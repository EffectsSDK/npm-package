"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.tsvb=void 0;var _excluded=["region"],_excluded2=["chars","padding","resolution","textureWidth","textureHeight"];var _isMobile$default;function _construct(t,e,r){if(_isNativeReflectConstruct2())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,e);var p=new(t.bind.apply(t,o))();return r&&_setPrototypeOf2(p,r.prototype),p;}function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)o=s[r],t.includes(o)||{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o]);}return i;}function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n];}return t;}function _superPropGet2(t,e,o,r){var p=_get2(_getPrototypeOf2(1&r?t.prototype:t),e,o);return 2&r&&"function"==typeof p?function(t){return p.apply(o,t);}:p;}function _get2(){return _get2="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var p=_superPropBase2(e,t);if(p){var n=Object.getOwnPropertyDescriptor(p,t);return n.get?n.get.call(arguments.length<3?e:r):n.value;}},_get2.apply(null,arguments);}function _superPropBase2(t,o){for(;!{}.hasOwnProperty.call(t,o)&&null!==(t=_getPrototypeOf2(t)););return t;}function _callSuper2(t,o,e){return o=_getPrototypeOf2(o),_possibleConstructorReturn2(t,_isNativeReflectConstruct2()?Reflect.construct(o,e||[],_getPrototypeOf2(t).constructor):o.apply(t,e));}function _possibleConstructorReturn2(t,e){if(e&&("object"==_typeof2(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized2(t);}function _assertThisInitialized2(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function _isNativeReflectConstruct2(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(t){}return(_isNativeReflectConstruct2=function _isNativeReflectConstruct2(){return!!t;})();}function _getPrototypeOf2(t){return _getPrototypeOf2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t);},_getPrototypeOf2(t);}function _inherits2(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf2(t,e);}function _setPrototypeOf2(t,e){return _setPrototypeOf2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t;},_setPrototypeOf2(t,e);}function _toConsumableArray2(r){return _arrayWithoutHoles2(r)||_iterableToArray2(r)||_unsupportedIterableToArray2(r)||_nonIterableSpread2();}function _nonIterableSpread2(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArray2(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r);}function _arrayWithoutHoles2(r){if(Array.isArray(r))return _arrayLikeToArray2(r);}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function _defineProperty(e,r,t){return(r=_toPropertyKey2(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e;}function _slicedToArray2(r,e){return _arrayWithHoles2(r)||_iterableToArrayLimit2(r,e)||_unsupportedIterableToArray2(r,e)||_nonIterableRest2();}function _nonIterableRest2(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArrayLimit2(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1;}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r;}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return;}finally{if(o)throw n;}}return a;}}function _arrayWithHoles2(r){if(Array.isArray(r))return r;}function _classCallCheck2(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function");}function __defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey2(o.key),o);}}function _createClass2(e,r,t){return r&&__defineProperties(e.prototype,r),t&&__defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e;}function _toPropertyKey2(t){var i=_toPrimitive2(t,"string");return"symbol"==_typeof2(i)?i:i+"";}function _toPrimitive2(t,r){if("object"!=_typeof2(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof2(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===r?String:Number)(t);}function _regeneratorRuntime2(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime2=function _regeneratorRuntime2(){return e;};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value;},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e];}try{define({},"");}catch(t){define=function define(t,e,r){return t[e]=r;};}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a;}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)};}catch(t){return{type:"throw",arg:t};}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,function(){return this;});var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach(function(e){define(t,e,function(t){return this._invoke(e,t);});});}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof2(h)&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){invoke("next",t,i,a);},function(t){invoke("throw",t,i,a);}):e.resolve(h).then(function(t){u.value=t,i(u);},function(t){return invoke("throw",t,i,a);});}a(c.arg);}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e(function(e,r){invoke(t,n,e,r);});}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg();}});}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0};}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done};}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg);}};}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator["return"]&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y);}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e);}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e;}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0);}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next;};return i.next=i;}}throw new TypeError(_typeof2(e)+" is not iterable");}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name));},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t;},e.awrap=function(t){return{__await:t};},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,function(){return this;}),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next();});},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,function(){return this;}),define(g,"toString",function(){return"[object Generator]";}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next;}return next.done=!0,next;};},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t);},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval;},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o;}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc);}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc);}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break;}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a);},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y;},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y;}},"catch":function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r);}return o;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y;}},e;}function _asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value;}catch(n){return void e(n);}i.done?t(u):Promise.resolve(u).then(r,o);}function _asyncToGenerator2(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){_asyncGeneratorStep(a,r,o,_next,_throw,"next",n);}function _throw(n){_asyncGeneratorStep(a,r,o,_next,_throw,"throw",n);}_next(void 0);});};}function _createForOfIteratorHelper2(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=_unsupportedIterableToArray2(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var _n224=0,F=function F(){};return{s:F,n:function n(){return _n224>=r.length?{done:!0}:{done:!1,value:r[_n224++]};},e:function e(r){throw r;},f:F};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,a=!0,u=!1;return{s:function s(){t=t.call(r);},n:function n(){var r=t.next();return a=r.done,r;},e:function e(r){u=!0,o=r;},f:function f(){try{a||null==t["return"]||t["return"]();}finally{if(u)throw o;}}};}function _unsupportedIterableToArray2(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray2(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray2(r,a):void 0;}}function _arrayLikeToArray2(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n;}function _typeof2(o){"@babel/helpers - typeof";return _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},_typeof2(o);}function _asyncIterator(r){var n,t,o,e=2;for("undefined"!=typeof Symbol&&(t=Symbol.asyncIterator,o=Symbol.iterator);e--;){if(t&&null!=(n=r[t]))return n.call(r);if(o&&null!=(n=r[o]))return new AsyncFromSyncIterator(n.call(r));t="@@asyncIterator",o="@@iterator";}throw new TypeError("Object is not async iterable");}function AsyncFromSyncIterator(r){function AsyncFromSyncIteratorContinuation(r){if(Object(r)!==r)return Promise.reject(new TypeError(r+" is not an object."));var n=r.done;return Promise.resolve(r.value).then(function(r){return{value:r,done:n};});}return AsyncFromSyncIterator=function AsyncFromSyncIterator(r){this.s=r,this.n=r.next;},AsyncFromSyncIterator.prototype={s:null,n:null,next:function next(){return AsyncFromSyncIteratorContinuation(this.n.apply(this.s,arguments));},"return":function _return(r){var n=this.s["return"];return void 0===n?Promise.resolve({value:r,done:!0}):AsyncFromSyncIteratorContinuation(n.apply(this.s,arguments));},"throw":function _throw(r){var n=this.s["return"];return void 0===n?Promise.reject(r):AsyncFromSyncIteratorContinuation(n.apply(this.s,arguments));}},new AsyncFromSyncIterator(r);}/*! For license information please see tsvb.js.LICENSE.txt */var __webpack_modules__={9452:function _(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1;}function o(e,t,n,o,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new i(n,o||e,a),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e;}function a(e,t){0==--e._eventsCount?e._events=new n():delete e._events[t];}function s(){this._events=new n(),this._eventsCount=0;}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i;},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=new Array(o);i<o;i++)a[i]=n[i].fn;return a;},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0;},s.prototype.emit=function(e,t,n,i,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var u,l,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,o),!0;case 6:return c.fn.call(c.context,t,n,i,o,a),!0;}for(l=1,u=new Array(h-1);l<h;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u);}else{var f,d=c.length;for(l=0;l<d;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),h){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,n);break;case 4:c[l].fn.call(c[l].context,t,n,i);break;default:if(!u)for(f=1,u=new Array(h-1);f<h;f++)u[f-1]=arguments[f];c[l].fn.apply(c[l].context,u);}}return!0;},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1);},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0);},s.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||a(this,o);else{for(var u=0,l=[],c=s.length;u<c;u++)(s[u].fn!==t||i&&!s[u].once||n&&s[u].context!==n)&&l.push(s[u]);l.length?this._events[o]=1===l.length?l[0]:l:a(this,o);}return this;},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new n(),this._eventsCount=0),this;},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s;},3161:function _(e){var t;t=function t(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports;}return r.m=e,r.c=t,r.p="",r(0);}([function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isNotPNG=function(e){return e===s;},t.isNotAPNG=function(e){return e===u;},t["default"]=function(e){var t=new Uint8Array(e);if(Array.prototype.some.call(l,function(e,r){return e!==t[r];}))return s;var r=!1;if(c(t,function(e){return!(r="acTL"===e);}),!r)return u;var n=[],i=[],o=null,h=null,y=0,m=new a.APNG();if(c(t,function(e,t,r,s){var u=new DataView(t.buffer);switch(e){case"IHDR":o=t.subarray(r+8,r+8+s),m.width=u.getUint32(r+8),m.height=u.getUint32(r+12);break;case"acTL":m.numPlays=u.getUint32(r+8+4);break;case"fcTL":h&&(m.frames.push(h),y++),(h=new a.Frame()).width=u.getUint32(r+8+4),h.height=u.getUint32(r+8+8),h.left=u.getUint32(r+8+12),h.top=u.getUint32(r+8+16);var l=u.getUint16(r+8+20),c=u.getUint16(r+8+22);0===c&&(c=100),h.delay=1e3*l/c,h.delay<=10&&(h.delay=100),m.playTime+=h.delay,h.disposeOp=u.getUint8(r+8+24),h.blendOp=u.getUint8(r+8+25),h.dataParts=[],0===y&&2===h.disposeOp&&(h.disposeOp=1);break;case"fdAT":h&&h.dataParts.push(t.subarray(r+8+4,r+8+s));break;case"IDAT":h&&h.dataParts.push(t.subarray(r+8,r+8+s));break;case"IEND":i.push(f(t,r,12+s));break;default:n.push(f(t,r,12+s));}}),h&&m.frames.push(h),0==m.frames.length)return u;var g=new Blob(n),w=new Blob(i);return m.frames.forEach(function(e){var t=[];t.push(l),o.set(p(e.width),0),o.set(p(e.height),4),t.push(d("IHDR",o)),t.push(g),e.dataParts.forEach(function(e){return t.push(d("IDAT",e));}),t.push(w),e.imageData=new Blob(t,{type:"image/png"}),delete e.dataParts,t=null;}),m;};var n,i=r(1),o=(n=i)&&n.__esModule?n:{"default":n},a=r(2),s=new Error("Not a PNG"),u=new Error("Not an animated PNG"),l=new Uint8Array([137,80,78,71,13,10,26,10]);function c(e,t){var r=new DataView(e.buffer),n=8,i=void 0,o=void 0,a=void 0;do{o=r.getUint32(n),a=t(i=h(e,n+4,4),e,n,o),n+=12+o;}while(!1!==a&&"IEND"!=i&&n<e.length);}function h(e,t,r){var n=Array.prototype.slice.call(e.subarray(t,t+r));return String.fromCharCode.apply(String,n);}function f(e,t,r){var n=new Uint8Array(r);return n.set(e.subarray(t,t+r)),n;}var d=function d(e,t){var r=e.length+t.length,n=new Uint8Array(r+8),i=new DataView(n.buffer);i.setUint32(0,t.length),n.set(function(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t;}(e),4),n.set(t,8);var a=(0,o["default"])(n,4,r);return i.setUint32(r+4,a),n;},p=function p(e){return new Uint8Array([e>>>24&255,e>>>16&255,e>>>8&255,255&e]);};},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,i=t,o=t+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length-t);i<o;i++)n=n>>>8^r[255&(n^e[i])];return~n;};for(var r=new Uint32Array(256),n=0;n<256;n++){for(var i=n,o=0;o<8;o++)i=1&i?3988292384^i>>>1:i>>>1;r[n]=i;}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Frame=t.APNG=void 0;var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n);}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t;};}(),o=r(3),a=(n=o)&&n.__esModule?n:{"default":n};function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}t.APNG=function(){function e(){s(this,e),this.width=0,this.height=0,this.numPlays=0,this.playTime=0,this.frames=[];}return i(e,[{key:"createImages",value:function value(){return Promise.all(this.frames.map(function(e){return e.createImage();}));}},{key:"getPlayer",value:function value(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.createImages().then(function(){return new a["default"](t,e,r);});}}]),e;}(),t.Frame=function(){function e(){s(this,e),this.left=0,this.top=0,this.width=0,this.height=0,this.delay=0,this.disposeOp=0,this.blendOp=0,this.imageData=null,this.imageElement=null;}return i(e,[{key:"createImage",value:function value(){var e=this;return this.imageElement?Promise.resolve():new Promise(function(t,r){var n=URL.createObjectURL(e.imageData);e.imageElement=document.createElement("img"),e.imageElement.onload=function(){URL.revokeObjectURL(n),t();},e.imageElement.onerror=function(){URL.revokeObjectURL(n),e.imageElement=null,r(new Error("Image creation error"));},e.imageElement.src=n;});}}]),e;}();},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n);}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t;};}(),o=r(4),a=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof2(t)&&"function"!=typeof t?e:t;}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.playbackRate=1,i._currentFrameNumber=0,i._ended=!1,i._paused=!0,i._numPlays=0,i._apng=e,i.context=r,i.stop(),n&&i.play(),i;}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof2(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(t,e),i(t,[{key:"renderNextFrame",value:function value(){this._currentFrameNumber=(this._currentFrameNumber+1)%this._apng.frames.length,this._currentFrameNumber===this._apng.frames.length-1&&(this._numPlays++,0!==this._apng.numPlays&&this._numPlays>=this._apng.numPlays&&(this._ended=!0,this._paused=!0)),this._prevFrame&&1==this._prevFrame.disposeOp?this.context.clearRect(this._prevFrame.left,this._prevFrame.top,this._prevFrame.width,this._prevFrame.height):this._prevFrame&&2==this._prevFrame.disposeOp&&this.context.putImageData(this._prevFrameData,this._prevFrame.left,this._prevFrame.top);var e=this.currentFrame;this._prevFrame=e,this._prevFrameData=null,2==e.disposeOp&&(this._prevFrameData=this.context.getImageData(e.left,e.top,e.width,e.height)),0==e.blendOp&&this.context.clearRect(e.left,e.top,e.width,e.height),this.context.drawImage(e.imageElement,e.left,e.top),this.emit("frame",this._currentFrameNumber),this._ended&&this.emit("end");}},{key:"play",value:function value(){var e=this;this.emit("play"),this._ended&&this.stop(),this._paused=!1;var t=performance.now()+this.currentFrame.delay/this.playbackRate;requestAnimationFrame(function r(n){if(!e._ended&&!e._paused){if(n>=t){for(;n-t>=e._apng.playTime/e.playbackRate;)t+=e._apng.playTime/e.playbackRate,e._numPlays++;do{e.renderNextFrame(),t+=e.currentFrame.delay/e.playbackRate;}while(!e._ended&&!e._paused&&n>t);}requestAnimationFrame(r);}});}},{key:"pause",value:function value(){this._paused||(this.emit("pause"),this._paused=!0);}},{key:"stop",value:function value(){this.emit("stop"),this._numPlays=0,this._ended=!1,this._paused=!0,this._currentFrameNumber=-1,this.context.clearRect(0,0,this._apng.width,this._apng.height),this.renderNextFrame();}},{key:"currentFrameNumber",get:function get(){return this._currentFrameNumber;}},{key:"currentFrame",get:function get(){return this._apng.frames[this._currentFrameNumber];}},{key:"paused",get:function get(){return this._paused;}},{key:"ended",get:function get(){return this._ended;}}]),t;}(((n=o)&&n.__esModule?n:{"default":n})["default"]);t["default"]=a;},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0;}function n(e){return"function"==typeof e;}function i(e){return"object"==_typeof2(e)&&null!==e;}function o(e){return void 0===e;}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this;},r.prototype.emit=function(e){var t,r,a,s,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c;}if(o(r=this._events[e]))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s);}else if(i(r))for(s=Array.prototype.slice.call(arguments,1),a=(l=r.slice()).length,u=0;u<a;u++)l[u].apply(this,s);return!0;},r.prototype.addListener=function(e,t){var a;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(a=o(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[e].length>a&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this;},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){if(!n(t))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(e,i),r||(r=!0,t.apply(this,arguments));}return i.listener=t,this.on(e,i),this;},r.prototype.removeListener=function(e,t){var r,o,a,s;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(a=(r=this._events[e]).length,o=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(r)){for(s=a;s-->0;)if(r[s]===t||r[s].listener&&r[s].listener===t){o=s;break;}if(o<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t);}return this;},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this;}if(n(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this;},r.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[];},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length;}return 0;},r.listenerCount=function(e,t){return e.listenerCount(t);};}]);},e.exports=t();},2505:function _(e,t,r){e.exports=r(8015);},5592:function _(e,t,r){var n=r(9516),i=r(7522),o=r(3948),a=r(9106),s=r(9615),u=r(2012),l=r(4202),c=r(7763),h=r(4896),f=r(1928);e.exports=function(e){return new Promise(function(t,r){var d,p=e.data,y=e.headers,m=e.responseType;function g(){e.cancelToken&&e.cancelToken.unsubscribe(d),e.signal&&e.signal.removeEventListener("abort",d);}n.isFormData(p)&&delete y["Content-Type"];var w=new XMLHttpRequest();if(e.auth){var b=e.auth.username||"",v=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";y.Authorization="Basic "+btoa(b+":"+v);}var x=s(e.baseURL,e.url);function _(){if(w){var n="getAllResponseHeaders"in w?u(w.getAllResponseHeaders()):null,o={data:m&&"text"!==m&&"json"!==m?w.response:w.responseText,status:w.status,statusText:w.statusText,headers:n,config:e,request:w};i(function(e){t(e),g();},function(e){r(e),g();},o),w=null;}}if(w.open(e.method.toUpperCase(),a(x,e.params,e.paramsSerializer),!0),w.timeout=e.timeout,"onloadend"in w?w.onloadend=_:w.onreadystatechange=function(){w&&4===w.readyState&&(0!==w.status||w.responseURL&&0===w.responseURL.indexOf("file:"))&&setTimeout(_);},w.onabort=function(){w&&(r(c("Request aborted",e,"ECONNABORTED",w)),w=null);},w.onerror=function(){r(c("Network Error",e,null,w)),w=null;},w.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",n=e.transitional||h;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(c(t,e,n.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",w)),w=null;},n.isStandardBrowserEnv()){var S=(e.withCredentials||l(x))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;S&&(y[e.xsrfHeaderName]=S);}"setRequestHeader"in w&&n.forEach(y,function(e,t){void 0===p&&"content-type"===t.toLowerCase()?delete y[t]:w.setRequestHeader(t,e);}),n.isUndefined(e.withCredentials)||(w.withCredentials=!!e.withCredentials),m&&"json"!==m&&(w.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&w.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&w.upload&&w.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(d=function d(e){w&&(r(!e||e&&e.type?new f("canceled"):e),w.abort(),w=null);},e.cancelToken&&e.cancelToken.subscribe(d),e.signal&&(e.signal.aborted?d():e.signal.addEventListener("abort",d))),p||(p=null),w.send(p);});};},8015:function _(e,t,r){var n=r(9516),i=r(9012),o=r(5155),a=r(5343);var s=function e(t){var r=new o(t),s=i(o.prototype.request,r);return n.extend(s,o.prototype,r),n.extend(s,r),s.create=function(r){return e(a(t,r));},s;}(r(7412));s.Axios=o,s.Cancel=r(1928),s.CancelToken=r(3191),s.isCancel=r(3864),s.VERSION=r(9641).version,s.all=function(e){return Promise.all(e);},s.spread=r(7980),s.isAxiosError=r(5019),e.exports=s,e.exports["default"]=s;},1928:function _(e){function t(e){this.message=e;}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"");},t.prototype.__CANCEL__=!0,e.exports=t;},3191:function _(e,t,r){var n=r(1928);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e;});var r=this;this.promise.then(function(e){if(r._listeners){var t,n=r._listeners.length;for(t=0;t<n;t++)r._listeners[t](e);r._listeners=null;}}),this.promise.then=function(e){var t,n=new Promise(function(e){r.subscribe(e),t=e;}).then(e);return n.cancel=function(){r.unsubscribe(t);},n;},e(function(e){r.reason||(r.reason=new n(e),t(r.reason));});}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason;},i.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e];},i.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1);}},i.source=function(){var e,t=new i(function(t){e=t;});return{token:t,cancel:e};},e.exports=i;},3864:function _(e){e.exports=function(e){return!(!e||!e.__CANCEL__);};},5155:function _(e,t,r){var n=r(9516),i=r(9106),o=r(3471),a=r(4490),s=r(5343),u=r(4841),l=u.validators;function c(e){this.defaults=e,this.interceptors={request:new o(),response:new o()};}c.prototype.request=function(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},(t=s(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var r=t.transitional;void 0!==r&&u.assertOptions(r,{silentJSONParsing:l.transitional(l["boolean"]),forcedJSONParsing:l.transitional(l["boolean"]),clarifyTimeoutError:l.transitional(l["boolean"])},!1);var n=[],i=!0;this.interceptors.request.forEach(function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(i=i&&e.synchronous,n.unshift(e.fulfilled,e.rejected));});var o,c=[];if(this.interceptors.response.forEach(function(e){c.push(e.fulfilled,e.rejected);}),!i){var h=[a,void 0];for(Array.prototype.unshift.apply(h,n),h=h.concat(c),o=Promise.resolve(t);h.length;)o=o.then(h.shift(),h.shift());return o;}for(var f=t;n.length;){var d=n.shift(),p=n.shift();try{f=d(f);}catch(e){p(e);break;}}try{o=a(f);}catch(e){return Promise.reject(e);}for(;c.length;)o=o.then(c.shift(),c.shift());return o;},c.prototype.getUri=function(e){return e=s(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"");},n.forEach(["delete","get","head","options"],function(e){c.prototype[e]=function(t,r){return this.request(s(r||{},{method:e,url:t,data:(r||{}).data}));};}),n.forEach(["post","put","patch"],function(e){c.prototype[e]=function(t,r,n){return this.request(s(n||{},{method:e,url:t,data:r}));};}),e.exports=c;},3471:function _(e,t,r){var n=r(9516);function i(){this.handlers=[];}i.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1;},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null);},i.prototype.forEach=function(e){n.forEach(this.handlers,function(t){null!==t&&e(t);});},e.exports=i;},9615:function _(e,t,r){var n=r(9137),i=r(4680);e.exports=function(e,t){return e&&!n(t)?i(e,t):t;};},7763:function _(e,t,r){var n=r(5449);e.exports=function(e,t,r,i,o){var a=new Error(e);return n(a,t,r,i,o);};},4490:function _(e,t,r){var n=r(9516),i=r(2881),o=r(3864),a=r(7412),s=r(1928);function u(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new s("canceled");}e.exports=function(e){return u(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t];}),(e.adapter||a.adapter)(e).then(function(t){return u(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t;},function(t){return o(t)||(u(e),t&&t.response&&(t.response.data=i.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t);});};},5449:function _(e){e.exports=function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null};},e;};},5343:function _(e,t,r){var n=r(9516);e.exports=function(e,t){t=t||{};var r={};function i(e,t){return n.isPlainObject(e)&&n.isPlainObject(t)?n.merge(e,t):n.isPlainObject(t)?n.merge({},t):n.isArray(t)?t.slice():t;}function o(r){return n.isUndefined(t[r])?n.isUndefined(e[r])?void 0:i(void 0,e[r]):i(e[r],t[r]);}function a(e){if(!n.isUndefined(t[e]))return i(void 0,t[e]);}function s(r){return n.isUndefined(t[r])?n.isUndefined(e[r])?void 0:i(void 0,e[r]):i(void 0,t[r]);}function u(r){return r in t?i(e[r],t[r]):r in e?i(void 0,e[r]):void 0;}var l={url:a,method:a,data:a,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:u};return n.forEach(Object.keys(e).concat(Object.keys(t)),function(e){var t=l[e]||o,i=t(e);n.isUndefined(i)&&t!==u||(r[e]=i);}),r;};},7522:function _(e,t,r){var n=r(7763);e.exports=function(e,t,r){var i=r.config.validateStatus;r.status&&i&&!i(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r);};},2881:function _(e,t,r){var n=r(9516),i=r(7412);e.exports=function(e,t,r){var o=this||i;return n.forEach(r,function(r){e=r.call(o,e,t);}),e;};},7412:function _(e,t,r){var n=r(5606),i=r(9516),o=r(7018),a=r(5449),s=r(4896),u={"Content-Type":"application/x-www-form-urlencoded"};function l(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t);}var c,h={transitional:s,adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==n&&"[object process]"===Object.prototype.toString.call(n))&&(c=r(5592)),c),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(l(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||t&&"application/json"===t["Content-Type"]?(l(t,"application/json"),function(e,t,r){if(i.isString(e))try{return(t||JSON.parse)(e),i.trim(e);}catch(e){if("SyntaxError"!==e.name)throw e;}return(r||JSON.stringify)(e);}(e)):e;}],transformResponse:[function(e){var t=this.transitional||h.transitional,r=t&&t.silentJSONParsing,n=t&&t.forcedJSONParsing,o=!r&&"json"===this.responseType;if(o||n&&i.isString(e)&&e.length)try{return JSON.parse(e);}catch(e){if(o){if("SyntaxError"===e.name)throw a(e,this,"E_JSON_PARSE");throw e;}}return e;}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function validateStatus(e){return e>=200&&e<300;},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],function(e){h.headers[e]={};}),i.forEach(["post","put","patch"],function(e){h.headers[e]=i.merge(u);}),e.exports=h;},4896:function _(e){e.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};},9641:function _(e){e.exports={version:"0.26.1"};},9012:function _(e){e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r);};};},9106:function _(e,t,r){var n=r(9516);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]");}e.exports=function(e,t,r){if(!t)return e;var o;if(r)o=r(t);else if(n.isURLSearchParams(t))o=t.toString();else{var a=[];n.forEach(t,function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e));}));}),o=a.join("&");}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o;}return e;};},4680:function _(e){e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e;};},3948:function _(e,t,r){var n=r(9516);e.exports=n.isStandardBrowserEnv()?{write:function write(e,t,r,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),n.isString(i)&&s.push("path="+i),n.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ");},read:function read(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null;},remove:function remove(e){this.write(e,"",Date.now()-864e5);}}:{write:function write(){},read:function read(){return null;},remove:function remove(){}};},9137:function _(e){e.exports=function(e){return /^([a-z][a-z\d+\-.]*:)?\/\//i.test(e);};},5019:function _(e,t,r){var n=r(9516);e.exports=function(e){return n.isObject(e)&&!0===e.isAxiosError;};},4202:function _(e,t,r){var n=r(9516);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname};}return e=i(window.location.href),function(t){var r=n.isString(t)?i(t):t;return r.protocol===e.protocol&&r.host===e.host;};}():function(){return!0;};},7018:function _(e,t,r){var n=r(9516);e.exports=function(e,t){n.forEach(e,function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n]);});};},2012:function _(e,t,r){var n=r(9516),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,o,a={};return e?(n.forEach(e.split("\n"),function(e){if(o=e.indexOf(":"),t=n.trim(e.substr(0,o)).toLowerCase(),r=n.trim(e.substr(o+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([r]):a[t]?a[t]+", "+r:r;}}),a):a;};},7980:function _(e){e.exports=function(e){return function(t){return e.apply(null,t);};};},4841:function _(e,t,r){var n=r(9641).version,i={};["object","boolean","number","function","string","symbol"].forEach(function(e,t){i[e]=function(r){return _typeof2(r)===e||"a"+(t<1?"n ":" ")+e;};});var o={};i.transitional=function(e,t,r){function i(e,t){return"[Axios v"+n+"] Transitional option '"+e+"'"+t+(r?". "+r:"");}return function(r,n,a){if(!1===e)throw new Error(i(n," has been removed"+(t?" in "+t:"")));return t&&!o[n]&&(o[n]=!0,console.warn(i(n," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,n,a);};},e.exports={assertOptions:function assertOptions(e,t,r){if("object"!=_typeof2(e))throw new TypeError("options must be an object");for(var n=Object.keys(e),i=n.length;i-->0;){var o=n[i],a=t[o];if(a){var s=e[o],u=void 0===s||a(s,o,e);if(!0!==u)throw new TypeError("option "+o+" must be "+u);}else if(!0!==r)throw Error("Unknown option "+o);}},validators:i};},9516:function _(e,t,r){var n=r(9012),i=Object.prototype.toString;function o(e){return Array.isArray(e);}function a(e){return void 0===e;}function s(e){return"[object ArrayBuffer]"===i.call(e);}function u(e){return null!==e&&"object"==_typeof2(e);}function l(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype;}function c(e){return"[object Function]"===i.call(e);}function h(e,t){if(null!=e)if("object"!=_typeof2(e)&&(e=[e]),o(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e);}e.exports={isArray:o,isArrayBuffer:s,isBuffer:function isBuffer(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e);},isFormData:function isFormData(e){return"[object FormData]"===i.call(e);},isArrayBufferView:function isArrayBufferView(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&s(e.buffer);},isString:function isString(e){return"string"==typeof e;},isNumber:function isNumber(e){return"number"==typeof e;},isObject:u,isPlainObject:l,isUndefined:a,isDate:function isDate(e){return"[object Date]"===i.call(e);},isFile:function isFile(e){return"[object File]"===i.call(e);},isBlob:function isBlob(e){return"[object Blob]"===i.call(e);},isFunction:c,isStream:function isStream(e){return u(e)&&c(e.pipe);},isURLSearchParams:function isURLSearchParams(e){return"[object URLSearchParams]"===i.call(e);},isStandardBrowserEnv:function isStandardBrowserEnv(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document;},forEach:h,merge:function e(){var t={};function r(r,n){l(t[n])&&l(r)?t[n]=e(t[n],r):l(r)?t[n]=e({},r):o(r)?t[n]=r.slice():t[n]=r;}for(var n=0,i=arguments.length;n<i;n++)h(arguments[n],r);return t;},extend:function extend(e,t,r){return h(t,function(t,i){e[i]=r&&"function"==typeof t?n(t,r):t;}),e;},trim:function trim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"");},stripBOM:function stripBOM(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e;}};},8380:function _(e,t,r){r.d(t,{yy:function yy(){return f;},y$:function y$(){return l;}});var n="3.4.3";function i(e){return i="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},i(e);}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n);}}function a(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function s(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}(e,"string");return"symbol"==i(t)?t:t+"";}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}var l,c={overlay:!1,overlay_attrs:{url:"https://effectssdk.ai/assets/videos/overlay/esdk.mp4"},lowerthird:!1,lowerthird_type:"lowerthird_3",lowerthird_text:{text:{title:"Max Troshin",subtitle:"CEO at Effects SDK / effectssdk.com"}},lowerthird_color:{color:{primary:161271}},lowerthird_offset:{offset:{x:15/1280,y:75/720}},emoji_duration:{duration:3500},emoji_size:{size:.3},emoji_position:{position:{placement:"top-left"}},giphy_duration:{duration:3500},giphy_size:{size:.3},giphy_position:{position:{placement:"top-left"}},seg_mode:"balanced",background:"none",layout:"center",layout_custom:void 0,blur:!0,blur_power:.6,beautification:!0,beauty_power:.68,boundary:0,frameskipping:!1,sz_switch:!0,sz_facearea:.1,sz_drawface:!1,sz_drawprefaces:!1,sz_accuracy:.75,sz_smoothing:.2,sz_period:100,cc_switch:!1,cc_power:1,cc_part:1,cc_period:1e3,cf_switch:!1,cf_lut:{lut:"none"},cf_part:{part:1},cf_power:{power:1},cf_capacity:{capacity:5},sh_switch:!1,sh_power:.5},h=a(function e(){u(this,e);});h.APP_ENV="web",h.API_URL="https://effectssdk.ai/sdk/session/",h.STATS_URL="https://effectssdk.ai/sdk/stats/",h.BASE_URL="https://effectssdk.ai/",h.SDK_URL=h.BASE_URL+"sdk/",h.VB_MODEL=h.SDK_URL+"models/model-1.2.1.0.tsvb",h.PRESET="balanced",h.DEMO_IMAGE=h.SDK_URL+"100.jpg",h.DEMO_VIDEO=h.SDK_URL+"video-background.mp4",function(e){e.VIRTUAL_BACKGROUND="VIRTUAL_BACKGROUND",e.SMART_ZOOM="SMART_ZOOM",e.CUSTOM_RESOLUTION="CUSTOM_RESOLUTION",e.LOW_LIGHT="LOW_LIGHT",e.COLOR_CORRECTION="COLOR_CORRECTION",e.COLOR_FILTER="COLOR_FILTER",e.SHARPNESS="SHARPNESS",e.MIRRORING="MIRRORING";}(l||(l={}));var f=function(){function e(){u(this,e);}return a(e,null,[{key:"isEffectExist",value:function value(e){var t=new Map();t.set(l.COLOR_CORRECTION,"colorcorrector"),t.set(l.SMART_ZOOM,"facedetector"),t.set(l.LOW_LIGHT,"lowlighter");var r=this.EFFECTS.includes(e),n=t.get(e);return n&&(r=r&&this.MODELS[n]),r;}},{key:"getModelUrl",value:function value(t){return e.SDK_URL+t;}},{key:"getPresetUrl",value:function value(t){return e.SDK_URL+t;}},{key:"setVersion",value:function value(){e.VERSION=n;}}]);}();f.EFFECTS=[l.VIRTUAL_BACKGROUND,l.SMART_ZOOM,l.LOW_LIGHT,l.COLOR_CORRECTION,l.COLOR_FILTER,l.SHARPNESS,l.MIRRORING],f.VERSION="0.0.0",f.CUSTOMER_ID="",f.APP_ENV=h.APP_ENV,f.API_URL=h.API_URL,f.STATS_URL=h.STATS_URL,f.MODEL_URL=h.SDK_URL+"models/model-1.2.1.tsvb",f.PRESET=h.PRESET,f.SDK_URL=h.SDK_URL,f.MODELS={colorcorrector:"models/model-cc-1.0.0.tsvb",facedetector:"models/model-fd-1.1.0.tsvb",lowlighter:"models/model-ll-1.2.0.tsvb"},f.PROXY=!0,f.STATS=!1,f.PROVIDER="wasm",f.WASM_PATHS={},f.PRESETS={quality:"models/model-1.0.1.tsvb",balanced:"models/model-5.5.0.tsvb",speed:"models/model-3.1.1.tsvb",lightning:"models/model-4.0.1.tsvb"},f.PRESETS_PORTRAIT={quality:"models/m-model-1.0.1.tsvb",balanced:"models/m-model-5.5.0.tsvb",speed:"models/m-model-3.1.1.tsvb",lightning:"models/m-model-4.0.1.tsvb"},f.STATES_PRESET=c;},9672:function _(e,t,r){function n(e){return n="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},n(e);}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n);}}function o(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}(e,"string");return"symbol"==n(t)?t:t+"";}r.d(t,{By:function By(){return a;},JK:function JK(){return s;},bv:function bv(){return l;}});var a,s,u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e);}return function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}(e,[{key:"subscribe",value:function value(e){var t="function"==typeof e;this.onErrorFunction=t?e:void 0;}},{key:"notify",value:function value(e){"function"==typeof this.onErrorFunction&&(e.emitter&&(e.message="[ ".concat(e.emitter," ]: ").concat(e.message)),e.type||(e.type=a.ERROR),this.onErrorFunction(e));}}],[{key:"getInstance",value:function value(){return e._instance||(e._instance=new e()),e._instance;}}]);}(),l=u.getInstance();!function(e){e.INFO="info",e.WARNING="warning",e.ERROR="error";}(a||(a={})),function(e){e.TSVB="tsvb",e.COMPONENTS_SYSTEM="components_system",e.SRTEAM_PROCESSOR="stream_processor",e.ML_INFERENCE="ml_inference",e.PRESET_INIT="preset_init",e.RENDERER="renderer",e.RECORDER="recorder",e.EFFECT_VIRTUAL_BACKGROUND="effect_virtual_background",e.EFFECT_COLOR_CORRECTION="effect_color_correction",e.EFFECT_COLOR_FILTER="effect_color_filter",e.EFFECT_SMART_ZOOM="effect_smart_zoom",e.EFFECT_LOW_LIGHT="effect_low_light";}(s||(s={}));},7036:function _(e,t,r){function n(e){return n="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},n(e);}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n);}}function o(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}(e,"string");return"symbol"==n(t)?t:t+"";}r.d(t,{P:function P(){return a;}});var a=function(){return function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}(function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e);},[{key:"createPromise",value:function value(){var e=this;return this._promise=new Promise(function(t,r){e.resolver=t,e.rejecter=r;}),this._promise;}},{key:"promise",get:function get(){return this._promise;}},{key:"resolve",value:function value(e){if("function"!=typeof this.resolver)return!1;this.resolver(e),this.resolver=void 0;}},{key:"reject",value:function value(e){if("function"!=typeof this.rejecter)return!1;this.rejecter(e),this.rejecter=void 0,this._promise=void 0;}}]);}();},6739:function _(e,t,r){function n(e){return e?e.charAt(0).toUpperCase()+e.slice(1):"";}r.d(t,{Y:function Y(){return B;},kc:function kc(){return p;},Uz:function Uz(){return d;}});var i=r(8380),o=r(2004),a=r(2505),s=r.n(a);function u(e){return u="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},u(e);}function l(e){return function(e){if(Array.isArray(e))return c(e);}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e);}(e)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0;}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}();}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n;}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n);}}function f(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}(e,"string");return"symbol"==u(t)?t:t+"";}var d=function(){return function(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}(function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this.data=[],this.delay=5e3,this.isRunning=!1,this.deferred=new Map();},[{key:"setCustomerID",value:function value(e){this.customer_id=e;}},{key:"push",value:function value(e,t){var r=this;i.yy.STATS&&(this.checkRunning(e),this.isRunning?(clearTimeout(this.timer),this.data.push({feature:e,user_id:o.W.getInstance().getUID(this.customer_id),data:t}),this.timer=setTimeout(function(){return r.send();},this.delay)):this.deferred.set(e,t));}},{key:"send",value:function value(){var e=this,t=l(this.data);this.data=[];var r=i.yy.STATS_URL+this.customer_id,n={"Tsvb-Version":i.yy.VERSION};s().post(r,t,{headers:n})["catch"](function(r){return e.data=[].concat(l(t),l(e.data)),r;});}},{key:"checkRunning",value:function value(e){var t=this,r=o.W.getInstance().getUID(this.customer_id);"run"===e&&(this.isRunning=!0,this.deferred.forEach(function(e,n){t.data.push({feature:n,user_id:r,data:e});}),this.deferred.clear());}}],[{key:"Instance",get:function get(){return this._instance||(this._instance=new this());}}]);}();function p(e){return function(t,r,i){var o=i.value;i.value=function(){var t=r+n(e);d.Instance.push(t);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return o.apply(this,a);};};}function y(e){return y="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},y(e);}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n);}}function g(e){var t=function(e,t){if("object"!=y(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}(e,"string");return"symbol"==y(t)?t:t+"";}var w=function(){return function(e,t,r){return t&&m(e.prototype,t),r&&m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}(function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e);},null,[{key:"isStattable",value:function value(e,t){var r;return(null!==(r=this.FEATURES[e])&&void 0!==r?r:[]).includes(t);}}]);}();function b(e){return b="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},b(e);}function v(){v=function v(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new R(n||[]);return i(a,"_invoke",{value:C(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function x(){}var _={};l(_,a,function(){return this;});var S=Object.getPrototypeOf,T=S&&S(S(B([])));T&&T!==r&&n.call(T,a)&&(_=T);var I=x.prototype=g.prototype=Object.create(_);function E(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function A(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==b(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function C(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=O(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function O(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,O(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0);}function B(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(b(t)+" is not iterable");}return w.prototype=x,i(I,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=l(x,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,l(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e;},t.awrap=function(e){return{__await:e};},E(A.prototype),l(A.prototype,s,function(){return this;}),t.AsyncIterator=A,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new A(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},E(I),l(I,u,"Generator"),l(I,a,function(){return this;}),l(I,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=B,R.prototype={constructor:R,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),k(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;k(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:B(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}w.FEATURES={recorder:["start","stop","pause","resume"],tsvb:["run","stop","enableBeautification","disableBeautification","setBlur","clearBlur","setBackground","clearBackground","enableSmartZoom","disableSmartZoom","enableColorCorrector","disableColorCorrector","enableFrameSkipping","disableFrameSkipping","setLayout","enableColorFilter","disableColorFilter","setSegmentationPreset","enableLowLightEffect","disableLowLightEffect","enableSharpnessEffect","disableSharpnessEffect"]},w.SDK_RUNNING_INTERVALS=[{feature:"run5",delay_ms:3e5},{feature:"run10",delay_ms:3e5},{feature:"run15",delay_ms:3e5},{feature:"run20",delay_ms:3e5}];var x=v().mark(T);function _(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return S(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(e,t):void 0;}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var _n2=0,i=function i(){};return{s:i,n:function n(){return _n2>=e.length?{done:!0}:{done:!1,value:e[_n2++]};},e:function e(_e2){throw _e2;},f:i};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,a=!0,s=!1;return{s:function s(){r=r.call(e);},n:function n(){var e=r.next();return a=e.done,e;},e:function e(_e3){s=!0,o=_e3;},f:function f(){try{a||null==r["return"]||r["return"]();}finally{if(s)throw o;}}};}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n;}function T(e){var t,r,n;return v().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:t=_(e),i.prev=1,t.s();case 3:if((r=t.n()).done){i.next=9;break;}return n=r.value,i.next=7,n;case 7:i.next=3;break;case 9:i.next=14;break;case 11:i.prev=11,i.t0=i["catch"](1),t.e(i.t0);case 14:return i.prev=14,t.f(),i.finish(14);case 17:case"end":return i.stop();}},x,null,[[1,11,14,17]]);}function I(e){return I="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},I(e);}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A(n.key),n);}}function A(e){var t=function(e,t){if("object"!=I(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}(e,"string");return"symbol"==I(t)?t:t+"";}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e);}return function(e,t,r){return t&&E(e.prototype,t),r&&E(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}(e,[{key:"setFeatureData",value:function value(e,t){this.feature=t,this.type=e;}},{key:"handle",value:function value(){this.isDisableToPush()||(this.pushStat(),this.isSdkRunFeature()&&(clearTimeout(this.sdkRunningTimer),this.intervalIterator=T(w.SDK_RUNNING_INTERVALS),this.handleSdkRunningInterval()),this.isSdkStopFeature()&&clearTimeout(this.sdkRunningTimer));}},{key:"isDisableToPush",value:function value(){return!w.isStattable(this.type,this.feature)||!!this.isEqualLastPushedFeature();}},{key:"pushStat",value:function value(){var e=this.getFeatureName();d.Instance.push(e),this.lastPushedFeature=e;}},{key:"getFeatureName",value:function value(){var e="tsvb"!==this.type?n(this.type):"";return this.feature+e;}},{key:"isSdkRunFeature",value:function value(){return"tsvb"===this.type&&"run"===this.feature;}},{key:"isSdkStopFeature",value:function value(){return"tsvb"===this.type&&"stop"===this.feature;}},{key:"isEqualLastPushedFeature",value:function value(){return this.lastPushedFeature===this.getFeatureName();}},{key:"handleSdkRunningInterval",value:function value(){var e=this.intervalIterator.next(),t=e.value;e.done||this.startSdkRunningTimer(t.feature,t.delay_ms);}},{key:"startSdkRunningTimer",value:function value(e,t){var r=this;this.sdkRunningTimer=setTimeout(function(){d.Instance.push(e),r.handleSdkRunningInterval();},t);}}],[{key:"getInstance",value:function value(){return e._instance||(e._instance=new e()),e._instance;}}]);}(),O=C.getInstance();function P(e){return P="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},P(e);}function k(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return R(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?R(e,t):void 0;}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var _n3=0,i=function i(){};return{s:i,n:function n(){return _n3>=e.length?{done:!0}:{done:!1,value:e[_n3++]};},e:function e(_e4){throw _e4;},f:i};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,a=!0,s=!1;return{s:function s(){r=r.call(e);},n:function n(){var e=r.next();return a=e.done,e;},e:function e(_e5){s=!0,o=_e5;},f:function f(){try{a||null==r["return"]||r["return"]();}finally{if(s)throw o;}}};}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n;}function B(e){return function(t){var r,n=k(Object.getOwnPropertyNames(t.prototype));try{var i=function i(){var n=r.value,i=Object.getOwnPropertyDescriptor(t.prototype,n);if(!i)return 0;var o=i.value;if(!(o instanceof Function))return 0;i.value=function(){O.setFeatureData(e,n),O.handle();for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=o.apply(this,r),s=function s(){};if("object"===P(a)&&"function"==typeof a.then){var u=a.then(s);"function"==typeof u["catch"]&&u["catch"](function(e){return e;});}return a;},Object.defineProperty(t.prototype,n,i);};for(n.s();!(r=n.n()).done;)i();}catch(e){n.e(e);}finally{n.f();}};}},2004:function _(e,t,r){function n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n];}return e;}r.d(t,{W:function W(){return y;}});var i=function e(t,r){function i(e,i,o){if("undefined"!=typeof document){"number"==typeof(o=n({},r,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var s in o)o[s]&&(a+="; "+s,!0!==o[s]&&(a+="="+o[s].split(";")[0]));return document.cookie=e+"="+t.write(i,e)+a;}}return Object.create({set:i,get:function get(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},i=0;i<r.length;i++){var o=r[i].split("="),a=o.slice(1).join("=");try{var s=decodeURIComponent(o[0]);if(n[s]=t.read(a,s),e===s)break;}catch(e){}}return e?n[e]:n;}},remove:function remove(e,t){i(e,"",n({},t,{expires:-1}));},withAttributes:function withAttributes(t){return e(this.converter,n({},this.attributes,t));},withConverter:function withConverter(t){return e(n({},this.converter,t),this.attributes);}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}});}({read:function read(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);},write:function write(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent);}},{path:"/"});var o={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var a;var s=new Uint8Array(16);function u(){if(!a&&(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!a))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(s);}var l=[];for(var _e6=0;_e6<256;++_e6)l.push((_e6+256).toString(16).slice(1));function c(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]];}var h=function h(e,t,r){if(o.randomUUID&&!t&&!e)return o.randomUUID();var n=(e=e||{}).random||(e.rng||u)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var _e7=0;_e7<16;++_e7)t[r+_e7]=n[_e7];return t;}return c(n);};function f(e){return f="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},f(e);}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n);}}function p(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}(e,"string");return"symbol"==f(t)?t:t+"";}var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e);}return function(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}(e,[{key:"getUID",value:function value(e){if(this._uid)return this._uid;var t=i.get("TSVB_UID");return t||(t=h(),i.set("TSVB_UID",t)),t;}},{key:"setUID",value:function value(e){this._uid=e;}}],[{key:"getInstance",value:function value(){return e.instance||(e.instance=new e()),e.instance;}}]);}();},7526:function _(e,t){t.byteLength=function(e){var t=s(e),r=t[0],n=t[1];return 3*(r+n)/4-n;},t.toByteArray=function(e){var t,r,o=s(e),a=o[0],u=o[1],l=new i(function(e,t,r){return 3*(t+r)/4-r;}(0,a,u)),c=0,h=u>0?a-4:a;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],l[c++]=t>>16&255,l[c++]=t>>8&255,l[c++]=255&t;2===u&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,l[c++]=255&t);1===u&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,l[c++]=t>>8&255,l[c++]=255&t);return l;},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=16383,s=0,l=n-i;s<l;s+=a)o.push(u(e,s,s+a>l?l:s+a));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("");};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)r[a]=o[a],n[o.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4];}function u(e,t,n){for(var i,o,a=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("");}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63;},8287:function _(e,t,r){var n=r(7526),i=r(251),o=r(4634);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823;}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e;}function u(e,t,r){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e);}return l(this,e,t,r);}function l(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=f(e,t);return e;}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!u.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(t,r);e=s(e,n);var i=e.write(t,r);i!==n&&(e=e.slice(0,i));return e;}(e,t,r):function(e,t){if(u.isBuffer(t)){var r=0|d(t.length);return 0===(e=s(e,r)).length||t.copy(e,0,0,r),e;}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?s(e,0):f(e,t);if("Buffer"===t.type&&o(t.data))return f(e,t.data);}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}(e,t);}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative');}function h(e,t){if(c(t),e=s(e,t<0?0:0|d(t)),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e;}function f(e,t){var r=t.length<0?0:0|d(t.length);e=s(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e;}function d(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e;}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return j(e).length;default:if(n)return G(e).length;t=(""+t).toLowerCase(),n=!0;}}function y(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,r);case"utf8":case"utf-8":return E(this,t,r);case"ascii":return C(this,t,r);case"latin1":case"binary":return O(this,t,r);case"base64":return I(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0;}}function m(e,t,r){var n=e[t];e[t]=e[r],e[r]=n;}function g(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1;}else if(r<0){if(!i)return-1;r=0;}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:w(e,t,r,n,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer");}function w(e,t,r,n,i){var o,a=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,r/=2;}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a);}if(i){var c=-1;for(o=r;o<s;o++)if(l(e,o)===l(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===u)return c*a;}else-1!==c&&(o-=o-c),c=-1;}else for(r+u>s&&(r=s-u),o=r;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(l(e,o+f)!==l(t,f)){h=!1;break;}if(h)return o;}return-1;}function b(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s;}return a;}function v(e,t,r,n){return z(G(t,e.length-r),e,r,n);}function x(e,t,r,n){return z(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t;}(t),e,r,n);}function _(e,t,r,n){return x(e,t,r,n);}function S(e,t,r,n){return z(j(t),e,r,n);}function T(e,t,r,n){return z(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o;}(t,e.length-r),e,r,n);}function I(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r));}function E(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,u,l=e[i],c=null,h=l>239?4:l>223?3:l>191?2:1;if(i+h<=r)switch(h){case 1:l<128&&(c=l);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&l)<<6|63&o)>127&&(c=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(u=(15&l)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(c=u);}null===c?(c=65533,h=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=h;}return function(e){var t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=A));return r;}(n);}t.hp=u,t.IS=50,u.TYPED_ARRAY_SUPPORT=void 0!==r.g.TYPED_ARRAY_SUPPORT?r.g.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function foo(){return 42;}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength;}catch(e){return!1;}}(),a(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e;},u.from=function(e,t,r){return l(null,e,t,r);},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,r){return function(e,t,r,n){return c(t),t<=0?s(e,t):void 0!==r?"string"==typeof n?s(e,t).fill(r,n):s(e,t).fill(r):s(e,t);}(null,e,t,r);},u.allocUnsafe=function(e){return h(null,e);},u.allocUnsafeSlow=function(e){return h(null,e);},u.isBuffer=function(e){return!(null==e||!e._isBuffer);},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break;}return r<n?-1:n<r?1:0;},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=u.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var a=e[r];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,i),i+=a.length;}return n;},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this;},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this;},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this;},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?E(this,0,e):y.apply(this,arguments);},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e);},u.prototype.inspect=function(){var e="",r=t.IS;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">";},u.prototype.compare=function(e,t,r,n,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(o,a),l=this.slice(n,i),c=e.slice(t,r),h=0;h<s;++h)if(l[h]!==c[h]){o=l[h],a=c[h];break;}return o<a?-1:a<o?1:0;},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r);},u.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0);},u.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1);},u.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0);}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return b(this,e,t,r);case"utf8":case"utf-8":return v(this,e,t,r);case"ascii":return x(this,e,t,r);case"latin1":case"binary":return _(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0;}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)};};var A=4096;function C(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n;}function O(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n;}function P(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=U(e[o]);return i;}function k(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i;}function R(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length");}function B(e,t,r,n,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range");}function $(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i);}function D(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255;}function M(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range");}function L(e,t,r,n,o){return o||M(e,0,r,4),i.write(e,t,r,n,23,4),r+4;}function F(e,t,r,n,o){return o||M(e,0,r,8),i.write(e,t,r,n,52,8),r+8;}u.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;r=new u(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e];}return r;},u.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n;},u.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n;},u.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e];},u.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8;},u.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1];},u.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3];},u.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3]);},u.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n;},u.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o;},u.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e];},u.prototype.readInt16LE=function(e,t){t||R(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r;},u.prototype.readInt16BE=function(e,t){t||R(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r;},u.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24;},u.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3];},u.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!0,23,4);},u.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!1,23,4);},u.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!0,52,8);},u.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!1,52,8);},u.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||B(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r;},u.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||B(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r;},u.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1;},u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):$(this,e,t,!0),t+2;},u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):$(this,e,t,!1),t+2;},u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4;},u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4;},u.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);B(this,e,t,r,i-1,-i);}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+r;},u.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);B(this,e,t,r,i-1,-i);}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+r;},u.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1;},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):$(this,e,t,!0),t+2;},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):$(this,e,t,!1),t+2;},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4;},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4;},u.prototype.writeFloatLE=function(e,t,r){return L(this,e,t,!0,r);},u.prototype.writeFloatBE=function(e,t,r){return L(this,e,t,!1,r);},u.prototype.writeDoubleLE=function(e,t,r){return F(this,e,t,!0,r);},u.prototype.writeDoubleBE=function(e,t,r){return F(this,e,t,!1,r);},u.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o;},u.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i);}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n);}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=u.isBuffer(e)?e:G(new u(e,n).toString()),s=a.length;for(o=0;o<r-t;++o)this[o+t]=a[o%s];}return this;};var N=/[^+\/0-9A-Za-z-_]/g;function U(e){return e<16?"0"+e.toString(16):e.toString(16);}function G(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue;}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue;}i=r;continue;}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue;}r=65536+(i-55296<<10|r-56320);}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r);}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128);}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128);}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128);}}return o;}function j(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"");}(e).replace(N,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e;}(e));}function z(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i;}},8075:function _(e,t,r){var n=r(453),i=r(487),o=i(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&o(e,".prototype.")>-1?i(r):r;};},487:function _(e,t,r){var n=r(6743),i=r(453),o=r(6897),a=r(9675),s=i("%Function.prototype.apply%"),u=i("%Function.prototype.call%"),l=i("%Reflect.apply%",!0)||n.call(u,s),c=r(655),h=i("%Math.max%");e.exports=function(e){if("function"!=typeof e)throw new a("a function is required");var t=l(n,u,arguments);return o(t,1+h(0,e.length-(arguments.length-1)),!0);};var f=function f(){return l(n,s,arguments);};c?c(e.exports,"apply",{value:f}):e.exports.apply=f;},41:function _(e,t,r){var n=r(655),i=r(8068),o=r(9675),a=r(5795);e.exports=function(e,t,r){if(!e||"object"!=_typeof2(e)&&"function"!=typeof e)throw new o("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=_typeof2(t))throw new o("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new o("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new o("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new o("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new o("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,u=arguments.length>4?arguments[4]:null,l=arguments.length>5?arguments[5]:null,c=arguments.length>6&&arguments[6],h=!!a&&a(e,t);if(n)n(e,t,{configurable:null===l&&h?h.configurable:!l,enumerable:null===s&&h?h.enumerable:!s,value:r,writable:null===u&&h?h.writable:!u});else{if(!c&&(s||u||l))throw new i("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=r;}};},6570:function _(e){function t(e,t,n){n=n||2;var o,a,s,u,h,f,p,y=t&&t.length,m=y?t[0]*n:e.length,g=r(e,0,m,n,!0),w=[];if(!g||g.next===g.prev)return w;if(y&&(g=function(e,t,n,i){var o,a,s,u=[];for(o=0,a=t.length;o<a;o++)(s=r(e,t[o]*i,o<a-1?t[o+1]*i:e.length,i,!1))===s.next&&(s.steiner=!0),u.push(d(s));for(u.sort(l),o=0;o<u.length;o++)n=c(u[o],n);return n;}(e,t,g,n)),e.length>80*n){o=s=e[0],a=u=e[1];for(var b=n;b<m;b+=n)(h=e[b])<o&&(o=h),(f=e[b+1])<a&&(a=f),h>s&&(s=h),f>u&&(u=f);p=0!==(p=Math.max(s-o,u-a))?32767/p:0;}return i(g,w,n,o,a,p,0),w;}function r(e,t,r,n,i){var o,a;if(i===E(e,t,r,n)>0)for(o=t;o<r;o+=n)a=S(o,e[o],e[o+1],a);else for(o=r-n;o>=t;o-=n)a=S(o,e[o],e[o+1],a);return a&&g(a,a.next)&&(T(a),a=a.next),a;}function n(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!g(n,n.next)&&0!==m(n.prev,n,n.next))n=n.next;else{if(T(n),(n=t=n.prev)===n.next)break;r=!0;}}while(r||n!==t);return t;}function i(e,t,r,l,c,h,d){if(e){!d&&h&&function(e,t,r,n){var i=e;do{0===i.z&&(i.z=f(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,o,a,s,u,l=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,n=r,s=0,t=0;t<l&&(s++,n=n.nextZ);t++);for(u=l;s>0||u>0&&n;)0!==s&&(0===u||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,u--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;r=n;}o.nextZ=null,l*=2;}while(a>1);}(i);}(e,l,c,h);for(var p,y,m=e;e.prev!==e.next;)if(p=e.prev,y=e.next,h?a(e,l,c,h):o(e))t.push(p.i/r|0),t.push(e.i/r|0),t.push(y.i/r|0),T(e),e=y.next,m=y.next;else if((e=y)===m){d?1===d?i(e=s(n(e),t,r),t,r,l,c,h,2):2===d&&u(e,t,r,l,c,h):i(n(e),t,r,l,c,h,1);break;}}}function o(e){var t=e.prev,r=e,n=e.next;if(m(t,r,n)>=0)return!1;for(var i=t.x,o=r.x,a=n.x,s=t.y,u=r.y,l=n.y,c=i<o?i<a?i:a:o<a?o:a,h=s<u?s<l?s:l:u<l?u:l,f=i>o?i>a?i:a:o>a?o:a,d=s>u?s>l?s:l:u>l?u:l,y=n.next;y!==t;){if(y.x>=c&&y.x<=f&&y.y>=h&&y.y<=d&&p(i,s,o,u,a,l,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.next;}return!0;}function a(e,t,r,n){var i=e.prev,o=e,a=e.next;if(m(i,o,a)>=0)return!1;for(var s=i.x,u=o.x,l=a.x,c=i.y,h=o.y,d=a.y,y=s<u?s<l?s:l:u<l?u:l,g=c<h?c<d?c:d:h<d?h:d,w=s>u?s>l?s:l:u>l?u:l,b=c>h?c>d?c:d:h>d?h:d,v=f(y,g,t,r,n),x=f(w,b,t,r,n),_=e.prevZ,S=e.nextZ;_&&_.z>=v&&S&&S.z<=x;){if(_.x>=y&&_.x<=w&&_.y>=g&&_.y<=b&&_!==i&&_!==a&&p(s,c,u,h,l,d,_.x,_.y)&&m(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,S.x>=y&&S.x<=w&&S.y>=g&&S.y<=b&&S!==i&&S!==a&&p(s,c,u,h,l,d,S.x,S.y)&&m(S.prev,S,S.next)>=0)return!1;S=S.nextZ;}for(;_&&_.z>=v;){if(_.x>=y&&_.x<=w&&_.y>=g&&_.y<=b&&_!==i&&_!==a&&p(s,c,u,h,l,d,_.x,_.y)&&m(_.prev,_,_.next)>=0)return!1;_=_.prevZ;}for(;S&&S.z<=x;){if(S.x>=y&&S.x<=w&&S.y>=g&&S.y<=b&&S!==i&&S!==a&&p(s,c,u,h,l,d,S.x,S.y)&&m(S.prev,S,S.next)>=0)return!1;S=S.nextZ;}return!0;}function s(e,t,r){var i=e;do{var o=i.prev,a=i.next.next;!g(o,a)&&w(o,i,i.next,a)&&x(o,a)&&x(a,o)&&(t.push(o.i/r|0),t.push(i.i/r|0),t.push(a.i/r|0),T(i),T(i.next),i=e=a),i=i.next;}while(i!==e);return n(i);}function u(e,t,r,o,a,s){var u=e;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&y(u,l)){var c=_(u,l);return u=n(u,u.next),c=n(c,c.next),i(u,t,r,o,a,s,0),void i(c,t,r,o,a,s,0);}l=l.next;}u=u.next;}while(u!==e);}function l(e,t){return e.x-t.x;}function c(e,t){var r=function(e,t){var r,n=t,i=e.x,o=e.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>a&&(a=s,r=n.x<n.next.x?n:n.next,s===i))return r;}n=n.next;}while(n!==t);if(!r)return null;var u,l=r,c=r.x,f=r.y,d=1/0;n=r;do{i>=n.x&&n.x>=c&&i!==n.x&&p(o<f?i:a,o,c,f,o<f?a:i,o,n.x,n.y)&&(u=Math.abs(o-n.y)/(i-n.x),x(n,e)&&(u<d||u===d&&(n.x>r.x||n.x===r.x&&h(r,n)))&&(r=n,d=u)),n=n.next;}while(n!==l);return r;}(e,t);if(!r)return t;var i=_(r,e);return n(i,i.next),n(r,r.next);}function h(e,t){return m(e.prev,e,t.prev)<0&&m(t.next,e,e.next)<0;}function f(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1;}function d(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;}while(t!==e);return r;}function p(e,t,r,n,i,o,a,s){return(i-a)*(t-s)>=(e-a)*(o-s)&&(e-a)*(n-s)>=(r-a)*(t-s)&&(r-a)*(o-s)>=(i-a)*(n-s);}function y(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&w(r,r.next,e,t))return!0;r=r.next;}while(r!==e);return!1;}(e,t)&&(x(e,t)&&x(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;}while(r!==e);return n;}(e,t)&&(m(e.prev,e,t.prev)||m(e,t.prev,t))||g(e,t)&&m(e.prev,e,e.next)>0&&m(t.prev,t,t.next)>0);}function m(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y);}function g(e,t){return e.x===t.x&&e.y===t.y;}function w(e,t,r,n){var i=v(m(e,t,r)),o=v(m(e,t,n)),a=v(m(r,n,e)),s=v(m(r,n,t));return i!==o&&a!==s||!(0!==i||!b(e,r,t))||!(0!==o||!b(e,n,t))||!(0!==a||!b(r,e,n))||!(0!==s||!b(r,t,n));}function b(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y);}function v(e){return e>0?1:e<0?-1:0;}function x(e,t){return m(e.prev,e,e.next)<0?m(e,t,e.next)>=0&&m(e,e.prev,t)>=0:m(e,t,e.prev)<0||m(e,e.next,t)<0;}function _(e,t){var r=new I(e.i,e.x,e.y),n=new I(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n;}function S(e,t,r,n){var i=new I(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i;}function T(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ);}function I(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1;}function E(e,t,r,n){for(var i=0,o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i;}e.exports=t,e.exports["default"]=t,t.deviation=function(e,t,r,n){var i=t&&t.length,o=i?t[0]*r:e.length,a=Math.abs(E(e,0,o,r));if(i)for(var s=0,u=t.length;s<u;s++){var l=t[s]*r,c=s<u-1?t[s+1]*r:e.length;a-=Math.abs(E(e,l,c,r));}var h=0;for(s=0;s<n.length;s+=3){var f=n[s]*r,d=n[s+1]*r,p=n[s+2]*r;h+=Math.abs((e[f]-e[p])*(e[d+1]-e[f+1])-(e[f]-e[d])*(e[p+1]-e[f+1]));}return 0===a&&0===h?0:Math.abs((h-a)/a);},t.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[i][o][a]);i>0&&(n+=e[i-1].length,r.holes.push(n));}return r;};},655:function _(e,t,r){var n=r(453)("%Object.defineProperty%",!0)||!1;if(n)try{n({},"a",{value:1});}catch(e){n=!1;}e.exports=n;},1237:function _(e){e.exports=EvalError;},9383:function _(e){e.exports=Error;},9290:function _(e){e.exports=RangeError;},9538:function _(e){e.exports=ReferenceError;},8068:function _(e){e.exports=SyntaxError;},9675:function _(e){e.exports=TypeError;},5345:function _(e){e.exports=URIError;},228:function _(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1;}function o(e,t,n,o,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new i(n,o||e,a),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e;}function a(e,t){0==--e._eventsCount?e._events=new n():delete e._events[t];}function s(){this._events=new n(),this._eventsCount=0;}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i;},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=new Array(o);i<o;i++)a[i]=n[i].fn;return a;},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0;},s.prototype.emit=function(e,t,n,i,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var u,l,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,o),!0;case 6:return c.fn.call(c.context,t,n,i,o,a),!0;}for(l=1,u=new Array(h-1);l<h;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u);}else{var f,d=c.length;for(l=0;l<d;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),h){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,n);break;case 4:c[l].fn.call(c[l].context,t,n,i);break;default:if(!u)for(f=1,u=new Array(h-1);f<h;f++)u[f-1]=arguments[f];c[l].fn.apply(c[l].context,u);}}return!0;},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1);},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0);},s.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||a(this,o);else{for(var u=0,l=[],c=s.length;u<c;u++)(s[u].fn!==t||i&&!s[u].once||n&&s[u].context!==n)&&l.push(s[u]);l.length?this._events[o]=1===l.length?l[0]:l:a(this,o);}return this;},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new n(),this._eventsCount=0),this;},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s;},8389:function _(e,t){!function(e){var t=function t(e){return function(t){var r=e(t);return t.add(r),r;};},r=function r(e){return function(t,r){return e.set(t,r),r;};},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,i=536870912,o=2*i,a=function a(e,t){return function(r){var a=t.get(r),s=void 0===a?r.size:a<o?a+1:0;if(!r.has(s))return e(r,s);if(r.size<i){for(;r.has(s);)s=Math.floor(Math.random()*o);return e(r,s);}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(s);)s=Math.floor(Math.random()*n);return e(r,s);};},s=new WeakMap(),u=r(s),l=a(u,s),c=t(l);e.addUniqueNumber=c,e.generateUniqueNumber=l;}(t);},1707:function _(e,t,r){var n,i;n=function n(){var e={172351395:{name:"EBML",type:"Container"},646:{name:"EBMLVersion",type:"Uint"},759:{name:"EBMLReadVersion",type:"Uint"},754:{name:"EBMLMaxIDLength",type:"Uint"},755:{name:"EBMLMaxSizeLength",type:"Uint"},642:{name:"DocType",type:"String"},647:{name:"DocTypeVersion",type:"Uint"},645:{name:"DocTypeReadVersion",type:"Uint"},108:{name:"Void",type:"Binary"},63:{name:"CRC-32",type:"Binary"},190023271:{name:"SignatureSlot",type:"Container"},16010:{name:"SignatureAlgo",type:"Uint"},16026:{name:"SignatureHash",type:"Uint"},16037:{name:"SignaturePublicKey",type:"Binary"},16053:{name:"Signature",type:"Binary"},15963:{name:"SignatureElements",type:"Container"},15995:{name:"SignatureElementList",type:"Container"},9522:{name:"SignedElement",type:"Binary"},139690087:{name:"Segment",type:"Container"},21863284:{name:"SeekHead",type:"Container"},3515:{name:"Seek",type:"Container"},5035:{name:"SeekID",type:"Binary"},5036:{name:"SeekPosition",type:"Uint"},88713574:{name:"Info",type:"Container"},13220:{name:"SegmentUID",type:"Binary"},13188:{name:"SegmentFilename",type:"String"},1882403:{name:"PrevUID",type:"Binary"},1868715:{name:"PrevFilename",type:"String"},2013475:{name:"NextUID",type:"Binary"},1999803:{name:"NextFilename",type:"String"},1092:{name:"SegmentFamily",type:"Binary"},10532:{name:"ChapterTranslate",type:"Container"},10748:{name:"ChapterTranslateEditionUID",type:"Uint"},10687:{name:"ChapterTranslateCodec",type:"Uint"},10661:{name:"ChapterTranslateID",type:"Binary"},710577:{name:"TimecodeScale",type:"Uint"},1161:{name:"Duration",type:"Float"},1121:{name:"DateUTC",type:"Date"},15273:{name:"Title",type:"String"},3456:{name:"MuxingApp",type:"String"},5953:{name:"WritingApp",type:"String"},103:{name:"Timecode",type:"Uint"},6228:{name:"SilentTracks",type:"Container"},6359:{name:"SilentTrackNumber",type:"Uint"},39:{name:"Position",type:"Uint"},43:{name:"PrevSize",type:"Uint"},35:{name:"SimpleBlock",type:"Binary"},32:{name:"BlockGroup",type:"Container"},33:{name:"Block",type:"Binary"},34:{name:"BlockVirtual",type:"Binary"},13729:{name:"BlockAdditions",type:"Container"},38:{name:"BlockMore",type:"Container"},110:{name:"BlockAddID",type:"Uint"},37:{name:"BlockAdditional",type:"Binary"},27:{name:"BlockDuration",type:"Uint"},122:{name:"ReferencePriority",type:"Uint"},123:{name:"ReferenceBlock",type:"Int"},125:{name:"ReferenceVirtual",type:"Int"},36:{name:"CodecState",type:"Binary"},13730:{name:"DiscardPadding",type:"Int"},14:{name:"Slices",type:"Container"},104:{name:"TimeSlice",type:"Container"},76:{name:"LaceNumber",type:"Uint"},77:{name:"FrameNumber",type:"Uint"},75:{name:"BlockAdditionID",type:"Uint"},78:{name:"Delay",type:"Uint"},79:{name:"SliceDuration",type:"Uint"},72:{name:"ReferenceFrame",type:"Container"},73:{name:"ReferenceOffset",type:"Uint"},74:{name:"ReferenceTimeCode",type:"Uint"},47:{name:"EncryptedBlock",type:"Binary"},106212971:{name:"Tracks",type:"Container"},46:{name:"TrackEntry",type:"Container"},87:{name:"TrackNumber",type:"Uint"},13253:{name:"TrackUID",type:"Uint"},3:{name:"TrackType",type:"Uint"},57:{name:"FlagEnabled",type:"Uint"},8:{name:"FlagDefault",type:"Uint"},5546:{name:"FlagForced",type:"Uint"},28:{name:"FlagLacing",type:"Uint"},11751:{name:"MinCache",type:"Uint"},11768:{name:"MaxCache",type:"Uint"},254851:{name:"DefaultDuration",type:"Uint"},216698:{name:"DefaultDecodedFieldDuration",type:"Uint"},209231:{name:"TrackTimecodeScale",type:"Float"},4991:{name:"TrackOffset",type:"Int"},5614:{name:"MaxBlockAdditionID",type:"Uint"},4974:{name:"Name",type:"String"},177564:{name:"Language",type:"String"},6:{name:"CodecID",type:"String"},9122:{name:"CodecPrivate",type:"Binary"},362120:{name:"CodecName",type:"String"},13382:{name:"AttachmentLink",type:"Uint"},1742487:{name:"CodecSettings",type:"String"},1785920:{name:"CodecInfoURL",type:"String"},438848:{name:"CodecDownloadURL",type:"String"},42:{name:"CodecDecodeAll",type:"Uint"},12203:{name:"TrackOverlay",type:"Uint"},5802:{name:"CodecDelay",type:"Uint"},5819:{name:"SeekPreRoll",type:"Uint"},9764:{name:"TrackTranslate",type:"Container"},9980:{name:"TrackTranslateEditionUID",type:"Uint"},9919:{name:"TrackTranslateCodec",type:"Uint"},9893:{name:"TrackTranslateTrackID",type:"Binary"},96:{name:"Video",type:"Container"},26:{name:"FlagInterlaced",type:"Uint"},5048:{name:"StereoMode",type:"Uint"},5056:{name:"AlphaMode",type:"Uint"},5049:{name:"OldStereoMode",type:"Uint"},48:{name:"PixelWidth",type:"Uint"},58:{name:"PixelHeight",type:"Uint"},5290:{name:"PixelCropBottom",type:"Uint"},5307:{name:"PixelCropTop",type:"Uint"},5324:{name:"PixelCropLeft",type:"Uint"},5341:{name:"PixelCropRight",type:"Uint"},5296:{name:"DisplayWidth",type:"Uint"},5306:{name:"DisplayHeight",type:"Uint"},5298:{name:"DisplayUnit",type:"Uint"},5299:{name:"AspectRatioType",type:"Uint"},963876:{name:"ColourSpace",type:"Binary"},1029411:{name:"GammaValue",type:"Float"},230371:{name:"FrameRate",type:"Float"},97:{name:"Audio",type:"Container"},53:{name:"SamplingFrequency",type:"Float"},14517:{name:"OutputSamplingFrequency",type:"Float"},31:{name:"Channels",type:"Uint"},15739:{name:"ChannelPositions",type:"Binary"},8804:{name:"BitDepth",type:"Uint"},98:{name:"TrackOperation",type:"Container"},99:{name:"TrackCombinePlanes",type:"Container"},100:{name:"TrackPlane",type:"Container"},101:{name:"TrackPlaneUID",type:"Uint"},102:{name:"TrackPlaneType",type:"Uint"},105:{name:"TrackJoinBlocks",type:"Container"},109:{name:"TrackJoinUID",type:"Uint"},64:{name:"TrickTrackUID",type:"Uint"},65:{name:"TrickTrackSegmentUID",type:"Binary"},70:{name:"TrickTrackFlag",type:"Uint"},71:{name:"TrickMasterTrackUID",type:"Uint"},68:{name:"TrickMasterTrackSegmentUID",type:"Binary"},11648:{name:"ContentEncodings",type:"Container"},8768:{name:"ContentEncoding",type:"Container"},4145:{name:"ContentEncodingOrder",type:"Uint"},4146:{name:"ContentEncodingScope",type:"Uint"},4147:{name:"ContentEncodingType",type:"Uint"},4148:{name:"ContentCompression",type:"Container"},596:{name:"ContentCompAlgo",type:"Uint"},597:{name:"ContentCompSettings",type:"Binary"},4149:{name:"ContentEncryption",type:"Container"},2017:{name:"ContentEncAlgo",type:"Uint"},2018:{name:"ContentEncKeyID",type:"Binary"},2019:{name:"ContentSignature",type:"Binary"},2020:{name:"ContentSigKeyID",type:"Binary"},2021:{name:"ContentSigAlgo",type:"Uint"},2022:{name:"ContentSigHashAlgo",type:"Uint"},206814059:{name:"Cues",type:"Container"},59:{name:"CuePoint",type:"Container"},51:{name:"CueTime",type:"Uint"},55:{name:"CueTrackPositions",type:"Container"},119:{name:"CueTrack",type:"Uint"},113:{name:"CueClusterPosition",type:"Uint"},112:{name:"CueRelativePosition",type:"Uint"},50:{name:"CueDuration",type:"Uint"},4984:{name:"CueBlockNumber",type:"Uint"},106:{name:"CueCodecState",type:"Uint"},91:{name:"CueReference",type:"Container"},22:{name:"CueRefTime",type:"Uint"},23:{name:"CueRefCluster",type:"Uint"},4959:{name:"CueRefNumber",type:"Uint"},107:{name:"CueRefCodecState",type:"Uint"},155296873:{name:"Attachments",type:"Container"},8615:{name:"AttachedFile",type:"Container"},1662:{name:"FileDescription",type:"String"},1646:{name:"FileName",type:"String"},1632:{name:"FileMimeType",type:"String"},1628:{name:"FileData",type:"Binary"},1710:{name:"FileUID",type:"Uint"},1653:{name:"FileReferral",type:"Binary"},1633:{name:"FileUsedStartTime",type:"Uint"},1634:{name:"FileUsedEndTime",type:"Uint"},4433776:{name:"Chapters",type:"Container"},1465:{name:"EditionEntry",type:"Container"},1468:{name:"EditionUID",type:"Uint"},1469:{name:"EditionFlagHidden",type:"Uint"},1499:{name:"EditionFlagDefault",type:"Uint"},1501:{name:"EditionFlagOrdered",type:"Uint"},54:{name:"ChapterAtom",type:"Container"},13252:{name:"ChapterUID",type:"Uint"},5716:{name:"ChapterStringUID",type:"String"},17:{name:"ChapterTimeStart",type:"Uint"},18:{name:"ChapterTimeEnd",type:"Uint"},24:{name:"ChapterFlagHidden",type:"Uint"},1432:{name:"ChapterFlagEnabled",type:"Uint"},11879:{name:"ChapterSegmentUID",type:"Binary"},11964:{name:"ChapterSegmentEditionUID",type:"Uint"},9155:{name:"ChapterPhysicalEquiv",type:"Uint"},15:{name:"ChapterTrack",type:"Container"},9:{name:"ChapterTrackNumber",type:"Uint"},0:{name:"ChapterDisplay",type:"Container"},5:{name:"ChapString",type:"String"},892:{name:"ChapLanguage",type:"String"},894:{name:"ChapCountry",type:"String"},10564:{name:"ChapProcess",type:"Container"},10581:{name:"ChapProcessCodecID",type:"Uint"},1293:{name:"ChapProcessPrivate",type:"Binary"},10513:{name:"ChapProcessCommand",type:"Container"},10530:{name:"ChapProcessTime",type:"Uint"},10547:{name:"ChapProcessData",type:"Binary"},39109479:{name:"Tags",type:"Container"},13171:{name:"Tag",type:"Container"},9152:{name:"Targets",type:"Container"},10442:{name:"TargetTypeValue",type:"Uint"},9162:{name:"TargetType",type:"String"},9157:{name:"TagTrackUID",type:"Uint"},9161:{name:"TagEditionUID",type:"Uint"},9156:{name:"TagChapterUID",type:"Uint"},9158:{name:"TagAttachmentUID",type:"Uint"},10184:{name:"SimpleTag",type:"Container"},1443:{name:"TagName",type:"String"},1146:{name:"TagLanguage",type:"String"},1156:{name:"TagDefault",type:"Uint"},1159:{name:"TagString",type:"String"},1157:{name:"TagBinary",type:"Binary"}};function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e;}function r(e,t){this.name=e||"Unknown",this.type=t||"Unknown";}function n(e,t){r.call(this,e,t||"Uint");}function i(e){return e.length%2==1?"0"+e:e;}function o(e,t){r.call(this,e,t||"Float");}function a(e,t){r.call(this,e,t||"Container");}function s(e){a.call(this,"File","File"),this.setSource(e);}function u(e,t,r,n){if("object"==_typeof2(r)&&(n=r,r=void 0),!r)return new Promise(function(r){u(e,t,r,n);});try{var i=new FileReader();i.onloadend=function(){try{var o=new s(new Uint8Array(i.result));o.fixDuration(t,n)&&(e=o.toBlob(e.type));}catch(e){}r(e);},i.readAsArrayBuffer(e);}catch(t){r(e);}}return r.prototype.updateBySource=function(){},r.prototype.setSource=function(e){this.source=e,this.updateBySource();},r.prototype.updateByData=function(){},r.prototype.setData=function(e){this.data=e,this.updateByData();},t(n,r),n.prototype.updateBySource=function(){this.data="";for(var e=0;e<this.source.length;e++){var t=this.source[e].toString(16);this.data+=i(t);}},n.prototype.updateByData=function(){var e=this.data.length/2;this.source=new Uint8Array(e);for(var t=0;t<e;t++){var r=this.data.substr(2*t,2);this.source[t]=parseInt(r,16);}},n.prototype.getValue=function(){return parseInt(this.data,16);},n.prototype.setValue=function(e){this.setData(i(e.toString(16)));},t(o,r),o.prototype.getFloatArrayType=function(){return this.source&&4===this.source.length?Float32Array:Float64Array;},o.prototype.updateBySource=function(){var e=this.source.reverse(),t=new(this.getFloatArrayType())(e.buffer);this.data=t[0];},o.prototype.updateByData=function(){var e=new(this.getFloatArrayType())([this.data]),t=new Uint8Array(e.buffer);this.source=t.reverse();},o.prototype.getValue=function(){return this.data;},o.prototype.setValue=function(e){this.setData(e);},t(a,r),a.prototype.readByte=function(){return this.source[this.offset++];},a.prototype.readUint=function(){for(var e=this.readByte(),t=8-e.toString(2).length,r=e-(1<<7-t),n=0;n<t;n++)r*=256,r+=this.readByte();return r;},a.prototype.updateBySource=function(){for(this.data=[],this.offset=0;this.offset<this.source.length;this.offset=s){var t=this.readUint(),i=this.readUint(),s=Math.min(this.offset+i,this.source.length),u=this.source.slice(this.offset,s),l=e[t]||{name:"Unknown",type:"Unknown"},c=r;switch(l.type){case"Container":c=a;break;case"Uint":c=n;break;case"Float":c=o;}var h=new c(l.name,l.type);h.setSource(u),this.data.push({id:t,idHex:t.toString(16),data:h});}},a.prototype.writeUint=function(e,t){for(var r=1,n=128;e>=n&&r<8;r++,n*=128);if(!t)for(var i=n+e,o=r-1;o>=0;o--){var a=i%256;this.source[this.offset+o]=a,i=(i-a)/256;}this.offset+=r;},a.prototype.writeSections=function(e){this.offset=0;for(var t=0;t<this.data.length;t++){var r=this.data[t],n=r.data.source,i=n.length;this.writeUint(r.id,e),this.writeUint(i,e),e||this.source.set(n,this.offset),this.offset+=i;}return this.offset;},a.prototype.updateByData=function(){var e=this.writeSections("draft");this.source=new Uint8Array(e),this.writeSections();},a.prototype.getSectionById=function(e){for(var t=0;t<this.data.length;t++){var r=this.data[t];if(r.id===e)return r.data;}return null;},t(s,a),s.prototype.fixDuration=function(e,t){var r=t&&t.logger;void 0===r?r=function r(e){console.log(e);}:r||(r=function r(){});var n=this.getSectionById(139690087);if(!n)return r("[fix-webm-duration] Segment section is missing"),!1;var i=n.getSectionById(88713574);if(!i)return r("[fix-webm-duration] Info section is missing"),!1;var a=i.getSectionById(710577);if(!a)return r("[fix-webm-duration] TimecodeScale section is missing"),!1;var s=i.getSectionById(1161);if(s){if(!(s.getValue()<=0))return r("[fix-webm-duration] Duration section is present, and the value is ".concat(s.getValue())),!1;r("[fix-webm-duration] Duration section is present, but the value is ".concat(s.getValue())),s.setValue(e);}else r("[fix-webm-duration] Duration section is missing"),(s=new o("Duration","Float")).setValue(e),i.data.push({id:1161,data:s});return a.setValue(1e6),i.updateByData(),n.updateByData(),this.updateByData(),!0;},s.prototype.toBlob=function(e){return new Blob([this.source.buffer],{type:e||"video/webm"});},u["default"]=u,u;},void 0===(i="function"==typeof n?n.call(t,r,t,e):n)||(e.exports=i);},9353:function _(e){var t=Object.prototype.toString,r=Math.max,n=function n(e,t){for(var r=[],n=0;n<e.length;n+=1)r[n]=e[n];for(var i=0;i<t.length;i+=1)r[i+e.length]=t[i];return r;};e.exports=function(e){var i=this;if("function"!=typeof i||"[object Function]"!==t.apply(i))throw new TypeError("Function.prototype.bind called on incompatible "+i);for(var o,a=function(e,t){for(var r=[],n=t||0,i=0;n<e.length;n+=1,i+=1)r[i]=e[n];return r;}(arguments,1),s=r(0,i.length-a.length),u=[],l=0;l<s;l++)u[l]="$"+l;if(o=Function("binder","return function ("+function(e,t){for(var r="",n=0;n<e.length;n+=1)r+=e[n],n+1<e.length&&(r+=t);return r;}(u,",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof o){var t=i.apply(this,n(a,arguments));return Object(t)===t?t:this;}return i.apply(e,n(a,arguments));}),i.prototype){var c=function c(){};c.prototype=i.prototype,o.prototype=new c(),c.prototype=null;}return o;};},6743:function _(e,t,r){var n=r(9353);e.exports=Function.prototype.bind||n;},453:function _(e,t,r){var n,i=r(9383),o=r(1237),a=r(9290),s=r(9538),u=r(8068),l=r(9675),c=r(5345),h=Function,f=function f(e){try{return h('"use strict"; return ('+e+").constructor;")();}catch(e){}},d=Object.getOwnPropertyDescriptor;if(d)try{d({},"");}catch(e){d=null;}var p=function p(){throw new l();},y=d?function(){try{return p;}catch(e){try{return d(arguments,"callee").get;}catch(e){return p;}}}():p,m=r(4039)(),g=r(24)(),w=Object.getPrototypeOf||(g?function(e){return e.__proto__;}:null),b={},v="undefined"!=typeof Uint8Array&&w?w(Uint8Array):n,x={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":m&&w?w([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":b,"%AsyncGenerator%":b,"%AsyncGeneratorFunction%":b,"%AsyncIteratorPrototype%":b,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?n:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":i,"%eval%":eval,"%EvalError%":o,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":h,"%GeneratorFunction%":b,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":m&&w?w(w([][Symbol.iterator]())):n,"%JSON%":"object"==(typeof JSON==="undefined"?"undefined":_typeof2(JSON))?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&m&&w?w(new Map()[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":a,"%ReferenceError%":s,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&m&&w?w(new Set()[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":m&&w?w(""[Symbol.iterator]()):n,"%Symbol%":m?Symbol:n,"%SyntaxError%":u,"%ThrowTypeError%":y,"%TypedArray%":v,"%TypeError%":l,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":c,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet};if(w)try{null.error;}catch(e){var _=w(w(e));x["%Error.prototype%"]=_;}var S=function e(t){var r;if("%AsyncFunction%"===t)r=f("async function () {}");else if("%GeneratorFunction%"===t)r=f("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=f("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype);}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&w&&(r=w(i.prototype));}return x[t]=r,r;},T={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},I=r(6743),E=r(9957),A=I.call(Function.call,Array.prototype.concat),C=I.call(Function.apply,Array.prototype.splice),O=I.call(Function.call,String.prototype.replace),P=I.call(Function.call,String.prototype.slice),k=I.call(Function.call,RegExp.prototype.exec),R=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,B=/\\(\\)?/g,$=function $(e,t){var r,n=e;if(E(T,n)&&(n="%"+(r=T[n])[0]+"%"),E(x,n)){var i=x[n];if(i===b&&(i=S(n)),void 0===i&&!t)throw new l("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i};}throw new u("intrinsic "+e+" does not exist!");};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new l("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new l('"allowMissing" argument must be a boolean');if(null===k(/^%?[^%]*%?$/,e))throw new u("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(e){var t=P(e,0,1),r=P(e,-1);if("%"===t&&"%"!==r)throw new u("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new u("invalid intrinsic syntax, expected opening `%`");var n=[];return O(e,R,function(e,t,r,i){n[n.length]=r?O(i,B,"$1"):t||e;}),n;}(e),n=r.length>0?r[0]:"",i=$("%"+n+"%",t),o=i.name,a=i.value,s=!1,c=i.alias;c&&(n=c[0],C(r,A([0,1],c)));for(var h=1,f=!0;h<r.length;h+=1){var p=r[h],y=P(p,0,1),m=P(p,-1);if(('"'===y||"'"===y||"`"===y||'"'===m||"'"===m||"`"===m)&&y!==m)throw new u("property names with quotes must have matching quotes");if("constructor"!==p&&f||(s=!0),E(x,o="%"+(n+="."+p)+"%"))a=x[o];else if(null!=a){if(!(p in a)){if(!t)throw new l("base intrinsic for "+e+" exists, but the property is not available.");return;}if(d&&h+1>=r.length){var g=d(a,p);a=(f=!!g)&&"get"in g&&!("originalValue"in g.get)?g.get:a[p];}else f=E(a,p),a=a[p];f&&!s&&(x[o]=a);}}return a;};},5795:function _(e,t,r){var n=r(453)("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length");}catch(e){n=null;}e.exports=n;},592:function _(e,t,r){var n=r(655),i=function i(){return!!n;};i.hasArrayLengthDefineBug=function(){if(!n)return null;try{return 1!==n([],"length",{value:1}).length;}catch(e){return!0;}},e.exports=i;},24:function _(e){var t={__proto__:null,foo:{}},r=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!(t instanceof r);};},4039:function _(e,t,r){var n="undefined"!=typeof Symbol&&Symbol,i=r(1333);e.exports=function(){return"function"==typeof n&&"function"==typeof Symbol&&"symbol"==_typeof2(n("foo"))&&"symbol"==_typeof2(Symbol("bar"))&&i();};},1333:function _(e){e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==_typeof2(Symbol.iterator))return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1;}return!0;};},9957:function _(e,t,r){var n=Function.prototype.call,i=Object.prototype.hasOwnProperty,o=r(6743);e.exports=o.call(n,i);},251:function _(e,t){t.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,l=u>>1,c=-7,h=r?i-1:0,f=r?-1:1,d=e[t+h];for(h+=f,o=d&(1<<-c)-1,d>>=-c,c+=s;c>0;o=256*o+e[t+h],h+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=256*a+e[t+h],h+=f,c-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),o-=l;}return(d?-1:1)*a*Math.pow(2,o-n);},t.write=function(e,t,r,n,i,o){var a,s,u,l=8*o-i-1,c=(1<<l)-1,h=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,p=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(t*u-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,l+=i;l>0;e[r+d]=255&a,d+=p,a/=256,l-=8);e[r+d-p]|=128*y;};},4634:function _(e){var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e);};},8859:function _(e,t,r){var n="function"==typeof Map&&Map.prototype,i=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,o=n&&i&&"function"==typeof i.get?i.get:null,a=n&&Map.prototype.forEach,s="function"==typeof Set&&Set.prototype,u=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,l=s&&u&&"function"==typeof u.get?u.get:null,c=s&&Set.prototype.forEach,h="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,f="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,d="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,y=Object.prototype.toString,m=Function.prototype.toString,g=String.prototype.match,w=String.prototype.slice,b=String.prototype.replace,v=String.prototype.toUpperCase,x=String.prototype.toLowerCase,_=RegExp.prototype.test,S=Array.prototype.concat,T=Array.prototype.join,I=Array.prototype.slice,E=Math.floor,A="function"==typeof BigInt?BigInt.prototype.valueOf:null,C=Object.getOwnPropertySymbols,O="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?Symbol.prototype.toString:null,P="function"==typeof Symbol&&"object"==_typeof2(Symbol.iterator),k="function"==typeof Symbol&&Symbol.toStringTag&&(_typeof2(Symbol.toStringTag)===P||"symbol")?Symbol.toStringTag:null,R=Object.prototype.propertyIsEnumerable,B=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__;}:null);function $(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||_.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var n=e<0?-E(-e):E(e);if(n!==e){var i=String(n),o=w.call(t,i.length+1);return b.call(i,r,"$&_")+"."+b.call(b.call(o,/([0-9]{3})/g,"$&_"),/_$/,"");}}return b.call(t,r,"$&_");}var D=r(2634),M=D.custom,L=j(M)?M:null;function F(e,t,r){var n="double"===(r.quoteStyle||t)?'"':"'";return n+e+n;}function N(e){return b.call(String(e),/"/g,"&quot;");}function U(e){return!("[object Array]"!==H(e)||k&&"object"==_typeof2(e)&&k in e);}function G(e){return!("[object RegExp]"!==H(e)||k&&"object"==_typeof2(e)&&k in e);}function j(e){if(P)return e&&"object"==_typeof2(e)&&e instanceof Symbol;if("symbol"==_typeof2(e))return!0;if(!e||"object"!=_typeof2(e)||!O)return!1;try{return O.call(e),!0;}catch(e){}return!1;}e.exports=function e(t,n,i,s){var u=n||{};if(V(u,"quoteStyle")&&"single"!==u.quoteStyle&&"double"!==u.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(V(u,"maxStringLength")&&("number"==typeof u.maxStringLength?u.maxStringLength<0&&u.maxStringLength!==1/0:null!==u.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var y=!V(u,"customInspect")||u.customInspect;if("boolean"!=typeof y&&"symbol"!==y)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(V(u,"indent")&&null!==u.indent&&"\t"!==u.indent&&!(parseInt(u.indent,10)===u.indent&&u.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(V(u,"numericSeparator")&&"boolean"!=typeof u.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var v=u.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return Y(t,u);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var _=String(t);return v?$(t,_):_;}if("bigint"==typeof t){var E=String(t)+"n";return v?$(t,E):E;}var C=void 0===u.depth?5:u.depth;if(void 0===i&&(i=0),i>=C&&C>0&&"object"==_typeof2(t))return U(t)?"[Array]":"[Object]";var M=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;r=T.call(Array(e.indent+1)," ");}return{base:r,prev:T.call(Array(t+1),r)};}(u,i);if(void 0===s)s=[];else if(W(s,t)>=0)return"[Circular]";function z(t,r,n){if(r&&(s=I.call(s)).push(r),n){var o={depth:u.depth};return V(u,"quoteStyle")&&(o.quoteStyle=u.quoteStyle),e(t,o,i+1,s);}return e(t,u,i+1,s);}if("function"==typeof t&&!G(t)){var K=function(e){if(e.name)return e.name;var t=g.call(m.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null;}(t),ee=Q(t,z);return"[Function"+(K?": "+K:" (anonymous)")+"]"+(ee.length>0?" { "+T.call(ee,", ")+" }":"");}if(j(t)){var te=P?b.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):O.call(t);return"object"!=_typeof2(t)||P?te:X(te);}if(function(e){if(!e||"object"!=_typeof2(e))return!1;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute;}(t)){for(var re="<"+x.call(String(t.nodeName)),ne=t.attributes||[],ie=0;ie<ne.length;ie++)re+=" "+ne[ie].name+"="+F(N(ne[ie].value),"double",u);return re+=">",t.childNodes&&t.childNodes.length&&(re+="..."),re+="</"+x.call(String(t.nodeName))+">";}if(U(t)){if(0===t.length)return"[]";var oe=Q(t,z);return M&&!function(e){for(var t=0;t<e.length;t++)if(W(e[t],"\n")>=0)return!1;return!0;}(oe)?"["+J(oe,M)+"]":"[ "+T.call(oe,", ")+" ]";}if(function(e){return!("[object Error]"!==H(e)||k&&"object"==_typeof2(e)&&k in e);}(t)){var ae=Q(t,z);return"cause"in Error.prototype||!("cause"in t)||R.call(t,"cause")?0===ae.length?"["+String(t)+"]":"{ ["+String(t)+"] "+T.call(ae,", ")+" }":"{ ["+String(t)+"] "+T.call(S.call("[cause]: "+z(t.cause),ae),", ")+" }";}if("object"==_typeof2(t)&&y){if(L&&"function"==typeof t[L]&&D)return D(t,{depth:C-i});if("symbol"!==y&&"function"==typeof t.inspect)return t.inspect();}if(function(e){if(!o||!e||"object"!=_typeof2(e))return!1;try{o.call(e);try{l.call(e);}catch(e){return!0;}return e instanceof Map;}catch(e){}return!1;}(t)){var se=[];return a&&a.call(t,function(e,r){se.push(z(r,t,!0)+" => "+z(e,t));}),q("Map",o.call(t),se,M);}if(function(e){if(!l||!e||"object"!=_typeof2(e))return!1;try{l.call(e);try{o.call(e);}catch(e){return!0;}return e instanceof Set;}catch(e){}return!1;}(t)){var ue=[];return c&&c.call(t,function(e){ue.push(z(e,t));}),q("Set",l.call(t),ue,M);}if(function(e){if(!h||!e||"object"!=_typeof2(e))return!1;try{h.call(e,h);try{f.call(e,f);}catch(e){return!0;}return e instanceof WeakMap;}catch(e){}return!1;}(t))return Z("WeakMap");if(function(e){if(!f||!e||"object"!=_typeof2(e))return!1;try{f.call(e,f);try{h.call(e,h);}catch(e){return!0;}return e instanceof WeakSet;}catch(e){}return!1;}(t))return Z("WeakSet");if(function(e){if(!d||!e||"object"!=_typeof2(e))return!1;try{return d.call(e),!0;}catch(e){}return!1;}(t))return Z("WeakRef");if(function(e){return!("[object Number]"!==H(e)||k&&"object"==_typeof2(e)&&k in e);}(t))return X(z(Number(t)));if(function(e){if(!e||"object"!=_typeof2(e)||!A)return!1;try{return A.call(e),!0;}catch(e){}return!1;}(t))return X(z(A.call(t)));if(function(e){return!("[object Boolean]"!==H(e)||k&&"object"==_typeof2(e)&&k in e);}(t))return X(p.call(t));if(function(e){return!("[object String]"!==H(e)||k&&"object"==_typeof2(e)&&k in e);}(t))return X(z(String(t)));if("undefined"!=typeof window&&t===window)return"{ [object Window] }";if("undefined"!=typeof globalThis&&t===globalThis||void 0!==r.g&&t===r.g)return"{ [object globalThis] }";if(!function(e){return!("[object Date]"!==H(e)||k&&"object"==_typeof2(e)&&k in e);}(t)&&!G(t)){var le=Q(t,z),ce=B?B(t)===Object.prototype:t instanceof Object||t.constructor===Object,he=t instanceof Object?"":"null prototype",fe=!ce&&k&&Object(t)===t&&k in t?w.call(H(t),8,-1):he?"Object":"",de=(ce||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(fe||he?"["+T.call(S.call([],fe||[],he||[]),": ")+"] ":"");return 0===le.length?de+"{}":M?de+"{"+J(le,M)+"}":de+"{ "+T.call(le,", ")+" }";}return String(t);};var z=Object.prototype.hasOwnProperty||function(e){return e in this;};function V(e,t){return z.call(e,t);}function H(e){return y.call(e);}function W(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1;}function Y(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return Y(w.call(e,0,t.maxStringLength),t)+n;}return F(b.call(b.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,K),"single",t);}function K(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+v.call(t.toString(16));}function X(e){return"Object("+e+")";}function Z(e){return e+" { ? }";}function q(e,t,r,n){return e+" ("+t+") {"+(n?J(r,n):T.call(r,", "))+"}";}function J(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+T.call(e,","+r)+"\n"+t.prev;}function Q(e,t){var r=U(e),n=[];if(r){n.length=e.length;for(var i=0;i<e.length;i++)n[i]=V(e,i)?t(e[i],e):"";}var o,a="function"==typeof C?C(e):[];if(P){o={};for(var s=0;s<a.length;s++)o["$"+a[s]]=a[s];}for(var u in e)V(e,u)&&(r&&String(Number(u))===u&&u<e.length||P&&o["$"+u]instanceof Symbol||(_.call(/[^\w$]/,u)?n.push(t(u,e)+": "+t(e[u],e)):n.push(u+": "+t(e[u],e))));if("function"==typeof C)for(var l=0;l<a.length;l++)R.call(e,a[l])&&n.push("["+t(a[l])+"]: "+t(e[a[l]],e));return n;}},5606:function _(e){var t,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined");}function o(){throw new Error("clearTimeout has not been defined");}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0);}catch(r){try{return t.call(null,e,0);}catch(r){return t.call(this,e,0);}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i;}catch(e){t=i;}try{r="function"==typeof clearTimeout?clearTimeout:o;}catch(e){r=o;}}();var s,u=[],l=!1,c=-1;function h(){l&&s&&(l=!1,s.length?u=s.concat(u):c=-1,u.length&&f());}function f(){if(!l){var e=a(h);l=!0;for(var t=u.length;t;){for(s=u,u=[];++c<t;)s&&s[c].run();c=-1,t=u.length;}s=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e);}catch(t){try{return r.call(null,e);}catch(t){return r.call(this,e);}}}(e);}}function d(e,t){this.fun=e,this.array=t;}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new d(e,t)),1!==u.length||l||a(f);},d.prototype.run=function(){this.fun.apply(null,this.array);},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[];},n.binding=function(e){throw new Error("process.binding is not supported");},n.cwd=function(){return"/";},n.chdir=function(e){throw new Error("process.chdir is not supported");},n.umask=function(){return 0;};},9655:function _(e,t,r){var n;e=r.nmd(e),function(){t&&t.nodeType,e&&e.nodeType;var i="object"==_typeof2(r.g)&&r.g;i.global!==i&&i.window!==i&&i.self;var o,a=2147483647,s=36,u=/^xn--/,l=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,d=String.fromCharCode;function p(e){throw new RangeError(h[e]);}function y(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n;}function m(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+y((e=e.replace(c,".")).split("."),t).join(".");}function g(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n;}function w(e){return y(e,function(e){var t="";return e>65535&&(t+=d((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=d(e);}).join("");}function b(e,t){return e+22+75*(e<26)-((0!=t)<<5);}function v(e,t,r){var n=0;for(e=r?f(e/700):e>>1,e+=f(e/t);e>455;n+=s)e=f(e/35);return f(n+36*e/(e+38));}function x(e){var t,r,n,i,o,u,l,c,h,d,y,m=[],g=e.length,b=0,x=128,_=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&p("not-basic"),m.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<g;){for(o=b,u=1,l=s;i>=g&&p("invalid-input"),((c=(y=e.charCodeAt(i++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:s)>=s||c>f((a-b)/u))&&p("overflow"),b+=c*u,!(c<(h=l<=_?1:l>=_+26?26:l-_));l+=s)u>f(a/(d=s-h))&&p("overflow"),u*=d;_=v(b-o,t=m.length+1,0==o),f(b/t)>a-x&&p("overflow"),x+=f(b/t),b%=t,m.splice(b++,0,x);}return w(m);}function _(e){var t,r,n,i,o,u,l,c,h,y,m,w,x,_,S,T=[];for(w=(e=g(e)).length,t=128,r=0,o=72,u=0;u<w;++u)(m=e[u])<128&&T.push(d(m));for(n=i=T.length,i&&T.push("-");n<w;){for(l=a,u=0;u<w;++u)(m=e[u])>=t&&m<l&&(l=m);for(l-t>f((a-r)/(x=n+1))&&p("overflow"),r+=(l-t)*x,t=l,u=0;u<w;++u)if((m=e[u])<t&&++r>a&&p("overflow"),m==t){for(c=r,h=s;!(c<(y=h<=o?1:h>=o+26?26:h-o));h+=s)S=c-y,_=s-y,T.push(d(b(y+S%_,0))),c=f(S/_);T.push(d(b(c,0))),o=v(r,x,n==i),r=0,++n;}++r,++t;}return T.join("");}o={version:"1.4.1",ucs2:{decode:g,encode:w},decode:x,encode:_,toASCII:function toASCII(e){return m(e,function(e){return l.test(e)?"xn--"+_(e):e;});},toUnicode:function toUnicode(e){return m(e,function(e){return u.test(e)?x(e.slice(4).toLowerCase()):e;});}},void 0===(n=function(){return o;}.call(t,r,t,e))||(e.exports=n);}();},4765:function _(e){var t=String.prototype.replace,r=/%20/g,n="RFC1738",i="RFC3986";e.exports={"default":i,formatters:{RFC1738:function RFC1738(e){return t.call(e,r,"+");},RFC3986:function RFC3986(e){return String(e);}},RFC1738:n,RFC3986:i};},5373:function _(e,t,r){var n=r(8636),i=r(2642),o=r(4765);e.exports={formats:o,parse:i,stringify:n};},2642:function _(e,t,r){var n=r(7720),i=Object.prototype.hasOwnProperty,o=Array.isArray,a={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:n.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1},s=function s(e){return e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10));});},u=function u(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e;},l=function l(e,t,r,n){if(e){var o=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/g,s=r.depth>0&&/(\[[^[\]]*])/.exec(o),l=s?o.slice(0,s.index):o,c=[];if(l){if(!r.plainObjects&&i.call(Object.prototype,l)&&!r.allowPrototypes)return;c.push(l);}for(var h=0;r.depth>0&&null!==(s=a.exec(o))&&h<r.depth;){if(h+=1,!r.plainObjects&&i.call(Object.prototype,s[1].slice(1,-1))&&!r.allowPrototypes)return;c.push(s[1]);}if(s){if(!0===r.strictDepth)throw new RangeError("Input depth exceeded depth option of "+r.depth+" and strictDepth is true");c.push("["+o.slice(s.index)+"]");}return function(e,t,r,n){for(var i=n?t:u(t,r),o=e.length-1;o>=0;--o){var a,s=e[o];if("[]"===s&&r.parseArrays)a=r.allowEmptyArrays&&(""===i||r.strictNullHandling&&null===i)?[]:[].concat(i);else{a=r.plainObjects?Object.create(null):{};var l="["===s.charAt(0)&&"]"===s.charAt(s.length-1)?s.slice(1,-1):s,c=r.decodeDotInKeys?l.replace(/%2E/g,"."):l,h=parseInt(c,10);r.parseArrays||""!==c?!isNaN(h)&&s!==c&&String(h)===c&&h>=0&&r.parseArrays&&h<=r.arrayLimit?(a=[])[h]=i:"__proto__"!==c&&(a[c]=i):a={0:i};}i=a;}return i;}(c,t,r,n);}};e.exports=function(e,t){var r=function(e){if(!e)return a;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.decodeDotInKeys&&"boolean"!=typeof e.decodeDotInKeys)throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?a.charset:e.charset,r=void 0===e.duplicates?a.duplicates:e.duplicates;if("combine"!==r&&"first"!==r&&"last"!==r)throw new TypeError("The duplicates option must be either combine, first, or last");return{allowDots:void 0===e.allowDots?!0===e.decodeDotInKeys||a.allowDots:!!e.allowDots,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:a.allowEmptyArrays,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:a.allowPrototypes,allowSparse:"boolean"==typeof e.allowSparse?e.allowSparse:a.allowSparse,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:a.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:a.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:a.comma,decodeDotInKeys:"boolean"==typeof e.decodeDotInKeys?e.decodeDotInKeys:a.decodeDotInKeys,decoder:"function"==typeof e.decoder?e.decoder:a.decoder,delimiter:"string"==typeof e.delimiter||n.isRegExp(e.delimiter)?e.delimiter:a.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:a.depth,duplicates:r,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:a.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:a.plainObjects,strictDepth:"boolean"==typeof e.strictDepth?!!e.strictDepth:a.strictDepth,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:a.strictNullHandling};}(t);if(""===e||null==e)return r.plainObjects?Object.create(null):{};for(var c="string"==typeof e?function(e,t){var r={__proto__:null},l=t.ignoreQueryPrefix?e.replace(/^\?/,""):e;l=l.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var c,h=t.parameterLimit===1/0?void 0:t.parameterLimit,f=l.split(t.delimiter,h),d=-1,p=t.charset;if(t.charsetSentinel)for(c=0;c<f.length;++c)0===f[c].indexOf("utf8=")&&("utf8=%E2%9C%93"===f[c]?p="utf-8":"utf8=%26%2310003%3B"===f[c]&&(p="iso-8859-1"),d=c,c=f.length);for(c=0;c<f.length;++c)if(c!==d){var y,m,g=f[c],w=g.indexOf("]="),b=-1===w?g.indexOf("="):w+1;-1===b?(y=t.decoder(g,a.decoder,p,"key"),m=t.strictNullHandling?null:""):(y=t.decoder(g.slice(0,b),a.decoder,p,"key"),m=n.maybeMap(u(g.slice(b+1),t),function(e){return t.decoder(e,a.decoder,p,"value");})),m&&t.interpretNumericEntities&&"iso-8859-1"===p&&(m=s(m)),g.indexOf("[]=")>-1&&(m=o(m)?[m]:m);var v=i.call(r,y);v&&"combine"===t.duplicates?r[y]=n.combine(r[y],m):v&&"last"!==t.duplicates||(r[y]=m);}return r;}(e,r):e,h=r.plainObjects?Object.create(null):{},f=Object.keys(c),d=0;d<f.length;++d){var p=f[d],y=l(p,c[p],r,"string"==typeof e);h=n.merge(h,y,r);}return!0===r.allowSparse?h:n.compact(h);};},8636:function _(e,t,r){var n=r(920),i=r(7720),o=r(4765),a=Object.prototype.hasOwnProperty,s={brackets:function brackets(e){return e+"[]";},comma:"comma",indices:function indices(e,t){return e+"["+t+"]";},repeat:function repeat(e){return e;}},u=Array.isArray,l=Array.prototype.push,c=function c(e,t){l.apply(e,u(t)?t:[t]);},h=Date.prototype.toISOString,f=o["default"],d={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:i.encode,encodeValuesOnly:!1,format:f,formatter:o.formatters[f],indices:!1,serializeDate:function serializeDate(e){return h.call(e);},skipNulls:!1,strictNullHandling:!1},p={},y=function e(t,r,o,a,s,l,h,f,y,m,g,w,b,v,x,_,S,T){for(var I=t,E=T,A=0,C=!1;void 0!==(E=E.get(p))&&!C;){var O=E.get(t);if(A+=1,void 0!==O){if(O===A)throw new RangeError("Cyclic object value");C=!0;}void 0===E.get(p)&&(A=0);}if("function"==typeof m?I=m(r,I):I instanceof Date?I=b(I):"comma"===o&&u(I)&&(I=i.maybeMap(I,function(e){return e instanceof Date?b(e):e;})),null===I){if(l)return y&&!_?y(r,d.encoder,S,"key",v):r;I="";}if(function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||"symbol"==_typeof2(e)||"bigint"==typeof e;}(I)||i.isBuffer(I))return y?[x(_?r:y(r,d.encoder,S,"key",v))+"="+x(y(I,d.encoder,S,"value",v))]:[x(r)+"="+x(String(I))];var P,k=[];if(void 0===I)return k;if("comma"===o&&u(I))_&&y&&(I=i.maybeMap(I,y)),P=[{value:I.length>0?I.join(",")||null:void 0}];else if(u(m))P=m;else{var R=Object.keys(I);P=g?R.sort(g):R;}var B=f?r.replace(/\./g,"%2E"):r,$=a&&u(I)&&1===I.length?B+"[]":B;if(s&&u(I)&&0===I.length)return $+"[]";for(var D=0;D<P.length;++D){var M=P[D],L="object"==_typeof2(M)&&void 0!==M.value?M.value:I[M];if(!h||null!==L){var F=w&&f?M.replace(/\./g,"%2E"):M,N=u(I)?"function"==typeof o?o($,F):$:$+(w?"."+F:"["+F+"]");T.set(t,A);var U=n();U.set(p,T),c(k,e(L,N,o,a,s,l,h,f,"comma"===o&&_&&u(I)?null:y,m,g,w,b,v,x,_,S,U));}}return k;};e.exports=function(e,t){var r,i=e,l=function(e){if(!e)return d;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||d.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=o["default"];if(void 0!==e.format){if(!a.call(o.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format;}var n,i=o.formatters[r],l=d.filter;if(("function"==typeof e.filter||u(e.filter))&&(l=e.filter),n=e.arrayFormat in s?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":d.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var c=void 0===e.allowDots?!0===e.encodeDotInKeys||d.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:d.addQueryPrefix,allowDots:c,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:d.allowEmptyArrays,arrayFormat:n,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:d.charsetSentinel,commaRoundTrip:e.commaRoundTrip,delimiter:void 0===e.delimiter?d.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:d.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:d.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:d.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:d.encodeValuesOnly,filter:l,format:r,formatter:i,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:d.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:d.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:d.strictNullHandling};}(t);"function"==typeof l.filter?i=(0,l.filter)("",i):u(l.filter)&&(r=l.filter);var h=[];if("object"!=_typeof2(i)||null===i)return"";var f=s[l.arrayFormat],p="comma"===f&&l.commaRoundTrip;r||(r=Object.keys(i)),l.sort&&r.sort(l.sort);for(var m=n(),g=0;g<r.length;++g){var w=r[g];l.skipNulls&&null===i[w]||c(h,y(i[w],w,f,p,l.allowEmptyArrays,l.strictNullHandling,l.skipNulls,l.encodeDotInKeys,l.encode?l.encoder:null,l.filter,l.sort,l.allowDots,l.serializeDate,l.format,l.formatter,l.encodeValuesOnly,l.charset,m));}var b=h.join(l.delimiter),v=!0===l.addQueryPrefix?"?":"";return l.charsetSentinel&&("iso-8859-1"===l.charset?v+="utf8=%26%2310003%3B&":v+="utf8=%E2%9C%93&"),b.length>0?v+b:"";};},7720:function _(e,t,r){var n=r(4765),i=Object.prototype.hasOwnProperty,o=Array.isArray,a=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e;}(),s=function s(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r;},u=1024;e.exports={arrayToObject:s,assign:function assign(e,t){return Object.keys(t).reduce(function(e,r){return e[r]=t[r],e;},e);},combine:function combine(e,t){return[].concat(e,t);},compact:function compact(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var i=t[n],a=i.obj[i.prop],s=Object.keys(a),u=0;u<s.length;++u){var l=s[u],c=a[l];"object"==_typeof2(c)&&null!==c&&-1===r.indexOf(c)&&(t.push({obj:a,prop:l}),r.push(c));}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(o(r)){for(var n=[],i=0;i<r.length;++i)void 0!==r[i]&&n.push(r[i]);t.obj[t.prop]=n;}}}(t),e;},decode:function decode(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n);}catch(e){return n;}},encode:function encode(e,t,r,i,o){if(0===e.length)return e;var s=e;if("symbol"==_typeof2(e)?s=Symbol.prototype.toString.call(e):"string"!=typeof e&&(s=String(e)),"iso-8859-1"===r)return escape(s).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B";});for(var l="",c=0;c<s.length;c+=u){for(var h=s.length>=u?s.slice(c,c+u):s,f=[],d=0;d<h.length;++d){var p=h.charCodeAt(d);45===p||46===p||95===p||126===p||p>=48&&p<=57||p>=65&&p<=90||p>=97&&p<=122||o===n.RFC1738&&(40===p||41===p)?f[f.length]=h.charAt(d):p<128?f[f.length]=a[p]:p<2048?f[f.length]=a[192|p>>6]+a[128|63&p]:p<55296||p>=57344?f[f.length]=a[224|p>>12]+a[128|p>>6&63]+a[128|63&p]:(d+=1,p=65536+((1023&p)<<10|1023&h.charCodeAt(d)),f[f.length]=a[240|p>>18]+a[128|p>>12&63]+a[128|p>>6&63]+a[128|63&p]);}l+=f.join("");}return l;},isBuffer:function isBuffer(e){return!(!e||"object"!=_typeof2(e))&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e));},isRegExp:function isRegExp(e){return"[object RegExp]"===Object.prototype.toString.call(e);},maybeMap:function maybeMap(e,t){if(o(e)){for(var r=[],n=0;n<e.length;n+=1)r.push(t(e[n]));return r;}return t(e);},merge:function e(t,r,n){if(!r)return t;if("object"!=_typeof2(r)){if(o(t))t.push(r);else{if(!t||"object"!=_typeof2(t))return[t,r];(n&&(n.plainObjects||n.allowPrototypes)||!i.call(Object.prototype,r))&&(t[r]=!0);}return t;}if(!t||"object"!=_typeof2(t))return[t].concat(r);var a=t;return o(t)&&!o(r)&&(a=s(t,n)),o(t)&&o(r)?(r.forEach(function(r,o){if(i.call(t,o)){var a=t[o];a&&"object"==_typeof2(a)&&r&&"object"==_typeof2(r)?t[o]=e(a,r,n):t.push(r);}else t[o]=r;}),t):Object.keys(r).reduce(function(t,o){var a=r[o];return i.call(t,o)?t[o]=e(t[o],a,n):t[o]=a,t;},a);}};},6897:function _(e,t,r){var n=r(453),i=r(41),o=r(592)(),a=r(5795),s=r(9675),u=n("%Math.floor%");e.exports=function(e,t){if("function"!=typeof e)throw new s("`fn` is not a function");if("number"!=typeof t||t<0||t>4294967295||u(t)!==t)throw new s("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],n=!0,l=!0;if("length"in e&&a){var c=a(e,"length");c&&!c.configurable&&(n=!1),c&&!c.writable&&(l=!1);}return(n||l||!r)&&(o?i(e,"length",t,!0,!0):i(e,"length",t)),e;};},920:function _(e,t,r){var n=r(453),i=r(8075),o=r(8859),a=r(9675),s=n("%WeakMap%",!0),u=n("%Map%",!0),l=i("WeakMap.prototype.get",!0),c=i("WeakMap.prototype.set",!0),h=i("WeakMap.prototype.has",!0),f=i("Map.prototype.get",!0),d=i("Map.prototype.set",!0),p=i("Map.prototype.has",!0),y=function y(e,t){for(var r,n=e;null!==(r=n.next);n=r)if(r.key===t)return n.next=r.next,r.next=e.next,e.next=r,r;};e.exports=function(){var e,t,r,n={assert:function assert(e){if(!n.has(e))throw new a("Side channel does not contain "+o(e));},get:function get(n){if(s&&n&&("object"==_typeof2(n)||"function"==typeof n)){if(e)return l(e,n);}else if(u){if(t)return f(t,n);}else if(r)return function(e,t){var r=y(e,t);return r&&r.value;}(r,n);},has:function has(n){if(s&&n&&("object"==_typeof2(n)||"function"==typeof n)){if(e)return h(e,n);}else if(u){if(t)return p(t,n);}else if(r)return function(e,t){return!!y(e,t);}(r,n);return!1;},set:function set(n,i){s&&n&&("object"==_typeof2(n)||"function"==typeof n)?(e||(e=new s()),c(e,n,i)):u?(t||(t=new u()),d(t,n,i)):(r||(r={key:{},next:null}),function(e,t,r){var n=y(e,t);n?n.value=r:e.next={key:t,next:e.next,value:r};}(r,n,i));}};return n;};},8835:function _(e,t,r){var n=r(9655);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null;}var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(u),c=["%","/","?",";","#"].concat(l),h=["/","?","#"],f=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=r(5373);function w(e,t,r){if(e&&"object"==_typeof2(e)&&e instanceof i)return e;var n=new i();return n.parse(e,t,r),n;}i.prototype.parse=function(e,t,r){if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+_typeof2(e));var i=e.indexOf("?"),a=-1!==i&&i<e.indexOf("#")?"?":"#",u=e.split(a);u[0]=u[0].replace(/\\/g,"/");var w=e=u.join(a);if(w=w.trim(),!r&&1===e.split("#").length){var b=s.exec(w);if(b)return this.path=w,this.href=w,this.pathname=b[1],b[2]?(this.search=b[2],this.query=t?g.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this;}var v=o.exec(w);if(v){var x=(v=v[0]).toLowerCase();this.protocol=x,w=w.substr(v.length);}if(r||v||w.match(/^\/\/[^@/]+@[^@/]+/)){var _="//"===w.substr(0,2);!_||v&&y[v]||(w=w.substr(2),this.slashes=!0);}if(!y[v]&&(_||v&&!m[v])){for(var S,T,I=-1,E=0;E<h.length;E++){-1!==(A=w.indexOf(h[E]))&&(-1===I||A<I)&&(I=A);}-1!==(T=-1===I?w.lastIndexOf("@"):w.lastIndexOf("@",I))&&(S=w.slice(0,T),w=w.slice(T+1),this.auth=decodeURIComponent(S)),I=-1;for(E=0;E<c.length;E++){var A;-1!==(A=w.indexOf(c[E]))&&(-1===I||A<I)&&(I=A);}-1===I&&(I=w.length),this.host=w.slice(0,I),w=w.slice(I),this.parseHost(),this.hostname=this.hostname||"";var C="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!C)for(var O=this.hostname.split(/\./),P=(E=0,O.length);E<P;E++){var k=O[E];if(k&&!k.match(f)){for(var R="",B=0,$=k.length;B<$;B++)k.charCodeAt(B)>127?R+="x":R+=k[B];if(!R.match(f)){var D=O.slice(0,E),M=O.slice(E+1),L=k.match(d);L&&(D.push(L[1]),M.unshift(L[2])),M.length&&(w="/"+M.join(".")+w),this.hostname=D.join(".");break;}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),C||(this.hostname=n.toASCII(this.hostname));var F=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+F,this.href+=this.host,C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==w[0]&&(w="/"+w));}if(!p[x])for(E=0,P=l.length;E<P;E++){var U=l[E];if(-1!==w.indexOf(U)){var G=encodeURIComponent(U);G===U&&(G=escape(U)),w=w.split(U).join(G);}}var j=w.indexOf("#");-1!==j&&(this.hash=w.substr(j),w=w.slice(0,j));var z=w.indexOf("?");if(-1!==z?(this.search=w.substr(z),this.query=w.substr(z+1),t&&(this.query=g.parse(this.query)),w=w.slice(0,z)):t&&(this.search="",this.query={}),w&&(this.pathname=w),m[x]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){F=this.pathname||"";var V=this.search||"";this.path=F+V;}return this.href=this.format(),this;},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&"object"==_typeof2(this.query)&&Object.keys(this.query).length&&(o=g.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var a=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||m[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),t+i+(r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e);}))+(a=a.replace("#","%23"))+n;},i.prototype.resolve=function(e){return this.resolveObject(w(e,!1,!0)).format();},i.prototype.resolveObject=function(e){if("string"==typeof e){var t=new i();t.parse(e,!1,!0),e=t;}for(var r=new i(),n=Object.keys(this),o=0;o<n.length;o++){var a=n[o];r[a]=this[a];}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),u=0;u<s.length;u++){var l=s[u];"protocol"!==l&&(r[l]=e[l]);}return m[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r;}if(e.protocol&&e.protocol!==r.protocol){if(!m[e.protocol]){for(var c=Object.keys(e),h=0;h<c.length;h++){var f=c[h];r[f]=e[f];}return r.href=r.format(),r;}if(r.protocol=e.protocol,e.host||y[e.protocol])r.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),r.pathname=d.join("/");}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var p=r.pathname||"",g=r.search||"";r.path=p+g;}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r;}var w=r.pathname&&"/"===r.pathname.charAt(0),b=e.host||e.pathname&&"/"===e.pathname.charAt(0),v=b||w||r.host&&e.pathname,x=v,_=r.pathname&&r.pathname.split("/")||[],S=(d=e.pathname&&e.pathname.split("/")||[],r.protocol&&!m[r.protocol]);if(S&&(r.hostname="",r.port=null,r.host&&(""===_[0]?_[0]=r.host:_.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),v=v&&(""===d[0]||""===_[0])),b)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,_=d;else if(d.length)_||(_=[]),_.pop(),_=_.concat(d),r.search=e.search,r.query=e.query;else if(null!=e.search){if(S)r.host=_.shift(),r.hostname=r.host,(C=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=C.shift(),r.hostname=C.shift(),r.host=r.hostname);return r.search=e.search,r.query=e.query,null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r;}if(!_.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var T=_.slice(-1)[0],I=(r.host||e.host||_.length>1)&&("."===T||".."===T)||""===T,E=0,A=_.length;A>=0;A--)"."===(T=_[A])?_.splice(A,1):".."===T?(_.splice(A,1),E++):E&&(_.splice(A,1),E--);if(!v&&!x)for(;E--;E)_.unshift("..");!v||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),I&&"/"!==_.join("/").substr(-1)&&_.push("");var C,O=""===_[0]||_[0]&&"/"===_[0].charAt(0);S&&(r.hostname=O?"":_.length?_.shift():"",r.host=r.hostname,(C=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=C.shift(),r.hostname=C.shift(),r.host=r.hostname));return(v=v||r.host&&_.length)&&!O&&_.unshift(""),_.length>0?r.pathname=_.join("/"):(r.pathname=null,r.path=null),null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r;},i.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e);},t.qg=w,t.hd=function(e,t){return w(e,!1,!0).resolve(t);},t.GP=function(e){return"string"==typeof e&&(e=w(e)),e instanceof i?e.format():i.prototype.format.call(e);};},4788:function _(e){e.exports="data:application/javascript;base64,ZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkociwgZSkgeyByZXR1cm4gX2FycmF5V2l0aEhvbGVzKHIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChyLCBlKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkociwgZSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOyB9CmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0KZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KHIsIGwpIHsgdmFyIHQgPSBudWxsID09IHIgPyBudWxsIDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIFN5bWJvbCAmJiByW1N5bWJvbC5pdGVyYXRvcl0gfHwgclsiQEBpdGVyYXRvciJdOyBpZiAobnVsbCAhPSB0KSB7IHZhciBlLCBuLCBpLCB1LCBhID0gW10sIGYgPSAhMCwgbyA9ICExOyB0cnkgeyBpZiAoaSA9ICh0ID0gdC5jYWxsKHIpKS5uZXh0LCAwID09PSBsKSB7IGlmIChPYmplY3QodCkgIT09IHQpIHJldHVybjsgZiA9ICExOyB9IGVsc2UgZm9yICg7ICEoZiA9IChlID0gaS5jYWxsKHQpKS5kb25lKSAmJiAoYS5wdXNoKGUudmFsdWUpLCBhLmxlbmd0aCAhPT0gbCk7IGYgPSAhMCk7IH0gY2F0Y2ggKHIpIHsgbyA9ICEwLCBuID0gcjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFmICYmIG51bGwgIT0gdFsicmV0dXJuIl0gJiYgKHUgPSB0WyJyZXR1cm4iXSgpLCBPYmplY3QodSkgIT09IHUpKSByZXR1cm47IH0gZmluYWxseSB7IGlmIChvKSB0aHJvdyBuOyB9IH0gcmV0dXJuIGE7IH0gfQpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMocikgeyBpZiAoQXJyYXkuaXNBcnJheShyKSkgcmV0dXJuIHI7IH0KZnVuY3Rpb24gX2NvbnN0cnVjdCh0LCBlLCByKSB7IGlmIChfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkpIHJldHVybiBSZWZsZWN0LmNvbnN0cnVjdC5hcHBseShudWxsLCBhcmd1bWVudHMpOyB2YXIgbyA9IFtudWxsXTsgby5wdXNoLmFwcGx5KG8sIGUpOyB2YXIgcCA9IG5ldyAodC5iaW5kLmFwcGx5KHQsIG8pKSgpOyByZXR1cm4gciAmJiBfc2V0UHJvdG90eXBlT2YocCwgci5wcm90b3R5cGUpLCBwOyB9CmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZih0LCBlKSB7IHJldHVybiBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gKHQsIGUpIHsgcmV0dXJuIHQuX19wcm90b19fID0gZSwgdDsgfSwgX3NldFByb3RvdHlwZU9mKHQsIGUpOyB9CmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7IHRyeSB7IHZhciB0ID0gIUJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgfSBjYXRjaCAodCkge30gcmV0dXJuIChfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgcmV0dXJuICEhdDsgfSkoKTsgfQpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkocikgeyByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKHIpIHx8IF9pdGVyYWJsZVRvQXJyYXkocikgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KHIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOyB9CmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0KZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShyKSB7IGlmICgidW5kZWZpbmVkIiAhPSB0eXBlb2YgU3ltYm9sICYmIG51bGwgIT0gcltTeW1ib2wuaXRlcmF0b3JdIHx8IG51bGwgIT0gclsiQEBpdGVyYXRvciJdKSByZXR1cm4gQXJyYXkuZnJvbShyKTsgfQpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMocikgeyBpZiAoQXJyYXkuaXNBcnJheShyKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KHIpOyB9CmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShlLCByLCB0KSB7IHJldHVybiAociA9IF90b1Byb3BlcnR5S2V5KHIpKSBpbiBlID8gT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIHIsIHsgdmFsdWU6IHQsIGVudW1lcmFibGU6ICEwLCBjb25maWd1cmFibGU6ICEwLCB3cml0YWJsZTogITAgfSkgOiBlW3JdID0gdCwgZTsgfQpmdW5jdGlvbiBfdG9Qcm9wZXJ0eUtleSh0KSB7IHZhciBpID0gX3RvUHJpbWl0aXZlKHQsICJzdHJpbmciKTsgcmV0dXJuICJzeW1ib2wiID09IF90eXBlb2YoaSkgPyBpIDogaSArICIiOyB9CmZ1bmN0aW9uIF90b1ByaW1pdGl2ZSh0LCByKSB7IGlmICgib2JqZWN0IiAhPSBfdHlwZW9mKHQpIHx8ICF0KSByZXR1cm4gdDsgdmFyIGUgPSB0W1N5bWJvbC50b1ByaW1pdGl2ZV07IGlmICh2b2lkIDAgIT09IGUpIHsgdmFyIGkgPSBlLmNhbGwodCwgciB8fCAiZGVmYXVsdCIpOyBpZiAoIm9iamVjdCIgIT0gX3R5cGVvZihpKSkgcmV0dXJuIGk7IHRocm93IG5ldyBUeXBlRXJyb3IoIkBAdG9QcmltaXRpdmUgbXVzdCByZXR1cm4gYSBwcmltaXRpdmUgdmFsdWUuIik7IH0gcmV0dXJuICgic3RyaW5nIiA9PT0gciA/IFN0cmluZyA6IE51bWJlcikodCk7IH0KZnVuY3Rpb24gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIociwgZSkgeyB2YXIgdCA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBTeW1ib2wgJiYgcltTeW1ib2wuaXRlcmF0b3JdIHx8IHJbIkBAaXRlcmF0b3IiXTsgaWYgKCF0KSB7IGlmIChBcnJheS5pc0FycmF5KHIpIHx8ICh0ID0gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KHIpKSB8fCBlICYmIHIgJiYgIm51bWJlciIgPT0gdHlwZW9mIHIubGVuZ3RoKSB7IHQgJiYgKHIgPSB0KTsgdmFyIF9uNiA9IDAsIEYgPSBmdW5jdGlvbiBGKCkge307IHJldHVybiB7IHM6IEYsIG46IGZ1bmN0aW9uIG4oKSB7IHJldHVybiBfbjYgPj0gci5sZW5ndGggPyB7IGRvbmU6ICEwIH0gOiB7IGRvbmU6ICExLCB2YWx1ZTogcltfbjYrK10gfTsgfSwgZTogZnVuY3Rpb24gZShyKSB7IHRocm93IHI7IH0sIGY6IEYgfTsgfSB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gaXRlcmF0ZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0gdmFyIG8sIGEgPSAhMCwgdSA9ICExOyByZXR1cm4geyBzOiBmdW5jdGlvbiBzKCkgeyB0ID0gdC5jYWxsKHIpOyB9LCBuOiBmdW5jdGlvbiBuKCkgeyB2YXIgciA9IHQubmV4dCgpOyByZXR1cm4gYSA9IHIuZG9uZSwgcjsgfSwgZTogZnVuY3Rpb24gZShyKSB7IHUgPSAhMCwgbyA9IHI7IH0sIGY6IGZ1bmN0aW9uIGYoKSB7IHRyeSB7IGEgfHwgbnVsbCA9PSB0WyJyZXR1cm4iXSB8fCB0WyJyZXR1cm4iXSgpOyB9IGZpbmFsbHkgeyBpZiAodSkgdGhyb3cgbzsgfSB9IH07IH0KZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KHIsIGEpIHsgaWYgKHIpIHsgaWYgKCJzdHJpbmciID09IHR5cGVvZiByKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkociwgYSk7IHZhciB0ID0ge30udG9TdHJpbmcuY2FsbChyKS5zbGljZSg4LCAtMSk7IHJldHVybiAiT2JqZWN0IiA9PT0gdCAmJiByLmNvbnN0cnVjdG9yICYmICh0ID0gci5jb25zdHJ1Y3Rvci5uYW1lKSwgIk1hcCIgPT09IHQgfHwgIlNldCIgPT09IHQgPyBBcnJheS5mcm9tKHIpIDogIkFyZ3VtZW50cyIgPT09IHQgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QodCkgPyBfYXJyYXlMaWtlVG9BcnJheShyLCBhKSA6IHZvaWQgMDsgfSB9CmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KHIsIGEpIHsgKG51bGwgPT0gYSB8fCBhID4gci5sZW5ndGgpICYmIChhID0gci5sZW5ndGgpOyBmb3IgKHZhciBlID0gMCwgbiA9IEFycmF5KGEpOyBlIDwgYTsgZSsrKSBuW2VdID0gcltlXTsgcmV0dXJuIG47IH0KZnVuY3Rpb24gX3R5cGVvZihvKSB7ICJAYmFiZWwvaGVscGVycyAtIHR5cGVvZiI7IHJldHVybiBfdHlwZW9mID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPyBmdW5jdGlvbiAobykgeyByZXR1cm4gdHlwZW9mIG87IH0gOiBmdW5jdGlvbiAobykgeyByZXR1cm4gbyAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgby5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG8gIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvOyB9LCBfdHlwZW9mKG8pOyB9Ci8qISBGb3IgbGljZW5zZSBpbmZvcm1hdGlvbiBwbGVhc2Ugc2VlIGxvd0xpZ2h0LmpzLkxJQ0VOU0UudHh0ICovCihmdW5jdGlvbiAoKSB7CiAgInVzZSBzdHJpY3QiOwoKICBmdW5jdGlvbiB0KGUpIHsKICAgIHJldHVybiB0ID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IF90eXBlb2YoU3ltYm9sLml0ZXJhdG9yKSA/IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiBfdHlwZW9mKHQpOwogICAgfSA6IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiB0ICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiB0LmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgdCAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZih0KTsKICAgIH0sIHQoZSk7CiAgfQogIGZ1bmN0aW9uIGUodCwgZSkgewogICAgZm9yICh2YXIgYSA9IDA7IGEgPCBlLmxlbmd0aDsgYSsrKSB7CiAgICAgIHZhciByID0gZVthXTsKICAgICAgci5lbnVtZXJhYmxlID0gci5lbnVtZXJhYmxlIHx8ICExLCByLmNvbmZpZ3VyYWJsZSA9ICEwLCAidmFsdWUiIGluIHIgJiYgKHIud3JpdGFibGUgPSAhMCksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCBuKHIua2V5KSwgcik7CiAgICB9CiAgfQogIGZ1bmN0aW9uIG4oZSkgewogICAgdmFyIG4gPSBmdW5jdGlvbiAoZSwgbikgewogICAgICBpZiAoIm9iamVjdCIgIT0gdChlKSB8fCAhZSkgcmV0dXJuIGU7CiAgICAgIHZhciBhID0gZVtTeW1ib2wudG9QcmltaXRpdmVdOwogICAgICBpZiAodm9pZCAwICE9PSBhKSB7CiAgICAgICAgdmFyIHIgPSBhLmNhbGwoZSwgbiB8fCAiZGVmYXVsdCIpOwogICAgICAgIGlmICgib2JqZWN0IiAhPSB0KHIpKSByZXR1cm4gcjsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOwogICAgICB9CiAgICAgIHJldHVybiAoInN0cmluZyIgPT09IG4gPyBTdHJpbmcgOiBOdW1iZXIpKGUpOwogICAgfShlLCAic3RyaW5nIik7CiAgICByZXR1cm4gInN5bWJvbCIgPT0gdChuKSA/IG4gOiBuICsgIiI7CiAgfQogIHZhciBhID0gLjAwODg1NiwKICAgIHIgPSAxIC8gTWF0aC5zcXJ0KDIpLAogICAgbyA9IDEgLyBNYXRoLnNxcnQoMyksCiAgICBpID0gMSAvIE1hdGguc3FydCg2KSwKICAgIHUgPSBNYXRoLmxvZygxMCksCiAgICBsID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdCA9IGZ1bmN0aW9uIHQoKSB7CiAgICAgICAgIWZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICBpZiAoISh0IGluc3RhbmNlb2YgZSkpIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogICAgICAgIH0odGhpcywgdCk7CiAgICAgIH0sIGwgPSBbewogICAgICAgIGtleTogIlJHQnRvWFlaIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgdmFyIGUgPSB0LlIsCiAgICAgICAgICAgIG4gPSB0LkcsCiAgICAgICAgICAgIGEgPSB0LkI7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBYOiAuNDEyNDUzICogKGUgPSByKGUpKSArIC4zNTc1OCAqIChuID0gcihuKSkgKyAuMTgwNDIzICogKGEgPSByKGEpKSwKICAgICAgICAgICAgWTogLjIxMjY3MSAqIGUgKyAuNzE1MTYgKiBuICsgLjA3MjE2OSAqIGEsCiAgICAgICAgICAgIFo6IC4wMTkzMzQgKiBlICsgLjExOTE5MyAqIG4gKyAuOTUwMjI3ICogYQogICAgICAgICAgfTsKICAgICAgICAgIGZ1bmN0aW9uIHIodCkgewogICAgICAgICAgICByZXR1cm4gKHQgLz0gMjU1KSA+IC4wNDA0NSA/IE1hdGgucG93KCh0ICsgLjA1NSkgLyAxLjA1NSwgMi40KSA6IHQgLyAxMi45MjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJSR0J0b0NJRUxhYiIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQpIHsKICAgICAgICAgIHJldHVybiB0aGlzLlhZWnRvQ0lFTGFiKHRoaXMuUkdCdG9YWVoodCkpOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIlJHQnRvTE1TIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgdmFyIGUgPSB0LlIsCiAgICAgICAgICAgIG4gPSB0LkcsCiAgICAgICAgICAgIGEgPSB0LkI7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBMOiAuMzgxMSAqIGUgKyAuNTc4MyAqIG4gKyAuMDQwMiAqIGEsCiAgICAgICAgICAgIE06IC4xOTY3ICogZSArIC43MjQ0ICogbiArIC4wNzgyICogYSwKICAgICAgICAgICAgUzogLjAyNDEgKiBlICsgLjEyODggKiBuICsgLjg0NDQgKiBhCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIlJHQnRvTGFiIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuTE1TdG9MYWIodGhpcy5SR0J0b0xNUyh0KSk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiUkdCdG9ZIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgWTogKC4yOTkgKiB0LlIgKyAuNTg3ICogdC5HICsgLjExNCAqIHQuQikgLyAyNTUKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiWFladG9SR0IiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgICB2YXIgZSA9IHQuWCwKICAgICAgICAgICAgbiA9IHQuWSwKICAgICAgICAgICAgYSA9IHQuWiwKICAgICAgICAgICAgciA9IHUoMy4yNDA2ICogZSArIC0xLjUzNzIgKiBuICsgLS40OTg2ICogYSksCiAgICAgICAgICAgIG8gPSB1KC0uOTY4OSAqIGUgKyAxLjg3NTggKiBuICsgLjA0MTUgKiBhKSwKICAgICAgICAgICAgaSA9IHUoLjA1NTcgKiBlICsgLS4yMDQgKiBuICsgMS4wNTcgKiBhKTsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFI6IHMoMjU1ICogciksCiAgICAgICAgICAgIEc6IHMoMjU1ICogbyksCiAgICAgICAgICAgIEI6IHMoMjU1ICogaSkKICAgICAgICAgIH07CiAgICAgICAgICBmdW5jdGlvbiB1KHQpIHsKICAgICAgICAgICAgcmV0dXJuIHQgPiAuMDAzMTMwOCA/IDEuMDU1ICogTWF0aC5wb3codCwgMSAvIDIuNCkgLSAuMDU1IDogMTIuOTIgKiB0OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIlhZWnRvQ0lFTGFiIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgdmFyIGUgPSB0LlgsCiAgICAgICAgICAgIG4gPSB0LlksCiAgICAgICAgICAgIHIgPSB0LlosCiAgICAgICAgICAgIG8gPSAhKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzFdKSB8fCBhcmd1bWVudHNbMV0sCiAgICAgICAgICAgIGkgPSBuID4gYSA/IDExNiAqIE1hdGgucG93KG4sIDEgLyAzKSAtIDE2IDogOTAzLjMgKiBuLAogICAgICAgICAgICB1ID0gNTAwICogKHMoZSkgLSBzKG4pKSwKICAgICAgICAgICAgbCA9IDIwMCAqIChzKG4pIC0gcyhyKSk7CiAgICAgICAgICByZXR1cm4gbyA/IHRoaXMubm9ybWFsaXplQ0lFTGFiKHsKICAgICAgICAgICAgTDogaSwKICAgICAgICAgICAgYTogdSwKICAgICAgICAgICAgYjogbAogICAgICAgICAgfSkgOiB7CiAgICAgICAgICAgIEw6IGksCiAgICAgICAgICAgIGE6IHUsCiAgICAgICAgICAgIGI6IGwKICAgICAgICAgIH07CiAgICAgICAgICBmdW5jdGlvbiBzKHQpIHsKICAgICAgICAgICAgcmV0dXJuIHQgPiBhID8gTWF0aC5wb3codCwgMSAvIDMpIDogNy43ODcgKiB0ICsgMTYgLyAxMTY7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiQ0lFTGFidG9YWVoiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgICB2YXIgZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzFdICYmICFhcmd1bWVudHNbMV0gPyB0IDogdGhpcy5ub3JtYWxpemVCYWNrQ0lFTGFiKHQpLAogICAgICAgICAgICBuID0gZS5MLAogICAgICAgICAgICByID0gZS5hLAogICAgICAgICAgICBvID0gZS5iLAogICAgICAgICAgICBpID0gKG4gKyAxNikgLyAxMTYsCiAgICAgICAgICAgIHUgPSBzKHIgLyA1MDAgKyBpKSwKICAgICAgICAgICAgbCA9IHMoaSAtIG8gLyAyMDApOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgWDogdSwKICAgICAgICAgICAgWTogcyhpKSwKICAgICAgICAgICAgWjogbAogICAgICAgICAgfTsKICAgICAgICAgIGZ1bmN0aW9uIHModCkgewogICAgICAgICAgICB2YXIgZSA9IE1hdGgucG93KHQsIDMpOwogICAgICAgICAgICByZXR1cm4gZSA+IGEgPyBlIDogKHQgLSAxNiAvIDExNikgLyA3Ljc4NzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJDSUVMYWJ0b1JHQiIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQpIHsKICAgICAgICAgIHJldHVybiB0aGlzLlhZWnRvUkdCKHRoaXMuQ0lFTGFidG9YWVoodCkpOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIm5vcm1hbGl6ZUNJRUxhYiIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIEw6IHQuTCAvIDEwMCwKICAgICAgICAgICAgYTogKHQuYSArIDEyOCkgLyAyNTUsCiAgICAgICAgICAgIGI6ICh0LmIgKyAxMjgpIC8gMjU1CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIm5vcm1hbGl6ZUJhY2tDSUVMYWIiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgICB2YXIgZSA9IHQuTCwKICAgICAgICAgICAgbiA9IHQuYSwKICAgICAgICAgICAgYSA9IHQuYjsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIEw6IE1hdGgubWluKDEwMCwgTWF0aC5tYXgoMCwgMTAwICogZSkpLAogICAgICAgICAgICBhOiBNYXRoLm1pbigxMjcsIE1hdGgubWF4KC0xMjcsIDI1NSAqIG4gLSAxMjgpKSwKICAgICAgICAgICAgYjogTWF0aC5taW4oMTI3LCBNYXRoLm1heCgtMTI3LCAyNTUgKiBhIC0gMTI4KSkKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiTE1TdG9SR0IiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgICB2YXIgZSA9IHQuTCwKICAgICAgICAgICAgbiA9IHQuTSwKICAgICAgICAgICAgYSA9IHQuUzsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIFI6IHMoNC40Njg2ICogZSAtIDMuNTg4NiAqIG4gKyAuMTE5NiAqIGEpLAogICAgICAgICAgICBHOiBzKC0xLjIxOTcgKiBlICsgMi4zODMgKiBuIC0gLjE2MjYgKiBhKSwKICAgICAgICAgICAgQjogcyguMDU4NSAqIGUgLSAuMjYxICogbiArIDEuMjA1NiAqIGEpCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIkxNU3RvTGFiIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgdmFyIGUgPSB0LkwsCiAgICAgICAgICAgIG4gPSB0Lk0sCiAgICAgICAgICAgIGEgPSB0LlM7CiAgICAgICAgICByZXR1cm4gZSAmJiAoZSA9IE1hdGgubG9nKGUpIC8gdSksIG4gJiYgKG4gPSBNYXRoLmxvZyhuKSAvIHUpLCBhICYmIChhID0gTWF0aC5sb2coYSkgLyB1KSwgewogICAgICAgICAgICBMOiAoZSArIG4gKyBhKSAqIG8sCiAgICAgICAgICAgIGE6IChlICsgbiAtIDIgKiBhKSAqIGksCiAgICAgICAgICAgIGI6IChlIC0gbikgKiByCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGtleTogIkxhYnRvUkdCIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuTE1TdG9SR0IodGhpcy5MYWJ0b0xNUyh0KSk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiTGFidG9MTVMiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgICB2YXIgZSA9IHQuTCwKICAgICAgICAgICAgbiA9IHQuYSwKICAgICAgICAgICAgYSA9IHQuYjsKICAgICAgICAgIHJldHVybiBlICo9IG8sIG4gKj0gaSwgYSAqPSByLCB7CiAgICAgICAgICAgIEw6IE1hdGgucG93KDEwLCBlICsgbiArIGEpLAogICAgICAgICAgICBNOiBNYXRoLnBvdygxMCwgZSArIG4gLSBhKSwKICAgICAgICAgICAgUzogTWF0aC5wb3coMTAsIGUgLSAyICogbikKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9XSwgKG4gPSBudWxsKSAmJiBlKHQucHJvdG90eXBlLCBuKSwgbCAmJiBlKHQsIGwpLCBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgInByb3RvdHlwZSIsIHsKICAgICAgICB3cml0YWJsZTogITEKICAgICAgfSksIHQ7CiAgICAgIHZhciB0LCBuLCBsOwogICAgfSgpOwogIGZ1bmN0aW9uIHModCkgewogICAgcmV0dXJuIE1hdGgubWluKDI1NSwgTWF0aC5tYXgoMCwgdCkpOwogIH0KICBmdW5jdGlvbiBjKHQpIHsKICAgIHJldHVybiBjID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IF90eXBlb2YoU3ltYm9sLml0ZXJhdG9yKSA/IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiBfdHlwZW9mKHQpOwogICAgfSA6IGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiB0ICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiB0LmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgdCAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZih0KTsKICAgIH0sIGModCk7CiAgfQogIGZ1bmN0aW9uIGYodCwgZSkgewogICAgZm9yICh2YXIgbiA9IDA7IG4gPCBlLmxlbmd0aDsgbisrKSB7CiAgICAgIHZhciBhID0gZVtuXTsKICAgICAgYS5lbnVtZXJhYmxlID0gYS5lbnVtZXJhYmxlIHx8ICExLCBhLmNvbmZpZ3VyYWJsZSA9ICEwLCAidmFsdWUiIGluIGEgJiYgKGEud3JpdGFibGUgPSAhMCksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCBoKGEua2V5KSwgYSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGgodCkgewogICAgdmFyIGUgPSBmdW5jdGlvbiAodCwgZSkgewogICAgICBpZiAoIm9iamVjdCIgIT0gYyh0KSB8fCAhdCkgcmV0dXJuIHQ7CiAgICAgIHZhciBuID0gdFtTeW1ib2wudG9QcmltaXRpdmVdOwogICAgICBpZiAodm9pZCAwICE9PSBuKSB7CiAgICAgICAgdmFyIGEgPSBuLmNhbGwodCwgZSB8fCAiZGVmYXVsdCIpOwogICAgICAgIGlmICgib2JqZWN0IiAhPSBjKGEpKSByZXR1cm4gYTsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOwogICAgICB9CiAgICAgIHJldHVybiAoInN0cmluZyIgPT09IGUgPyBTdHJpbmcgOiBOdW1iZXIpKHQpOwogICAgfSh0LCAic3RyaW5nIik7CiAgICByZXR1cm4gInN5bWJvbCIgPT0gYyhlKSA/IGUgOiBlICsgIiI7CiAgfQogIHZhciB2ID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHQgPSBmdW5jdGlvbiB0KGUpIHsKICAgICAgIWZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIGUpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICAgICAgfSh0aGlzLCB0KSwgdGhpcy5hQXZlcmFnZSA9IHt9LCB0aGlzLnN0ZERldiA9IHt9LCB0aGlzLnN1bSA9IHt9LCB0aGlzLnN1bVNxciA9IHt9LCB0aGlzLnBpeGVsc0NvdW50ID0gZTsKICAgIH0sIChlID0gW3sKICAgICAga2V5OiAiYWRkUGl4ZWwiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCkgewogICAgICAgIHZhciBlID0gdGhpczsKICAgICAgICBPYmplY3Qua2V5cyh0KS5mb3JFYWNoKGZ1bmN0aW9uIChuKSB7CiAgICAgICAgICB2YXIgYSwgcjsKICAgICAgICAgIGUuc3VtW25dID0gKG51bGwgIT09IChhID0gZS5zdW1bbl0pICYmIHZvaWQgMCAhPT0gYSA/IGEgOiAwKSArIHRbbl0sIGUuc3VtU3FyW25dID0gKG51bGwgIT09IChyID0gZS5zdW1TcXJbbl0pICYmIHZvaWQgMCAhPT0gciA/IHIgOiAwKSArIE1hdGgucG93KHRbbl0sIDIpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImNvdW50QXZlcmFnZSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICB2YXIgdCA9IHRoaXM7CiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuc3VtKS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICB2YXIgbjsKICAgICAgICAgIHQuYUF2ZXJhZ2VbZV0gPSAobnVsbCAhPT0gKG4gPSB0LnN1bVtlXSkgJiYgdm9pZCAwICE9PSBuID8gbiA6IDApIC8gdC5waXhlbHNDb3VudDsKICAgICAgICB9KSwgdGhpcy5hQXZlcmFnZTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJjb3VudFN0ZERldiIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICB2YXIgdCA9IHRoaXM7CiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuc3VtU3FyKS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICB2YXIgbiwKICAgICAgICAgICAgYSwKICAgICAgICAgICAgciA9IChudWxsICE9PSAobiA9IHQuc3VtU3FyW2VdKSAmJiB2b2lkIDAgIT09IG4gPyBuIDogMCkgLSB0LnBpeGVsc0NvdW50ICogTWF0aC5wb3cobnVsbCAhPT0gKGEgPSB0LmFBdmVyYWdlW2VdKSAmJiB2b2lkIDAgIT09IGEgPyBhIDogMCwgMik7CiAgICAgICAgICB0LnN0ZERldltlXSA9IE1hdGguc3FydCgrci50b0ZpeGVkKDUpIC8gKHQucGl4ZWxzQ291bnQgLSAxKSk7CiAgICAgICAgfSksIHRoaXMuc3RkRGV2OwogICAgICB9CiAgICB9XSkgJiYgZih0LnByb3RvdHlwZSwgZSksIG4gJiYgZih0LCBuKSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsICJwcm90b3R5cGUiLCB7CiAgICAgIHdyaXRhYmxlOiAhMQogICAgfSksIHQ7CiAgICB2YXIgdCwgZSwgbjsKICB9KCk7CiAgZnVuY3Rpb24gYih0KSB7CiAgICByZXR1cm4gYiA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiAic3ltYm9sIiA9PSBfdHlwZW9mKFN5bWJvbC5pdGVyYXRvcikgPyBmdW5jdGlvbiAodCkgewogICAgICByZXR1cm4gX3R5cGVvZih0KTsKICAgIH0gOiBmdW5jdGlvbiAodCkgewogICAgICByZXR1cm4gdCAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgdC5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIHQgIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IF90eXBlb2YodCk7CiAgICB9LCBiKHQpOwogIH0KICBmdW5jdGlvbiB5KHQsIGUpIHsKICAgIGZvciAodmFyIG4gPSAwOyBuIDwgZS5sZW5ndGg7IG4rKykgewogICAgICB2YXIgYSA9IGVbbl07CiAgICAgIGEuZW51bWVyYWJsZSA9IGEuZW51bWVyYWJsZSB8fCAhMSwgYS5jb25maWd1cmFibGUgPSAhMCwgInZhbHVlIiBpbiBhICYmIChhLndyaXRhYmxlID0gITApLCBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgbShhLmtleSksIGEpOwogICAgfQogIH0KICBmdW5jdGlvbiBtKHQpIHsKICAgIHZhciBlID0gZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgaWYgKCJvYmplY3QiICE9IGIodCkgfHwgIXQpIHJldHVybiB0OwogICAgICB2YXIgbiA9IHRbU3ltYm9sLnRvUHJpbWl0aXZlXTsKICAgICAgaWYgKHZvaWQgMCAhPT0gbikgewogICAgICAgIHZhciBhID0gbi5jYWxsKHQsIGUgfHwgImRlZmF1bHQiKTsKICAgICAgICBpZiAoIm9iamVjdCIgIT0gYihhKSkgcmV0dXJuIGE7CiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS4iKTsKICAgICAgfQogICAgICByZXR1cm4gKCJzdHJpbmciID09PSBlID8gU3RyaW5nIDogTnVtYmVyKSh0KTsKICAgIH0odCwgInN0cmluZyIpOwogICAgcmV0dXJuICJzeW1ib2wiID09IGIoZSkgPyBlIDogZSArICIiOwogIH0KICB2YXIgcCA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0ID0gZnVuY3Rpb24gdChlKSB7CiAgICAgICFmdW5jdGlvbiAodCwgZSkgewogICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBlKSkgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgICAgIH0odGhpcywgdCksIHRoaXMuZGF0YVJHQmEgPSBlLCB0aGlzLnBpeGVsc0NvdW50ID0gZS5sZW5ndGggLyA0LCB0aGlzLmNoYW5uZWxzQ0lFTGFiID0gbmV3IHYodGhpcy5waXhlbHNDb3VudCksIHRoaXMuY2hhbm5lbHNMYWIgPSBuZXcgdih0aGlzLnBpeGVsc0NvdW50KSwgdGhpcy5jaGFubmVsc1kgPSBuZXcgdih0aGlzLnBpeGVsc0NvdW50KTsKICAgIH0sIChlID0gW3sKICAgICAga2V5OiAiY291bnRBdmVyYWdlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgIHRoaXMuY2hhbm5lbHNDSUVMYWIuY291bnRBdmVyYWdlKCksIHRoaXMuY2hhbm5lbHNMYWIuY291bnRBdmVyYWdlKCksIHRoaXMuY2hhbm5lbHNZLmNvdW50QXZlcmFnZSgpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImNvdW50U3RkRGV2IiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgIHRoaXMuY2hhbm5lbHNDSUVMYWIuY291bnRTdGREZXYoKSwgdGhpcy5jaGFubmVsc0xhYi5jb3VudFN0ZERldigpLCB0aGlzLmNoYW5uZWxzWS5jb3VudFN0ZERldigpOwogICAgICB9CiAgICB9XSkgJiYgeSh0LnByb3RvdHlwZSwgZSksIG4gJiYgeSh0LCBuKSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsICJwcm90b3R5cGUiLCB7CiAgICAgIHdyaXRhYmxlOiAhMQogICAgfSksIHQ7CiAgICB2YXIgdCwgZSwgbjsKICB9KCk7CiAgZnVuY3Rpb24gTCh0KSB7CiAgICByZXR1cm4gTCA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiAic3ltYm9sIiA9PSBfdHlwZW9mKFN5bWJvbC5pdGVyYXRvcikgPyBmdW5jdGlvbiAodCkgewogICAgICByZXR1cm4gX3R5cGVvZih0KTsKICAgIH0gOiBmdW5jdGlvbiAodCkgewogICAgICByZXR1cm4gdCAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgdC5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIHQgIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IF90eXBlb2YodCk7CiAgICB9LCBMKHQpOwogIH0KICBmdW5jdGlvbiBkKHQsIGUpIHsKICAgIGZvciAodmFyIG4gPSAwOyBuIDwgZS5sZW5ndGg7IG4rKykgewogICAgICB2YXIgYSA9IGVbbl07CiAgICAgIGEuZW51bWVyYWJsZSA9IGEuZW51bWVyYWJsZSB8fCAhMSwgYS5jb25maWd1cmFibGUgPSAhMCwgInZhbHVlIiBpbiBhICYmIChhLndyaXRhYmxlID0gITApLCBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgZyhhLmtleSksIGEpOwogICAgfQogIH0KICBmdW5jdGlvbiBnKHQpIHsKICAgIHZhciBlID0gZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgaWYgKCJvYmplY3QiICE9IEwodCkgfHwgIXQpIHJldHVybiB0OwogICAgICB2YXIgbiA9IHRbU3ltYm9sLnRvUHJpbWl0aXZlXTsKICAgICAgaWYgKHZvaWQgMCAhPT0gbikgewogICAgICAgIHZhciBhID0gbi5jYWxsKHQsIGUgfHwgImRlZmF1bHQiKTsKICAgICAgICBpZiAoIm9iamVjdCIgIT0gTChhKSkgcmV0dXJuIGE7CiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS4iKTsKICAgICAgfQogICAgICByZXR1cm4gKCJzdHJpbmciID09PSBlID8gU3RyaW5nIDogTnVtYmVyKSh0KTsKICAgIH0odCwgInN0cmluZyIpOwogICAgcmV0dXJuICJzeW1ib2wiID09IEwoZSkgPyBlIDogZSArICIiOwogIH0KICB2YXIgRSA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0ID0gZnVuY3Rpb24gdCgpIHsKICAgICAgIWZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIGUpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICAgICAgfSh0aGlzLCB0KSwgdGhpcy5kZWZhdWx0TFVUMzZfUkdCID0gdGhpcy5nZW5lcmF0ZURlZmF1bHRMVVQzNl9SR0IoKSwgdGhpcy5kZWZhdWx0TFVUMzZfQ0lFTGFiID0gdGhpcy5nZW5lcmF0ZURlZmF1bHRMVVQzNl9DSUVMYWIodGhpcy5kZWZhdWx0TFVUMzZfUkdCKSwgdGhpcy5kZWZhdWx0TFVUMzZfTGFiID0gdGhpcy5nZW5lcmF0ZURlZmF1bHRMVVQzNl9MYWIodGhpcy5kZWZhdWx0TFVUMzZfUkdCKSwgdGhpcy5kZWZhdWx0TFVUMzZfWSA9IHRoaXMuZ2VuZXJhdGVEZWZhdWx0TFVUMzZfWSh0aGlzLmRlZmF1bHRMVVQzNl9SR0IpOwogICAgfSwgZSA9IFt7CiAgICAgIGtleTogInByb2Nlc3MiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCwgZSkgewogICAgICAgIGZvciAodmFyIG4gPSB0aGlzLCBhID0gbmV3IHAodCksIHIgPSBuZXcgcChlKSwgbyA9IDA7IG8gPCBhLmRhdGFSR0JhLmxlbmd0aDsgbyArPSA0KSB7CiAgICAgICAgICB2YXIgaSA9IHsKICAgICAgICAgICAgICBSOiBhLmRhdGFSR0JhW28gKyAwXSwKICAgICAgICAgICAgICBHOiBhLmRhdGFSR0JhW28gKyAxXSwKICAgICAgICAgICAgICBCOiBhLmRhdGFSR0JhW28gKyAyXQogICAgICAgICAgICB9LAogICAgICAgICAgICB1ID0gewogICAgICAgICAgICAgIFI6IHIuZGF0YVJHQmFbbyArIDBdLAogICAgICAgICAgICAgIEc6IHIuZGF0YVJHQmFbbyArIDFdLAogICAgICAgICAgICAgIEI6IHIuZGF0YVJHQmFbbyArIDJdCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHMgPSBsLlJHQnRvQ0lFTGFiKGkpLAogICAgICAgICAgICBjID0gbC5SR0J0b0NJRUxhYih1KTsKICAgICAgICAgIGEuY2hhbm5lbHNDSUVMYWIuYWRkUGl4ZWwocyksIHIuY2hhbm5lbHNDSUVMYWIuYWRkUGl4ZWwoYyk7CiAgICAgICAgICB2YXIgZiA9IGwuUkdCdG9MYWIoaSksCiAgICAgICAgICAgIGggPSBsLlJHQnRvTGFiKHUpOwogICAgICAgICAgYS5jaGFubmVsc0xhYi5hZGRQaXhlbChmKSwgci5jaGFubmVsc0xhYi5hZGRQaXhlbChoKTsKICAgICAgICAgIHZhciB2ID0gbC5SR0J0b1koaSksCiAgICAgICAgICAgIGIgPSBsLlJHQnRvWSh1KTsKICAgICAgICAgIGEuY2hhbm5lbHNZLmFkZFBpeGVsKHYpLCByLmNoYW5uZWxzWS5hZGRQaXhlbChiKTsKICAgICAgICB9CiAgICAgICAgYS5jb3VudEF2ZXJhZ2UoKSwgci5jb3VudEF2ZXJhZ2UoKSwgYS5jb3VudFN0ZERldigpLCByLmNvdW50U3RkRGV2KCk7CiAgICAgICAgZm9yICh2YXIgeSA9IFtdLCBtID0gZnVuY3Rpb24gbSgpIHsKICAgICAgICAgICAgdmFyIHQgPSBuLm1lcmdlKG4uZGVmYXVsdExVVDM2X0NJRUxhYlszICogTCArIDBdLCAiTCIsIGEuY2hhbm5lbHNDSUVMYWIsIHIuY2hhbm5lbHNDSUVMYWIsICEwKSwKICAgICAgICAgICAgICBlID0gbi5tZXJnZShuLmRlZmF1bHRMVVQzNl9DSUVMYWJbMyAqIEwgKyAxXSwgImEiLCBhLmNoYW5uZWxzQ0lFTGFiLCByLmNoYW5uZWxzQ0lFTGFiLCAhMCksCiAgICAgICAgICAgICAgbyA9IG4ubWVyZ2Uobi5kZWZhdWx0TFVUMzZfQ0lFTGFiWzMgKiBMICsgMl0sICJiIiwgYS5jaGFubmVsc0NJRUxhYiwgci5jaGFubmVsc0NJRUxhYiwgITApLAogICAgICAgICAgICAgIGkgPSBsLkNJRUxhYnRvUkdCKHsKICAgICAgICAgICAgICAgIEw6IHQsCiAgICAgICAgICAgICAgICBhOiBlLAogICAgICAgICAgICAgICAgYjogbwogICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgIHUgPSBuLm1lcmdlKG4uZGVmYXVsdExVVDM2X0xhYlszICogTCArIDBdLCAiTCIsIGEuY2hhbm5lbHNMYWIsIHIuY2hhbm5lbHNMYWIpLAogICAgICAgICAgICAgIHMgPSBuLm1lcmdlKG4uZGVmYXVsdExVVDM2X0xhYlszICogTCArIDFdLCAiYSIsIGEuY2hhbm5lbHNMYWIsIHIuY2hhbm5lbHNMYWIpLAogICAgICAgICAgICAgIGMgPSBuLm1lcmdlKG4uZGVmYXVsdExVVDM2X0xhYlszICogTCArIDJdLCAiYiIsIGEuY2hhbm5lbHNMYWIsIHIuY2hhbm5lbHNMYWIpLAogICAgICAgICAgICAgIGYgPSBsLkxhYnRvUkdCKHsKICAgICAgICAgICAgICAgIEw6IHUsCiAgICAgICAgICAgICAgICBhOiBzLAogICAgICAgICAgICAgICAgYjogYwogICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgIGggPSBuLm1peChpLCBmLCAuNiksCiAgICAgICAgICAgICAgdiA9IG4ubWVyZ2Uobi5kZWZhdWx0TFVUMzZfWVtMXSwgIlkiLCBhLmNoYW5uZWxzWSwgci5jaGFubmVsc1ksICEwKSwKICAgICAgICAgICAgICBiID0gbC5SR0J0b1koaCkuWSwKICAgICAgICAgICAgICBtID0gZnVuY3Rpb24gbSh0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5taW4oMjU1LCB0ICogdiAvIE1hdGgubWF4KGIsIDEgLyAyNTUpKTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHAgPSB7CiAgICAgICAgICAgICAgICBSOiBtKGguUiksCiAgICAgICAgICAgICAgICBHOiBtKGguRyksCiAgICAgICAgICAgICAgICBCOiBtKGguQikKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGQgPSB7CiAgICAgICAgICAgICAgICBSOiAyNTUgKiBuLmRlZmF1bHRMVVQzNl9ZW0xdLAogICAgICAgICAgICAgICAgRzogMjU1ICogbi5kZWZhdWx0TFVUMzZfWVtMXSwKICAgICAgICAgICAgICAgIEI6IDI1NSAqIG4uZGVmYXVsdExVVDM2X1lbTF0KICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGcgPSBuLm1peChwLCBkLCAuOSk7CiAgICAgICAgICAgIHkucHVzaChnLlIsIGcuRywgZy5CLCAyNTUpOwogICAgICAgICAgfSwgTCA9IDA7IEwgPCB0aGlzLmRlZmF1bHRMVVQzNl9SR0IubGVuZ3RoIC8gMzsgTCsrKSBtKCk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIE5FV19MVVQzNl9SR0JhX1RJTlRFRDogeQogICAgICAgIH07CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZ2VuZXJhdGVEZWZhdWx0TFVUMzZfUkdCIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgIGZvciAodmFyIHQgPSAzNiwgZSA9IE1hdGgucG93KDIxNiwgMiksIG4gPSAyNTUgLyB0LCBhID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KDMgKiBlKSwgciA9IDA7IHIgPCBlOyByKyspIHsKICAgICAgICAgIHZhciBvID0gaShyLCA2LCB0KTsKICAgICAgICAgIGFbMyAqIHIgKyAwXSA9IHIgJSB0ICogbiwgYVszICogciArIDFdID0gTWF0aC50cnVuYyhyIC8gMjE2ICUgdCkgKiBuLCBhWzMgKiByICsgMl0gPSBvICogKDI1NSAvIDM2KTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGE7CiAgICAgICAgZnVuY3Rpb24gaSh0LCBlLCBuKSB7CiAgICAgICAgICB2YXIgYSA9IE1hdGgudHJ1bmModCAvIG4pICUgZTsKICAgICAgICAgIHJldHVybiBlICogTWF0aC50cnVuYyh0IC8gKG4gKiBuICogZSkpICsgYTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZ2VuZXJhdGVEZWZhdWx0TFVUMzZfQ0lFTGFiIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHQpIHsKICAgICAgICBmb3IgKHZhciBlID0gbmV3IEFycmF5KHQubGVuZ3RoKSwgbiA9IDA7IG4gPCB0Lmxlbmd0aDsgbisrKSB7CiAgICAgICAgICB2YXIgYSA9IHsKICAgICAgICAgICAgICBSOiB0WzMgKiBuICsgMF0sCiAgICAgICAgICAgICAgRzogdFszICogbiArIDFdLAogICAgICAgICAgICAgIEI6IHRbMyAqIG4gKyAyXQogICAgICAgICAgICB9LAogICAgICAgICAgICByID0gbC5SR0J0b0NJRUxhYihhKSwKICAgICAgICAgICAgbyA9IHIuTCwKICAgICAgICAgICAgaSA9IHIuYSwKICAgICAgICAgICAgdSA9IHIuYjsKICAgICAgICAgIGVbMyAqIG4gKyAwXSA9IG8sIGVbMyAqIG4gKyAxXSA9IGksIGVbMyAqIG4gKyAyXSA9IHU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBlOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdlbmVyYXRlRGVmYXVsdExVVDM2X0xhYiIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgZm9yICh2YXIgZSA9IG5ldyBBcnJheSh0Lmxlbmd0aCksIG4gPSAwOyBuIDwgdC5sZW5ndGggLyAzOyBuKyspIHsKICAgICAgICAgIHZhciBhID0gewogICAgICAgICAgICAgIFI6IHRbMyAqIG4gKyAwXSwKICAgICAgICAgICAgICBHOiB0WzMgKiBuICsgMV0sCiAgICAgICAgICAgICAgQjogdFszICogbiArIDJdCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHIgPSBsLlJHQnRvTGFiKGEpLAogICAgICAgICAgICBvID0gci5MLAogICAgICAgICAgICBpID0gci5hLAogICAgICAgICAgICB1ID0gci5iOwogICAgICAgICAgZVszICogbiArIDBdID0gbywgZVszICogbiArIDFdID0gaSwgZVszICogbiArIDJdID0gdTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGU7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZ2VuZXJhdGVEZWZhdWx0TFVUMzZfWSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0KSB7CiAgICAgICAgZm9yICh2YXIgZSA9IFtdLCBuID0gMDsgbiA8IHQubGVuZ3RoIC8gMzsgbisrKSB7CiAgICAgICAgICB2YXIgYSA9IHsKICAgICAgICAgICAgICBSOiB0WzMgKiBuICsgMF0sCiAgICAgICAgICAgICAgRzogdFszICogbiArIDFdLAogICAgICAgICAgICAgIEI6IHRbMyAqIG4gKyAyXQogICAgICAgICAgICB9LAogICAgICAgICAgICByID0gbC5SR0J0b1koYSkuWTsKICAgICAgICAgIGUucHVzaChyKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGU7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAibWVyZ2UiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCwgZSwgbiwgYSkgewogICAgICAgIHZhciByLAogICAgICAgICAgbywKICAgICAgICAgIGksCiAgICAgICAgICB1LAogICAgICAgICAgbCA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzRdICYmIGFyZ3VtZW50c1s0XSwKICAgICAgICAgIHMgPSBudWxsICE9PSAociA9IG4uYUF2ZXJhZ2VbZV0pICYmIHZvaWQgMCAhPT0gciA/IHIgOiAwLAogICAgICAgICAgYyA9IG51bGwgIT09IChvID0gYS5hQXZlcmFnZVtlXSkgJiYgdm9pZCAwICE9PSBvID8gbyA6IDAsCiAgICAgICAgICBmID0gbnVsbCAhPT0gKGkgPSBuLnN0ZERldltlXSkgJiYgdm9pZCAwICE9PSBpID8gaSA6IDAsCiAgICAgICAgICBoID0gbnVsbCAhPT0gKHUgPSBhLnN0ZERldltlXSkgJiYgdm9pZCAwICE9PSB1ID8gdSA6IDA7CiAgICAgICAgaWYgKCFuLnN0ZERldltlXSB8fCAhYS5zdGREZXZbZV0pIHsKICAgICAgICAgIHZhciB2ID0gdCArIGMgLSBzOwogICAgICAgICAgcmV0dXJuIE1hdGgubWluKDEsIE1hdGgubWF4KDAsIHYpKTsKICAgICAgICB9CiAgICAgICAgdmFyIGIgPSAodCAtIHMpIC8gZiAqIGggKyBjOwogICAgICAgIHJldHVybiBsID8gTWF0aC5taW4oMSwgTWF0aC5tYXgoMCwgYikpIDogYjsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJtaXgiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCwgZSwgbikgewogICAgICAgIHJldHVybiBuID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgbikpLCB7CiAgICAgICAgICBSOiBhKHQuUiwgZS5SKSwKICAgICAgICAgIEc6IGEodC5HLCBlLkcpLAogICAgICAgICAgQjogYSh0LkIsIGUuQikKICAgICAgICB9OwogICAgICAgIGZ1bmN0aW9uIGEodCwgZSkgewogICAgICAgICAgcmV0dXJuIHQgKiBuICsgZSAqICgxIC0gbik7CiAgICAgICAgfQogICAgICB9CiAgICB9XSwgZSAmJiBkKHQucHJvdG90eXBlLCBlKSwgbiAmJiBkKHQsIG4pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgInByb3RvdHlwZSIsIHsKICAgICAgd3JpdGFibGU6ICExCiAgICB9KSwgdDsKICAgIHZhciB0LCBlLCBuOwogIH0oKTsKICB2YXIgUiA9IFN5bWJvbCgiQ29tbGluay5wcm94eSIpLAogICAgUyA9IFN5bWJvbCgiQ29tbGluay5lbmRwb2ludCIpLAogICAgdyA9IFN5bWJvbCgiQ29tbGluay5yZWxlYXNlUHJveHkiKSwKICAgIEcgPSBTeW1ib2woIkNvbWxpbmsuZmluYWxpemVyIiksCiAgICBNID0gU3ltYm9sKCJDb21saW5rLnRocm93biIpLAogICAgQiA9IGZ1bmN0aW9uIEIodCkgewogICAgICByZXR1cm4gIm9iamVjdCIgPT0gX3R5cGVvZih0KSAmJiBudWxsICE9PSB0IHx8ICJmdW5jdGlvbiIgPT0gdHlwZW9mIHQ7CiAgICB9LAogICAgVCA9IG5ldyBNYXAoW1sicHJveHkiLCB7CiAgICAgIGNhbkhhbmRsZTogZnVuY3Rpb24gY2FuSGFuZGxlKHQpIHsKICAgICAgICByZXR1cm4gQih0KSAmJiB0W1JdOwogICAgICB9LAogICAgICBzZXJpYWxpemU6IGZ1bmN0aW9uIHNlcmlhbGl6ZSh0KSB7CiAgICAgICAgdmFyIF9NZXNzYWdlQ2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpLAogICAgICAgICAgZSA9IF9NZXNzYWdlQ2hhbm5lbC5wb3J0MSwKICAgICAgICAgIG4gPSBfTWVzc2FnZUNoYW5uZWwucG9ydDI7CiAgICAgICAgcmV0dXJuIEModCwgZSksIFtuLCBbbl1dOwogICAgICB9LAogICAgICBkZXNlcmlhbGl6ZTogZnVuY3Rpb24gZGVzZXJpYWxpemUodCkgewogICAgICAgIHJldHVybiB0LnN0YXJ0KCksIF8odCwgW10sIGUpOwogICAgICAgIHZhciBlOwogICAgICB9CiAgICB9XSwgWyJ0aHJvdyIsIHsKICAgICAgY2FuSGFuZGxlOiBmdW5jdGlvbiBjYW5IYW5kbGUodCkgewogICAgICAgIHJldHVybiBCKHQpICYmIE0gaW4gdDsKICAgICAgfSwKICAgICAgc2VyaWFsaXplOiBmdW5jdGlvbiBzZXJpYWxpemUoX3JlZikgewogICAgICAgIHZhciB0ID0gX3JlZi52YWx1ZTsKICAgICAgICB2YXIgZTsKICAgICAgICByZXR1cm4gZSA9IHQgaW5zdGFuY2VvZiBFcnJvciA/IHsKICAgICAgICAgIGlzRXJyb3I6ICEwLAogICAgICAgICAgdmFsdWU6IHsKICAgICAgICAgICAgbWVzc2FnZTogdC5tZXNzYWdlLAogICAgICAgICAgICBuYW1lOiB0Lm5hbWUsCiAgICAgICAgICAgIHN0YWNrOiB0LnN0YWNrCiAgICAgICAgICB9CiAgICAgICAgfSA6IHsKICAgICAgICAgIGlzRXJyb3I6ICExLAogICAgICAgICAgdmFsdWU6IHQKICAgICAgICB9LCBbZSwgW11dOwogICAgICB9LAogICAgICBkZXNlcmlhbGl6ZTogZnVuY3Rpb24gZGVzZXJpYWxpemUodCkgewogICAgICAgIGlmICh0LmlzRXJyb3IpIHRocm93IE9iamVjdC5hc3NpZ24obmV3IEVycm9yKHQudmFsdWUubWVzc2FnZSksIHQudmFsdWUpOwogICAgICAgIHRocm93IHQudmFsdWU7CiAgICAgIH0KICAgIH1dXSk7CiAgZnVuY3Rpb24gQyh0KSB7CiAgICB2YXIgZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZ2xvYmFsVGhpczsKICAgIHZhciBuID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBbIioiXTsKICAgIGUuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIGZ1bmN0aW9uIGEocikgewogICAgICBpZiAoIXIgfHwgIXIuZGF0YSkgcmV0dXJuOwogICAgICBpZiAoIWZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHQpLAogICAgICAgICAgX3N0ZXA7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgIHZhciBfbiA9IF9zdGVwLnZhbHVlOwogICAgICAgICAgICBpZiAoZSA9PT0gX24gfHwgIioiID09PSBfbikgcmV0dXJuICEwOwogICAgICAgICAgICBpZiAoX24gaW5zdGFuY2VvZiBSZWdFeHAgJiYgX24udGVzdChlKSkgcmV0dXJuICEwOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICExOwogICAgICB9KG4sIHIub3JpZ2luKSkgcmV0dXJuIHZvaWQgY29uc29sZS53YXJuKCJJbnZhbGlkIG9yaWdpbiAnIi5jb25jYXQoci5vcmlnaW4sICInIGZvciBjb21saW5rIHByb3h5IikpOwogICAgICB2YXIgX09iamVjdCRhc3NpZ24gPSBPYmplY3QuYXNzaWduKHsKICAgICAgICAgIHBhdGg6IFtdCiAgICAgICAgfSwgci5kYXRhKSwKICAgICAgICBvID0gX09iamVjdCRhc3NpZ24uaWQsCiAgICAgICAgaSA9IF9PYmplY3QkYXNzaWduLnR5cGUsCiAgICAgICAgdSA9IF9PYmplY3QkYXNzaWduLnBhdGgsCiAgICAgICAgbCA9IChyLmRhdGEuYXJndW1lbnRMaXN0IHx8IFtdKS5tYXAoRCk7CiAgICAgIHZhciBzOwogICAgICB0cnkgewogICAgICAgIHZhciBfZSA9IHUuc2xpY2UoMCwgLTEpLnJlZHVjZShmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgICByZXR1cm4gdFtlXTsKICAgICAgICAgIH0sIHQpLAogICAgICAgICAgX24yID0gdS5yZWR1Y2UoZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgcmV0dXJuIHRbZV07CiAgICAgICAgICB9LCB0KTsKICAgICAgICBzd2l0Y2ggKGkpIHsKICAgICAgICAgIGNhc2UgIkdFVCI6CiAgICAgICAgICAgIHMgPSBfbjI7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiU0VUIjoKICAgICAgICAgICAgX2VbdS5zbGljZSgtMSlbMF1dID0gRChyLmRhdGEudmFsdWUpLCBzID0gITA7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiQVBQTFkiOgogICAgICAgICAgICBzID0gX24yLmFwcGx5KF9lLCBsKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJDT05TVFJVQ1QiOgogICAgICAgICAgICBzID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih0LCBfZGVmaW5lUHJvcGVydHkoe30sIFIsICEwKSk7CiAgICAgICAgICAgIH0oX2NvbnN0cnVjdChfbjIsIF90b0NvbnN1bWFibGVBcnJheShsKSkpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgIkVORFBPSU5UIjoKICAgICAgICAgICAgewogICAgICAgICAgICAgIHZhciBfTWVzc2FnZUNoYW5uZWwyID0gbmV3IE1lc3NhZ2VDaGFubmVsKCksCiAgICAgICAgICAgICAgICBfZTIgPSBfTWVzc2FnZUNoYW5uZWwyLnBvcnQxLAogICAgICAgICAgICAgICAgX24zID0gX01lc3NhZ2VDaGFubmVsMi5wb3J0MjsKICAgICAgICAgICAgICBDKHQsIF9uMyksIHMgPSBmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGouc2V0KHQsIGUpLCB0OwogICAgICAgICAgICAgIH0oX2UyLCBbX2UyXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJSRUxFQVNFIjoKICAgICAgICAgICAgcyA9IHZvaWQgMDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgcyA9IF9kZWZpbmVQcm9wZXJ0eSh7CiAgICAgICAgICB2YWx1ZTogdAogICAgICAgIH0sIE0sIDApOwogICAgICB9CiAgICAgIFByb21pc2UucmVzb2x2ZShzKVsiY2F0Y2giXShmdW5jdGlvbiAodCkgewogICAgICAgIHJldHVybiBfZGVmaW5lUHJvcGVydHkoewogICAgICAgICAgdmFsdWU6IHQKICAgICAgICB9LCBNLCAwKTsKICAgICAgfSkudGhlbihmdW5jdGlvbiAobikgewogICAgICAgIHZhciBfQSA9IEEobiksCiAgICAgICAgICBfQTIgPSBfc2xpY2VkVG9BcnJheShfQSwgMiksCiAgICAgICAgICByID0gX0EyWzBdLAogICAgICAgICAgdSA9IF9BMlsxXTsKICAgICAgICBlLnBvc3RNZXNzYWdlKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgciksIHsKICAgICAgICAgIGlkOiBvCiAgICAgICAgfSksIHUpLCAiUkVMRUFTRSIgPT09IGkgJiYgKGUucmVtb3ZlRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIGEpLCBrKGUpLCBHIGluIHQgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgdFtHXSAmJiB0W0ddKCkpOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAodCkgewogICAgICAgIHZhciBfQTMgPSBBKF9kZWZpbmVQcm9wZXJ0eSh7CiAgICAgICAgICAgIHZhbHVlOiBuZXcgVHlwZUVycm9yKCJVbnNlcmlhbGl6YWJsZSByZXR1cm4gdmFsdWUiKQogICAgICAgICAgfSwgTSwgMCkpLAogICAgICAgICAgX0E0ID0gX3NsaWNlZFRvQXJyYXkoX0EzLCAyKSwKICAgICAgICAgIG4gPSBfQTRbMF0sCiAgICAgICAgICBhID0gX0E0WzFdOwogICAgICAgIGUucG9zdE1lc3NhZ2UoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBuKSwgewogICAgICAgICAgaWQ6IG8KICAgICAgICB9KSwgYSk7CiAgICAgIH0pOwogICAgfSksIGUuc3RhcnQgJiYgZS5zdGFydCgpOwogIH0KICBmdW5jdGlvbiBrKHQpIHsKICAgIChmdW5jdGlvbiAodCkgewogICAgICByZXR1cm4gIk1lc3NhZ2VQb3J0IiA9PT0gdC5jb25zdHJ1Y3Rvci5uYW1lOwogICAgfSkodCkgJiYgdC5jbG9zZSgpOwogIH0KICBmdW5jdGlvbiBJKHQpIHsKICAgIGlmICh0KSB0aHJvdyBuZXcgRXJyb3IoIlByb3h5IGhhcyBiZWVuIHJlbGVhc2VkIGFuZCBpcyBub3QgdXNlYWJsZSIpOwogIH0KICBmdW5jdGlvbiBZKHQpIHsKICAgIHJldHVybiBPKHQsIHsKICAgICAgdHlwZTogIlJFTEVBU0UiCiAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgayh0KTsKICAgIH0pOwogIH0KICB2YXIgeCA9IG5ldyBXZWFrTWFwKCksCiAgICBQID0gIkZpbmFsaXphdGlvblJlZ2lzdHJ5IiBpbiBnbG9iYWxUaGlzICYmIG5ldyBGaW5hbGl6YXRpb25SZWdpc3RyeShmdW5jdGlvbiAodCkgewogICAgICB2YXIgZSA9ICh4LmdldCh0KSB8fCAwKSAtIDE7CiAgICAgIHguc2V0KHQsIGUpLCAwID09PSBlICYmIFkodCk7CiAgICB9KTsKICBmdW5jdGlvbiBfKHQpIHsKICAgIHZhciBlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBbXTsKICAgIHZhciBuID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBmdW5jdGlvbiAoKSB7fTsKICAgIHZhciBhID0gITE7CiAgICB2YXIgciA9IG5ldyBQcm94eShuLCB7CiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KG4sIG8pIHsKICAgICAgICBpZiAoSShhKSwgbyA9PT0gdykgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICFmdW5jdGlvbiAodCkgewogICAgICAgICAgICBQICYmIFAudW5yZWdpc3Rlcih0KTsKICAgICAgICAgIH0ociksIFkodCksIGEgPSAhMDsKICAgICAgICB9OwogICAgICAgIGlmICgidGhlbiIgPT09IG8pIHsKICAgICAgICAgIGlmICgwID09PSBlLmxlbmd0aCkgcmV0dXJuIHsKICAgICAgICAgICAgdGhlbjogZnVuY3Rpb24gdGhlbigpIHsKICAgICAgICAgICAgICByZXR1cm4gcjsKICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICAgIHZhciBfbjQgPSBPKHQsIHsKICAgICAgICAgICAgdHlwZTogIkdFVCIsCiAgICAgICAgICAgIHBhdGg6IGUubWFwKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHQudG9TdHJpbmcoKTsKICAgICAgICAgICAgfSkKICAgICAgICAgIH0pLnRoZW4oRCk7CiAgICAgICAgICByZXR1cm4gX240LnRoZW4uYmluZChfbjQpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gXyh0LCBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGUpLCBbb10pKTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbiBzZXQobiwgciwgbykgewogICAgICAgIEkoYSk7CiAgICAgICAgdmFyIF9BNiA9IEEobyksCiAgICAgICAgICBfQTcgPSBfc2xpY2VkVG9BcnJheShfQTYsIDIpLAogICAgICAgICAgaSA9IF9BN1swXSwKICAgICAgICAgIHUgPSBfQTdbMV07CiAgICAgICAgcmV0dXJuIE8odCwgewogICAgICAgICAgdHlwZTogIlNFVCIsCiAgICAgICAgICBwYXRoOiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGUpLCBbcl0pLm1hcChmdW5jdGlvbiAodCkgewogICAgICAgICAgICByZXR1cm4gdC50b1N0cmluZygpOwogICAgICAgICAgfSksCiAgICAgICAgICB2YWx1ZTogaQogICAgICAgIH0sIHUpLnRoZW4oRCk7CiAgICAgIH0sCiAgICAgIGFwcGx5OiBmdW5jdGlvbiBhcHBseShuLCByLCBvKSB7CiAgICAgICAgSShhKTsKICAgICAgICB2YXIgaSA9IGVbZS5sZW5ndGggLSAxXTsKICAgICAgICBpZiAoaSA9PT0gUykgcmV0dXJuIE8odCwgewogICAgICAgICAgdHlwZTogIkVORFBPSU5UIgogICAgICAgIH0pLnRoZW4oRCk7CiAgICAgICAgaWYgKCJiaW5kIiA9PT0gaSkgcmV0dXJuIF8odCwgZS5zbGljZSgwLCAtMSkpOwogICAgICAgIHZhciBfVSA9IFUobyksCiAgICAgICAgICBfVTIgPSBfc2xpY2VkVG9BcnJheShfVSwgMiksCiAgICAgICAgICB1ID0gX1UyWzBdLAogICAgICAgICAgbCA9IF9VMlsxXTsKICAgICAgICByZXR1cm4gTyh0LCB7CiAgICAgICAgICB0eXBlOiAiQVBQTFkiLAogICAgICAgICAgcGF0aDogZS5tYXAoZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgcmV0dXJuIHQudG9TdHJpbmcoKTsKICAgICAgICAgIH0pLAogICAgICAgICAgYXJndW1lbnRMaXN0OiB1CiAgICAgICAgfSwgbCkudGhlbihEKTsKICAgICAgfSwKICAgICAgY29uc3RydWN0OiBmdW5jdGlvbiBjb25zdHJ1Y3QobiwgcikgewogICAgICAgIEkoYSk7CiAgICAgICAgdmFyIF9VMyA9IFUociksCiAgICAgICAgICBfVTQgPSBfc2xpY2VkVG9BcnJheShfVTMsIDIpLAogICAgICAgICAgbyA9IF9VNFswXSwKICAgICAgICAgIGkgPSBfVTRbMV07CiAgICAgICAgcmV0dXJuIE8odCwgewogICAgICAgICAgdHlwZTogIkNPTlNUUlVDVCIsCiAgICAgICAgICBwYXRoOiBlLm1hcChmdW5jdGlvbiAodCkgewogICAgICAgICAgICByZXR1cm4gdC50b1N0cmluZygpOwogICAgICAgICAgfSksCiAgICAgICAgICBhcmd1bWVudExpc3Q6IG8KICAgICAgICB9LCBpKS50aGVuKEQpOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiBmdW5jdGlvbiAodCwgZSkgewogICAgICB2YXIgbiA9ICh4LmdldChlKSB8fCAwKSArIDE7CiAgICAgIHguc2V0KGUsIG4pLCBQICYmIFAucmVnaXN0ZXIodCwgZSwgdCk7CiAgICB9KHIsIHQpLCByOwogIH0KICBmdW5jdGlvbiBVKHQpIHsKICAgIHZhciBlID0gdC5tYXAoQSk7CiAgICByZXR1cm4gW2UubWFwKGZ1bmN0aW9uICh0KSB7CiAgICAgIHJldHVybiB0WzBdOwogICAgfSksIChuID0gZS5tYXAoZnVuY3Rpb24gKHQpIHsKICAgICAgcmV0dXJuIHRbMV07CiAgICB9KSwgQXJyYXkucHJvdG90eXBlLmNvbmNhdC5hcHBseShbXSwgbikpXTsKICAgIHZhciBuOwogIH0KICB2YXIgaiA9IG5ldyBXZWFrTWFwKCk7CiAgZnVuY3Rpb24gQSh0KSB7CiAgICB2YXIgX2l0ZXJhdG9yMiA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKFQpLAogICAgICBfc3RlcDI7CiAgICB0cnkgewogICAgICBmb3IgKF9pdGVyYXRvcjIucygpOyAhKF9zdGVwMiA9IF9pdGVyYXRvcjIubigpKS5kb25lOykgewogICAgICAgIHZhciBfc3RlcDIkdmFsdWUgPSBfc2xpY2VkVG9BcnJheShfc3RlcDIudmFsdWUsIDIpLAogICAgICAgICAgX2UzID0gX3N0ZXAyJHZhbHVlWzBdLAogICAgICAgICAgX241ID0gX3N0ZXAyJHZhbHVlWzFdOwogICAgICAgIGlmIChfbjUuY2FuSGFuZGxlKHQpKSB7CiAgICAgICAgICB2YXIgX241JHNlcmlhbGl6ZSA9IF9uNS5zZXJpYWxpemUodCksCiAgICAgICAgICAgIF9uNSRzZXJpYWxpemUyID0gX3NsaWNlZFRvQXJyYXkoX241JHNlcmlhbGl6ZSwgMiksCiAgICAgICAgICAgIF9hID0gX241JHNlcmlhbGl6ZTJbMF0sCiAgICAgICAgICAgIF9yID0gX241JHNlcmlhbGl6ZTJbMV07CiAgICAgICAgICByZXR1cm4gW3sKICAgICAgICAgICAgdHlwZTogIkhBTkRMRVIiLAogICAgICAgICAgICBuYW1lOiBfZTMsCiAgICAgICAgICAgIHZhbHVlOiBfYQogICAgICAgICAgfSwgX3JdOwogICAgICAgIH0KICAgICAgfQogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIF9pdGVyYXRvcjIuZShlcnIpOwogICAgfSBmaW5hbGx5IHsKICAgICAgX2l0ZXJhdG9yMi5mKCk7CiAgICB9CiAgICByZXR1cm4gW3sKICAgICAgdHlwZTogIlJBVyIsCiAgICAgIHZhbHVlOiB0CiAgICB9LCBqLmdldCh0KSB8fCBbXV07CiAgfQogIGZ1bmN0aW9uIEQodCkgewogICAgc3dpdGNoICh0LnR5cGUpIHsKICAgICAgY2FzZSAiSEFORExFUiI6CiAgICAgICAgcmV0dXJuIFQuZ2V0KHQubmFtZSkuZGVzZXJpYWxpemUodC52YWx1ZSk7CiAgICAgIGNhc2UgIlJBVyI6CiAgICAgICAgcmV0dXJuIHQudmFsdWU7CiAgICB9CiAgfQogIGZ1bmN0aW9uIE8odCwgZSwgbikgewogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhKSB7CiAgICAgIHZhciByID0gbmV3IEFycmF5KDQpLmZpbGwoMCkubWFwKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpLnRvU3RyaW5nKDE2KTsKICAgICAgfSkuam9pbigiLSIpOwogICAgICB0LmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBmdW5jdGlvbiBlKG4pIHsKICAgICAgICBuLmRhdGEgJiYgbi5kYXRhLmlkICYmIG4uZGF0YS5pZCA9PT0gciAmJiAodC5yZW1vdmVFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgZSksIGEobi5kYXRhKSk7CiAgICAgIH0pLCB0LnN0YXJ0ICYmIHQuc3RhcnQoKSwgdC5wb3N0TWVzc2FnZShPYmplY3QuYXNzaWduKHsKICAgICAgICBpZDogcgogICAgICB9LCBlKSwgbik7CiAgICB9KTsKICB9CiAgdmFyIE4gPSBuZXcgRSgpOwogIEMoewogICAgZ2V0TFVUVGV4dHVyZTogZnVuY3Rpb24gZ2V0TFVUVGV4dHVyZSh0LCBlKSB7CiAgICAgIHJldHVybiBOLnByb2Nlc3ModCwgZSkuTkVXX0xVVDM2X1JHQmFfVElOVEVEOwogICAgfQogIH0pOwp9KSgpOw==";},2634:function _(){},7734:function _(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{_K:function _K(){return ee;},qY:function qY(){return Ne;},wV:function wV(){return Md;}});var process=__webpack_require__(5606),Buffer=__webpack_require__(8287).hp,$d=Object.create,kn=Object.defineProperty,Bd=Object.getOwnPropertyDescriptor,kd=Object.getOwnPropertyNames,Nd=Object.getPrototypeOf,Rd=Object.prototype.hasOwnProperty,L=function L(e,t){return function(){return e&&(t=e(e=0)),t;};},ye=function ye(e,t){return function(){return t||e((t={exports:{}}).exports,t),t.exports;};},cr=function cr(e,t){for(var r in t)kn(e,r,{get:t[r],enumerable:!0});},Qa=function Qa(e,t,r,n){if(t&&"object"==_typeof2(t)||"function"==typeof t){var _iterator3=_createForOfIteratorHelper2(kd(t)),_step3;try{var _loop=function _loop(){var i=_step3.value;!Rd.call(e,i)&&i!==r&&kn(e,i,{get:function get(){return t[i];},enumerable:!(n=Bd(t,i))||n.enumerable});};for(_iterator3.s();!(_step3=_iterator3.n()).done;){_loop();}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}}return e;},Nr=function Nr(e,t,r){return r=null!=e?$d(Nd(e)):{},Qa(!t&&e&&e.__esModule?r:kn(r,"default",{value:e,enumerable:!0}),e);},Ht=function Ht(e){return Qa(kn({},"__esModule",{value:!0}),e);},Nn,pr,dr,Rn,Mn=L(function(){Nn=new Map(),pr=[],dr=function dr(e,t,r){if(!t||"function"!=typeof t.init||"function"!=typeof t.createInferenceSessionHandler)throw new TypeError("not a valid backend");{var _n4=Nn.get(e);if(void 0===_n4)Nn.set(e,{backend:t,priority:r});else{if(_n4.priority>r)return;if(_n4.priority===r&&_n4.backend!==t)throw new Error("cannot register backend \"".concat(e,"\" using priority ").concat(r));}if(r>=0){var _t2=pr.indexOf(e);-1!==_t2&&pr.splice(_t2,1);for(var _t3=0;_t3<pr.length;_t3++)if(Nn.get(pr[_t3]).priority<=r)return void pr.splice(_t3,0,e);pr.push(e);}}},Rn=/*#__PURE__*/function(){var _ref=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee(e){var t,r,_iterator4,_step4,_e8,_t4,_n5;return _regeneratorRuntime2().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:t=0===e.length?pr:e,r=[];_iterator4=_createForOfIteratorHelper2(t);_context.prev=2;_iterator4.s();case 4:if((_step4=_iterator4.n()).done){_context.next=29;break;}_e8=_step4.value;_t4=Nn.get(_e8);if(!_t4){_context.next=27;break;}if(!_t4.initialized){_context.next=10;break;}return _context.abrupt("return",_t4.backend);case 10:if(!_t4.aborted){_context.next=12;break;}return _context.abrupt("continue",27);case 12:_n5=!!_t4.initPromise;_context.prev=13;_n5||(_t4.initPromise=_t4.backend.init(_e8));_context.next=17;return _t4.initPromise;case 17:_t4.initialized=!0;return _context.abrupt("return",_t4.backend);case 21:_context.prev=21;_context.t0=_context["catch"](13);_n5||r.push({name:_e8,err:_context.t0}),_t4.aborted=!0;case 24:_context.prev=24;delete _t4.initPromise;return _context.finish(24);case 27:_context.next=4;break;case 29:_context.next=34;break;case 31:_context.prev=31;_context.t1=_context["catch"](2);_iterator4.e(_context.t1);case 34:_context.prev=34;_iterator4.f();return _context.finish(34);case 37:throw new Error("no available backend found. ERR: ".concat(r.map(function(e){return"[".concat(e.name,"] ").concat(e.err);}).join(", ")));case 38:case"end":return _context.stop();}},_callee,null,[[2,31,34,37],[13,21,24,27]]);}));return function Rn(_x){return _ref.apply(this,arguments);};}();}),es=L(function(){Mn();}),ts,rs=L(function(){ts="1.17.0";}),ns,hr,Jo=L(function(){rs(),ns="warning",hr={wasm:{},webgl:{},webgpu:{},versions:{common:ts},set logLevel(e){if(void 0!==e){if("string"!=typeof e||-1===["verbose","info","warning","error","fatal"].indexOf(e))throw new Error("Unsupported logging level: ".concat(e));ns=e;}},get logLevel(){return ns;}},Object.defineProperty(hr,"logLevel",{enumerable:!0});}),ee,os=L(function(){Jo(),ee=hr;}),is,as,ss=L(function(){is=function is(e,t){var r=(typeof document==="undefined"?"undefined":_typeof2(document))<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);r.width=e.dims[3],r.height=e.dims[2];var n=r.getContext("2d");if(null!=n){var _i2,_o2;void 0!==(t===null||t===void 0?void 0:t.tensorLayout)&&"NHWC"===t.tensorLayout?(_i2=e.dims[2],_o2=e.dims[3]):(_i2=e.dims[3],_o2=e.dims[2]);var _a2,_s2,_u2=void 0!==(t===null||t===void 0?void 0:t.format)?t.format:"RGB",_l2=t===null||t===void 0?void 0:t.norm;void 0===_l2||void 0===_l2.mean?_a2=[255,255,255,255]:"number"==typeof _l2.mean?_a2=[_l2.mean,_l2.mean,_l2.mean,_l2.mean]:(_a2=[_l2.mean[0],_l2.mean[1],_l2.mean[2],0],void 0!==_l2.mean[3]&&(_a2[3]=_l2.mean[3])),void 0===_l2||void 0===_l2.bias?_s2=[0,0,0,0]:"number"==typeof _l2.bias?_s2=[_l2.bias,_l2.bias,_l2.bias,_l2.bias]:(_s2=[_l2.bias[0],_l2.bias[1],_l2.bias[2],0],void 0!==_l2.bias[3]&&(_s2[3]=_l2.bias[3]));var _c2=_o2*_i2,_h2=0,_f2=_c2,_d2=2*_c2,_p2=-1;"RGBA"===_u2?(_h2=0,_f2=_c2,_d2=2*_c2,_p2=3*_c2):"RGB"===_u2?(_h2=0,_f2=_c2,_d2=2*_c2):"RBG"===_u2&&(_h2=0,_d2=_c2,_f2=2*_c2);for(var _t5=0;_t5<_o2;_t5++)for(var _r2=0;_r2<_i2;_r2++){var _i3=(e.data[_h2++]-_s2[0])*_a2[0],_o3=(e.data[_f2++]-_s2[1])*_a2[1],_u3=(e.data[_d2++]-_s2[2])*_a2[2],_l3=-1===_p2?255:(e.data[_p2++]-_s2[3])*_a2[3];n.fillStyle="rgba("+_i3+","+_o3+","+_u3+","+_l3+")",n.fillRect(_r2,_t5,1,1);}if("toDataURL"in r)return r.toDataURL();throw new Error("toDataURL is not supported");}throw new Error("Can not access image data");},as=function as(e,t){var r,n=(typeof document==="undefined"?"undefined":_typeof2(document))<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");if(null==n)throw new Error("Can not access image data");{var _i4,_o4,_a3;void 0!==(t===null||t===void 0?void 0:t.tensorLayout)&&"NHWC"===t.tensorLayout?(_i4=e.dims[2],_o4=e.dims[1],_a3=e.dims[3]):(_i4=e.dims[3],_o4=e.dims[2],_a3=e.dims[1]);var _s3,_u4,_l4=void 0!==t&&void 0!==t.format?t.format:"RGB",_c3=t===null||t===void 0?void 0:t.norm;void 0===_c3||void 0===_c3.mean?_s3=[255,255,255,255]:"number"==typeof _c3.mean?_s3=[_c3.mean,_c3.mean,_c3.mean,_c3.mean]:(_s3=[_c3.mean[0],_c3.mean[1],_c3.mean[2],255],void 0!==_c3.mean[3]&&(_s3[3]=_c3.mean[3])),void 0===_c3||void 0===_c3.bias?_u4=[0,0,0,0]:"number"==typeof _c3.bias?_u4=[_c3.bias,_c3.bias,_c3.bias,_c3.bias]:(_u4=[_c3.bias[0],_c3.bias[1],_c3.bias[2],0],void 0!==_c3.bias[3]&&(_u4[3]=_c3.bias[3]));var _h3=_o4*_i4;if(void 0!==t&&(void 0!==t.format&&4===_a3&&"RGBA"!==t.format||3===_a3&&"RGB"!==t.format&&"BGR"!==t.format))throw new Error("Tensor format doesn't match input tensor dims");var _f3=4,_d3=0,_p3=1,_y=2,_m2=3,_g2=0,_w=_h3,_b2=2*_h3,_v=-1;"RGBA"===_l4?(_g2=0,_w=_h3,_b2=2*_h3,_v=3*_h3):"RGB"===_l4?(_g2=0,_w=_h3,_b2=2*_h3):"RBG"===_l4&&(_g2=0,_b2=_h3,_w=2*_h3),r=n.createImageData(_i4,_o4);for(var _t6=0;_t6<_o4*_i4;_d3+=_f3,_p3+=_f3,_y+=_f3,_m2+=_f3,_t6++)r.data[_d3]=(e.data[_g2++]-_u4[0])*_s3[0],r.data[_p3]=(e.data[_w++]-_u4[1])*_s3[1],r.data[_y]=(e.data[_b2++]-_u4[2])*_s3[2],r.data[_m2]=-1===_v?255:(e.data[_v++]-_u4[3])*_s3[3];}return r;};}),Zo,us,ls,fs,cs,ps=L(function(){Gn(),Zo=function Zo(e,t){var _t$norm,_a$mean$,_a$bias$;if(void 0===e)throw new Error("Image buffer must be defined");if(void 0===t.height||void 0===t.width)throw new Error("Image height and width must be defined");if("NHWC"===t.tensorLayout)throw new Error("NHWC Tensor layout is not supported yet");var r,n,i=t.height,o=t.width,a=(_t$norm=t.norm)!==null&&_t$norm!==void 0?_t$norm:{mean:255,bias:0};r="number"==typeof a.mean?[a.mean,a.mean,a.mean,a.mean]:[a.mean[0],a.mean[1],a.mean[2],(_a$mean$=a.mean[3])!==null&&_a$mean$!==void 0?_a$mean$:255],n="number"==typeof a.bias?[a.bias,a.bias,a.bias,a.bias]:[a.bias[0],a.bias[1],a.bias[2],(_a$bias$=a.bias[3])!==null&&_a$bias$!==void 0?_a$bias$:0];var s=void 0!==t.format?t.format:"RGBA",u=void 0!==t.tensorFormat&&void 0!==t.tensorFormat?t.tensorFormat:"RGB",l=i*o,c="RGBA"===u?new Float32Array(4*l):new Float32Array(3*l),h=4,f=0,d=1,p=2,y=3,m=0,g=l,w=2*l,b=-1;"RGB"===s&&(h=3,f=0,d=1,p=2,y=-1),"RGBA"===u?b=3*l:"RBG"===u?(m=0,w=l,g=2*l):"BGR"===u&&(w=0,g=l,m=2*l);for(var _t7=0;_t7<l;_t7++,f+=h,p+=h,d+=h,y+=h)c[m++]=(e[f]+n[0])/r[0],c[g++]=(e[d]+n[1])/r[1],c[w++]=(e[p]+n[2])/r[2],-1!==b&&-1!==y&&(c[b++]=(e[y]+n[3])/r[3]);return new Xe("float32",c,"RGBA"===u?[1,4,i,o]:[1,3,i,o]);},us=/*#__PURE__*/function(){var _ref2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee2(e,t){var r,n,i,o,a,s,u,l,_n6,_i5,_n7,_o5,_n8,_i6,_t8,_n9,_n10,_i7,_t9,_o6;return _regeneratorRuntime2().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:n=(typeof HTMLImageElement==="undefined"?"undefined":_typeof2(HTMLImageElement))<"u"&&e instanceof HTMLImageElement,i=(typeof ImageData==="undefined"?"undefined":_typeof2(ImageData))<"u"&&e instanceof ImageData,o=(typeof ImageBitmap==="undefined"?"undefined":_typeof2(ImageBitmap))<"u"&&e instanceof ImageBitmap,a="string"==typeof e,s=t!==null&&t!==void 0?t:{},u=function u(){if((typeof document==="undefined"?"undefined":_typeof2(document))<"u")return document.createElement("canvas");if((typeof OffscreenCanvas==="undefined"?"undefined":_typeof2(OffscreenCanvas))<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported");},l=function l(e){return e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas?e.getContext("2d"):null;};if(!n){_context2.next=18;break;}_n6=u();_n6.width=e.width,_n6.height=e.height;_i5=l(_n6);if(!(null==_i5)){_context2.next=7;break;}throw new Error("Can not access image data");case 7:_n7=e.height,_o5=e.width;if(!(void 0!==t&&void 0!==t.resizedHeight&&void 0!==t.resizedWidth&&(_n7=t.resizedHeight,_o5=t.resizedWidth),void 0!==t)){_context2.next=14;break;}if(!(s=t,void 0!==t.tensorFormat)){_context2.next=11;break;}throw new Error("Image input config format must be RGBA for HTMLImageElement");case 11:s.tensorFormat="RGBA",s.height=_n7,s.width=_o5;_context2.next=15;break;case 14:s.tensorFormat="RGBA",s.height=_n7,s.width=_o5;case 15:_i5.drawImage(e,0,0),r=_i5.getImageData(0,0,_o5,_n7).data;_context2.next=42;break;case 18:if(i){_context2.next=32;break;}if(!o){_context2.next=29;break;}if(!(void 0===t)){_context2.next=22;break;}throw new Error("Please provide image config with format for Imagebitmap");case 22:_n8=u();_n8.width=e.width,_n8.height=e.height;_i6=l(_n8);if(!(null!=_i6)){_context2.next=28;break;}_t8=e.height,_n9=e.width;return _context2.abrupt("return",(_i6.drawImage(e,0,0,_n9,_t8),r=_i6.getImageData(0,0,_n9,_t8).data,s.height=_t8,s.width=_n9,Zo(r,s)));case 28:throw new Error("Can not access image data");case 29:if(!a){_context2.next=31;break;}return _context2.abrupt("return",new Promise(function(t,r){var n=u(),i=l(n);if(!e||!i)return r();var o=new Image();o.crossOrigin="Anonymous",o.src=e,o.onload=function(){n.width=o.width,n.height=o.height,i.drawImage(o,0,0,n.width,n.height);var e=i.getImageData(0,0,n.width,n.height);s.height=n.height,s.width=n.width,t(Zo(e.data,s));};}));case 31:throw new Error("Input data provided is not supported - aborted tensor creation");case 32:if(!(void 0!==t&&void 0!==t.resizedWidth&&void 0!==t.resizedHeight?(_n10=t.resizedHeight,_i7=t.resizedWidth):(_n10=e.height,_i7=e.width),void 0!==t&&(s=t),s.format="RGBA",s.height=_n10,s.width=_i7,void 0!==t)){_context2.next=41;break;}_t9=u();_t9.width=_i7,_t9.height=_n10;_o6=l(_t9);if(!(null==_o6)){_context2.next=38;break;}throw new Error("Can not access image data");case 38:_o6.putImageData(e,0,0),r=_o6.getImageData(0,0,_i7,_n10).data;_context2.next=42;break;case 41:r=e.data;case 42:if(!(void 0!==r)){_context2.next=44;break;}return _context2.abrupt("return",Zo(r,s));case 44:throw new Error("Input data provided is not supported - aborted tensor creation");case 45:case"end":return _context2.stop();}},_callee2);}));return function us(_x2,_x3){return _ref2.apply(this,arguments);};}(),ls=function ls(e,t){var r=t.width,n=t.height,i=t.download,o=t.dispose;return new Xe({location:"texture",type:"float32",texture:e,dims:[1,n,r,4],download:i,dispose:o});},fs=function fs(e,t){var r=t.dataType,n=t.dims,i=t.download,o=t.dispose;return new Xe({location:"gpu-buffer",type:r!==null&&r!==void 0?r:"float32",gpuBuffer:e,dims:n,download:i,dispose:o});},cs=function cs(e,t,r){return new Xe({location:"cpu-pinned",type:e,data:t,dims:r!==null&&r!==void 0?r:[t.length]});};}),an,Un,ds,hs,ms=L(function(){an=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["float16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),Un=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),ds=!1,hs=function hs(){if(!ds){ds=!0;var _e9=(typeof BigInt64Array==="undefined"?"undefined":_typeof2(BigInt64Array))<"u"&&"function"==typeof BigInt64Array.from,_t10=(typeof BigUint64Array==="undefined"?"undefined":_typeof2(BigUint64Array))<"u"&&"function"==typeof BigUint64Array.from;_e9&&(an.set("int64",BigInt64Array),Un.set(BigInt64Array,"int64")),_t10&&(an.set("uint64",BigUint64Array),Un.set(BigUint64Array,"uint64"));}};}),bs,gs,ys=L(function(){Gn(),bs=function bs(e){var t=1;for(var _r3=0;_r3<e.length;_r3++){var _n11=e[_r3];if("number"!=typeof _n11||!Number.isSafeInteger(_n11))throw new TypeError("dims[".concat(_r3,"] must be an integer, got: ").concat(_n11));if(_n11<0)throw new RangeError("dims[".concat(_r3,"] must be a non-negative integer, got: ").concat(_n11));t*=_n11;}return t;},gs=function gs(e,t){switch(e.location){case"cpu":return new Xe(e.type,e.data,t);case"cpu-pinned":return new Xe({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new Xe({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new Xe({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});default:throw new Error("tensorReshape: tensor location ".concat(e.location," is not supported"));}};}),Xe,Gn=L(function(){ss(),ps(),ms(),ys(),Xe=/*#__PURE__*/function(){function Xe(e,t,r){_classCallCheck2(this,Xe);var n,i;if(hs(),"object"==_typeof2(e)&&"location"in e)switch(this.dataLocation=e.location,n=e.type,i=e.dims,e.location){case"cpu-pinned":{var _t11=an.get(n);if(!_t11)throw new TypeError("unsupported type \"".concat(n,"\" to create tensor from pinned buffer"));if(!(e.data instanceof _t11))throw new TypeError("buffer should be of type ".concat(_t11.name));this.cpuData=e.data;break;}case"texture":if("float32"!==n)throw new TypeError("unsupported type \"".concat(n,"\" to create tensor from texture"));this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break;case"gpu-buffer":if("float32"!==n&&"float16"!==n&&"int32"!==n&&"int64"!==n&&"uint32"!==n&&"bool"!==n)throw new TypeError("unsupported type \"".concat(n,"\" to create tensor from gpu buffer"));this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break;default:throw new Error("Tensor constructor: unsupported location '".concat(this.dataLocation,"'"));}else{var _o7,_a4;if("string"==typeof e){if(n=e,_a4=r,"string"===e){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");_o7=t;}else{var _r4=an.get(e);if(void 0===_r4)throw new TypeError("Unsupported tensor type: ".concat(e,"."));if(Array.isArray(t)){if("float16"===e)throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");_o7="uint64"===e||"int64"===e?_r4.from(t,BigInt):_r4.from(t);}else{if(!(t instanceof _r4))throw new TypeError("A ".concat(n," tensor's data must be type of ").concat(_r4));_o7=t;}}}else if(_a4=t,Array.isArray(e)){if(0===e.length)throw new TypeError("Tensor type cannot be inferred from an empty array.");var _t12=_typeof2(e[0]);if("string"===_t12)n="string",_o7=e;else{if("boolean"!==_t12)throw new TypeError("Invalid element type of data array: ".concat(_t12,"."));n="bool",_o7=Uint8Array.from(e);}}else{var _t13=Un.get(e.constructor);if(void 0===_t13)throw new TypeError("Unsupported type for tensor data: ".concat(e.constructor,"."));n=_t13,_o7=e;}if(void 0===_a4)_a4=[_o7.length];else if(!Array.isArray(_a4))throw new TypeError("A tensor's dims must be a number array");i=_a4,this.cpuData=_o7,this.dataLocation="cpu";}var o=bs(i);if(this.cpuData&&o!==this.cpuData.length)throw new Error("Tensor's size(".concat(o,") does not match data length(").concat(this.cpuData.length,")."));this.type=n,this.dims=i,this.size=o;}return _createClass2(Xe,[{key:"toDataURL",value:function toDataURL(e){return is(this,e);}},{key:"toImageData",value:function toImageData(e){return as(this,e);}},{key:"data",get:function get(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData;}},{key:"location",get:function get(){return this.dataLocation;}},{key:"texture",get:function get(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData;}},{key:"gpuBuffer",get:function get(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData;}},{key:"getData",value:function(){var _getData=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee3(e){var _t14;return _regeneratorRuntime2().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.t0=(this.ensureValid(),this.dataLocation);_context3.next=_context3.t0==="cpu"?3:_context3.t0==="cpu-pinned"?3:_context3.t0==="texture"?4:_context3.t0==="gpu-buffer"?4:17;break;case 3:return _context3.abrupt("return",this.data);case 4:if(this.downloader){_context3.next=6;break;}throw new Error("The current tensor is not created with a specified data downloader.");case 6:if(!this.isDownloading){_context3.next=8;break;}throw new Error("The current tensor is being downloaded.");case 8:_context3.prev=8;this.isDownloading=!0;_context3.next=12;return this.downloader();case 12:_t14=_context3.sent;return _context3.abrupt("return",(this.downloader=void 0,this.dataLocation="cpu",this.cpuData=_t14,e&&this.disposer&&(this.disposer(),this.disposer=void 0),_t14));case 14:_context3.prev=14;this.isDownloading=!1;return _context3.finish(14);case 17:throw new Error("cannot get data from location: ".concat(this.dataLocation));case 18:case"end":return _context3.stop();}},_callee3,this,[[8,,14,17]]);}));function getData(_x4){return _getData.apply(this,arguments);}return getData;}()},{key:"dispose",value:function dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none";}},{key:"ensureValid",value:function ensureValid(){if("none"===this.dataLocation)throw new Error("The tensor is disposed.");}},{key:"reshape",value:function reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return gs(this,e);}}],[{key:"fromImage",value:function(){var _fromImage=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee4(e,t){return _regeneratorRuntime2().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.abrupt("return",us(e,t));case 1:case"end":return _context4.stop();}},_callee4);}));function fromImage(_x5,_x6){return _fromImage.apply(this,arguments);}return fromImage;}()},{key:"fromTexture",value:function fromTexture(e,t){return ls(e,t);}},{key:"fromGpuBuffer",value:function fromGpuBuffer(e,t){return fs(e,t);}},{key:"fromPinnedBuffer",value:function fromPinnedBuffer(e,t,r){return cs(e,t,r);}}]);}();}),Ne,zn=L(function(){Gn(),Ne=Xe;}),Ts,xs,mr,br,Qo=L(function(){Jo(),Ts=function Ts(e,t){hr.wasm.trace&&console.timeStamp("".concat(e,"::ORT::").concat(t));},xs=function xs(e,t){var _Error$stack;var r=((_Error$stack=new Error().stack)===null||_Error$stack===void 0?void 0:_Error$stack.split(/\r\n|\r|\n/g))||[],n=!1;for(var _i8=0;_i8<r.length;_i8++){if(n&&!r[_i8].includes("TRACE_FUNC")){var _n12="FUNC_".concat(e,"::").concat(r[_i8].trim().split(" ")[1]);return t&&(_n12+="::".concat(t)),void Ts("CPU",_n12);}r[_i8].includes("TRACE_FUNC")&&(n=!0);}},mr=function mr(e){hr.wasm.trace&&xs("BEGIN",e);},br=function br(e){hr.wasm.trace&&xs("END",e);};}),Wn,ws=L(function(){Mn(),zn(),Qo(),Wn=/*#__PURE__*/function(){function e(_e10){_classCallCheck2(this,e);this.handler=_e10;}return _createClass2(e,[{key:"run",value:function(){var _run=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee5(_e11,t,r){var n,i,o,_iterator5,_step5,_e12,_e13,_a5,_iterator6,_step6,_r5,_i9,_iterator7,_step7,_t16,_iterator8,_step8,_e14,a,s,_e20,_t15;return _regeneratorRuntime2().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:mr();n={},i={};if(!("object"!=_typeof2(_e11)||null===_e11||_e11 instanceof Ne||Array.isArray(_e11))){_context5.next=4;break;}throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");case 4:o=!0;if(!("object"==_typeof2(t))){_context5.next=57;break;}if(!(null===t)){_context5.next=8;break;}throw new TypeError("Unexpected argument[1]: cannot be null.");case 8:if(!(t instanceof Ne)){_context5.next=10;break;}throw new TypeError("'fetches' cannot be a Tensor");case 10:if(!Array.isArray(t)){_context5.next=42;break;}if(!(0===t.length)){_context5.next=13;break;}throw new TypeError("'fetches' cannot be an empty array.");case 13:o=!1;_iterator5=_createForOfIteratorHelper2(t);_context5.prev=15;_iterator5.s();case 17:if((_step5=_iterator5.n()).done){_context5.next=26;break;}_e12=_step5.value;if(!("string"!=typeof _e12)){_context5.next=21;break;}throw new TypeError("'fetches' must be a string array or an object.");case 21:if(!(-1===this.outputNames.indexOf(_e12))){_context5.next=23;break;}throw new RangeError("'fetches' contains invalid output name: ".concat(_e12,"."));case 23:n[_e12]=null;case 24:_context5.next=17;break;case 26:_context5.next=31;break;case 28:_context5.prev=28;_context5.t0=_context5["catch"](15);_iterator5.e(_context5.t0);case 31:_context5.prev=31;_iterator5.f();return _context5.finish(31);case 34:if(!("object"==_typeof2(r)&&null!==r)){_context5.next=38;break;}i=r;_context5.next=40;break;case 38:if(!(_typeof2(r)<"u")){_context5.next=40;break;}throw new TypeError("'options' must be an object.");case 40:_context5.next=55;break;case 42:_e13=!1,_a5=Object.getOwnPropertyNames(t);_iterator6=_createForOfIteratorHelper2(this.outputNames);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){_r5=_step6.value;if(-1!==_a5.indexOf(_r5)){_i9=t[_r5];(null===_i9||_i9 instanceof Ne)&&(_e13=!0,o=!1,n[_r5]=_i9);}}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}if(!_e13){_context5.next=54;break;}if(!("object"==_typeof2(r)&&null!==r)){_context5.next=50;break;}i=r;_context5.next=52;break;case 50:if(!(_typeof2(r)<"u")){_context5.next=52;break;}throw new TypeError("'options' must be an object.");case 52:_context5.next=55;break;case 54:i=t;case 55:_context5.next=59;break;case 57:if(!(_typeof2(t)<"u")){_context5.next=59;break;}throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");case 59:_iterator7=_createForOfIteratorHelper2(this.inputNames);_context5.prev=60;_iterator7.s();case 62:if((_step7=_iterator7.n()).done){_context5.next=68;break;}_t16=_step7.value;if(!(_typeof2(_e11[_t16])>"u")){_context5.next=66;break;}throw new Error("input '".concat(_t16,"' is missing in 'feeds'."));case 66:_context5.next=62;break;case 68:_context5.next=73;break;case 70:_context5.prev=70;_context5.t1=_context5["catch"](60);_iterator7.e(_context5.t1);case 73:_context5.prev=73;_iterator7.f();return _context5.finish(73);case 76:if(o){_iterator8=_createForOfIteratorHelper2(this.outputNames);try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){_e14=_step8.value;n[_e14]=null;}}catch(err){_iterator8.e(err);}finally{_iterator8.f();}}_context5.next=79;return this.handler.run(_e11,n,i);case 79:a=_context5.sent;s={};for(_e20 in a)if(Object.hasOwnProperty.call(a,_e20)){_t15=a[_e20];s[_e20]=_t15 instanceof Ne?_t15:new Ne(_t15.type,_t15.data,_t15.dims);}return _context5.abrupt("return",(br(),s));case 83:case"end":return _context5.stop();}},_callee5,this,[[15,28,31,34],[60,70,73,76]]);}));function run(_x7,_x8,_x9){return _run.apply(this,arguments);}return run;}()},{key:"release",value:function(){var _release=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee6(){return _regeneratorRuntime2().wrap(function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return _context6.abrupt("return",this.handler.dispose());case 1:case"end":return _context6.stop();}},_callee6,this);}));function release(){return _release.apply(this,arguments);}return release;}()},{key:"configure",value:function(){var _configure=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee7(_e16){return _regeneratorRuntime2().wrap(function _callee7$(_context7){while(1)switch(_context7.prev=_context7.next){case 0:_context7.next=2;return this.handler.configure(_e16);case 2:return _context7.abrupt("return",_context7.sent);case 3:case"end":return _context7.stop();}},_callee7,this);}));function configure(_x10){return _configure.apply(this,arguments);}return configure;}()},{key:"auth",value:function(){var _auth=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee8(_e17){return _regeneratorRuntime2().wrap(function _callee8$(_context8){while(1)switch(_context8.prev=_context8.next){case 0:_context8.next=2;return this.handler.auth(_e17);case 2:return _context8.abrupt("return",_context8.sent);case 3:case"end":return _context8.stop();}},_callee8,this);}));function auth(_x11){return _auth.apply(this,arguments);}return auth;}()},{key:"startProfiling",value:function startProfiling(){this.handler.startProfiling();}},{key:"endProfiling",value:function endProfiling(){this.handler.endProfiling();}},{key:"inputNames",get:function get(){return this.handler.inputNames;}},{key:"outputNames",get:function get(){return this.handler.outputNames;}}],[{key:"create",value:function(){var _create=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee9(t,r,n,i){var o,a,_e18,_s4,_u5,s,u;return _regeneratorRuntime2().wrap(function _callee9$(_context9){while(1)switch(_context9.prev=_context9.next){case 0:mr();a={};if(!("string"==typeof t)){_context9.next=11;break;}if(!(o=t,"object"==_typeof2(r)&&null!==r)){_context9.next=7;break;}a=r;_context9.next=9;break;case 7:if(!(_typeof2(r)<"u")){_context9.next=9;break;}throw new TypeError("'options' must be an object.");case 9:_context9.next=52;break;case 11:if(!(t instanceof Uint8Array)){_context9.next=20;break;}if(!(o=t,"object"==_typeof2(r)&&null!==r)){_context9.next=16;break;}a=r;_context9.next=18;break;case 16:if(!(_typeof2(r)<"u")){_context9.next=18;break;}throw new TypeError("'options' must be an object.");case 18:_context9.next=52;break;case 20:if(t instanceof ArrayBuffer||(typeof SharedArrayBuffer==="undefined"?"undefined":_typeof2(SharedArrayBuffer))<"u"&&t instanceof SharedArrayBuffer){_context9.next=22;break;}throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");case 22:_e18=t,_s4=0,_u5=t.byteLength;if(!("object"==_typeof2(r)&&null!==r)){_context9.next=27;break;}a=r;_context9.next=51;break;case 27:if(!("number"==typeof r)){_context9.next=49;break;}if(!(_s4=r,!Number.isSafeInteger(_s4))){_context9.next=30;break;}throw new RangeError("'byteOffset' must be an integer.");case 30:if(!(_s4<0||_s4>=_e18.byteLength)){_context9.next=32;break;}throw new RangeError("'byteOffset' is out of range [0, ".concat(_e18.byteLength,")."));case 32:if(!(_u5=t.byteLength-_s4,"number"==typeof n)){_context9.next=45;break;}if(!(_u5=n,!Number.isSafeInteger(_u5))){_context9.next=35;break;}throw new RangeError("'byteLength' must be an integer.");case 35:if(!(_u5<=0||_s4+_u5>_e18.byteLength)){_context9.next=37;break;}throw new RangeError("'byteLength' is out of range (0, ".concat(_e18.byteLength-_s4,"]."));case 37:if(!("object"==_typeof2(i)&&null!==i)){_context9.next=41;break;}a=i;_context9.next=43;break;case 41:if(!(_typeof2(i)<"u")){_context9.next=43;break;}throw new TypeError("'options' must be an object.");case 43:_context9.next=47;break;case 45:if(!(_typeof2(n)<"u")){_context9.next=47;break;}throw new TypeError("'byteLength' must be a number.");case 47:_context9.next=51;break;case 49:if(!(_typeof2(r)<"u")){_context9.next=51;break;}throw new TypeError("'options' must be an object.");case 51:o=new Uint8Array(_e18,_s4,_u5);case 52:s=(a.executionProviders||[]).map(function(_e19){return"string"==typeof _e19?_e19:_e19.name;});_context9.next=55;return Rn(s);case 55:_context9.next=57;return _context9.sent.createInferenceSessionHandler(o,a);case 57:u=_context9.sent;return _context9.abrupt("return",(br(),new e(u)));case 59:case"end":return _context9.stop();}},_callee9);}));function create(_x12,_x13,_x14,_x15){return _create.apply(this,arguments);}return create;}()}]);}();}),Md,vs=L(function(){ws(),Md=Wn;}),_s=L(function(){}),Gd,Vn,Os=L(function(){Mn(),zn(),Gd="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",Vn=/*#__PURE__*/function(){function e(_e21,t,r){_classCallCheck2(this,e);this.handler=_e21,this.hasOptimizerModel=t,this.hasEvalModel=r;}return _createClass2(e,[{key:"trainingInputNames",get:function get(){return this.handler.inputNames;}},{key:"trainingOutputNames",get:function get(){return this.handler.outputNames;}},{key:"evalInputNames",get:function get(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.");}},{key:"evalOutputNames",get:function get(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.");}},{key:"typeNarrowingForRunStep",value:function typeNarrowingForRunStep(_e23,t,r,n,i){var o={},a={};if("object"!=_typeof2(r)||null===r||r instanceof Ne||Array.isArray(r))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");var s=!0;if("object"==_typeof2(n)){if(null===n)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof Ne)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(0===n.length)throw new TypeError("'fetches' cannot be an empty array.");s=!1;var _iterator9=_createForOfIteratorHelper2(n),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var _e24=_step9.value;if("string"!=typeof _e24)throw new TypeError("'fetches' must be a string array or an object.");if(-1===t.indexOf(_e24))throw new RangeError("'fetches' contains invalid output name: ".concat(_e24,"."));o[_e24]=null;}}catch(err){_iterator9.e(err);}finally{_iterator9.f();}if("object"==_typeof2(i)&&null!==i)a=i;else if(_typeof2(i)<"u")throw new TypeError("'options' must be an object.");}else{var _e25=!1,_r6=Object.getOwnPropertyNames(n);var _iterator10=_createForOfIteratorHelper2(t),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var _i10=_step10.value;if(-1!==_r6.indexOf(_i10)){var _t17=n[_i10];(null===_t17||_t17 instanceof Ne)&&(_e25=!0,s=!1,o[_i10]=_t17);}}}catch(err){_iterator10.e(err);}finally{_iterator10.f();}if(_e25){if("object"==_typeof2(i)&&null!==i)a=i;else if(_typeof2(i)<"u")throw new TypeError("'options' must be an object.");}else a=n;}}else if(_typeof2(n)<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");var _iterator11=_createForOfIteratorHelper2(_e23),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var _t18=_step11.value;if(_typeof2(r[_t18])>"u")throw new Error("input '".concat(_t18,"' is missing in 'feeds'."));}}catch(err){_iterator11.e(err);}finally{_iterator11.f();}if(s){var _iterator12=_createForOfIteratorHelper2(t),_step12;try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var _e26=_step12.value;o[_e26]=null;}}catch(err){_iterator12.e(err);}finally{_iterator12.f();}}return[o,a];}},{key:"convertHandlerReturnTypeToMapOfTensors",value:function convertHandlerReturnTypeToMapOfTensors(_e27){var t={};for(var _r7 in _e27)if(Object.hasOwnProperty.call(_e27,_r7)){var _n13=_e27[_r7];t[_r7]=_n13 instanceof Ne?_n13:new Ne(_n13.type,_n13.data,_n13.dims);}return t;}},{key:"lazyResetGrad",value:function(){var _lazyResetGrad=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee10(){return _regeneratorRuntime2().wrap(function _callee10$(_context10){while(1)switch(_context10.prev=_context10.next){case 0:_context10.next=2;return this.handler.lazyResetGrad();case 2:case"end":return _context10.stop();}},_callee10,this);}));function lazyResetGrad(){return _lazyResetGrad.apply(this,arguments);}return lazyResetGrad;}()},{key:"runTrainStep",value:function(){var _runTrainStep=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee11(_e28,t,r){var _this$typeNarrowingFo,_this$typeNarrowingFo2,n,i,o;return _regeneratorRuntime2().wrap(function _callee11$(_context11){while(1)switch(_context11.prev=_context11.next){case 0:_this$typeNarrowingFo=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,_e28,t,r);_this$typeNarrowingFo2=_slicedToArray2(_this$typeNarrowingFo,2);n=_this$typeNarrowingFo2[0];i=_this$typeNarrowingFo2[1];_context11.next=6;return this.handler.runTrainStep(_e28,n,i);case 6:o=_context11.sent;return _context11.abrupt("return",this.convertHandlerReturnTypeToMapOfTensors(o));case 8:case"end":return _context11.stop();}},_callee11,this);}));function runTrainStep(_x16,_x17,_x18){return _runTrainStep.apply(this,arguments);}return runTrainStep;}()},{key:"runOptimizerStep",value:function(){var _runOptimizerStep=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee12(_e29){return _regeneratorRuntime2().wrap(function _callee12$(_context12){while(1)switch(_context12.prev=_context12.next){case 0:if(this.hasOptimizerModel){_context12.next=2;break;}throw new Error("This TrainingSession has no OptimizerModel loaded.");case 2:_context12.next=4;return this.handler.runOptimizerStep(_e29||{});case 4:case"end":return _context12.stop();}},_callee12,this);}));function runOptimizerStep(_x19){return _runOptimizerStep.apply(this,arguments);}return runOptimizerStep;}()},{key:"runEvalStep",value:function(){var _runEvalStep=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee13(_e30,t,r){var _this$typeNarrowingFo3,_this$typeNarrowingFo4,_n14,_i11,_o8;return _regeneratorRuntime2().wrap(function _callee13$(_context13){while(1)switch(_context13.prev=_context13.next){case 0:if(!this.hasEvalModel){_context13.next=9;break;}_this$typeNarrowingFo3=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,_e30,t,r);_this$typeNarrowingFo4=_slicedToArray2(_this$typeNarrowingFo3,2);_n14=_this$typeNarrowingFo4[0];_i11=_this$typeNarrowingFo4[1];_context13.next=7;return this.handler.runEvalStep(_e30,_n14,_i11);case 7:_o8=_context13.sent;return _context13.abrupt("return",this.convertHandlerReturnTypeToMapOfTensors(_o8));case 9:throw new Error("This TrainingSession has no EvalModel loaded.");case 10:case"end":return _context13.stop();}},_callee13,this);}));function runEvalStep(_x20,_x21,_x22){return _runEvalStep.apply(this,arguments);}return runEvalStep;}()},{key:"getParametersSize",value:function(){var _getParametersSize=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee14(){var _e31,_args14=arguments;return _regeneratorRuntime2().wrap(function _callee14$(_context14){while(1)switch(_context14.prev=_context14.next){case 0:_e31=_args14.length>0&&_args14[0]!==undefined?_args14[0]:!0;return _context14.abrupt("return",this.handler.getParametersSize(_e31));case 2:case"end":return _context14.stop();}},_callee14,this);}));function getParametersSize(){return _getParametersSize.apply(this,arguments);}return getParametersSize;}()},{key:"loadParametersBuffer",value:function(){var _loadParametersBuffer=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee15(_e32){var t,r,_args15=arguments;return _regeneratorRuntime2().wrap(function _callee15$(_context15){while(1)switch(_context15.prev=_context15.next){case 0:t=_args15.length>1&&_args15[1]!==undefined?_args15[1]:!0;_context15.next=3;return this.getParametersSize(t);case 3:r=_context15.sent;if(!(_e32.length!==4*r)){_context15.next=6;break;}throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");case 6:return _context15.abrupt("return",this.handler.loadParametersBuffer(_e32,t));case 7:case"end":return _context15.stop();}},_callee15,this);}));function loadParametersBuffer(_x23){return _loadParametersBuffer.apply(this,arguments);}return loadParametersBuffer;}()},{key:"getContiguousParameters",value:function(){var _getContiguousParameters=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee16(){var _e33,_args16=arguments;return _regeneratorRuntime2().wrap(function _callee16$(_context16){while(1)switch(_context16.prev=_context16.next){case 0:_e33=_args16.length>0&&_args16[0]!==undefined?_args16[0]:!0;return _context16.abrupt("return",this.handler.getContiguousParameters(_e33));case 2:case"end":return _context16.stop();}},_callee16,this);}));function getContiguousParameters(){return _getContiguousParameters.apply(this,arguments);}return getContiguousParameters;}()},{key:"release",value:function(){var _release2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee17(){return _regeneratorRuntime2().wrap(function _callee17$(_context17){while(1)switch(_context17.prev=_context17.next){case 0:return _context17.abrupt("return",this.handler.dispose());case 1:case"end":return _context17.stop();}},_callee17,this);}));function release(){return _release2.apply(this,arguments);}return release;}()}],[{key:"create",value:function(){var _create2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee18(t,r){var n,i,o,a,s,_r8;return _regeneratorRuntime2().wrap(function _callee18$(_context18){while(1)switch(_context18.prev=_context18.next){case 0:n=t.evalModel||"";i=t.optimizerModel||"";o=r||{};a=(o.executionProviders||[]).map(function(_e22){return"string"==typeof _e22?_e22:_e22.name;});_context18.next=6;return Rn(a);case 6:s=_context18.sent;if(!s.createTrainingSessionHandler){_context18.next=12;break;}_context18.next=10;return s.createTrainingSessionHandler(t.checkpointState,t.trainModel,n,i,o);case 10:_r8=_context18.sent;return _context18.abrupt("return",new e(_r8,!!t.optimizerModel,!!t.evalModel));case 12:throw new Error(Gd);case 13:case"end":return _context18.stop();}},_callee18);}));function create(_x24,_x25){return _create2.apply(this,arguments);}return create;}()}]);}();}),Ud,Is=L(function(){Os(),Ud=Vn;}),ei={};cr(ei,{InferenceSession:function InferenceSession(){return Md;},TRACE:function TRACE(){return Ts;},TRACE_FUNC_BEGIN:function TRACE_FUNC_BEGIN(){return mr;},TRACE_FUNC_END:function TRACE_FUNC_END(){return br;},Tensor:function Tensor(){return Ne;},TrainingSession:function TrainingSession(){return Ud;},env:function env(){return ee;},registerBackend:function registerBackend(){return dr;}});var It=L(function(){es(),os(),vs(),zn(),Qo(),_s(),Is();});function Qt(e,t,r,n){if(void 0===t)return Wd(e);if(void 0===r)Hn(e,t,1);else if("number"==typeof r&&void 0===n)Hn(e,t,r);else if("string"==typeof r&&void 0===n)Hn(e,r,1,t);else{if("string"!=typeof r||"number"!=typeof n)throw new TypeError("input is valid");Hn(e,r,n,t);}}function Wd(e){return{verbose:Qt.verbose.bind(null,e),info:Qt.info.bind(null,e),warning:Qt.warning.bind(null,e),error:Qt.error.bind(null,e),fatal:Qt.fatal.bind(null,e)};}function Hn(e,t,r,n){var i=sn[n||""]||sn[""];As[e]<As[i.minimalSeverity]||(i.logDateTime&&(t="".concat(new Date().toISOString(),"|").concat(t)),i.logSourceLocation,zd[i.provider].log(e,t,n));}var ti,ri,As,zd,Es,sn,pe,qn,Yn,Xn,jn,dt=L(function(){ti=/*#__PURE__*/function(){function ti(){_classCallCheck2(this,ti);}return _createClass2(ti,[{key:"log",value:function log(e,t,r){}}]);}(),ri=/*#__PURE__*/function(){function ri(){_classCallCheck2(this,ri);}return _createClass2(ri,[{key:"log",value:function log(e,t,r){console.log("".concat(this.color(e)," ").concat(r?"[35m"+r+"[0m ":"").concat(t));}},{key:"color",value:function color(e){switch(e){case"verbose":return"[34;40mv[0m";case"info":return"[32mi[0m";case"warning":return"[30;43mw[0m";case"error":return"[31;40me[0m";case"fatal":return"[101mf[0m";default:throw new Error("unsupported severity: ".concat(e));}}}]);}(),As={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},zd={none:new ti(),console:new ri()},sn={"":Es={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1}},function(e){function t(e){sn={},r("",e||{});}function r(e,r){if("*"===e)t(r);else{var _t19=sn[e]||Es;sn[e]={provider:r.provider||_t19.provider,minimalSeverity:r.minimalSeverity||_t19.minimalSeverity,logDateTime:void 0===r.logDateTime?_t19.logDateTime:r.logDateTime,logSourceLocation:void 0===r.logSourceLocation?_t19.logSourceLocation:r.logSourceLocation};}}e.verbose=function(t,r){e("verbose",t,r);},e.info=function(t,r){e("info",t,r);},e.warning=function(t,r){e("warning",t,r);},e.error=function(t,r){e("error",t,r);},e.fatal=function(t,r){e("fatal",t,r);},e.reset=t,e.set=r,e.setWithEnv=function(e){var t={};e.logLevel&&(t.minimalSeverity=e.logLevel),r("",t);};}(Qt||(Qt={})),pe=Qt,qn=/*#__PURE__*/function(){function qn(e,t,r,n,i,o){_classCallCheck2(this,qn);this.category=e,this.name=t,this.startTime=r,this.endCallback=n,this.timer=i,this.ctx=o;}return _createClass2(qn,[{key:"end",value:function(){var _end=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee19(){return _regeneratorRuntime2().wrap(function _callee19$(_context19){while(1)switch(_context19.prev=_context19.next){case 0:return _context19.abrupt("return",this.endCallback(this));case 1:case"end":return _context19.stop();}},_callee19,this);}));function end(){return _end.apply(this,arguments);}return end;}()},{key:"checkTimer",value:function(){var _checkTimer=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee20(){return _regeneratorRuntime2().wrap(function _callee20$(_context20){while(1)switch(_context20.prev=_context20.next){case 0:if(!(void 0===this.ctx||void 0===this.timer)){_context20.next=2;break;}throw new Error("No webgl timer found");case 2:return _context20.abrupt("return",(this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)));case 3:case"end":return _context20.stop();}},_callee20,this);}));function checkTimer(){return _checkTimer.apply(this,arguments);}return checkTimer;}()}]);}(),Yn=/*#__PURE__*/_createClass2(function Yn(e,t,r,n){_classCallCheck2(this,Yn);this.category=e,this.name=t,this.startTime=r,this.endTime=n;}),Xn=/*#__PURE__*/function(){function Xn(e,t,r){_classCallCheck2(this,Xn);this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=void 0===e?1e4:e,this._flushBatchSize=void 0===t?10:t,this._flushIntervalInMilliseconds=void 0===r?5e3:r;}return _createClass2(Xn,[{key:"start",value:function start(){this._started=!0,this._timingEvents=[],this._flushTime=jn(),this._flushPointer=0;}},{key:"stop",value:function stop(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);}},{key:"event",value:function event(e,t,r,n){var i=this._started?this.begin(e,t,n):void 0,o=!1,a=r();if(a&&"function"==typeof a.then)return o=!0,new Promise(function(e,t){a.then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee21(t){return _regeneratorRuntime2().wrap(function _callee21$(_context21){while(1)switch(_context21.prev=_context21.next){case 0:_context21.t0=i;if(!_context21.t0){_context21.next=4;break;}_context21.next=4;return i.end();case 4:e(t);case 5:case"end":return _context21.stop();}},_callee21);}));return function(_x26){return _ref3.apply(this,arguments);};}(),/*#__PURE__*/function(){var _ref4=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee22(e){return _regeneratorRuntime2().wrap(function _callee22$(_context22){while(1)switch(_context22.prev=_context22.next){case 0:_context22.t0=i;if(!_context22.t0){_context22.next=4;break;}_context22.next=4;return i.end();case 4:t(e);case 5:case"end":return _context22.stop();}},_callee22);}));return function(_x27){return _ref4.apply(this,arguments);};}());});if(!o&&i){var _e34=i.end();if(_e34&&"function"==typeof _e34.then)return new Promise(function(t,r){_e34.then(function(){t(a);},function(e){r(e);});});}return a;}},{key:"begin",value:function begin(e,t,r){var _this=this;if(!this._started)throw new Error("profiler is not started yet");if(void 0===r){var _r9=jn();return this.flush(_r9),new qn(e,t,_r9,function(e){return _this.endSync(e);});}{var _n15=r.beginTimer();return new qn(e,t,0,/*#__PURE__*/function(){var _ref5=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee23(e){return _regeneratorRuntime2().wrap(function _callee23$(_context23){while(1)switch(_context23.prev=_context23.next){case 0:return _context23.abrupt("return",_this.end(e));case 1:case"end":return _context23.stop();}},_callee23);}));return function(_x28){return _ref5.apply(this,arguments);};}(),_n15,r);}}},{key:"end",value:function(){var _end2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee24(e){var t;return _regeneratorRuntime2().wrap(function _callee24$(_context24){while(1)switch(_context24.prev=_context24.next){case 0:_context24.next=2;return e.checkTimer();case 2:t=_context24.sent;this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new Yn(e.category,e.name,e.startTime,t)),this.flush(t));case 4:case"end":return _context24.stop();}},_callee24,this);}));function end(_x29){return _end2.apply(this,arguments);}return end;}()},{key:"endSync",value:function endSync(e){var t=jn();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new Yn(e.category,e.name,e.startTime,t)),this.flush(t));}},{key:"logOneEvent",value:function logOneEvent(e){pe.verbose("Profiler.".concat(e.category),"".concat((e.endTime-e.startTime).toFixed(2),"ms on event '").concat(e.name,"' at ").concat(e.endTime.toFixed(2)));}},{key:"flush",value:function flush(e){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||e-this._flushTime>=this._flushIntervalInMilliseconds){for(var _e35=this._flushPointer;this._flushPointer<_e35+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=jn();}}},{key:"started",get:function get(){return this._started;}}],[{key:"create",value:function create(e){return void 0===e?new this():new this(e.maxNumberEvents,e.flushBatchSize,e.flushIntervalInMilliseconds);}}]);}(),jn=(typeof performance==="undefined"?"undefined":_typeof2(performance))<"u"&&performance.now?function(){return performance.now();}:Date.now;});function Ps(e,t,r){var _iterator13=_createForOfIteratorHelper2(r),_step13;try{for(_iterator13.s();!(_step13=_iterator13.n()).done;){var _n16=_step13.value;var _r10=_n16[0],_i12=_n16[1],_o9=_n16[2],_a6=_n16[3],_s5=_n16[4];if(e.opType===_r10){var _iterator14=_createForOfIteratorHelper2(t),_step14;try{for(_iterator14.s();!(_step14=_iterator14.n()).done;){var _e36=_step14.value;if((_e36.domain===_i12||"ai.onnx"===_e36.domain&&""===_i12)&&Vd(_e36.version,_o9))return{opImpl:_a6,opInit:_s5};}}catch(err){_iterator14.e(err);}finally{_iterator14.f();}}}}catch(err){_iterator13.e(err);}finally{_iterator13.f();}throw new TypeError("cannot resolve operator '".concat(e.opType,"' with opsets: ").concat(t.map(function(e){return"".concat(e.domain||"ai.onnx"," v").concat(e.version);}).join(", ")));}function Vd(e,t){if(t.endsWith("+")){var _r11=Number.parseInt(t.substring(0,t.length-1),10);return!isNaN(_r11)&&_r11<=e;}if(2===t.split("-").length){var _r12=t.split("-"),_n17=Number.parseInt(_r12[0],10),_i13=Number.parseInt(_r12[1],10);return!isNaN(_n17)&&!isNaN(_i13)&&_n17<=e&&e<=_i13;}return Number.parseInt(t,10)===e;}var Ds=L(function(){}),Ls=ye(function(e){e.__esModule=!0;var t=function(){function e(t){if(!t)throw new TypeError("Invalid argument; `value` has no value.");this.value=e.EMPTY,t&&e.isGuid(t)&&(this.value=t);}return e.isGuid=function(t){var r=t.toString();return t&&(t instanceof e||e.validator.test(r));},e.create=function(){return new e([e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-"));},e.createEmpty=function(){return new e("emptyguid");},e.parse=function(t){return new e(t);},e.raw=function(){return[e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-");},e.gen=function(e){for(var t="",r=0;r<e;r++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t;},e.prototype.equals=function(t){return e.isGuid(t)&&this.value===t.toString();},e.prototype.isEmpty=function(){return this.value===e.EMPTY;},e.prototype.toString=function(){return this.value;},e.prototype.toJSON=function(){return{value:this.value};},e.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),e.EMPTY="00000000-0000-0000-0000-000000000000",e;}();e.Guid=t;});function Te(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r;}function He(e){return!0===(e&&e.__isLong__);}function Fs(e){var t=Math.clz32(e&-e);return e?31-t:t;}function gr(e,t){var r,n,i;return t?(i=0<=(e>>>=0)&&e<256)&&(n=$s[e])?n:(r=le(e,0,!0),i&&($s[e]=r),r):(i=-128<=(e|=0)&&e<128)&&(n=Cs[e])?n:(r=le(e,e<0?-1:0,!1),i&&(Cs[e]=r),r);}function mt(e,t){if(isNaN(e))return t?jt:St;if(t){if(e<0)return jt;if(e>=Rs)return Us;}else{if(e<=-ks)return rt;if(e+1>=ks)return Gs;}return e<0?mt(-e,t).neg():le(e%Mr|0,e/Mr|0,t);}function le(e,t,r){return new Te(e,t,r);}function ii(e,t,r){if(0===e.length)throw Error("empty string");if("number"==typeof t?(r=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?jt:St;if((r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return ii(e.substring(1),t,r).neg();for(var i=mt(Kn(r,8)),o=St,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),u=parseInt(e.substring(a,a+s),r);if(s<8){var l=mt(Kn(r,s));o=o.mul(l).add(mt(u));}else o=(o=o.mul(i)).add(mt(u));}return o.unsigned=t,o;}function At(e,t){return"number"==typeof e?mt(e,t):"string"==typeof e?ii(e,t):le(e.low,e.high,"boolean"==typeof t?t:e.unsigned);}var ht,Cs,$s,Kn,Bs,jd,Mr,Rs,ks,Ns,St,jt,Rr,Ms,oi,Gs,Us,rt,k,qt,ai=L(function(){ht=null;try{ht=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports;}catch(_unused){}Te.prototype.__isLong__,Object.defineProperty(Te.prototype,"__isLong__",{value:!0}),Te.isLong=He,Cs={},$s={},Te.fromInt=gr,Te.fromNumber=mt,Te.fromBits=le,Kn=Math.pow,Te.fromString=ii,Te.fromValue=At,ks=(Rs=(Mr=(Bs=65536)*Bs)*Mr)/2,Ns=gr(jd=1<<24),St=gr(0),Te.ZERO=St,jt=gr(0,!0),Te.UZERO=jt,Rr=gr(1),Te.ONE=Rr,Ms=gr(1,!0),Te.UONE=Ms,oi=gr(-1),Te.NEG_ONE=oi,Gs=le(-1,2147483647,!1),Te.MAX_VALUE=Gs,Us=le(-1,-1,!0),Te.MAX_UNSIGNED_VALUE=Us,rt=le(0,-2147483648,!1),Te.MIN_VALUE=rt,(k=Te.prototype).toInt=function(){return this.unsigned?this.low>>>0:this.low;},k.toNumber=function(){return this.unsigned?(this.high>>>0)*Mr+(this.low>>>0):this.high*Mr+(this.low>>>0);},k.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(rt)){var t=mt(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e);}return"-"+this.neg().toString(e);}for(var i=mt(Kn(e,6),this.unsigned),o=this,a="";;){var s=o.div(i),u=(o.sub(s.mul(i)).toInt()>>>0).toString(e);if((o=s).isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a;}},k.getHighBits=function(){return this.high;},k.getHighBitsUnsigned=function(){return this.high>>>0;},k.getLowBits=function(){return this.low;},k.getLowBitsUnsigned=function(){return this.low>>>0;},k.getNumBitsAbs=function(){if(this.isNegative())return this.eq(rt)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return 0!=this.high?t+33:t+1;},k.isZero=function(){return 0===this.high&&0===this.low;},k.eqz=k.isZero,k.isNegative=function(){return!this.unsigned&&this.high<0;},k.isPositive=function(){return this.unsigned||this.high>=0;},k.isOdd=function(){return!(1&~this.low);},k.isEven=function(){return!(1&this.low);},k.equals=function(e){return He(e)||(e=At(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low;},k.eq=k.equals,k.notEquals=function(e){return!this.eq(e);},k.neq=k.notEquals,k.ne=k.notEquals,k.lessThan=function(e){return this.comp(e)<0;},k.lt=k.lessThan,k.lessThanOrEqual=function(e){return this.comp(e)<=0;},k.lte=k.lessThanOrEqual,k.le=k.lessThanOrEqual,k.greaterThan=function(e){return this.comp(e)>0;},k.gt=k.greaterThan,k.greaterThanOrEqual=function(e){return this.comp(e)>=0;},k.gte=k.greaterThanOrEqual,k.ge=k.greaterThanOrEqual,k.compare=function(e){if(He(e)||(e=At(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1;},k.comp=k.compare,k.negate=function(){return!this.unsigned&&this.eq(rt)?rt:this.not().add(Rr);},k.neg=k.negate,k.add=function(e){He(e)||(e=At(e));var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=0,l=0,c=0,h=0;return c+=(h+=i+(65535&e.low))>>>16,l+=(c+=n+s)>>>16,u+=(l+=r+a)>>>16,u+=t+o,le((c&=65535)<<16|(h&=65535),(u&=65535)<<16|(l&=65535),this.unsigned);},k.subtract=function(e){return He(e)||(e=At(e)),this.add(e.neg());},k.sub=k.subtract,k.multiply=function(e){if(this.isZero())return this;if(He(e)||(e=At(e)),ht)return le(ht.mul(this.low,this.high,e.low,e.high),ht.get_high(),this.unsigned);if(e.isZero())return this.unsigned?jt:St;if(this.eq(rt))return e.isOdd()?rt:St;if(e.eq(rt))return this.isOdd()?rt:St;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(Ns)&&e.lt(Ns))return mt(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=65535&e.low,l=0,c=0,h=0,f=0;return h+=(f+=i*u)>>>16,c+=(h+=n*u)>>>16,h&=65535,c+=(h+=i*s)>>>16,l+=(c+=r*u)>>>16,c&=65535,l+=(c+=n*s)>>>16,c&=65535,l+=(c+=i*a)>>>16,l+=t*u+r*s+n*a+i*o,le((h&=65535)<<16|(f&=65535),(l&=65535)<<16|(c&=65535),this.unsigned);},k.mul=k.multiply,k.divide=function(e){if(He(e)||(e=At(e)),e.isZero())throw Error("division by zero");var t,r,n;if(ht)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?le((this.unsigned?ht.div_u:ht.div_s)(this.low,this.high,e.low,e.high),ht.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?jt:St;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return jt;if(e.gt(this.shru(1)))return Ms;n=jt;}else{if(this.eq(rt))return e.eq(Rr)||e.eq(oi)?rt:e.eq(rt)?Rr:(t=this.shr(1).div(e).shl(1)).eq(St)?e.isNegative()?Rr:oi:(r=this.sub(e.mul(t)),n=t.add(r.div(e)));if(e.eq(rt))return this.unsigned?jt:St;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();n=St;}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(t)/Math.LN2),o=i<=48?1:Kn(2,i-48),a=mt(t),s=a.mul(e);s.isNegative()||s.gt(r);)s=(a=mt(t-=o,this.unsigned)).mul(e);a.isZero()&&(a=Rr),n=n.add(a),r=r.sub(s);}return n;},k.div=k.divide,k.modulo=function(e){return He(e)||(e=At(e)),ht?le((this.unsigned?ht.rem_u:ht.rem_s)(this.low,this.high,e.low,e.high),ht.get_high(),this.unsigned):this.sub(this.div(e).mul(e));},k.mod=k.modulo,k.rem=k.modulo,k.not=function(){return le(~this.low,~this.high,this.unsigned);},k.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32;},k.clz=k.countLeadingZeros,k.countTrailingZeros=function(){return this.low?Fs(this.low):Fs(this.high)+32;},k.ctz=k.countTrailingZeros,k.and=function(e){return He(e)||(e=At(e)),le(this.low&e.low,this.high&e.high,this.unsigned);},k.or=function(e){return He(e)||(e=At(e)),le(this.low|e.low,this.high|e.high,this.unsigned);},k.xor=function(e){return He(e)||(e=At(e)),le(this.low^e.low,this.high^e.high,this.unsigned);},k.shiftLeft=function(e){return He(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?le(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):le(0,this.low<<e-32,this.unsigned);},k.shl=k.shiftLeft,k.shiftRight=function(e){return He(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?le(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):le(this.high>>e-32,this.high>=0?0:-1,this.unsigned);},k.shr=k.shiftRight,k.shiftRightUnsigned=function(e){return He(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?le(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):le(32===e?this.high:this.high>>>e-32,0,this.unsigned);},k.shru=k.shiftRightUnsigned,k.shr_u=k.shiftRightUnsigned,k.rotateLeft=function(e){var t;return He(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?le(this.high,this.low,this.unsigned):e<32?(t=32-e,le(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(t=32-(e-=32),le(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned));},k.rotl=k.rotateLeft,k.rotateRight=function(e){var t;return He(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?le(this.high,this.low,this.unsigned):e<32?(t=32-e,le(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(t=32-(e-=32),le(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned));},k.rotr=k.rotateRight,k.toSigned=function(){return this.unsigned?le(this.low,this.high,!1):this;},k.toUnsigned=function(){return this.unsigned?this:le(this.low,this.high,!0);},k.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE();},k.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24];},k.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t];},Te.fromBytes=function(e,t,r){return r?Te.fromBytesLE(e,t):Te.fromBytesBE(e,t);},Te.fromBytesLE=function(e,t){return new Te(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t);},Te.fromBytesBE=function(e,t){return new Te(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t);},qt=Te;}),I,Jn=L(function(){I={},I.Table,I.SIZEOF_SHORT=2,I.SIZEOF_INT=4,I.FILE_IDENTIFIER_LENGTH=4,I.SIZE_PREFIX_LENGTH=4,I.Encoding={UTF8_BYTES:1,UTF16_STRING:2},I.int32=new Int32Array(2),I.float32=new Float32Array(I.int32.buffer),I.float64=new Float64Array(I.int32.buffer),I.isLittleEndian=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0],I.Long=function(e,t){this.low=0|e,this.high=0|t;},I.Long.create=function(e,t){return 0==e&&0==t?I.Long.ZERO:new I.Long(e,t);},I.Long.prototype.toFloat64=function(){return(this.low>>>0)+4294967296*this.high;},I.Long.prototype.equals=function(e){return this.low==e.low&&this.high==e.high;},I.Long.ZERO=new I.Long(0,0),I.Builder=function(e){if(e)var t=e;else t=1024;this.bb=I.ByteBuffer.allocate(t),this.space=t,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1;},I.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1;},I.Builder.prototype.forceDefaults=function(e){this.force_defaults=e;},I.Builder.prototype.dataBuffer=function(){return this.bb;},I.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset());},I.Builder.prototype.prep=function(e,t){e>this.minalign&&(this.minalign=e);for(var r=1+~(this.bb.capacity()-this.space+t)&e-1;this.space<r+e+t;){var n=this.bb.capacity();this.bb=I.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-n;}this.pad(r);},I.Builder.prototype.pad=function(e){for(var t=0;t<e;t++)this.bb.writeInt8(--this.space,0);},I.Builder.prototype.writeInt8=function(e){this.bb.writeInt8(this.space-=1,e);},I.Builder.prototype.writeInt16=function(e){this.bb.writeInt16(this.space-=2,e);},I.Builder.prototype.writeInt32=function(e){this.bb.writeInt32(this.space-=4,e);},I.Builder.prototype.writeInt64=function(e){this.bb.writeInt64(this.space-=8,e);},I.Builder.prototype.writeFloat32=function(e){this.bb.writeFloat32(this.space-=4,e);},I.Builder.prototype.writeFloat64=function(e){this.bb.writeFloat64(this.space-=8,e);},I.Builder.prototype.addInt8=function(e){this.prep(1,0),this.writeInt8(e);},I.Builder.prototype.addInt16=function(e){this.prep(2,0),this.writeInt16(e);},I.Builder.prototype.addInt32=function(e){this.prep(4,0),this.writeInt32(e);},I.Builder.prototype.addInt64=function(e){this.prep(8,0),this.writeInt64(e);},I.Builder.prototype.addFloat32=function(e){this.prep(4,0),this.writeFloat32(e);},I.Builder.prototype.addFloat64=function(e){this.prep(8,0),this.writeFloat64(e);},I.Builder.prototype.addFieldInt8=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt8(t),this.slot(e));},I.Builder.prototype.addFieldInt16=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt16(t),this.slot(e));},I.Builder.prototype.addFieldInt32=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt32(t),this.slot(e));},I.Builder.prototype.addFieldInt64=function(e,t,r){(this.force_defaults||!t.equals(r))&&(this.addInt64(t),this.slot(e));},I.Builder.prototype.addFieldFloat32=function(e,t,r){(this.force_defaults||t!=r)&&(this.addFloat32(t),this.slot(e));},I.Builder.prototype.addFieldFloat64=function(e,t,r){(this.force_defaults||t!=r)&&(this.addFloat64(t),this.slot(e));},I.Builder.prototype.addFieldOffset=function(e,t,r){(this.force_defaults||t!=r)&&(this.addOffset(t),this.slot(e));},I.Builder.prototype.addFieldStruct=function(e,t,r){t!=r&&(this.nested(t),this.slot(e));},I.Builder.prototype.nested=function(e){if(e!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.");},I.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.");},I.Builder.prototype.slot=function(e){this.vtable[e]=this.offset();},I.Builder.prototype.offset=function(){return this.bb.capacity()-this.space;},I.Builder.growByteBuffer=function(e){var t=e.capacity();if(3221225472&t)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var r=t<<1,n=I.ByteBuffer.allocate(r);return n.setPosition(r-t),n.bytes().set(e.bytes(),r-t),n;},I.Builder.prototype.addOffset=function(e){this.prep(I.SIZEOF_INT,0),this.writeInt32(this.offset()-e+I.SIZEOF_INT);},I.Builder.prototype.startObject=function(e){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=e;for(var t=0;t<e;t++)this.vtable[t]=0;this.isNested=!0,this.object_start=this.offset();},I.Builder.prototype.endObject=function(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var e=this.offset(),t=this.vtable_in_use-1;t>=0&&0==this.vtable[t];t--);for(var r=t+1;t>=0;t--)this.addInt16(0!=this.vtable[t]?e-this.vtable[t]:0);this.addInt16(e-this.object_start);var n=(r+2)*I.SIZEOF_SHORT;this.addInt16(n);var i=0,o=this.space;e:for(t=0;t<this.vtables.length;t++){var a=this.bb.capacity()-this.vtables[t];if(n==this.bb.readInt16(a)){for(var s=I.SIZEOF_SHORT;s<n;s+=I.SIZEOF_SHORT)if(this.bb.readInt16(o+s)!=this.bb.readInt16(a+s))continue e;i=this.vtables[t];break;}}return i?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,i-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e;},I.Builder.prototype.finish=function(e,t,r){var n=r?I.SIZE_PREFIX_LENGTH:0;if(t){var i=t;if(this.prep(this.minalign,I.SIZEOF_INT+I.FILE_IDENTIFIER_LENGTH+n),i.length!=I.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+I.FILE_IDENTIFIER_LENGTH);for(var o=I.FILE_IDENTIFIER_LENGTH-1;o>=0;o--)this.writeInt8(i.charCodeAt(o));}this.prep(this.minalign,I.SIZEOF_INT+n),this.addOffset(e),n&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space);},I.Builder.prototype.finishSizePrefixed=function(e,t){this.finish(e,t,!0);},I.Builder.prototype.requiredField=function(e,t){var r=this.bb.capacity()-e,n=r-this.bb.readInt32(r);if(!(0!=this.bb.readInt16(n+t)))throw new Error("FlatBuffers: field "+t+" must be set");},I.Builder.prototype.startVector=function(e,t,r){this.notNested(),this.vector_num_elems=t,this.prep(I.SIZEOF_INT,e*t),this.prep(r,e*t);},I.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset();},I.Builder.prototype.createString=function(e){if(e instanceof Uint8Array)var t=e;else{t=[];for(var r=0;r<e.length;){var n,i=e.charCodeAt(r++);if(i<55296||i>=56320)n=i;else n=(i<<10)+e.charCodeAt(r++)+-56613888;n<128?t.push(n):(n<2048?t.push(n>>6&31|192):(n<65536?t.push(n>>12&15|224):t.push(n>>18&7|240,n>>12&63|128),t.push(n>>6&63|128)),t.push(63&n|128));}}this.addInt8(0),this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length);r=0;for(var o=this.space,a=this.bb.bytes();r<t.length;r++)a[o++]=t[r];return this.endVector();},I.Builder.prototype.createLong=function(e,t){return I.Long.create(e,t);},I.ByteBuffer=function(e){this.bytes_=e,this.position_=0;},I.ByteBuffer.allocate=function(e){return new I.ByteBuffer(new Uint8Array(e));},I.ByteBuffer.prototype.clear=function(){this.position_=0;},I.ByteBuffer.prototype.bytes=function(){return this.bytes_;},I.ByteBuffer.prototype.position=function(){return this.position_;},I.ByteBuffer.prototype.setPosition=function(e){this.position_=e;},I.ByteBuffer.prototype.capacity=function(){return this.bytes_.length;},I.ByteBuffer.prototype.readInt8=function(e){return this.readUint8(e)<<24>>24;},I.ByteBuffer.prototype.readUint8=function(e){return this.bytes_[e];},I.ByteBuffer.prototype.readInt16=function(e){return this.readUint16(e)<<16>>16;},I.ByteBuffer.prototype.readUint16=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8;},I.ByteBuffer.prototype.readInt32=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24;},I.ByteBuffer.prototype.readUint32=function(e){return this.readInt32(e)>>>0;},I.ByteBuffer.prototype.readInt64=function(e){return new I.Long(this.readInt32(e),this.readInt32(e+4));},I.ByteBuffer.prototype.readUint64=function(e){return new I.Long(this.readUint32(e),this.readUint32(e+4));},I.ByteBuffer.prototype.readFloat32=function(e){return I.int32[0]=this.readInt32(e),I.float32[0];},I.ByteBuffer.prototype.readFloat64=function(e){return I.int32[I.isLittleEndian?0:1]=this.readInt32(e),I.int32[I.isLittleEndian?1:0]=this.readInt32(e+4),I.float64[0];},I.ByteBuffer.prototype.writeInt8=function(e,t){this.bytes_[e]=t;},I.ByteBuffer.prototype.writeUint8=function(e,t){this.bytes_[e]=t;},I.ByteBuffer.prototype.writeInt16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8;},I.ByteBuffer.prototype.writeUint16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8;},I.ByteBuffer.prototype.writeInt32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24;},I.ByteBuffer.prototype.writeUint32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24;},I.ByteBuffer.prototype.writeInt64=function(e,t){this.writeInt32(e,t.low),this.writeInt32(e+4,t.high);},I.ByteBuffer.prototype.writeUint64=function(e,t){this.writeUint32(e,t.low),this.writeUint32(e+4,t.high);},I.ByteBuffer.prototype.writeFloat32=function(e,t){I.float32[0]=t,this.writeInt32(e,I.int32[0]);},I.ByteBuffer.prototype.writeFloat64=function(e,t){I.float64[0]=t,this.writeInt32(e,I.int32[I.isLittleEndian?0:1]),this.writeInt32(e+4,I.int32[I.isLittleEndian?1:0]);},I.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+I.SIZEOF_INT+I.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var e="",t=0;t<I.FILE_IDENTIFIER_LENGTH;t++)e+=String.fromCharCode(this.readInt8(this.position_+I.SIZEOF_INT+t));return e;},I.ByteBuffer.prototype.__offset=function(e,t){var r=e-this.readInt32(e);return t<this.readInt16(r)?this.readInt16(r+t):0;},I.ByteBuffer.prototype.__union=function(e,t){return e.bb_pos=t+this.readInt32(t),e.bb=this,e;},I.ByteBuffer.prototype.__string=function(e,t){e+=this.readInt32(e);var r=this.readInt32(e),n="",i=0;if(e+=I.SIZEOF_INT,t===I.Encoding.UTF8_BYTES)return this.bytes_.subarray(e,e+r);for(;i<r;){var o,a=this.readUint8(e+i++);if(a<192)o=a;else{var s=this.readUint8(e+i++);if(a<224)o=(31&a)<<6|63&s;else{var u=this.readUint8(e+i++);if(a<240)o=(15&a)<<12|(63&s)<<6|63&u;else o=(7&a)<<18|(63&s)<<12|(63&u)<<6|63&this.readUint8(e+i++);}}o<65536?n+=String.fromCharCode(o):(o-=65536,n+=String.fromCharCode(55296+(o>>10),56320+(1023&o)));}return n;},I.ByteBuffer.prototype.__indirect=function(e){return e+this.readInt32(e);},I.ByteBuffer.prototype.__vector=function(e){return e+this.readInt32(e)+I.SIZEOF_INT;},I.ByteBuffer.prototype.__vector_len=function(e){return this.readInt32(e+this.readInt32(e));},I.ByteBuffer.prototype.__has_identifier=function(e){if(e.length!=I.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+I.FILE_IDENTIFIER_LENGTH);for(var t=0;t<I.FILE_IDENTIFIER_LENGTH;t++)if(e.charCodeAt(t)!=this.readInt8(this.position_+I.SIZEOF_INT+t))return!1;return!0;},I.ByteBuffer.prototype.createLong=function(e,t){return I.Long.create(e,t);};}),H,un=L(function(){Jn(),function(e){var t;(function(e){var t;(function(e){var t;(function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.FLOAT=1]="FLOAT",e[e.INT=2]="INT",e[e.STRING=3]="STRING",e[e.TENSOR=4]="TENSOR",e[e.GRAPH=5]="GRAPH",e[e.FLOATS=6]="FLOATS",e[e.INTS=7]="INTS",e[e.STRINGS=8]="STRINGS",e[e.TENSORS=9]="TENSORS",e[e.GRAPHS=10]="GRAPHS",e[e.SPARSE_TENSOR=11]="SPARSE_TENSOR",e[e.SPARSE_TENSORS=12]="SPARSE_TENSORS";})(t=e.AttributeType||(e.AttributeType={}));})(t=e.fbs||(e.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(e){var t;(function(e){var t;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VALUE=1]="VALUE",e[e.PARAM=2]="PARAM";})(t=e.DimensionValueType||(e.DimensionValueType={}));})(t=e.fbs||(e.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(e){var t;(function(e){var t;var r;(r=t=e.TensorDataType||(e.TensorDataType={}))[r.UNDEFINED=0]="UNDEFINED",r[r.FLOAT=1]="FLOAT",r[r.UINT8=2]="UINT8",r[r.INT8=3]="INT8",r[r.UINT16=4]="UINT16",r[r.INT16=5]="INT16",r[r.INT32=6]="INT32",r[r.INT64=7]="INT64",r[r.STRING=8]="STRING",r[r.BOOL=9]="BOOL",r[r.FLOAT16=10]="FLOAT16",r[r.DOUBLE=11]="DOUBLE",r[r.UINT32=12]="UINT32",r[r.UINT64=13]="UINT64",r[r.COMPLEX64=14]="COMPLEX64",r[r.COMPLEX128=15]="COMPLEX128",r[r.BFLOAT16=16]="BFLOAT16",r[r.FLOAT8E4M3FN=17]="FLOAT8E4M3FN",r[r.FLOAT8E4M3FNUZ=18]="FLOAT8E4M3FNUZ",r[r.FLOAT8E5M2=19]="FLOAT8E5M2",r[r.FLOAT8E5M2FNUZ=20]="FLOAT8E5M2FNUZ";})(t=e.fbs||(e.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(e){var t;(function(e){var t;(function(e){e[e.Primitive=0]="Primitive",e[e.Fused=1]="Fused";})(t=e.NodeType||(e.NodeType={}));})(t=e.fbs||(e.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(e){var t;(function(e){var t;(function(e){e[e.NONE=0]="NONE",e[e.tensor_type=1]="tensor_type",e[e.sequence_type=2]="sequence_type",e[e.map_type=3]="map_type";})(t=e.TypeInfoValue||(e.TypeInfoValue={}));})(t=e.fbs||(e.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(t){var r;(function(t){var r=/*#__PURE__*/function(){function r(){_classCallCheck2(this,r);this.bb=null,this.bb_pos=0;}return _createClass2(r,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"dim",value:function dim(t,_r13){var n=this.bb.__offset(this.bb_pos,4);return n?(_r13||new e.experimental.fbs.Dimension()).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null;}},{key:"dimLength",value:function dimLength(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0;}}],[{key:"getRootAsShape",value:function getRootAsShape(e,t){return(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsShape",value:function getSizePrefixedRootAsShape(e,t){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startShape",value:function startShape(e){e.startObject(1);}},{key:"addDim",value:function addDim(e,t){e.addFieldOffset(0,t,0);}},{key:"createDimVector",value:function createDimVector(e,t){e.startVector(4,t.length,4);for(var _r15=t.length-1;_r15>=0;_r15--)e.addOffset(t[_r15]);return e.endVector();}},{key:"startDimVector",value:function startDimVector(e,t){e.startVector(4,t,4);}},{key:"endShape",value:function endShape(e){return e.endObject();}},{key:"createShape",value:function createShape(e,t){return r.startShape(e),r.addDim(e,t),r.endShape(e);}}]);}();t.Shape=r;})(r=t.fbs||(t.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(t){var r;(function(t){var r=/*#__PURE__*/function(){function r(){_classCallCheck2(this,r);this.bb=null,this.bb_pos=0;}return _createClass2(r,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"value",value:function value(t){var _r16=this.bb.__offset(this.bb_pos,4);return _r16?(t||new e.experimental.fbs.DimensionValue()).__init(this.bb.__indirect(this.bb_pos+_r16),this.bb):null;}},{key:"denotation",value:function denotation(e){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null;}}],[{key:"getRootAsDimension",value:function getRootAsDimension(e,t){return(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsDimension",value:function getSizePrefixedRootAsDimension(e,t){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startDimension",value:function startDimension(e){e.startObject(2);}},{key:"addValue",value:function addValue(e,t){e.addFieldOffset(0,t,0);}},{key:"addDenotation",value:function addDenotation(e,t){e.addFieldOffset(1,t,0);}},{key:"endDimension",value:function endDimension(e){return e.endObject();}},{key:"createDimension",value:function createDimension(e,t,n){return r.startDimension(e),r.addValue(e,t),r.addDenotation(e,n),r.endDimension(e);}}]);}();t.Dimension=r;})(r=t.fbs||(t.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(e){var t;(function(e){var t=/*#__PURE__*/function(){function t(){_classCallCheck2(this,t);this.bb=null,this.bb_pos=0;}return _createClass2(t,[{key:"__init",value:function __init(e,_t20){return this.bb_pos=e,this.bb=_t20,this;}},{key:"dimType",value:function dimType(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt8(this.bb_pos+e):0;}},{key:"dimValue",value:function dimValue(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0);}},{key:"dimParam",value:function dimParam(e){var _t21=this.bb.__offset(this.bb_pos,8);return _t21?this.bb.__string(this.bb_pos+_t21,e):null;}}],[{key:"getRootAsDimensionValue",value:function getRootAsDimensionValue(e,r){return(r||new t()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsDimensionValue",value:function getSizePrefixedRootAsDimensionValue(e,r){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(r||new t()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startDimensionValue",value:function startDimensionValue(e){e.startObject(3);}},{key:"addDimType",value:function addDimType(e,_t22){e.addFieldInt8(0,_t22,0);}},{key:"addDimValue",value:function addDimValue(e,_t23){e.addFieldInt64(1,_t23,e.createLong(0,0));}},{key:"addDimParam",value:function addDimParam(e,_t24){e.addFieldOffset(2,_t24,0);}},{key:"endDimensionValue",value:function endDimensionValue(e){return e.endObject();}},{key:"createDimensionValue",value:function createDimensionValue(e,r,n,i){return t.startDimensionValue(e),t.addDimType(e,r),t.addDimValue(e,n),t.addDimParam(e,i),t.endDimensionValue(e);}}]);}();e.DimensionValue=t;})(t=e.fbs||(e.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(t){var r;(function(t){var r=/*#__PURE__*/function(){function r(){_classCallCheck2(this,r);this.bb=null,this.bb_pos=0;}return _createClass2(r,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"elemType",value:function elemType(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0;}},{key:"shape",value:function shape(t){var _r17=this.bb.__offset(this.bb_pos,6);return _r17?(t||new e.experimental.fbs.Shape()).__init(this.bb.__indirect(this.bb_pos+_r17),this.bb):null;}}],[{key:"getRootAsTensorTypeAndShape",value:function getRootAsTensorTypeAndShape(e,t){return(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsTensorTypeAndShape",value:function getSizePrefixedRootAsTensorTypeAndShape(e,t){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startTensorTypeAndShape",value:function startTensorTypeAndShape(e){e.startObject(2);}},{key:"addElemType",value:function addElemType(e,t){e.addFieldInt32(0,t,0);}},{key:"addShape",value:function addShape(e,t){e.addFieldOffset(1,t,0);}},{key:"endTensorTypeAndShape",value:function endTensorTypeAndShape(e){return e.endObject();}},{key:"createTensorTypeAndShape",value:function createTensorTypeAndShape(e,t,n){return r.startTensorTypeAndShape(e),r.addElemType(e,t),r.addShape(e,n),r.endTensorTypeAndShape(e);}}]);}();t.TensorTypeAndShape=r;})(r=t.fbs||(t.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(t){var r;(function(t){var r=/*#__PURE__*/function(){function r(){_classCallCheck2(this,r);this.bb=null,this.bb_pos=0;}return _createClass2(r,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"keyType",value:function keyType(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0;}},{key:"valueType",value:function valueType(t){var _r18=this.bb.__offset(this.bb_pos,6);return _r18?(t||new e.experimental.fbs.TypeInfo()).__init(this.bb.__indirect(this.bb_pos+_r18),this.bb):null;}}],[{key:"getRootAsMapType",value:function getRootAsMapType(e,t){return(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsMapType",value:function getSizePrefixedRootAsMapType(e,t){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startMapType",value:function startMapType(e){e.startObject(2);}},{key:"addKeyType",value:function addKeyType(e,t){e.addFieldInt32(0,t,0);}},{key:"addValueType",value:function addValueType(e,t){e.addFieldOffset(1,t,0);}},{key:"endMapType",value:function endMapType(e){return e.endObject();}},{key:"createMapType",value:function createMapType(e,t,n){return r.startMapType(e),r.addKeyType(e,t),r.addValueType(e,n),r.endMapType(e);}}]);}();t.MapType=r;})(r=t.fbs||(t.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(t){var r;(function(t){var r=/*#__PURE__*/function(){function r(){_classCallCheck2(this,r);this.bb=null,this.bb_pos=0;}return _createClass2(r,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"elemType",value:function elemType(t){var _r19=this.bb.__offset(this.bb_pos,4);return _r19?(t||new e.experimental.fbs.TypeInfo()).__init(this.bb.__indirect(this.bb_pos+_r19),this.bb):null;}}],[{key:"getRootAsSequenceType",value:function getRootAsSequenceType(e,t){return(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsSequenceType",value:function getSizePrefixedRootAsSequenceType(e,t){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startSequenceType",value:function startSequenceType(e){e.startObject(1);}},{key:"addElemType",value:function addElemType(e,t){e.addFieldOffset(0,t,0);}},{key:"endSequenceType",value:function endSequenceType(e){return e.endObject();}},{key:"createSequenceType",value:function createSequenceType(e,t){return r.startSequenceType(e),r.addElemType(e,t),r.endSequenceType(e);}}]);}();t.SequenceType=r;})(r=t.fbs||(t.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(e){var t;(function(e){e.EdgeEnd=/*#__PURE__*/function(){function _class(){_classCallCheck2(this,_class);this.bb=null,this.bb_pos=0;}return _createClass2(_class,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"nodeIndex",value:function nodeIndex(){return this.bb.readUint32(this.bb_pos);}},{key:"srcArgIndex",value:function srcArgIndex(){return this.bb.readInt32(this.bb_pos+4);}},{key:"dstArgIndex",value:function dstArgIndex(){return this.bb.readInt32(this.bb_pos+8);}}],[{key:"createEdgeEnd",value:function createEdgeEnd(e,t,r,n){return e.prep(4,12),e.writeInt32(n),e.writeInt32(r),e.writeInt32(t),e.offset();}}]);}();})(t=e.fbs||(e.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(t){var r;(function(t){var r=/*#__PURE__*/function(){function r(){_classCallCheck2(this,r);this.bb=null,this.bb_pos=0;}return _createClass2(r,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"nodeIndex",value:function nodeIndex(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb_pos+e):0;}},{key:"inputEdges",value:function inputEdges(t,_r20){var n=this.bb.__offset(this.bb_pos,6);return n?(_r20||new e.experimental.fbs.EdgeEnd()).__init(this.bb.__vector(this.bb_pos+n)+12*t,this.bb):null;}},{key:"inputEdgesLength",value:function inputEdgesLength(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"outputEdges",value:function outputEdges(t,_r21){var n=this.bb.__offset(this.bb_pos,8);return n?(_r21||new e.experimental.fbs.EdgeEnd()).__init(this.bb.__vector(this.bb_pos+n)+12*t,this.bb):null;}},{key:"outputEdgesLength",value:function outputEdgesLength(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0;}}],[{key:"getRootAsNodeEdge",value:function getRootAsNodeEdge(e,t){return(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsNodeEdge",value:function getSizePrefixedRootAsNodeEdge(e,t){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startNodeEdge",value:function startNodeEdge(e){e.startObject(3);}},{key:"addNodeIndex",value:function addNodeIndex(e,t){e.addFieldInt32(0,t,0);}},{key:"addInputEdges",value:function addInputEdges(e,t){e.addFieldOffset(1,t,0);}},{key:"startInputEdgesVector",value:function startInputEdgesVector(e,t){e.startVector(12,t,4);}},{key:"addOutputEdges",value:function addOutputEdges(e,t){e.addFieldOffset(2,t,0);}},{key:"startOutputEdgesVector",value:function startOutputEdgesVector(e,t){e.startVector(12,t,4);}},{key:"endNodeEdge",value:function endNodeEdge(e){return e.endObject();}},{key:"createNodeEdge",value:function createNodeEdge(e,t,n,i){return r.startNodeEdge(e),r.addNodeIndex(e,t),r.addInputEdges(e,n),r.addOutputEdges(e,i),r.endNodeEdge(e);}}]);}();t.NodeEdge=r;})(r=t.fbs||(t.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(t){var r;(function(t){var r=/*#__PURE__*/function(){function r(){_classCallCheck2(this,r);this.bb=null,this.bb_pos=0;}return _createClass2(r,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"name",value:function name(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"docString",value:function docString(e){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"domain",value:function domain(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"sinceVersion",value:function sinceVersion(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt32(this.bb_pos+e):0;}},{key:"index",value:function index(){var e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readUint32(this.bb_pos+e):0;}},{key:"opType",value:function opType(e){var t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"type",value:function type(){var e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readInt32(this.bb_pos+e):0;}},{key:"executionProviderType",value:function executionProviderType(e){var t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"inputs",value:function inputs(e,t){var _r22=this.bb.__offset(this.bb_pos,20);return _r22?this.bb.__string(this.bb.__vector(this.bb_pos+_r22)+4*e,t):null;}},{key:"inputsLength",value:function inputsLength(){var e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"outputs",value:function outputs(e,t){var _r23=this.bb.__offset(this.bb_pos,22);return _r23?this.bb.__string(this.bb.__vector(this.bb_pos+_r23)+4*e,t):null;}},{key:"outputsLength",value:function outputsLength(){var e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"attributes",value:function attributes(t,_r24){var n=this.bb.__offset(this.bb_pos,24);return n?(_r24||new e.experimental.fbs.Attribute()).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null;}},{key:"attributesLength",value:function attributesLength(){var e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"inputArgCounts",value:function inputArgCounts(e){var t=this.bb.__offset(this.bb_pos,26);return t?this.bb.readInt32(this.bb.__vector(this.bb_pos+t)+4*e):0;}},{key:"inputArgCountsLength",value:function inputArgCountsLength(){var e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"inputArgCountsArray",value:function inputArgCountsArray(){var e=this.bb.__offset(this.bb_pos,26);return e?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null;}},{key:"implicitInputs",value:function implicitInputs(e,t){var _r25=this.bb.__offset(this.bb_pos,28);return _r25?this.bb.__string(this.bb.__vector(this.bb_pos+_r25)+4*e,t):null;}},{key:"implicitInputsLength",value:function implicitInputsLength(){var e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__vector_len(this.bb_pos+e):0;}}],[{key:"getRootAsNode",value:function getRootAsNode(e,t){return(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsNode",value:function getSizePrefixedRootAsNode(e,t){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startNode",value:function startNode(e){e.startObject(13);}},{key:"addName",value:function addName(e,t){e.addFieldOffset(0,t,0);}},{key:"addDocString",value:function addDocString(e,t){e.addFieldOffset(1,t,0);}},{key:"addDomain",value:function addDomain(e,t){e.addFieldOffset(2,t,0);}},{key:"addSinceVersion",value:function addSinceVersion(e,t){e.addFieldInt32(3,t,0);}},{key:"addIndex",value:function addIndex(e,t){e.addFieldInt32(4,t,0);}},{key:"addOpType",value:function addOpType(e,t){e.addFieldOffset(5,t,0);}},{key:"addType",value:function addType(e,t){e.addFieldInt32(6,t,0);}},{key:"addExecutionProviderType",value:function addExecutionProviderType(e,t){e.addFieldOffset(7,t,0);}},{key:"addInputs",value:function addInputs(e,t){e.addFieldOffset(8,t,0);}},{key:"createInputsVector",value:function createInputsVector(e,t){e.startVector(4,t.length,4);for(var _r31=t.length-1;_r31>=0;_r31--)e.addOffset(t[_r31]);return e.endVector();}},{key:"startInputsVector",value:function startInputsVector(e,t){e.startVector(4,t,4);}},{key:"addOutputs",value:function addOutputs(e,t){e.addFieldOffset(9,t,0);}},{key:"createOutputsVector",value:function createOutputsVector(e,t){e.startVector(4,t.length,4);for(var _r32=t.length-1;_r32>=0;_r32--)e.addOffset(t[_r32]);return e.endVector();}},{key:"startOutputsVector",value:function startOutputsVector(e,t){e.startVector(4,t,4);}},{key:"addAttributes",value:function addAttributes(e,t){e.addFieldOffset(10,t,0);}},{key:"createAttributesVector",value:function createAttributesVector(e,t){e.startVector(4,t.length,4);for(var _r33=t.length-1;_r33>=0;_r33--)e.addOffset(t[_r33]);return e.endVector();}},{key:"startAttributesVector",value:function startAttributesVector(e,t){e.startVector(4,t,4);}},{key:"addInputArgCounts",value:function addInputArgCounts(e,t){e.addFieldOffset(11,t,0);}},{key:"createInputArgCountsVector",value:function createInputArgCountsVector(e,t){e.startVector(4,t.length,4);for(var _r34=t.length-1;_r34>=0;_r34--)e.addInt32(t[_r34]);return e.endVector();}},{key:"startInputArgCountsVector",value:function startInputArgCountsVector(e,t){e.startVector(4,t,4);}},{key:"addImplicitInputs",value:function addImplicitInputs(e,t){e.addFieldOffset(12,t,0);}},{key:"createImplicitInputsVector",value:function createImplicitInputsVector(e,t){e.startVector(4,t.length,4);for(var _r35=t.length-1;_r35>=0;_r35--)e.addOffset(t[_r35]);return e.endVector();}},{key:"startImplicitInputsVector",value:function startImplicitInputsVector(e,t){e.startVector(4,t,4);}},{key:"endNode",value:function endNode(e){return e.endObject();}},{key:"createNode",value:function createNode(e,t,n,i,o,a,s,u,l,c,h,f,d,p){return r.startNode(e),r.addName(e,t),r.addDocString(e,n),r.addDomain(e,i),r.addSinceVersion(e,o),r.addIndex(e,a),r.addOpType(e,s),r.addType(e,u),r.addExecutionProviderType(e,l),r.addInputs(e,c),r.addOutputs(e,h),r.addAttributes(e,f),r.addInputArgCounts(e,d),r.addImplicitInputs(e,p),r.endNode(e);}}]);}();t.Node=r;})(r=t.fbs||(t.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(t){var r;(function(t){var r=/*#__PURE__*/function(){function r(){_classCallCheck2(this,r);this.bb=null,this.bb_pos=0;}return _createClass2(r,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"name",value:function name(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"docString",value:function docString(e){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"type",value:function type(t){var _r36=this.bb.__offset(this.bb_pos,8);return _r36?(t||new e.experimental.fbs.TypeInfo()).__init(this.bb.__indirect(this.bb_pos+_r36),this.bb):null;}}],[{key:"getRootAsValueInfo",value:function getRootAsValueInfo(e,t){return(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsValueInfo",value:function getSizePrefixedRootAsValueInfo(e,t){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startValueInfo",value:function startValueInfo(e){e.startObject(3);}},{key:"addName",value:function addName(e,t){e.addFieldOffset(0,t,0);}},{key:"addDocString",value:function addDocString(e,t){e.addFieldOffset(1,t,0);}},{key:"addType",value:function addType(e,t){e.addFieldOffset(2,t,0);}},{key:"endValueInfo",value:function endValueInfo(e){return e.endObject();}},{key:"createValueInfo",value:function createValueInfo(e,t,n,i){return r.startValueInfo(e),r.addName(e,t),r.addDocString(e,n),r.addType(e,i),r.endValueInfo(e);}}]);}();t.ValueInfo=r;})(r=t.fbs||(t.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(e){var t;(function(e){var t=/*#__PURE__*/function(){function t(){_classCallCheck2(this,t);this.bb=null,this.bb_pos=0;}return _createClass2(t,[{key:"__init",value:function __init(e,_t25){return this.bb_pos=e,this.bb=_t25,this;}},{key:"denotation",value:function denotation(e){var _t26=this.bb.__offset(this.bb_pos,4);return _t26?this.bb.__string(this.bb_pos+_t26,e):null;}},{key:"valueType",value:function valueType(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb_pos+e):0;}},{key:"value",value:function value(e){var _t27=this.bb.__offset(this.bb_pos,8);return _t27?this.bb.__union(e,this.bb_pos+_t27):null;}}],[{key:"getRootAsTypeInfo",value:function getRootAsTypeInfo(e,r){return(r||new t()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsTypeInfo",value:function getSizePrefixedRootAsTypeInfo(e,r){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(r||new t()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startTypeInfo",value:function startTypeInfo(e){e.startObject(3);}},{key:"addDenotation",value:function addDenotation(e,_t28){e.addFieldOffset(0,_t28,0);}},{key:"addValueType",value:function addValueType(e,_t29){e.addFieldInt8(1,_t29,0);}},{key:"addValue",value:function addValue(e,_t30){e.addFieldOffset(2,_t30,0);}},{key:"endTypeInfo",value:function endTypeInfo(e){return e.endObject();}},{key:"createTypeInfo",value:function createTypeInfo(e,r,n,i){return t.startTypeInfo(e),t.addDenotation(e,r),t.addValueType(e,n),t.addValue(e,i),t.endTypeInfo(e);}}]);}();e.TypeInfo=t;})(t=e.fbs||(e.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(e){var t;(function(e){var t=/*#__PURE__*/function(){function t(){_classCallCheck2(this,t);this.bb=null,this.bb_pos=0;}return _createClass2(t,[{key:"__init",value:function __init(e,_t31){return this.bb_pos=e,this.bb=_t31,this;}},{key:"domain",value:function domain(e){var _t32=this.bb.__offset(this.bb_pos,4);return _t32?this.bb.__string(this.bb_pos+_t32,e):null;}},{key:"version",value:function version(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0);}}],[{key:"getRootAsOperatorSetId",value:function getRootAsOperatorSetId(e,r){return(r||new t()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsOperatorSetId",value:function getSizePrefixedRootAsOperatorSetId(e,r){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(r||new t()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startOperatorSetId",value:function startOperatorSetId(e){e.startObject(2);}},{key:"addDomain",value:function addDomain(e,_t33){e.addFieldOffset(0,_t33,0);}},{key:"addVersion",value:function addVersion(e,_t34){e.addFieldInt64(1,_t34,e.createLong(0,0));}},{key:"endOperatorSetId",value:function endOperatorSetId(e){return e.endObject();}},{key:"createOperatorSetId",value:function createOperatorSetId(e,r,n){return t.startOperatorSetId(e),t.addDomain(e,r),t.addVersion(e,n),t.endOperatorSetId(e);}}]);}();e.OperatorSetId=t;})(t=e.fbs||(e.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(e){var t;(function(e){var t=/*#__PURE__*/function(){function t(){_classCallCheck2(this,t);this.bb=null,this.bb_pos=0;}return _createClass2(t,[{key:"__init",value:function __init(e,_t35){return this.bb_pos=e,this.bb=_t35,this;}},{key:"name",value:function name(e){var _t36=this.bb.__offset(this.bb_pos,4);return _t36?this.bb.__string(this.bb_pos+_t36,e):null;}},{key:"docString",value:function docString(e){var _t37=this.bb.__offset(this.bb_pos,6);return _t37?this.bb.__string(this.bb_pos+_t37,e):null;}},{key:"dims",value:function dims(e){var _t38=this.bb.__offset(this.bb_pos,8);return _t38?this.bb.readInt64(this.bb.__vector(this.bb_pos+_t38)+8*e):this.bb.createLong(0,0);}},{key:"dimsLength",value:function dimsLength(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"dataType",value:function dataType(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt32(this.bb_pos+e):0;}},{key:"rawData",value:function rawData(e){var _t39=this.bb.__offset(this.bb_pos,12);return _t39?this.bb.readUint8(this.bb.__vector(this.bb_pos+_t39)+e):0;}},{key:"rawDataLength",value:function rawDataLength(){var e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"rawDataArray",value:function rawDataArray(){var e=this.bb.__offset(this.bb_pos,12);return e?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null;}},{key:"stringData",value:function stringData(e,_t40){var r=this.bb.__offset(this.bb_pos,14);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,_t40):null;}},{key:"stringDataLength",value:function stringDataLength(){var e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0;}}],[{key:"getRootAsTensor",value:function getRootAsTensor(e,r){return(r||new t()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsTensor",value:function getSizePrefixedRootAsTensor(e,r){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(r||new t()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startTensor",value:function startTensor(e){e.startObject(6);}},{key:"addName",value:function addName(e,_t41){e.addFieldOffset(0,_t41,0);}},{key:"addDocString",value:function addDocString(e,_t42){e.addFieldOffset(1,_t42,0);}},{key:"addDims",value:function addDims(e,_t43){e.addFieldOffset(2,_t43,0);}},{key:"createDimsVector",value:function createDimsVector(e,_t44){e.startVector(8,_t44.length,8);for(var _r37=_t44.length-1;_r37>=0;_r37--)e.addInt64(_t44[_r37]);return e.endVector();}},{key:"startDimsVector",value:function startDimsVector(e,_t45){e.startVector(8,_t45,8);}},{key:"addDataType",value:function addDataType(e,_t46){e.addFieldInt32(3,_t46,0);}},{key:"addRawData",value:function addRawData(e,_t47){e.addFieldOffset(4,_t47,0);}},{key:"createRawDataVector",value:function createRawDataVector(e,_t48){e.startVector(1,_t48.length,1);for(var _r38=_t48.length-1;_r38>=0;_r38--)e.addInt8(_t48[_r38]);return e.endVector();}},{key:"startRawDataVector",value:function startRawDataVector(e,_t49){e.startVector(1,_t49,1);}},{key:"addStringData",value:function addStringData(e,_t50){e.addFieldOffset(5,_t50,0);}},{key:"createStringDataVector",value:function createStringDataVector(e,_t51){e.startVector(4,_t51.length,4);for(var _r39=_t51.length-1;_r39>=0;_r39--)e.addOffset(_t51[_r39]);return e.endVector();}},{key:"startStringDataVector",value:function startStringDataVector(e,_t52){e.startVector(4,_t52,4);}},{key:"endTensor",value:function endTensor(e){return e.endObject();}},{key:"createTensor",value:function createTensor(e,r,n,i,o,a,s){return t.startTensor(e),t.addName(e,r),t.addDocString(e,n),t.addDims(e,i),t.addDataType(e,o),t.addRawData(e,a),t.addStringData(e,s),t.endTensor(e);}}]);}();e.Tensor=t;})(t=e.fbs||(e.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(t){var r;(function(t){var r=/*#__PURE__*/function(){function r(){_classCallCheck2(this,r);this.bb=null,this.bb_pos=0;}return _createClass2(r,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"values",value:function values(t){var _r40=this.bb.__offset(this.bb_pos,4);return _r40?(t||new e.experimental.fbs.Tensor()).__init(this.bb.__indirect(this.bb_pos+_r40),this.bb):null;}},{key:"indices",value:function indices(t){var _r41=this.bb.__offset(this.bb_pos,6);return _r41?(t||new e.experimental.fbs.Tensor()).__init(this.bb.__indirect(this.bb_pos+_r41),this.bb):null;}},{key:"dims",value:function dims(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0);}},{key:"dimsLength",value:function dimsLength(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0;}}],[{key:"getRootAsSparseTensor",value:function getRootAsSparseTensor(e,t){return(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsSparseTensor",value:function getSizePrefixedRootAsSparseTensor(e,t){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startSparseTensor",value:function startSparseTensor(e){e.startObject(3);}},{key:"addValues",value:function addValues(e,t){e.addFieldOffset(0,t,0);}},{key:"addIndices",value:function addIndices(e,t){e.addFieldOffset(1,t,0);}},{key:"addDims",value:function addDims(e,t){e.addFieldOffset(2,t,0);}},{key:"createDimsVector",value:function createDimsVector(e,t){e.startVector(8,t.length,8);for(var _r43=t.length-1;_r43>=0;_r43--)e.addInt64(t[_r43]);return e.endVector();}},{key:"startDimsVector",value:function startDimsVector(e,t){e.startVector(8,t,8);}},{key:"endSparseTensor",value:function endSparseTensor(e){return e.endObject();}},{key:"createSparseTensor",value:function createSparseTensor(e,t,n,i){return r.startSparseTensor(e),r.addValues(e,t),r.addIndices(e,n),r.addDims(e,i),r.endSparseTensor(e);}}]);}();t.SparseTensor=r;})(r=t.fbs||(t.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(t){var r;(function(t){var r=/*#__PURE__*/function(){function r(){_classCallCheck2(this,r);this.bb=null,this.bb_pos=0;}return _createClass2(r,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"name",value:function name(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"docString",value:function docString(e){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"type",value:function type(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt32(this.bb_pos+e):0;}},{key:"f",value:function f(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat32(this.bb_pos+e):0;}},{key:"i",value:function i(){var e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0);}},{key:"s",value:function s(e){var t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"t",value:function t(_t53){var _r44=this.bb.__offset(this.bb_pos,16);return _r44?(_t53||new e.experimental.fbs.Tensor()).__init(this.bb.__indirect(this.bb_pos+_r44),this.bb):null;}},{key:"g",value:function g(t){var _r45=this.bb.__offset(this.bb_pos,18);return _r45?(t||new e.experimental.fbs.Graph()).__init(this.bb.__indirect(this.bb_pos+_r45),this.bb):null;}},{key:"floats",value:function floats(e){var t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readFloat32(this.bb.__vector(this.bb_pos+t)+4*e):0;}},{key:"floatsLength",value:function floatsLength(){var e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"floatsArray",value:function floatsArray(){var e=this.bb.__offset(this.bb_pos,20);return e?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null;}},{key:"ints",value:function ints(e){var t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0);}},{key:"intsLength",value:function intsLength(){var e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"strings",value:function strings(e,t){var _r46=this.bb.__offset(this.bb_pos,24);return _r46?this.bb.__string(this.bb.__vector(this.bb_pos+_r46)+4*e,t):null;}},{key:"stringsLength",value:function stringsLength(){var e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"tensors",value:function tensors(t,_r47){var n=this.bb.__offset(this.bb_pos,26);return n?(_r47||new e.experimental.fbs.Tensor()).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null;}},{key:"tensorsLength",value:function tensorsLength(){var e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"graphs",value:function graphs(t,_r48){var n=this.bb.__offset(this.bb_pos,28);return n?(_r48||new e.experimental.fbs.Graph()).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null;}},{key:"graphsLength",value:function graphsLength(){var e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__vector_len(this.bb_pos+e):0;}}],[{key:"getRootAsAttribute",value:function getRootAsAttribute(e,t){return(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsAttribute",value:function getSizePrefixedRootAsAttribute(e,t){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startAttribute",value:function startAttribute(e){e.startObject(13);}},{key:"addName",value:function addName(e,t){e.addFieldOffset(0,t,0);}},{key:"addDocString",value:function addDocString(e,t){e.addFieldOffset(1,t,0);}},{key:"addType",value:function addType(e,t){e.addFieldInt32(2,t,0);}},{key:"addF",value:function addF(e,t){e.addFieldFloat32(3,t,0);}},{key:"addI",value:function addI(e,t){e.addFieldInt64(4,t,e.createLong(0,0));}},{key:"addS",value:function addS(e,t){e.addFieldOffset(5,t,0);}},{key:"addT",value:function addT(e,t){e.addFieldOffset(6,t,0);}},{key:"addG",value:function addG(e,t){e.addFieldOffset(7,t,0);}},{key:"addFloats",value:function addFloats(e,t){e.addFieldOffset(8,t,0);}},{key:"createFloatsVector",value:function createFloatsVector(e,t){e.startVector(4,t.length,4);for(var _r54=t.length-1;_r54>=0;_r54--)e.addFloat32(t[_r54]);return e.endVector();}},{key:"startFloatsVector",value:function startFloatsVector(e,t){e.startVector(4,t,4);}},{key:"addInts",value:function addInts(e,t){e.addFieldOffset(9,t,0);}},{key:"createIntsVector",value:function createIntsVector(e,t){e.startVector(8,t.length,8);for(var _r55=t.length-1;_r55>=0;_r55--)e.addInt64(t[_r55]);return e.endVector();}},{key:"startIntsVector",value:function startIntsVector(e,t){e.startVector(8,t,8);}},{key:"addStrings",value:function addStrings(e,t){e.addFieldOffset(10,t,0);}},{key:"createStringsVector",value:function createStringsVector(e,t){e.startVector(4,t.length,4);for(var _r56=t.length-1;_r56>=0;_r56--)e.addOffset(t[_r56]);return e.endVector();}},{key:"startStringsVector",value:function startStringsVector(e,t){e.startVector(4,t,4);}},{key:"addTensors",value:function addTensors(e,t){e.addFieldOffset(11,t,0);}},{key:"createTensorsVector",value:function createTensorsVector(e,t){e.startVector(4,t.length,4);for(var _r57=t.length-1;_r57>=0;_r57--)e.addOffset(t[_r57]);return e.endVector();}},{key:"startTensorsVector",value:function startTensorsVector(e,t){e.startVector(4,t,4);}},{key:"addGraphs",value:function addGraphs(e,t){e.addFieldOffset(12,t,0);}},{key:"createGraphsVector",value:function createGraphsVector(e,t){e.startVector(4,t.length,4);for(var _r58=t.length-1;_r58>=0;_r58--)e.addOffset(t[_r58]);return e.endVector();}},{key:"startGraphsVector",value:function startGraphsVector(e,t){e.startVector(4,t,4);}},{key:"endAttribute",value:function endAttribute(e){return e.endObject();}},{key:"createAttribute",value:function createAttribute(e,t,n,i,o,a,s,u,l,c,h,f,d,p){return r.startAttribute(e),r.addName(e,t),r.addDocString(e,n),r.addType(e,i),r.addF(e,o),r.addI(e,a),r.addS(e,s),r.addT(e,u),r.addG(e,l),r.addFloats(e,c),r.addInts(e,h),r.addStrings(e,f),r.addTensors(e,d),r.addGraphs(e,p),r.endAttribute(e);}}]);}();t.Attribute=r;})(r=t.fbs||(t.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(t){var r;(function(t){var r=/*#__PURE__*/function(){function r(){_classCallCheck2(this,r);this.bb=null,this.bb_pos=0;}return _createClass2(r,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"initializers",value:function initializers(t,_r59){var n=this.bb.__offset(this.bb_pos,4);return n?(_r59||new e.experimental.fbs.Tensor()).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null;}},{key:"initializersLength",value:function initializersLength(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"nodeArgs",value:function nodeArgs(t,_r60){var n=this.bb.__offset(this.bb_pos,6);return n?(_r60||new e.experimental.fbs.ValueInfo()).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null;}},{key:"nodeArgsLength",value:function nodeArgsLength(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"nodes",value:function nodes(t,_r61){var n=this.bb.__offset(this.bb_pos,8);return n?(_r61||new e.experimental.fbs.Node()).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null;}},{key:"nodesLength",value:function nodesLength(){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"maxNodeIndex",value:function maxNodeIndex(){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readUint32(this.bb_pos+e):0;}},{key:"nodeEdges",value:function nodeEdges(t,_r62){var n=this.bb.__offset(this.bb_pos,12);return n?(_r62||new e.experimental.fbs.NodeEdge()).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null;}},{key:"nodeEdgesLength",value:function nodeEdgesLength(){var e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"inputs",value:function inputs(e,t){var _r63=this.bb.__offset(this.bb_pos,14);return _r63?this.bb.__string(this.bb.__vector(this.bb_pos+_r63)+4*e,t):null;}},{key:"inputsLength",value:function inputsLength(){var e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"outputs",value:function outputs(e,t){var _r64=this.bb.__offset(this.bb_pos,16);return _r64?this.bb.__string(this.bb.__vector(this.bb_pos+_r64)+4*e,t):null;}},{key:"outputsLength",value:function outputsLength(){var e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"sparseInitializers",value:function sparseInitializers(t,_r65){var n=this.bb.__offset(this.bb_pos,18);return n?(_r65||new e.experimental.fbs.SparseTensor()).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null;}},{key:"sparseInitializersLength",value:function sparseInitializersLength(){var e=this.bb.__offset(this.bb_pos,18);return e?this.bb.__vector_len(this.bb_pos+e):0;}}],[{key:"getRootAsGraph",value:function getRootAsGraph(e,t){return(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsGraph",value:function getSizePrefixedRootAsGraph(e,t){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startGraph",value:function startGraph(e){e.startObject(8);}},{key:"addInitializers",value:function addInitializers(e,t){e.addFieldOffset(0,t,0);}},{key:"createInitializersVector",value:function createInitializersVector(e,t){e.startVector(4,t.length,4);for(var _r73=t.length-1;_r73>=0;_r73--)e.addOffset(t[_r73]);return e.endVector();}},{key:"startInitializersVector",value:function startInitializersVector(e,t){e.startVector(4,t,4);}},{key:"addNodeArgs",value:function addNodeArgs(e,t){e.addFieldOffset(1,t,0);}},{key:"createNodeArgsVector",value:function createNodeArgsVector(e,t){e.startVector(4,t.length,4);for(var _r74=t.length-1;_r74>=0;_r74--)e.addOffset(t[_r74]);return e.endVector();}},{key:"startNodeArgsVector",value:function startNodeArgsVector(e,t){e.startVector(4,t,4);}},{key:"addNodes",value:function addNodes(e,t){e.addFieldOffset(2,t,0);}},{key:"createNodesVector",value:function createNodesVector(e,t){e.startVector(4,t.length,4);for(var _r75=t.length-1;_r75>=0;_r75--)e.addOffset(t[_r75]);return e.endVector();}},{key:"startNodesVector",value:function startNodesVector(e,t){e.startVector(4,t,4);}},{key:"addMaxNodeIndex",value:function addMaxNodeIndex(e,t){e.addFieldInt32(3,t,0);}},{key:"addNodeEdges",value:function addNodeEdges(e,t){e.addFieldOffset(4,t,0);}},{key:"createNodeEdgesVector",value:function createNodeEdgesVector(e,t){e.startVector(4,t.length,4);for(var _r76=t.length-1;_r76>=0;_r76--)e.addOffset(t[_r76]);return e.endVector();}},{key:"startNodeEdgesVector",value:function startNodeEdgesVector(e,t){e.startVector(4,t,4);}},{key:"addInputs",value:function addInputs(e,t){e.addFieldOffset(5,t,0);}},{key:"createInputsVector",value:function createInputsVector(e,t){e.startVector(4,t.length,4);for(var _r77=t.length-1;_r77>=0;_r77--)e.addOffset(t[_r77]);return e.endVector();}},{key:"startInputsVector",value:function startInputsVector(e,t){e.startVector(4,t,4);}},{key:"addOutputs",value:function addOutputs(e,t){e.addFieldOffset(6,t,0);}},{key:"createOutputsVector",value:function createOutputsVector(e,t){e.startVector(4,t.length,4);for(var _r78=t.length-1;_r78>=0;_r78--)e.addOffset(t[_r78]);return e.endVector();}},{key:"startOutputsVector",value:function startOutputsVector(e,t){e.startVector(4,t,4);}},{key:"addSparseInitializers",value:function addSparseInitializers(e,t){e.addFieldOffset(7,t,0);}},{key:"createSparseInitializersVector",value:function createSparseInitializersVector(e,t){e.startVector(4,t.length,4);for(var _r79=t.length-1;_r79>=0;_r79--)e.addOffset(t[_r79]);return e.endVector();}},{key:"startSparseInitializersVector",value:function startSparseInitializersVector(e,t){e.startVector(4,t,4);}},{key:"endGraph",value:function endGraph(e){return e.endObject();}},{key:"createGraph",value:function createGraph(e,t,n,i,o,a,s,u,l){return r.startGraph(e),r.addInitializers(e,t),r.addNodeArgs(e,n),r.addNodes(e,i),r.addMaxNodeIndex(e,o),r.addNodeEdges(e,a),r.addInputs(e,s),r.addOutputs(e,u),r.addSparseInitializers(e,l),r.endGraph(e);}}]);}();t.Graph=r;})(r=t.fbs||(t.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(t){var r;(function(t){var r=/*#__PURE__*/function(){function r(){_classCallCheck2(this,r);this.bb=null,this.bb_pos=0;}return _createClass2(r,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"irVersion",value:function irVersion(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0);}},{key:"opsetImport",value:function opsetImport(t,_r80){var n=this.bb.__offset(this.bb_pos,6);return n?(_r80||new e.experimental.fbs.OperatorSetId()).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null;}},{key:"opsetImportLength",value:function opsetImportLength(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"producerName",value:function producerName(e){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"producerVersion",value:function producerVersion(e){var t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"domain",value:function domain(e){var t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"modelVersion",value:function modelVersion(){var e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0);}},{key:"docString",value:function docString(e){var t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"graph",value:function graph(t){var _r81=this.bb.__offset(this.bb_pos,18);return _r81?(t||new e.experimental.fbs.Graph()).__init(this.bb.__indirect(this.bb_pos+_r81),this.bb):null;}},{key:"graphDocString",value:function graphDocString(e){var t=this.bb.__offset(this.bb_pos,20);return t?this.bb.__string(this.bb_pos+t,e):null;}}],[{key:"getRootAsModel",value:function getRootAsModel(e,t){return(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsModel",value:function getSizePrefixedRootAsModel(e,t){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startModel",value:function startModel(e){e.startObject(9);}},{key:"addIrVersion",value:function addIrVersion(e,t){e.addFieldInt64(0,t,e.createLong(0,0));}},{key:"addOpsetImport",value:function addOpsetImport(e,t){e.addFieldOffset(1,t,0);}},{key:"createOpsetImportVector",value:function createOpsetImportVector(e,t){e.startVector(4,t.length,4);for(var _r83=t.length-1;_r83>=0;_r83--)e.addOffset(t[_r83]);return e.endVector();}},{key:"startOpsetImportVector",value:function startOpsetImportVector(e,t){e.startVector(4,t,4);}},{key:"addProducerName",value:function addProducerName(e,t){e.addFieldOffset(2,t,0);}},{key:"addProducerVersion",value:function addProducerVersion(e,t){e.addFieldOffset(3,t,0);}},{key:"addDomain",value:function addDomain(e,t){e.addFieldOffset(4,t,0);}},{key:"addModelVersion",value:function addModelVersion(e,t){e.addFieldInt64(5,t,e.createLong(0,0));}},{key:"addDocString",value:function addDocString(e,t){e.addFieldOffset(6,t,0);}},{key:"addGraph",value:function addGraph(e,t){e.addFieldOffset(7,t,0);}},{key:"addGraphDocString",value:function addGraphDocString(e,t){e.addFieldOffset(8,t,0);}},{key:"endModel",value:function endModel(e){return e.endObject();}},{key:"createModel",value:function createModel(e,t,n,i,o,a,s,u,l,c){return r.startModel(e),r.addIrVersion(e,t),r.addOpsetImport(e,n),r.addProducerName(e,i),r.addProducerVersion(e,o),r.addDomain(e,a),r.addModelVersion(e,s),r.addDocString(e,u),r.addGraph(e,l),r.addGraphDocString(e,c),r.endModel(e);}}]);}();t.Model=r;})(r=t.fbs||(t.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(e){var t;(function(e){var t=/*#__PURE__*/function(){function t(){_classCallCheck2(this,t);this.bb=null,this.bb_pos=0;}return _createClass2(t,[{key:"__init",value:function __init(e,_t54){return this.bb_pos=e,this.bb=_t54,this;}},{key:"nodeIndices",value:function nodeIndices(e){var _t55=this.bb.__offset(this.bb_pos,4);return _t55?this.bb.readUint32(this.bb.__vector(this.bb_pos+_t55)+4*e):0;}},{key:"nodeIndicesLength",value:function nodeIndicesLength(){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0;}},{key:"nodeIndicesArray",value:function nodeIndicesArray(){var e=this.bb.__offset(this.bb_pos,4);return e?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null;}},{key:"kernelDefHashes",value:function kernelDefHashes(e){var _t56=this.bb.__offset(this.bb_pos,6);return _t56?this.bb.readUint64(this.bb.__vector(this.bb_pos+_t56)+8*e):this.bb.createLong(0,0);}},{key:"kernelDefHashesLength",value:function kernelDefHashesLength(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0;}}],[{key:"getRootAsKernelCreateInfos",value:function getRootAsKernelCreateInfos(e,r){return(r||new t()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsKernelCreateInfos",value:function getSizePrefixedRootAsKernelCreateInfos(e,r){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(r||new t()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startKernelCreateInfos",value:function startKernelCreateInfos(e){e.startObject(2);}},{key:"addNodeIndices",value:function addNodeIndices(e,_t57){e.addFieldOffset(0,_t57,0);}},{key:"createNodeIndicesVector",value:function createNodeIndicesVector(e,_t58){e.startVector(4,_t58.length,4);for(var _r84=_t58.length-1;_r84>=0;_r84--)e.addInt32(_t58[_r84]);return e.endVector();}},{key:"startNodeIndicesVector",value:function startNodeIndicesVector(e,_t59){e.startVector(4,_t59,4);}},{key:"addKernelDefHashes",value:function addKernelDefHashes(e,_t60){e.addFieldOffset(1,_t60,0);}},{key:"createKernelDefHashesVector",value:function createKernelDefHashesVector(e,_t61){e.startVector(8,_t61.length,8);for(var _r85=_t61.length-1;_r85>=0;_r85--)e.addInt64(_t61[_r85]);return e.endVector();}},{key:"startKernelDefHashesVector",value:function startKernelDefHashesVector(e,_t62){e.startVector(8,_t62,8);}},{key:"endKernelCreateInfos",value:function endKernelCreateInfos(e){return e.endObject();}},{key:"createKernelCreateInfos",value:function createKernelCreateInfos(e,r,n){return t.startKernelCreateInfos(e),t.addNodeIndices(e,r),t.addKernelDefHashes(e,n),t.endKernelCreateInfos(e);}}]);}();e.KernelCreateInfos=t;})(t=e.fbs||(e.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(t){var r;(function(t){var r=/*#__PURE__*/function(){function r(){_classCallCheck2(this,r);this.bb=null,this.bb_pos=0;}return _createClass2(r,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"graphId",value:function graphId(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"sessionState",value:function sessionState(t){var _r86=this.bb.__offset(this.bb_pos,6);return _r86?(t||new e.experimental.fbs.SessionState()).__init(this.bb.__indirect(this.bb_pos+_r86),this.bb):null;}}],[{key:"getRootAsSubGraphSessionState",value:function getRootAsSubGraphSessionState(e,t){return(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsSubGraphSessionState",value:function getSizePrefixedRootAsSubGraphSessionState(e,t){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startSubGraphSessionState",value:function startSubGraphSessionState(e){e.startObject(2);}},{key:"addGraphId",value:function addGraphId(e,t){e.addFieldOffset(0,t,0);}},{key:"addSessionState",value:function addSessionState(e,t){e.addFieldOffset(1,t,0);}},{key:"endSubGraphSessionState",value:function endSubGraphSessionState(e){var t=e.endObject();return e.requiredField(t,4),t;}},{key:"createSubGraphSessionState",value:function createSubGraphSessionState(e,t,n){return r.startSubGraphSessionState(e),r.addGraphId(e,t),r.addSessionState(e,n),r.endSubGraphSessionState(e);}}]);}();t.SubGraphSessionState=r;})(r=t.fbs||(t.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(t){var r;(function(t){var r=/*#__PURE__*/function(){function r(){_classCallCheck2(this,r);this.bb=null,this.bb_pos=0;}return _createClass2(r,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"kernels",value:function kernels(t){var _r87=this.bb.__offset(this.bb_pos,4);return _r87?(t||new e.experimental.fbs.KernelCreateInfos()).__init(this.bb.__indirect(this.bb_pos+_r87),this.bb):null;}},{key:"subGraphSessionStates",value:function subGraphSessionStates(t,_r88){var n=this.bb.__offset(this.bb_pos,6);return n?(_r88||new e.experimental.fbs.SubGraphSessionState()).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null;}},{key:"subGraphSessionStatesLength",value:function subGraphSessionStatesLength(){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0;}}],[{key:"getRootAsSessionState",value:function getRootAsSessionState(e,t){return(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsSessionState",value:function getSizePrefixedRootAsSessionState(e,t){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"startSessionState",value:function startSessionState(e){e.startObject(2);}},{key:"addKernels",value:function addKernels(e,t){e.addFieldOffset(0,t,0);}},{key:"addSubGraphSessionStates",value:function addSubGraphSessionStates(e,t){e.addFieldOffset(1,t,0);}},{key:"createSubGraphSessionStatesVector",value:function createSubGraphSessionStatesVector(e,t){e.startVector(4,t.length,4);for(var _r90=t.length-1;_r90>=0;_r90--)e.addOffset(t[_r90]);return e.endVector();}},{key:"startSubGraphSessionStatesVector",value:function startSubGraphSessionStatesVector(e,t){e.startVector(4,t,4);}},{key:"endSessionState",value:function endSessionState(e){return e.endObject();}},{key:"createSessionState",value:function createSessionState(e,t,n){return r.startSessionState(e),r.addKernels(e,t),r.addSubGraphSessionStates(e,n),r.endSessionState(e);}}]);}();t.SessionState=r;})(r=t.fbs||(t.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={})),function(e){var t;(function(t){var r;(function(t){var r=/*#__PURE__*/function(){function r(){_classCallCheck2(this,r);this.bb=null,this.bb_pos=0;}return _createClass2(r,[{key:"__init",value:function __init(e,t){return this.bb_pos=e,this.bb=t,this;}},{key:"ortVersion",value:function ortVersion(e){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null;}},{key:"model",value:function model(t){var _r91=this.bb.__offset(this.bb_pos,6);return _r91?(t||new e.experimental.fbs.Model()).__init(this.bb.__indirect(this.bb_pos+_r91),this.bb):null;}},{key:"sessionState",value:function sessionState(t){var _r92=this.bb.__offset(this.bb_pos,8);return _r92?(t||new e.experimental.fbs.SessionState()).__init(this.bb.__indirect(this.bb_pos+_r92),this.bb):null;}}],[{key:"getRootAsInferenceSession",value:function getRootAsInferenceSession(e,t){return(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"getSizePrefixedRootAsInferenceSession",value:function getSizePrefixedRootAsInferenceSession(e,t){return e.setPosition(e.position()+I.SIZE_PREFIX_LENGTH),(t||new r()).__init(e.readInt32(e.position())+e.position(),e);}},{key:"bufferHasIdentifier",value:function bufferHasIdentifier(e){return e.__has_identifier("ORTM");}},{key:"startInferenceSession",value:function startInferenceSession(e){e.startObject(3);}},{key:"addOrtVersion",value:function addOrtVersion(e,t){e.addFieldOffset(0,t,0);}},{key:"addModel",value:function addModel(e,t){e.addFieldOffset(1,t,0);}},{key:"addSessionState",value:function addSessionState(e,t){e.addFieldOffset(2,t,0);}},{key:"endInferenceSession",value:function endInferenceSession(e){return e.endObject();}},{key:"finishInferenceSessionBuffer",value:function finishInferenceSessionBuffer(e,t){e.finish(t,"ORTM");}},{key:"finishSizePrefixedInferenceSessionBuffer",value:function finishSizePrefixedInferenceSessionBuffer(e,t){e.finish(t,"ORTM",!0);}},{key:"createInferenceSession",value:function createInferenceSession(e,t,n,i){return r.startInferenceSession(e),r.addOrtVersion(e,t),r.addModel(e,n),r.addSessionState(e,i),r.endInferenceSession(e);}}]);}();t.InferenceSession=r;})(r=t.fbs||(t.fbs={}));})(t=e.experimental||(e.experimental={}));}(H||(H={}));}),Ws=ye(function(e,t){t.exports=function(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(i,a){r[n]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];i.apply(null,t);}};try{e.apply(t||null,r);}catch(e){o&&(o=!1,a(e));}});};}),qs=ye(function(e){var t=e;t.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r;};var r,n=new Array(64),i=new Array(123);for(r=0;r<64;)i[n[r]=r<26?r+65:r<52?r+71:r<62?r-4:r-59|43]=r++;t.encode=function(e,t,r){for(var i,o=null,a=[],s=0,u=0;t<r;){var l=e[t++];switch(u){case 0:a[s++]=n[l>>2],i=(3&l)<<4,u=1;break;case 1:a[s++]=n[i|l>>4],i=(15&l)<<2,u=2;break;case 2:a[s++]=n[i|l>>6],a[s++]=n[63&l],u=0;}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0);}return u&&(a[s++]=n[i],a[s++]=61,1===u&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s));};var o="invalid encoding";t.decode=function(e,t,r){for(var n,a=r,s=0,u=0;u<e.length;){var l=e.charCodeAt(u++);if(61===l&&s>1)break;if(void 0===(l=i[l]))throw Error(o);switch(s){case 0:n=l,s=1;break;case 1:t[r++]=n<<2|(48&l)>>4,n=l,s=2;break;case 2:t[r++]=(15&n)<<4|(60&l)>>2,n=l,s=3;break;case 3:t[r++]=(3&n)<<6|l,s=0;}}if(1===s)throw Error(o);return r-a;},t.test=function(e){return /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e);};}),Xs=ye(function(e,t){function r(){this._listeners={};}t.exports=r,r.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this;},r.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this;},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r);}return this;};}),ru=ye(function(e,t){function r(e){return(typeof Float32Array==="undefined"?"undefined":_typeof2(Float32Array))<"u"?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3];}function o(e,n,i){t[0]=e,n[i]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0];}function a(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0];}function s(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0];}e.writeFloatLE=n?i:o,e.writeFloatBE=n?o:i,e.readFloatLE=n?a:s,e.readFloatBE=n?s:a;}():function(){function t(e,t,r,n){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,r,n);}}function r(e,t,r){var n=e(t,r),i=2*(n>>31)+1,o=n>>>23&255,a=8388607&n;return 255===o?a?NaN:i*(1/0):0===o?1401298464324817e-60*i*a:i*Math.pow(2,o-150)*(a+8388608);}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,i),e.readFloatLE=r.bind(null,o),e.readFloatBE=r.bind(null,a);}(),(typeof Float64Array==="undefined"?"undefined":_typeof2(Float64Array))<"u"?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3],n[i+4]=r[4],n[i+5]=r[5],n[i+6]=r[6],n[i+7]=r[7];}function o(e,n,i){t[0]=e,n[i]=r[7],n[i+1]=r[6],n[i+2]=r[5],n[i+3]=r[4],n[i+4]=r[3],n[i+5]=r[2],n[i+6]=r[1],n[i+7]=r[0];}function a(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0];}function s(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0];}e.writeDoubleLE=n?i:o,e.writeDoubleBE=n?o:i,e.readDoubleLE=n?a:s,e.readDoubleBE=n?s:a;}():function(){function t(e,t,r,n,i,o){var a=n<0?1:0;if(a&&(n=-n),0===n)e(0,i,o+t),e(1/n>0?0:2147483648,i,o+r);else if(isNaN(n))e(0,i,o+t),e(2146959360,i,o+r);else if(n>17976931348623157e292)e(0,i,o+t),e((a<<31|2146435072)>>>0,i,o+r);else{var s;if(n<22250738585072014e-324)e((s=n/5e-324)>>>0,i,o+t),e((a<<31|s/4294967296)>>>0,i,o+r);else{var u=Math.floor(Math.log(n)/Math.LN2);1024===u&&(u=1023),e(4503599627370496*(s=n*Math.pow(2,-u))>>>0,i,o+t),e((a<<31|u+1023<<20|1048576*s&1048575)>>>0,i,o+r);}}}function r(e,t,r,n,i){var o=e(n,i+t),a=e(n,i+r),s=2*(a>>31)+1,u=a>>>20&2047,l=4294967296*(1048575&a)+o;return 2047===u?l?NaN:s*(1/0):0===u?5e-324*s*l:s*Math.pow(2,u-1075)*(l+4503599627370496);}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,i,4,0),e.readDoubleLE=r.bind(null,o,0,4),e.readDoubleBE=r.bind(null,a,4,0);}(),e;}function n(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24;}function i(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e;}function o(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0;}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0;}t.exports=r(r);}),nu=ye(function(exports,module){function inquire(moduleName){try{var mod=undefined;if(mod&&(mod.length||Object.keys(mod).length))return mod;}catch(e){}return null;}module.exports=inquire;}),iu=ye(function(e){var t=e;t.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t;},t.read=function(e,t,r){if(r-t<1)return"";for(var n,i=null,o=[],a=0;t<r;)(n=e[t++])<128?o[a++]=n:n>191&&n<224?o[a++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(n>>10),o[a++]=56320+(1023&n)):o[a++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a));},t.write=function(e,t,r){for(var n,i,o=r,a=0;a<e.length;++a)(n=e.charCodeAt(a))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(i=e.charCodeAt(a+1)))?(n=65536+((1023&n)<<10)+(1023&i),++a,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-o;};}),su=ye(function(e,t){t.exports=function(e,t,r){var n=r||8192,i=n>>>1,o=null,a=n;return function(r){if(r<1||r>i)return e(r);a+r>n&&(o=e(n),a=0);var s=t.call(o,a,a+=r);return 7&a&&(a=1+(7|a)),s;};};}),lu=ye(function(e,t){t.exports=n;var r=tr();function n(e,t){this.lo=e>>>0,this.hi=t>>>0;}var i=n.zero=new n(0,0);i.toNumber=function(){return 0;},i.zzEncode=i.zzDecode=function(){return this;},i.length=function(){return 1;};var o=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var r=e>>>0,o=(e-r)/4294967296>>>0;return t&&(o=~o>>>0,r=~r>>>0,++r>4294967295&&(r=0,++o>4294967295&&(o=0))),new n(r,o);},n.from=function(e){if("number"==typeof e)return n.fromNumber(e);if(r.isString(e)){if(!r.Long)return n.fromNumber(parseInt(e,10));e=r.Long.fromString(e);}return e.low||e.high?new n(e.low>>>0,e.high>>>0):i;},n.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r);}return this.lo+4294967296*this.hi;},n.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,!!e):{low:0|this.lo,high:0|this.hi,unsigned:!!e};};var a=String.prototype.charCodeAt;n.fromHash=function(e){return e===o?i:new n((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0);},n.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24);},n.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this;},n.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this;},n.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10;};}),tr=ye(function(e){var t=e;function r(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)(void 0===e[n[i]]||!r)&&(e[n[i]]=t[n[i]]);return e;}function n(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function get(){return e;}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&r(this,n);}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function get(){return e;},set:void 0,enumerable:!1,configurable:!0},toString:{value:function value(){return this.name+": "+this.message;},writable:!0,enumerable:!1,configurable:!0}}),t;}t.asPromise=Ws(),t.base64=qs(),t.EventEmitter=Xs(),t["float"]=ru(),t.inquire=nu(),t.utf8=iu(),t.pool=su(),t.LongBits=lu(),t.isNode=!!((typeof global==="undefined"?"undefined":_typeof2(global))<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node),t.global=t.isNode&&global||(typeof window==="undefined"?"undefined":_typeof2(window))<"u"&&window||(typeof self==="undefined"?"undefined":_typeof2(self))<"u"&&self||e,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e;},t.isString=function(e){return"string"==typeof e||e instanceof String;},t.isObject=function(e){return e&&"object"==_typeof2(e);},t.isset=t.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=_typeof2(r)||(Array.isArray(r)?r.length:Object.keys(r).length)>0);},t.Buffer=function(){try{var e=t.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null;}catch(_unused2){return null;}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(e){return"number"==typeof e?t.Buffer?t._Buffer_allocUnsafe(e):new t.Array(e):t.Buffer?t._Buffer_from(e):(typeof Uint8Array==="undefined"?"undefined":_typeof2(Uint8Array))>"u"?e:new Uint8Array(e);},t.Array=(typeof Uint8Array==="undefined"?"undefined":_typeof2(Uint8Array))<"u"?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(e){return e?t.LongBits.from(e).toHash():t.LongBits.zeroHash;},t.longFromHash=function(e,r){var n=t.LongBits.fromHash(e);return t.Long?t.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r);},t.merge=r,t.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1);},t.newError=n,t.ProtocolError=n("ProtocolError"),t.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r];};},t.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]];};},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var e=t.Buffer;e?(t._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r);},t._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t);}):t._Buffer_from=t._Buffer_allocUnsafe=null;};}),mi=ye(function(e,t){t.exports=c;var r,n=tr(),i=n.LongBits,o=n.base64,a=n.utf8;function s(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r;}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states;}function c(){this.len=0,this.head=new s(u,0,0),this.tail=this.head,this.states=null;}var h=function h(){return n.Buffer?function(){return(c.create=function(){return new r();})();}:function(){return new c();};};function f(e,t,r){t[r]=255&e;}function d(e,t){this.len=e,this.next=void 0,this.val=t;}function p(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo;}function y(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24;}c.create=h(),c.alloc=function(e){return new n.Array(e);},n.Array!==Array&&(c.alloc=n.pool(c.alloc,n.Array.prototype.subarray)),c.prototype._push=function(e,t,r){return this.tail=this.tail.next=new s(e,t,r),this.len+=t,this;},d.prototype=Object.create(s.prototype),d.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e;},c.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new d((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this;},c.prototype.int32=function(e){return e<0?this._push(p,10,i.fromNumber(e)):this.uint32(e);},c.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0);},c.prototype.uint64=function(e){var t=i.from(e);return this._push(p,t.length(),t);},c.prototype.int64=c.prototype.uint64,c.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(p,t.length(),t);},c.prototype.bool=function(e){return this._push(f,1,e?1:0);},c.prototype.fixed32=function(e){return this._push(y,4,e>>>0);},c.prototype.sfixed32=c.prototype.fixed32,c.prototype.fixed64=function(e){var t=i.from(e);return this._push(y,4,t.lo)._push(y,4,t.hi);},c.prototype.sfixed64=c.prototype.fixed64,c.prototype["float"]=function(e){return this._push(n["float"].writeFloatLE,4,e);},c.prototype["double"]=function(e){return this._push(n["float"].writeDoubleLE,8,e);};var m=n.Array.prototype.set?function(e,t,r){t.set(e,r);}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n];};c.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(n.isString(e)){var r=c.alloc(t=o.length(e));o.decode(e,r,0),e=r;}return this.uint32(t)._push(m,t,e);},c.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0);},c.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new s(u,0,0),this.len=0,this;},c.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new s(u,0,0),this.len=0),this;},c.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this;},c.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t;},c._configure=function(e){r=e,c.create=h(),r._configure();};}),yu=ye(function(e,t){t.exports=i;var r=mi();(i.prototype=Object.create(r.prototype)).constructor=i;var n=tr();function i(){r.call(this);}function o(e,t,r){e.length<40?n.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r);}i._configure=function(){i.alloc=n._Buffer_allocUnsafe,i.writeBytesBuffer=n.Buffer&&n.Buffer.prototype instanceof Uint8Array&&"set"===n.Buffer.prototype.set.name?function(e,t,r){t.set(e,r);}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++];};},i.prototype.bytes=function(e){n.isString(e)&&(e=n._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this;},i.prototype.string=function(e){var t=n.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this;},i._configure();}),yi=ye(function(e,t){t.exports=s;var r,n=tr(),i=n.LongBits,o=n.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len);}function s(e){this.buf=e,this.pos=0,this.len=e.length;}var u=(typeof Uint8Array==="undefined"?"undefined":_typeof2(Uint8Array))<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new s(e);throw Error("illegal buffer");}:function(e){if(Array.isArray(e))return new s(e);throw Error("illegal buffer");},l=function l(){return n.Buffer?function(e){return(s.create=function(e){return n.Buffer.isBuffer(e)?new r(e):u(e);})(e);}:u;};function c(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e;}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e;}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e;}throw Error("invalid varint encoding");}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0;}function f(){if(this.pos+8>this.len)throw a(this,8);return new i(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4));}s.create=l(),s.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,s.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return e;};}(),s.prototype.int32=function(){return 0|this.uint32();},s.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e);},s.prototype.bool=function(){return 0!==this.uint32();},s.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return h(this.buf,this.pos+=4);},s.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|h(this.buf,this.pos+=4);},s.prototype["float"]=function(){if(this.pos+4>this.len)throw a(this,4);var e=n["float"].readFloatLE(this.buf,this.pos);return this.pos+=4,e;},s.prototype["double"]=function(){if(this.pos+8>this.len)throw a(this,4);var e=n["float"].readDoubleLE(this.buf,this.pos);return this.pos+=8,e;},s.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r);},s.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length);},s.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e;}else do{if(this.pos>=this.len)throw a(this);}while(128&this.buf[this.pos++]);return this;},s.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos);}return this;},s._configure=function(e){r=e,s.create=l(),r._configure();var t=n.Long?"toLong":"toNumber";n.merge(s.prototype,{int64:function int64(){return c.call(this)[t](!1);},uint64:function uint64(){return c.call(this)[t](!0);},sint64:function sint64(){return c.call(this).zzDecode()[t](!1);},fixed64:function fixed64(){return f.call(this)[t](!0);},sfixed64:function sfixed64(){return f.call(this)[t](!1);}});};}),Au=ye(function(e,t){t.exports=i;var r=yi();(i.prototype=Object.create(r.prototype)).constructor=i;var n=tr();function i(e){r.call(this,e);}i._configure=function(){n.Buffer&&(i.prototype._slice=n.Buffer.prototype.slice);},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len));},i._configure();}),Pu=ye(function(e,t){t.exports=n;var r=tr();function n(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!n;}(n.prototype=Object.create(r.EventEmitter.prototype)).constructor=n,n.prototype.rpcCall=function e(t,n,i,o,a){if(!o)throw TypeError("request must be specified");var s=this;if(!a)return r.asPromise(e,s,t,n,i,o);if(s.rpcImpl)try{return s.rpcImpl(t,n[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),function(e,r){if(e)return s.emit("error",e,t),a(e);if(null!==r){if(!(r instanceof i))try{r=i[s.responseDelimited?"decodeDelimited":"decode"](r);}catch(e){return s.emit("error",e,t),a(e);}return s.emit("data",r,t),a(null,r);}s.end(!0);});}catch(e){return s.emit("error",e,t),void setTimeout(function(){a(e);},0);}else setTimeout(function(){a(Error("already ended"));},0);},n.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this;};}),Lu=ye(function(e){e.Service=Pu();}),Cu=ye(function(e,t){t.exports={};}),ku=ye(function(e){var t=e;function r(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader);}t.build="minimal",t.Writer=mi(),t.BufferWriter=yu(),t.Reader=yi(),t.BufferReader=Au(),t.util=tr(),t.rpc=Lu(),t.roots=Cu(),t.configure=r,r();}),Ru=ye(function(e,t){t.exports=ku();}),Ur=ye(function(e,t){var r=Ru(),n=r.Reader,i=r.Writer,o=r.util,a=r.roots["default"]||(r.roots["default"]={});a.onnx=function(){var e={};return e.Version=function(){var e={},t=Object.create(e);return t[e[0]="_START_VERSION"]=0,t[e[1]="IR_VERSION_2017_10_10"]=1,t[e[2]="IR_VERSION_2017_10_30"]=2,t[e[3]="IR_VERSION_2017_11_3"]=3,t[e[4]="IR_VERSION_2019_1_22"]=4,t[e[5]="IR_VERSION_2019_3_18"]=5,t[e[6]="IR_VERSION_2019_9_19"]=6,t[e[7]="IR_VERSION_2020_5_8"]=7,t[e[8]="IR_VERSION_2021_7_30"]=8,t[e[9]="IR_VERSION"]=9,t;}(),e.AttributeProto=function(){function e(e){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],this.sparseTensors=[],this.typeProtos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.name="",e.prototype.refAttrName="",e.prototype.docString="",e.prototype.type=0,e.prototype.f=0,e.prototype.i=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.s=o.newBuffer([]),e.prototype.t=null,e.prototype.g=null,e.prototype.sparseTensor=null,e.prototype.tp=null,e.prototype.floats=o.emptyArray,e.prototype.ints=o.emptyArray,e.prototype.strings=o.emptyArray,e.prototype.tensors=o.emptyArray,e.prototype.graphs=o.emptyArray,e.prototype.sparseTensors=o.emptyArray,e.prototype.typeProtos=o.emptyArray,e.create=function(t){return new e(t);},e.encode=function(e,t){if(t||(t=i.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.f&&Object.hasOwnProperty.call(e,"f")&&t.uint32(21)["float"](e.f),null!=e.i&&Object.hasOwnProperty.call(e,"i")&&t.uint32(24).int64(e.i),null!=e.s&&Object.hasOwnProperty.call(e,"s")&&t.uint32(34).bytes(e.s),null!=e.t&&Object.hasOwnProperty.call(e,"t")&&a.onnx.TensorProto.encode(e.t,t.uint32(42).fork()).ldelim(),null!=e.g&&Object.hasOwnProperty.call(e,"g")&&a.onnx.GraphProto.encode(e.g,t.uint32(50).fork()).ldelim(),null!=e.floats&&e.floats.length){t.uint32(58).fork();for(var r=0;r<e.floats.length;++r)t["float"](e.floats[r]);t.ldelim();}if(null!=e.ints&&e.ints.length){t.uint32(66).fork();for(r=0;r<e.ints.length;++r)t.int64(e.ints[r]);t.ldelim();}if(null!=e.strings&&e.strings.length)for(r=0;r<e.strings.length;++r)t.uint32(74).bytes(e.strings[r]);if(null!=e.tensors&&e.tensors.length)for(r=0;r<e.tensors.length;++r)a.onnx.TensorProto.encode(e.tensors[r],t.uint32(82).fork()).ldelim();if(null!=e.graphs&&e.graphs.length)for(r=0;r<e.graphs.length;++r)a.onnx.GraphProto.encode(e.graphs[r],t.uint32(90).fork()).ldelim();if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(106).string(e.docString),null!=e.tp&&Object.hasOwnProperty.call(e,"tp")&&a.onnx.TypeProto.encode(e.tp,t.uint32(114).fork()).ldelim(),null!=e.typeProtos&&e.typeProtos.length)for(r=0;r<e.typeProtos.length;++r)a.onnx.TypeProto.encode(e.typeProtos[r],t.uint32(122).fork()).ldelim();if(null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(160).int32(e.type),null!=e.refAttrName&&Object.hasOwnProperty.call(e,"refAttrName")&&t.uint32(170).string(e.refAttrName),null!=e.sparseTensor&&Object.hasOwnProperty.call(e,"sparseTensor")&&a.onnx.SparseTensorProto.encode(e.sparseTensor,t.uint32(178).fork()).ldelim(),null!=e.sparseTensors&&e.sparseTensors.length)for(r=0;r<e.sparseTensors.length;++r)a.onnx.SparseTensorProto.encode(e.sparseTensors[r],t.uint32(186).fork()).ldelim();return t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.AttributeProto();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.name=e.string();break;case 21:i.refAttrName=e.string();break;case 13:i.docString=e.string();break;case 20:i.type=e.int32();break;case 2:i.f=e["float"]();break;case 3:i.i=e.int64();break;case 4:i.s=e.bytes();break;case 5:i.t=a.onnx.TensorProto.decode(e,e.uint32());break;case 6:i.g=a.onnx.GraphProto.decode(e,e.uint32());break;case 22:i.sparseTensor=a.onnx.SparseTensorProto.decode(e,e.uint32());break;case 14:i.tp=a.onnx.TypeProto.decode(e,e.uint32());break;case 7:if(i.floats&&i.floats.length||(i.floats=[]),2==(7&o))for(var s=e.uint32()+e.pos;e.pos<s;)i.floats.push(e["float"]());else i.floats.push(e["float"]());break;case 8:if(i.ints&&i.ints.length||(i.ints=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.ints.push(e.int64());else i.ints.push(e.int64());break;case 9:i.strings&&i.strings.length||(i.strings=[]),i.strings.push(e.bytes());break;case 10:i.tensors&&i.tensors.length||(i.tensors=[]),i.tensors.push(a.onnx.TensorProto.decode(e,e.uint32()));break;case 11:i.graphs&&i.graphs.length||(i.graphs=[]),i.graphs.push(a.onnx.GraphProto.decode(e,e.uint32()));break;case 23:i.sparseTensors&&i.sparseTensors.length||(i.sparseTensors=[]),i.sparseTensors.push(a.onnx.SparseTensorProto.decode(e,e.uint32()));break;case 15:i.typeProtos&&i.typeProtos.length||(i.typeProtos=[]),i.typeProtos.push(a.onnx.TypeProto.decode(e,e.uint32()));break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.refAttrName&&e.hasOwnProperty("refAttrName")&&!o.isString(e.refAttrName))return"refAttrName: string expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 11:case 13:case 6:case 7:case 8:case 9:case 10:case 12:case 14:}if(null!=e.f&&e.hasOwnProperty("f")&&"number"!=typeof e.f)return"f: number expected";if(null!=e.i&&e.hasOwnProperty("i")&&!o.isInteger(e.i)&&!(e.i&&o.isInteger(e.i.low)&&o.isInteger(e.i.high)))return"i: integer|Long expected";if(null!=e.s&&e.hasOwnProperty("s")&&!(e.s&&"number"==typeof e.s.length||o.isString(e.s)))return"s: buffer expected";if(null!=e.t&&e.hasOwnProperty("t")&&(r=a.onnx.TensorProto.verify(e.t)))return"t."+r;if(null!=e.g&&e.hasOwnProperty("g")&&(r=a.onnx.GraphProto.verify(e.g)))return"g."+r;if(null!=e.sparseTensor&&e.hasOwnProperty("sparseTensor")&&(r=a.onnx.SparseTensorProto.verify(e.sparseTensor)))return"sparseTensor."+r;if(null!=e.tp&&e.hasOwnProperty("tp")&&(r=a.onnx.TypeProto.verify(e.tp)))return"tp."+r;if(null!=e.floats&&e.hasOwnProperty("floats")){if(!Array.isArray(e.floats))return"floats: array expected";for(var t=0;t<e.floats.length;++t)if("number"!=typeof e.floats[t])return"floats: number[] expected";}if(null!=e.ints&&e.hasOwnProperty("ints")){if(!Array.isArray(e.ints))return"ints: array expected";for(t=0;t<e.ints.length;++t)if(!(o.isInteger(e.ints[t])||e.ints[t]&&o.isInteger(e.ints[t].low)&&o.isInteger(e.ints[t].high)))return"ints: integer|Long[] expected";}if(null!=e.strings&&e.hasOwnProperty("strings")){if(!Array.isArray(e.strings))return"strings: array expected";for(t=0;t<e.strings.length;++t)if(!(e.strings[t]&&"number"==typeof e.strings[t].length||o.isString(e.strings[t])))return"strings: buffer[] expected";}if(null!=e.tensors&&e.hasOwnProperty("tensors")){if(!Array.isArray(e.tensors))return"tensors: array expected";for(t=0;t<e.tensors.length;++t){if(r=a.onnx.TensorProto.verify(e.tensors[t]))return"tensors."+r;}}if(null!=e.graphs&&e.hasOwnProperty("graphs")){if(!Array.isArray(e.graphs))return"graphs: array expected";for(t=0;t<e.graphs.length;++t){if(r=a.onnx.GraphProto.verify(e.graphs[t]))return"graphs."+r;}}if(null!=e.sparseTensors&&e.hasOwnProperty("sparseTensors")){if(!Array.isArray(e.sparseTensors))return"sparseTensors: array expected";for(t=0;t<e.sparseTensors.length;++t){if(r=a.onnx.SparseTensorProto.verify(e.sparseTensors[t]))return"sparseTensors."+r;}}if(null!=e.typeProtos&&e.hasOwnProperty("typeProtos")){if(!Array.isArray(e.typeProtos))return"typeProtos: array expected";for(t=0;t<e.typeProtos.length;++t){var r;if(r=a.onnx.TypeProto.verify(e.typeProtos[t]))return"typeProtos."+r;}}return null;},e.fromObject=function(e){if(e instanceof a.onnx.AttributeProto)return e;var t=new a.onnx.AttributeProto();switch(null!=e.name&&(t.name=String(e.name)),null!=e.refAttrName&&(t.refAttrName=String(e.refAttrName)),null!=e.docString&&(t.docString=String(e.docString)),e.type){default:if("number"==typeof e.type){t.type=e.type;break;}break;case"UNDEFINED":case 0:t.type=0;break;case"FLOAT":case 1:t.type=1;break;case"INT":case 2:t.type=2;break;case"STRING":case 3:t.type=3;break;case"TENSOR":case 4:t.type=4;break;case"GRAPH":case 5:t.type=5;break;case"SPARSE_TENSOR":case 11:t.type=11;break;case"TYPE_PROTO":case 13:t.type=13;break;case"FLOATS":case 6:t.type=6;break;case"INTS":case 7:t.type=7;break;case"STRINGS":case 8:t.type=8;break;case"TENSORS":case 9:t.type=9;break;case"GRAPHS":case 10:t.type=10;break;case"SPARSE_TENSORS":case 12:t.type=12;break;case"TYPE_PROTOS":case 14:t.type=14;}if(null!=e.f&&(t.f=Number(e.f)),null!=e.i&&(o.Long?(t.i=o.Long.fromValue(e.i)).unsigned=!1:"string"==typeof e.i?t.i=parseInt(e.i,10):"number"==typeof e.i?t.i=e.i:"object"==_typeof2(e.i)&&(t.i=new o.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber())),null!=e.s&&("string"==typeof e.s?o.base64.decode(e.s,t.s=o.newBuffer(o.base64.length(e.s)),0):e.s.length>=0&&(t.s=e.s)),null!=e.t){if("object"!=_typeof2(e.t))throw TypeError(".onnx.AttributeProto.t: object expected");t.t=a.onnx.TensorProto.fromObject(e.t);}if(null!=e.g){if("object"!=_typeof2(e.g))throw TypeError(".onnx.AttributeProto.g: object expected");t.g=a.onnx.GraphProto.fromObject(e.g);}if(null!=e.sparseTensor){if("object"!=_typeof2(e.sparseTensor))throw TypeError(".onnx.AttributeProto.sparseTensor: object expected");t.sparseTensor=a.onnx.SparseTensorProto.fromObject(e.sparseTensor);}if(null!=e.tp){if("object"!=_typeof2(e.tp))throw TypeError(".onnx.AttributeProto.tp: object expected");t.tp=a.onnx.TypeProto.fromObject(e.tp);}if(e.floats){if(!Array.isArray(e.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");t.floats=[];for(var r=0;r<e.floats.length;++r)t.floats[r]=Number(e.floats[r]);}if(e.ints){if(!Array.isArray(e.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");t.ints=[];for(r=0;r<e.ints.length;++r)o.Long?(t.ints[r]=o.Long.fromValue(e.ints[r])).unsigned=!1:"string"==typeof e.ints[r]?t.ints[r]=parseInt(e.ints[r],10):"number"==typeof e.ints[r]?t.ints[r]=e.ints[r]:"object"==_typeof2(e.ints[r])&&(t.ints[r]=new o.LongBits(e.ints[r].low>>>0,e.ints[r].high>>>0).toNumber());}if(e.strings){if(!Array.isArray(e.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");t.strings=[];for(r=0;r<e.strings.length;++r)"string"==typeof e.strings[r]?o.base64.decode(e.strings[r],t.strings[r]=o.newBuffer(o.base64.length(e.strings[r])),0):e.strings[r].length>=0&&(t.strings[r]=e.strings[r]);}if(e.tensors){if(!Array.isArray(e.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");t.tensors=[];for(r=0;r<e.tensors.length;++r){if("object"!=_typeof2(e.tensors[r]))throw TypeError(".onnx.AttributeProto.tensors: object expected");t.tensors[r]=a.onnx.TensorProto.fromObject(e.tensors[r]);}}if(e.graphs){if(!Array.isArray(e.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");t.graphs=[];for(r=0;r<e.graphs.length;++r){if("object"!=_typeof2(e.graphs[r]))throw TypeError(".onnx.AttributeProto.graphs: object expected");t.graphs[r]=a.onnx.GraphProto.fromObject(e.graphs[r]);}}if(e.sparseTensors){if(!Array.isArray(e.sparseTensors))throw TypeError(".onnx.AttributeProto.sparseTensors: array expected");t.sparseTensors=[];for(r=0;r<e.sparseTensors.length;++r){if("object"!=_typeof2(e.sparseTensors[r]))throw TypeError(".onnx.AttributeProto.sparseTensors: object expected");t.sparseTensors[r]=a.onnx.SparseTensorProto.fromObject(e.sparseTensors[r]);}}if(e.typeProtos){if(!Array.isArray(e.typeProtos))throw TypeError(".onnx.AttributeProto.typeProtos: array expected");t.typeProtos=[];for(r=0;r<e.typeProtos.length;++r){if("object"!=_typeof2(e.typeProtos[r]))throw TypeError(".onnx.AttributeProto.typeProtos: object expected");t.typeProtos[r]=a.onnx.TypeProto.fromObject(e.typeProtos[r]);}}return t;},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.floats=[],r.ints=[],r.strings=[],r.tensors=[],r.graphs=[],r.typeProtos=[],r.sparseTensors=[]),t.defaults){if(r.name="",r.f=0,o.Long){var n=new o.Long(0,0,!1);r.i=t.longs===String?n.toString():t.longs===Number?n.toNumber():n;}else r.i=t.longs===String?"0":0;t.bytes===String?r.s="":(r.s=[],t.bytes!==Array&&(r.s=o.newBuffer(r.s))),r.t=null,r.g=null,r.docString="",r.tp=null,r.type=t.enums===String?"UNDEFINED":0,r.refAttrName="",r.sparseTensor=null;}if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.f&&e.hasOwnProperty("f")&&(r.f=t.json&&!isFinite(e.f)?String(e.f):e.f),null!=e.i&&e.hasOwnProperty("i")&&("number"==typeof e.i?r.i=t.longs===String?String(e.i):e.i:r.i=t.longs===String?o.Long.prototype.toString.call(e.i):t.longs===Number?new o.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber():e.i),null!=e.s&&e.hasOwnProperty("s")&&(r.s=t.bytes===String?o.base64.encode(e.s,0,e.s.length):t.bytes===Array?Array.prototype.slice.call(e.s):e.s),null!=e.t&&e.hasOwnProperty("t")&&(r.t=a.onnx.TensorProto.toObject(e.t,t)),null!=e.g&&e.hasOwnProperty("g")&&(r.g=a.onnx.GraphProto.toObject(e.g,t)),e.floats&&e.floats.length){r.floats=[];for(var i=0;i<e.floats.length;++i)r.floats[i]=t.json&&!isFinite(e.floats[i])?String(e.floats[i]):e.floats[i];}if(e.ints&&e.ints.length){r.ints=[];for(i=0;i<e.ints.length;++i)"number"==typeof e.ints[i]?r.ints[i]=t.longs===String?String(e.ints[i]):e.ints[i]:r.ints[i]=t.longs===String?o.Long.prototype.toString.call(e.ints[i]):t.longs===Number?new o.LongBits(e.ints[i].low>>>0,e.ints[i].high>>>0).toNumber():e.ints[i];}if(e.strings&&e.strings.length){r.strings=[];for(i=0;i<e.strings.length;++i)r.strings[i]=t.bytes===String?o.base64.encode(e.strings[i],0,e.strings[i].length):t.bytes===Array?Array.prototype.slice.call(e.strings[i]):e.strings[i];}if(e.tensors&&e.tensors.length){r.tensors=[];for(i=0;i<e.tensors.length;++i)r.tensors[i]=a.onnx.TensorProto.toObject(e.tensors[i],t);}if(e.graphs&&e.graphs.length){r.graphs=[];for(i=0;i<e.graphs.length;++i)r.graphs[i]=a.onnx.GraphProto.toObject(e.graphs[i],t);}if(null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),null!=e.tp&&e.hasOwnProperty("tp")&&(r.tp=a.onnx.TypeProto.toObject(e.tp,t)),e.typeProtos&&e.typeProtos.length){r.typeProtos=[];for(i=0;i<e.typeProtos.length;++i)r.typeProtos[i]=a.onnx.TypeProto.toObject(e.typeProtos[i],t);}if(null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?void 0===a.onnx.AttributeProto.AttributeType[e.type]?e.type:a.onnx.AttributeProto.AttributeType[e.type]:e.type),null!=e.refAttrName&&e.hasOwnProperty("refAttrName")&&(r.refAttrName=e.refAttrName),null!=e.sparseTensor&&e.hasOwnProperty("sparseTensor")&&(r.sparseTensor=a.onnx.SparseTensorProto.toObject(e.sparseTensor,t)),e.sparseTensors&&e.sparseTensors.length){r.sparseTensors=[];for(i=0;i<e.sparseTensors.length;++i)r.sparseTensors[i]=a.onnx.SparseTensorProto.toObject(e.sparseTensors[i],t);}return r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.AttributeProto";},e.AttributeType=function(){var e={},t=Object.create(e);return t[e[0]="UNDEFINED"]=0,t[e[1]="FLOAT"]=1,t[e[2]="INT"]=2,t[e[3]="STRING"]=3,t[e[4]="TENSOR"]=4,t[e[5]="GRAPH"]=5,t[e[11]="SPARSE_TENSOR"]=11,t[e[13]="TYPE_PROTO"]=13,t[e[6]="FLOATS"]=6,t[e[7]="INTS"]=7,t[e[8]="STRINGS"]=8,t[e[9]="TENSORS"]=9,t[e[10]="GRAPHS"]=10,t[e[12]="SPARSE_TENSORS"]=12,t[e[14]="TYPE_PROTOS"]=14,t;}(),e;}(),e.ValueInfoProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.name="",e.prototype.type=null,e.prototype.docString="",e.create=function(t){return new e(t);},e.encode=function(e,t){return t||(t=i.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&a.onnx.TypeProto.encode(e.type,t.uint32(18).fork()).ldelim(),null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(26).string(e.docString),t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.ValueInfoProto();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.name=e.string();break;case 2:i.type=a.onnx.TypeProto.decode(e,e.uint32());break;case 3:i.docString=e.string();break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.type&&e.hasOwnProperty("type")){var t=a.onnx.TypeProto.verify(e.type);if(t)return"type."+t;}return null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString)?"docString: string expected":null;},e.fromObject=function(e){if(e instanceof a.onnx.ValueInfoProto)return e;var t=new a.onnx.ValueInfoProto();if(null!=e.name&&(t.name=String(e.name)),null!=e.type){if("object"!=_typeof2(e.type))throw TypeError(".onnx.ValueInfoProto.type: object expected");t.type=a.onnx.TypeProto.fromObject(e.type);}return null!=e.docString&&(t.docString=String(e.docString)),t;},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.name="",r.type=null,r.docString=""),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.type&&e.hasOwnProperty("type")&&(r.type=a.onnx.TypeProto.toObject(e.type,t)),null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.ValueInfoProto";},e;}(),e.NodeProto=function(){function e(e){if(this.input=[],this.output=[],this.attribute=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.input=o.emptyArray,e.prototype.output=o.emptyArray,e.prototype.name="",e.prototype.opType="",e.prototype.domain="",e.prototype.attribute=o.emptyArray,e.prototype.docString="",e.create=function(t){return new e(t);},e.encode=function(e,t){if(t||(t=i.create()),null!=e.input&&e.input.length)for(var r=0;r<e.input.length;++r)t.uint32(10).string(e.input[r]);if(null!=e.output&&e.output.length)for(r=0;r<e.output.length;++r)t.uint32(18).string(e.output[r]);if(null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(26).string(e.name),null!=e.opType&&Object.hasOwnProperty.call(e,"opType")&&t.uint32(34).string(e.opType),null!=e.attribute&&e.attribute.length)for(r=0;r<e.attribute.length;++r)a.onnx.AttributeProto.encode(e.attribute[r],t.uint32(42).fork()).ldelim();return null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(50).string(e.docString),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(58).string(e.domain),t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.NodeProto();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.input&&i.input.length||(i.input=[]),i.input.push(e.string());break;case 2:i.output&&i.output.length||(i.output=[]),i.output.push(e.string());break;case 3:i.name=e.string();break;case 4:i.opType=e.string();break;case 7:i.domain=e.string();break;case 5:i.attribute&&i.attribute.length||(i.attribute=[]),i.attribute.push(a.onnx.AttributeProto.decode(e,e.uint32()));break;case 6:i.docString=e.string();break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(var t=0;t<e.input.length;++t)if(!o.isString(e.input[t]))return"input: string[] expected";}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(t=0;t<e.output.length;++t)if(!o.isString(e.output[t]))return"output: string[] expected";}if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.opType&&e.hasOwnProperty("opType")&&!o.isString(e.opType))return"opType: string expected";if(null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain))return"domain: string expected";if(null!=e.attribute&&e.hasOwnProperty("attribute")){if(!Array.isArray(e.attribute))return"attribute: array expected";for(t=0;t<e.attribute.length;++t){var r=a.onnx.AttributeProto.verify(e.attribute[t]);if(r)return"attribute."+r;}}return null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString)?"docString: string expected":null;},e.fromObject=function(e){if(e instanceof a.onnx.NodeProto)return e;var t=new a.onnx.NodeProto();if(e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.NodeProto.input: array expected");t.input=[];for(var r=0;r<e.input.length;++r)t.input[r]=String(e.input[r]);}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.NodeProto.output: array expected");t.output=[];for(r=0;r<e.output.length;++r)t.output[r]=String(e.output[r]);}if(null!=e.name&&(t.name=String(e.name)),null!=e.opType&&(t.opType=String(e.opType)),null!=e.domain&&(t.domain=String(e.domain)),e.attribute){if(!Array.isArray(e.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");t.attribute=[];for(r=0;r<e.attribute.length;++r){if("object"!=_typeof2(e.attribute[r]))throw TypeError(".onnx.NodeProto.attribute: object expected");t.attribute[r]=a.onnx.AttributeProto.fromObject(e.attribute[r]);}}return null!=e.docString&&(t.docString=String(e.docString)),t;},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.input=[],r.output=[],r.attribute=[]),t.defaults&&(r.name="",r.opType="",r.docString="",r.domain=""),e.input&&e.input.length){r.input=[];for(var n=0;n<e.input.length;++n)r.input[n]=e.input[n];}if(e.output&&e.output.length){r.output=[];for(n=0;n<e.output.length;++n)r.output[n]=e.output[n];}if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.opType&&e.hasOwnProperty("opType")&&(r.opType=e.opType),e.attribute&&e.attribute.length){r.attribute=[];for(n=0;n<e.attribute.length;++n)r.attribute[n]=a.onnx.AttributeProto.toObject(e.attribute[n],t);}return null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),null!=e.domain&&e.hasOwnProperty("domain")&&(r.domain=e.domain),r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.NodeProto";},e;}(),e.TrainingInfoProto=function(){function e(e){if(this.initializationBinding=[],this.updateBinding=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.initialization=null,e.prototype.algorithm=null,e.prototype.initializationBinding=o.emptyArray,e.prototype.updateBinding=o.emptyArray,e.create=function(t){return new e(t);},e.encode=function(e,t){if(t||(t=i.create()),null!=e.initialization&&Object.hasOwnProperty.call(e,"initialization")&&a.onnx.GraphProto.encode(e.initialization,t.uint32(10).fork()).ldelim(),null!=e.algorithm&&Object.hasOwnProperty.call(e,"algorithm")&&a.onnx.GraphProto.encode(e.algorithm,t.uint32(18).fork()).ldelim(),null!=e.initializationBinding&&e.initializationBinding.length)for(var r=0;r<e.initializationBinding.length;++r)a.onnx.StringStringEntryProto.encode(e.initializationBinding[r],t.uint32(26).fork()).ldelim();if(null!=e.updateBinding&&e.updateBinding.length)for(r=0;r<e.updateBinding.length;++r)a.onnx.StringStringEntryProto.encode(e.updateBinding[r],t.uint32(34).fork()).ldelim();return t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TrainingInfoProto();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.initialization=a.onnx.GraphProto.decode(e,e.uint32());break;case 2:i.algorithm=a.onnx.GraphProto.decode(e,e.uint32());break;case 3:i.initializationBinding&&i.initializationBinding.length||(i.initializationBinding=[]),i.initializationBinding.push(a.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 4:i.updateBinding&&i.updateBinding.length||(i.updateBinding=[]),i.updateBinding.push(a.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";if(null!=e.initialization&&e.hasOwnProperty("initialization")&&(r=a.onnx.GraphProto.verify(e.initialization)))return"initialization."+r;if(null!=e.algorithm&&e.hasOwnProperty("algorithm")&&(r=a.onnx.GraphProto.verify(e.algorithm)))return"algorithm."+r;if(null!=e.initializationBinding&&e.hasOwnProperty("initializationBinding")){if(!Array.isArray(e.initializationBinding))return"initializationBinding: array expected";for(var t=0;t<e.initializationBinding.length;++t){if(r=a.onnx.StringStringEntryProto.verify(e.initializationBinding[t]))return"initializationBinding."+r;}}if(null!=e.updateBinding&&e.hasOwnProperty("updateBinding")){if(!Array.isArray(e.updateBinding))return"updateBinding: array expected";for(t=0;t<e.updateBinding.length;++t){var r;if(r=a.onnx.StringStringEntryProto.verify(e.updateBinding[t]))return"updateBinding."+r;}}return null;},e.fromObject=function(e){if(e instanceof a.onnx.TrainingInfoProto)return e;var t=new a.onnx.TrainingInfoProto();if(null!=e.initialization){if("object"!=_typeof2(e.initialization))throw TypeError(".onnx.TrainingInfoProto.initialization: object expected");t.initialization=a.onnx.GraphProto.fromObject(e.initialization);}if(null!=e.algorithm){if("object"!=_typeof2(e.algorithm))throw TypeError(".onnx.TrainingInfoProto.algorithm: object expected");t.algorithm=a.onnx.GraphProto.fromObject(e.algorithm);}if(e.initializationBinding){if(!Array.isArray(e.initializationBinding))throw TypeError(".onnx.TrainingInfoProto.initializationBinding: array expected");t.initializationBinding=[];for(var r=0;r<e.initializationBinding.length;++r){if("object"!=_typeof2(e.initializationBinding[r]))throw TypeError(".onnx.TrainingInfoProto.initializationBinding: object expected");t.initializationBinding[r]=a.onnx.StringStringEntryProto.fromObject(e.initializationBinding[r]);}}if(e.updateBinding){if(!Array.isArray(e.updateBinding))throw TypeError(".onnx.TrainingInfoProto.updateBinding: array expected");t.updateBinding=[];for(r=0;r<e.updateBinding.length;++r){if("object"!=_typeof2(e.updateBinding[r]))throw TypeError(".onnx.TrainingInfoProto.updateBinding: object expected");t.updateBinding[r]=a.onnx.StringStringEntryProto.fromObject(e.updateBinding[r]);}}return t;},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.initializationBinding=[],r.updateBinding=[]),t.defaults&&(r.initialization=null,r.algorithm=null),null!=e.initialization&&e.hasOwnProperty("initialization")&&(r.initialization=a.onnx.GraphProto.toObject(e.initialization,t)),null!=e.algorithm&&e.hasOwnProperty("algorithm")&&(r.algorithm=a.onnx.GraphProto.toObject(e.algorithm,t)),e.initializationBinding&&e.initializationBinding.length){r.initializationBinding=[];for(var n=0;n<e.initializationBinding.length;++n)r.initializationBinding[n]=a.onnx.StringStringEntryProto.toObject(e.initializationBinding[n],t);}if(e.updateBinding&&e.updateBinding.length){r.updateBinding=[];for(n=0;n<e.updateBinding.length;++n)r.updateBinding[n]=a.onnx.StringStringEntryProto.toObject(e.updateBinding[n],t);}return r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TrainingInfoProto";},e;}(),e.ModelProto=function(){function e(e){if(this.opsetImport=[],this.metadataProps=[],this.trainingInfo=[],this.functions=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.irVersion=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.opsetImport=o.emptyArray,e.prototype.producerName="",e.prototype.producerVersion="",e.prototype.domain="",e.prototype.modelVersion=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.docString="",e.prototype.graph=null,e.prototype.metadataProps=o.emptyArray,e.prototype.trainingInfo=o.emptyArray,e.prototype.functions=o.emptyArray,e.create=function(t){return new e(t);},e.encode=function(e,t){if(t||(t=i.create()),null!=e.irVersion&&Object.hasOwnProperty.call(e,"irVersion")&&t.uint32(8).int64(e.irVersion),null!=e.producerName&&Object.hasOwnProperty.call(e,"producerName")&&t.uint32(18).string(e.producerName),null!=e.producerVersion&&Object.hasOwnProperty.call(e,"producerVersion")&&t.uint32(26).string(e.producerVersion),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(34).string(e.domain),null!=e.modelVersion&&Object.hasOwnProperty.call(e,"modelVersion")&&t.uint32(40).int64(e.modelVersion),null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(50).string(e.docString),null!=e.graph&&Object.hasOwnProperty.call(e,"graph")&&a.onnx.GraphProto.encode(e.graph,t.uint32(58).fork()).ldelim(),null!=e.opsetImport&&e.opsetImport.length)for(var r=0;r<e.opsetImport.length;++r)a.onnx.OperatorSetIdProto.encode(e.opsetImport[r],t.uint32(66).fork()).ldelim();if(null!=e.metadataProps&&e.metadataProps.length)for(r=0;r<e.metadataProps.length;++r)a.onnx.StringStringEntryProto.encode(e.metadataProps[r],t.uint32(114).fork()).ldelim();if(null!=e.trainingInfo&&e.trainingInfo.length)for(r=0;r<e.trainingInfo.length;++r)a.onnx.TrainingInfoProto.encode(e.trainingInfo[r],t.uint32(162).fork()).ldelim();if(null!=e.functions&&e.functions.length)for(r=0;r<e.functions.length;++r)a.onnx.FunctionProto.encode(e.functions[r],t.uint32(202).fork()).ldelim();return t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.ModelProto();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.irVersion=e.int64();break;case 8:i.opsetImport&&i.opsetImport.length||(i.opsetImport=[]),i.opsetImport.push(a.onnx.OperatorSetIdProto.decode(e,e.uint32()));break;case 2:i.producerName=e.string();break;case 3:i.producerVersion=e.string();break;case 4:i.domain=e.string();break;case 5:i.modelVersion=e.int64();break;case 6:i.docString=e.string();break;case 7:i.graph=a.onnx.GraphProto.decode(e,e.uint32());break;case 14:i.metadataProps&&i.metadataProps.length||(i.metadataProps=[]),i.metadataProps.push(a.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 20:i.trainingInfo&&i.trainingInfo.length||(i.trainingInfo=[]),i.trainingInfo.push(a.onnx.TrainingInfoProto.decode(e,e.uint32()));break;case 25:i.functions&&i.functions.length||(i.functions=[]),i.functions.push(a.onnx.FunctionProto.decode(e,e.uint32()));break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";if(null!=e.irVersion&&e.hasOwnProperty("irVersion")&&!o.isInteger(e.irVersion)&&!(e.irVersion&&o.isInteger(e.irVersion.low)&&o.isInteger(e.irVersion.high)))return"irVersion: integer|Long expected";if(null!=e.opsetImport&&e.hasOwnProperty("opsetImport")){if(!Array.isArray(e.opsetImport))return"opsetImport: array expected";for(var t=0;t<e.opsetImport.length;++t){if(r=a.onnx.OperatorSetIdProto.verify(e.opsetImport[t]))return"opsetImport."+r;}}if(null!=e.producerName&&e.hasOwnProperty("producerName")&&!o.isString(e.producerName))return"producerName: string expected";if(null!=e.producerVersion&&e.hasOwnProperty("producerVersion")&&!o.isString(e.producerVersion))return"producerVersion: string expected";if(null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain))return"domain: string expected";if(null!=e.modelVersion&&e.hasOwnProperty("modelVersion")&&!o.isInteger(e.modelVersion)&&!(e.modelVersion&&o.isInteger(e.modelVersion.low)&&o.isInteger(e.modelVersion.high)))return"modelVersion: integer|Long expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.graph&&e.hasOwnProperty("graph")&&(r=a.onnx.GraphProto.verify(e.graph)))return"graph."+r;if(null!=e.metadataProps&&e.hasOwnProperty("metadataProps")){if(!Array.isArray(e.metadataProps))return"metadataProps: array expected";for(t=0;t<e.metadataProps.length;++t){if(r=a.onnx.StringStringEntryProto.verify(e.metadataProps[t]))return"metadataProps."+r;}}if(null!=e.trainingInfo&&e.hasOwnProperty("trainingInfo")){if(!Array.isArray(e.trainingInfo))return"trainingInfo: array expected";for(t=0;t<e.trainingInfo.length;++t){if(r=a.onnx.TrainingInfoProto.verify(e.trainingInfo[t]))return"trainingInfo."+r;}}if(null!=e.functions&&e.hasOwnProperty("functions")){if(!Array.isArray(e.functions))return"functions: array expected";for(t=0;t<e.functions.length;++t){var r;if(r=a.onnx.FunctionProto.verify(e.functions[t]))return"functions."+r;}}return null;},e.fromObject=function(e){if(e instanceof a.onnx.ModelProto)return e;var t=new a.onnx.ModelProto();if(null!=e.irVersion&&(o.Long?(t.irVersion=o.Long.fromValue(e.irVersion)).unsigned=!1:"string"==typeof e.irVersion?t.irVersion=parseInt(e.irVersion,10):"number"==typeof e.irVersion?t.irVersion=e.irVersion:"object"==_typeof2(e.irVersion)&&(t.irVersion=new o.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber())),e.opsetImport){if(!Array.isArray(e.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");t.opsetImport=[];for(var r=0;r<e.opsetImport.length;++r){if("object"!=_typeof2(e.opsetImport[r]))throw TypeError(".onnx.ModelProto.opsetImport: object expected");t.opsetImport[r]=a.onnx.OperatorSetIdProto.fromObject(e.opsetImport[r]);}}if(null!=e.producerName&&(t.producerName=String(e.producerName)),null!=e.producerVersion&&(t.producerVersion=String(e.producerVersion)),null!=e.domain&&(t.domain=String(e.domain)),null!=e.modelVersion&&(o.Long?(t.modelVersion=o.Long.fromValue(e.modelVersion)).unsigned=!1:"string"==typeof e.modelVersion?t.modelVersion=parseInt(e.modelVersion,10):"number"==typeof e.modelVersion?t.modelVersion=e.modelVersion:"object"==_typeof2(e.modelVersion)&&(t.modelVersion=new o.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber())),null!=e.docString&&(t.docString=String(e.docString)),null!=e.graph){if("object"!=_typeof2(e.graph))throw TypeError(".onnx.ModelProto.graph: object expected");t.graph=a.onnx.GraphProto.fromObject(e.graph);}if(e.metadataProps){if(!Array.isArray(e.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");t.metadataProps=[];for(r=0;r<e.metadataProps.length;++r){if("object"!=_typeof2(e.metadataProps[r]))throw TypeError(".onnx.ModelProto.metadataProps: object expected");t.metadataProps[r]=a.onnx.StringStringEntryProto.fromObject(e.metadataProps[r]);}}if(e.trainingInfo){if(!Array.isArray(e.trainingInfo))throw TypeError(".onnx.ModelProto.trainingInfo: array expected");t.trainingInfo=[];for(r=0;r<e.trainingInfo.length;++r){if("object"!=_typeof2(e.trainingInfo[r]))throw TypeError(".onnx.ModelProto.trainingInfo: object expected");t.trainingInfo[r]=a.onnx.TrainingInfoProto.fromObject(e.trainingInfo[r]);}}if(e.functions){if(!Array.isArray(e.functions))throw TypeError(".onnx.ModelProto.functions: array expected");t.functions=[];for(r=0;r<e.functions.length;++r){if("object"!=_typeof2(e.functions[r]))throw TypeError(".onnx.ModelProto.functions: object expected");t.functions[r]=a.onnx.FunctionProto.fromObject(e.functions[r]);}}return t;},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.opsetImport=[],r.metadataProps=[],r.trainingInfo=[],r.functions=[]),t.defaults){if(o.Long){var n=new o.Long(0,0,!1);r.irVersion=t.longs===String?n.toString():t.longs===Number?n.toNumber():n;}else r.irVersion=t.longs===String?"0":0;if(r.producerName="",r.producerVersion="",r.domain="",o.Long){n=new o.Long(0,0,!1);r.modelVersion=t.longs===String?n.toString():t.longs===Number?n.toNumber():n;}else r.modelVersion=t.longs===String?"0":0;r.docString="",r.graph=null;}if(null!=e.irVersion&&e.hasOwnProperty("irVersion")&&("number"==typeof e.irVersion?r.irVersion=t.longs===String?String(e.irVersion):e.irVersion:r.irVersion=t.longs===String?o.Long.prototype.toString.call(e.irVersion):t.longs===Number?new o.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber():e.irVersion),null!=e.producerName&&e.hasOwnProperty("producerName")&&(r.producerName=e.producerName),null!=e.producerVersion&&e.hasOwnProperty("producerVersion")&&(r.producerVersion=e.producerVersion),null!=e.domain&&e.hasOwnProperty("domain")&&(r.domain=e.domain),null!=e.modelVersion&&e.hasOwnProperty("modelVersion")&&("number"==typeof e.modelVersion?r.modelVersion=t.longs===String?String(e.modelVersion):e.modelVersion:r.modelVersion=t.longs===String?o.Long.prototype.toString.call(e.modelVersion):t.longs===Number?new o.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber():e.modelVersion),null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),null!=e.graph&&e.hasOwnProperty("graph")&&(r.graph=a.onnx.GraphProto.toObject(e.graph,t)),e.opsetImport&&e.opsetImport.length){r.opsetImport=[];for(var i=0;i<e.opsetImport.length;++i)r.opsetImport[i]=a.onnx.OperatorSetIdProto.toObject(e.opsetImport[i],t);}if(e.metadataProps&&e.metadataProps.length){r.metadataProps=[];for(i=0;i<e.metadataProps.length;++i)r.metadataProps[i]=a.onnx.StringStringEntryProto.toObject(e.metadataProps[i],t);}if(e.trainingInfo&&e.trainingInfo.length){r.trainingInfo=[];for(i=0;i<e.trainingInfo.length;++i)r.trainingInfo[i]=a.onnx.TrainingInfoProto.toObject(e.trainingInfo[i],t);}if(e.functions&&e.functions.length){r.functions=[];for(i=0;i<e.functions.length;++i)r.functions[i]=a.onnx.FunctionProto.toObject(e.functions[i],t);}return r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.ModelProto";},e;}(),e.StringStringEntryProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.key="",e.prototype.value="",e.create=function(t){return new e(t);},e.encode=function(e,t){return t||(t=i.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.StringStringEntryProto();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.key=e.string();break;case 2:i.value=e.string();break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){return"object"!=_typeof2(e)||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!o.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!o.isString(e.value)?"value: string expected":null;},e.fromObject=function(e){if(e instanceof a.onnx.StringStringEntryProto)return e;var t=new a.onnx.StringStringEntryProto();return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t;},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.key="",r.value=""),null!=e.key&&e.hasOwnProperty("key")&&(r.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(r.value=e.value),r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.StringStringEntryProto";},e;}(),e.TensorAnnotation=function(){function e(e){if(this.quantParameterTensorNames=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.tensorName="",e.prototype.quantParameterTensorNames=o.emptyArray,e.create=function(t){return new e(t);},e.encode=function(e,t){if(t||(t=i.create()),null!=e.tensorName&&Object.hasOwnProperty.call(e,"tensorName")&&t.uint32(10).string(e.tensorName),null!=e.quantParameterTensorNames&&e.quantParameterTensorNames.length)for(var r=0;r<e.quantParameterTensorNames.length;++r)a.onnx.StringStringEntryProto.encode(e.quantParameterTensorNames[r],t.uint32(18).fork()).ldelim();return t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TensorAnnotation();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.tensorName=e.string();break;case 2:i.quantParameterTensorNames&&i.quantParameterTensorNames.length||(i.quantParameterTensorNames=[]),i.quantParameterTensorNames.push(a.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";if(null!=e.tensorName&&e.hasOwnProperty("tensorName")&&!o.isString(e.tensorName))return"tensorName: string expected";if(null!=e.quantParameterTensorNames&&e.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(e.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var t=0;t<e.quantParameterTensorNames.length;++t){var r=a.onnx.StringStringEntryProto.verify(e.quantParameterTensorNames[t]);if(r)return"quantParameterTensorNames."+r;}}return null;},e.fromObject=function(e){if(e instanceof a.onnx.TensorAnnotation)return e;var t=new a.onnx.TensorAnnotation();if(null!=e.tensorName&&(t.tensorName=String(e.tensorName)),e.quantParameterTensorNames){if(!Array.isArray(e.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");t.quantParameterTensorNames=[];for(var r=0;r<e.quantParameterTensorNames.length;++r){if("object"!=_typeof2(e.quantParameterTensorNames[r]))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");t.quantParameterTensorNames[r]=a.onnx.StringStringEntryProto.fromObject(e.quantParameterTensorNames[r]);}}return t;},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.quantParameterTensorNames=[]),t.defaults&&(r.tensorName=""),null!=e.tensorName&&e.hasOwnProperty("tensorName")&&(r.tensorName=e.tensorName),e.quantParameterTensorNames&&e.quantParameterTensorNames.length){r.quantParameterTensorNames=[];for(var n=0;n<e.quantParameterTensorNames.length;++n)r.quantParameterTensorNames[n]=a.onnx.StringStringEntryProto.toObject(e.quantParameterTensorNames[n],t);}return r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorAnnotation";},e;}(),e.GraphProto=function(){function e(e){if(this.node=[],this.initializer=[],this.sparseInitializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.node=o.emptyArray,e.prototype.name="",e.prototype.initializer=o.emptyArray,e.prototype.sparseInitializer=o.emptyArray,e.prototype.docString="",e.prototype.input=o.emptyArray,e.prototype.output=o.emptyArray,e.prototype.valueInfo=o.emptyArray,e.prototype.quantizationAnnotation=o.emptyArray,e.create=function(t){return new e(t);},e.encode=function(e,t){if(t||(t=i.create()),null!=e.node&&e.node.length)for(var r=0;r<e.node.length;++r)a.onnx.NodeProto.encode(e.node[r],t.uint32(10).fork()).ldelim();if(null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),null!=e.initializer&&e.initializer.length)for(r=0;r<e.initializer.length;++r)a.onnx.TensorProto.encode(e.initializer[r],t.uint32(42).fork()).ldelim();if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(82).string(e.docString),null!=e.input&&e.input.length)for(r=0;r<e.input.length;++r)a.onnx.ValueInfoProto.encode(e.input[r],t.uint32(90).fork()).ldelim();if(null!=e.output&&e.output.length)for(r=0;r<e.output.length;++r)a.onnx.ValueInfoProto.encode(e.output[r],t.uint32(98).fork()).ldelim();if(null!=e.valueInfo&&e.valueInfo.length)for(r=0;r<e.valueInfo.length;++r)a.onnx.ValueInfoProto.encode(e.valueInfo[r],t.uint32(106).fork()).ldelim();if(null!=e.quantizationAnnotation&&e.quantizationAnnotation.length)for(r=0;r<e.quantizationAnnotation.length;++r)a.onnx.TensorAnnotation.encode(e.quantizationAnnotation[r],t.uint32(114).fork()).ldelim();if(null!=e.sparseInitializer&&e.sparseInitializer.length)for(r=0;r<e.sparseInitializer.length;++r)a.onnx.SparseTensorProto.encode(e.sparseInitializer[r],t.uint32(122).fork()).ldelim();return t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.GraphProto();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.node&&i.node.length||(i.node=[]),i.node.push(a.onnx.NodeProto.decode(e,e.uint32()));break;case 2:i.name=e.string();break;case 5:i.initializer&&i.initializer.length||(i.initializer=[]),i.initializer.push(a.onnx.TensorProto.decode(e,e.uint32()));break;case 15:i.sparseInitializer&&i.sparseInitializer.length||(i.sparseInitializer=[]),i.sparseInitializer.push(a.onnx.SparseTensorProto.decode(e,e.uint32()));break;case 10:i.docString=e.string();break;case 11:i.input&&i.input.length||(i.input=[]),i.input.push(a.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 12:i.output&&i.output.length||(i.output=[]),i.output.push(a.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 13:i.valueInfo&&i.valueInfo.length||(i.valueInfo=[]),i.valueInfo.push(a.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 14:i.quantizationAnnotation&&i.quantizationAnnotation.length||(i.quantizationAnnotation=[]),i.quantizationAnnotation.push(a.onnx.TensorAnnotation.decode(e,e.uint32()));break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";if(null!=e.node&&e.hasOwnProperty("node")){if(!Array.isArray(e.node))return"node: array expected";for(var t=0;t<e.node.length;++t){if(r=a.onnx.NodeProto.verify(e.node[t]))return"node."+r;}}if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.initializer&&e.hasOwnProperty("initializer")){if(!Array.isArray(e.initializer))return"initializer: array expected";for(t=0;t<e.initializer.length;++t){if(r=a.onnx.TensorProto.verify(e.initializer[t]))return"initializer."+r;}}if(null!=e.sparseInitializer&&e.hasOwnProperty("sparseInitializer")){if(!Array.isArray(e.sparseInitializer))return"sparseInitializer: array expected";for(t=0;t<e.sparseInitializer.length;++t){if(r=a.onnx.SparseTensorProto.verify(e.sparseInitializer[t]))return"sparseInitializer."+r;}}if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(t=0;t<e.input.length;++t){if(r=a.onnx.ValueInfoProto.verify(e.input[t]))return"input."+r;}}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(t=0;t<e.output.length;++t){if(r=a.onnx.ValueInfoProto.verify(e.output[t]))return"output."+r;}}if(null!=e.valueInfo&&e.hasOwnProperty("valueInfo")){if(!Array.isArray(e.valueInfo))return"valueInfo: array expected";for(t=0;t<e.valueInfo.length;++t){if(r=a.onnx.ValueInfoProto.verify(e.valueInfo[t]))return"valueInfo."+r;}}if(null!=e.quantizationAnnotation&&e.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(e.quantizationAnnotation))return"quantizationAnnotation: array expected";for(t=0;t<e.quantizationAnnotation.length;++t){var r;if(r=a.onnx.TensorAnnotation.verify(e.quantizationAnnotation[t]))return"quantizationAnnotation."+r;}}return null;},e.fromObject=function(e){if(e instanceof a.onnx.GraphProto)return e;var t=new a.onnx.GraphProto();if(e.node){if(!Array.isArray(e.node))throw TypeError(".onnx.GraphProto.node: array expected");t.node=[];for(var r=0;r<e.node.length;++r){if("object"!=_typeof2(e.node[r]))throw TypeError(".onnx.GraphProto.node: object expected");t.node[r]=a.onnx.NodeProto.fromObject(e.node[r]);}}if(null!=e.name&&(t.name=String(e.name)),e.initializer){if(!Array.isArray(e.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");t.initializer=[];for(r=0;r<e.initializer.length;++r){if("object"!=_typeof2(e.initializer[r]))throw TypeError(".onnx.GraphProto.initializer: object expected");t.initializer[r]=a.onnx.TensorProto.fromObject(e.initializer[r]);}}if(e.sparseInitializer){if(!Array.isArray(e.sparseInitializer))throw TypeError(".onnx.GraphProto.sparseInitializer: array expected");t.sparseInitializer=[];for(r=0;r<e.sparseInitializer.length;++r){if("object"!=_typeof2(e.sparseInitializer[r]))throw TypeError(".onnx.GraphProto.sparseInitializer: object expected");t.sparseInitializer[r]=a.onnx.SparseTensorProto.fromObject(e.sparseInitializer[r]);}}if(null!=e.docString&&(t.docString=String(e.docString)),e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.GraphProto.input: array expected");t.input=[];for(r=0;r<e.input.length;++r){if("object"!=_typeof2(e.input[r]))throw TypeError(".onnx.GraphProto.input: object expected");t.input[r]=a.onnx.ValueInfoProto.fromObject(e.input[r]);}}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.GraphProto.output: array expected");t.output=[];for(r=0;r<e.output.length;++r){if("object"!=_typeof2(e.output[r]))throw TypeError(".onnx.GraphProto.output: object expected");t.output[r]=a.onnx.ValueInfoProto.fromObject(e.output[r]);}}if(e.valueInfo){if(!Array.isArray(e.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");t.valueInfo=[];for(r=0;r<e.valueInfo.length;++r){if("object"!=_typeof2(e.valueInfo[r]))throw TypeError(".onnx.GraphProto.valueInfo: object expected");t.valueInfo[r]=a.onnx.ValueInfoProto.fromObject(e.valueInfo[r]);}}if(e.quantizationAnnotation){if(!Array.isArray(e.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");t.quantizationAnnotation=[];for(r=0;r<e.quantizationAnnotation.length;++r){if("object"!=_typeof2(e.quantizationAnnotation[r]))throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");t.quantizationAnnotation[r]=a.onnx.TensorAnnotation.fromObject(e.quantizationAnnotation[r]);}}return t;},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.node=[],r.initializer=[],r.input=[],r.output=[],r.valueInfo=[],r.quantizationAnnotation=[],r.sparseInitializer=[]),t.defaults&&(r.name="",r.docString=""),e.node&&e.node.length){r.node=[];for(var n=0;n<e.node.length;++n)r.node[n]=a.onnx.NodeProto.toObject(e.node[n],t);}if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),e.initializer&&e.initializer.length){r.initializer=[];for(n=0;n<e.initializer.length;++n)r.initializer[n]=a.onnx.TensorProto.toObject(e.initializer[n],t);}if(null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),e.input&&e.input.length){r.input=[];for(n=0;n<e.input.length;++n)r.input[n]=a.onnx.ValueInfoProto.toObject(e.input[n],t);}if(e.output&&e.output.length){r.output=[];for(n=0;n<e.output.length;++n)r.output[n]=a.onnx.ValueInfoProto.toObject(e.output[n],t);}if(e.valueInfo&&e.valueInfo.length){r.valueInfo=[];for(n=0;n<e.valueInfo.length;++n)r.valueInfo[n]=a.onnx.ValueInfoProto.toObject(e.valueInfo[n],t);}if(e.quantizationAnnotation&&e.quantizationAnnotation.length){r.quantizationAnnotation=[];for(n=0;n<e.quantizationAnnotation.length;++n)r.quantizationAnnotation[n]=a.onnx.TensorAnnotation.toObject(e.quantizationAnnotation[n],t);}if(e.sparseInitializer&&e.sparseInitializer.length){r.sparseInitializer=[];for(n=0;n<e.sparseInitializer.length;++n)r.sparseInitializer[n]=a.onnx.SparseTensorProto.toObject(e.sparseInitializer[n],t);}return r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.GraphProto";},e;}(),e.TensorProto=function(){function e(e){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.dims=o.emptyArray,e.prototype.dataType=0,e.prototype.segment=null,e.prototype.floatData=o.emptyArray,e.prototype.int32Data=o.emptyArray,e.prototype.stringData=o.emptyArray,e.prototype.int64Data=o.emptyArray,e.prototype.name="",e.prototype.docString="",e.prototype.rawData=o.newBuffer([]),e.prototype.externalData=o.emptyArray,e.prototype.dataLocation=0,e.prototype.doubleData=o.emptyArray,e.prototype.uint64Data=o.emptyArray,e.create=function(t){return new e(t);},e.encode=function(e,t){if(t||(t=i.create()),null!=e.dims&&e.dims.length){t.uint32(10).fork();for(var r=0;r<e.dims.length;++r)t.int64(e.dims[r]);t.ldelim();}if(null!=e.dataType&&Object.hasOwnProperty.call(e,"dataType")&&t.uint32(16).int32(e.dataType),null!=e.segment&&Object.hasOwnProperty.call(e,"segment")&&a.onnx.TensorProto.Segment.encode(e.segment,t.uint32(26).fork()).ldelim(),null!=e.floatData&&e.floatData.length){t.uint32(34).fork();for(r=0;r<e.floatData.length;++r)t["float"](e.floatData[r]);t.ldelim();}if(null!=e.int32Data&&e.int32Data.length){t.uint32(42).fork();for(r=0;r<e.int32Data.length;++r)t.int32(e.int32Data[r]);t.ldelim();}if(null!=e.stringData&&e.stringData.length)for(r=0;r<e.stringData.length;++r)t.uint32(50).bytes(e.stringData[r]);if(null!=e.int64Data&&e.int64Data.length){t.uint32(58).fork();for(r=0;r<e.int64Data.length;++r)t.int64(e.int64Data[r]);t.ldelim();}if(null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(66).string(e.name),null!=e.rawData&&Object.hasOwnProperty.call(e,"rawData")&&t.uint32(74).bytes(e.rawData),null!=e.doubleData&&e.doubleData.length){t.uint32(82).fork();for(r=0;r<e.doubleData.length;++r)t["double"](e.doubleData[r]);t.ldelim();}if(null!=e.uint64Data&&e.uint64Data.length){t.uint32(90).fork();for(r=0;r<e.uint64Data.length;++r)t.uint64(e.uint64Data[r]);t.ldelim();}if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(98).string(e.docString),null!=e.externalData&&e.externalData.length)for(r=0;r<e.externalData.length;++r)a.onnx.StringStringEntryProto.encode(e.externalData[r],t.uint32(106).fork()).ldelim();return null!=e.dataLocation&&Object.hasOwnProperty.call(e,"dataLocation")&&t.uint32(112).int32(e.dataLocation),t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TensorProto();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:if(i.dims&&i.dims.length||(i.dims=[]),2==(7&o))for(var s=e.uint32()+e.pos;e.pos<s;)i.dims.push(e.int64());else i.dims.push(e.int64());break;case 2:i.dataType=e.int32();break;case 3:i.segment=a.onnx.TensorProto.Segment.decode(e,e.uint32());break;case 4:if(i.floatData&&i.floatData.length||(i.floatData=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.floatData.push(e["float"]());else i.floatData.push(e["float"]());break;case 5:if(i.int32Data&&i.int32Data.length||(i.int32Data=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.int32Data.push(e.int32());else i.int32Data.push(e.int32());break;case 6:i.stringData&&i.stringData.length||(i.stringData=[]),i.stringData.push(e.bytes());break;case 7:if(i.int64Data&&i.int64Data.length||(i.int64Data=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.int64Data.push(e.int64());else i.int64Data.push(e.int64());break;case 8:i.name=e.string();break;case 12:i.docString=e.string();break;case 9:i.rawData=e.bytes();break;case 13:i.externalData&&i.externalData.length||(i.externalData=[]),i.externalData.push(a.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 14:i.dataLocation=e.int32();break;case 10:if(i.doubleData&&i.doubleData.length||(i.doubleData=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.doubleData.push(e["double"]());else i.doubleData.push(e["double"]());break;case 11:if(i.uint64Data&&i.uint64Data.length||(i.uint64Data=[]),2==(7&o))for(s=e.uint32()+e.pos;e.pos<s;)i.uint64Data.push(e.uint64());else i.uint64Data.push(e.uint64());break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";if(null!=e.dims&&e.hasOwnProperty("dims")){if(!Array.isArray(e.dims))return"dims: array expected";for(var t=0;t<e.dims.length;++t)if(!(o.isInteger(e.dims[t])||e.dims[t]&&o.isInteger(e.dims[t].low)&&o.isInteger(e.dims[t].high)))return"dims: integer|Long[] expected";}if(null!=e.dataType&&e.hasOwnProperty("dataType")&&!o.isInteger(e.dataType))return"dataType: integer expected";if(null!=e.segment&&e.hasOwnProperty("segment")&&(r=a.onnx.TensorProto.Segment.verify(e.segment)))return"segment."+r;if(null!=e.floatData&&e.hasOwnProperty("floatData")){if(!Array.isArray(e.floatData))return"floatData: array expected";for(t=0;t<e.floatData.length;++t)if("number"!=typeof e.floatData[t])return"floatData: number[] expected";}if(null!=e.int32Data&&e.hasOwnProperty("int32Data")){if(!Array.isArray(e.int32Data))return"int32Data: array expected";for(t=0;t<e.int32Data.length;++t)if(!o.isInteger(e.int32Data[t]))return"int32Data: integer[] expected";}if(null!=e.stringData&&e.hasOwnProperty("stringData")){if(!Array.isArray(e.stringData))return"stringData: array expected";for(t=0;t<e.stringData.length;++t)if(!(e.stringData[t]&&"number"==typeof e.stringData[t].length||o.isString(e.stringData[t])))return"stringData: buffer[] expected";}if(null!=e.int64Data&&e.hasOwnProperty("int64Data")){if(!Array.isArray(e.int64Data))return"int64Data: array expected";for(t=0;t<e.int64Data.length;++t)if(!(o.isInteger(e.int64Data[t])||e.int64Data[t]&&o.isInteger(e.int64Data[t].low)&&o.isInteger(e.int64Data[t].high)))return"int64Data: integer|Long[] expected";}if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.rawData&&e.hasOwnProperty("rawData")&&!(e.rawData&&"number"==typeof e.rawData.length||o.isString(e.rawData)))return"rawData: buffer expected";if(null!=e.externalData&&e.hasOwnProperty("externalData")){if(!Array.isArray(e.externalData))return"externalData: array expected";for(t=0;t<e.externalData.length;++t){var r;if(r=a.onnx.StringStringEntryProto.verify(e.externalData[t]))return"externalData."+r;}}if(null!=e.dataLocation&&e.hasOwnProperty("dataLocation"))switch(e.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:}if(null!=e.doubleData&&e.hasOwnProperty("doubleData")){if(!Array.isArray(e.doubleData))return"doubleData: array expected";for(t=0;t<e.doubleData.length;++t)if("number"!=typeof e.doubleData[t])return"doubleData: number[] expected";}if(null!=e.uint64Data&&e.hasOwnProperty("uint64Data")){if(!Array.isArray(e.uint64Data))return"uint64Data: array expected";for(t=0;t<e.uint64Data.length;++t)if(!(o.isInteger(e.uint64Data[t])||e.uint64Data[t]&&o.isInteger(e.uint64Data[t].low)&&o.isInteger(e.uint64Data[t].high)))return"uint64Data: integer|Long[] expected";}return null;},e.fromObject=function(e){if(e instanceof a.onnx.TensorProto)return e;var t=new a.onnx.TensorProto();if(e.dims){if(!Array.isArray(e.dims))throw TypeError(".onnx.TensorProto.dims: array expected");t.dims=[];for(var r=0;r<e.dims.length;++r)o.Long?(t.dims[r]=o.Long.fromValue(e.dims[r])).unsigned=!1:"string"==typeof e.dims[r]?t.dims[r]=parseInt(e.dims[r],10):"number"==typeof e.dims[r]?t.dims[r]=e.dims[r]:"object"==_typeof2(e.dims[r])&&(t.dims[r]=new o.LongBits(e.dims[r].low>>>0,e.dims[r].high>>>0).toNumber());}if(null!=e.dataType&&(t.dataType=0|e.dataType),null!=e.segment){if("object"!=_typeof2(e.segment))throw TypeError(".onnx.TensorProto.segment: object expected");t.segment=a.onnx.TensorProto.Segment.fromObject(e.segment);}if(e.floatData){if(!Array.isArray(e.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");t.floatData=[];for(r=0;r<e.floatData.length;++r)t.floatData[r]=Number(e.floatData[r]);}if(e.int32Data){if(!Array.isArray(e.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");t.int32Data=[];for(r=0;r<e.int32Data.length;++r)t.int32Data[r]=0|e.int32Data[r];}if(e.stringData){if(!Array.isArray(e.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");t.stringData=[];for(r=0;r<e.stringData.length;++r)"string"==typeof e.stringData[r]?o.base64.decode(e.stringData[r],t.stringData[r]=o.newBuffer(o.base64.length(e.stringData[r])),0):e.stringData[r].length>=0&&(t.stringData[r]=e.stringData[r]);}if(e.int64Data){if(!Array.isArray(e.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");t.int64Data=[];for(r=0;r<e.int64Data.length;++r)o.Long?(t.int64Data[r]=o.Long.fromValue(e.int64Data[r])).unsigned=!1:"string"==typeof e.int64Data[r]?t.int64Data[r]=parseInt(e.int64Data[r],10):"number"==typeof e.int64Data[r]?t.int64Data[r]=e.int64Data[r]:"object"==_typeof2(e.int64Data[r])&&(t.int64Data[r]=new o.LongBits(e.int64Data[r].low>>>0,e.int64Data[r].high>>>0).toNumber());}if(null!=e.name&&(t.name=String(e.name)),null!=e.docString&&(t.docString=String(e.docString)),null!=e.rawData&&("string"==typeof e.rawData?o.base64.decode(e.rawData,t.rawData=o.newBuffer(o.base64.length(e.rawData)),0):e.rawData.length>=0&&(t.rawData=e.rawData)),e.externalData){if(!Array.isArray(e.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");t.externalData=[];for(r=0;r<e.externalData.length;++r){if("object"!=_typeof2(e.externalData[r]))throw TypeError(".onnx.TensorProto.externalData: object expected");t.externalData[r]=a.onnx.StringStringEntryProto.fromObject(e.externalData[r]);}}switch(e.dataLocation){default:if("number"==typeof e.dataLocation){t.dataLocation=e.dataLocation;break;}break;case"DEFAULT":case 0:t.dataLocation=0;break;case"EXTERNAL":case 1:t.dataLocation=1;}if(e.doubleData){if(!Array.isArray(e.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");t.doubleData=[];for(r=0;r<e.doubleData.length;++r)t.doubleData[r]=Number(e.doubleData[r]);}if(e.uint64Data){if(!Array.isArray(e.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");t.uint64Data=[];for(r=0;r<e.uint64Data.length;++r)o.Long?(t.uint64Data[r]=o.Long.fromValue(e.uint64Data[r])).unsigned=!0:"string"==typeof e.uint64Data[r]?t.uint64Data[r]=parseInt(e.uint64Data[r],10):"number"==typeof e.uint64Data[r]?t.uint64Data[r]=e.uint64Data[r]:"object"==_typeof2(e.uint64Data[r])&&(t.uint64Data[r]=new o.LongBits(e.uint64Data[r].low>>>0,e.uint64Data[r].high>>>0).toNumber(!0));}return t;},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.dims=[],r.floatData=[],r.int32Data=[],r.stringData=[],r.int64Data=[],r.doubleData=[],r.uint64Data=[],r.externalData=[]),t.defaults&&(r.dataType=0,r.segment=null,r.name="",t.bytes===String?r.rawData="":(r.rawData=[],t.bytes!==Array&&(r.rawData=o.newBuffer(r.rawData))),r.docString="",r.dataLocation=t.enums===String?"DEFAULT":0),e.dims&&e.dims.length){r.dims=[];for(var n=0;n<e.dims.length;++n)"number"==typeof e.dims[n]?r.dims[n]=t.longs===String?String(e.dims[n]):e.dims[n]:r.dims[n]=t.longs===String?o.Long.prototype.toString.call(e.dims[n]):t.longs===Number?new o.LongBits(e.dims[n].low>>>0,e.dims[n].high>>>0).toNumber():e.dims[n];}if(null!=e.dataType&&e.hasOwnProperty("dataType")&&(r.dataType=e.dataType),null!=e.segment&&e.hasOwnProperty("segment")&&(r.segment=a.onnx.TensorProto.Segment.toObject(e.segment,t)),e.floatData&&e.floatData.length){r.floatData=[];for(n=0;n<e.floatData.length;++n)r.floatData[n]=t.json&&!isFinite(e.floatData[n])?String(e.floatData[n]):e.floatData[n];}if(e.int32Data&&e.int32Data.length){r.int32Data=[];for(n=0;n<e.int32Data.length;++n)r.int32Data[n]=e.int32Data[n];}if(e.stringData&&e.stringData.length){r.stringData=[];for(n=0;n<e.stringData.length;++n)r.stringData[n]=t.bytes===String?o.base64.encode(e.stringData[n],0,e.stringData[n].length):t.bytes===Array?Array.prototype.slice.call(e.stringData[n]):e.stringData[n];}if(e.int64Data&&e.int64Data.length){r.int64Data=[];for(n=0;n<e.int64Data.length;++n)"number"==typeof e.int64Data[n]?r.int64Data[n]=t.longs===String?String(e.int64Data[n]):e.int64Data[n]:r.int64Data[n]=t.longs===String?o.Long.prototype.toString.call(e.int64Data[n]):t.longs===Number?new o.LongBits(e.int64Data[n].low>>>0,e.int64Data[n].high>>>0).toNumber():e.int64Data[n];}if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.rawData&&e.hasOwnProperty("rawData")&&(r.rawData=t.bytes===String?o.base64.encode(e.rawData,0,e.rawData.length):t.bytes===Array?Array.prototype.slice.call(e.rawData):e.rawData),e.doubleData&&e.doubleData.length){r.doubleData=[];for(n=0;n<e.doubleData.length;++n)r.doubleData[n]=t.json&&!isFinite(e.doubleData[n])?String(e.doubleData[n]):e.doubleData[n];}if(e.uint64Data&&e.uint64Data.length){r.uint64Data=[];for(n=0;n<e.uint64Data.length;++n)"number"==typeof e.uint64Data[n]?r.uint64Data[n]=t.longs===String?String(e.uint64Data[n]):e.uint64Data[n]:r.uint64Data[n]=t.longs===String?o.Long.prototype.toString.call(e.uint64Data[n]):t.longs===Number?new o.LongBits(e.uint64Data[n].low>>>0,e.uint64Data[n].high>>>0).toNumber(!0):e.uint64Data[n];}if(null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),e.externalData&&e.externalData.length){r.externalData=[];for(n=0;n<e.externalData.length;++n)r.externalData[n]=a.onnx.StringStringEntryProto.toObject(e.externalData[n],t);}return null!=e.dataLocation&&e.hasOwnProperty("dataLocation")&&(r.dataLocation=t.enums===String?void 0===a.onnx.TensorProto.DataLocation[e.dataLocation]?e.dataLocation:a.onnx.TensorProto.DataLocation[e.dataLocation]:e.dataLocation),r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorProto";},e.DataType=function(){var e={},t=Object.create(e);return t[e[0]="UNDEFINED"]=0,t[e[1]="FLOAT"]=1,t[e[2]="UINT8"]=2,t[e[3]="INT8"]=3,t[e[4]="UINT16"]=4,t[e[5]="INT16"]=5,t[e[6]="INT32"]=6,t[e[7]="INT64"]=7,t[e[8]="STRING"]=8,t[e[9]="BOOL"]=9,t[e[10]="FLOAT16"]=10,t[e[11]="DOUBLE"]=11,t[e[12]="UINT32"]=12,t[e[13]="UINT64"]=13,t[e[14]="COMPLEX64"]=14,t[e[15]="COMPLEX128"]=15,t[e[16]="BFLOAT16"]=16,t[e[17]="FLOAT8E4M3FN"]=17,t[e[18]="FLOAT8E4M3FNUZ"]=18,t[e[19]="FLOAT8E5M2"]=19,t[e[20]="FLOAT8E5M2FNUZ"]=20,t;}(),e.Segment=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.begin=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.end=o.Long?o.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t);},e.encode=function(e,t){return t||(t=i.create()),null!=e.begin&&Object.hasOwnProperty.call(e,"begin")&&t.uint32(8).int64(e.begin),null!=e.end&&Object.hasOwnProperty.call(e,"end")&&t.uint32(16).int64(e.end),t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TensorProto.Segment();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.begin=e.int64();break;case 2:i.end=e.int64();break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){return"object"!=_typeof2(e)||null===e?"object expected":null==e.begin||!e.hasOwnProperty("begin")||o.isInteger(e.begin)||e.begin&&o.isInteger(e.begin.low)&&o.isInteger(e.begin.high)?null==e.end||!e.hasOwnProperty("end")||o.isInteger(e.end)||e.end&&o.isInteger(e.end.low)&&o.isInteger(e.end.high)?null:"end: integer|Long expected":"begin: integer|Long expected";},e.fromObject=function(e){if(e instanceof a.onnx.TensorProto.Segment)return e;var t=new a.onnx.TensorProto.Segment();return null!=e.begin&&(o.Long?(t.begin=o.Long.fromValue(e.begin)).unsigned=!1:"string"==typeof e.begin?t.begin=parseInt(e.begin,10):"number"==typeof e.begin?t.begin=e.begin:"object"==_typeof2(e.begin)&&(t.begin=new o.LongBits(e.begin.low>>>0,e.begin.high>>>0).toNumber())),null!=e.end&&(o.Long?(t.end=o.Long.fromValue(e.end)).unsigned=!1:"string"==typeof e.end?t.end=parseInt(e.end,10):"number"==typeof e.end?t.end=e.end:"object"==_typeof2(e.end)&&(t.end=new o.LongBits(e.end.low>>>0,e.end.high>>>0).toNumber())),t;},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(o.Long){var n=new o.Long(0,0,!1);r.begin=t.longs===String?n.toString():t.longs===Number?n.toNumber():n;}else r.begin=t.longs===String?"0":0;if(o.Long){n=new o.Long(0,0,!1);r.end=t.longs===String?n.toString():t.longs===Number?n.toNumber():n;}else r.end=t.longs===String?"0":0;}return null!=e.begin&&e.hasOwnProperty("begin")&&("number"==typeof e.begin?r.begin=t.longs===String?String(e.begin):e.begin:r.begin=t.longs===String?o.Long.prototype.toString.call(e.begin):t.longs===Number?new o.LongBits(e.begin.low>>>0,e.begin.high>>>0).toNumber():e.begin),null!=e.end&&e.hasOwnProperty("end")&&("number"==typeof e.end?r.end=t.longs===String?String(e.end):e.end:r.end=t.longs===String?o.Long.prototype.toString.call(e.end):t.longs===Number?new o.LongBits(e.end.low>>>0,e.end.high>>>0).toNumber():e.end),r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorProto.Segment";},e;}(),e.DataLocation=function(){var e={},t=Object.create(e);return t[e[0]="DEFAULT"]=0,t[e[1]="EXTERNAL"]=1,t;}(),e;}(),e.SparseTensorProto=function(){function e(e){if(this.dims=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.values=null,e.prototype.indices=null,e.prototype.dims=o.emptyArray,e.create=function(t){return new e(t);},e.encode=function(e,t){if(t||(t=i.create()),null!=e.values&&Object.hasOwnProperty.call(e,"values")&&a.onnx.TensorProto.encode(e.values,t.uint32(10).fork()).ldelim(),null!=e.indices&&Object.hasOwnProperty.call(e,"indices")&&a.onnx.TensorProto.encode(e.indices,t.uint32(18).fork()).ldelim(),null!=e.dims&&e.dims.length){t.uint32(26).fork();for(var r=0;r<e.dims.length;++r)t.int64(e.dims[r]);t.ldelim();}return t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.SparseTensorProto();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.values=a.onnx.TensorProto.decode(e,e.uint32());break;case 2:i.indices=a.onnx.TensorProto.decode(e,e.uint32());break;case 3:if(i.dims&&i.dims.length||(i.dims=[]),2==(7&o))for(var s=e.uint32()+e.pos;e.pos<s;)i.dims.push(e.int64());else i.dims.push(e.int64());break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";var t;if(null!=e.values&&e.hasOwnProperty("values")&&(t=a.onnx.TensorProto.verify(e.values)))return"values."+t;if(null!=e.indices&&e.hasOwnProperty("indices")&&(t=a.onnx.TensorProto.verify(e.indices)))return"indices."+t;if(null!=e.dims&&e.hasOwnProperty("dims")){if(!Array.isArray(e.dims))return"dims: array expected";for(var r=0;r<e.dims.length;++r)if(!(o.isInteger(e.dims[r])||e.dims[r]&&o.isInteger(e.dims[r].low)&&o.isInteger(e.dims[r].high)))return"dims: integer|Long[] expected";}return null;},e.fromObject=function(e){if(e instanceof a.onnx.SparseTensorProto)return e;var t=new a.onnx.SparseTensorProto();if(null!=e.values){if("object"!=_typeof2(e.values))throw TypeError(".onnx.SparseTensorProto.values: object expected");t.values=a.onnx.TensorProto.fromObject(e.values);}if(null!=e.indices){if("object"!=_typeof2(e.indices))throw TypeError(".onnx.SparseTensorProto.indices: object expected");t.indices=a.onnx.TensorProto.fromObject(e.indices);}if(e.dims){if(!Array.isArray(e.dims))throw TypeError(".onnx.SparseTensorProto.dims: array expected");t.dims=[];for(var r=0;r<e.dims.length;++r)o.Long?(t.dims[r]=o.Long.fromValue(e.dims[r])).unsigned=!1:"string"==typeof e.dims[r]?t.dims[r]=parseInt(e.dims[r],10):"number"==typeof e.dims[r]?t.dims[r]=e.dims[r]:"object"==_typeof2(e.dims[r])&&(t.dims[r]=new o.LongBits(e.dims[r].low>>>0,e.dims[r].high>>>0).toNumber());}return t;},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.dims=[]),t.defaults&&(r.values=null,r.indices=null),null!=e.values&&e.hasOwnProperty("values")&&(r.values=a.onnx.TensorProto.toObject(e.values,t)),null!=e.indices&&e.hasOwnProperty("indices")&&(r.indices=a.onnx.TensorProto.toObject(e.indices,t)),e.dims&&e.dims.length){r.dims=[];for(var n=0;n<e.dims.length;++n)"number"==typeof e.dims[n]?r.dims[n]=t.longs===String?String(e.dims[n]):e.dims[n]:r.dims[n]=t.longs===String?o.Long.prototype.toString.call(e.dims[n]):t.longs===Number?new o.LongBits(e.dims[n].low>>>0,e.dims[n].high>>>0).toNumber():e.dims[n];}return r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.SparseTensorProto";},e;}(),e.TensorShapeProto=function(){function e(e){if(this.dim=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.dim=o.emptyArray,e.create=function(t){return new e(t);},e.encode=function(e,t){if(t||(t=i.create()),null!=e.dim&&e.dim.length)for(var r=0;r<e.dim.length;++r)a.onnx.TensorShapeProto.Dimension.encode(e.dim[r],t.uint32(10).fork()).ldelim();return t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TensorShapeProto();e.pos<r;){var o=e.uint32();if(o>>>3==1)i.dim&&i.dim.length||(i.dim=[]),i.dim.push(a.onnx.TensorShapeProto.Dimension.decode(e,e.uint32()));else e.skipType(7&o);}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";if(null!=e.dim&&e.hasOwnProperty("dim")){if(!Array.isArray(e.dim))return"dim: array expected";for(var t=0;t<e.dim.length;++t){var r=a.onnx.TensorShapeProto.Dimension.verify(e.dim[t]);if(r)return"dim."+r;}}return null;},e.fromObject=function(e){if(e instanceof a.onnx.TensorShapeProto)return e;var t=new a.onnx.TensorShapeProto();if(e.dim){if(!Array.isArray(e.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");t.dim=[];for(var r=0;r<e.dim.length;++r){if("object"!=_typeof2(e.dim[r]))throw TypeError(".onnx.TensorShapeProto.dim: object expected");t.dim[r]=a.onnx.TensorShapeProto.Dimension.fromObject(e.dim[r]);}}return t;},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.dim=[]),e.dim&&e.dim.length){r.dim=[];for(var n=0;n<e.dim.length;++n)r.dim[n]=a.onnx.TensorShapeProto.Dimension.toObject(e.dim[n],t);}return r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorShapeProto";},e.Dimension=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}var t;return e.prototype.dimValue=null,e.prototype.dimParam=null,e.prototype.denotation="",Object.defineProperty(e.prototype,"value",{get:o.oneOfGetter(t=["dimValue","dimParam"]),set:o.oneOfSetter(t)}),e.create=function(t){return new e(t);},e.encode=function(e,t){return t||(t=i.create()),null!=e.dimValue&&Object.hasOwnProperty.call(e,"dimValue")&&t.uint32(8).int64(e.dimValue),null!=e.dimParam&&Object.hasOwnProperty.call(e,"dimParam")&&t.uint32(18).string(e.dimParam),null!=e.denotation&&Object.hasOwnProperty.call(e,"denotation")&&t.uint32(26).string(e.denotation),t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TensorShapeProto.Dimension();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.dimValue=e.int64();break;case 2:i.dimParam=e.string();break;case 3:i.denotation=e.string();break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";var t={};if(null!=e.dimValue&&e.hasOwnProperty("dimValue")&&(t.value=1,!(o.isInteger(e.dimValue)||e.dimValue&&o.isInteger(e.dimValue.low)&&o.isInteger(e.dimValue.high))))return"dimValue: integer|Long expected";if(null!=e.dimParam&&e.hasOwnProperty("dimParam")){if(1===t.value)return"value: multiple values";if(t.value=1,!o.isString(e.dimParam))return"dimParam: string expected";}return null!=e.denotation&&e.hasOwnProperty("denotation")&&!o.isString(e.denotation)?"denotation: string expected":null;},e.fromObject=function(e){if(e instanceof a.onnx.TensorShapeProto.Dimension)return e;var t=new a.onnx.TensorShapeProto.Dimension();return null!=e.dimValue&&(o.Long?(t.dimValue=o.Long.fromValue(e.dimValue)).unsigned=!1:"string"==typeof e.dimValue?t.dimValue=parseInt(e.dimValue,10):"number"==typeof e.dimValue?t.dimValue=e.dimValue:"object"==_typeof2(e.dimValue)&&(t.dimValue=new o.LongBits(e.dimValue.low>>>0,e.dimValue.high>>>0).toNumber())),null!=e.dimParam&&(t.dimParam=String(e.dimParam)),null!=e.denotation&&(t.denotation=String(e.denotation)),t;},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.denotation=""),null!=e.dimValue&&e.hasOwnProperty("dimValue")&&("number"==typeof e.dimValue?r.dimValue=t.longs===String?String(e.dimValue):e.dimValue:r.dimValue=t.longs===String?o.Long.prototype.toString.call(e.dimValue):t.longs===Number?new o.LongBits(e.dimValue.low>>>0,e.dimValue.high>>>0).toNumber():e.dimValue,t.oneofs&&(r.value="dimValue")),null!=e.dimParam&&e.hasOwnProperty("dimParam")&&(r.dimParam=e.dimParam,t.oneofs&&(r.value="dimParam")),null!=e.denotation&&e.hasOwnProperty("denotation")&&(r.denotation=e.denotation),r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorShapeProto.Dimension";},e;}(),e;}(),e.TypeProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}var t;return e.prototype.tensorType=null,e.prototype.sequenceType=null,e.prototype.mapType=null,e.prototype.optionalType=null,e.prototype.sparseTensorType=null,e.prototype.denotation="",Object.defineProperty(e.prototype,"value",{get:o.oneOfGetter(t=["tensorType","sequenceType","mapType","optionalType","sparseTensorType"]),set:o.oneOfSetter(t)}),e.create=function(t){return new e(t);},e.encode=function(e,t){return t||(t=i.create()),null!=e.tensorType&&Object.hasOwnProperty.call(e,"tensorType")&&a.onnx.TypeProto.Tensor.encode(e.tensorType,t.uint32(10).fork()).ldelim(),null!=e.sequenceType&&Object.hasOwnProperty.call(e,"sequenceType")&&a.onnx.TypeProto.Sequence.encode(e.sequenceType,t.uint32(34).fork()).ldelim(),null!=e.mapType&&Object.hasOwnProperty.call(e,"mapType")&&a.onnx.TypeProto.Map.encode(e.mapType,t.uint32(42).fork()).ldelim(),null!=e.denotation&&Object.hasOwnProperty.call(e,"denotation")&&t.uint32(50).string(e.denotation),null!=e.sparseTensorType&&Object.hasOwnProperty.call(e,"sparseTensorType")&&a.onnx.TypeProto.SparseTensor.encode(e.sparseTensorType,t.uint32(66).fork()).ldelim(),null!=e.optionalType&&Object.hasOwnProperty.call(e,"optionalType")&&a.onnx.TypeProto.Optional.encode(e.optionalType,t.uint32(74).fork()).ldelim(),t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.tensorType=a.onnx.TypeProto.Tensor.decode(e,e.uint32());break;case 4:i.sequenceType=a.onnx.TypeProto.Sequence.decode(e,e.uint32());break;case 5:i.mapType=a.onnx.TypeProto.Map.decode(e,e.uint32());break;case 9:i.optionalType=a.onnx.TypeProto.Optional.decode(e,e.uint32());break;case 8:i.sparseTensorType=a.onnx.TypeProto.SparseTensor.decode(e,e.uint32());break;case 6:i.denotation=e.string();break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";var t={};if(null!=e.tensorType&&e.hasOwnProperty("tensorType")&&(t.value=1,r=a.onnx.TypeProto.Tensor.verify(e.tensorType)))return"tensorType."+r;if(null!=e.sequenceType&&e.hasOwnProperty("sequenceType")){if(1===t.value)return"value: multiple values";if(t.value=1,r=a.onnx.TypeProto.Sequence.verify(e.sequenceType))return"sequenceType."+r;}if(null!=e.mapType&&e.hasOwnProperty("mapType")){if(1===t.value)return"value: multiple values";if(t.value=1,r=a.onnx.TypeProto.Map.verify(e.mapType))return"mapType."+r;}if(null!=e.optionalType&&e.hasOwnProperty("optionalType")){if(1===t.value)return"value: multiple values";if(t.value=1,r=a.onnx.TypeProto.Optional.verify(e.optionalType))return"optionalType."+r;}if(null!=e.sparseTensorType&&e.hasOwnProperty("sparseTensorType")){if(1===t.value)return"value: multiple values";var r;if(t.value=1,r=a.onnx.TypeProto.SparseTensor.verify(e.sparseTensorType))return"sparseTensorType."+r;}return null!=e.denotation&&e.hasOwnProperty("denotation")&&!o.isString(e.denotation)?"denotation: string expected":null;},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto)return e;var t=new a.onnx.TypeProto();if(null!=e.tensorType){if("object"!=_typeof2(e.tensorType))throw TypeError(".onnx.TypeProto.tensorType: object expected");t.tensorType=a.onnx.TypeProto.Tensor.fromObject(e.tensorType);}if(null!=e.sequenceType){if("object"!=_typeof2(e.sequenceType))throw TypeError(".onnx.TypeProto.sequenceType: object expected");t.sequenceType=a.onnx.TypeProto.Sequence.fromObject(e.sequenceType);}if(null!=e.mapType){if("object"!=_typeof2(e.mapType))throw TypeError(".onnx.TypeProto.mapType: object expected");t.mapType=a.onnx.TypeProto.Map.fromObject(e.mapType);}if(null!=e.optionalType){if("object"!=_typeof2(e.optionalType))throw TypeError(".onnx.TypeProto.optionalType: object expected");t.optionalType=a.onnx.TypeProto.Optional.fromObject(e.optionalType);}if(null!=e.sparseTensorType){if("object"!=_typeof2(e.sparseTensorType))throw TypeError(".onnx.TypeProto.sparseTensorType: object expected");t.sparseTensorType=a.onnx.TypeProto.SparseTensor.fromObject(e.sparseTensorType);}return null!=e.denotation&&(t.denotation=String(e.denotation)),t;},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.denotation=""),null!=e.tensorType&&e.hasOwnProperty("tensorType")&&(r.tensorType=a.onnx.TypeProto.Tensor.toObject(e.tensorType,t),t.oneofs&&(r.value="tensorType")),null!=e.sequenceType&&e.hasOwnProperty("sequenceType")&&(r.sequenceType=a.onnx.TypeProto.Sequence.toObject(e.sequenceType,t),t.oneofs&&(r.value="sequenceType")),null!=e.mapType&&e.hasOwnProperty("mapType")&&(r.mapType=a.onnx.TypeProto.Map.toObject(e.mapType,t),t.oneofs&&(r.value="mapType")),null!=e.denotation&&e.hasOwnProperty("denotation")&&(r.denotation=e.denotation),null!=e.sparseTensorType&&e.hasOwnProperty("sparseTensorType")&&(r.sparseTensorType=a.onnx.TypeProto.SparseTensor.toObject(e.sparseTensorType,t),t.oneofs&&(r.value="sparseTensorType")),null!=e.optionalType&&e.hasOwnProperty("optionalType")&&(r.optionalType=a.onnx.TypeProto.Optional.toObject(e.optionalType,t),t.oneofs&&(r.value="optionalType")),r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto";},e.Tensor=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.elemType=0,e.prototype.shape=null,e.create=function(t){return new e(t);},e.encode=function(e,t){return t||(t=i.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&t.uint32(8).int32(e.elemType),null!=e.shape&&Object.hasOwnProperty.call(e,"shape")&&a.onnx.TensorShapeProto.encode(e.shape,t.uint32(18).fork()).ldelim(),t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto.Tensor();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.elemType=e.int32();break;case 2:i.shape=a.onnx.TensorShapeProto.decode(e,e.uint32());break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")&&!o.isInteger(e.elemType))return"elemType: integer expected";if(null!=e.shape&&e.hasOwnProperty("shape")){var t=a.onnx.TensorShapeProto.verify(e.shape);if(t)return"shape."+t;}return null;},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto.Tensor)return e;var t=new a.onnx.TypeProto.Tensor();if(null!=e.elemType&&(t.elemType=0|e.elemType),null!=e.shape){if("object"!=_typeof2(e.shape))throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");t.shape=a.onnx.TensorShapeProto.fromObject(e.shape);}return t;},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.elemType=0,r.shape=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(r.elemType=e.elemType),null!=e.shape&&e.hasOwnProperty("shape")&&(r.shape=a.onnx.TensorShapeProto.toObject(e.shape,t)),r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Tensor";},e;}(),e.Sequence=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.elemType=null,e.create=function(t){return new e(t);},e.encode=function(e,t){return t||(t=i.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&a.onnx.TypeProto.encode(e.elemType,t.uint32(10).fork()).ldelim(),t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto.Sequence();e.pos<r;){var o=e.uint32();if(o>>>3==1)i.elemType=a.onnx.TypeProto.decode(e,e.uint32());else e.skipType(7&o);}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")){var t=a.onnx.TypeProto.verify(e.elemType);if(t)return"elemType."+t;}return null;},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto.Sequence)return e;var t=new a.onnx.TypeProto.Sequence();if(null!=e.elemType){if("object"!=_typeof2(e.elemType))throw TypeError(".onnx.TypeProto.Sequence.elemType: object expected");t.elemType=a.onnx.TypeProto.fromObject(e.elemType);}return t;},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.elemType=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(r.elemType=a.onnx.TypeProto.toObject(e.elemType,t)),r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Sequence";},e;}(),e.Map=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.keyType=0,e.prototype.valueType=null,e.create=function(t){return new e(t);},e.encode=function(e,t){return t||(t=i.create()),null!=e.keyType&&Object.hasOwnProperty.call(e,"keyType")&&t.uint32(8).int32(e.keyType),null!=e.valueType&&Object.hasOwnProperty.call(e,"valueType")&&a.onnx.TypeProto.encode(e.valueType,t.uint32(18).fork()).ldelim(),t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto.Map();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.keyType=e.int32();break;case 2:i.valueType=a.onnx.TypeProto.decode(e,e.uint32());break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";if(null!=e.keyType&&e.hasOwnProperty("keyType")&&!o.isInteger(e.keyType))return"keyType: integer expected";if(null!=e.valueType&&e.hasOwnProperty("valueType")){var t=a.onnx.TypeProto.verify(e.valueType);if(t)return"valueType."+t;}return null;},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto.Map)return e;var t=new a.onnx.TypeProto.Map();if(null!=e.keyType&&(t.keyType=0|e.keyType),null!=e.valueType){if("object"!=_typeof2(e.valueType))throw TypeError(".onnx.TypeProto.Map.valueType: object expected");t.valueType=a.onnx.TypeProto.fromObject(e.valueType);}return t;},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.keyType=0,r.valueType=null),null!=e.keyType&&e.hasOwnProperty("keyType")&&(r.keyType=e.keyType),null!=e.valueType&&e.hasOwnProperty("valueType")&&(r.valueType=a.onnx.TypeProto.toObject(e.valueType,t)),r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Map";},e;}(),e.Optional=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.elemType=null,e.create=function(t){return new e(t);},e.encode=function(e,t){return t||(t=i.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&a.onnx.TypeProto.encode(e.elemType,t.uint32(10).fork()).ldelim(),t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto.Optional();e.pos<r;){var o=e.uint32();if(o>>>3==1)i.elemType=a.onnx.TypeProto.decode(e,e.uint32());else e.skipType(7&o);}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")){var t=a.onnx.TypeProto.verify(e.elemType);if(t)return"elemType."+t;}return null;},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto.Optional)return e;var t=new a.onnx.TypeProto.Optional();if(null!=e.elemType){if("object"!=_typeof2(e.elemType))throw TypeError(".onnx.TypeProto.Optional.elemType: object expected");t.elemType=a.onnx.TypeProto.fromObject(e.elemType);}return t;},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.elemType=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(r.elemType=a.onnx.TypeProto.toObject(e.elemType,t)),r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Optional";},e;}(),e.SparseTensor=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.elemType=0,e.prototype.shape=null,e.create=function(t){return new e(t);},e.encode=function(e,t){return t||(t=i.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&t.uint32(8).int32(e.elemType),null!=e.shape&&Object.hasOwnProperty.call(e,"shape")&&a.onnx.TensorShapeProto.encode(e.shape,t.uint32(18).fork()).ldelim(),t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.TypeProto.SparseTensor();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.elemType=e.int32();break;case 2:i.shape=a.onnx.TensorShapeProto.decode(e,e.uint32());break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")&&!o.isInteger(e.elemType))return"elemType: integer expected";if(null!=e.shape&&e.hasOwnProperty("shape")){var t=a.onnx.TensorShapeProto.verify(e.shape);if(t)return"shape."+t;}return null;},e.fromObject=function(e){if(e instanceof a.onnx.TypeProto.SparseTensor)return e;var t=new a.onnx.TypeProto.SparseTensor();if(null!=e.elemType&&(t.elemType=0|e.elemType),null!=e.shape){if("object"!=_typeof2(e.shape))throw TypeError(".onnx.TypeProto.SparseTensor.shape: object expected");t.shape=a.onnx.TensorShapeProto.fromObject(e.shape);}return t;},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.elemType=0,r.shape=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(r.elemType=e.elemType),null!=e.shape&&e.hasOwnProperty("shape")&&(r.shape=a.onnx.TensorShapeProto.toObject(e.shape,t)),r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.SparseTensor";},e;}(),e;}(),e.OperatorSetIdProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.domain="",e.prototype.version=o.Long?o.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t);},e.encode=function(e,t){return t||(t=i.create()),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(10).string(e.domain),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(16).int64(e.version),t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.OperatorSetIdProto();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.domain=e.string();break;case 2:i.version=e.int64();break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){return"object"!=_typeof2(e)||null===e?"object expected":null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain)?"domain: string expected":null==e.version||!e.hasOwnProperty("version")||o.isInteger(e.version)||e.version&&o.isInteger(e.version.low)&&o.isInteger(e.version.high)?null:"version: integer|Long expected";},e.fromObject=function(e){if(e instanceof a.onnx.OperatorSetIdProto)return e;var t=new a.onnx.OperatorSetIdProto();return null!=e.domain&&(t.domain=String(e.domain)),null!=e.version&&(o.Long?(t.version=o.Long.fromValue(e.version)).unsigned=!1:"string"==typeof e.version?t.version=parseInt(e.version,10):"number"==typeof e.version?t.version=e.version:"object"==_typeof2(e.version)&&(t.version=new o.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber())),t;},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults)if(r.domain="",o.Long){var n=new o.Long(0,0,!1);r.version=t.longs===String?n.toString():t.longs===Number?n.toNumber():n;}else r.version=t.longs===String?"0":0;return null!=e.domain&&e.hasOwnProperty("domain")&&(r.domain=e.domain),null!=e.version&&e.hasOwnProperty("version")&&("number"==typeof e.version?r.version=t.longs===String?String(e.version):e.version:r.version=t.longs===String?o.Long.prototype.toString.call(e.version):t.longs===Number?new o.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber():e.version),r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.OperatorSetIdProto";},e;}(),e.OperatorStatus=function(){var e={},t=Object.create(e);return t[e[0]="EXPERIMENTAL"]=0,t[e[1]="STABLE"]=1,t;}(),e.FunctionProto=function(){function e(e){if(this.input=[],this.output=[],this.attribute=[],this.attributeProto=[],this.node=[],this.opsetImport=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]]);}return e.prototype.name="",e.prototype.input=o.emptyArray,e.prototype.output=o.emptyArray,e.prototype.attribute=o.emptyArray,e.prototype.attributeProto=o.emptyArray,e.prototype.node=o.emptyArray,e.prototype.docString="",e.prototype.opsetImport=o.emptyArray,e.prototype.domain="",e.create=function(t){return new e(t);},e.encode=function(e,t){if(t||(t=i.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.input&&e.input.length)for(var r=0;r<e.input.length;++r)t.uint32(34).string(e.input[r]);if(null!=e.output&&e.output.length)for(r=0;r<e.output.length;++r)t.uint32(42).string(e.output[r]);if(null!=e.attribute&&e.attribute.length)for(r=0;r<e.attribute.length;++r)t.uint32(50).string(e.attribute[r]);if(null!=e.node&&e.node.length)for(r=0;r<e.node.length;++r)a.onnx.NodeProto.encode(e.node[r],t.uint32(58).fork()).ldelim();if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(66).string(e.docString),null!=e.opsetImport&&e.opsetImport.length)for(r=0;r<e.opsetImport.length;++r)a.onnx.OperatorSetIdProto.encode(e.opsetImport[r],t.uint32(74).fork()).ldelim();if(null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(82).string(e.domain),null!=e.attributeProto&&e.attributeProto.length)for(r=0;r<e.attributeProto.length;++r)a.onnx.AttributeProto.encode(e.attributeProto[r],t.uint32(90).fork()).ldelim();return t;},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim();},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new a.onnx.FunctionProto();e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.name=e.string();break;case 4:i.input&&i.input.length||(i.input=[]),i.input.push(e.string());break;case 5:i.output&&i.output.length||(i.output=[]),i.output.push(e.string());break;case 6:i.attribute&&i.attribute.length||(i.attribute=[]),i.attribute.push(e.string());break;case 11:i.attributeProto&&i.attributeProto.length||(i.attributeProto=[]),i.attributeProto.push(a.onnx.AttributeProto.decode(e,e.uint32()));break;case 7:i.node&&i.node.length||(i.node=[]),i.node.push(a.onnx.NodeProto.decode(e,e.uint32()));break;case 8:i.docString=e.string();break;case 9:i.opsetImport&&i.opsetImport.length||(i.opsetImport=[]),i.opsetImport.push(a.onnx.OperatorSetIdProto.decode(e,e.uint32()));break;case 10:i.domain=e.string();break;default:e.skipType(7&o);}}return i;},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32());},e.verify=function(e){if("object"!=_typeof2(e)||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name))return"name: string expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(var t=0;t<e.input.length;++t)if(!o.isString(e.input[t]))return"input: string[] expected";}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(t=0;t<e.output.length;++t)if(!o.isString(e.output[t]))return"output: string[] expected";}if(null!=e.attribute&&e.hasOwnProperty("attribute")){if(!Array.isArray(e.attribute))return"attribute: array expected";for(t=0;t<e.attribute.length;++t)if(!o.isString(e.attribute[t]))return"attribute: string[] expected";}if(null!=e.attributeProto&&e.hasOwnProperty("attributeProto")){if(!Array.isArray(e.attributeProto))return"attributeProto: array expected";for(t=0;t<e.attributeProto.length;++t){if(r=a.onnx.AttributeProto.verify(e.attributeProto[t]))return"attributeProto."+r;}}if(null!=e.node&&e.hasOwnProperty("node")){if(!Array.isArray(e.node))return"node: array expected";for(t=0;t<e.node.length;++t){if(r=a.onnx.NodeProto.verify(e.node[t]))return"node."+r;}}if(null!=e.docString&&e.hasOwnProperty("docString")&&!o.isString(e.docString))return"docString: string expected";if(null!=e.opsetImport&&e.hasOwnProperty("opsetImport")){if(!Array.isArray(e.opsetImport))return"opsetImport: array expected";for(t=0;t<e.opsetImport.length;++t){var r;if(r=a.onnx.OperatorSetIdProto.verify(e.opsetImport[t]))return"opsetImport."+r;}}return null!=e.domain&&e.hasOwnProperty("domain")&&!o.isString(e.domain)?"domain: string expected":null;},e.fromObject=function(e){if(e instanceof a.onnx.FunctionProto)return e;var t=new a.onnx.FunctionProto();if(null!=e.name&&(t.name=String(e.name)),e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.FunctionProto.input: array expected");t.input=[];for(var r=0;r<e.input.length;++r)t.input[r]=String(e.input[r]);}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.FunctionProto.output: array expected");t.output=[];for(r=0;r<e.output.length;++r)t.output[r]=String(e.output[r]);}if(e.attribute){if(!Array.isArray(e.attribute))throw TypeError(".onnx.FunctionProto.attribute: array expected");t.attribute=[];for(r=0;r<e.attribute.length;++r)t.attribute[r]=String(e.attribute[r]);}if(e.attributeProto){if(!Array.isArray(e.attributeProto))throw TypeError(".onnx.FunctionProto.attributeProto: array expected");t.attributeProto=[];for(r=0;r<e.attributeProto.length;++r){if("object"!=_typeof2(e.attributeProto[r]))throw TypeError(".onnx.FunctionProto.attributeProto: object expected");t.attributeProto[r]=a.onnx.AttributeProto.fromObject(e.attributeProto[r]);}}if(e.node){if(!Array.isArray(e.node))throw TypeError(".onnx.FunctionProto.node: array expected");t.node=[];for(r=0;r<e.node.length;++r){if("object"!=_typeof2(e.node[r]))throw TypeError(".onnx.FunctionProto.node: object expected");t.node[r]=a.onnx.NodeProto.fromObject(e.node[r]);}}if(null!=e.docString&&(t.docString=String(e.docString)),e.opsetImport){if(!Array.isArray(e.opsetImport))throw TypeError(".onnx.FunctionProto.opsetImport: array expected");t.opsetImport=[];for(r=0;r<e.opsetImport.length;++r){if("object"!=_typeof2(e.opsetImport[r]))throw TypeError(".onnx.FunctionProto.opsetImport: object expected");t.opsetImport[r]=a.onnx.OperatorSetIdProto.fromObject(e.opsetImport[r]);}}return null!=e.domain&&(t.domain=String(e.domain)),t;},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.input=[],r.output=[],r.attribute=[],r.node=[],r.opsetImport=[],r.attributeProto=[]),t.defaults&&(r.name="",r.docString="",r.domain=""),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),e.input&&e.input.length){r.input=[];for(var n=0;n<e.input.length;++n)r.input[n]=e.input[n];}if(e.output&&e.output.length){r.output=[];for(n=0;n<e.output.length;++n)r.output[n]=e.output[n];}if(e.attribute&&e.attribute.length){r.attribute=[];for(n=0;n<e.attribute.length;++n)r.attribute[n]=e.attribute[n];}if(e.node&&e.node.length){r.node=[];for(n=0;n<e.node.length;++n)r.node[n]=a.onnx.NodeProto.toObject(e.node[n],t);}if(null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),e.opsetImport&&e.opsetImport.length){r.opsetImport=[];for(n=0;n<e.opsetImport.length;++n)r.opsetImport[n]=a.onnx.OperatorSetIdProto.toObject(e.opsetImport[n],t);}if(null!=e.domain&&e.hasOwnProperty("domain")&&(r.domain=e.domain),e.attributeProto&&e.attributeProto.length){r.attributeProto=[];for(n=0;n<e.attributeProto.length;++n)r.attributeProto[n]=a.onnx.AttributeProto.toObject(e.attributeProto[n],t);}return r;},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions);},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.FunctionProto";},e;}(),e;}(),t.exports=a;});function zr(e,t){if(!e)throw new Error("string"==typeof t?t:t());}function dn(e){return new TextDecoder().decode(e);}var we,xr,xi,Ke,ro,Ve,ot,z,pn,wr,vr,_r,fe=L(function(){Jn(),ai(),we=Nr(Ur()),Or(),xr=/*#__PURE__*/function(){function xr(){_classCallCheck2(this,xr);}return _createClass2(xr,null,[{key:"arraysEqual",value:function arraysEqual(e,t){if(e.length!==t.length)return!1;for(var _r93=0;_r93<e.length;_r93++)if(e[_r93]!==t[_r93])return!1;return!0;}}]);}(),xi=/*#__PURE__*/function(){function xi(){_classCallCheck2(this,xi);}return _createClass2(xi,null,[{key:"preprocessInputShapes",value:function preprocessInputShapes(e,t){return[1===e.length?[1,e[0]]:e,1===t.length?[t[0],1]:t];}},{key:"postprocessOutputShape",value:function postprocessOutputShape(e,t,r){1===t&&e.splice(e.length-2,1),1===r&&e.pop();}},{key:"calcMatMulShape",value:function calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]];}}]);}(),Ke=/*#__PURE__*/function(){function e(){_classCallCheck2(this,e);}return _createClass2(e,null,[{key:"calcShape",value:function calcShape(_e37,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;var n=_e37.length,i=t.length;if(0===n)return t;if(0===i)return _e37;var o=Math.max(_e37.length,t.length),a=new Array(o);if(r){if(n<2||i<2)return;var _r94=xi.calcMatMulShape([_e37[n-2],_e37[n-1]],[t[i-2],t[i-1]]);if(void 0===_r94)return;var _r95=_slicedToArray2(_r94,2);a[o-2]=_r95[0];a[o-1]=_r95[1];}for(var _s6=r?3:1;_s6<=o;_s6++){var _r96=n-_s6<0?1:_e37[n-_s6],_u6=i-_s6<0?1:t[i-_s6];if(_r96!==_u6&&_r96>1&&_u6>1)return;a[o-_s6]=Math.max(_r96,_u6);}return a;}},{key:"index",value:function index(t,r){var n=new Array(r.length);return e.fillIndex(t,r,n),n;}},{key:"fillIndex",value:function fillIndex(_e38,t,r){var n=_e38.length-t.length;for(var _i14=0;_i14<t.length;_i14++)r[_i14]=_e38[n+_i14]%t[_i14];}},{key:"calc",value:function calc(t,r,n,i,o){var a=e.calcShape(t.dims,r.dims);if(a){if(i&&!z.areEqual(a,t.dims))return;var _s7=z.size(a),_u7=i?t:new $e(a,o||t.type);if(0===a.length)_u7.set([],n(t.get([]),r.get([])));else{var _i15,_o10=new Array(a.length),_l5=new Array(t.dims.length),_c4=new Array(r.dims.length),_h4=0,_f4=0,_d4=!1,_p4=!1;0===t.dims.length&&(_h4=t.get([]),_d4=!0),0===r.dims.length&&(_f4=r.get([]),_p4=!0);for(var _y2=0;_y2<_s7;_y2++){_i15=_y2;for(var _e42=a.length-1;_e42>=0;_e42--)_o10[_e42]=_i15%a[_e42],_i15=Math.floor(_i15/a[_e42]);_d4||(e.fillIndex(_o10,t.dims,_l5),_h4=t.get(_l5)),_p4||(e.fillIndex(_o10,r.dims,_c4),_f4=r.get(_c4)),_u7.set(_o10,n(_h4,_f4));}}return _u7;}}},{key:"isValidBroadcast",value:function isValidBroadcast(_e40,t){var r=_e40.length,n=t.length;if(r>n)return!1;for(var _i16=1;_i16<=r;_i16++)if(1!==_e40[r-_i16]&&_e40[r-_i16]!==t[n-_i16])return!1;return!0;}},{key:"getBroadcastDims",value:function getBroadcastDims(_e41,t){var r=_e41.length,n=[];for(var _i17=0;_i17<r;_i17++){var _o11=r-1-_i17,_a7=_e41[_o11]||1;(t[t.length-1-_i17]||1)>1&&1===_a7&&n.unshift(_o11);}return n;}}]);}(),ro=/*#__PURE__*/function(){function ro(){_classCallCheck2(this,ro);}return _createClass2(ro,null,[{key:"getShapeOfGemmResult",value:function getShapeOfGemmResult(e,t,r,n,i){if(2!==e.length||2!==r.length)throw new Error("shape need to be of size 2");var o,a,s;t?(o=e[1],a=e[0]):(o=e[0],a=e[1]);var u=-1;if(n?(s=r[0],u=1):(s=r[1],u=0),r[u]!==a)throw new Error("dimension mismatch");if(o<=0||s<=0||a<=0)throw new Error("invalid shape specified");if(i&&!Ke.isValidBroadcast(i,[o,s]))throw new Error("gemm: invalid bias shape for broadcast");return[o,s,a];}}]);}(),Ve=/*#__PURE__*/function(){function e(){_classCallCheck2(this,e);}return _createClass2(e,null,[{key:"tensorDataTypeFromProto",value:function tensorDataTypeFromProto(_e43){switch(_e43){case we.onnx.TensorProto.DataType.INT8:return"int8";case we.onnx.TensorProto.DataType.UINT8:return"uint8";case we.onnx.TensorProto.DataType.BOOL:return"bool";case we.onnx.TensorProto.DataType.INT16:return"int16";case we.onnx.TensorProto.DataType.UINT16:return"uint16";case we.onnx.TensorProto.DataType.INT32:return"int32";case we.onnx.TensorProto.DataType.UINT32:return"uint32";case we.onnx.TensorProto.DataType.FLOAT:return"float32";case we.onnx.TensorProto.DataType.DOUBLE:return"float64";case we.onnx.TensorProto.DataType.STRING:return"string";case we.onnx.TensorProto.DataType.INT64:return"int32";case we.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error("unsupported data type: ".concat(we.onnx.TensorProto.DataType[_e43]));}}},{key:"tensorDataTypeStringToEnum",value:function tensorDataTypeStringToEnum(_e44){switch(_e44){case"int8":return we.onnx.TensorProto.DataType.INT8;case"uint8":return we.onnx.TensorProto.DataType.UINT8;case"bool":return we.onnx.TensorProto.DataType.BOOL;case"int16":return we.onnx.TensorProto.DataType.INT16;case"uint16":return we.onnx.TensorProto.DataType.UINT16;case"int32":return we.onnx.TensorProto.DataType.INT32;case"uint32":return we.onnx.TensorProto.DataType.UINT32;case"float32":return we.onnx.TensorProto.DataType.FLOAT;case"float64":return we.onnx.TensorProto.DataType.DOUBLE;case"string":return we.onnx.TensorProto.DataType.STRING;case"int64":return we.onnx.TensorProto.DataType.INT64;case"uint64":return we.onnx.TensorProto.DataType.UINT64;default:throw new Error("unsupported data type: ".concat(_e44));}}},{key:"tensorDimsFromProto",value:function tensorDimsFromProto(_e45){return _e45.map(function(_e46){return qt.isLong(_e46)?_e46.toNumber():_e46;});}},{key:"tensorValueTypeFromProto",value:function tensorValueTypeFromProto(t){return{tensorType:e.tensorDataTypeFromProto(t.elemType),shape:{dims:e.tensorDimsFromProto(t.shape.dim.map(function(_e47){return _e47.dimValue;}))}};}},{key:"tensorDimsFromORTFormat",value:function tensorDimsFromORTFormat(_e48){var t=[];for(var _r97=0;_r97<_e48.dimsLength();_r97++)t.push(ot.longToNumber(_e48.dims(_r97)));return t;}},{key:"tensorAttributesFromORTFormat",value:function tensorAttributesFromORTFormat(_e49){var t=[];for(var _r98=0;_r98<_e49.attributesLength();_r98++)t.push(_e49.attributes(_r98));return t;}}]);}(),ot=/*#__PURE__*/function(){function ot(){_classCallCheck2(this,ot);}return _createClass2(ot,null,[{key:"longToNumber",value:function longToNumber(e,t){return qt.isLong(e)?e.toNumber():e instanceof I.Long?qt.fromValue({low:e.low,high:e.high,unsigned:t!==null&&t!==void 0?t:!1}).toNumber():e;}},{key:"isLong",value:function isLong(e){return qt.isLong(e)||e instanceof I.Long;}}]);}(),z=/*#__PURE__*/function(){function e(){_classCallCheck2(this,e);}return _createClass2(e,null,[{key:"size",value:function size(t){return e.getSizeFromDimensionRange(t,0,t.length);}},{key:"sizeFromDimension",value:function sizeFromDimension(t,r){if(r<0||r>t.length)throw new Error("invalid dimension of ".concat(r," for sizeFromDimension as Tensor has ").concat(t.length," dimensions."));return e.getSizeFromDimensionRange(t,r,t.length);}},{key:"sizeToDimension",value:function sizeToDimension(t,r){if(r<0||r>t.length)throw new Error("invalid dimension of ".concat(r," for sizeToDimension as Tensor has ").concat(t.length," dimensions."));return e.getSizeFromDimensionRange(t,0,r);}},{key:"getSizeFromDimensionRange",value:function getSizeFromDimensionRange(_e50,t,r){var n=1;for(var _i18=t;_i18<r;_i18++){if(_e50[_i18]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");n*=_e50[_i18];}return n;}},{key:"computeStrides",value:function computeStrides(_e51){var t=_e51.length;if(0===t)return[];if(1===t)return[1];var r=new Array(t);r[t-1]=1,r[t-2]=_e51[t-1];for(var _n18=t-3;_n18>=0;--_n18)r[_n18]=r[_n18+1]*_e51[_n18+1];return r;}},{key:"transpose",value:function transpose(_e52){return _e52.slice().reverse();}},{key:"indicesToOffset",value:function indicesToOffset(_e53,t,r){void 0===r&&(r=_e53.length);var n=0;for(var _i19=0;_i19<r;++_i19)n+=t[_i19]*_e53[_i19];return n;}},{key:"offsetToIndices",value:function offsetToIndices(_e54,t){var r=t.length;if(0===r)return[];if(1===r)return[_e54*t[0]];var n=new Array(t.length);for(var _r99=0;_r99<n.length-1;++_r99)n[_r99]=Math.floor(_e54/t[_r99]),_e54-=n[_r99]*t[_r99];return n[n.length-1]=_e54,n;}},{key:"normalizeAxis",value:function normalizeAxis(_e55,t){if(_e55<-t&&_e55>=t)throw new Error("unsupported axis for this operation.");return _e55<0?_e55+t:_e55;}},{key:"normalizeAxes",value:function normalizeAxes(_e56,t){var _this2=this;return _e56.map(function(_e57){return _this2.normalizeAxis(_e57,t);});}},{key:"incrementIndex",value:function incrementIndex(_e58,t,r){if(0===t.length||0===_e58.length)throw new Error("Index incrementing unsupported for scalar Tensor");if(void 0===r)r=t.length;else if(r<=0||r>t.length)throw new Error("Incorrect axis to increment on");for(var _n19=r-1;_n19>=0&&(_e58[_n19]++,!(_e58[_n19]<t[_n19]));--_n19)_e58[_n19]=0;}},{key:"calculateReshapedDims",value:function calculateReshapedDims(t,r){if(0===r.length){if(0===t.length||1===e.size(t))return[];throw new Error("cannot reshape to a scalar Tensor");}var n=r.length,i=new Array(n),o=-1,a=1;for(var _e71=0;_e71<n;_e71++){if(r[_e71]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(-1===r[_e71]){if(-1!==o)throw new Error("at most one dimension in shape hints can be -1");o=_e71;}else{if(0===r[_e71]){if(_e71>=t.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");i[_e71]=t[_e71];}else i[_e71]=r[_e71];a*=i[_e71];}}var s=e.size(t);if(-1!==o){if(s%a!=0)throw new Error("the input tensor cannot be reshaped to the requested shape. Input shape: [".concat(t,"] Output shape: [").concat(r,"]"));i[o]=s/a;}else if(a!==s)throw new Error("reshapedDims and originalDims don't have matching sizes");return i;}},{key:"sortBasedOnPerm",value:function sortBasedOnPerm(_e60,t){return t?t.map(function(t){return _e60[t];}):_e60.slice().reverse();}},{key:"padShape",value:function padShape(_e61,t){var r=_e61.length;return _e61.map(function(_e62,n){return _e62+t[n]+t[n+r];});}},{key:"areEqual",value:function areEqual(_e63,t){return _e63.length===t.length&&_e63.every(function(_e64,r){return _e64===t[r];});}},{key:"validateDimsAndCalcSize",value:function validateDimsAndCalcSize(_e65){if(_e65.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");var t=1;var _iterator15=_createForOfIteratorHelper2(_e65),_step15;try{for(_iterator15.s();!(_step15=_iterator15.n()).done;){var _r100=_step15.value;if(!Number.isInteger(_r100))throw new TypeError("Invalid shape: ".concat(_r100," is not an integer"));if(_r100<0||_r100>2147483647)throw new TypeError("Invalid shape: length ".concat(_r100," is not allowed"));t*=_r100;}}catch(err){_iterator15.e(err);}finally{_iterator15.f();}return t;}},{key:"flattenShape",value:function flattenShape(_e66,t){t<0&&(t+=_e66.length);var r=_e66.reduce(function(_e67,t){return _e67*t;},1),n=_e66.slice(t).reduce(function(_e68,t){return _e68*t;},1);return[r/n,n];}},{key:"squeezeShape",value:function squeezeShape(t,r){var n=new Array();r=e.normalizeAxes(r,t.length);for(var _e72=0;_e72<t.length;_e72++){var _i20=r.indexOf(_e72)>=0;if(_i20&&1!==t[_e72])throw new Error("squeeze an axis of size different than 1");(0===r.length&&t[_e72]>1||r.length>0&&!_i20)&&n.push(t[_e72]);}return n;}},{key:"unsqueezeShape",value:function unsqueezeShape(t,r){var n=new Array(t.length+r.length);n.fill(0);for(var _t63=0;_t63<r.length;_t63++){var _i21=e.normalizeAxis(r[_t63],n.length);if(_i21>=n.length)throw new Error("'axes' has an out of range axis");if(0!==n[_i21])throw new Error("'axes' has a duplicate axis");n[_i21]=1;}var i=0;for(var _e73=0;_e73<n.length;_e73++)0===n[_e73]&&(n[_e73]=t[i++]);if(i!==t.length)throw new Error("the unsqueezed dimension could not be established");return n;}}]);}(),pn=/*#__PURE__*/function(){function e(){_classCallCheck2(this,e);}return _createClass2(e,null,[{key:"splitShape",value:function splitShape(t,r,n,i){if(0===n.length){if(!i)throw new Error("need to know number of outputs when the 'split' attribute is not specified");e.determineSplit(t[r],i,n);}var o=[],a=[0];for(var _e76=0;_e76<n.length;++_e76){0!==_e76&&a.push(a[_e76-1]+n[_e76-1]);var _i22=t.slice();_i22[r]=n[_e76],o.push(_i22);}return[o,a];}},{key:"determineSplit",value:function determineSplit(_e75,t,r){if(_e75%t!=0)throw new Error("cannot split tensor to equal sized parts");for(var _n20=0;_n20<t;++_n20)r.push(_e75/t);}}]);}(),wr=/*#__PURE__*/function(){function e(){_classCallCheck2(this,e);}return _createClass2(e,null,[{key:"adjustPoolAttributes",value:function adjustPoolAttributes(_e77,t,r,n,i,o){if(!_e77&&r.length!==t.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(_e77)for(var _e85=0;_e85<t.length-2;_e85++)_e85>=r.length?r.push(t[_e85+2]):r[_e85]=t[_e85+2];for(var _e86=0;_e86<r.length;_e86++)if(_e86<n.length){if(n[_e86]<0)throw new Error("strides should be greater than or equal to 1");}else n.push(1);for(var _e87=0;_e87<r.length;_e87++)if(_e87<i.length){if(i[_e87]<0)throw new Error("dilations should be greater than or equal to 1");}else i.push(1);for(var _e88=0;_e88<2*r.length;_e88++)if(_e88<o.length){if(o[_e88]<0)throw new Error("pad should be greater than or equal to 1");}else o.push(0);for(var _e89=0;_e89<r.length;_e89++){if(r[_e89]<=0)throw new Error("kernel shapes need to be greater than 0");if(o[_e89]>=r[_e89]||o[_e89+r.length]>=r[_e89])throw new Error("pads should be smaller than kernel");}}},{key:"adjustPadsBasedOnAutoPad",value:function adjustPadsBasedOnAutoPad(t,r,n,i,o,a){if(a){if(o.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(r.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(var _s8=0;_s8<t.length-2;_s8++)e.adjustPadAndReturnShape(t[_s8+2],r[_s8],n[_s8],i[_s8],o,_s8,_s8+t.length-2,a);}}},{key:"computePoolOutputShape",value:function computePoolOutputShape(t,r,n,i,o,a,s){if(r.length<=0)throw new Error("input shape must be of size greater than 0");var u=[r[0],r[1]];return e.computeShapeHelper(t,r,u,n,i,o,a,s),u;}},{key:"computeConvOutputShape",value:function computeConvOutputShape(t,r,n,i,o,a,s){if(t.length<=0||r.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");var u=[t[0],r[0]];return e.computeShapeHelper(!1,t,u,n,i,o,a,s),u;}},{key:"computeShapeHelper",value:function computeShapeHelper(t,r,n,i,o,a,s,u){if(t)for(var _e90=0;_e90<r.length-2;_e90++)n.push(1);else for(var _t64=0;_t64<r.length-2;_t64++)n.push(e.adjustPadAndReturnShape(r[_t64+2],i[_t64],o[_t64],a[_t64],s,_t64,_t64+r.length-2,u));}},{key:"adjustPadAndReturnShape",value:function adjustPadAndReturnShape(_e84,t,r,n,i,o,a,s){var u=r*(n-1)+1;if(!s||"NOTSET"===s)return Math.floor((_e84+i[o]+i[a]-u)/t+1);switch(s){case"VALID":return i[o]=0,i[a]=0,Math.floor((_e84-u)/t+1);case"SAME_LOWER":case"SAME_UPPER":if(1!==r)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{var _r101=((_e84+t-1)/t-1)*t+n-_e84;return i[o]=Math.floor("SAME_LOWER"===s?(_r101+1)/2:_r101/2),i[a]=_r101-i[o],Math.floor((_e84+_r101-n)/t+1);}default:throw new Error("Unsupported AutoPad type");}}}]);}(),vr=-34028234663852886e22,_r=34028234663852886e22;});function rh(e){switch(e){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error("cannot calculate sizeof() on type ".concat(e));}}function Gu(e){switch(e){case re.onnx.TensorProto.DataType.UINT8:case re.onnx.TensorProto.DataType.INT8:case re.onnx.TensorProto.DataType.BOOL:return 1;case re.onnx.TensorProto.DataType.UINT16:case re.onnx.TensorProto.DataType.INT16:return 2;case re.onnx.TensorProto.DataType.FLOAT:case re.onnx.TensorProto.DataType.INT32:case re.onnx.TensorProto.DataType.UINT32:return 4;case re.onnx.TensorProto.DataType.INT64:case re.onnx.TensorProto.DataType.DOUBLE:case re.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error("cannot calculate sizeof() on type ".concat(re.onnx.TensorProto.DataType[e]));}}function nh(e,t){return new(Wu(t))(e);}function Wu(e){switch(e){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error");}}function vi(e,t){if(t===re.onnx.TensorProto.DataType.INT64||t===wi.TensorDataType.INT64){if(e.greaterThanOrEqual(2147483648)||e.lessThan(-2147483648))throw new TypeError("int64 is not supported");}else{if(t!==re.onnx.TensorProto.DataType.UINT32&&t!==wi.TensorDataType.UINT32&&t!==re.onnx.TensorProto.DataType.UINT64&&t!==wi.TensorDataType.UINT64)throw new TypeError("not a LONG type: ".concat(re.onnx.TensorProto.DataType[t]));if(e.greaterThanOrEqual(4294967296)||e.lessThan(0))throw new TypeError("uint64 is not supported");}return e.toNumber();}function Uu(e,t,r){switch(t){case re.onnx.TensorProto.DataType.BOOL:case re.onnx.TensorProto.DataType.UINT8:return e.getUint8(r);case re.onnx.TensorProto.DataType.INT8:return e.getInt8(r);case re.onnx.TensorProto.DataType.UINT16:return e.getUint16(r,!0);case re.onnx.TensorProto.DataType.INT16:return e.getInt16(r,!0);case re.onnx.TensorProto.DataType.FLOAT:return e.getFloat32(r,!0);case re.onnx.TensorProto.DataType.INT32:return e.getInt32(r,!0);case re.onnx.TensorProto.DataType.UINT32:return e.getUint32(r,!0);case re.onnx.TensorProto.DataType.INT64:return vi(qt.fromBits(e.getUint32(r,!0),e.getUint32(r+4,!0),!1),t);case re.onnx.TensorProto.DataType.DOUBLE:return e.getFloat64(r,!0);case re.onnx.TensorProto.DataType.UINT64:return vi(qt.fromBits(e.getUint32(r,!0),e.getUint32(r+4,!0),!0),t);default:throw new Error("cannot read from DataView for type ".concat(re.onnx.TensorProto.DataType[t]));}}var zu,re,wi,$e,Or=L(function(){zu=Nr(Ls()),ai(),un(),re=Nr(Ur()),fe(),wi=H.experimental.fbs,$e=/*#__PURE__*/function(){function e(_e91,t,r,n,i){var o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:zu.Guid.create();_classCallCheck2(this,e);this.dims=_e91,this.type=t,this.dataProvider=r,this.asyncDataProvider=n,this.cache=i,this.dataId=o,this.size=z.validateDimsAndCalcSize(_e91);var a=this.size,s=void 0===r&&void 0===n&&void 0===i;if(void 0!==i&&i.length!==a)throw new RangeError("Input dims doesn't match data length.");if("string"===t){if(!(void 0===i||Array.isArray(i)&&i.every(function(_e92){return"string"==typeof _e92;})))throw new TypeError("cache should be a string array");s&&(this.cache=new Array(a));}else{if(void 0!==i){var _e93=Wu(t);if(!(i instanceof _e93))throw new TypeError("cache should be type ".concat(_e93.name));}if(s){var _e94=new ArrayBuffer(a*rh(t));this.cache=nh(_e94,t);}}}return _createClass2(e,[{key:"data",get:function get(){if(void 0===this.cache){var _e95=this.dataProvider(this.dataId);if(_e95.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=_e95;}return this.cache;}},{key:"stringData",get:function get(){if("string"!==this.type)throw new TypeError("data type is not string");return this.data;}},{key:"integerData",get:function get(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)");}}},{key:"floatData",get:function get(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)");}}},{key:"numberData",get:function get(){if("string"!==this.type)return this.data;throw new TypeError("type cannot be non-number (string)");}},{key:"get",value:function get(_e96){return this.data[z.indicesToOffset(_e96,this.strides)];}},{key:"set",value:function set(_e97,t){this.data[z.indicesToOffset(_e97,this.strides)]=t;}},{key:"getData",value:function(){var _getData2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee25(){return _regeneratorRuntime2().wrap(function _callee25$(_context25){while(1)switch(_context25.prev=_context25.next){case 0:_context25.t0=void 0===this.cache;if(!_context25.t0){_context25.next=5;break;}_context25.next=4;return this.asyncDataProvider(this.dataId);case 4:this.cache=_context25.sent;case 5:return _context25.abrupt("return",this.cache);case 6:case"end":return _context25.stop();}},_callee25,this);}));function getData(){return _getData2.apply(this,arguments);}return getData;}()},{key:"strides",get:function get(){return this._strides||(this._strides=z.computeStrides(this.dims)),this._strides;}}],[{key:"fromProto",value:function fromProto(t){if(!t)throw new Error("cannot construct Value from an empty tensor");var r=Ve.tensorDataTypeFromProto(t.dataType),n=Ve.tensorDimsFromProto(t.dims),i=new e(n,r);if("string"===r)t.stringData.forEach(function(_e98,t){i.data[t]=dn(_e98);});else if(t.rawData&&"number"==typeof t.rawData.byteLength&&t.rawData.byteLength>0){var _e99=i.data,_r102=new DataView(t.rawData.buffer,t.rawData.byteOffset,t.rawData.byteLength),_n21=Gu(t.dataType),_o12=t.rawData.byteLength/_n21;if(t.rawData.byteLength%_n21!=0)throw new Error("invalid buffer length");if(_e99.length!==_o12)throw new Error("buffer length mismatch");for(var _i23=0;_i23<_o12;_i23++){var _o13=Uu(_r102,t.dataType,_i23*_n21);_e99[_i23]=_o13;}}else{var _e100;switch(t.dataType){case re.onnx.TensorProto.DataType.FLOAT:_e100=t.floatData;break;case re.onnx.TensorProto.DataType.INT32:case re.onnx.TensorProto.DataType.INT16:case re.onnx.TensorProto.DataType.UINT16:case re.onnx.TensorProto.DataType.INT8:case re.onnx.TensorProto.DataType.UINT8:case re.onnx.TensorProto.DataType.BOOL:_e100=t.int32Data;break;case re.onnx.TensorProto.DataType.INT64:_e100=t.int64Data;break;case re.onnx.TensorProto.DataType.DOUBLE:_e100=t.doubleData;break;case re.onnx.TensorProto.DataType.UINT32:case re.onnx.TensorProto.DataType.UINT64:_e100=t.uint64Data;break;default:throw new Error("unspecific error");}if(null==_e100)throw new Error("failed to populate data from a tensorproto value");var _r103=i.data;if(_r103.length!==_e100.length)throw new Error("array length mismatch");for(var _n22=0;_n22<_e100.length;_n22++){var _i24=_e100[_n22];qt.isLong(_i24)?_r103[_n22]=vi(_i24,t.dataType):_r103[_n22]=_i24;}}return i;}},{key:"fromData",value:function fromData(t,r,n){return new e(r,n,void 0,void 0,t);}},{key:"fromOrtTensor",value:function fromOrtTensor(t){if(!t)throw new Error("cannot construct Value from an empty tensor");var r=Ve.tensorDimsFromORTFormat(t),n=Ve.tensorDataTypeFromProto(t.dataType()),i=new e(r,n);if("string"===n)for(var _e103=0;_e103<t.stringDataLength();_e103++)i.data[_e103]=t.stringData(_e103);else if(t.rawDataArray()&&"number"==typeof t.rawDataLength()&&t.rawDataLength()>0){var _e102=i.data,_r104=new DataView(t.rawDataArray().buffer,t.rawDataArray().byteOffset,t.rawDataLength()),_n23=Gu(t.dataType()),_o14=t.rawDataLength()/_n23;if(t.rawDataLength()%_n23!=0)throw new Error("invalid buffer length");if(_e102.length!==_o14)throw new Error("buffer length mismatch");for(var _i25=0;_i25<_o14;_i25++){var _o15=Uu(_r104,t.dataType(),_i25*_n23);_e102[_i25]=_o15;}}return i;}}]);}();});function q(e){return 1===e?oh:ih;}function Vu(e){var t=q(e);return"".concat(t.version,"\n      precision highp float;\n      ").concat(t.attribute," vec3 position;\n      ").concat(t.attribute," vec2 textureCoord;\n\n      ").concat(t.varyingVertex," vec2 TexCoords;\n\n      void main()\n      {\n          gl_Position = vec4(position, 1.0);\n          TexCoords = textureCoord;\n      }");}function Hu(e){var t=q(e);return"".concat(t.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(t.varyingFrag," vec2 TexCoords;\n    ").concat(t.outputDeclaration,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    // Custom vector types to handle higher dimenalities.\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    ");}function ju(e,t){return"\n  void main() {\n    int indices[".concat(t,"];\n    toVec(TexCoords, indices);\n    vec4 result = vec4(process(indices));\n    ").concat(q(e).output," = result;\n  }\n  ");}var oh,ih,ve=L(function(){oh={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},ih={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"};}),ae=L(function(){});function _i(_x30){return _i26.apply(this,arguments);}function _i26(){_i26=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee70(e){var t,r,_args73=arguments;return _regeneratorRuntime2().wrap(function _callee70$(_context73){while(1)switch(_context73.prev=_context73.next){case 0:t=_args73.length>1&&_args73[1]!==undefined?_args73[1]:function(e){return 0;};r=_args73.length>2?_args73[2]:undefined;return _context73.abrupt("return",new Promise(function(n,i){var o=0,_a25=function a(){if(e())return void n();o++;var s=t(o);null!=r&&o>=r?i():setTimeout(_a25,s);};_a25();}));case 3:case"end":return _context73.stop();}},_callee70);}));return _i26.apply(this,arguments);}function no(e){return zr(_typeof2(e)<"u"&&0!==e.length,function(){return"empty string found for sampler name";}),"get"+e.charAt(0).toUpperCase()+e.slice(1);}function qu(e){return zr(_typeof2(e)<"u"&&0!==e.length,function(){return"empty string found for sampler name";}),"get"+e.charAt(0).toUpperCase()+e.slice(1)+"AtOutCoords";}function Wr(e,t){var r=JSON.parse(JSON.stringify(e));return r=t,r;}function Vr(e,t){return t.map(function(t){return e[t];}).join(", ");}function Je(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"));}function Dt(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:6;return["x","y","z","w","u","v"].slice(0,e);}var Bt=L(function(){fe();});function ah(e,t){return Dt(t).map(function(t){return"".concat(e,".").concat(t);});}function Hr(e,t){return 1===t?[e]:ah(e,t);}function kt(){return"\n    float getChannel(vec4 frag, int dim) {\n      int modCoord = imod(dim, 2);\n      return modCoord == 0 ? frag.r : frag.g;\n    }\n\n    float getChannel(vec4 frag, vec2 innerDims) {\n      vec2 modCoord = mod(innerDims, 2.);\n      return modCoord.x == 0. ?\n        (modCoord.y == 0. ? frag.r : frag.g) :\n        (modCoord.y == 0. ? frag.b : frag.a);\n    }\n  ";}var Ir=L(function(){Bt();});function uh(e,t,r){if(0===e)return"false";if(1===e)return"rc > ".concat(t[0]);var n="";for(var _i27=e-2;_i27<e;_i27++)n+="".concat(r[_i27]," >= ").concat(t[_i27-e+2]),_i27<e-1&&(n+="||");return n;}function lh(e,t){var r=e.length;if(0===r)return"getA(), 0, 0, 0";if(1===r)return"getA(rc),\n            rc + 1 >= ".concat(e[0]," ? 0. : getA(rc + 1),\n            0, 0");var n="";if(r>2)for(var _e104=0;_e104<r-2;++_e104)n+="".concat(t[_e104],",");return"getA(".concat(n,"r, c),\n          rEdge ? 0. : getA(").concat(n,"rp1, c),\n          cEdge ? 0. : getA(").concat(n,"r, cp1),\n          rEdge || cEdge ? 0. : getA(").concat(n,"rp1, cp1)");}function fh(e,t,r,n){return 0===e||1===e?"":"\n    int r = ".concat(t[e-2],";\n    int c = ").concat(t[e-1],";\n    int rp1 = ").concat(t[e-2]," + 1;\n    int cp1 = ").concat(t[e-1]," + 1;\n    bool rEdge = rp1 >= ").concat(n,";\n    bool cEdge = cp1 >= ").concat(r,";\n    ");}var Yu,sh,Xu,Ku=L(function(){ve(),ae(),Bt(),Ir(),Yu={name:"pack",inputNames:["A"],inputTypes:[1]},sh=function sh(e,t){var r,n=q(e.session.backend.glContext.version),i=t.dims,o=i.length,a=t.dims.length,s=Je(a),u=Hr("rc",a),l=fh(a,u,i[i.length-2],i[i.length-1]);r=0===o?[1,1]:1===o?[i[0],1]:[i[a-1],i[a-2]];var c=uh(a,r,u),h=lh(i,u),f="\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n\n          if(").concat(c,") {\n            ").concat(n.output," = vec4(0);\n          } else {\n            ").concat(l,"\n\n            ").concat(n.output," = vec4(").concat(h,");\n          }\n        }\n      ");return _objectSpread(_objectSpread({},Yu),{},{hasMain:!0,output:{dims:t.dims,type:t.type,textureType:2},shaderSource:f});},Xu=function Xu(e,t){return _objectSpread(_objectSpread({},Yu),{},{get:function get(){return sh(e,t);}});};});function Oi(e){if(0===e.length)return[1,1,1];var t=1;for(var _r105=0;_r105<e.length-2;++_r105)t*=e[_r105];return[t,e.length>1?e[e.length-2]:1,e[e.length-1]];}function Zu(e,t){var r=!1;return r=0===e.length||0===t.length||(e.length<2||t.length<2?e[e.length-1]===t[t.length-1]:e[e.length-1]===t[t.length-1]&&e[e.length-2]===t[t.length-2]),r;}function dh(e){var t=z.computeStrides(e),r=["b","r","c"],n="index";return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(t.map(function(e,i){return"".concat("int ".concat(r[i]," = ").concat(n," / ").concat(e),"; ",i===t.length-1?"int ".concat(r[i+1]," = ").concat(n," - ").concat(r[i]," * ").concat(e):"index -= ".concat(r[i]," * ").concat(e),";");}).join(""),"\n      return ivec3(b, r, c);\n    }\n  ");}function hh(e){var t=z.computeStrides(e);return"\n  int getFlattenedIndex(ivec3 coords) {\n    // reverse y, z order\n    return coords.x * ".concat(t[0]," + coords.z * ").concat(t[1]," + coords.y;\n  }\n");}var ch,ph,Ju,Qu=L(function(){fe(),ve(),ae(),Ir(),ch=function ch(e){return{name:"Reshape (packed)",inputTypes:[2],inputNames:["A"],cacheHint:"".concat(e)};},ph=function ph(e,t,r,n){var i=t.dims,o=n,a="";for(var _e105=0;_e105<4;_e105++){var _t65="";switch(_e105){case 0:_t65="outputCoords = rc;";break;case 1:_t65="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:_t65="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:_t65="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw new Error();}a+="\n        ".concat(_t65,"\n        ").concat(_e105>0?"if(outputCoords.y < rows && outputCoords.z < cols){":"","\n          int flattenedIndex = getFlattenedIndex(outputCoords);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);\n          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(_e105,"] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);\n\n        ").concat(_e105>0?"}":"","\n      ");}var s=q(e.session.backend.glContext.version),u="\n      ".concat(dh(i),"\n      ").concat(hh(o),"\n      ").concat(kt(),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.0);\n\n        ivec3 outputCoords;\n        int rows = ").concat(o[2],";\n        int cols = ").concat(o[1],";\n\n        ").concat(a,"\n        ").concat(s.output," = result;\n      }\n    ");return _objectSpread(_objectSpread({},r),{},{output:{dims:o,type:t.type,textureType:2},shaderSource:u,hasMain:!0});},Ju=function Ju(e,t,r){var n=ch(r);return _objectSpread(_objectSpread({},n),{},{get:function get(){return ph(e,t,n,r);}});};}),Ii,el=L(function(){ve(),ae(),Ii=function Ii(e,t){var r=t.shape,n=q(e.session.backend.glContext.version),i="\n    const float FLOAT_MAX = 1.70141184e38;\n    const float FLOAT_MIN = 1.17549435e-38;\n\n    bool isNaN(float val) {\n      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;\n    }\n\n    highp vec4 encodeAsUint8(highp float v) {\n      if (isNaN(v)) {\n        return vec4(255, 255, 255, 255);\n      }\n\n      highp float av = abs(v);\n\n      if(av < FLOAT_MIN) {\n        return vec4(0.0, 0.0, 0.0, 0.0);\n      } else if(v > FLOAT_MAX) {\n        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n      } else if(v < -FLOAT_MAX) {\n        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n      }\n\n      highp vec4 c = vec4(0,0,0,0);\n\n      highp float e = floor(log2(av));\n      highp float m = exp2(fract(log2(av))) - 1.0;\n\n      c[2] = floor(128.0 * m);\n      m -= c[2] / 128.0;\n      c[1] = floor(32768.0 * m);\n      m -= c[1] / 32768.0;\n      c[0] = floor(8388608.0 * m);\n\n      highp float ebias = e + 127.0;\n      c[3] = floor(ebias / 2.0);\n      ebias -= c[3] * 2.0;\n      c[2] += floor(ebias) * 128.0;\n\n      c[3] += 128.0 * step(0.0, -v);\n\n      return c / 255.0;\n    }\n\n    void main() {\n      float value = ".concat(n.texture2D,"(X,TexCoords).r;\n      ").concat(n.output," = encodeAsUint8(value);\n    }"),o={name:"Uint8Encode",inputTypes:[0],inputNames:["X"],output:{dims:r,type:t.tensor.type,textureType:3},shaderSource:i,hasMain:!0};return e.executeProgram(o,[t.tensor]);};});function bh(e,t){if(1===e)return"rc";var r="";for(var _n24=0;_n24<e;_n24++)r+=t[_n24],_n24<e-1&&(r+=",");return r;}var tl,mh,rl,nl=L(function(){ve(),ae(),Bt(),Ir(),tl={name:"unpack",inputNames:["A"],inputTypes:[2]},mh=function mh(e,t){var r=t.dims.length,n=Hr("rc",r),i=n.slice(-2),o=Je(r),a=kt(),s=0===t.dims.length?"":bh(r,n),u=r<=1?"rc":"vec2(".concat(i.join(","),")"),l="\n    ".concat(a,"\n    void main() {\n      ").concat(o," rc = getOutputCoords();\n\n       // Sample the texture with the coords to get the rgba channel value.\n       vec4 packedInput = getA(").concat(s,");\n\n       ").concat(q(e.session.backend.glContext.version).output," = vec4(getChannel(packedInput, ").concat(u,"), 0, 0, 0);\n     }\n   ");return _objectSpread(_objectSpread({},tl),{},{hasMain:!0,output:{dims:t.dims,type:t.type,textureType:0},shaderSource:l});},rl=function rl(e,t){return _objectSpread(_objectSpread({},tl),{},{get:function get(){return mh(e,t);}});};}),oo,hn,io,mn=L(function(){dt(),oo=/*#__PURE__*/function(){function oo(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;_classCallCheck2(this,oo);if(1===t)this.internalFormat=e.R32F,this.format=e.RED,this.textureType=e.FLOAT,this.channelSize=t;else{if(4!==t)throw new Error("Invalid number of channels: ".concat(t));this.internalFormat=e.RGBA32F,this.format=e.RGBA,this.textureType=e.FLOAT,this.channelSize=t;}}return _createClass2(oo,[{key:"encode",value:function encode(e,t){var r,n;return e.constructor!==Float32Array&&(pe.warning("Encoder","data was not of type Float32; creating new Float32Array"),n=new Float32Array(e)),t*this.channelSize>e.length?(pe.warning("Encoder","Source data too small. Allocating larger array"),n=e,r=this.allocate(t*this.channelSize),n.forEach(function(e,t){return r[t]=e;})):(n=e,r=n),r;}},{key:"allocate",value:function allocate(e){return new Float32Array(4*e);}},{key:"decode",value:function decode(e,t){return 1===this.channelSize?e.filter(function(e,t){return t%4==0;}).subarray(0,t):e.subarray(0,t);}}]);}(),hn=/*#__PURE__*/function(){function hn(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var r=arguments.length>2?arguments[2]:undefined;_classCallCheck2(this,hn);if(1!==t&&4!==t)throw new Error("Invalid number of channels: ".concat(t));this.internalFormat=e.RGBA,this.format=e.RGBA,this.channelSize=t,this.textureType=r||e.FLOAT;}return _createClass2(hn,[{key:"encode",value:function encode(e,t){var r=e;return 1===this.channelSize&&(pe.verbose("Encoder","Exploding into a larger array"),r=this.allocate(t),e.forEach(function(e,t){return r[4*t]=e;})),r;}},{key:"allocate",value:function allocate(e){return new Float32Array(4*e);}},{key:"decode",value:function decode(e,t){return 1===this.channelSize?e.filter(function(e,t){return t%4==0;}).subarray(0,t):e.subarray(0,t);}}]);}(),io=/*#__PURE__*/function(){function io(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;_classCallCheck2(this,io);if(this.channelSize=4,1===t)this.internalFormat=e.ALPHA,this.format=e.ALPHA,this.textureType=e.UNSIGNED_BYTE,this.channelSize=t;else{if(4!==t)throw new Error("Invalid number of channels: ".concat(t));this.internalFormat=e.RGBA,this.format=e.RGBA,this.textureType=e.UNSIGNED_BYTE,this.channelSize=t;}}return _createClass2(io,[{key:"encode",value:function encode(e,t){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);}},{key:"allocate",value:function allocate(e){return new Uint8Array(e*this.channelSize);}},{key:"decode",value:function decode(e,t){if(e instanceof Uint8Array)return e.subarray(0,t);throw new Error("Invalid array type: ".concat(e.constructor));}}]);}();}),bn,ol,Si,il=L(function(){fe(),ae(),bn=function bn(e,t,r){var n=0===r||1===r?1:4,i=2===r,o=1===r||2===r,a=4===r?t.length-1:void 0,s=4===r?t.map(function(e,r){return r===t.length-1?4*e:e;}):void 0;return Si(e,t,n,s,{isPacked:i,reverseWH:o,breakAxis:a});},ol=function ol(e,t,r){var n=bn(e,t,r);return[n.width,n.height];},Si=function Si(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var n=arguments.length>3?arguments[3]:undefined;var i=arguments.length>4?arguments[4]:undefined;var o=!(!i||!i.isPacked),_e$computeTextureWH=e.computeTextureWH(o&&n||t,i),_e$computeTextureWH2=_slicedToArray2(_e$computeTextureWH,2),a=_e$computeTextureWH2[0],s=_e$computeTextureWH2[1],u=t.length,l=t.slice(0);if(0===u&&(l=[1]),1===r)n=t;else if(o){if(4!==r)throw new Error("a packed texture must be 4-channel");n=t,u>0&&(l[u-1]=Math.ceil(l[u-1]/2)),u>1&&(l[u-2]=Math.ceil(l[u-2]/2));}else if(!n)throw new Error("Unpacked shape is needed when using channels > 1");return{width:a,height:s,channels:r,isPacked:o,shape:l,strides:z.computeStrides(l),unpackedShape:n,reversedWH:i&&i.reverseWH};};}),yh,ao,sl=L(function(){dt(),Or(),fe(),Ku(),Qu(),el(),nl(),mn(),il(),ae(),yh=function yh(e,t){var r=t.map(function(e){return"".concat(e.unpackedShape.join(","),";").concat(e.width,"x").concat(e.height);}).join("_"),n=e.name;return e.cacheHint&&(n+="["+e.cacheHint+"]"),n+=":"+r,n;},ao=/*#__PURE__*/function(){function ao(e){_classCallCheck2(this,ao);this.session=e,this.packedTextureDataCache=new Map(),this.unpackedTextureDataCache=new Map();}return _createClass2(ao,[{key:"calculateTextureWidthAndHeight",value:function calculateTextureWidthAndHeight(e,t){return ol(this.session.layoutStrategy,e,t);}},{key:"executeProgram",value:function executeProgram(e,t){if(t.length<e.inputNames.length)throw new Error("Input size mustn't be less than ".concat(e.inputNames.length,"."));if(e.inputNames.length!==e.inputTypes.length)throw new Error("input names size does not match input types");var r=[];for(var _n25=0;_n25<e.inputNames.length;++_n25)r[_n25]=this.getOrCreateTextureData(t[_n25],e.inputTypes[_n25]);var n=yh(e,r),i=this.session.programManager.getArtifact(n),o=i?i.programInfo:"function"==typeof e.get?e.get():e,a=bn(this.session.layoutStrategy,o.output.dims,o.output.textureType),s=this.createTextureData(a,o.output.type);return i||(i=this.session.programManager.build(o,r,s),this.session.programManager.setArtifact(n,i)),this.runProgram(i,r,s),s;}},{key:"run",value:function run(e,t){return this.executeProgram(e,t).tensor;}},{key:"runProgram",value:function runProgram(e,t,r){for(var _r106=0;_r106<t.length;++_r106)if(!!t[_r106].isPacked!=(2===e.programInfo.inputTypes[_r106]))throw new Error("input[".concat(_r106,"] property packed inconsistent"));if(!!r.isPacked!=(2===e.programInfo.output.textureType))throw new Error("output property packed inconsistent");this.session.programManager.run(e,t,r);}},{key:"getOrCreateTextureData",value:function getOrCreateTextureData(e,t){var r=this.getTextureData(e.dataId,2===t);if(!r&&(r=this.getTextureData(e.dataId,2!==t),r))return 2===t?this.pack(r):this.unpack(r);if(!r){var _n26=bn(this.session.layoutStrategy,e.dims,t);if(4===t){var _r107=e.dims;if(4===_r107.length){var _n27=[_r107[0],Math.ceil(_r107[1]*_r107[2]*_r107[3]/4)],_i28=bn(this.session.layoutStrategy,_n27,t),_o16=e.numberData;if(_r107[1]*_r107[2]*_r107[3]%4!=0){var _t66=_r107[0],_n28=_r107[1]*_r107[2]*_r107[3],_i29=4*Math.ceil(1*_n28/4);_o16=new Float32Array(_t66*_i29);for(var _r108=0;_r108<_t66;++_r108){var _t67=_r108*_n28,_a8=_r108*_i29+_r108%1*_n28;_o16.set(e.numberData.subarray(_t67,_t67+_n28),_a8);}}return this.createTextureData(_i28,e.type,_o16,e,1);}}if(2===t){var _t68=Si(this.session.layoutStrategy,e.dims,1,[],{reverseWH:!0}),_n29=this.createTextureData(_t68,e.type,e.numberData,e,1);r=this.pack(_n29);}else r=this.createTextureData(_n26,e.type,e.numberData,e,1);}return r;}},{key:"createTextureDataFromLayoutBindTensor",value:function createTextureDataFromLayoutBindTensor(e,t,r,n){return this.createTextureData(e,t,r,n,1);}},{key:"createTextureData",value:function createTextureData(e,t,r,n,i){pe.verbose("InferenceHandler","Creating TextureData: layout:[".concat(JSON.stringify(e),"]"));var o=this.session.textureManager.createTextureFromLayout(t,e,r,i);return this.createTextureDataFromTexture(e,t,o,n);}},{key:"reshapeUnpacked",value:function reshapeUnpacked(e,t){var r=this.getOrCreateTextureData(e,0),n={channels:r.channels,height:r.height,width:r.width,shape:0!==t.length?t:[1],strides:z.computeStrides(t),unpackedShape:t};return this.createTextureDataFromTexture(n,e.type,r.texture).tensor;}},{key:"reshapePacked",value:function reshapePacked(e,t){var r=this.getOrCreateTextureData(e,2);if(Zu(e.dims,t)){var _n30={channels:r.channels,height:r.height,width:r.width,shape:0!==t.length?t:[1],strides:z.computeStrides(t),unpackedShape:t,isPacked:!0};return this.createTextureDataFromTexture(_n30,e.type,r.texture).tensor;}var n=Oi(e.dims),i=Oi(t),o=this.reshapePacked(e,n),a=this.run(Ju(this,o,i),[o]);return this.reshapePacked(a,t);}},{key:"cast",value:function cast(e,t){var r=this.getOrCreateTextureData(e,0);return this.createTextureDataFromTexture(r,t,r.texture).tensor;}},{key:"createTextureDataFromTexture",value:function createTextureDataFromTexture(e,t,r,n,i){var _this3=this;var o=_objectSpread(_objectSpread({},e),{},{tensor:n||new $e(e.unpackedShape,t,function(e){return _this3.readTexture(o);},/*#__PURE__*/function(){var _ref6=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee26(e){return _regeneratorRuntime2().wrap(function _callee26$(_context26){while(1)switch(_context26.prev=_context26.next){case 0:return _context26.abrupt("return",_this3.readTextureAsync(o));case 1:case"end":return _context26.stop();}},_callee26);}));return function(_x31){return _ref6.apply(this,arguments);};}(),void 0,i),texture:r});return this.setTextureData(o.tensor.dataId,o,e.isPacked),o;}},{key:"getTextureData",value:function getTextureData(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;return this.session.isInitializer(e)?this.session.getTextureData(e,t):t?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e);}},{key:"setTextureData",value:function setTextureData(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;this.session.isInitializer(e)?this.session.setTextureData(e,t,r):(r?this.packedTextureDataCache:this.unpackedTextureDataCache).set(e,t);}},{key:"isTextureLayoutCached",value:function isTextureLayoutCached(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;return!!this.getTextureData(e.dataId,t);}},{key:"dispose",value:function dispose(){var _this4=this;this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(function(e){return _this4.session.textureManager.releaseTexture(e);}),this.packedTextureDataCache=new Map(),this.unpackedTextureDataCache.forEach(function(e){return _this4.session.textureManager.releaseTexture(e);}),this.unpackedTextureDataCache=new Map();}},{key:"readTexture",value:function readTexture(e){return e.isPacked?this.readTexture(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat(Ii(this,e));}},{key:"readTextureAsync",value:function(){var _readTextureAsync=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee27(e){return _regeneratorRuntime2().wrap(function _callee27$(_context27){while(1)switch(_context27.prev=_context27.next){case 0:return _context27.abrupt("return",e.isPacked?this.readTextureAsync(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat(Ii(this,e)));case 1:case"end":return _context27.stop();}},_callee27,this);}));function readTextureAsync(_x32){return _readTextureAsync.apply(this,arguments);}return readTextureAsync;}()},{key:"pack",value:function pack(e){return this.executeProgram(Xu(this,e.tensor),[e.tensor]);}},{key:"unpack",value:function unpack(e){return this.executeProgram(rl(this,e.tensor),[e.tensor]);}}]);}();}),Ai,te,Me=L(function(){Ai=/*#__PURE__*/function(){function Ai(e){_classCallCheck2(this,Ai);Object.assign(this,e);}return _createClass2(Ai,[{key:"cacheKey",get:function get(){var _this5=this;return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(function(e){return"".concat(_this5[e]);}).join(";")),this.key;}}]);}(),te=function te(e){return new Ai(e);};}),ul,ll,fl,Th,xh,cl=L(function(){Me(),ve(),ae(),ul={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[0,0,0,0,0]},ll=function ll(e,t,r){return xh(t),[e.run(_objectSpread(_objectSpread({},ul),{},{cacheHint:r.cacheKey,get:function get(){return Th(e,t,r);}}),t)];},fl=function fl(e){var t=e.attributes.getFloat("epsilon",1e-5),r=e.attributes.getFloat("momentum",.9),n=e.attributes.getInt("spatial",1);return te({epsilon:t,momentum:r,spatial:n});},Th=function Th(e,t,r){var n=q(e.session.backend.glContext.version),i=t[0].dims.length,_e$calculateTextureWi=e.calculateTextureWidthAndHeight(t[1].dims,0),_e$calculateTextureWi2=_slicedToArray2(_e$calculateTextureWi,2),o=_e$calculateTextureWi2[0],a=_e$calculateTextureWi2[1],s="\n  float process(int[".concat(i,"] indices) {\n    vec2 position = offsetToCoords(indices[1], ").concat(o,", ").concat(a,");\n    float scale = getColorAsFloat(").concat(n.texture2D,"(Scale, position));\n    float mean = getColorAsFloat(").concat(n.texture2D,"(Mean, position));\n    float variance = getColorAsFloat(").concat(n.texture2D,"(Variance, position));\n    float b = getColorAsFloat(").concat(n.texture2D,"(B, position));\n\n    return scale * ( (_A(indices) - mean) / sqrt(variance + float(").concat(r.epsilon,")) ) + b;\n  }");return _objectSpread(_objectSpread({},ul),{},{output:{dims:t[0].dims,type:t[0].type,textureType:0},shaderSource:s});},xh=function xh(e){if(!e||5!==e.length)throw new Error("BatchNormalization requires 5 inputs.");var t=e[0],r=e[1],n=e[2],i=e[3],o=e[4];if(t.dims.length<3||1!==r.dims.length||1!==n.dims.length||1!==i.dims.length||1!==o.dims.length)throw new Error("invalid input shape.");if(r.dims[0]!==t.dims[1]||n.dims[0]!==t.dims[1]||i.dims[0]!==t.dims[1]||o.dims[0]!==t.dims[1])throw new Error("invalid input shape.");if("float32"!==t.type&&"float64"!==t.type||"float32"!==r.type&&"float64"!==r.type||"float32"!==n.type&&"float64"!==n.type||"float32"!==i.type&&"float64"!==i.type||"float32"!==o.type&&"float64"!==o.type)throw new Error("invalid input tensor types.");};}),so,gt,G,gn,uo,Yt=L(function(){so=/*#__PURE__*/_createClass2(function so(e,t,r,n){_classCallCheck2(this,so);this.glContext=e,this.programInfo=t,this.inputTextureLayouts=r,this.outputTextureLayout=n;}),gt=/*#__PURE__*/_createClass2(function gt(e){_classCallCheck2(this,gt);this.context=e;}),G=/*#__PURE__*/_createClass2(function G(e,t){_classCallCheck2(this,G);this.routineBody=e,this.dependencies=t;}),gn=/*#__PURE__*/function(){function gn(e,t,r){_classCallCheck2(this,gn);this.name=e,this.dependencies=r||[],t&&(this.routineBody=t);}return _createClass2(gn,[{key:"addDependency",value:function addDependency(e){e&&this.dependencies.push(e);}}]);}(),uo=/*#__PURE__*/function(){function uo(){_classCallCheck2(this,uo);}return _createClass2(uo,null,[{key:"returnOrderedNodes",value:function returnOrderedNodes(e){if(!e||0===e.length)return[];if(1===e.length)return e;var t=new Set(),r=new Set(),n=new Array();return this.createOrderedNodes(e,t,r,n),n;}},{key:"createOrderedNodes",value:function createOrderedNodes(e,t,r,n){for(var _i30=0;_i30<e.length;++_i30)this.dfsTraverse(e[_i30],t,r,n);}},{key:"dfsTraverse",value:function dfsTraverse(e,t,r,n){if(!e||r.has(e.name))return;if(t.has(e.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");t.add(e.name);var i=e.dependencies;if(i&&i.length>0)for(var _e106=0;_e106<i.length;++_e106)this.dfsTraverse(i[_e106],t,r,n);n.push(e),r.add(e.name),t["delete"](e.name);}}]);}();});function vh(){var e="add_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return a + b;\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return v1 + v2;\n  }\n  "),name:e,type:0};}function _h(){var e="div_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return a / b;\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return v1 / v2;\n  }\n  "),name:e,type:0};}function Oh(){var e="mul_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return a * b;\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return v1 * v2;\n  }\n  "),name:e,type:0};}function Ih(){var e="sub_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return a - b;\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return v1 - v2;\n  }\n  "),name:e,type:0};}function Sh(){var e="equal_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return float(a == b);\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return vec4(equal(v1, v2));\n  }\n  "),name:e,type:0};}function Ah(){var e="greater_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return float(a > b);\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return vec4( v1.r > v2.r ,\n      v1.g > v2.g,\n      v1.b > v2.b,\n      v1.a > v2.a );\n  }\n  "),name:e,type:0};}function Eh(){var e="less_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return float(a < b);\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return vec4( v1.r < v2.r ,\n                v1.g < v2.g,\n                v1.b < v2.b,\n                v1.a < v2.a );\n  }\n  "),name:e,type:0};}function Ph(){var e="and_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return float( bool(a) && bool(b) );\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r && b2.r ,\n                b1.g && b2.g,\n                b1.b && b2.b,\n                b1.a && b2.a );\n  }\n  "),name:e,type:0};}function Dh(){var e="or_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return float( bool(a) || bool(b) );\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r || b2.r ,\n                b1.g || b2.g,\n                b1.b || b2.b,\n                b1.a || b2.a );\n  }\n  "),name:e,type:0};}function Lh(){var e="xor_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return float( bool(a) ^^ bool(b) );\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r ^^ b2.r ,\n                b1.g ^^ b2.g,\n                b1.b ^^ b2.b,\n                b1.a ^^ b2.a );\n  }\n  "),name:e,type:0};}function Fh(){return $h("pow");}function Ch(){var e="prelu_";return{body:"\n  float ".concat(e,"(float a, float b) {\n    return a < 0.0 ? a * b: a;\n  }\n  vec4 ").concat(e,"(vec4 v1, vec4 v2) {\n    return vec4(\n      v1.r < 0.0 ? v1.r * v2.r: v1.r,\n      v1.g < 0.0 ? v1.g * v2.g: v1.g,\n      v1.b < 0.0 ? v1.b * v2.b: v1.b,\n      v1.a < 0.0 ? v1.a * v2.a: v1.a\n      );\n  }\n  "),name:e,type:0};}function $h(e){var t="".concat(e,"_");return{body:"\n  float ".concat(t,"(float a, float b) {\n    return ").concat(e,"(a, b);\n  }\n  vec4 ").concat(t,"(vec4 v1, vec4 v2) {\n    return ").concat(e,"(v1, v2);\n  }\n  "),name:t,type:0};}var yt,Bh,pl,dl,hl,ml,bl,gl,yl,Tl,xl,wl,vl,_l,Ol=L(function(){fe(),Yt(),ve(),ae(),yt=function yt(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:t[0].type;var i=arguments.length>4?arguments[4]:undefined;var o=e.session.pack?2:0;return{name:r.name,inputNames:["A","B"],inputTypes:[o,o],cacheHint:i,get:function get(){return Bh(e,t,r,n);}};},Bh=function Bh(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:t[0].type;var i=e.session.pack?2:0,o=!z.areEqual(t[0].dims,t[1].dims),a=t[0].dims,s=e.session.pack;if(o){var _o17=Ke.calcShape(t[0].dims,t[1].dims,!1);if(!_o17)throw new Error("Can't perform binary op on the given tensors");a=_o17;var _u8=a.length,_l6=0!==t[0].dims.length?t[0].dims.length:1,_c5=0!==t[1].dims.length?t[1].dims.length:1,_h5=0!==t[0].dims.length?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",_f5=0!==t[1].dims.length?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",_d5=q(e.session.backend.glContext.version),_p5=s?"\n      ".concat(r.body,"\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n        vec4 result = ").concat(r.name,"(a, b);\n        ").concat(_d5.output," = result;\n      }"):"\n      ".concat(r.body,"\n      float process(int indices[").concat(_u8,"]) {\n        int aindices[").concat(_l6,"];\n        int bindices[").concat(_c5,"];\n        ").concat(_h5,"\n        ").concat(_f5,"\n        return ").concat(r.name,"(_A(aindices), _B(bindices));\n      }");return{name:r.name,inputNames:["A","B"],inputTypes:[i,i],output:{dims:a,type:n,textureType:i},shaderSource:_p5,hasMain:s};}var u=q(e.session.backend.glContext.version),l="\n    ".concat(r.body,"\n    void main() {\n      vec4 v1 = ").concat(u.texture2D,"(A, TexCoords);\n      vec4 v2 = ").concat(u.texture2D,"(B, TexCoords);\n      vec4 result = ").concat(r.name,"(v1, v2);\n      ").concat(u.output," = result;\n    }\n    ");return{name:r.name,inputNames:["A","B"],inputTypes:[i,i],output:{dims:t[0].dims,type:n,textureType:i},shaderSource:l,hasMain:!0};},pl=function pl(e,t){return[e.run(yt(e,t,vh()),t)];},dl=function dl(e,t){return[e.run(yt(e,t,Ph(),"bool"),t)];},hl=function hl(e,t){return[e.run(yt(e,t,_h()),t)];},ml=function ml(e,t){return[e.run(yt(e,t,Sh(),"bool"),t)];},bl=function bl(e,t){return[e.run(yt(e,t,Ah(),"bool"),t)];},gl=function gl(e,t){return[e.run(yt(e,t,Eh(),"bool"),t)];},yl=function yl(e,t){return[e.run(yt(e,t,Oh()),t)];},Tl=function Tl(e,t){return[e.run(yt(e,t,Dh(),"bool"),t)];},xl=function xl(e,t){return[e.run(yt(e,t,Fh()),t)];},wl=function wl(e,t){return[e.run(yt(e,t,Ch()),t)];},vl=function vl(e,t){return[e.run(yt(e,t,Ih()),t)];},_l=function _l(e,t){return[e.run(yt(e,t,Lh(),"bool"),t)];};}),Il,Sl,Nh,Al=L(function(){fe(),Il=function Il(e,t,r){return Nh(t),[e.cast(t[0],r)];},Sl=function Sl(e){return Ve.tensorDataTypeFromProto(e.attributes.getInt("to"));},Nh=function Nh(e){if(!e||1!==e.length)throw new Error("Cast requires 1 input.");if("string"===e[0].type)throw new Error("Invalid input type.");};}),Rh,Mh,El,lo,Pl=L(function(){ve(),ae(),Bt(),Ir(),Rh=function Rh(e,t){return{name:"Concat (packed)",inputNames:Array.from({length:e},function(e,t){return"X".concat(t);}),inputTypes:Array(e).fill(2),cacheHint:t};},Mh=function Mh(e,t,r,n){var i=r[0].dims.slice();if(n>=i.length||n<-1*i.length)throw new Error("axis specified for concat doesn't match input dimensionality");n<0&&(n=i.length+n);var o=i.slice(0);for(var _e107=1;_e107<r.length;_e107++){var _t69=r[_e107].dims.slice();for(var _e108=0;_e108<i.length;_e108++)if(_e108===n)o[n]+=_t69[_e108];else if(i[_e108]!==_t69[_e108])throw new Error("non concat dimensions must match");}var a=o.length,s=Hr("coords",a),u=Je(a),l=kt(),c=r.map(function(e){return e.dims;}),h=Dt(a),f=new Array(c.length-1);f[0]=c[0][n];for(var _e109=1;_e109<f.length;_e109++)f[_e109]=f[_e109-1]+c[_e109][n];var d=h[n],p=h.slice(-2),y=h.join(),m="if (".concat(d," < ").concat(f[0],") {\n        return getChannel(\n            getX0(").concat(y,"), vec2(").concat(p.join(),"));\n        }");for(var _e110=1;_e110<f.length;_e110++){var _t70=f[_e110-1];m+="\n            if (".concat(d," < ").concat(f[_e110],"  && ").concat(d," >= ").concat(f[_e110-1],") {\n              return getChannel(\n                getX").concat(_e110,"(").concat(lo(h,d,_t70),"),\n                vec2(").concat(lo(p,d,_t70),"));\n            }");}var g=f.length,w=f[f.length-1];m+="\n            return getChannel(\n              getX".concat(g,"(").concat(lo(h,d,w),"),\n              vec2(").concat(lo(p,d,w),"));");var b=q(e.session.backend.glContext.version),v="\n          ".concat(l,"\n          float getValue(").concat(h.map(function(e){return"int "+e;}),") {\n            ").concat(m,"\n          }\n\n          void main() {\n            ").concat(u," coords = getOutputCoords();\n            int lastDim = coords.").concat(h[a-1],";\n            coords.").concat(h[a-1]," = coords.").concat(h[a-2],";\n            coords.").concat(h[a-2]," = lastDim;\n\n            vec4 result = vec4(getValue(").concat(s,"), 0., 0., 0.);\n\n            ").concat(s[a-1]," = ").concat(s[a-1]," + 1;\n            if (").concat(s[a-1]," < ").concat(o[a-1],") {\n              result.g = getValue(").concat(s,");\n            }\n\n            ").concat(s[a-2]," = ").concat(s[a-2]," + 1;\n            if (").concat(s[a-2]," < ").concat(o[a-2],") {\n              result.a = getValue(").concat(s,");\n            }\n\n            ").concat(s[a-1]," = ").concat(s[a-1]," - 1;\n            if (").concat(s[a-2]," < ").concat(o[a-2]," &&\n                ").concat(s[a-1]," < ").concat(o[a-1],") {\n              result.b = getValue(").concat(s,");\n            }\n            ").concat(b.output," = result;\n          }\n        ");return _objectSpread(_objectSpread({},t),{},{output:{dims:o,type:r[0].type,textureType:2},shaderSource:v,hasMain:!0});},El=function El(e,t,r){var n=Rh(t.length,r.cacheKey);return _objectSpread(_objectSpread({},n),{},{get:function get(){return Mh(e,n,t,r.axis);}});},lo=function lo(e,t,r){var n=e.indexOf(t);return e.map(function(e,t){return t===n?"".concat(e," - ").concat(r):e;}).join();};}),Dl,Gh,Uh,zh,Ll,Wh,Vh,Hh,Fl,jh,Cl=L(function(){Me(),ae(),Pl(),Dl=function Dl(e,t,r){return jh(t),e.session.pack&&t[0].dims.length>1?[e.run(El(e,t,r),t)]:[e.run(zh(e,t,r),t)];},Gh=function Gh(e,t){return{name:"Concat",inputNames:Array.from({length:e},function(e,t){return"X".concat(t);}),inputTypes:Array(e).fill(0),cacheHint:t};},Uh=function Uh(e,t,r,n){var i=r[0].dims.slice();if(n>=i.length||n<-1*i.length)throw new Error("axis specified for concat doesn't match input dimensionality");n<0&&(n=i.length+n);var o=i.slice(0);for(var _e111=1;_e111<r.length;_e111++){var _t71=r[_e111].dims.slice();for(var _e112=0;_e112<i.length;_e112++)if(_e112===n)o[n]+=_t71[_e112];else if(i[_e112]!==_t71[_e112])throw new Error("non concat dimensions must match");}var a=o.length,s=new Array(r.length),u=0;for(var _e113=0;_e113<s.length;++_e113)u+=r[_e113].dims[n],s[_e113]=u;var l="";l=r.length<5?Ll(s):Wh(s);var c="\n        ".concat(Vh(r.length,a),"\n        ").concat(Hh(s),"\n        ").concat(l,"\n        float process(int indices[").concat(a,"]) {\n          int textureIndex = getTextureWhereDataResides (indices[").concat(n,"]);\n\n          if(textureIndex != 0) {\n            indices[").concat(n,"] = indices[").concat(n,"] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));\n          }\n\n          return fetchDataFromCorrectTexture(textureIndex, indices);\n        }");return _objectSpread(_objectSpread({},t),{},{output:{dims:o,type:r[0].type,textureType:0},shaderSource:c});},zh=function zh(e,t,r){var n=Gh(t.length,r.cacheKey);return _objectSpread(_objectSpread({},n),{},{get:function get(){return Uh(e,n,t,r.axis);}});},Ll=function Ll(e){return"int getTextureWhereDataResides(int index) {\n      ".concat(e.map(function(e,t){return"if(index<".concat(e,") {return ").concat(t,";}\n");}).join(""),"\n    }");},Wh=function Wh(e){return Ll(e);},Vh=function Vh(e,t){var r=["float fetchDataFromCorrectTexture(int textureIndex, int indices[".concat(t,"]) {")];for(var _t72=0;_t72<e;++_t72)0===_t72?r.push("\tif (textureIndex == ".concat(_t72,") { return _X").concat(_t72,"(indices); }")):_t72===e-1?r.push("\telse { return _X".concat(_t72,"(indices); }")):r.push("\telse if (textureIndex == ".concat(_t72,") { return _X").concat(_t72,"(indices); }"));return r.push("\t}"),r.join("\n");},Hh=function Hh(e){var t=["int getSizeInConcatAxisValueFromIndex(int index) {"];for(var _r109=0;_r109<e.length;++_r109)0===_r109?t.push("\tif (index == ".concat(_r109,") { return ").concat(e[_r109],"; }")):_r109===e.length-1?t.push("\telse { return ".concat(e[_r109],"; }")):t.push("\telse if (index == ".concat(_r109,") { return ").concat(e[_r109],"; }"));return t.push("\t}"),t.join("\n");},Fl=function Fl(e){return te({axis:e.attributes.getInt("axis")});},jh=function jh(e){if(!e||e.length<1)throw new Error("too few inputs");var t=e[0].type,r=e[0].dims.length;if("string"===t)throw new Error("string tensor is not supported yet");var _iterator16=_createForOfIteratorHelper2(e),_step16;try{for(_iterator16.s();!(_step16=_iterator16.n()).done;){var _n31=_step16.value;if(_n31.type!==t)throw new Error("input tensors should be one type");if(_n31.dims.length!==r)throw new Error("input tensors should have the same shape");}}catch(err){_iterator16.e(err);}finally{_iterator16.f();}};});function qh(){return Tt("abs");}function Yh(){return Tt("acos");}function Xh(){return Tt("asin");}function Kh(){return Tt("atan");}function Jh(){return Tt("ceil");}function Zh(){return Tt("cos");}function Qh(e){var t="elu";return{body:"\n  const float alpha = float(".concat(e,");\n\n  float ").concat(t,"_(float a) {\n    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;\n  }\n  vec4 ").concat(t,"_(vec4 v) {\n    return vec4(").concat(t,"_(v.x), ").concat(t,"_(v.y), ").concat(t,"_(v.z), ").concat(t,"_(v.w));\n  }\n  "),name:t,type:0};}function em(){return Tt("exp");}function tm(){return Tt("floor");}function Ei(e,t){var r="clip";return{body:"\n  const float min = float(".concat(e,");\n  const float max = float(").concat(t,");\n\n  float ").concat(r,"_(float a) {\n    return clamp(a, min, max);\n  }\n  vec4 ").concat(r,"_(vec4 v) {\n    return clamp(v, min, max);\n  }\n  "),name:r,type:0};}function rm(){var e="indentity";return{body:"\n  float ".concat(e,"_(float a) {\n    return a;\n  }\n  vec4 ").concat(e,"_(vec4 v) {\n    return v;\n  }\n  "),name:e,type:0};}function nm(e){var t="leakyRelu";return{body:"\n  const float alpha = float(".concat(e,");\n\n  float ").concat(t,"_(float a) {\n    return a < 0.0 ? a * alpha : a;\n  }\n  vec4 ").concat(t,"_(vec4 v) {\n    return vec4(").concat(t,"_(v.x), ").concat(t,"_(v.y), ").concat(t,"_(v.z), ").concat(t,"_(v.w));\n  }\n  "),name:t,type:0};}function om(){return Tt("log");}function im(){var e="neg";return{body:"\n  float ".concat(e,"_(float a) {\n    return -a;\n  }\n  vec4 ").concat(e,"_(vec4 v) {\n    return -v;\n  }\n  "),name:e,type:0};}function am(){var e="not";return{body:"\n  float ".concat(e,"_(float a) {\n    return float( ! bool(a) );\n  }\n  bool ").concat(e,"_(bool a) {\n    return !a;\n  }\n  vec4 ").concat(e,"_(vec4 v) {\n    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));\n  }\n  bvec4 ").concat(e,"_(bvec4 v) {\n    return bvec4(!v.x, !v.y, !v.z, !v.w);\n  }\n  "),name:e,type:0};}function sm(){return Tt("sin");}function Pi(){var e="relu";return{body:"\n  float ".concat(e,"_(float a) {\n    return max( a, 0.0 );\n  }\n  vec4 ").concat(e,"_(vec4 v) {\n    return max( v, 0.0 );\n  }\n  "),name:e,type:0};}function Di(){var e="sigmoid";return{body:"\n  float ".concat(e,"_(float a) {\n    return 1.0 / (1.0 + exp(-a));\n  }\n  vec4 ").concat(e,"_(vec4 v) {\n    return 1.0 / (1.0 + exp(-v));\n  }\n  "),name:e,type:0};}function um(){return Tt("sqrt");}function lm(){return Tt("tan");}function fm(){var e="tanh";return{body:"\n  float ".concat(e,"_(float a) {\n    a = clamp(a, -10., 10.);\n    a = exp(2.*a);\n    return (a - 1.) / (a + 1.);\n  }\n  vec4 ").concat(e,"_(vec4 v) {\n    v = clamp(v, -10., 10.);\n    v = exp(2.*v);\n    return (v - 1.) / (v + 1.);\n  }\n  "),name:e,type:0};}function Tt(e){return{body:"\n  float ".concat(e,"_(float a) {\n    return ").concat(e,"(a);\n  }\n  vec4 ").concat(e,"_(vec4 v) {\n    return ").concat(e,"(v);\n  }\n  "),name:e,type:0};}var cm,Fe,$l,Bl,kl,Nl,Li,Rl,Ml,pm,Gl,Ul,zl,Wl,Vl,Hl,Fi,jl,ql,Yl,Xl,Kl,Jl,Zl,Ql,ef,tf,rf,Ci=L(function(){Me(),fe(),Yt(),ve(),ae(),cm=function cm(e,t,r,n){var i=e.session.pack?2:0,o=q(e.session.backend.glContext.version);return _objectSpread(_objectSpread({},t),{},{output:{dims:r.dims,type:r.type,textureType:i},shaderSource:"\n     ".concat(n.body,"\n     void main() {\n       vec4 v = ").concat(o.texture2D,"(A, TexCoords);\n       v = ").concat(n.name,"_(v);\n       ").concat(o.output," = v;\n     }\n     "),hasMain:!0});},Fe=function Fe(e,t,r,n){var i=e.session.pack?2:0,o={name:r.name,inputTypes:[i],inputNames:["A"],cacheHint:n};return _objectSpread(_objectSpread({},o),{},{get:function get(){return cm(e,o,t,r);}});},$l=function $l(e,t){return[e.run(Fe(e,t[0],qh()),t)];},Bl=function Bl(e,t){return[e.run(Fe(e,t[0],Yh()),t)];},kl=function kl(e,t){return[e.run(Fe(e,t[0],Xh()),t)];},Nl=function Nl(e,t){return[e.run(Fe(e,t[0],Kh()),t)];},Li=function Li(e,t,r){return[e.run(Fe(e,t[0],Ei(r.min,r.max),r.cacheKey),t)];},Rl=function Rl(e){return te({min:e.attributes.getFloat("min",vr),max:e.attributes.getFloat("max",_r)});},Ml=function Ml(e,t){var r=pm(e,t);return Li(e,[t[0]],r);},pm=function pm(e,t){if(t.length>=3&&(!e.session.isInitializer(t[1].dataId)||!e.session.isInitializer(t[2].dataId)))throw new Error("dynamic clip attributes are not allowed");var r=t.length>=3?t[1].numberData[0]:vr,n=t.length>=3?t[2].numberData[0]:_r;return te({min:r,max:n});},Gl=function Gl(e,t){return[e.run(Fe(e,t[0],Jh()),t)];},Ul=function Ul(e,t){return[e.run(Fe(e,t[0],Zh()),t)];},zl=function zl(e,t,r){return[e.run(Fe(e,t[0],Qh(r.alpha),r.cacheKey),t)];},Wl=function Wl(e){return te({alpha:e.attributes.getFloat("alpha",1)});},Vl=function Vl(e,t){return[e.run(Fe(e,t[0],em()),t)];},Hl=function Hl(e,t){return[e.run(Fe(e,t[0],tm()),t)];},Fi=function Fi(e,t){return[e.run(Fe(e,t[0],rm()),t)];},jl=function jl(e,t,r){return[e.run(Fe(e,t[0],nm(r.alpha),r.cacheKey),t)];},ql=function ql(e){return te({alpha:e.attributes.getFloat("alpha",.01)});},Yl=function Yl(e,t){return[e.run(Fe(e,t[0],om()),t)];},Xl=function Xl(e,t){return[e.run(Fe(e,t[0],im()),t)];},Kl=function Kl(e,t){return[e.run(Fe(e,t[0],am()),t)];},Jl=function Jl(e,t){return[e.run(Fe(e,t[0],Pi()),t)];},Zl=function Zl(e,t){return[e.run(Fe(e,t[0],Di()),t)];},Ql=function Ql(e,t){return[e.run(Fe(e,t[0],sm()),t)];},ef=function ef(e,t){return[e.run(Fe(e,t[0],um()),t)];},tf=function tf(e,t){return[e.run(Fe(e,t[0],lm()),t)];},rf=function rf(e,t){return[e.run(Fe(e,t[0],fm()),t)];};});function Nt(e){var t;switch(e.activation){case"Relu":t=Pi();break;case"Sigmoid":t=Di();break;case"Clip":t=Ei(e.clipMin,e.clipMax);break;default:return{activationFunction:"",applyActivation:""};}var r=t.name;return{activationFunction:t.body,applyActivation:"value = ".concat(r,"_(value);")};}var jr,Sr=L(function(){fe(),Ci(),jr=function jr(e){var t=e.getString("activation","");if("Clip"===t){var _e$getFloats=e.getFloats("activation_params",[vr,_r]),_e$getFloats2=_slicedToArray2(_e$getFloats,2),_r110=_e$getFloats2[0],_n32=_e$getFloats2[1];return{activation:t,clipMax:_n32,clipMin:_r110,activationCacheKey:"".concat(t,":").concat(_r110,",").concat(_n32)};}return{activation:t,activationCacheKey:t};};}),hm,mm,nf,of=L(function(){dt(),ve(),ae(),fo(),Sr(),hm=function hm(e,t){return{name:"GroupedConv",inputNames:e?["X","W","Bias"]:["X","W"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t};},mm=function mm(e,t,r,n){var i=t.length>2?"value += getBias(output_channel);":"",o=t[0].dims.slice(),a=t[1].dims.slice(),s=a[0]/n.group;pe.verbose("GroupedConv","autpPad:".concat(n.autoPad,", dilations:").concat(n.dilations,", group:").concat(n.group,", kernelShape:").concat(n.kernelShape,", pads:").concat(n.pads,", strides:").concat(n.strides));var u=qr(o,a,n.dilations,n.pads,n.strides),l=q(e.session.backend.glContext.version),_Nt=Nt(n),c=_Nt.activationFunction,h=_Nt.applyActivation,f="\n  const ivec2 strides = ivec2(".concat(n.strides[0],", ").concat(n.strides[1],");\n  const ivec2 pads = ivec2(").concat(n.pads[0],", ").concat(n.pads[1],");\n  ").concat(c,"\n  void main() {\n    ivec4 coords = getOutputCoords();\n    int batch = coords.x;\n    int output_channel = coords.y;\n    ivec2 xRCCorner = coords.zw * strides - pads;\n    int group_id = output_channel / ").concat(s,";\n\n    float value = 0.0;\n    for (int wInChannel = 0; wInChannel < ").concat(a[1],"; wInChannel++) {\n      int input_channel = group_id * ").concat(a[1]," + wInChannel;\n      for (int wHeight = 0; wHeight < ").concat(a[2],"; wHeight++) {\n        int xHeight = xRCCorner.x + wHeight * ").concat(n.dilations[0],";\n\n        if (xHeight < 0 || xHeight >= ").concat(o[2],") {\n          continue;\n        }\n\n        for (int wWidth = 0; wWidth < ").concat(a[3],"; wWidth++) {\n          int xWidth = xRCCorner.y + wWidth * ").concat(n.dilations[1],";\n          if (xWidth < 0 || xWidth >= ").concat(o[3],") {\n            continue;\n          }\n\n          float xVal = getX(batch, input_channel, xWidth, xHeight);\n          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);\n          value += xVal*wVal;\n        }\n      }\n    }\n    ").concat(i,"\n    ").concat(h,"\n    ").concat(l.output," = vec4(value, .0, .0, .0);\n  }\n");return _objectSpread(_objectSpread({},r),{},{output:{dims:u,type:t[0].type,textureType:0},shaderSource:f,hasMain:!0});},nf=function nf(e,t,r){var n=hm(t.length>2,r.cacheKey);return _objectSpread(_objectSpread({},n),{},{get:function get(){return mm(e,t,n,r);}});};}),bm,gm,af,sf=L(function(){ve(),ae(),Ir(),bm=function bm(e){return{name:"Im2Col (packed)",inputNames:["A"],inputTypes:[2],cacheHint:e};},gm=function gm(e,t,r,n,i,o){var a=r.dims,s=n.dims,u=i.length,l=[s[1]*s[2]*s[3],i[2]*i[3]],c=s[2]*s[3],h=kt(),f=q(e.session.backend.glContext.version),d="";for(var _e114=0;_e114<=1;_e114++)for(var _t73=0;_t73<=1;_t73++)d+="\n            blockIndex = rc.x + ".concat(_t73,";\n            pos = rc.y + ").concat(_e114,";\n\n            if(blockIndex < ").concat(l[1]," && pos < ").concat(l[0],") {\n              offsetY = int(blockIndex / (").concat(i[u-1],")) * ").concat(o.strides[0]," -\n                ").concat(o.pads[0],";\n              d0 = offsetY + ").concat(o.dilations[0]," * (imod(pos, ").concat(c,") / ").concat(s[2],");\n\n              if(d0 < ").concat(a[2]," && d0 >= 0) {\n                offsetX = imod(blockIndex, ").concat(i[u-1],") * ").concat(o.strides[1]," -\n                  ").concat(o.pads[1],";\n                d1 = offsetX + ").concat(o.dilations[1]," * imod(imod(pos, ").concat(c,"), ").concat(s[2],");\n\n                if(d1 < ").concat(a[3]," && d1 >= 0) {\n\n                  ch = int(float(pos)/ ").concat(c,".);\n                    innerDims = vec2(d0, d1);\n                    result[").concat(2*_e114+_t73,"] = getChannel(\n                      getA(0, ch, int(innerDims.x),\n                      int(innerDims.y)), innerDims);\n                }\n              }\n            }\n\n          ");var p="\n      ".concat(h,"\n\n      void main() {\n        ivec2 rc = getOutputCoords();\n          vec4 result = vec4(0.0);\n          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n          vec2 innerDims;\n          ").concat(d,"\n          ").concat(f.output," = result;\n      }\n            ");return _objectSpread(_objectSpread({},t),{},{output:{dims:l,type:r.type,textureType:2},shaderSource:p,hasMain:!0});},af=function af(e,t,r,n,i){var o=bm(i.cacheKey);return _objectSpread(_objectSpread({},o),{},{get:function get(){return gm(e,o,t,r,n,i);}});};});function Tm(e,t,r){var n=t[0].dims,i=t[1].dims,o=Ke.calcShape(n,i,!0);if(!o)throw new Error("Can't use matmul on the given tensors");var a=Je(o.length),s=Dt(),_Nt2=Nt(r),u=_Nt2.activationFunction,l=_Nt2.applyActivation,c=t.length>2,h=c?"value += getBiasForMatmul();":"",f=c?"".concat(Bi(a,s,t[2].dims,o,!1)):"",d=o.length,p=n.length,y=i.length,m="\n    ".concat(u,"\n    ").concat(f,"\n    float process(int indices[").concat(d,"]) {\n        int a[").concat(p,"];\n        int b[").concat(y,"];\n        bcastMatmulIndices_A(indices, a);\n        bcastMatmulIndices_B(indices, b);\n\n        float value;\n        for (int k=0; k<").concat(n[n.length-1],"; ++k) {\n            a[").concat(p-1,"] = k;\n            b[").concat(y-2,"] = k;\n            value += _A(a) * _B(b);\n        }\n        ").concat(h,"\n        ").concat(l,"\n        return value;\n    }");return _objectSpread(_objectSpread({},e),{},{output:{dims:o,type:t[0].type,textureType:0},shaderSource:m});}function $i(e,t){var r=ym(e.length>2,t.activationCacheKey);return _objectSpread(_objectSpread({},r),{},{get:function get(){return Tm(r,e,t);}});}function Bi(e,t,r,n,i){var o="",a=r.length,s=n.length,u=s-a;o=s<2&&a>0?"coords":r.map(function(e,r){return"coords.".concat(t[r+u]);}).join(", ");var l=Ke.getBroadcastDims(r,n).map(function(e){return"coords.".concat(t[e+u]," = 0;");}).join("\n"),c="vec4(outputValue.xx, outputValue.yy)";return 1===z.size(r)&&(c="vec4(outputValue.x)"),i?"\nvec4 getBiasForMatmul() {\n  ".concat(e," coords = getOutputCoords();\n  ").concat(l,"\n  vec4 outputValue = getBias(").concat(o,");\n  return ").concat(c,";\n}"):"\nfloat getBiasForMatmul() {\n  ".concat(e," coords = getOutputCoords();\n  ").concat(l,"\n  return getBias(coords.x);\n}");}var uf,lf,ym,xm,co=L(function(){fe(),ae(),Bt(),Sr(),ki(),uf=function uf(e,t,r){return xm(t),e.session.pack?[e.run(po(e,t,r),t)]:[e.run($i(t,r),t)];},lf=function lf(e){return jr(e.attributes);},ym=function ym(e,t){return{name:"MatMul",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t};},xm=function xm(e){if(!e||2!==e.length)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.");if("float32"!==e[0].type&&"float64"!==e[0].type||"float32"!==e[1].type&&"float64"!==e[1].type)throw new Error("inputs should be float type");if(e[0].type!==e[1].type)throw new Error("inputs types should match");};});function _m(e,t,r,n){var i=[],o=[],a=r[0].dims,s=r[1].dims,u=a.length,l=s.length,c=n.length,h=c-u,f=c-l;i=a.map(function(e,r){return"coords.".concat(t[r+h]);}),i[u-1]="i*2",i.join(", "),o=s.map(function(e,r){return"coords.".concat(t[r+f]);}),o[l-2]="i*2",o.join(", ");var d=Ke.getBroadcastDims(a,n),p=Ke.getBroadcastDims(s,n),y=d.map(function(e){return"coords.".concat(t[e+h]," = 0;");}).join("\n"),m=p.map(function(e){return"coords.".concat(t[e+f]," = 0;");}).join("\n"),g="int lastDim = coords.".concat(t[c-1],";\n  coords.").concat(t[c-1]," = coords.").concat(t[c-2],";\n  coords.").concat(t[c-2]," = lastDim;");return"\nvec4 getAAtOutCoordsMatmul(int i) {\n  ".concat(e," coords = getOutputCoords();\n  ").concat(g,"\n  ").concat(y,"\n  vec4 outputValue = getA(").concat(i,");\n  return outputValue;\n}\n\nvec4 getBAtOutCoordsMatmul(int i) {\n  ").concat(e," coords = getOutputCoords();\n  ").concat(g,"\n  ").concat(m,"\n  vec4 outputValue = getB(").concat(o,");\n  return outputValue;\n}");}function Om(e,t){var r="";for(var _n33=0;_n33<t-2;_n33++)r+="rc.".concat(e[_n33],", ");return r+="rc.".concat(e[t-2],", i*2"),r;}function Im(e,t){var r="";for(var _n34=0;_n34<t-2;_n34++)r+="rc.".concat(e[_n34],", ");return r+="i*2, rc.".concat(e[t-1]),r;}var wm,vm,po,ki=L(function(){fe(),ve(),ae(),Bt(),Sr(),co(),wm=function wm(e,t){return{name:"MatMul (packed)",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[2,2,2]:[2,2],cacheHint:t};},vm=function vm(e,t,r,n){var i=r.length>2,o=i?"value += getBiasForMatmul();":"",a=r[0].dims,s=r[1].dims,u=Ke.calcShape(a,s,!0),l=!z.areEqual(r[0].dims,r[1].dims);if(!u)throw new Error("Can't use matmul on the given tensors");var c=a[a.length-1],h=Math.ceil(c/2),f=a.length,d=s.length,p=q(e.session.backend.glContext.version),y=Je(u.length),m=u.length,g=Dt(),_Nt3=Nt(n),w=_Nt3.activationFunction,b=_Nt3.applyActivation,v=i?"".concat(Bi(y,g,r[2].dims,u,!0)):"",x=l?"".concat(_m(y,g,r,u)):"",_=l?"getAAtOutCoordsMatmul(i)":"getA(".concat(Om(g,f),")"),S=l?"getBAtOutCoordsMatmul(i)":"getB(".concat(Im(g,d),")"),T="\n            ".concat(x,"\n            ").concat(v,"\n            ").concat(w,"\n            void main() {\n              ").concat(l?"":"".concat(y," rc =\n          getOutputCoords(); int lastDim = rc.").concat(g[m-1],"; rc.").concat(g[m-1]," =\n          rc.").concat(g[m-2],"; rc.").concat(g[m-2]," = lastDim;\n      "),"\n\n              vec4 value = vec4(0);\n              for (int i = 0; i < ").concat(h,"; i++) {\n                vec4 a = ").concat(_,";\n                vec4 b = ").concat(S,";\n\n                value += (a.rrbb * b.rgrg);\n                value += (a.ggaa * b.baba);\n              }\n              ").concat(o,"\n              ").concat(b,"\n              ").concat(p.output," = value;\n            }");return _objectSpread(_objectSpread({},t),{},{output:{dims:u,type:r[0].type,textureType:2},shaderSource:T,hasMain:!0});},po=function po(e,t,r){var n=wm(t.length>2,r.activationCacheKey);return _objectSpread(_objectSpread({},n),{},{get:function get(){return vm(e,n,t,r);}});};}),ff,cf=L(function(){fo(),sf(),ki(),ff=function ff(e,t,r){var n=t[0].dims,i=t[1].dims,o=qr(n,i,r.dilations,r.pads,r.strides),a=e.run(af(e,t[0],t[1],o,r),[t[0]]),s=e.reshapePacked(t[1],[i[0],i[1]*i[2]*i[3]]),u=3===t.length?[s,a,t[2]]:[s,a],l=e.run(po(e,u,r),u);return e.reshapePacked(l,o);};}),Sm,Am,pf,Ni,Ri=L(function(){ae(),Sm=function Sm(e){return{name:"Im2Col",inputNames:["X"],inputTypes:[0],cacheHint:e};},Am=function Am(e,t,r,n,i,o){var a=r.dims,s=n.dims,u=i.length,l=Ni(a,s,i,4),c="\n        const int XC = ".concat(a[1],";\n        const int XH = ").concat(a[2],";\n        const int XW = ").concat(a[3],";\n        const int KH = ").concat(o.kernelShape[0],";\n        const int KW = ").concat(o.kernelShape[1],";\n        const int dilationH = ").concat(o.dilations[0],";\n        const int dilationW = ").concat(o.dilations[1],";\n        const int strideH = ").concat(o.strides[0],";\n        const int strideW = ").concat(o.strides[1],";\n        const int padH = ").concat(o.pads[0],";\n        const int padW = ").concat(o.pads[1],";\n        const int KHKW = KH*KW;\n        const int XCKHKW = XC * KHKW;\n        const int outputChannels = 4;\n        vec4 process(int indices[").concat(u,"]) {\n          int b  = indices[0]; // batch size\n          int oh = indices[1] * strideH - padH; //output height\n          int ow = indices[2] * strideW - padW; //output width\n          int p = indices[3] * outputChannels; //patch\n          vec4 value = vec4(0.0);\n          for(int i=0; i < outputChannels; ++i) {\n            if(p < XCKHKW) {\n              int patchC = p / KHKW;\n              int patchH = (p - patchC*KHKW) / KW;\n              int patchW = (p - patchC*KHKW) - patchH * KW;\n              int xh2 = oh + patchH * dilationH;\n              int xw2 = ow + patchW * dilationW;\n              int x[").concat(a.length,"];\n              x[0] = b;\n              x[1] = patchC;\n              x[2] = xh2;\n              x[3] = xw2;\n              if(xh2 >= 0 &&\n                  xh2 < XH &&\n                  xw2 >= 0 &&\n                  xw2 < XW) {\n                value[i] = _X(x);\n              }\n            }\n            ++p;\n          }\n          return value;\n        }\n        ");return _objectSpread(_objectSpread({},t),{},{output:{dims:l,type:r.type,textureType:4},shaderSource:c});},pf=function pf(e,t,r,n,i){var o=Sm(i.cacheKey);return _objectSpread(_objectSpread({},o),{},{get:function get(){return Am(e,o,t,r,n,i);}});},Ni=function Ni(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:4;return[r[0],r[2],r[3],Math.ceil(e[1]*t[2]*t[3]/n)];};}),Em,Pm,df,hf=L(function(){fe(),ve(),ae(),Sr(),Ri(),Em=function Em(e,t){return{name:"ConvDotProduct",inputNames:e?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:e?[0,4,0]:[0,4],cacheKey:t.activationCacheKey};},Pm=function Pm(e,t,r,n,i){var o=r[0].dims,a=r[1].dims,s=[a[0],Math.ceil(o[1]*a[2]*a[3]/4)],u=Ni(o,a,n),_e$calculateTextureWi3=e.calculateTextureWidthAndHeight(s,4),_e$calculateTextureWi4=_slicedToArray2(_e$calculateTextureWi3,2),l=_e$calculateTextureWi4[0],c=_e$calculateTextureWi4[1],h=z.computeStrides(u),_e$calculateTextureWi5=e.calculateTextureWidthAndHeight(u,4),_e$calculateTextureWi6=_slicedToArray2(_e$calculateTextureWi5,2),f=_e$calculateTextureWi6[0],d=_e$calculateTextureWi6[1],p=n.length,y=r.length<3?"0.0":"_B(b)",m=Math.ceil(o[1]*a[2]*a[3]/4),_Nt4=Nt(i),g=_Nt4.activationFunction,w=_Nt4.applyActivation,b=q(e.session.backend.glContext.version),v="\n".concat(g,"\nfloat process(int indices[").concat(p,"]) {\n  int b[1];\n  b[0] = indices[1];\n  int im2col[4];\n  im2col[0] = indices[0];\n  im2col[1] = indices[2];\n  im2col[2] = indices[3];\n  int im2colOffset = im2col[0] * ").concat(h[0]," + im2col[1] * ").concat(h[1]," + im2col[2] * ").concat(h[2],";\n  int kernelOffset = indices[1] * ").concat(s[1],";\n  float value = ").concat(y,";\n  for (int i = 0; i < ").concat(m,"; ++i) {\n    vec2 im2colCoords = offsetToCoords(im2colOffset, ").concat(f,", ").concat(d,");\n    vec2 kernelCoords = offsetToCoords(kernelOffset, ").concat(l,", ").concat(c,");\n    value += dot(").concat(b.texture2D,"(Im2Col, im2colCoords), ").concat(b.texture2D,"(K, kernelCoords));\n    ++im2colOffset;\n    ++kernelOffset;\n  }\n  ").concat(w,"\n  return value;\n}");return _objectSpread(_objectSpread({},t),{},{output:{dims:n,type:r[0].type,textureType:0},shaderSource:v});},df=function df(e,t,r,n){var i=Em(t.length>2,n);return _objectSpread(_objectSpread({},i),{},{get:function get(){return Pm(e,i,t,r,n);}});};}),qr,Mi,Dm,Lm,Fm,Cm,Gi,$m,fo=L(function(){Me(),fe(),of(),cf(),hf(),Sr(),Ri(),co(),qr=function qr(e,t,r,n,i){var _ref7;var o=e[0],a=e.slice(2),s=a.length,u=t[0],l=t.slice(2).map(function(e,t){return e+(e-1)*(r[t]-1);}),c=a.map(function(e,t){return e+n[t]+n[t+s];}).map(function(e,t){return Math.floor((e-l[t]+i[t])/i[t]);});return(_ref7=[o,u]).concat.apply(_ref7,_toConsumableArray2(c));},Mi=function Mi(e,t,r){return $m(t,r),Dm(e,t,r);},Dm=function Dm(e,t,r){var n=Cm(r,t),i=e.session.pack,o=1===n.kernelShape[0]&&1===n.kernelShape[1];return n.group>1?[e.run(nf(e,t,n),t)]:o&&i?[Lm(e,t,n)]:i&&4===t[0].dims.length&&1===t[0].dims[0]&&!o?[ff(e,t,n)]:[Fm(e,t,n)];},Lm=function Lm(e,t,r){var n=t[0].dims,i=t[1].dims,o=qr(n,i,r.dilations,r.pads,r.strides),a=e.reshapeUnpacked(t[0],[n[1],n[2]*n[3]]),s=e.reshapeUnpacked(t[1],[i[0],i[1]]),u=t.length>2?[s,a,t[2]]:[s,a],l=e.run($i(u,r),u);return e.reshapeUnpacked(l,o);},Fm=function Fm(e,t,r){var n=t[0].dims,i=t[1].dims,o=qr(n,i,r.dilations,r.pads,r.strides),a=e.run(pf(e,t[0],t[1],o,r),[t[0]]),s=3===t.length?[a,t[1],t[2]]:[a,t[1]];return e.run(df(e,t,o,r),s);},Cm=function Cm(e,t){var r=e.kernelShape.slice();if(0===e.kernelShape.length)for(var _e115=2;_e115<t[1].dims.length;++_e115)r.push(t[1].dims[_e115]);var n=e.pads.slice();wr.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,n,e.autoPad);var i=Object.assign({},e);return Object.assign(i,{kernelShape:r,pads:n,cacheKey:e.cacheKey}),i;},Gi=function Gi(e){var t=e.attributes,r=jr(t),n=t.getString("auto_pad","NOTSET"),i=t.getInts("dilations",[1,1]),o=t.getInt("group",1),a=t.getInts("kernel_shape",[]),s=t.getInts("pads",[0,0,0,0]),u=t.getInts("strides",[1,1]);return te(_objectSpread({autoPad:n,dilations:i,group:o,kernelShape:a,pads:s,strides:u},r));},$m=function $m(e,t){if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length||4!==e[1].dims.length)throw new Error("currently only support 2-dimensional conv");if(e[0].dims[1]!==e[1].dims[1]*t.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(3===e.length&&(1!==e[2].dims.length||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");var r=e[0].dims.length-2;if(t.dilations.length!==r)throw new Error("dilations should be ".concat(r,"D"));if(t.strides.length!==r)throw new Error("strides should be ".concat(r,"D"));if(t.pads.length!==2*r)throw new Error("pads should be ".concat(2*r,"D"));if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if("float32"!==e[0].type||"float32"!==e[1].type)throw new Error("Conv input(X,W) should be float tensor");if(3===e.length&&"float32"!==e[2].type)throw new Error("Conv input(bias) should be float tensor");};}),Bm,km,Nm,mf,Rm,Mm,Gm,Um,zm,Wm,bf,Vm,gf=L(function(){Me(),ve(),ae(),Sr(),Bm=function Bm(e,t,r,n,i,o){return(e-1)*t+r+(n-1)*i+1-o;},km=function km(e,t,r,n,i){var o=Math.floor(e/2);"SAME_UPPER"===t?(r[n]=o,r[i]=e-o):"SAME_LOWER"===t&&(r[n]=e-o,r[i]=o);},Nm=function Nm(e,t,r,n,i,o,a,s){var u=e.length-2,l=0===s.length;for(var _c6=0;_c6<u;++_c6){var _h6=l?e[_c6+2]*o[_c6]:s[_c6],_f6=Bm(e[_c6+2],o[_c6],i[_c6],t[_c6],r[_c6],_h6);km(_f6,n,i,_c6,_c6+u),l&&s.push(o[_c6]*(e[_c6+2]-1)+a[_c6]+(t[_c6]-1)*r[_c6]+1-i[_c6]-i[_c6+u]);}},mf=function mf(e,t,r){return Vm(t,r),Rm(e,t,r);},Rm=function Rm(e,t,r){var n=Wm(r,t);return[zm(e,t,n)];},Mm=function Mm(e,t){return{name:"ConvTranspose",inputNames:e?["X","W","B"]:["X","W"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t};},Gm=function Gm(e,t,r,n){var i=t.length>2?"getB(output_channel)":"0.0",o=t[0].dims,a=t[1].dims,s=a[1],u=a[0]/n.group,l=[t[0].dims[0],t[1].dims[1]*n.group].concat(_toConsumableArray2(n.outputShape)),c=q(e.session.backend.glContext.version),_Nt5=Nt(n),h=_Nt5.activationFunction,f=_Nt5.applyActivation,d="\n  const ivec2 strides = ivec2(".concat(n.strides[0],", ").concat(n.strides[1],");\n  const ivec2 pads = ivec2(").concat(n.pads[0],", ").concat(n.pads[1],");\n  ").concat(h,"\n  void main() {\n    ivec4 coords = getOutputCoords();\n    int batch = coords.x;\n    int output_channel = coords.y;\n\n    ivec2 loc = coords.zw + pads;\n\n    int group_id = output_channel / ").concat(s,";\n    int wOutChannel = output_channel - group_id * ").concat(s,";\n\n    float value = ").concat(i,";\n    for (int inChannelOffset = 0; inChannelOffset < ").concat(u,"; inChannelOffset++) {\n      int input_channel = group_id * ").concat(u," + inChannelOffset;\n      for (int wWOff = 0; wWOff < ").concat(a[2],"; wWOff++) {\n        for (int wHOff = 0; wHOff < ").concat(a[3],"; wHOff++) {\n          ivec2 wOff = ivec2(wWOff * ").concat(n.dilations[0],", wHOff * ").concat(n.dilations[1],");\n          ivec2 wLoc = loc - wOff;\n          ivec2 wLocIn = wLoc / strides;\n          if (\n            wLocIn * strides == wLoc &&\n            wLocIn.x >= 0 && wLocIn.x < ").concat(o[2]," &&\n            wLocIn.y >= 0 && wLocIn.y < ").concat(o[3],"\n          ) {\n            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);\n            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);\n            value += xVal * wVal;\n          }\n        }\n      }\n    }\n    ").concat(f,"\n    ").concat(c.output," = vec4(value, .0, .0, .0);\n  }\n");return _objectSpread(_objectSpread({},r),{},{output:{dims:l,type:t[0].type,textureType:0},shaderSource:d,hasMain:!0});},Um=function Um(e,t,r){var n=Mm(t.length>2,r.cacheKey);return _objectSpread(_objectSpread({},n),{},{get:function get(){return Gm(e,t,n,r);}});},zm=function zm(e,t,r){return e.run(Um(e,t,r),t);},Wm=function Wm(e,t){var r=e.kernelShape.slice();if(0===e.kernelShape.length)for(var _e116=2;_e116<t[1].dims.length;++_e116)r.push(t[1].dims[_e116]);var n=e.pads.slice(),i=e.outputShape.slice(),o=t[0].dims;Nm(o,r,e.dilations,e.autoPad,n,e.strides,e.outputPadding,i);var a=Object.assign({},e);return Object.assign(a,{kernelShape:r,pads:n,outputShape:i,cacheKey:e.cacheKey}),a;},bf=function bf(e){var t=e.attributes,r=jr(t),n=t.getString("auto_pad","NOTSET"),i=t.getInts("dilations",[1,1]),o=t.getInt("group",1),a=t.getInts("kernel_shape",[]),s=t.getInts("output_padding",[0,0]),u=t.getInts("output_shape",[]),l=t.getInts("pads",[0,0,0,0]),c=t.getInts("strides",[1,1]);return te(_objectSpread({autoPad:n,dilations:i,group:o,kernelShape:a,outputPadding:s,outputShape:u,pads:l,strides:c},r));},Vm=function Vm(e,t){if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length||4!==e[1].dims.length)throw new Error("currently only support 2-dimensional conv");if(e[0].dims[1]!==e[1].dims[0])throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");var r=e[1].dims[1]*t.group;if(3===e.length&&(1!==e[2].dims.length||e[2].dims[0]!==r))throw new Error("invalid bias");var n=e[0].dims.length-2;if(t.dilations.length!==n)throw new Error("dilations should be ".concat(n,"D"));if(t.strides.length!==n)throw new Error("strides should be ".concat(n,"D"));if(t.pads.length!==2*n)throw new Error("pads should be ".concat(2*n,"D"));if(t.outputPadding.length!==n)throw new Error("output_padding should be ".concat(n,"D"));if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(0!==t.outputShape.length&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape");if("float32"!==e[0].type||"float32"!==e[1].type)throw new Error("ConvTranspose input(X,W) should be float tensor");if(3===e.length&&"float32"!==e[2].type)throw new Error("ConvTranspose input(bias) should be float tensor");};}),yf,Ar,Tf,Hm,xf,jm,qm,Ym,ho=L(function(){Me(),fe(),ae(),yf={name:"Transpose",inputNames:["A"],inputTypes:[0]},Ar=function Ar(e,t,r){return Ym(t),[e.run(_objectSpread(_objectSpread({},yf),{},{cacheHint:r.cacheKey,get:function get(){return Hm(e,t[0],r.perm);}}),t)];},Tf=function Tf(e){return te({perm:e.attributes.getInts("perm",[])});},Hm=function Hm(e,t,r){var n=t.dims;r=xf(n,r);var i=jm(n,r),o=n.length,a="\n      ".concat(qm("perm",r,o),"\n      float process(int indices[").concat(o,"]) {\n        int a[").concat(o,"];\n        perm(a, indices);\n        return _A(a);\n      }");return _objectSpread(_objectSpread({},yf),{},{output:{dims:i,type:t.type,textureType:0},shaderSource:a});},xf=function xf(e,t){return t&&t.length!==e.length&&(t=_toConsumableArray2(e.keys()).reverse()),t;},jm=function jm(e,t){return t=xf(e,t),z.sortBasedOnPerm(e,t);},qm=function qm(e,t,r){var n=[];n.push("void ".concat(e,"(out int a[").concat(r,"], int src[").concat(r,"]) {"));for(var _e117=0;_e117<r;++_e117)n.push("\ta[".concat(t[_e117],"]=src[").concat(_e117,"];"));return n.push("\t}"),n.join("\n");},Ym=function Ym(e){if(!e||1!==e.length)throw new Error("Transpose requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("input should be float tensor");};}),wf,vf,Xm,_f=L(function(){ho(),wf=function wf(e,t,r){Xm(t);var n=r.blocksize,i=n*n,o="DCR"===r.mode?[0,3,4,1,5,2]:[0,1,4,2,5,3],a="DCR"===r.mode?[t[0].dims[0],n,n,t[0].dims[1]/i,t[0].dims[2],t[0].dims[3]]:[t[0].dims[0],t[0].dims[1]/i,n,n,t[0].dims[2],t[0].dims[3]],s=e.reshapeUnpacked(t[0],a),u={perm:o,cacheKey:"".concat(o)},_Ar=Ar(e,[s],u),_Ar2=_slicedToArray2(_Ar,1),l=_Ar2[0],c=[t[0].dims[0],t[0].dims[1]/i,t[0].dims[2]*n,t[0].dims[3]*n];return[e.reshapeUnpacked(l,c)];},vf=function vf(e){var t=e.attributes.getInt("blocksize");if(t<1)throw new Error("blocksize must be >= 1, but got : ".concat(t," for DepthToSpace"));var r=e.attributes.getString("mode","DCR");if("DCR"!==r&&"CRD"!==r)throw new Error("unrecognized mode: ".concat(r," for DepthToSpace"));return{mode:r,blocksize:t};},Xm=function Xm(e){if(1!==e.length)throw new Error("DepthToSpace expect 1 inputs, but got ".concat(e.length));if("string"===e[0].type||4!==e[0].dims.length)throw new TypeError("DepthToSpace input should be a 4-D numeric tensor");};}),Of,If,Km,Sf=L(function(){fe(),Of=function Of(e,t,r){Km(t,r);var n=z.flattenShape(t[0].dims,r);return[e.reshapeUnpacked(t[0],n)];},If=function If(e){return e.attributes.getInt("axis",1);},Km=function Km(e,t){if(!e||1!==e.length)throw new Error("Flatten requires 1 input.");var r=e[0].dims.length;if(0===r)throw new Error("scalar tensor is not supported.");if(t<-r||t>r)throw new Error("Invalid axis");if("string"===e[0].type)throw new Error("string tensor is not supported.");};}),nr,yn=L(function(){nr=["float32","float64","int32","int16","int8","uint16","uint32","uint8"];}),Af,Ef,Jm,Zm,Qm,eb,Pf=L(function(){Me(),yn(),fe(),ae(),Af=function Af(e,t,r){return eb(t,r.axis),[e.run(Qm(e,t,r),t)];},Ef=function Ef(e){return te({axis:e.attributes.getInt("axis",0)});},Jm={name:"Gather",inputNames:["A","B"],inputTypes:[0,0]},Zm=function Zm(e,t,r,n){var i=r[0].dims.slice(),o=r[1].dims.slice(),a=new Array(i.length+o.length-1);n=z.normalizeAxis(n,i.length);var s=[];for(var _e118=0;_e118<a.length;_e118++)_e118<n?(a[_e118]=i[_e118],s.push("inputIdx[".concat(_e118,"] = outputIdx[").concat(_e118,"];"))):_e118<n+o.length?(a[_e118]=o[_e118-n],s.push("indexDataIdx[".concat(_e118-n,"] = outputIdx[").concat(_e118,"];"))):(a[_e118]=i[_e118-o.length+1],s.push("inputIdx[".concat(_e118-o.length+1,"] = outputIdx[").concat(_e118,"];")));var u="\n      float process(int outputIdx[".concat(a.length||1,"]) {\n        int inputIdx[").concat(i.length,"];\n        int indexDataIdx[").concat(o.length||1,"];\n        indexDataIdx[0] = 0;\n        ").concat(s.join("\n        "),"\n        int idx = int(_B(indexDataIdx));\n        inputIdx[").concat(n,"] = idx < 0 ? idx + ").concat(i[n]," : idx;\n        return _A(inputIdx);\n      }");return _objectSpread(_objectSpread({},t),{},{output:{dims:a,type:r[0].type,textureType:0},shaderSource:u});},Qm=function Qm(e,t,r){var n=_objectSpread(_objectSpread({},Jm),{},{cacheHint:r.cacheKey});return _objectSpread(_objectSpread({},n),{},{get:function get(){return Zm(e,n,t,r.axis);}});},eb=function eb(e,t){if(!e||2!==e.length)throw new Error("Gather requires 2 inputs.");var r=e[0].dims.length;if(r<1)throw new Error("Invalid input shape.");if(t<-r||t>r-1)throw new Error("Invalid axis.");if(-1===nr.indexOf(e[0].type))throw new Error("Invaid input type.");if("int32"!==e[1].type&&"int16"!==e[1].type)throw new Error("Invaid input type.");};}),Ui,Df,Lf,Ff,tb,rb,nb,Cf=L(function(){Me(),fe(),ae(),Ui=function Ui(e,t,r){return nb(t,r),[e.run(tb(t,r),t)];},Df=function Df(e,t){var r=0!==e.attributes.getInt("transA",0),n=0!==e.attributes.getInt("transB",0),i=e.attributes.getFloat("alpha",1),o=e.attributes.getFloat("beta",1);return te({transA:r,transB:n,alpha:i,beta:o,isOptionalC:t});},Lf=function Lf(e){return Df(e,!1);},Ff=function Ff(e){return Df(e,!0);},tb=function tb(e,t){var r={name:"Gemm",inputNames:3===e.length?["A","B","C"]:["A","B"],inputTypes:3===e.length?[0,0,0]:[0,0],key:t.cacheKey};return _objectSpread(_objectSpread({},r),{},{get:function get(){return rb(r,e,t);}});},rb=function rb(e,t,r){var n=t[0].dims.slice(),i=t[1].dims.slice(),_ro$getShapeOfGemmRes=ro.getShapeOfGemmResult(n,r.transA,i,r.transB,3===t.length?t[2].dims:void 0),_ro$getShapeOfGemmRes2=_slicedToArray2(_ro$getShapeOfGemmRes,2),o=_ro$getShapeOfGemmRes2[0],a=_ro$getShapeOfGemmRes2[1],s=[o,a];if(!s)throw new Error("Can't use gemm on the given tensors");var u=n[n.length-1],l="";r.transA&&(u=n[0]),r.transA&&r.transB?l="value += _A_T(a) * _B_T(b);":r.transA&&!r.transB?l="value += _A_T(a) * _B(b);":!r.transA&&r.transB?l="value += _A(a) * _B_T(b);":!r.transA&&!r.transB&&(l="value += _A(a) * _B(b);");var c=s.length,h="\n      float process(int indices[".concat(c,"]) {\n          int a[").concat(c,"];\n          int b[").concat(c,"];\n          ").concat(3===t.length?"int c[".concat(t[2].dims.length,"];"):"","\n\n          copyVec(indices, a);\n          copyVec(indices, b);\n          ").concat(3===t.length?"bcastIndices_C(indices, c);":"","\n\n          float value = 0.0;\n          for (int k=0; k<").concat(u,"; ++k) {\n              a[").concat(c-1,"] = k;\n              b[").concat(c-2,"] = k;\n              ").concat(l,"\n          }\n\n          value = value * alpha;\n          ").concat(3===t.length?"value += beta * _C(c);":"","\n          return value;\n      }");return _objectSpread(_objectSpread({},e),{},{output:{dims:s,type:t[0].type,textureType:0},variables:[{name:"alpha",type:"float",data:r.alpha},{name:"beta",type:"float",data:r.beta}],shaderSource:h});},nb=function nb(e,t){if(!e)throw new Error("Input is missing");if(t.isOptionalC&&(e.length<2||e.length>3))throw new Error("Invaid input shape.");if(!t.isOptionalC&&3!==e.length)throw new Error("Gemm requires 3 inputs");if(3===e.length&&1!==e[2].dims.length&&2!==e[2].dims.length)throw new Error("Invalid input shape of C");if("float32"!==e[0].type&&"float64"!==e[0].type||"float32"!==e[1].type&&"float64"!==e[1].type||3===e.length&&"float32"!==e[2].type&&"float64"!==e[2].type)throw new Error("Invalid input type.");if(e[0].type!==e[1].type||3===e.length&&e[0].type!==e[2].type)throw new Error("Input types are mismatched");};}),$f,Bf,ob,ib,ab,sb,ub,kf=L(function(){Me(),ae(),$f=function $f(e,t,r){return ub(t),[e.run(ab(e,t,r),t)];},Bf=function Bf(e){var t=e.attributes.getFloat("scale"),r=e.attributes.getFloats("bias");return te({scale:t,bias:r});},ob={name:"ImageScaler",inputNames:["X"],inputTypes:[0]},ib=function ib(e,t,r,n){var i=r[0].dims.slice(),o=i.length,a="\n      ".concat(sb(n.bias.length),"\n      float process(int indices[").concat(o,"]) {\n        return _X(indices) * scale + getBias(bias, indices[1]);\n      }");return _objectSpread(_objectSpread({},t),{},{output:{dims:i,type:r[0].type,textureType:0},variables:[{name:"bias",type:"float",arrayLength:n.bias.length,data:n.bias},{name:"scale",type:"float",data:n.scale}],shaderSource:a});},ab=function ab(e,t,r){var n=_objectSpread(_objectSpread({},ob),{},{cacheHint:r.cacheKey});return _objectSpread(_objectSpread({},n),{},{get:function get(){return ib(e,n,t,r);}});},sb=function sb(e){var t=["float getBias(float bias[".concat(e,"], int channel) {")];for(var _r111=0;_r111<e;++_r111)0===_r111?t.push("\tif (channel == ".concat(_r111,") { return bias[").concat(_r111,"]; }")):_r111===e-1?t.push("\telse { return bias[".concat(_r111,"]; }")):t.push("\telse if (channel == ".concat(_r111,") { return bias[").concat(_r111,"]; }"));return t.push("\t}"),t.join("\n");},ub=function ub(e){if(!e||1!==e.length)throw new Error("ImageScaler requires 1 input.");if(4!==e[0].dims.length)throw new Error("Invalid input shape.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.");};}),Rf,Mf,Nf,lb,fb,cb,pb,db,hb,Gf=L(function(){ve(),ae(),Rf=function Rf(e,t,r){hb(t);var n=e.run(fb(t[0]),t);return[e.run(db(e,t[0],r,n.dims),[t[0],n,t[1],t[2]])];},Mf=function Mf(e){return e.attributes.getFloat("epsilon",1e-5);},Nf={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[0]},lb=function lb(e,t){var r=t.dims.slice(),n=r[1],i=r[2]*r[3],o=[r[0],n],a="\n      vec4 process(int[2] indices) {\n        vec4 v = vec4(0.0);\n        int a[4];\n        a[0] = indices[0];\n        a[1] = indices[1];\n        float temp = 0.0;\n        for(int a2=0; a2<".concat(r[2],"; a2++) {\n          a[2] = a2;\n          for(int a3=0; a3<").concat(r[3],"; a3++) {\n            a[3] = a3;\n            float x = _X(a);\n            temp += x;\n          }\n        }\n        float mean = temp / float(").concat(i,");\n        temp = 0.0;\n        for(int a2=0; a2<").concat(r[2],"; a2++) {\n          a[2] = a2;\n          for(int a3=0; a3<").concat(r[3],"; a3++) {\n            a[3] = a3;\n            float x = _X(a);\n            temp += (x - mean) * (x - mean);\n          }\n        }\n        v.r = mean;\n        v.g = temp / float(").concat(i,");\n\n        return v;\n      }");return _objectSpread(_objectSpread({},e),{},{output:{dims:o,type:t.type,textureType:4},shaderSource:a});},fb=function fb(e){return _objectSpread(_objectSpread({},Nf),{},{get:function get(){return lb(Nf,e);}});},cb={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[0,4,0,0]},pb=function pb(e,t,r,n,i){var o=q(e.session.backend.glContext.version),_e$calculateTextureWi7=e.calculateTextureWidthAndHeight(i,4),_e$calculateTextureWi8=_slicedToArray2(_e$calculateTextureWi7,2),a=_e$calculateTextureWi8[0],s=_e$calculateTextureWi8[1],u=a/4,l=s,c="\n      vec4 get_MeanAndVariance(int[2] mv) {\n        int offset = indicesToOffset_MeanAndVariance(mv);\n        vec2 coords = offsetToCoords(offset, ".concat(u,", ").concat(l,");\n        return ").concat(o.texture2D,"(MeanAndVariance, coords);\n      }\n\n      float process(int[4] indices) {\n        int mv[2];\n        mv[0] = indices[0];\n        mv[1] = indices[1];\n        vec4 mean_and_variance = get_MeanAndVariance(mv);\n        float mean = mean_and_variance.r;\n        float variance = mean_and_variance.g;\n\n        int sb[1];\n        sb[0] = indices[1];\n        float scale = _Scale(sb);\n        float b = _B(sb);\n\n        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;\n      }");return _objectSpread(_objectSpread({},t),{},{output:{dims:r.dims,type:r.type,textureType:0},variables:[{name:"epsilon",type:"float",data:n}],shaderSource:c});},db=function db(e,t,r,n){var i=_objectSpread(_objectSpread({},cb),{},{cacheHint:"".concat(r)});return _objectSpread(_objectSpread({},i),{},{get:function get(){return pb(e,i,t,r,n);}});},hb=function hb(e){if(!e||3!==e.length)throw new Error("InstanceNormalization requires 3 inputs.");var t=e[0],r=e[1],n=e[2];if(t.dims.length<3||1!==r.dims.length||1!==n.dims.length)throw new Error("Invalid input shape.");if(r.dims[0]!==t.dims[1]||n.dims[0]!==t.dims[1])throw new Error("Input shapes are mismatched.");if("float32"!==t.type&&"float64"!==t.type||"float32"!==r.type&&"float64"!==r.type||"float32"!==n.type&&"float64"!==n.type)throw new Error("Invalid input type.");if(4!==e[0].dims.length)throw new Error("Only support 4-D input shape.");};});function mb(e,t){var r=e[0].dims[1],n=e[0].dims.length,i=-Math.floor((t.size-1)/2),o=Math.ceil((t.size-1)/2),a="float(".concat(t.alpha,") / float(").concat(t.size,")"),s="\n    float process(int indices[".concat(n,"]) {\n        int c = indices[1];\n        float x = _X(indices);\n        float square_sum = 0.0;\n\n        for (int i = ").concat(i,"; i <= ").concat(o,"; i++) {\n          int idx = c + i;\n          if (c >= 0 && c < ").concat(r,") {\n            indices[1] = idx;\n            float j = _X(indices);\n            square_sum += j * j;\n          }\n        }\n        return x / pow(","float(".concat(t.bias,")")," + ").concat(a," * square_sum, ","float(".concat(t.beta,")"),");\n    }");return _objectSpread(_objectSpread({},Wf),{},{cacheHint:t.cacheKey,output:{dims:e[0].dims,type:e[0].type,textureType:0},shaderSource:s});}function bb(e,t){return _objectSpread(_objectSpread({},Wf),{},{cacheHint:t.cacheKey,get:function get(){return mb(e,t);}});}var Uf,zf,Wf,gb,Vf=L(function(){Me(),ae(),Uf=function Uf(e,t,r){return gb(t),[e.run(bb(t,r),t)];},zf=function zf(e){var t=e.attributes.getFloat("alpha",1e-4),r=e.attributes.getFloat("beta",.75),n=e.attributes.getFloat("bias",1),i=e.attributes.getInt("size");return te({alpha:t,beta:r,bias:n,size:i});},Wf={name:"LRN",inputNames:["X"],inputTypes:[0]},gb=function gb(e){if(!e||1!==e.length)throw new Error("LRN requires 1 input.");if(4!==e[0].dims.length)throw new Error('currently only support LRN for input with "NCHW" format');if("float32"!==e[0].type)throw new Error("input should be float type");};}),yb,zi,Hf,jf,qf,Tb,xb,wb,vb,_b,Ob,Ib,Sb,Yf=L(function(){Me(),fe(),ve(),ae(),yb={name:"Pad",inputNames:["A"],inputTypes:[0]},zi=function zi(e,t,r){return wb(t),[e.run(_objectSpread(_objectSpread({},yb),{},{cacheHint:r.cacheKey,get:function get(){return xb(e,t[0],r);}}),t)];},Hf=function Hf(e){var t=e.attributes.getString("mode","constant"),r=e.attributes.getFloat("value",0),n=e.attributes.getInts("pads");return te({mode:t,value:r,pads:n});},jf=function jf(e,t,r){vb(t);var n=Tb(e,t,r);return zi(e,[t[0]],n);},qf=function qf(e){return e.attributes.getString("mode","constant");},Tb=function Tb(e,t,r){if(!e.session.isInitializer(t[1].dataId)||t.length>=3&&!e.session.isInitializer(t[2].dataId))throw new Error("dynamic pad attributes are not allowed");var n=Array.from(t[1].integerData),i=t.length>=3?t[2].floatData[0]:0;return te({mode:r,pads:n,value:i});},xb=function xb(e,t,r){var n=z.padShape(t.dims.slice(),r.pads),i=n.length,o="\n      ".concat(_b(e,t,r),"\n      float process(int[").concat(i,"] indices) {\n          return padA(indices);\n      }");return{name:"Pad",inputNames:["A"],inputTypes:[0],output:{dims:n,type:t.type,textureType:0},shaderSource:o};},wb=function wb(e){if(!e||1!==e.length)throw new Error("Pad requires 1 input");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.");},vb=function vb(e){if(!e||2!==e.length&&3!==e.length)throw new Error("Pad requires 2 or 3 inputs");if("int32"!==e[1].type)throw new Error("Invalid input type.");if(e.length>=3&&"string"===e[2].type)throw new Error("Invalid input type.");},_b=function _b(e,t,r){var n=q(e.session.backend.glContext.version),_e$calculateTextureWi9=e.calculateTextureWidthAndHeight(t.dims,0),_e$calculateTextureWi10=_slicedToArray2(_e$calculateTextureWi9,2),i=_e$calculateTextureWi10[0],o=_e$calculateTextureWi10[1],a=z.computeStrides(t.dims);switch(r.mode){case"constant":return Ob(n,t.dims,a,i,o,r.pads,r.value);case"reflect":return Ib(n,t.dims,a,i,o,r.pads);case"edge":return Sb(n,t.dims,a,i,o,r.pads);default:throw new Error("Invalid mode");}},Ob=function Ob(e,t,r,n,i,o,a){var s=t.length,u="";for(var _e119=s-1;_e119>=0;--_e119)u+="\n        k = m[".concat(_e119,"] - ").concat(o[_e119],";\n        if (k < 0)  return constant;\n        if (k >= ").concat(t[_e119],") return constant;\n        offset += k * ").concat(r[_e119],";\n        ");return"\n      float padA(int m[".concat(s,"]) {\n        const float constant = float(").concat(a,");\n        int offset = 0;\n        int k = 0;\n        ").concat(u,"\n        vec2 coords = offsetToCoords(offset, ").concat(n,", ").concat(i,");\n        float value = getColorAsFloat(").concat(e.texture2D,"(A, coords));\n        return value;\n      }\n      ");},Ib=function Ib(e,t,r,n,i,o){var a=t.length,s="";for(var _e120=a-1;_e120>=0;--_e120)s+="\n        k = m[".concat(_e120,"] - ").concat(o[_e120],";\n        if (k < 0) { k = -k; }\n        {\n          const int _2n_1 = ").concat(2*(t[_e120]-1),";\n          k = int( mod( float(k), float(_2n_1) ) ) ;\n          if(k >= ").concat(t[_e120],") { k = _2n_1 - k; }\n        }\n        offset += k * ").concat(r[_e120],";\n        ");return"\n      float padA(int m[".concat(a,"]) {\n        int offset = 0;\n        int k = 0;\n        ").concat(s,"\n        vec2 coords = offsetToCoords(offset, ").concat(n,", ").concat(i,");\n        float value = getColorAsFloat(").concat(e.texture2D,"(A, coords));\n        return value;\n      }\n      ");},Sb=function Sb(e,t,r,n,i,o){var a=t.length,s="";for(var _e121=a-1;_e121>=0;--_e121)s+="\n        k = m[".concat(_e121,"] - ").concat(o[_e121],";\n        if (k < 0)  k = 0;\n        if (k >= ").concat(t[_e121],") k = ").concat(t[_e121]-1,";\n        offset += k * ").concat(r[_e121],";\n      ");return"\n      float padA(int m[".concat(a,"]) {\n        int offset = 0;\n        int k = 0;\n        ").concat(s,"\n        vec2 coords = offsetToCoords(offset, ").concat(n,", ").concat(i,");\n        float value = getColorAsFloat(").concat(e.texture2D,"(A, coords));\n        return value;\n      }\n      ");};}),Kf,Jf,Zf,Qf,ec,tc,rc,nc,oc,Ab,Xf,ic,bo,ac,mo,Eb,sc=L(function(){Me(),fe(),ae(),Kf=function Kf(e,t,r){bo(t);var n={name:"AveragePool",inputNames:["X"],inputTypes:[0],cacheHint:r.cacheKey};return[e.run(_objectSpread(_objectSpread({},n),{},{get:function get(){return Zf(t,n,!1,r);}}),t)];},Jf=function Jf(e){var t=e.attributes.getString("auto_pad","NOTSET"),r=e.attributes.getInt("ceil_mode",0),n=0!==e.attributes.getInt("count_include_pad",0),i=e.attributes.getInts("kernel_shape"),o=e.attributes.getInts("strides",[]),a=e.attributes.getInts("pads",[]);if(0!==r)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return te({autoPad:t,ceilMode:r,countIncludePad:n,kernelShape:i,strides:o,pads:a});},Zf=function Zf(e,t,r,n){var _oc=oc(e,n,r),_oc2=_slicedToArray2(_oc,2),i=_oc2[0],o=_oc2[1],a=z.size(i.kernelShape),s="";i.countIncludePad?s+="value /= float(".concat(a,");"):s+="value /= float(".concat(a," - pad);");var u="\n        ".concat(ac(e[0].dims,i,"value += _X(x);",s,"0.0"),"\n      ");return _objectSpread(_objectSpread({},t),{},{output:{dims:o,type:e[0].type,textureType:0},shaderSource:u});},Qf=function Qf(e,t,r){bo(t);var n={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[0],cacheHint:"".concat(r.countIncludePad)};return[e.run(_objectSpread(_objectSpread({},n),{},{get:function get(){return Zf(t,n,!0,r);}}),t)];},ec=function ec(e){var t=0!==e.attributes.getInt("count_include_pad",0);return te({autoPad:"",ceilMode:0,countIncludePad:t,kernelShape:[],strides:[],pads:[]});},tc=function tc(e,t,r){bo(t);var n={name:"MaxPool",inputNames:["X"],inputTypes:[0],cacheHint:r.cacheKey};return[e.run(_objectSpread(_objectSpread({},n),{},{get:function get(){return nc(t,n,!1,r);}}),t)];},rc=function rc(e){var t=e.attributes.getString("auto_pad","NOTSET"),r=e.attributes.getInt("ceil_mode",0),n=e.attributes.getInts("kernel_shape"),i=e.attributes.getInts("strides",[]),o=e.attributes.getInts("pads",[]),a=e.attributes.getInt("storage_order",0),s=e.attributes.getInts("dilations",[]);if(0!==a)throw new Error("column major storage order is not yet supported for MaxPool");if(0!==r)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return te({autoPad:t,ceilMode:r,countIncludePad:!1,kernelShape:n,strides:i,pads:o,storageOrder:a,dilations:s});},nc=function nc(e,t,r,n){var _oc3=oc(e,n,r),_oc4=_slicedToArray2(_oc3,2),i=_oc4[0],o=_oc4[1],a="\n      ".concat(ac(e[0].dims,i,"\n      value = max(_X(x), value);\n    ","","-1e5"),"\n    ");return _objectSpread(_objectSpread({},t),{},{output:{dims:o,type:e[0].type,textureType:0},shaderSource:a});},oc=function oc(e,t,r){var n=e[0].dims.slice(),i=Object.hasOwnProperty.call(t,"dilations"),o=t.kernelShape.slice(),a=t.strides.slice(),s=i?t.dilations.slice():[],u=t.pads.slice();wr.adjustPoolAttributes(r,n,o,a,s,u);var l=wr.computePoolOutputShape(r,n,a,s,o,u,t.autoPad),c=Object.assign({},t);return i?Object.assign(c,{kernelShape:o,strides:a,pads:u,dilations:s,cacheKey:t.cacheKey}):Object.assign(c,{kernelShape:o,strides:a,pads:u,cacheKey:t.cacheKey}),[c,l];},Ab={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},Xf={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[0]},ic=function ic(e,t){return bo(t),[e.run(_objectSpread(_objectSpread({},Xf),{},{get:function get(){return nc(t,Xf,!0,Ab);}}),t)];},bo=function bo(e){if(!e||1!==e.length)throw new Error("Pool ops requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.");},ac=function ac(e,t,r,n,i){var o=e.length;if(t.kernelShape.length<=2){var _a9=t.kernelShape[t.kernelShape.length-1],_s9=t.strides[t.strides.length-1],_u9=t.pads[t.pads.length/2-1],_l7=t.pads[t.pads.length-1],_c7=e[o-1],_h7="",_f7="",_d6="";if(_h7=_u9+_l7!==0?"\n          for (int i = 0; i < ".concat(_a9,"; i++) {\n            x[").concat(o," - 1] = indices[").concat(o," - 1] * ").concat(_s9," - ").concat(_u9," + i;\n            if (x[").concat(o," - 1] < 0 || x[").concat(o," - 1] >= ").concat(_c7,") {\n              pad++;\n              continue;\n            }\n            ").concat(r,"\n          }"):"\n          for (int i = 0; i < ".concat(_a9,"; i++) {\n            x[").concat(o," - 1] = indices[").concat(o," - 1] * ").concat(_s9," - ").concat(_u9," + i;\n            ").concat(r,"\n          }"),2===t.kernelShape.length){var _r112=t.kernelShape[t.kernelShape.length-2],_n35=t.strides[t.strides.length-2],_i31=t.pads[t.pads.length/2-2],_s10=t.pads[t.pads.length-2],_u10=e[o-2];_f7=_i31+_s10!==0?"\n            for (int j = 0; j < ".concat(_r112,"; j++) {\n              x[").concat(o," - 2] = indices[").concat(o," - 2] * ").concat(_n35," - ").concat(_i31," + j;\n              if (x[").concat(o," - 2] < 0 || x[").concat(o," - 2] >= ").concat(_u10,") {\n                pad+= ").concat(_a9,";\n                continue;\n              }\n          "):"\n            for (int j = 0; j < ".concat(_r112,"; j++) {\n              x[").concat(o," - 2] = indices[").concat(o," - 2] * ").concat(_n35," - ").concat(_i31," + j;\n            "),_d6="\n          }\n        ";}return"\n        float process(int indices[".concat(o,"]) {\n          int x[").concat(o,"];\n          copyVec(indices, x);\n\n          float value = ").concat(i,";\n          int pad = 0;\n          ").concat(_f7,"\n          ").concat(_h7,"\n          ").concat(_d6,"\n          ").concat(n,"\n          return value;\n        }\n      ");}{var _a10=z.size(t.kernelShape),_s11=z.computeStrides(t.kernelShape),_u11=_s11.length,_l8=t.pads.length,_c8=Eb(_u11),_h8=mo(e,"inputDims"),_f8=mo(t.pads,"pads"),_d7=mo(_s11,"kernelStrides"),_p6=mo(t.strides,"strides"),_y3=t.pads.reduce(function(e,t){return e+t;}),_m3="";return _m3=_y3?"\n            if (x[j] >= inputDims[j] || x[j] < 0) {\n              pad++;\n              isPad = true;\n              break;\n            }\n          }\n          if (!isPad) {\n            ".concat(r,"\n          }"):"\n          }\n          ".concat(r,"\n        "),"\n        ".concat(_c8,"\n        float process(int indices[").concat(o,"]) {\n          int x[").concat(o,"];\n          copyVec(indices, x);\n          int offset[").concat(_u11,"];\n          int pads[").concat(_l8,"];\n          int inputDims[").concat(o,"];\n          int kernelStrides[").concat(_u11,"];\n          int strides[").concat(_u11,"];\n          ").concat(_f8,"\n          ").concat(_h8,"\n          ").concat(_p6,"\n          ").concat(_d7,"\n\n          float value = ").concat(i,";\n          int pad = 0;\n          bool isPad = false;\n          for (int i = 0; i < ").concat(_a10,"; i++) {\n            offsetToIndices(i, kernelStrides, offset);\n            isPad = false;\n            for (int j = ").concat(o," - ").concat(_u11,"; j < ").concat(o,"; j++) {\n              x[j] = indices[j] * strides[j - ").concat(o," + ").concat(_u11,"]\n                + offset[j - ").concat(o," + ").concat(_u11,"] - pads[j - 2];\n              ").concat(_m3,"\n          }\n          ").concat(n,"\n\n          return value;\n        }\n      ");}},mo=function mo(e,t){var r="";for(var _n36=0;_n36<e.length;_n36++)r+="\n      ".concat(t,"[").concat(_n36,"] = ").concat(e[_n36],";\n    ");return r;},Eb=function Eb(e){return"\n  void offsetToIndices(int offset, int[".concat(e,"] strides, out int[").concat(e,"] indices) {\n    if (").concat(e," == 0) {\n      return;\n    }\n    for (int i = 0; i < ").concat(e," - 1; ++i) {\n      indices[i] = offset / strides[i];\n      offset -= indices[i] * strides[i];\n    }\n    indices[").concat(e," - 1] = offset;\n  }");};}),Er,or,Pb,Db,uc,lc,fc,cc,pc,dc,hc,mc=L(function(){Me(),yn(),fe(),ae(),Er=function Er(e,t,r,n,i){Db(t);var o={name:n,inputNames:["A"],inputTypes:[0]};return[e.run(_objectSpread(_objectSpread({},o),{},{cacheHint:r.cacheKey,get:function get(){return Pb(e,t,r,n,i,o);}}),t)];},or=function or(e){var t=e.attributes.getInts("axes",[]),r=1===e.attributes.getInt("keepdims",1);return te({axes:t,keepDims:r});},Pb=function Pb(e,t,r,n,i,o){var a=[],s=t[0].dims.length||1,u=[],l=z.normalizeAxes(r.axes,t[0].dims.length),c=i(t,l),h=c[1];for(var _e122=0;_e122<t[0].dims.length;_e122++)l.indexOf(_e122)>=0||0===l.length?(r.keepDims&&a.push(1),h="\n          for(int j".concat(_e122," = 0; j").concat(_e122," < ").concat(t[0].dims[_e122],"; j").concat(_e122,"++) {\n            inputIdx[").concat(_e122,"] = j").concat(_e122,";\n            ").concat(h,"\n          }")):(u.push("inputIdx[".concat(_e122,"] = outputIdx[").concat(a.length,"];")),a.push(t[0].dims[_e122]));var f="\n      float process(int outputIdx[".concat(a.length||1,"]) {\n        float value;                 // final result\n        int inputIdx[").concat(s,"];      // addressing input data\n        ").concat(u.join("\n"),"\n        ").concat(c[0],"       // init ops for reduce max/min\n        ").concat(h,"\n        ").concat(c[2],"       // final computation for reduce mean\n        return value;\n      }");return _objectSpread(_objectSpread({},o),{},{output:{dims:a,type:t[0].type,textureType:0},shaderSource:f});},Db=function Db(e){if(!e||1!==e.length)throw new Error("Reduce op requires 1 input.");if(-1===nr.indexOf(e[0].type))throw new Error("Invalid input type.");},uc=function uc(e,t,r){return Er(e,t,r,"ReduceSum",function(){return["value = 0.0;","value += _A(inputIdx);",""];});},lc=function lc(e,t,r){return Er(e,t,r,"ReduceMean",function(e,t){var r=1;for(var _n37=0;_n37<e[0].dims.length;_n37++)(t.indexOf(_n37)>=0||0===t.length)&&(r*=e[0].dims[_n37]);return["value = 0.0;","value += _A(inputIdx);","value /= ".concat(r,".;")];});},fc=function fc(e,t,r){return Er(e,t,r,"ReduceMax",function(e,t){var r=[];for(var _n38=0;_n38<e[0].dims.length;_n38++)(t.indexOf(_n38)>=0||0===t.length)&&r.push("inputIdx[".concat(_n38,"] = 0;"));return["".concat(r.join("\n"),"\nvalue = _A(inputIdx);"),"value = max(value, _A(inputIdx));",""];});},cc=function cc(e,t,r){return Er(e,t,r,"ReduceMin",function(e,t){var r=[];for(var _n39=0;_n39<e[0].dims.length;_n39++)(t.indexOf(_n39)>=0||0===t.length)&&r.push("inputIdx[".concat(_n39,"] = 0;"));return["".concat(r.join("\n"),"\nvalue = _A(inputIdx);"),"value = min(value, _A(inputIdx));",""];});},pc=function pc(e,t,r){return Er(e,t,r,"ReduceProd",function(){return["value = 1.0;","value *= _A(inputIdx);",""];});},dc=function dc(e,t,r){return Er(e,t,r,"ReduceLogSum",function(){return["value = 0.0;","value += _A(inputIdx);","value = log(value);"];});},hc=function hc(e,t,r){return Er(e,t,r,"ReduceLogSumSquare",function(){return["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""];});};}),bc,gc=L(function(){fe(),bc=function bc(e,t){var r=z.calculateReshapedDims(t[0].dims,t[1].integerData);return e.session.pack?[e.reshapePacked(t[0],r)]:[e.reshapeUnpacked(t[0],r)];};}),yc,Wi,Tc,xc,Tn,Lb,Vi,go,Hi=L(function(){Me(),ve(),ae(),yc={name:"Upsample",inputNames:["X"],inputTypes:[0]},Wi=function Wi(e,t,r){return Vi(t,r),[e.run(_objectSpread(_objectSpread({},yc),{},{cacheHint:r.cacheKey,get:function get(){return Lb(e,t,r);}}),t)];},Tc=function Tc(e){return Tn(e,7);},xc=function xc(e){return Tn(e,9);},Tn=function Tn(e,t){var r=t>=10,n=e.attributes.getString("mode","nearest");if("nearest"!==n&&"linear"!==n&&(t<11||"cubic"!==n))throw new Error("unrecognized mode: ".concat(n));var i=[];t<9&&(i=e.attributes.getFloats("scales"),go(i,n,r));var o=e.attributes.getFloat("extrapolation_value",0),a=t>10?e.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(-1===["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(a))throw new Error("coordinate_transform_mode '".concat(a,"' is not supported"));var s="tf_crop_and_resize"===a,u=s,l="nearest"===n&&t>=11?e.attributes.getString("nearest_mode","round_prefer_floor"):"";if(-1===["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(l))throw new Error("nearest_mode '".concat(l,"' is not supported"));var c=e.attributes.getFloat("cubic_coeff_a",-.75),h=0!==e.attributes.getInt("exclude_outside",0);if(h&&"cubic"!==n)throw new Error("exclude_outside can be set to 1 only when mode is CUBIC.");var f=t<11||"nearest"===n&&"asymmetric"===a&&"floor"===l,d=0,p=0,y=0;return t>10?e.inputs.length>2?(d=1,p=2,y=3):(p=1,y=2):9===t&&(p=1),te({opset:t,isResize:r,mode:n,scales:i,extrapolationValue:o,coordinateTransformMode:a,useExtrapolation:u,needRoiInput:s,nearestMode:l,cubicCoefficientA:c,excludeOutside:h,useNearest2xOptimization:f,roiInputIdx:d,scalesInputIdx:p,sizesInputIdx:y});},Lb=function Lb(e,t,r){var n=q(e.session.backend.glContext.version),_e$calculateTextureWi11=e.calculateTextureWidthAndHeight(t[0].dims,0),_e$calculateTextureWi12=_slicedToArray2(_e$calculateTextureWi11,2),i=_e$calculateTextureWi12[0],o=_e$calculateTextureWi12[1],a=t[0].dims.map(function(e,t){return Math.floor(e*r.scales[t]);}),_e$calculateTextureWi13=e.calculateTextureWidthAndHeight(a,0),_e$calculateTextureWi14=_slicedToArray2(_e$calculateTextureWi13,2),s=_e$calculateTextureWi14[0],u=_e$calculateTextureWi14[1],l=a.length,c=new Array(l),h=new Array(l),f="\n      int output_pitches[".concat(l,"];\n      int input_pitches[").concat(l,"];\n      ");for(var _e123=l-1;_e123>=0;_e123--)c[_e123]=_e123===l-1?1:c[_e123+1]*a[_e123+1],h[_e123]=_e123===l-1?1:h[_e123+1]*t[0].dims[_e123+1],f+="\n        output_pitches[".concat(_e123,"] = ").concat(c[_e123],";\n        input_pitches[").concat(_e123,"] = ").concat(h[_e123],";\n        ");var d="\n      float getInputFloat(int index) {\n        vec2 coords = offsetToCoords(index, ".concat(i,", ").concat(o,");\n        float value = getColorAsFloat(").concat(n.texture2D,"(X, coords));\n        return value;\n      }\n      "),p="nearest"===r.mode?"\n    ".concat(d,"\n    float process(int indices[").concat(l,"]) {\n      int input_index = 0;\n      int output_index = coordsToOffset(TexCoords, ").concat(s,", ").concat(u,");\n\n      ").concat(f,"\n\n      int d, m;\n      for (int dim = 0; dim < ").concat(l,"; ++dim) {\n        d = output_index / output_pitches[dim];\n        m = output_index - d * output_pitches[dim];\n        output_index = m;\n\n        if (scales[dim] != 1 && d > 0) {\n          int d2 = d / scales[dim];\n          m = d - d2 * scales[dim];\n          d = d2;\n        }\n        input_index += input_pitches[dim] * d;\n      }\n\n      return getInputFloat(input_index);\n    }"):4===l?"\n    ".concat(d,"\n    float process(int indices[4]) {\n      int input_index = 0;\n      int output_index = coordsToOffset(TexCoords, ").concat(s,", ").concat(u,");\n\n      ").concat(f,"\n\n      int m;\n      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;\n      index_of_dim0 = output_index / output_pitches[0];\n      m = output_index - index_of_dim0 * output_pitches[0];\n      index_of_dim1 = m / output_pitches[1];\n      m = m - index_of_dim1 * output_pitches[1];\n      index_of_dim2 = m / output_pitches[2];\n      m = m - index_of_dim2 * output_pitches[2];\n      index_of_dim3 = m;\n\n      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;\n      index_of_input_dim2 = index_of_dim2 / scales[2];\n      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];\n      index_of_input_dim3 = index_of_dim3 / scales[3];\n      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];\n\n      input_index = index_of_dim0 * input_pitches[0] +\n            index_of_dim1 * input_pitches[1] +\n            index_of_input_dim2 * input_pitches[2] +\n            index_of_input_dim3;\n\n      float x00 = getInputFloat(input_index);\n      float x10, x01, x11;\n\n      bool end_of_dim2 = false;\n      if (index_of_input_dim2 == (").concat(t[0].dims[2]," - 1)) {\n        // It's the end in dimension 2\n        x01 = x00;\n        end_of_dim2 = true;\n      } else {\n        x01 = getInputFloat(input_index + input_pitches[2]);\n      }\n\n      if (index_of_input_dim3 == (input_pitches[2] - 1)) {\n        // It's the end in dimension 3\n        x10 = x00;\n        x11 = x01;\n      }\n      else {\n        x10 = getInputFloat(input_index + 1);\n        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);\n      }\n\n      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);\n      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);\n      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);\n    }"):"\n    ".concat(d,"\n    float process(int indices[2]) {\n      int input_index = 0;\n      int output_index = coordsToOffset(TexCoords, ").concat(s,", ").concat(u,");\n\n      ").concat(f,"\n\n      int m;\n      int index_of_dim0, index_of_dim1;\n      index_of_dim0 = output_index / output_pitches[0];\n      m = output_index - index_of_dim0 * output_pitches[0];\n      index_of_dim1 = m;\n\n      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;\n      index_of_input_dim0 = index_of_dim0 / scales[0];\n      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];\n      index_of_input_dim1 = index_of_dim1 / scales[1];\n      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];\n\n      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;\n\n      float x00 = getInputFloat(input_index);\n      float x10, x01, x11;\n\n      bool end_of_dim0 = false;\n      if (index_of_input_dim0 == (").concat(t[0].dims[0]," - 1)) {\n        // It's the end in dimension 0\n        x01 = x00;\n        end_of_dim0 = true;\n      } else {\n        x01 = getInputFloat(input_index + input_pitches[0]);\n      }\n\n      if (index_of_input_dim1 == (input_pitches[0] - 1)) {\n        // It's the end in dimension 1\n        x10 = x00;\n        x11 = x01;\n      }\n      else {\n        x10 = getInputFloat(input_index + 1);\n        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);\n      }\n\n      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);\n      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);\n      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);\n    }");return _objectSpread(_objectSpread({},yc),{},{output:{dims:a,type:t[0].type,textureType:0},shaderSource:p,variables:[{name:"scales",type:"int",arrayLength:r.scales.length,data:r.scales.map(function(e){return Math.ceil(e);})}]});},Vi=function Vi(e,t){if(!e||t.opset<9&&1!==e.length||t.opset>=9&&t.opset<11&&2!==e.length||t.opset>=11&&e.length<2)throw new Error("invalid inputs.");if(t.scales.length>0&&e[0].dims.length!==t.scales.length)throw new Error("Invalid input shape.");if("string"===e[0].type)throw new Error("Invalid input tensor types.");},go=function go(e,t,r){if(r){var _iterator17=_createForOfIteratorHelper2(e),_step17;try{for(_iterator17.s();!(_step17=_iterator17.n()).done;){var _t74=_step17.value;if(_t74<=0)throw new Error("Scale value should be greater than 0.");}}catch(err){_iterator17.e(err);}finally{_iterator17.f();}}else{var _iterator18=_createForOfIteratorHelper2(e),_step18;try{for(_iterator18.s();!(_step18=_iterator18.n()).done;){var _t75=_step18.value;if(_t75<1)throw new Error("Scale value should be greater than or equal to 1.");}}catch(err){_iterator18.e(err);}finally{_iterator18.f();}}if(!("linear"!==t&&"cubic"!==t||2===e.length||4===e.length&&1===e[0]&&1===e[1]))throw new Error("'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ".concat(r?"Resize":"Upsample"," opeartor."));};}),ji,qi,wc,vc,Fb,Cb,$b,Bb,_c=L(function(){ve(),ae(),Bt(),Ir(),Hi(),ji={name:"Resize",inputNames:["A"],inputTypes:[2]},qi=function qi(e,t,r){return Vi(t,r),[e.run(_objectSpread(_objectSpread({},ji),{},{cacheHint:r.cacheKey,get:function get(){return Fb(e,t,r);}}),t)];},wc=function wc(e){return Tn(e,10);},vc=function vc(e){return Tn(e,11);},Fb=function Fb(e,t,r){var n=q(e.session.backend.glContext.version),_Cb=Cb(t,r),_Cb2=_slicedToArray2(_Cb,2),i=_Cb2[0],o=_Cb2[1];if(i.every(function(e){return 1===e;})&&"tf_crop_and_resize"!==r.coordinateTransformMode)return _objectSpread(_objectSpread({},ji),{},{output:{dims:o,type:t[0].type,textureType:2},hasMain:!0,shaderSource:"void main() {\n                    vec4 v = ".concat(n.texture2D,"(X, TexCoords);\n                    ").concat(n.output," = v;\n                }")});var a=o.length;if(a<2)throw new Error("output dimension should be at least 2, but got ".concat(a));var s=o[a-2],u=o[a-1],l=t[0].dims;if(a!==l.length)throw new Error("output dimension should match input ".concat(l.length,", but got ").concat(a));var c=l[a-2],h=l[a-1],f=i[a-2],d=i[a-1],p="";if("linear"!==r.mode)throw new Error("resize (packed) does not support mode: '".concat(r.mode,"'"));switch(r.coordinateTransformMode){case"asymmetric":p="\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        return vec4(coords) / scaleWHWH;\n                    }\n                ";break;case"half_pixel":p="\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;\n                    }\n                ";break;case"pytorch_half_pixel":p="\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        vec4 fcoords = vec4(coords);\n                        return vec4(\n                            ".concat(u,".0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,\n                            ").concat(s,".0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,\n                            ").concat(u,".0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,\n                            ").concat(s,".0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0\n                          );\n                    }\n                ");break;case"align_corners":p="\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        vec4 resized = vec4(".concat(u,".0 - 1.0, ").concat(s,".0 - 1.0, ").concat(u,".0 - 1.0,\n                            ").concat(s,".0 - 1.0);\n                        vec4 original = vec4(").concat(h,".0 - 1.0, ").concat(c,".0 - 1.0, ").concat(h,".0 - 1.0,\n                            ").concat(c,".0 - 1.0);\n                        vec4 new_scale = original / resized;\n                        return vec4(coords) * new_scale;\n                    }\n                ");break;default:throw new Error("resize (packed) does not support coordinateTransformMode:                                 '".concat(r.coordinateTransformMode,"'"));}var y=Je(a),m="\n            const vec2 inputWH = vec2(".concat(c,".0, ").concat(h,".0);\n            const vec4 scaleWHWH = vec4(float(").concat(f,"), float(").concat(d,"), float(").concat(f,"), float(").concat(d,"));\n            ").concat(kt(),"\n            ").concat(p,"\n            float getAValue(int x10, int r, int c, int d) {\n                return getChannel(getA(x10, r, c, d), vec2(c, d));\n            }\n            void main() {\n                ").concat(y," rc = getOutputCoords();\n\n                int batch = rc[0];\n                int depth = rc[1];\n\n                // retrieve the 4 coordinates that is used in the 4 packed output values.\n                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);\n\n                // calculate the source index in fraction\n                vec4 sourceFrac = getSourceFracIndex(coords);\n\n                // get the lower and upper bound of the 4 values that will be packed into one texel.\n                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));\n                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));\n                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));\n                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));\n\n                bool hasNextRow = rc.w < ").concat(s-1,";\n                bool hasNextCol = rc.z < ").concat(u-1,";\n\n                // pack x00, x01, x10, x11's top-left corner into one vec4 structure\n                vec4 topLeft = vec4(\n                    getAValue(batch, depth, x00.x, x00.y),\n                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);\n\n                // pack x00, x01, x10, x11's top-right corner into one vec4 structure\n                vec4 topRight = vec4(\n                    getAValue(batch, depth, x00.x, x00.w),\n                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);\n\n                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure\n                vec4 bottomLeft = vec4(\n                    getAValue(batch, depth, x00.z, x00.y),\n                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);\n\n                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure\n                vec4 bottomRight = vec4(\n                    getAValue(batch, depth, x00.z, x00.w),\n                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);\n\n                // calculate the interpolation fraction on u and v direction\n                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);\n                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));\n\n                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);\n                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);\n                vec4 newValue = mix(top, bottom, clampFrac.xxzz);\n\n                ").concat(n.output," = vec4(newValue);\n            }\n        ");return _objectSpread(_objectSpread({},ji),{},{output:{dims:o,type:t[0].type,textureType:2},hasMain:!0,shaderSource:m});},Cb=function Cb(e,t){var r,n=e[0].dims,i=t.scales;if(0===i.length){var _o18=e[t.scalesInputIdx];if(_o18&&0!==_o18.size){if(e[t.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");i=$b(_o18,t.mode,t.isResize);}else{var _o19=e[t.sizesInputIdx];if(!_o19||0===_o19.size)throw new Error("Either scales or sizes MUST be provided as input.");r=Array.from(_o19.integerData),i=Bb(r,n,t.mode,t.isResize);}}else if(e[t.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");var o=r||n.map(function(e,t){return Math.floor(e*i[t]);});return[i,o];},$b=function $b(e,t,r){var n=Array.from(e.floatData);return go(n,t,r),n;},Bb=function Bb(e,t,r,n){var i=t.length,o=new Array(i);for(var _r113=0,_n40=i;_r113<_n40;_r113++)if(0===t[_r113]){if(0!==e[_r113])throw new Error("Input dim is zero but required output dim is non-zero.");o[_r113]=1;}else o[_r113]=e[_r113]/t[_r113];return go(o,r,n),o;};}),Oc,kb,Ic=L(function(){Or(),Oc=function Oc(e,t){return kb(t),[new $e([t[0].dims.length],"int32",void 0,void 0,new Int32Array(t[0].dims))];},kb=function kb(e){if(!e||1!==e.length)throw new Error("Shape requires 1 input.");};}),Yi,Sc,Ac,Ec,Nb,Pc,Rb,Mb,Dc=L(function(){Me(),yn(),fe(),ae(),Yi={name:"Slice",inputNames:["A"],inputTypes:[0]},Sc=function Sc(e,t,r){return Nb(t),[e.run(_objectSpread(_objectSpread({},Yi),{},{cacheHint:r.cacheKey,get:function get(){return Ec(e,t[0],r);}}),t)];},Ac=function Ac(e){var t=e.attributes.getInts("starts"),r=e.attributes.getInts("ends"),n=e.attributes.getInts("axes",[]);return te({starts:t,ends:r,axes:n});},Ec=function Ec(e,t,r){var n=0===r.axes.length?t.dims.slice(0).map(function(e,t){return t;}):r.axes,i=z.normalizeAxes(n,t.dims.length),o=r.starts.map(function(e,r){return e>t.dims[i[r]]-1?t.dims[i[r]]:z.normalizeAxis(e,t.dims[i[r]]);}),a=r.ends.map(function(e,r){return e>t.dims[i[r]]-1?t.dims[i[r]]:z.normalizeAxis(e,t.dims[i[r]]);}),s=t.dims.slice(),u=[];for(var _e124=0;_e124<i.length;_e124++)s[i[_e124]]=a[_e124]-o[_e124],o[_e124]>0&&u.push("outputIdx[".concat(i[_e124],"] += ").concat(o[_e124],";"));var l="\n      float process(int outputIdx[".concat(s.length,"]) {\n        ").concat(u.join("\n      "),"\n        return _A(outputIdx);\n      }");return _objectSpread(_objectSpread({},Yi),{},{output:{dims:s,type:t.type,textureType:0},shaderSource:l});},Nb=function Nb(e){if(!e||1!==e.length)throw new Error("Slice requires 1 input.");if(-1===nr.indexOf(e[0].type))throw new Error("Invalid input type.");},Pc=function Pc(e,t){Mb(t);var r=Rb(e,t);return[e.run(_objectSpread(_objectSpread({},Yi),{},{cacheHint:r.cacheKey,get:function get(){return Ec(e,t[0],r);}}),[t[0]])];},Rb=function Rb(e,t){if(!e.session.isInitializer(t[1].dataId)||!e.session.isInitializer(t[2].dataId)||t.length>=4&&!e.session.isInitializer(t[3].dataId)||t.length>=5&&!e.session.isInitializer(t[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(t.length>=5&&t[4].integerData.some(function(e){return 1!==e;}))throw new Error("currently non-1 steps is not supported for Slice");var r=Array.from(t[1].integerData),n=Array.from(t[2].integerData),i=t.length>=4?Array.from(t[3].integerData):[];return{starts:r,ends:n,axes:i,cacheKey:"".concat(i,";").concat(r,";").concat(n)};},Mb=function Mb(e){if(!e||e.length<3||e.length>5)throw new Error("Invalid input number.");if("int32"!==e[1].type||1!==e[1].dims.length)throw new Error("Invalid input type.");if("int32"!==e[2].type||1!==e[2].dims.length)throw new Error("Invalid input type.");if(e.length>=4&&("int32"!==e[3].type||1!==e[3].dims.length))throw new Error("Invalid input type.");if(e.length>=5&&("int32"!==e[4].type||1!==e[4].dims.length))throw new Error("Invalid input type.");};}),Lc,Fc,Cc,$c,Bc,kc,Nc,Rc,Gb,Ub,zb,Mc,Gc=L(function(){Me(),fe(),ve(),ae(),ho(),Lc={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[0]},Fc={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[0,0]},Cc={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[0,0,0]},$c=function $c(e,t,r){Mc(t);var n=t[0].dims.slice(),i=z.normalizeAxis(r.axis,n.length),o=z.sizeToDimension(n,i),a=z.sizeFromDimension(n,i);return Rc(e,t,r,o,a);},Bc=function Bc(e){return te({axis:e.attributes.getInt("axis",1)});},kc=function kc(e){return te({axis:e.attributes.getInt("axis",-1)});},Nc=function Nc(e,t,r){Mc(t);var n,i=t[0].dims.slice(),o=z.normalizeAxis(r.axis,i.length),a=i.length,s=o!==a-1,u=[],l=[],c=[];s&&(l=Array.from({length:a}).map(function(e,t){return t;}),l[o]=a-1,l[a-1]=o,l.map(function(e){return u.push(i[e]);}),n=te({perm:l}),c=Ar(e,t,n));var h=s?z.sizeToDimension(u,a-1):z.sizeToDimension(i,a-1),f=s?z.sizeFromDimension(u,a-1):z.sizeFromDimension(i,a-1),d=Rc(e,s?c:t,r,h,f);return s?Ar(e,d,n):d;},Rc=function Rc(e,t,r,n,i){var o=Gb(e,t[0],n,i,[n]),a=e.run(_objectSpread(_objectSpread({},Lc),{},{cacheHint:r.cacheKey,get:function get(){return o;}}),t),s=Ub(e,t[0],n,i,o.output.dims,[n]),u=e.run(_objectSpread(_objectSpread({},Fc),{},{cacheHint:r.cacheKey,get:function get(){return s;}}),[t[0],a]),l=zb(e,t[0],n,i,o.output.dims,s.output.dims);return[e.run(_objectSpread(_objectSpread({},Cc),{},{cacheHint:r.cacheKey,get:function get(){return l;}}),[t[0],a,u])];},Gb=function Gb(e,t,r,n,i){var _e$calculateTextureWi15=e.calculateTextureWidthAndHeight(t.dims,0),_e$calculateTextureWi16=_slicedToArray2(_e$calculateTextureWi15,2),o=_e$calculateTextureWi16[0],a=_e$calculateTextureWi16[1],s=i.length;if(r<1||n<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==i.length)throw new Error("Dimensionality of the output should be 1");if(i[0]!==r)throw new Error("Shape of the output should be equal to logical row count");var u=q(e.session.backend.glContext.version),l="\n      float process(int[".concat(s,"] indices) {\n        int logical_row_start_offset = indices[0] * ").concat(n,";\n\n        float max = getColorAsFloat(").concat(u.texture2D,"(A, offsetToCoords(logical_row_start_offset, ").concat(o,",\n        ").concat(a," )));\n        for(int i=1; i<").concat(n,"; ++i)\n        {\n          float current = getColorAsFloat(").concat(u.texture2D,"(A, offsetToCoords(logical_row_start_offset + i,\n            ").concat(o,", ").concat(a,")));\n          if(current > max)\n          max = current;\n        }\n\n        return max;\n      }");return _objectSpread(_objectSpread({},Lc),{},{output:{dims:i,type:t.type,textureType:0},shaderSource:l});},Ub=function Ub(e,t,r,n,i,o){var _e$calculateTextureWi17=e.calculateTextureWidthAndHeight(t.dims,0),_e$calculateTextureWi18=_slicedToArray2(_e$calculateTextureWi17,2),a=_e$calculateTextureWi18[0],s=_e$calculateTextureWi18[1],u=o.length;if(r<1||n<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==o.length)throw new Error("Dimensionality of the output should be 1");if(o[0]!==r)throw new Error("Shape of the output should be equal to logical row count");if(1!==i.length)throw new Error("Dimensionality of the intermediate results should be 1");if(i[0]!==r)throw new Error("Shape of the intermediate results should be equal to logical row count");var l="\n      float process(int[".concat(u,"] indices) {\n        int logical_row_start_offset = indices[0] * ").concat(n,";\n\n        float norm_factor = 0.0;\n        float max = _Max(indices);\n        for(int i=0; i<").concat(n,"; ++i)\n        {\n          norm_factor += exp(getColorAsFloat(").concat(q(e.session.backend.glContext.version).texture2D,"(A, offsetToCoords(logical_row_start_offset + i,\n            ").concat(a,", ").concat(s,"))) - max);\n        }\n\n        return norm_factor;\n      }");return _objectSpread(_objectSpread({},Fc),{},{output:{dims:o,type:t.type,textureType:0},shaderSource:l});},zb=function zb(e,t,r,n,i,o){var _e$calculateTextureWi19=e.calculateTextureWidthAndHeight(t.dims,0),_e$calculateTextureWi20=_slicedToArray2(_e$calculateTextureWi19,2),a=_e$calculateTextureWi20[0],s=_e$calculateTextureWi20[1],u=t.dims.length;if(r<1||n<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==i.length||1!==o.length)throw new Error("Dimensionality of the intermediate results should be 1");if(i[0]!==r||o[0]!==r)throw new Error("Shape of the intermediate results should be equal to logical row count");var l="\n      float process(int[".concat(u,"] indices) {\n\n      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)\n      int offset = coordsToOffset(TexCoords, ").concat(a,", ").concat(s,");\n\n      //determine the logical row for this index\n      int logical_row_index[1];\n      logical_row_index[0] = offset / ").concat(n,";\n\n      float norm_factor = _Norm(logical_row_index);\n\n      // avoid possible division by 0\n      // if norm_facor is 0, all elements are zero\n      // if so, return 0\n      if(norm_factor == 0.0)\n        return 0.0;\n\n      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;\n    }");return _objectSpread(_objectSpread({},Cc),{},{output:{dims:t.dims,type:t.type,textureType:0},shaderSource:l});},Mc=function Mc(e){if(!e||1!==e.length)throw new Error("Softmax requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type");};}),Uc,zc,Wc,Wb,Vb,Hb,Vc=L(function(){Me(),fe(),ae(),Uc={name:"Split",inputNames:["A"],inputTypes:[0]},zc=function zc(e,t,r){Hb(t);var n=z.normalizeAxis(r.axis,t[0].dims.length),i=Wb(e,t,n,r),o=[];var _loop2=function _loop2(_a11){o.push(e.run(_objectSpread(_objectSpread({},Uc),{},{cacheHint:"".concat(r.cacheKey,";").concat(_a11),get:function get(){return Vb(e,t[0],r,n,_a11);}}),t));};for(var _a11=0;_a11<i;++_a11){_loop2(_a11);}return o;},Wc=function Wc(e){var t=e.attributes.getInt("axis",0),r=e.attributes.getInts("split",[]),n=e.outputs.length;return te({axis:t,split:r,numOutputs:n});},Wb=function Wb(e,t,r,n){var _pn$splitShape=pn.splitShape(t[0].dims,r,n.split,n.numOutputs),_pn$splitShape2=_slicedToArray2(_pn$splitShape,2),i=_pn$splitShape2[1];return i.length;},Vb=function Vb(e,t,r,n,i){var _pn$splitShape3=pn.splitShape(t.dims,n,r.split,r.numOutputs),_pn$splitShape4=_slicedToArray2(_pn$splitShape3,2),o=_pn$splitShape4[0],a=_pn$splitShape4[1],s=a[i],u=o[i],l="\n      float process(int indices[".concat(u.length,"]) {\n        indices[").concat(n,"] += ").concat(s,";\n        return _A(indices);\n      }\n    ");return _objectSpread(_objectSpread({},Uc),{},{cacheHint:"".concat(r.cacheKey,":").concat(i),output:{dims:u,type:t.type,textureType:0},shaderSource:l});},Hb=function Hb(e){if(!e||1!==e.length)throw new Error("Split requires one input.");if("int8"!==e[0].type&&"uint8"!==e[0].type&&"int16"!==e[0].type&&"uint16"!==e[0].type&&"int32"!==e[0].type&&"uint32"!==e[0].type&&"float32"!==e[0].type&&"float64"!==e[0].type&&"bool"!==e[0].type)throw new Error("Invalid input type.");};}),Xi,Hc,jc,jb,qb,qc=L(function(){fe(),Xi=function Xi(e,t,r){jb(t);var n=z.squeezeShape(t[0].dims,r);return[e.reshapeUnpacked(t[0],n)];},Hc=function Hc(e,t){return qb(t),Xi(e,[t[0]],Array.from(t[1].integerData));},jc=function jc(e){return e.attributes.getInts("axes");},jb=function jb(e){if(!e||1!==e.length)throw new Error("Squeeze requires 1 input.");if("string"===e[0].type)throw new Error("invalid input tensor types.");},qb=function qb(e){if(!e||2!==e.length)throw new Error("Squeeze requires 2 inputs.");if("int32"!==e[1].type)throw new Error("Invalid input type.");};}),Yc,Yb,Xb,Xc=L(function(){ve(),ae(),Yc=function Yc(e,t){Xb(t);var r={name:"Sum",inputNames:t.map(function(e,t){return"X".concat(t);}),inputTypes:new Array(t.length).fill(0)};return[e.run(_objectSpread(_objectSpread({},r),{},{get:function get(){return Yb(e,t,r);}}),t)];},Yb=function Yb(e,t,r){var n=q(e.session.backend.glContext.version),i=t[0].dims.slice(),o="\n      void main() {\n        vec4 result = ".concat(t.map(function(e,t){return"".concat(n.texture2D,"(X").concat(t,",TexCoords)");}).join(" + "),";\n        ").concat(n.output," = result;\n      }\n    ");return _objectSpread(_objectSpread({},r),{},{output:{dims:i,type:t[0].type,textureType:0},hasMain:!0,shaderSource:o});},Xb=function Xb(e){if(!e||0===e.length)throw new Error("Sum requires inputs.");var t=e[0].dims.length;for(var _r114=1;_r114<e.length;_r114++){if(t!==e[_r114].dims.length)throw new Error("Input shapes are mismatched.");for(var _n41=0;_n41<t;_n41++)if(e[0].dims[_n41]!==e[_r114].dims[_n41])throw new Error("Input shapes are not matched.");}if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.");for(var _t76=1;_t76<e.length;_t76++)if(e[0].type!==e[_t76].type)throw new Error("Input types are not matched.");};}),Kc,Kb,Jb,Jc=L(function(){yn(),ae(),Kc=function Kc(e,t){Jb(t);var r={name:"Tile",inputNames:["A"],inputTypes:[0]};return[e.run(_objectSpread(_objectSpread({},r),{},{get:function get(){return Kb(e,t,r);}}),t)];},Kb=function Kb(e,t,r){var n=t[0].dims.slice(),i=new Array(n.length),o=[];for(var _e125=0;_e125<n.length;_e125++)i[_e125]=n[_e125]*t[1].numberData[_e125],o.push("inputIdx[".concat(_e125,"] = int(mod(float(outputIdx[").concat(_e125,"]), ").concat(n[_e125],".));"));var a=i.length,s="\n      float process(int outputIdx[".concat(a,"]) {\n        int inputIdx[").concat(a,"];\n        ").concat(o.join("\n"),"\n        return _A(inputIdx);\n      }\n    ");return _objectSpread(_objectSpread({},r),{},{output:{dims:i,type:t[0].type,textureType:0},shaderSource:s});},Jb=function Jb(e){if(!e||2!==e.length)throw new Error("Tile requires 2 input.");if(1!==e[1].dims.length)throw new Error("The second input shape must 1 dimension.");if(e[1].dims[0]!==e[0].dims.length)throw new Error("Invalid input shape.");if(-1===nr.indexOf(e[0].type))throw new Error("Invalid input type.");if("int32"!==e[1].type&&"int16"!==e[1].type)throw new Error("Invalid repeat type.");};}),Ki,Zc,Qc,Zb,Qb,ep=L(function(){fe(),Ki=function Ki(e,t,r){Zb(t);var n=z.unsqueezeShape(t[0].dims,r);return[e.reshapeUnpacked(t[0],n)];},Zc=function Zc(e,t){return Qb(t),Ki(e,[t[0]],Array.from(t[1].integerData));},Qc=function Qc(e){return e.attributes.getInts("axes");},Zb=function Zb(e){if(!e||1!==e.length)throw new Error("Unsqueeze requires 1 input.");if("string"===e[0].type)throw new Error("invalid input tensor types.");},Qb=function Qb(e){if(!e||2!==e.length)throw new Error("Unsqueeze requires 2 inputs.");if("int32"!==e[1].type)throw new Error("Invalid input type.");};}),tp,rp=L(function(){cl(),Ol(),Al(),Cl(),fo(),gf(),_f(),Sf(),Pf(),Cf(),kf(),Gf(),Vf(),co(),Yf(),sc(),mc(),gc(),_c(),Ic(),Dc(),Gc(),Vc(),qc(),Xc(),Jc(),ho(),Ci(),ep(),Hi(),tp=[["Abs","","6+",$l],["Acos","","7+",Bl],["Add","","7+",pl],["And","","7+",dl],["Asin","","7+",kl],["Atan","","7+",Nl],["AveragePool","","7+",Kf,Jf],["BatchNormalization","","7+",ll,fl],["Cast","","6+",Il,Sl],["Ceil","","6+",Gl],["Clip","","6-10",Li,Rl],["Clip","","11+",Ml],["Concat","","4+",Dl,Fl],["Conv","","1+",Mi,Gi],["ConvTranspose","","1+",mf,bf],["Cos","","7+",Ul],["Div","","7+",hl],["Dropout","","7+",Fi],["DepthToSpace","","1+",wf,vf],["Equal","","7+",ml],["Elu","","6+",zl,Wl],["Exp","","6+",Vl],["Flatten","","1+",Of,If],["Floor","","6+",Hl],["FusedConv","com.microsoft","1+",Mi,Gi],["Gather","","1+",Af,Ef],["Gemm","","7-10",Ui,Lf],["Gemm","","11+",Ui,Ff],["GlobalAveragePool","","1+",Qf,ec],["GlobalMaxPool","","1+",ic],["Greater","","7+",bl],["Identity","","1+",Fi],["ImageScaler","","1+",$f,Bf],["InstanceNormalization","","6+",Rf,Mf],["LeakyRelu","","6+",jl,ql],["Less","","7+",gl],["LRN","","1+",Uf,zf],["Log","","6+",Yl],["MatMul","","1+",uf,lf],["MaxPool","","1+",tc,rc],["Mul","","7+",yl],["Neg","","6+",Xl],["Not","","1+",Kl],["Or","","7+",Tl],["Pad","","2-10",zi,Hf],["Pad","","11+",jf,qf],["Pow","","7+",xl],["PRelu","","7+",wl],["ReduceLogSum","","1+",dc,or],["ReduceMax","","1+",fc,or],["ReduceMean","","1+",lc,or],["ReduceMin","","1+",cc,or],["ReduceProd","","1+",pc,or],["ReduceSum","","1-12",uc,or],["ReduceSumSquare","","1+",hc,or],["Relu","","6+",Jl],["Reshape","","5+",bc],["Resize","","10",qi,wc],["Resize","","11+",qi,vc],["Shape","","1+",Oc],["Sigmoid","","6+",Zl],["Sin","","7+",Ql],["Slice","","10+",Pc],["Slice","","1-9",Sc,Ac],["Softmax","","1-12",$c,Bc],["Softmax","","13+",Nc,kc],["Split","","2-12",zc,Wc],["Sqrt","","6+",ef],["Squeeze","","1-12",Xi,jc],["Squeeze","","13+",Hc],["Sub","","7+",vl],["Sum","","6+",Yc],["Tan","","7+",tf],["Tanh","","6+",rf],["Tile","","6+",Kc],["Transpose","","1+",Ar,Tf],["Upsample","","7-8",Wi,Tc],["Upsample","","9",Wi,xc],["Unsqueeze","","1-12",Ki,Qc],["Unsqueeze","","13+",Zc],["Xor","","7+",_l]];});function op(e){var t,r={};for(;null!==(t=np.exec(e));){var _e126=t[3].split(",").map(function(e){var t=e.trim().split(" ");return t&&2===t.length?{type:t[0],name:t[1]}:null;}).filter(function(e){return null!==e;});r[t[2]]={params:_e126,body:t[4]};}for(var _n42 in r){var _i32=eg.replace("__FUNC__",_n42),_o20=new RegExp(_i32,"gm");var _loop3=function _loop3(){var i=t[1],o=t[2],a=t[3].split(","),s=i?"".concat(i," ").concat(o,";"):"",u=r[_n42].body,l="";r[_n42].params.forEach(function(e,t){e&&(l+="".concat(e.type," ").concat(e.name," = ").concat(a[t],";\n"));}),u="".concat(l,"\n ").concat(u),u=u.replace("return","".concat(o," = "));var c="\n      ".concat(s,"\n      {\n        ").concat(u,"\n      }\n      ");e=e.replace(t[0],c);};for(;null!==(t=_o20.exec(e));){_loop3();}}return e=e.replace(np,"");}var np,eg,ip=L(function(){np=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm,eg="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;";});function Yr(e,t){var r=[],n=[],i=null!=t&&Array.isArray(t)&&0===t.length,o=null==t||i?null:tg(t,e).sort(),a=0;for(var _t77=0;_t77<e.length;++_t77){if(null!=o){if(o[a]===_t77&&1!==e[_t77])throw new Error("Can't squeeze axis ".concat(_t77," since its dim '").concat(e[_t77],"' is not 1"));(null==o[a]||o[a]>_t77)&&1===e[_t77]&&(r.push(e[_t77]),n.push(_t77)),o[a]<=_t77&&a++;}1!==e[_t77]&&(r.push(e[_t77]),n.push(_t77));}return{newShape:r,keptDims:n};}function tg(e,t){var r=t.length;return e=null==e?t.map(function(e,t){return t;}):[].concat(e),zr(e.every(function(e){return e>=-r&&e<r;}),function(){return"All values in axis param must be in range [-".concat(r,", ").concat(r,") but got axis ").concat(e);}),zr(e.every(rg),function(){return"All values in axis param must be integers but got axis ".concat(e);}),e.map(function(e){return e<0?r+e:e;});}function rg(e){return e%1==0;}function ng(e){if(0===e.length)return 1;var t=e[0];for(var _r115=1;_r115<e.length;_r115++)t*=e[_r115];return t;}function ap(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)];}var yo,Ji=L(function(){dt(),fe(),yo=/*#__PURE__*/function(){function yo(e){_classCallCheck2(this,yo);this.maxTextureSize=e;}return _createClass2(yo,[{key:"computeTextureWH",value:function computeTextureWH(e,t){var r=this.computeTexture(e,t);return t&&t.isPacked&&(r[0]/=2,r[1]/=2),t&&t.reverseWH?[r[1],r[0]]:r;}},{key:"computeTexture",value:function computeTexture(e,t){var r=t&&t.isPacked;if(0===e.length)return r?[2,2]:[1,1];var n=this.maxTextureSize;if(t&&void 0!==t.breakAxis){var _r116=t.breakAxis>=e.length?1:e.slice(t.breakAxis).reduce(function(e,t){return e*t;}),_i33=t.breakAxis<=0?1:e.slice(0,t.breakAxis).reduce(function(e,t){return e*t;});if(!(_r116>n||_i33>n))return[_r116,_i33];pe.verbose("TextureLayout","Given width/height preferences were unattainable: shape:".concat(e,", breakAxis:").concat(t.breakAxis));}var i=e.slice(0);r&&(n*=2,i=i.map(function(e,t){return t>=i.length-2?i[t]%2==0?i[t]:i[t]+1:i[t];}),1===i.length&&(i=[2,i[0]])),2!==i.length&&(i=Yr(i).newShape);var o=ng(i);return i.length<=1&&o<=n?[1,o]:2===i.length&&i[0]<=n&&i[1]<=n?i:3===i.length&&i[0]*i[1]<=n&&i[2]<=n?[i[0]*i[1],i[2]]:3===i.length&&i[0]<=n&&i[1]*i[2]<=n?[i[0],i[1]*i[2]]:4===i.length&&i[0]*i[1]*i[2]<=n&&i[3]<=n?[i[0]*i[1]*i[2],i[3]]:4===i.length&&i[0]<=n&&i[1]*i[2]*i[3]<=n?[i[0],i[1]*i[2]*i[3]]:r?ap(o/4).map(function(e){return 2*e;}):ap(o);}}]);}();}),To,sp=L(function(){fe(),Yt(),ve(),Ji(),Bt(),To=/*#__PURE__*/function(_gt){function To(e){_classCallCheck2(this,To);return _callSuper2(this,To,[e]);}_inherits2(To,_gt);return _createClass2(To,[{key:"getFunctions",value:function getFunctions(){return _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},this.offsetToCoords()),this.coordsToOffset()),this.toVec()),this.valueFrom()),this.getCommonUtilFuncs()),this.getInputsSamplingSnippets()),this.getOutputSamplingSnippet());}},{key:"getCustomTypes",value:function getCustomTypes(){return{};}},{key:"offsetToCoords",value:function offsetToCoords(){return{offsetToCoords:new G("\n      vec2 offsetToCoords(int offset, int width, int height) {\n        int t = offset / width;\n        int s = offset - t*width;\n        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);\n        return coords;\n      }\n      ")};}},{key:"coordsToOffset",value:function coordsToOffset(){return{coordsToOffset:new G("\n      int coordsToOffset(vec2 coords, int width, int height) {\n        float s = coords.s * float(width);\n        float t = coords.t * float(height);\n        int offset = int(t) * width + int(s);\n        return offset;\n      }\n      ")};}},{key:"getOutputSamplingSnippet",value:function getOutputSamplingSnippet(){var e=this.context.outputTextureLayout;return e.isPacked?this.getPackedOutputSamplingSnippet(e):this.getUnpackedOutputSamplingSnippet(e);}},{key:"getPackedOutputSamplingSnippet",value:function getPackedOutputSamplingSnippet(e){var t=e.unpackedShape,r=[e.width,e.height],n={},i="getOutputCoords";switch(t.length){case 0:n[i]=this.getOutputScalarCoords();break;case 1:n[i]=this.getOutputPacked1DCoords(t,r);break;case 2:n[i]=this.getOutputPacked2DCoords(t,r);break;case 3:n[i]=this.getOutputPacked3DCoords(t,r);break;default:n[i]=this.getOutputPackedNDCoords(t,r);}var o="\n      void setOutput(vec4 val) {\n        ".concat(q(this.context.glContext.version).output," = val;\n      }\n    ");return n.floatTextureSetRGBA=new G(o),n;}},{key:"getUnpackedOutputSamplingSnippet",value:function getUnpackedOutputSamplingSnippet(e){var t=e.unpackedShape,r=[e.width,e.height],n={},i="getOutputCoords";switch(t.length){case 0:n[i]=this.getOutputScalarCoords();break;case 1:n[i]=this.getOutputUnpacked1DCoords(t,r);break;case 2:n[i]=this.getOutputUnpacked2DCoords(t,r);break;case 3:n[i]=this.getOutputUnpacked3DCoords(t,r);break;case 4:n[i]=this.getOutputUnpacked4DCoords(t,r);break;case 5:n[i]=this.getOutputUnpacked5DCoords(t,r);break;case 6:n[i]=this.getOutputUnpacked6DCoords(t,r);break;default:throw new Error("Unsupported output dimensionality: ".concat(t.length));}var o="\n        void setOutput(float val) {\n          ".concat(q(this.context.glContext.version).output," = vec4(val, 0, 0, 0);\n        }\n    ");return n.floatTextureSetR=new G(o),n;}},{key:"getOutputScalarCoords",value:function getOutputScalarCoords(){return new G("\n      int getOutputCoords() {\n        return 0;\n      }\n    ");}},{key:"getOutputPacked1DCoords",value:function getOutputPacked1DCoords(e,t){var r=t,n="";return 1===r[0]?(n="\n          int getOutputCoords() {\n            return 2 * int(TexCoords.y * ".concat(r[1],".0);\n          }\n        "),new G(n)):1===r[1]?(n="\n          int getOutputCoords() {\n            return 2 * int(TexCoords.x * ".concat(r[0],".0);\n          }\n        "),new G(n)):(n="\n        int getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                 vec2(".concat(r[0],", ").concat(r[1],"));\n          return 2 * (resTexRC.y * ").concat(r[0]," + resTexRC.x);\n        }\n      "),new G(n));}},{key:"getOutputPacked2DCoords",value:function getOutputPacked2DCoords(e,t){var r="";if(xr.arraysEqual(e,t))return r="\n        ivec2 getOutputCoords() {\n          return 2 * ivec2(TexCoords.xy * vec2(".concat(t[0],", ").concat(t[1],"));\n        }\n      "),new G(r);var n=t,i=Math.ceil(e[1]/2);return r="\n        ivec2 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(".concat(n[0],", ").concat(n[1],"));\n\n          int index = resTexRC.y * ").concat(n[0]," + resTexRC.x;\n\n          // reverse r and c order for packed texture\n          int r = imod(index, ").concat(i,") * 2;\n          int c = 2 * (index / ").concat(i,");\n\n          return ivec2(r, c);\n        }\n      "),new G(r);}},{key:"getOutputPacked3DCoords",value:function getOutputPacked3DCoords(e,t){var r=[t[0],t[1]],n=Math.ceil(e[2]/2),i=n*Math.ceil(e[1]/2);return new G("\n        ivec3 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(".concat(r[0],", ").concat(r[1],"));\n          int index = resTexRC.y * ").concat(r[0]," + resTexRC.x;\n\n          int b = index / ").concat(i,";\n          index -= b * ").concat(i,";\n\n          // reverse r and c order for packed texture\n          int r = imod(index, ").concat(n,") * 2;\n          int c = 2 * (index / ").concat(n,");\n\n          return ivec3(b, r, c);\n        }\n      "));}},{key:"getOutputPackedNDCoords",value:function getOutputPackedNDCoords(e,t){var r=[t[0],t[1]],n=Math.ceil(e[e.length-1]/2),i=n*Math.ceil(e[e.length-2]/2),o=i,a="",s="b, r, c";for(var _t78=2;_t78<e.length-1;_t78++)o*=e[e.length-_t78-1],a="\n      int b".concat(_t78," = index / ").concat(o,";\n      index -= b").concat(_t78," * ").concat(o,";\n    ")+a,s="b".concat(_t78,", ")+s;var u="\n      ivec".concat(e.length," getOutputCoords() {\n        ivec2 resTexRC = ivec2(TexCoords.xy *\n                              vec2(").concat(r[0],", ").concat(r[1],"));\n        int index = resTexRC.y * ").concat(r[0]," + resTexRC.x;\n\n        ").concat(a,"\n\n        int b = index / ").concat(i,";\n        index -= b * ").concat(i,";\n\n        // reverse r and c order for packed texture\n        int r = imod(index, ").concat(n,") * 2;\n        int c = 2 * (index / ").concat(n,");\n\n        return ivec").concat(e.length,"(").concat(s,");\n      }\n    ");return new G(u);}},{key:"getOutputUnpacked1DCoords",value:function getOutputUnpacked1DCoords(e,t){var r="\n        int getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(".concat(t[0],", ").concat(t[1],"));\n          return resTexRC.y * ").concat(t[0]," + resTexRC.x;\n        }\n      ");return new G(r);}},{key:"getOutputUnpacked2DCoords",value:function getOutputUnpacked2DCoords(e,t){var r="\n        ivec2 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(".concat(t[0],", ").concat(t[1],"));\n          int index = resTexRC.y * ").concat(t[0]," + resTexRC.x;\n          int r = index / ").concat(e[1],";\n          int c = index - r * ").concat(e[1],";\n          return ivec2(r, c);\n        }\n      ");return new G(r);}},{key:"getOutputUnpacked3DCoords",value:function getOutputUnpacked3DCoords(e,t){var r="",n=e.length,i=null;n<2&&(i=[]),i=new Array(n-1),i[n-2]=e[n-1];for(var _t79=n-3;_t79>=0;--_t79)i[_t79]=i[_t79+1]*e[_t79+1];var o=["r","c","d"],a=i.map(function(e,t){return"".concat("int ".concat(o[t]," = index / ").concat(e),"; ",t===i.length-1?"int ".concat(o[t+1]," = index - ").concat(o[t]," * ").concat(e):"index -= ".concat(o[t]," * ").concat(e),";");}).join("");return r="\n        ivec3 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(".concat(t[0],", ").concat(t[1],"));\n          int index = resTexRC.y * ").concat(t[0]," + resTexRC.x;\n          ").concat(a,"\n          return ivec3(r, c, d);\n        }\n      "),new G(r);}},{key:"getOutputUnpacked4DCoords",value:function getOutputUnpacked4DCoords(e,t){var r="",n=e.length,i=null;n<2&&(i=[]),i=new Array(n-1),i[n-2]=e[n-1];for(var _t80=n-3;_t80>=0;--_t80)i[_t80]=i[_t80+1]*e[_t80+1];var o=["r","c","d","d2"],a=i.map(function(e,t){return"".concat("int ".concat(o[t]," = index / ").concat(e),"; ",t===i.length-1?"int ".concat(o[t+1]," = index - ").concat(o[t]," * ").concat(e):"index -= ".concat(o[t]," * ").concat(e),";");}).join("");return r="\n      ivec4 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(".concat(t[0],", ").concat(t[1],"));\n          int index = resTexRC.y * ").concat(t[0]," + resTexRC.x;\n          ").concat(a,"\n          return ivec4(r, c, d, d2);\n        }\n      "),new G(r);}},{key:"getOutputUnpacked5DCoords",value:function getOutputUnpacked5DCoords(e,t){var r="",n=e.length,i=null;n<2&&(i=[]),i=new Array(n-1),i[n-2]=e[n-1];for(var _t81=n-3;_t81>=0;--_t81)i[_t81]=i[_t81+1]*e[_t81+1];var o=["r","c","d","d2","d3"],a=i.map(function(e,t){return"".concat("int ".concat(o[t]," = index / ").concat(e),"; ",t===i.length-1?"int ".concat(o[t+1]," = index - ").concat(o[t]," * ").concat(e):"index -= ".concat(o[t]," * ").concat(e),";");}).join("");return r="\n      ivec5 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(".concat(t[0],", ").concat(t[1],"));\n          int index = resTexRC.y * ").concat(t[0]," + resTexRC.x;\n          ").concat(a,"\n          return ivec5(r, c, d, d2, d3);\n        }\n      "),new G(r);}},{key:"getOutputUnpacked6DCoords",value:function getOutputUnpacked6DCoords(e,t){var r="",n=e.length,i=null;n<2&&(i=[]),i=new Array(n-1),i[n-2]=e[n-1];for(var _t82=n-3;_t82>=0;--_t82)i[_t82]=i[_t82+1]*e[_t82+1];var o=["r","c","d","d2","d3","d4"],a=i.map(function(e,t){return"".concat("int ".concat(o[t]," = index / ").concat(e),"; ",t===i.length-1?"int ".concat(o[t+1]," = index - ").concat(o[t]," * ").concat(e):"index -= ".concat(o[t]," * ").concat(e),";");}).join("");return r="\n     ivec6 getOutputCoords() {\n         ivec2 resTexRC = ivec2(TexCoords.xy *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n         int index = resTexRC.y * ").concat(t[0]," + resTexRC.x;\n         ").concat(a,"\n         return ivec6(r, c, d, d2, d3, d4);\n       }\n     "),new G(r);}},{key:"getCommonUtilFuncs",value:function getCommonUtilFuncs(){var e={},t="uvFromFlat";e[t]=new G("\n    vec2 uvFromFlat(int texNumR, int texNumC, int index) {\n      int texC = index / texNumR;\n      int texR = index - texC * texNumR;\n      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to\n      //       v.\n      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);\n    }\n    "),t="packedUVfrom1D",e[t]=new G("\n      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n        int texelIndex = index / 2;\n        int texR = texelIndex / texNumC;\n        int texC = texelIndex - texR * texNumC;\n        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n      }\n      "),t="packedUVfrom2D",e[t]=new G("\n      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {\n        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n        int texR = texelIndex / texNumC;\n        int texC = texelIndex - texR * texNumC;\n        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n      }\n      "),t="packedUVfrom3D",e[t]=new G("\n      vec2 packedUVfrom3D(int texNumR, int texNumC,\n          int texelsInBatch, int texelsInLogicalRow, int b,\n          int row, int col) {\n        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n        int texR = index / texNumC;\n        int texC = index - texR * texNumC;\n        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n      }\n      "),t="sampleTexture";var r=q(this.context.glContext.version);return e[t]=new G("\n        float sampleTexture(sampler2D textureSampler, vec2 uv) {\n            return ".concat(r.texture2D,"(textureSampler, uv).r;\n        }")),e;}},{key:"getInputsSamplingSnippets",value:function getInputsSamplingSnippets(){var _this6=this;var e={},t=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach(function(r,n){var i=_this6.context.inputTextureLayouts[n],o=no(r);i.isPacked?e[o]=_this6.getPackedSamplerFromInput(o,r,i):e[o]=_this6.getUnpackedSamplerFromInput(o,r,i);var a=qu(r);i.unpackedShape.length<=t.unpackedShape.length&&(i.isPacked?e[a]=_this6.getPackedSamplerAtOutputCoords(a,i,t,r):e[a]=_this6.getUnpackedSamplerAtOutputCoords(a,i,t,r));}),e;}},{key:"getPackedSamplerAtOutputCoords",value:function getPackedSamplerAtOutputCoords(e,t,r,n){var i,o=t.unpackedShape,a=r.unpackedShape,s=no(n),u=o.length,l=a.length,c=Ke.getBroadcastDims(o,a),h=Je(l),f=l-u,d=Dt();i=0===u?"":l<2&&c.length>=1?"coords = 0;":c.map(function(e){return"coords.".concat(d[e+f]," = 0;");}).join("\n");var p="";p=l<2&&u>0?"coords":o.map(function(e,t){return"coords.".concat(d[t+f]);}).join(", ");var y="return outputValue;",m=1===z.size(o),g=1===z.size(a);if(1!==u||m||g){if(m&&!g)y=1===l?"\n          return vec4(outputValue.x, outputValue.x, 0., 0.);\n        ":"\n          return vec4(outputValue.x);\n        ";else if(c.length){var _e127=u-2,_t83=u-1;c.indexOf(_e127)>-1&&c.indexOf(_t83)>-1?y="return vec4(outputValue.x);":c.indexOf(_e127)>-1?y="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":c.indexOf(_t83)>-1&&(y="return vec4(outputValue.xx, outputValue.zz);");}}else y="\n        return vec4(outputValue.xy, outputValue.xy);\n      ";var w="\n        int lastDim = coords.".concat(d[l-1],";\n        coords.").concat(d[l-1]," = coords.").concat(d[l-2],";\n        coords.").concat(d[l-2]," = lastDim;\n      ");return new G("\n      vec4 ".concat(e,"() {\n        ").concat(h," coords = getOutputCoords();\n        ").concat(w,"\n        ").concat(i,"\n        vec4 outputValue = ").concat(s,"(").concat(p,");\n        ").concat(y,"\n      }\n    "),["coordinates.getOutputCoords"]);}},{key:"getUnpackedSamplerAtOutputCoords",value:function getUnpackedSamplerAtOutputCoords(e,t,r,n){var i=[r.width,r.height],o=[t.width,t.height],a=t.unpackedShape.length,s=r.unpackedShape.length,u=t.unpackedShape,l=r.unpackedShape,c=no(n);if(a===s&&xr.arraysEqual(o,i)){return new G("\n          float ".concat(e,"() {\n            return sampleTexture(").concat(n,", TexCoords);\n          }\n        "),["coordinates.sampleTexture"]);}var h,f=Je(s),d=Ke.getBroadcastDims(u,l),p=s-a,y=Dt();h=0===a?"":s<2&&d.length>=1?"coords = 0;":d.map(function(e){return"coords.".concat(y[e+p]," = 0;");}).join("\n");var m="";return m=s<2&&a>0?"coords":t.unpackedShape.map(function(e,t){return"coords.".concat(y[t+p]);}).join(", "),new G("\n        float ".concat(e,"() {\n          ").concat(f," coords = getOutputCoords();\n          ").concat(h,"\n          return ").concat(c,"(").concat(m,");\n        }\n      "),["coordinates.getOutputCoords"]);}},{key:"getPackedSamplerFromInput",value:function getPackedSamplerFromInput(e,t,r){switch(r.unpackedShape.length){case 0:return this.getPackedSamplerScalar(e,t);case 1:return this.getPackedSampler1D(e,t,r);case 2:return this.getPackedSampler2D(e,t,r);case 3:return this.getPackedSampler3D(e,t,r);default:return this.getPackedSamplerND(e,t,r);}}},{key:"getUnpackedSamplerFromInput",value:function getUnpackedSamplerFromInput(e,t,r){var n=r.unpackedShape;switch(n.length){case 0:return this.getUnpackedSamplerScalar(e,t,r);case 1:return this.getUnpackedSampler1D(e,t,r);case 2:return this.getUnpackedSampler2D(e,t,r);case 3:return this.getUnpackedSampler3D(e,t,r);case 4:return this.getUnpackedSampler4D(e,t,r);case 5:return this.getUnpackedSampler5D(e,t,r);case 6:return this.getUnpackedSampler6D(e,t,r);default:throw new Error("Unsupported dimension ".concat(n.length,"-D"));}}},{key:"getPackedSamplerScalar",value:function getPackedSamplerScalar(e,t){var r="\n          vec4 ".concat(e,"() {\n            return ").concat(q(this.context.glContext.version).texture2D,"(").concat(t,", halfCR);\n          }\n        ");return new G(r);}},{key:"getPackedSampler1D",value:function getPackedSampler1D(e,t,r){var n=[r.width,r.height],i=[n[1],n[0]],o=q(this.context.glContext.version),a="vec4 ".concat(e,"(int index) {\n      vec2 uv = packedUVfrom1D(\n      ").concat(i[0],", ").concat(i[1],", index);\n      return ").concat(o.texture2D,"(").concat(t,", uv);\n    }");return new G(a,["coordinates.packedUVfrom1D"]);}},{key:"getPackedSampler2D",value:function getPackedSampler2D(e,t,r){var n=r.unpackedShape,i=[r.width,r.height],o=q(this.context.glContext.version),a=i[0],s=i[1];if(null!=i&&xr.arraysEqual(n,i)){var _r117="vec4 ".concat(e,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(a,".0);\n        return ").concat(o.texture2D,"(").concat(t,", uv);\n      }");return new G(_r117);}var u=i,l=Math.ceil(n[1]/2),c="vec4 ".concat(e,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(u[1],", ").concat(u[0],", ").concat(l,", row, col);\n      return ").concat(o.texture2D,"(").concat(t,", uv);\n    }");return new G(c,["coordinates.packedUVfrom2D"]);}},{key:"getPackedSampler3D",value:function getPackedSampler3D(e,t,r){var n=r.unpackedShape,i=[r.width,r.height],o=[i[0],i[1]],a=q(this.context.glContext.version);if(1===n[0]){var _i34=n.slice(1),_o21=[1,2],_a12=Wr(n,_i34),_s12=["b","row","col"],_u12=JSON.parse(JSON.stringify(r));_u12.unpackedShape=_a12;var _l9=this.getPackedSamplerFromInput(e,t,_u12),_c9="".concat(_l9.routineBody,"\n      vec4 ").concat(e,"(int b, int row, int col) {\n        return ").concat(e,"(").concat(Vr(_s12,_o21),");\n      } ");return new G(_c9,_l9.dependencies);}var s=o[0],u=o[1],l=Math.ceil(n[2]/2),c="vec4 ".concat(e,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(u,", ").concat(s,", ").concat(l*Math.ceil(n[1]/2),", ").concat(l,", b, row, col);\n      return ").concat(a.texture2D,"(").concat(t,", uv);}");return new G(c,["coordinates.packedUVfrom3D"]);}},{key:"getPackedSamplerND",value:function getPackedSamplerND(e,t,r){var n=r.unpackedShape,i=n.length,o=[r.width,r.height],a=q(this.context.glContext.version),s=[o[0],o[1]],u=s[1],l=s[0],c=Math.ceil(n[i-1]/2),h=c*Math.ceil(n[i-2]/2),f="int b, int row, int col",d="b * ".concat(h," + (row / 2) * ").concat(c," + (col / 2)");for(var _e128=2;_e128<i-1;_e128++)f="int b".concat(_e128,", ")+f,h*=n[i-_e128-1],d="b".concat(_e128," * ").concat(h," + ")+d;var p="vec4 ".concat(e,"(").concat(f,") {\n      int index = ").concat(d,";\n      int texR = index / ").concat(l,";\n      int texC = index - texR * ").concat(l,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(l,", ").concat(u,");\n      return ").concat(a.texture2D,"(").concat(t,", uv);\n    }");return new G(p);}},{key:"getUnpackedSamplerScalar",value:function getUnpackedSamplerScalar(e,t,r){var _ref8=[r.width,r.height],n=_ref8[0],i=_ref8[1];if(1===n&&1===i){return new G("\n          float ".concat(e,"() {\n            return sampleTexture(").concat(t,", halfCR);\n          }\n        "),["coordinates.sampleTexture"]);}return new G("\n        float ".concat(e,"() {\n          int offset_").concat(t," = coordsToOffset(TexCoords, ").concat(n,", ").concat(i,");\n          vec2 uv = uvFromFlat(").concat(n,", ").concat(i,", offset_").concat(t,");\n          return sampleTexture(").concat(t,", uv);\n        }\n      "),["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"]);}},{key:"getUnpackedSampler1D",value:function getUnpackedSampler1D(e,t,r){var n=r.width,i=r.height;if(1===i&&1===n){return new G("\n        float ".concat(e,"(int index) {\n          return sampleTexture(").concat(t,", halfCR);\n        }\n      "),["coordinates.sampleTexture"]);}if(1===i){return new G("\n          float ".concat(e,"(int index) {\n            vec2 uv = vec2((float(index) + 0.5) / ").concat(n,".0, 0.5);\n            return sampleTexture(").concat(t,", uv);\n          }\n        "),["coordinates.sampleTexture"]);}if(1===n){return new G("\n          float ".concat(e,"(int index) {\n            vec2 uv = vec2(0.5, (float(index) + 0.5) / ").concat(i,".0);\n            return sampleTexture(").concat(t,", uv);\n          }\n        "),["coordinates.sampleTexture"]);}return new G("\n        float ".concat(e,"(int index) {\n          vec2 uv = uvFromFlat(").concat(n,", ").concat(i,", index);\n          return sampleTexture(").concat(t,", uv);\n        }\n      "),["coordinates.uvFromFlat","coordinates.sampleTexture"]);}},{key:"getUnpackedSampler2D",value:function getUnpackedSampler2D(e,t,r){var n=r.unpackedShape,i=[r.height,r.width];if(null!=i&&xr.arraysEqual(n,i)){return new G("\n          float ".concat(e,"(int row, int col) {\n            vec2 uv = (vec2(row, col) + halfCR) / vec2(").concat(i[1],".0, ").concat(i[0],".0);\n            return sampleTexture(").concat(t,", uv);\n          }\n        "),["coordinates.sampleTexture"]);}var _Yr=Yr(n),o=_Yr.newShape,a=_Yr.keptDims,s=o;if(s.length<n.length){var _i35=Wr(n,s),_o22=JSON.parse(JSON.stringify(r));_o22.unpackedShape=_i35;var _u13=["col","row"],_l10="\n          ".concat(this.getUnpackedSamplerFromInput(e,t,_o22).routineBody,"\n          float ").concat(e,"(int row, int col) {\n            return ").concat(e,"(").concat(Vr(_u13,a),");\n          }\n        ");return new G(_l10,["coordinates.sampleTexture"]);}var u=i[1],l=i[0];if(1===l){var _r118="\n          float ".concat(e,"(int row, int col) {\n            int offset_").concat(t," = coordsToOffset(TexCoords, ").concat(u,", ").concat(l,");\n            float index = dot(vec3(row, col, offset_").concat(t,"), vec3(").concat(n[1],", 1, 1));\n            vec2 uv = vec2(0.5, (index + 0.5) / ").concat(u,".0);\n            return sampleTexture(").concat(t,", uv);\n          }\n        ");return new G(_r118,["coordinates.sampleTexture","coordinates.coordsToOffset"]);}if(1===u){var _r119="\n          float ".concat(e,"(int row, int col) {\n            int offset_").concat(t," = coordsToOffset(TexCoords, ").concat(u,", ").concat(l,");\n            float index = dot(vec3(row, col, offset_").concat(t,"), vec3(").concat(n[1],", 1, 1));\n            vec2 uv = vec2((index + 0.5) / ").concat(l,".0, 0.5);\n            return sampleTexture(").concat(t,", uv);\n          }\n        ");return new G(_r119,["coordinates.sampleTexture","coordinates.coordsToOffset"]);}var c="\n        float ".concat(e,"(int row, int col) {\n          int index = col * ").concat(n[1]," + row;\n          vec2 uv = uvFromFlat(").concat(u,", ").concat(l,", index);\n          return sampleTexture(").concat(t,", uv);\n        }\n      ");return new G(c,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"]);}},{key:"getUnpackedSampler3D",value:function getUnpackedSampler3D(e,t,r){var n=r.unpackedShape,i=n[1]*n[2],o=n[2],_Yr2=Yr(n),a=_Yr2.newShape,s=_Yr2.keptDims,u=a;if(u.length<n.length){var _i36=Wr(n,u),_o23=["batch","col","row"],_a13=JSON.parse(JSON.stringify(r));_a13.unpackedShape=_i36;var _l11=this.getUnpackedSamplerFromInput(e,t,_a13),_c10=s.reverse(),_h9="\n          ".concat(_l11.routineBody,"\n          float ").concat(e,"(int batch, int row, int col) {\n            return ").concat(e,"(").concat(Vr(_o23,_c10),");\n          }\n        ");return new G(_h9,_l11.dependencies);}var l=r.width,c=r.height;return new G("\n          float ".concat(e,"(int depth, int row, int col) {\n            // Explicitly use integer operations as dot() only works on floats.\n            int index = depth * ").concat(i," + col * ").concat(o," + row;\n            vec2 uv = uvFromFlat(").concat(l,", ").concat(c,", index);\n            return sampleTexture(").concat(t,", uv);\n          }\n      "),["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"]);}},{key:"getUnpackedSampler4D",value:function getUnpackedSampler4D(e,t,r){var n=r.unpackedShape,i=n[3],o=n[2]*i,a=n[1]*o,s=r.width,u=r.height;return new G("\n        float ".concat(e,"(int row, int col, int depth, int depth2) {\n          int index = row * ").concat(a," + col * ").concat(o," +\n              depth2 * ").concat(i," + depth;\n          vec2 uv = uvFromFlat(").concat(s,", ").concat(u,", index);\n          return sampleTexture(").concat(t,", uv);\n        }\n      "),["coordinates.uvFromFlat","coordinates.sampleTexture"]);}},{key:"getUnpackedSampler5D",value:function getUnpackedSampler5D(e,t,r){var n=r.unpackedShape,i=n[4],o=n[3]*i,a=n[2]*o,s=n[1]*a,_Yr3=Yr(n),u=_Yr3.newShape,l=_Yr3.keptDims;if(u.length<n.length){var _i37=Wr(n,u),_o24=["row","col","depth","depth2","depth3"],_a14=JSON.parse(JSON.stringify(r));_a14.unpackedShape=_i37;var _s13="\n          ".concat(this.getUnpackedSamplerFromInput(e,t,_a14).routineBody,"\n          float ").concat(e,"(int row, int col, int depth, int depth2, int depth3) {\n            return ").concat(e,"(").concat(Vr(_o24,l),");\n          }\n        ");return new G(_s13,["coordinates.sampleTexture","coordinates.uvFromFlat"]);}var c=r.width,h=r.height;return new G("\n        float ".concat(e,"(int row, int col, int depth, int depth2, int depth3) {\n          int index = row * ").concat(s," + col * ").concat(a," + depth * ").concat(o," +\n          depth3 * ").concat(i," + depth2;\n          vec2 uv = uvFromFlat(").concat(c,", ").concat(h,", index);\n          return sampleTexture(").concat(t,", uv);\n        }\n      "),["coordinates.sampleTexture","coordinates.uvFromFlat"]);}},{key:"getUnpackedSampler6D",value:function getUnpackedSampler6D(e,t,r){var n=r.unpackedShape,i=n[5],o=n[4]*i,a=n[3]*o,s=n[2]*a,u=n[1]*s,_Yr4=Yr(n),l=_Yr4.newShape,c=_Yr4.keptDims;if(l.length<n.length){var _i38=Wr(n,l),_o25=["row","col","depth","depth2","depth3","depth4"],_a15=JSON.parse(JSON.stringify(r));_a15.unpackedShape=_i38;var _s14="\n            ".concat(this.getUnpackedSamplerFromInput(e,t,_a15).routineBody,"\n            float ").concat(e,"(int row, int col, int depth,\n              int depth2, int depth3, int depth4) {\n              return ").concat(e,"(").concat(Vr(_o25,c),");\n            }\n          ");return new G(_s14,["coordinates.sampleTexture","coordinates.uvFromFlat"]);}var h=r.width,f=r.height;return new G("\n          float ".concat(e,"(int row, int col, int depth,\n            int depth2, int depth3, int depth4) {\n            int index = row * ").concat(u," + col * ").concat(s," + depth * ").concat(a," +\n            depth2 * ").concat(o," + depth3 * ").concat(i," + depth4;\n            vec2 uv = uvFromFlat(").concat(h,", ").concat(f,", index);\n            return sampleTexture(").concat(t,", uv);\n          }\n        "),["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"]);}},{key:"toVec",value:function toVec(){var e=this.context.outputTextureLayout,t=e.shape.length,r=e.strides,n=e.width,i=e.height,o=[];for(var _e129=0;_e129<t-1;++_e129)o.push("\n        c[".concat(_e129,"] = offset / ").concat(r[_e129],";")),o.push("\n        offset -= c[".concat(_e129,"] * ").concat(r[_e129],";"));o.push("\n        c[".concat(t-1,"] = offset;"));var a="\n      void toVec(vec2 texCoords, out int c[".concat(t,"]) {\n        int offset = coordsToOffset(texCoords, ").concat(n,", ").concat(i,");\n        ").concat(o.join(""),"\n      }\n      void toVec(int offset, out int c[").concat(t,"]) {\n        ").concat(o.join(""),"\n      }\n    ");return{toVec:new G(a,["coordinates.coordsToOffset"])};}},{key:"valueFrom",value:function valueFrom(){var _this7=this;var e={};return this.context.programInfo.inputNames.forEach(function(t,r){var n=_this7.context.inputTextureLayouts[r],i=(n.unpackedShape.length>0?n.unpackedShape:n.shape).length,o="_".concat(t);e[o]=new G(_this7.getValueFromSingle(t,i,n.width,n.height,!1),["shapeUtils.indicesToOffset".concat(o),"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),o+="_T",e[o]=new G(_this7.getValueFromSingle(t,i,n.width,n.height,!0),["shapeUtils.indicesToOffset".concat(o),"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]);}),e;}},{key:"getValueFromSingle",value:function getValueFromSingle(e,t,r,n,i){var o="_".concat(e);return i&&(o+="_T"),"\n        float ".concat(o,"(int m[").concat(t,"]) {\n          int offset = indicesToOffset").concat(o,"(m);\n          vec2 coords = offsetToCoords(offset, ").concat(r,", ").concat(n,");\n          float value = getColorAsFloat(").concat(q(this.context.glContext.version).texture2D,"(").concat(e,", coords));\n          return value;\n        }\n        ");}},{key:"getPackedValueFrom",value:function getPackedValueFrom(e,t,r,n,i){var o="_".concat(e,"_Pack");return i&&(o+="_T"),"\n        vec4 ".concat(o,"(int m[").concat(t,"]) {\n          int offset = indicesToOffset_").concat(e,"(m);\n          vec2 coords = offsetToCoords(offset, ").concat(r,", ").concat(n,");\n          return ").concat(q(this.context.glContext.version).texture2D,"(").concat(e,", coords);\n        }\n        ");}}]);}(gt);}),xo,up=L(function(){Yt(),xo=/*#__PURE__*/function(_gt2){function e(_e130){_classCallCheck2(this,e);return _callSuper2(this,e,[_e130]);}_inherits2(e,_gt2);return _createClass2(e,[{key:"getFunctions",value:function getFunctions(){return _objectSpread(_objectSpread({},this.encodeFloat32()),this.decodeFloat32());}},{key:"getCustomTypes",value:function getCustomTypes(){return{};}},{key:"encodeFloat32",value:function encodeFloat32(){return{encode:new G("highp vec4 encode(highp float f) {\n        return vec4(f, 0.0, 0.0, 0.0);\n      }\n        ")};}},{key:"decodeFloat32",value:function decodeFloat32(){return{decode:new G("highp float decode(highp vec4 rgba) {\n        return rgba.r;\n      }\n        ")};}},{key:"encodeUint8",value:function encodeUint8(){var t=e.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new G("\n      highp vec4 encode(highp float f) {\n        highp float F = abs(f);\n        highp float Sign = step(0.0,-f);\n        highp float Exponent = floor(log2(F));\n        highp float Mantissa = (exp2(- Exponent) * F);\n        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));\n        highp vec4 rgba;\n        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));\n        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);\n        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));\n        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));\n        ".concat(t,"\n        rgba = rgba / 255.0; // values need to be normalized to [0,1]\n        return rgba;\n    }\n        "))};}},{key:"decodeUint8",value:function decodeUint8(){var t=e.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new G("\n        highp float decode(highp vec4 rgba) {\n          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]\n          ".concat(t,"\n          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;\n          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;\n          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);\n          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));\n          return Result;\n      }\n        "))};}}],[{key:"isLittleEndian",value:function isLittleEndian(){var _e131=new ArrayBuffer(4),t=new Uint32Array(_e131),r=new Uint8Array(_e131);if(t[0]=3735928559,239===r[0])return!0;if(222===r[0])return!1;throw new Error("unknown endianness");}}]);}(gt);}),wo,lp=L(function(){Yt(),ve(),wo=/*#__PURE__*/function(_gt3){function wo(e){_classCallCheck2(this,wo);return _callSuper2(this,wo,[e]);}_inherits2(wo,_gt3);return _createClass2(wo,[{key:"getFunctions",value:function getFunctions(){return _objectSpread(_objectSpread({},this.setFragColor()),this.getColorAsFloat());}},{key:"getCustomTypes",value:function getCustomTypes(){return{};}},{key:"setFragColor",value:function setFragColor(){var e=q(this.context.glContext.version);return{setFragColor:new G("\n        void setFragColor(float value) {\n            ".concat(e.output," = encode(value);\n        }\n        "),["encoding.encode"])};}},{key:"getColorAsFloat",value:function getColorAsFloat(){return{getColorAsFloat:new G("\n        float getColorAsFloat(vec4 color) {\n            return decode(color);\n        }\n        ",["encoding.decode"])};}}]);}(gt);}),vo,fp=L(function(){Yt(),vo=/*#__PURE__*/function(_gt4){function e(_e132){_classCallCheck2(this,e);return _callSuper2(this,e,[_e132]);}_inherits2(e,_gt4);return _createClass2(e,[{key:"getFunctions",value:function getFunctions(){return _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},this.bcastIndex()),this.bcastMatmulIndex()),this.offsetToIndices()),this.indicesToOffset()),this.incrementIndices());}},{key:"getCustomTypes",value:function getCustomTypes(){return{};}},{key:"bcastIndex",value:function bcastIndex(){var _this8=this;var _e133=this.context.outputTextureLayout.shape.length,t={};return this.context.programInfo.inputNames.forEach(function(r,n){var i=_this8.context.inputTextureLayouts[n].unpackedShape;if(i.length<=_e133){var _n43=i.length,_o26=_e133-_n43,_a16="bcastIndices_".concat(r),_s15="";for(var _e143=0;_e143<_n43;++_e143)_s15+="\n          realIndices[".concat(_e143,"] = int( mod(float(bcastedIndices[").concat(_o26+_e143,"]), ").concat(i[_e143],".0) );\n          ");var _u14="\n        void ".concat(_a16," (int bcastedIndices[").concat(_e133,"], out int realIndices[").concat(_n43,"]) {\n          ").concat(_s15,"\n        }\n        ");t[_a16]=new G(_u14);}}),t;}},{key:"bcastMatmulIndex",value:function bcastMatmulIndex(){var _this9=this;var _e135=this.context.outputTextureLayout.shape.length,t={};return this.context.programInfo.inputNames.forEach(function(r,n){var i=_this9.context.inputTextureLayouts[n].shape;if(!(i.length<2||i.length>_e135)){var _n44=i.length,_o27=_e135-_n44,_a17="bcastMatmulIndices_".concat(r),_s16="";for(var _e144=0;_e144<_n44-2;++_e144)_s16+="\n          realIndices[".concat(_e144,"] = int( mod(float(bcastedIndices[").concat(_o27+_e144,"]), ").concat(i[_e144],".0) );\n          ");var _u15="\n        void ".concat(_a17,"(int bcastedIndices[").concat(_e135,"], out int realIndices[").concat(_n44,"]) {\n          ").concat(_s16,"\n          realIndices[").concat(_n44-1,"] = bcastedIndices[").concat(_e135-1,"];\n          realIndices[").concat(_n44-2,"] = bcastedIndices[").concat(_e135-2,"];\n        }\n        ");t[_a17]=new G(_u15);}}),t;}},{key:"indicesToOffset",value:function indicesToOffset(){var _this10=this;var t={};return this.context.programInfo.inputNames.forEach(function(r,n){var i=_this10.context.inputTextureLayouts[n].shape,o=_this10.context.inputTextureLayouts[n].strides,a=i.length,s="indicesToOffset_".concat(r);t[s]=new G(e.indexToOffsetSingle(s,a,o)),s="indicesToOffset_".concat(r,"_T"),t[s]=new G(e.indexToOffsetSingle(s,a,o.slice().reverse()));}),t;}},{key:"offsetToIndices",value:function offsetToIndices(){var _this11=this;var t={};return this.context.programInfo.inputNames.forEach(function(r,n){var i=_this11.context.inputTextureLayouts[n].shape,o=_this11.context.inputTextureLayouts[n].strides,a=i.length,s="offsetToIndices_".concat(r);t[s]=new G(e.offsetToIndicesSingle(s,a,o)),s="offsetToIndices_".concat(r,"_T"),t[s]=new G(e.offsetToIndicesSingle(s,a,o.slice().reverse()));}),t;}},{key:"incrementIndices",value:function incrementIndices(){var _this12=this;var _e141={};return this.context.programInfo.inputNames.forEach(function(t,r){var n=_this12.context.inputTextureLayouts[r].shape,i=n.length,o="incrementIndices_".concat(t),a="";for(var _e145=0;_e145<i;++_e145)a+="\n        shape[".concat(_e145,"] = ").concat(n[_e145],";");var s="\n        void ".concat(o,"(int axis, out int indices[").concat(i,"]) {\n          int shape[").concat(i,"];\n          ").concat(a,";\n          for(int i = ").concat(i," -1 ; i >= 0; --i) {\n            if(i > axis) continue;\n            indices[i] += 1;\n            if(indices[i] < shape[i]) {\n              break;\n            }\n            indices[i] = 0;\n          }\n        }\n        ");_e141[o]=new G(s);}),_e141;}}],[{key:"indexToOffsetSingle",value:function indexToOffsetSingle(_e137,t,r){var n="";for(var _e146=t-1;_e146>=0;--_e146)n+="\n        offset += indices[".concat(_e146,"] * ").concat(r[_e146],";\n        ");return"\n      int ".concat(_e137,"(int indices[").concat(t,"]) {\n        int offset = 0;\n        ").concat(n,"\n        return offset;\n      }\n      ");}},{key:"offsetToIndicesSingle",value:function offsetToIndicesSingle(_e139,t,r){var n=[];for(var _e147=0;_e147<t-1;++_e147)n.push("\n      indices[".concat(_e147,"] = offset / ").concat(r[_e147],";")),n.push("\n        offset -= indices[".concat(_e147,"] * ").concat(r[_e147],";"));return n.push("\n      indices[".concat(t-1,"] = offset;")),"\n      void ".concat(_e139,"(int offset, out int indices[").concat(t,"]) {\n        ").concat(n.join(""),"\n      }\n      ");}}]);}(gt);}),_o,cp=L(function(){Yt(),_o=/*#__PURE__*/function(_gt5){function _o(e){_classCallCheck2(this,_o);return _callSuper2(this,_o,[e]);}_inherits2(_o,_gt5);return _createClass2(_o,[{key:"getCustomTypes",value:function getCustomTypes(){return{};}},{key:"getFunctions",value:function getFunctions(){return _objectSpread(_objectSpread(_objectSpread(_objectSpread({},this.binaryVecFunctions()),this.copyVec()),this.setVecItem()),this.getVecItem());}},{key:"binaryVecFunctions",value:function binaryVecFunctions(){var e=this.context.outputTextureLayout.shape.length,t={add:"+=",sub:"-=",mul:"*=",div:"/="},r={};for(var _n45 in t){var _i39="".concat(_n45,"Vec"),_o28="";for(var _r120=0;_r120<e;++_r120)_o28+="\n          dest[".concat(_r120,"] ").concat(t[_n45]," src[").concat(_r120,"];\n          ");var _a18="\n        void ".concat(_i39,"(int src[").concat(e,"], out int dest[").concat(e,"]) {\n          ").concat(_o28,"\n        }\n        ");r[_i39]=new G(_a18);}return r;}},{key:"copyVec",value:function copyVec(){var e=this.context.outputTextureLayout.shape.length,t="";for(var _r121=0;_r121<e;++_r121)t+="\n        dest[".concat(_r121,"] = src[").concat(_r121,"];\n        ");return{copyVec:new G("\n      void copyVec(int src[".concat(e,"], out int dest[").concat(e,"]) {\n        ").concat(t,"\n      }\n      "))};}},{key:"setVecItem",value:function setVecItem(){var e=this.context.outputTextureLayout.shape.length,t="\n        if(index < 0)\n            index =".concat(e," + index;\n        if (index == 0)\n            m[0] = value;\n        ");for(var _r122=1;_r122<e-1;++_r122)t+="\n        else if (index == ".concat(_r122,")\n            m[").concat(_r122,"] = value;\n            ");return t+="\n        else\n            m[".concat(e-1,"] = value;\n        "),{setVecItem:new G("\n      void setVecItem(out int m[".concat(e,"], int index, int value) {\n        ").concat(t,"\n      }\n        "))};}},{key:"getVecItem",value:function getVecItem(){var e=this.context.outputTextureLayout.shape.length,t="\n        if(index < 0)\n            index = ".concat(e," + index;\n        if (index == 0)\n            return m[0];\n      ");for(var _r123=1;_r123<e-1;++_r123)t+="\n        else if (index == ".concat(_r123,")\n            return m[").concat(_r123,"];\n      ");return t+="\n        else\n            return m[".concat(e-1,"];\n        "),{getVecItem:new G("\n      int getVecItem(int m[".concat(e,"], int index) {\n        ").concat(t,"\n      }\n    "))};}}]);}(gt);}),Zi,pp=L(function(){sp(),up(),lp(),fp(),cp(),Zi={encoding:xo,fragcolor:wo,vec:_o,shapeUtils:vo,coordinates:To};}),Oo,dp=L(function(){Yt(),ip(),pp(),ve(),Oo=/*#__PURE__*/function(){function Oo(e,t,r,n){var _this13=this;_classCallCheck2(this,Oo);this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new so(e,t,r,n),Object.keys(Zi).forEach(function(e){var t=new Zi[e](_this13.context);_this13.libs[e]=t;});var i=this.glslLibRoutineDependencyGraph;for(var _e148 in this.libs){var _t84=this.libs[_e148].getFunctions();for(var _r124 in _t84){var _n46=void 0,_o29=_e148+"."+_r124;i[_o29]?(_n46=i[_o29],_n46.routineBody=_t84[_r124].routineBody):(_n46=new gn(_o29,_t84[_r124].routineBody),i[_o29]=_n46);var _a19=_t84[_r124].dependencies;if(_a19)for(var _e149=0;_e149<_a19.length;++_e149)if(i[_a19[_e149]])_n46.addDependency(i[_a19[_e149]]);else{var _t85=new gn(_a19[_e149]);i[_a19[_e149]]=_t85,_n46.addDependency(_t85);}}}}return _createClass2(Oo,[{key:"preprocess",value:function preprocess(){var e=this.context.programInfo,t=e.shaderSource;return this.context.programInfo.hasMain||(t="".concat(t,"\n      ").concat(ju(this.context.glContext.version,this.context.outputTextureLayout.shape.length))),t=op(t),"".concat(Hu(this.context.glContext.version),"\n    ").concat(this.getUniforms(e.inputNames,e.variables),"\n    ").concat(this.getImports(t),"\n    ").concat(t);}},{key:"getImports",value:function getImports(e){var t=this.selectGlslLibRoutinesToBeIncluded(e);if(0===t.length)return"";var r="";for(var _e150=0;_e150<t.length;++_e150){if(!t[_e150].routineBody)throw new Error("Missing body for the Glsl Library routine: ".concat(t[_e150].name));r+=t[_e150].routineBody+"\n";}return r;}},{key:"selectGlslLibRoutinesToBeIncluded",value:function selectGlslLibRoutinesToBeIncluded(e){var _this14=this;var t=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach(function(r){var n=r.split(".")[1];-1!==e.indexOf(n)&&t.push(_this14.glslLibRoutineDependencyGraph[r]);}),uo.returnOrderedNodes(t);}},{key:"getUniforms",value:function getUniforms(e,t){var r=[];if(e){var _iterator19=_createForOfIteratorHelper2(e),_step19;try{for(_iterator19.s();!(_step19=_iterator19.n()).done;){var _t86=_step19.value;r.push("uniform sampler2D ".concat(_t86,";"));}}catch(err){_iterator19.e(err);}finally{_iterator19.f();}}if(t){var _iterator20=_createForOfIteratorHelper2(t),_step20;try{for(_iterator20.s();!(_step20=_iterator20.n()).done;){var _e151=_step20.value;r.push("uniform ".concat(_e151.type," ").concat(_e151.name).concat(_e151.arrayLength?"[".concat(_e151.arrayLength,"]"):"",";"));}}catch(err){_iterator20.e(err);}finally{_iterator20.f();}}return r.join("\n");}}]);}();}),Io,hp=L(function(){It(),dt(),dp(),ve(),Io=/*#__PURE__*/function(){function Io(e,t,r){_classCallCheck2(this,Io);this.profiler=e,this.glContext=t,this.textureLayoutStrategy=r,this.repo=new Map(),this.attributesBound=!1;}return _createClass2(Io,[{key:"getArtifact",value:function getArtifact(e){return this.repo.get(e);}},{key:"setArtifact",value:function setArtifact(e,t){this.repo.set(e,t);}},{key:"run",value:function run(e,t,r){var _e$programInfo$name,_this15=this;this.profiler.event("op","ProgramManager.run ".concat((_e$programInfo$name=e.programInfo.name)!==null&&_e$programInfo$name!==void 0?_e$programInfo$name:"unknown kernel"),function(){var n=_this15.glContext.gl,i=e.program;n.useProgram(i);try{var _e$programInfo$variab;_this15.bindOutput(r),_this15.attributesBound||_this15.bindAttributes(e.attribLocations),_this15.bindUniforms(e.uniformLocations,(_e$programInfo$variab=e.programInfo.variables)!==null&&_e$programInfo$variab!==void 0?_e$programInfo$variab:[],t);}catch(t){throw pe.error("ProgramManager",e.programInfo.shaderSource),t;}_this15.profiler.event("backend","GlContext.draw()",function(){_this15.glContext.draw();});},this.glContext);}},{key:"dispose",value:function dispose(){var _this16=this;this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach(function(e){return _this16.glContext.deleteProgram(e.program);});}},{key:"build",value:function build(e,t,r){var _this17=this;return this.profiler.event("backend","ProgramManager.build",function(){var n=new Oo(_this17.glContext,e,t,r),i=n.preprocess(),o=_this17.compile(i);return{programInfo:e,program:o,uniformLocations:_this17.getUniformLocations(o,n.context.programInfo.inputNames,n.context.programInfo.variables),attribLocations:_this17.getAttribLocations(o)};});}},{key:"compile",value:function compile(e){if(!this.vertexShader){pe.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");var _e152=Vu(this.glContext.version);this.vertexShader=this.glContext.compileShader(_e152,this.glContext.gl.VERTEX_SHADER);}ee.debug&&pe.verbose("ProrgramManager","FragShader:\n".concat(e,"\n"));var t=this.glContext.compileShader(e,this.glContext.gl.FRAGMENT_SHADER),r=this.glContext.createProgram(this.vertexShader,t);return this.glContext.deleteShader(t),r;}},{key:"bindOutput",value:function bindOutput(e){var t=e.width,r=e.height;pe.verbose("ProrgramManager","Binding output texture to Framebuffer: w/h=".concat(t,"/").concat(r,", shape=").concat(e.shape,", type=").concat(e.tensor.type)),this.glContext.attachFramebuffer(e.texture,t,r);}},{key:"bindAttributes",value:function bindAttributes(e){var t=e.position,r=e.textureCoord;this.glContext.setVertexAttributes(t,r),this.attributesBound=!0;}},{key:"bindUniforms",value:function bindUniforms(e,t,r){var _this18=this;var n=this.glContext.gl,i=0;var _iterator21=_createForOfIteratorHelper2(e),_step21;try{var _loop4=function _loop4(){var _t$find;var _step21$value=_step21.value,o=_step21$value.name,a=_step21$value.type,s=_step21$value.location,u=_step21$value.arrayLength;var e=(_t$find=t.find(function(e){return e.name===o;}))===null||_t$find===void 0?void 0:_t$find.data;if("sampler2D"!==a&&!e)throw new Error("variable '".concat(o,"' does not have data defined in program info"));switch(a){case"sampler2D":_this18.bindTexture(r[i],s,i),i++;break;case"float":u?n.uniform1fv(s,e):n.uniform1f(s,e);break;case"int":u?n.uniform1iv(s,e):n.uniform1i(s,e);break;default:throw new Error("Uniform not implemented: ".concat(a));}};for(_iterator21.s();!(_step21=_iterator21.n()).done;){_loop4();}}catch(err){_iterator21.e(err);}finally{_iterator21.f();}}},{key:"bindTexture",value:function bindTexture(e,t,r){this.glContext.bindTextureToUniform(e.texture,r,t);}},{key:"getAttribLocations",value:function getAttribLocations(e){return{position:this.getAttribLocation(e,"position"),textureCoord:this.getAttribLocation(e,"textureCoord")};}},{key:"getUniformLocations",value:function getUniformLocations(e,t,r){var n=[];if(t){var _iterator22=_createForOfIteratorHelper2(t),_step22;try{for(_iterator22.s();!(_step22=_iterator22.n()).done;){var _r125=_step22.value;n.push({name:_r125,type:"sampler2D",location:this.getUniformLocation(e,_r125)});}}catch(err){_iterator22.e(err);}finally{_iterator22.f();}}if(r){var _iterator23=_createForOfIteratorHelper2(r),_step23;try{for(_iterator23.s();!(_step23=_iterator23.n()).done;){var _t87=_step23.value;n.push(_objectSpread(_objectSpread({},_t87),{},{location:this.getUniformLocation(e,_t87.name)}));}}catch(err){_iterator23.e(err);}finally{_iterator23.f();}}return n;}},{key:"getUniformLocation",value:function getUniformLocation(e,t){var r=this.glContext.gl.getUniformLocation(e,t);if(null===r)throw new Error("Uniform ".concat(t," not found."));return r;}},{key:"getAttribLocation",value:function getAttribLocation(e,t){return this.glContext.gl.getAttribLocation(e,t);}}]);}();}),So,mp=L(function(){dt(),mn(),So=/*#__PURE__*/function(){function So(e,t,r,n){_classCallCheck2(this,So);this.glContext=e,this.layoutStrategy=t,this.profiler=r,this.config=n,this.pendingRead=new Map(),n.reuseTextures&&(this.inUseTextures=new Map(),this.idleTextures=new Map(),this.textureLookup=new Map());}return _createClass2(So,[{key:"createTextureFromLayout",value:function createTextureFromLayout(e,t,r,n){var i=this.toEncoderType(e),o=this.glContext.getEncoder(i,t.channels||1,n);if(t.isPacked&&1===n)throw new Error("not implemented");var a,s,u=t.width,l=t.height;if(this.config.reuseTextures){a="".concat(u,"x").concat(l,"_").concat(o.format,"_").concat(o.internalFormat,"_").concat(o.textureType),s=this.inUseTextures.get(a),s||(s=[],this.inUseTextures.set(a,s));var _t88=this.idleTextures.get(a);if(_t88&&_t88.length>0){var _i40=_t88.pop();return s.push(_i40),1===n&&this.glContext.updateTexture(_i40,u,l,o,this.toTextureData(e,r)),_i40;}}pe.verbose("TextureManager","Creating new texture of size ".concat(t.width,"x").concat(t.height));var c=this.glContext.allocateTexture(u,l,o,this.toTextureData(e,r));return this.config.reuseTextures&&(s.push(c),this.textureLookup.set(c,a)),c;}},{key:"readTexture",value:function readTexture(e,t,r){var _this19=this;return r||(r=1),this.profiler.event("backend","TextureManager.readTexture",function(){var n=e.shape.reduce(function(e,t){return e*t;})*r,i=_this19.glContext.readTexture(e.texture,e.width,e.height,n,_this19.toEncoderType(t),r);return _this19.toTensorData(t,i);});}},{key:"readTextureAsync",value:function(){var _readTextureAsync2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee29(e,t,r){var _this20=this;var n,_e153;return _regeneratorRuntime2().wrap(function _callee29$(_context29){while(1)switch(_context29.prev=_context29.next){case 0:n=e.tensor.dataId;if(!(r||(r=1),this.pendingRead.has(n))){_context29.next=4;break;}_e153=this.pendingRead.get(n);return _context29.abrupt("return",new Promise(function(t){return _e153===null||_e153===void 0?void 0:_e153.push(t);}));case 4:return _context29.abrupt("return",this.profiler.event("backend","TextureManager.readTextureAsync",/*#__PURE__*/_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee28(){var i,o,a,s;return _regeneratorRuntime2().wrap(function _callee28$(_context28){while(1)switch(_context28.prev=_context28.next){case 0:_this20.pendingRead.set(n,[]);i=e.shape.reduce(function(e,t){return e*t;})*r;_context28.next=4;return _this20.glContext.createAndWaitForFence();case 4:o=_this20.glContext.readTexture(e.texture,e.width,e.height,i,_this20.toEncoderType(t),r),a=_this20.toTensorData(t,o),s=_this20.pendingRead.get(n);return _context28.abrupt("return",(_this20.pendingRead["delete"](n),s!==null&&s!==void 0&&s.forEach(function(e){return e(a);}),a));case 6:case"end":return _context28.stop();}},_callee28);}))));case 5:case"end":return _context29.stop();}},_callee29,this);}));function readTextureAsync(_x33,_x34,_x35){return _readTextureAsync2.apply(this,arguments);}return readTextureAsync;}()},{key:"readUint8TextureAsFloat",value:function readUint8TextureAsFloat(e){var _this21=this;return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",function(){var t=e.shape.reduce(function(e,t){return e*t;}),r=_this21.glContext.readTexture(e.texture,e.width,e.height,4*t,"byte",4);return new Float32Array(r.buffer,r.byteOffset,t);});}},{key:"releaseTexture",value:function releaseTexture(e,t){var r;if(this.config.reuseTextures&&(r=this.textureLookup.get(e.texture),r)){t&&this.textureLookup["delete"](r);var _n47=this.inUseTextures.get(r);if(_n47){var _t89=_n47.indexOf(e.texture);if(-1!==_t89){_n47.splice(_t89,1);var _i41=this.idleTextures.get(r);_i41||(_i41=[],this.idleTextures.set(r,_i41)),_i41.push(e.texture);}}}(!r||t)&&(pe.verbose("TextureManager","Deleting texture of size ".concat(e.width,"x").concat(e.height)),this.glContext.deleteTexture(e.texture));}},{key:"toTensorData",value:function toTensorData(e,t){switch(e){case"int16":return t instanceof Int16Array?t:Int16Array.from(t);case"int32":return t instanceof Int32Array?t:Int32Array.from(t);case"int8":return t instanceof Int8Array?t:Int8Array.from(t);case"uint16":return t instanceof Uint16Array?t:Uint16Array.from(t);case"uint32":return t instanceof Uint32Array?t:Uint32Array.from(t);case"uint8":case"bool":return t instanceof Uint8Array?t:Uint8Array.from(t);case"float32":return t instanceof Float32Array?t:Float32Array.from(t);case"float64":return t instanceof Float64Array?t:Float64Array.from(t);default:throw new Error("TensorData type ".concat(e," is not supported"));}}},{key:"toTextureData",value:function toTextureData(e,t){if(t)return t instanceof Float32Array?t:new Float32Array(t);}},{key:"toEncoderType",value:function toEncoderType(e){return"float";}},{key:"clearActiveTextures",value:function clearActiveTextures(){this.glContext.clearActiveTextures();}}]);}();}),Ao,bp=L(function(){dt(),Ds(),sl(),rp(),hp(),Ji(),mp(),Ao=/*#__PURE__*/function(){function Ao(e,t){_classCallCheck2(this,Ao);this.backend=e,this.context=t,this.layoutStrategy=new yo(e.glContext.maxTextureSize),this.programManager=new Io(this.context.profiler,e.glContext,this.layoutStrategy),this.textureManager=new So(e.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:"full"===e.textureCacheMode}),this.packedTextureDataCache=new Map(),this.unpackedTextureDataCache=new Map(),this.pack=e.pack,this.pack2unpackMap=new Map(),this.unpack2packMap=new Map();}return _createClass2(Ao,[{key:"createInferenceHandler",value:function createInferenceHandler(){return new ao(this);}},{key:"onGraphInitialized",value:function onGraphInitialized(e){var t=e.getValues().filter(function(e){return-1===e.from&&e.tensor;}).map(function(e){return e.tensor.dataId;});this.initializers=new Set(t);}},{key:"isInitializer",value:function isInitializer(e){return!!this.initializers&&this.initializers.has(e);}},{key:"addInitializer",value:function addInitializer(e){this.initializers.add(e);}},{key:"getTextureData",value:function getTextureData(e,t){return t?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e);}},{key:"setTextureData",value:function setTextureData(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;pe.verbose("WebGLSessionHandler","Storing Texture data in cache"),r?this.packedTextureDataCache.set(e,t):this.unpackedTextureDataCache.set(e,t);}},{key:"dispose",value:function dispose(){var _this22=this;this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(function(e){return _this22.textureManager.releaseTexture(e,!0);}),this.packedTextureDataCache=new Map(),this.unpackedTextureDataCache.forEach(function(e){return _this22.textureManager.releaseTexture(e,!0);}),this.unpackedTextureDataCache=new Map();}},{key:"resolve",value:function resolve(e,t,r){var n=Ps(e,t,tp);return{impl:n.opImpl,context:n.opInit?n.opInit(e,r):e};}}]);}();});function og(e){var t=0;for(;t<e.length&&e[t]();++t);return t-1;}var xn,gp=L(function(){It(),mn(),mn(),Bt(),xn=/*#__PURE__*/function(){function xn(e,t){_classCallCheck2(this,xn);this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=e,this.version=t,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters();}return _createClass2(xn,[{key:"allocateTexture",value:function allocateTexture(e,t,r,n){var i=this.gl,o=i.createTexture();i.bindTexture(i.TEXTURE_2D,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);var a=n?r.encode(n,e*t):null;return i.texImage2D(i.TEXTURE_2D,0,r.internalFormat,e,t,0,r.format,r.textureType,a),this.checkError(),o;}},{key:"updateTexture",value:function updateTexture(e,t,r,n,i){var o=this.gl;o.bindTexture(o.TEXTURE_2D,e);var a=n.encode(i,t*r);o.texSubImage2D(o.TEXTURE_2D,0,0,0,t,r,n.format,n.textureType,a),this.checkError();}},{key:"attachFramebuffer",value:function attachFramebuffer(e,t,r){var n=this.gl;n.bindTexture(n.TEXTURE_2D,e),n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0),this.checkError(),n.viewport(0,0,t,r),n.scissor(0,0,t,r);}},{key:"readTexture",value:function readTexture(e,t,r,n,i,o){var a=this.gl;o||(o=1),this.frameBufferBound||this.attachFramebuffer(e,t,r);var s=this.getEncoder(i,o),u=s.allocate(t*r);return a.bindTexture(a.TEXTURE_2D,e),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),a.readPixels(0,0,t,r,a.RGBA,s.textureType,u),this.checkError(),s.decode(u,n);}},{key:"isFramebufferReady",value:function isFramebufferReady(){return!0;}},{key:"getActiveTexture",value:function getActiveTexture(){var e=this.gl;return"TEXTURE"+(e.getParameter(this.gl.ACTIVE_TEXTURE)-e.TEXTURE0);}},{key:"getTextureBinding",value:function getTextureBinding(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D);}},{key:"getFramebufferBinding",value:function getFramebufferBinding(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING);}},{key:"setVertexAttributes",value:function setVertexAttributes(e,t){var r=this.gl;r.vertexAttribPointer(e,3,r.FLOAT,!1,20,0),r.enableVertexAttribArray(e),-1!==t&&(r.vertexAttribPointer(t,2,r.FLOAT,!1,20,12),r.enableVertexAttribArray(t)),this.checkError();}},{key:"createProgram",value:function createProgram(e,t){var r=this.gl,n=r.createProgram();return r.attachShader(n,e),r.attachShader(n,t),r.linkProgram(n),n;}},{key:"compileShader",value:function compileShader(e,t){var r=this.gl,n=r.createShader(t);if(!n)throw new Error("createShader() returned null with type ".concat(t));if(r.shaderSource(n,e),r.compileShader(n),!1===r.getShaderParameter(n,r.COMPILE_STATUS))throw new Error("Failed to compile shader: ".concat(r.getShaderInfoLog(n),"\nShader source:\n").concat(e));return n;}},{key:"deleteShader",value:function deleteShader(e){this.gl.deleteShader(e);}},{key:"bindTextureToUniform",value:function bindTextureToUniform(e,t,r){var n=this.gl;n.activeTexture(n.TEXTURE0+t),this.checkError(),n.bindTexture(n.TEXTURE_2D,e),this.checkError(),n.uniform1i(r,t),this.checkError();}},{key:"draw",value:function draw(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError();}},{key:"checkError",value:function checkError(){if(ee.debug){var _e154=this.gl,_t90=_e154.getError(),_r126="";switch(_t90){case _e154.NO_ERROR:return;case _e154.INVALID_ENUM:_r126="INVALID_ENUM";break;case _e154.INVALID_VALUE:_r126="INVALID_VALUE";break;case _e154.INVALID_OPERATION:_r126="INVALID_OPERATION";break;case _e154.INVALID_FRAMEBUFFER_OPERATION:_r126="INVALID_FRAMEBUFFER_OPERATION";break;case _e154.OUT_OF_MEMORY:_r126="OUT_OF_MEMORY";break;case _e154.CONTEXT_LOST_WEBGL:_r126="CONTEXT_LOST_WEBGL";break;default:_r126="Unknown WebGL Error: ".concat(_t90.toString(16));}throw new Error(_r126);}}},{key:"deleteTexture",value:function deleteTexture(e){this.gl.deleteTexture(e);}},{key:"deleteProgram",value:function deleteProgram(e){this.gl.deleteProgram(e);}},{key:"getEncoder",value:function getEncoder(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;if(2===this.version)return new oo(this.gl,t);switch(e){case"float":return 1===r||this.isRenderFloat32Supported?new hn(this.gl,t):new hn(this.gl,t,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new io(this.gl,t);default:throw new Error("Invalid dataType: ".concat(e));}}},{key:"clearActiveTextures",value:function clearActiveTextures(){var e=this.gl;for(var _t91=0;_t91<this.maxTextureImageUnits;++_t91)e.activeTexture(e.TEXTURE0+_t91),e.bindTexture(e.TEXTURE_2D,null);}},{key:"dispose",value:function dispose(){if(this.disposed)return;var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(this.framebuffer),e.bindBuffer(e.ARRAY_BUFFER,null),e.deleteBuffer(this.vertexbuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.finish(),this.disposed=!0;}},{key:"createDefaultGeometry",value:function createDefaultGeometry(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);}},{key:"createVertexbuffer",value:function createVertexbuffer(){var e=this.gl,t=e.createBuffer();if(!t)throw new Error("createBuffer() returned null");var r=this.createDefaultGeometry();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),this.checkError(),t;}},{key:"createFramebuffer",value:function createFramebuffer(){var e=this.gl.createFramebuffer();if(!e)throw new Error("createFramebuffer returned null");return e;}},{key:"queryVitalParameters",value:function queryVitalParameters(){var e=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),1===this.version&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.version;}},{key:"getExtensions",value:function getExtensions(){2===this.version?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"));}},{key:"checkFloatTextureAttachableToFrameBuffer",value:function checkFloatTextureAttachableToFrameBuffer(){var e=this.gl,t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);var r=2===this.version?e.RGBA32F:e.RGBA;e.texImage2D(e.TEXTURE_2D,0,r,1,1,0,e.RGBA,e.FLOAT,null);var n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(t),e.deleteFramebuffer(n),i;}},{key:"checkRenderFloat32",value:function checkRenderFloat32(){if(2===this.version){if(!this.colorBufferFloatExtension)return!1;}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer;}},{key:"checkFloat32Download",value:function checkFloat32Download(){if(2===this.version){if(!this.colorBufferFloatExtension)return!1;}else if(!this.textureFloatExtension||!this.gl.getExtension("WEBGL_color_buffer_float"))return!1;return this.isFloatTextureAttachableToFrameBuffer;}},{key:"checkFloat32Blend",value:function checkFloat32Blend(){var e,t,r,n,i,o=this.gl;try{e=o.createTexture(),t=o.createFramebuffer(),o.bindTexture(o.TEXTURE_2D,e);var _a20=2===this.version?o.RGBA32F:o.RGBA;return o.texImage2D(o.TEXTURE_2D,0,_a20,1,1,0,o.RGBA,o.FLOAT,null),o.bindFramebuffer(o.FRAMEBUFFER,t),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,e,0),o.enable(o.BLEND),r=o.createShader(o.VERTEX_SHADER),!!(r&&(o.shaderSource(r,"void main(){}"),o.compileShader(r),n=o.createShader(o.FRAGMENT_SHADER),n)&&(o.shaderSource(n,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),o.compileShader(n),i=o.createProgram(),i))&&(o.attachShader(i,r),o.attachShader(i,n),o.linkProgram(i),o.useProgram(i),o.drawArrays(o.POINTS,0,1),o.getError()===o.NO_ERROR);}finally{o.disable(o.BLEND),i&&o.deleteProgram(i),r&&o.deleteShader(r),n&&o.deleteShader(n),t&&(o.bindFramebuffer(o.FRAMEBUFFER,null),o.deleteFramebuffer(t)),e&&(o.bindTexture(o.TEXTURE_2D,null),o.deleteTexture(e));}}},{key:"beginTimer",value:function beginTimer(){if(2===this.version&&this.disjointTimerQueryWebgl2Extension){var _e155=this.gl,_t92=this.disjointTimerQueryWebgl2Extension,_r127=_e155.createQuery();return _e155.beginQuery(_t92.TIME_ELAPSED_EXT,_r127),_r127;}throw new Error("WebGL1 profiling currently not supported.");}},{key:"endTimer",value:function endTimer(){if(2!==this.version||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{var _e156=this.gl,_t93=this.disjointTimerQueryWebgl2Extension;_e156.endQuery(_t93.TIME_ELAPSED_EXT);}}},{key:"isTimerResultAvailable",value:function isTimerResultAvailable(e){var t=!1,r=!1;if(2!==this.version||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{var _n48=this.gl,_i42=this.disjointTimerQueryWebgl2Extension;t=_n48.getQueryParameter(e,_n48.QUERY_RESULT_AVAILABLE),r=_n48.getParameter(_i42.GPU_DISJOINT_EXT);}return t&&!r;}},{key:"getTimerResult",value:function getTimerResult(e){var t=0;if(2!==this.version)throw new Error("WebGL1 profiling currently not supported");{var _r128=this.gl;t=_r128.getQueryParameter(e,_r128.QUERY_RESULT),_r128.deleteQuery(e);}return t/1e6;}},{key:"waitForQueryAndGetTime",value:function(){var _waitForQueryAndGetTime=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee30(e){var _this23=this;return _regeneratorRuntime2().wrap(function _callee30$(_context30){while(1)switch(_context30.prev=_context30.next){case 0:_context30.next=2;return _i(function(){return _this23.isTimerResultAvailable(e);});case 2:return _context30.abrupt("return",this.getTimerResult(e));case 3:case"end":return _context30.stop();}},_callee30,this);}));function waitForQueryAndGetTime(_x36){return _waitForQueryAndGetTime.apply(this,arguments);}return waitForQueryAndGetTime;}()},{key:"createAndWaitForFence",value:function(){var _createAndWaitForFence=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee31(){var e;return _regeneratorRuntime2().wrap(function _callee31$(_context31){while(1)switch(_context31.prev=_context31.next){case 0:e=this.createFence(this.gl);return _context31.abrupt("return",this.pollFence(e));case 2:case"end":return _context31.stop();}},_callee31,this);}));function createAndWaitForFence(){return _createAndWaitForFence.apply(this,arguments);}return createAndWaitForFence;}()},{key:"createFence",value:function createFence(e){var t,r=e,n=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),t=null===n?function(){return!0;}:function(){var e=r.clientWaitSync(n,0,0);return e===r.ALREADY_SIGNALED||e===r.CONDITION_SATISFIED;},{query:n,isFencePassed:t};}},{key:"pollFence",value:function(){var _pollFence=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee32(e){var _this24=this;return _regeneratorRuntime2().wrap(function _callee32$(_context32){while(1)switch(_context32.prev=_context32.next){case 0:return _context32.abrupt("return",new Promise(function(t){_this24.addItemToPoll(function(){return e.isFencePassed();},function(){return t();});}));case 1:case"end":return _context32.stop();}},_callee32);}));function pollFence(_x37){return _pollFence.apply(this,arguments);}return pollFence;}()},{key:"pollItems",value:function pollItems(){var e=og(this.itemsToPoll.map(function(e){return e.isDoneFn;}));for(var _t94=0;_t94<=e;++_t94){var _e157=this.itemsToPoll[_t94].resolveFn;_e157();}this.itemsToPoll=this.itemsToPoll.slice(e+1);}},{key:"addItemToPoll",value:function(){var _addItemToPoll=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee33(e,t){var _this25=this;return _regeneratorRuntime2().wrap(function _callee33$(_context33){while(1)switch(_context33.prev=_context33.next){case 0:this.itemsToPoll.push({isDoneFn:e,resolveFn:t});_context33.t0=!(this.itemsToPoll.length>1);if(!_context33.t0){_context33.next=5;break;}_context33.next=5;return _i(function(){return _this25.pollItems(),0===_this25.itemsToPoll.length;});case 5:case"end":return _context33.stop();}},_callee33,this);}));function addItemToPoll(_x38,_x39){return _addItemToPoll.apply(this,arguments);}return addItemToPoll;}()}]);}();});function Qi(e){var t;if(e&&"webgl2"!==e||!("webgl2"in Xr)?(!e||"webgl"===e)&&"webgl"in Xr&&(t=Xr.webgl):t=Xr.webgl2,!t)try{t=yp(ag(),e);}catch(_unused3){t=yp(ig(),e);}e=e||1===t.version?"webgl":"webgl2";var r=t.gl;return Xr[e]=t,r.isContextLost()?(delete Xr[e],Qi(e)):(r.disable(r.DEPTH_TEST),r.disable(r.STENCIL_TEST),r.disable(r.BLEND),r.disable(r.DITHER),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SAMPLE_COVERAGE),r.enable(r.SCISSOR_TEST),r.enable(r.CULL_FACE),r.cullFace(r.BACK),t);}function yp(e,t){var r,n={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1};if((!t||"webgl2"===t)&&(r=e.getContext("webgl2",n),r))try{return new xn(r,2);}catch(e){pe.warning("GlContextFactory","failed to create WebGLContext using contextId 'webgl2'. Error: ".concat(e));}if((!t||"webgl"===t)&&(r=e.getContext("webgl",n)||e.getContext("experimental-webgl",n),r))try{return new xn(r,1);}catch(e){pe.warning("GlContextFactory","failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ".concat(e));}throw new Error("WebGL is not supported");}function ig(){if((typeof document==="undefined"?"undefined":_typeof2(document))>"u")throw new TypeError("failed to create canvas: document is not supported");var e=document.createElement("canvas");return e.width=1,e.height=1,e;}function ag(){if((typeof OffscreenCanvas==="undefined"?"undefined":_typeof2(OffscreenCanvas))>"u")throw new TypeError("failed to create offscreen canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1);}var Xr,Tp=L(function(){dt(),gp(),Xr={};}),Eo,xp=L(function(){It(),dt(),bp(),Tp(),Eo=/*#__PURE__*/function(){function Eo(){_classCallCheck2(this,Eo);}return _createClass2(Eo,[{key:"contextId",get:function get(){return ee.webgl.contextId;},set:function set(e){ee.webgl.contextId=e;}},{key:"matmulMaxBatchSize",get:function get(){return ee.webgl.matmulMaxBatchSize;},set:function set(e){ee.webgl.matmulMaxBatchSize=e;}},{key:"textureCacheMode",get:function get(){return ee.webgl.textureCacheMode;},set:function set(e){ee.webgl.textureCacheMode=e;}},{key:"pack",get:function get(){return ee.webgl.pack;},set:function set(e){ee.webgl.pack=e;}},{key:"async",get:function get(){return ee.webgl.async;},set:function set(e){ee.webgl.async=e;}},{key:"initialize",value:function initialize(){try{return this.glContext=Qi(this.contextId),"number"!=typeof this.matmulMaxBatchSize&&(this.matmulMaxBatchSize=16),"string"!=typeof this.textureCacheMode&&(this.textureCacheMode="full"),"boolean"!=typeof this.pack&&(this.pack=!1),"boolean"!=typeof this.async&&(this.async=!1),pe.setWithEnv(ee),ee.webgl.context||Object.defineProperty(ee.webgl,"context",{value:this.glContext.gl}),pe.verbose("WebGLBackend","Created WebGLContext: ".concat(_typeof2(this.glContext)," with matmulMaxBatchSize: ").concat(this.matmulMaxBatchSize,"; textureCacheMode: ").concat(this.textureCacheMode,"; pack: ").concat(this.pack,"; async: ").concat(this.async,".")),!0;}catch(e){return pe.warning("WebGLBackend","Unable to initialize WebGLBackend. ".concat(e)),!1;}}},{key:"createSessionHandler",value:function createSessionHandler(e){return new Ao(this,e);}},{key:"dispose",value:function dispose(){this.glContext.dispose();}}]);}();});function ea(_x40){return _ea.apply(this,arguments);}function _ea(){_ea=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee71(e){var _t133,_iterator43,_step43,_e229,_t134,r;return _regeneratorRuntime2().wrap(function _callee71$(_context74){while(1)switch(_context74.prev=_context74.next){case 0:if(e){_context74.next=2;break;}return _context74.abrupt("return",ea(["webgl"]));case 2:_t133="string"==typeof e?[e]:e;_iterator43=_createForOfIteratorHelper2(_t133);_context74.prev=4;_iterator43.s();case 6:if((_step43=_iterator43.n()).done){_context74.next=18;break;}_e229=_step43.value;_t134=wp.get(_e229);if(!_t134){_context74.next=11;break;}return _context74.abrupt("return",_t134);case 11:_context74.next=13;return ug(_e229);case 13:r=_context74.sent;if(!r){_context74.next=16;break;}return _context74.abrupt("return",r);case 16:_context74.next=6;break;case 18:_context74.next=23;break;case 20:_context74.prev=20;_context74.t0=_context74["catch"](4);_iterator43.e(_context74.t0);case 23:_context74.prev=23;_iterator43.f();return _context74.finish(23);case 26:throw new Error("no available backend to use");case 27:case"end":return _context74.stop();}},_callee71,null,[[4,20,23,26]]);}));return _ea.apply(this,arguments);}function ug(_x41){return _ug.apply(this,arguments);}function _ug(){_ug=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee72(e){var t,r,_n81;return _regeneratorRuntime2().wrap(function _callee72$(_context75){while(1)switch(_context75.prev=_context75.next){case 0:t=sg;if(!(_typeof2(t[e])<"u"&&lg(t[e]))){_context75.next=10;break;}r=t[e],_n81=r.initialize();_context75.t0="object"==_typeof2(_n81)&&"then"in _n81;if(!_context75.t0){_context75.next=8;break;}_context75.next=7;return _n81;case 7:_n81=_context75.sent;case 8:if(!_n81){_context75.next=10;break;}return _context75.abrupt("return",(wp.set(e,r),r));case 10:case"end":return _context75.stop();}},_callee72);}));return _ug.apply(this,arguments);}function lg(e){var t=e;return"initialize"in t&&"function"==typeof t.initialize&&"createSessionHandler"in t&&"function"==typeof t.createSessionHandler&&"dispose"in t&&"function"==typeof t.dispose;}var wp,sg,vp=L(function(){xp(),wp=new Map(),sg={webgl:new Eo()};}),ta,Po,_p=L(function(){dt(),ta=/*#__PURE__*/_createClass2(function ta(e,t){_classCallCheck2(this,ta);this.op=e,this.node=t;}),Po=/*#__PURE__*/function(){function Po(e,t,r){_classCallCheck2(this,Po);this.graph=e,this.profiler=r,this.initialize(t);}return _createClass2(Po,[{key:"initialize",value:function initialize(e){var _this26=this;this.profiler.event("session","ExecutionPlan.initialize",function(){var t=_this26.graph.getNodes();if(t.length!==e.length)throw new Error("The size of nodes and OPs do not match.");_this26._ops=e.map(function(e,r){return new ta(e,t[r]);}),_this26.reset(),_this26._starter=[],_this26._ops.forEach(function(e,t){var r=!0;var _iterator24=_createForOfIteratorHelper2(e.node.inputs),_step24;try{for(_iterator24.s();!(_step24=_iterator24.n()).done;){var _t95=_step24.value;if(!_this26._values[_t95]&&-1===_this26.graph.getInputIndices().indexOf(_t95)){r=!1;break;}}}catch(err){_iterator24.e(err);}finally{_iterator24.f();}r&&_this26._starter.push(t);});});}},{key:"reset",value:function reset(){this._values=this.graph.getValues().map(function(e){return e.tensor;});}},{key:"execute",value:function(){var _execute=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee36(e,t){var _this27=this;return _regeneratorRuntime2().wrap(function _callee36$(_context37){while(1)switch(_context37.prev=_context37.next){case 0:return _context37.abrupt("return",this.profiler.event("session","ExecutionPlan.execute",/*#__PURE__*/_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee35(){var r,n,i,o,a,s,_loop5,u,_e158,_t96,_r129;return _regeneratorRuntime2().wrap(function _callee35$(_context36){while(1)switch(_context36.prev=_context36.next){case 0:_this27.reset();r=e.createInferenceHandler(),n=_this27.graph.getInputIndices();if(!(t.length!==n.length)){_context36.next=4;break;}throw new Error("number of input tensors don't match the number of inputs to the model: actual: ".concat(t.length," expected: ").concat(n.length));case 4:t.forEach(function(e,t){var r=n[t];_this27._values[r]=e;});i=_this27._starter.slice(0),o=_this27.graph.getValues(),a=_this27.graph.getNodes(),s=0;_loop5=/*#__PURE__*/_regeneratorRuntime2().mark(function _loop5(){var e,t,n,u,l,c;return _regeneratorRuntime2().wrap(function _loop5$(_context35){while(1)switch(_context35.prev=_context35.next){case 0:e=i[s++],t=_this27._ops[e],n=t.node.inputs.map(function(e){return _this27._values[e];});if(!(-1!==n.indexOf(void 0))){_context35.next=3;break;}throw new Error("unresolved input detected: op: ".concat(t.node));case 3:u=n;pe.verbose("ExecPlan","Runing op:".concat(t.node.name," (").concat(u.map(function(e,r){return"'".concat(t.node.inputs[r],"': ").concat(e.type,"[").concat(e.dims.join(","),"]");}).join(", "),")"));_context35.next=7;return _this27.profiler.event("node",t.node.name,/*#__PURE__*/_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee34(){return _regeneratorRuntime2().wrap(function _callee34$(_context34){while(1)switch(_context34.prev=_context34.next){case 0:return _context34.abrupt("return",t.op.impl(r,u,t.op.context));case 1:case"end":return _context34.stop();}},_callee34);})));case 7:l=_context35.sent;if(!(l.length!==t.node.outputs.length)){_context35.next=10;break;}throw new Error("the size of output does not match model definition.");case 10:l.forEach(function(e,r){var n=t.node.outputs[r];if(_this27._values[n])throw new Error("output [".concat(n,"] already has value: op:").concat(t.node.name));_this27._values[n]=e;});c=new Set();l.forEach(function(e,r){var n=t.node.outputs[r];var _iterator25=_createForOfIteratorHelper2(o[n].to),_step25;try{for(_iterator25.s();!(_step25=_iterator25.n()).done;){var _e159=_step25.value;var _t97=a[_e159],_r130=!0;var _iterator26=_createForOfIteratorHelper2(_t97.inputs),_step26;try{for(_iterator26.s();!(_step26=_iterator26.n()).done;){var _e160=_step26.value;if(!_this27._values[_e160]){_r130=!1;break;}}}catch(err){_iterator26.e(err);}finally{_iterator26.f();}_r130&&c.add(_e159);}}catch(err){_iterator25.e(err);}finally{_iterator25.f();}}),i.push.apply(i,_toConsumableArray2(c));case 13:case"end":return _context35.stop();}},_loop5);});case 7:if(!(s<i.length)){_context36.next=11;break;}return _context36.delegateYield(_loop5(),"t0",9);case 9:_context36.next=7;break;case 11:u=[];_e158=0;case 13:if(!(_e158<_this27.graph.getOutputIndices().length)){_context36.next=27;break;}_t96=_this27.graph.getOutputIndices()[_e158],_r129=_this27._values[_t96];if(!(void 0===_r129)){_context36.next=17;break;}throw new Error("required output [".concat(_t96,"] does not have value"));case 17:if(!(0===_t96)){_context36.next=22;break;}_context36.next=20;return _r129.getData();case 20:_context36.next=23;break;case 22:_r129.data;case 23:u.push(_r129);case 24:_e158++;_context36.next=13;break;case 27:return _context36.abrupt("return",(pe.verbose("ExecPlan","disposing of inferenceHandler"),r.dispose(),u));case 28:case"end":return _context36.stop();}},_callee35);}))));case 1:case"end":return _context37.stop();}},_callee36,this);}));function execute(_x42,_x43){return _execute.apply(this,arguments);}return execute;}()}]);}();}),oe,xt,wn,Op=L(function(){un(),oe=Nr(Ur()),Or(),fe(),xt=H.experimental.fbs,wn=/*#__PURE__*/function(){function e(t){_classCallCheck2(this,e);if(this._attributes=new Map(),null!=t){var _iterator27=_createForOfIteratorHelper2(t),_step27;try{for(_iterator27.s();!(_step27=_iterator27.n()).done;){var _r131=_step27.value;_r131 instanceof oe.onnx.AttributeProto?this._attributes.set(_r131.name,[e.getValue(_r131),e.getType(_r131)]):_r131 instanceof xt.Attribute&&this._attributes.set(_r131.name(),[e.getValue(_r131),e.getType(_r131)]);}}catch(err){_iterator27.e(err);}finally{_iterator27.f();}if(this._attributes.size<t.length)throw new Error("duplicated attribute names");}}return _createClass2(e,[{key:"set",value:function set(_e161,t,r){this._attributes.set(_e161,[r,t]);}},{key:"delete",value:function _delete(_e162){this._attributes["delete"](_e162);}},{key:"getFloat",value:function getFloat(_e163,t){return this.get(_e163,"float",t);}},{key:"getInt",value:function getInt(_e164,t){return this.get(_e164,"int",t);}},{key:"getString",value:function getString(_e165,t){return this.get(_e165,"string",t);}},{key:"getTensor",value:function getTensor(_e166,t){return this.get(_e166,"tensor",t);}},{key:"getFloats",value:function getFloats(_e167,t){return this.get(_e167,"floats",t);}},{key:"getInts",value:function getInts(_e168,t){return this.get(_e168,"ints",t);}},{key:"getStrings",value:function getStrings(_e169,t){return this.get(_e169,"strings",t);}},{key:"getTensors",value:function getTensors(_e170,t){return this.get(_e170,"tensors",t);}},{key:"get",value:function get(_e171,t,r){var n=this._attributes.get(_e171);if(void 0===n){if(void 0!==r)return r;throw new Error("required attribute not found: ".concat(_e171));}if(n[1]!==t)throw new Error("type mismatch: expected ".concat(t," but got ").concat(n[1]));return n[0];}}],[{key:"getType",value:function getType(_e172){var t=_e172 instanceof oe.onnx.AttributeProto?_e172.type:_e172.type();switch(t){case oe.onnx.AttributeProto.AttributeType.FLOAT:return"float";case oe.onnx.AttributeProto.AttributeType.INT:return"int";case oe.onnx.AttributeProto.AttributeType.STRING:return"string";case oe.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case oe.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case oe.onnx.AttributeProto.AttributeType.INTS:return"ints";case oe.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case oe.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error("attribute type is not supported yet: ".concat(oe.onnx.AttributeProto.AttributeType[t]));}}},{key:"getValue",value:function getValue(_e173){var t=_e173 instanceof oe.onnx.AttributeProto?_e173.type:_e173.type();if(t===oe.onnx.AttributeProto.AttributeType.GRAPH||t===oe.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");var r=this.getValueNoCheck(_e173);if(t===oe.onnx.AttributeProto.AttributeType.INT&&ot.isLong(r))return ot.longToNumber(r);if(t===oe.onnx.AttributeProto.AttributeType.INTS){var _e174=r,_t98=new Array(_e174.length);for(var _r132=0;_r132<_e174.length;_r132++){var _n49=_e174[_r132];_t98[_r132]=ot.longToNumber(_n49);}return _t98;}if(t===oe.onnx.AttributeProto.AttributeType.TENSOR)return _e173 instanceof oe.onnx.AttributeProto?$e.fromProto(r):$e.fromOrtTensor(r);if(t===oe.onnx.AttributeProto.AttributeType.TENSORS){if(_e173 instanceof oe.onnx.AttributeProto)return r.map(function(_e175){return $e.fromProto(_e175);});if(_e173 instanceof xt.Attribute)return r.map(function(_e176){return $e.fromOrtTensor(_e176);});}return t===oe.onnx.AttributeProto.AttributeType.STRING&&_e173 instanceof oe.onnx.AttributeProto?dn(r):t===oe.onnx.AttributeProto.AttributeType.STRINGS&&_e173 instanceof oe.onnx.AttributeProto?r.map(dn):r;}},{key:"getValueNoCheck",value:function getValueNoCheck(_e177){return _e177 instanceof oe.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(_e177):this.getValueNoCheckFromOrtFormat(_e177);}},{key:"getValueNoCheckFromOnnxFormat",value:function getValueNoCheckFromOnnxFormat(_e178){switch(_e178.type){case oe.onnx.AttributeProto.AttributeType.FLOAT:return _e178.f;case oe.onnx.AttributeProto.AttributeType.INT:return _e178.i;case oe.onnx.AttributeProto.AttributeType.STRING:return _e178.s;case oe.onnx.AttributeProto.AttributeType.TENSOR:return _e178.t;case oe.onnx.AttributeProto.AttributeType.GRAPH:return _e178.g;case oe.onnx.AttributeProto.AttributeType.FLOATS:return _e178.floats;case oe.onnx.AttributeProto.AttributeType.INTS:return _e178.ints;case oe.onnx.AttributeProto.AttributeType.STRINGS:return _e178.strings;case oe.onnx.AttributeProto.AttributeType.TENSORS:return _e178.tensors;case oe.onnx.AttributeProto.AttributeType.GRAPHS:return _e178.graphs;default:throw new Error("unsupported attribute type: ".concat(oe.onnx.AttributeProto.AttributeType[_e178.type]));}}},{key:"getValueNoCheckFromOrtFormat",value:function getValueNoCheckFromOrtFormat(_e179){switch(_e179.type()){case xt.AttributeType.FLOAT:return _e179.f();case xt.AttributeType.INT:return _e179.i();case xt.AttributeType.STRING:return _e179.s();case xt.AttributeType.TENSOR:return _e179.t();case xt.AttributeType.GRAPH:return _e179.g();case xt.AttributeType.FLOATS:return _e179.floatsArray();case xt.AttributeType.INTS:{var _t99=[];for(var _r133=0;_r133<_e179.intsLength();_r133++)_t99.push(_e179.ints(_r133));return _t99;}case xt.AttributeType.STRINGS:{var _t100=[];for(var _r134=0;_r134<_e179.stringsLength();_r134++)_t100.push(_e179.strings(_r134));return _t100;}case xt.AttributeType.TENSORS:{var _t101=[];for(var _r135=0;_r135<_e179.tensorsLength();_r135++)_t101.push(_e179.tensors(_r135));return _t101;}default:throw new Error("unsupported attribute type: ".concat(xt.AttributeType[_e179.type()]));}}}]);}();}),na,Do,oa,Rt,Lo,ra,Ip=L(function(){Op(),un(),na=Nr(Ur()),Or(),fe(),Do=H.experimental.fbs,oa={from:function from(e,t){return new ra(e,t);}},Rt=/*#__PURE__*/function(){function Rt(e){_classCallCheck2(this,Rt);this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,e&&(this.type=Ve.tensorValueTypeFromProto(e.type.tensorType));}return _createClass2(Rt,[{key:"from",get:function get(){return this._from;}},{key:"to",get:function get(){return this._to;}}]);}(),Lo=/*#__PURE__*/_createClass2(function Lo(e,t){_classCallCheck2(this,Lo);e instanceof na.onnx.NodeProto?(this.name=e.name,this.opType=e.opType,this.attributes=new wn(e.attribute)):e instanceof Do.Node&&(this.name=t!==null&&t!==void 0?t:e.name(),this.opType=e.opType(),this.attributes=new wn(Ve.tensorAttributesFromORTFormat(e))),this.inputs=[],this.outputs=[],this.executeNode=!0;}),ra=/*#__PURE__*/function(){function ra(e,t){_classCallCheck2(this,ra);if(!e)throw new TypeError("graph is empty");this.buildGraph(e),this.transformGraph(t),this.checkIsAcyclic();}return _createClass2(ra,[{key:"getInputIndices",value:function getInputIndices(){return this._allInputIndices;}},{key:"getInputNames",value:function getInputNames(){return this._allInputNames;}},{key:"getOutputIndices",value:function getOutputIndices(){return this._allOutputIndices;}},{key:"getOutputNames",value:function getOutputNames(){return this._allOutputNames;}},{key:"getValues",value:function getValues(){return this._allData;}},{key:"getNodes",value:function getNodes(){return this._nodes;}},{key:"buildGraph",value:function buildGraph(e){if(e instanceof na.onnx.GraphProto)this.buildGraphFromOnnxFormat(e);else{if(!(e instanceof Do.Graph))throw new TypeError("Graph type is not supported.");this.buildGraphFromOrtFormat(e);}}},{key:"buildGraphFromOnnxFormat",value:function buildGraphFromOnnxFormat(e){var t=new Map();this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];var r=new Map();if(!e.input)throw new Error("missing information in graph: input");var n=[];var _iterator28=_createForOfIteratorHelper2(e.input),_step28;try{for(_iterator28.s();!(_step28=_iterator28.n()).done;){var _r138=_step28.value;if(t.has(_r138.name))throw new Error("duplicated input name: ".concat(_r138.name));var _e183=this._allData.push(new Rt(_r138))-1;t.set(_r138.name,_e183),n.push(_r138.name);}}catch(err){_iterator28.e(err);}finally{_iterator28.f();}if(!e.initializer)throw new Error("missing information in graph: initializer");var _iterator29=_createForOfIteratorHelper2(e.initializer),_step29;try{for(_iterator29.s();!(_step29=_iterator29.n()).done;){var _r139=_step29.value;var _e184=t.get(_r139.name);if(void 0===_e184){var _n52=new Rt();_n52.type={shape:{dims:Ve.tensorDimsFromProto(_r139.dims)},tensorType:Ve.tensorDataTypeFromProto(_r139.dataType)},_e184=this._allData.push(_n52)-1,t.set(_r139.name,_e184);}this._allData[_e184]._from=-1,this._allData[_e184].tensor=$e.fromProto(_r139);}}catch(err){_iterator29.e(err);}finally{_iterator29.f();}for(var _e180=0;_e180<this._allData.length;_e180++)this._allData[_e180].tensor||(this._allInputIndices.push(_e180),this._allInputNames.push(n[_e180]));if(!e.output)throw new Error("missing information in graph: output");var _iterator30=_createForOfIteratorHelper2(e.output),_step30;try{for(_iterator30.s();!(_step30=_iterator30.n()).done;){var _r140=_step30.value;if(t.has(_r140.name))throw new Error("duplicated output name: ".concat(_r140.name));var _e185=this._allData.push(new Rt(_r140))-1;t.set(_r140.name,_e185),this._allOutputIndices.push(_e185),this._allOutputNames.push(_r140.name);}}catch(err){_iterator30.e(err);}finally{_iterator30.f();}if(!e.node)throw new Error("missing information in graph: node");var _iterator31=_createForOfIteratorHelper2(e.node),_step31;try{for(_iterator31.s();!(_step31=_iterator31.n()).done;){var _t102=_step31.value;if(!_t102.name)for(var _e186=0;;_e186++){var _n53="unnamed_".concat(_t102.opType,"_").concat(_e186);if(!r.has(_n53)){_t102.name=_n53;break;}}if(r.has(_t102.name))throw new Error("duplicated node name: ".concat(_t102.name));var _e187=this._nodes.push(new Lo(_t102))-1;r.set(_t102.name,_e187);}}catch(err){_iterator31.e(err);}finally{_iterator31.f();}for(var _r136=0;_r136<this._nodes.length;_r136++){var _n50=this._nodes[_r136],_i43=e.node[_r136];if(!_i43.output)throw new Error("missing output for node: ".concat(_i43.name));var _iterator32=_createForOfIteratorHelper2(_i43.output),_step32;try{for(_iterator32.s();!(_step32=_iterator32.n()).done;){var _e181=_step32.value;var _o30=t.get(_e181);if(_typeof2(_o30)>"u"&&(_o30=this._allData.push(new Rt())-1,t.set(_e181,_o30)),_n50.outputs.push(_o30),void 0!==this._allData[_o30]._from)throw new Error("multiple nodes output to one data value: ".concat(_o30));if(this._allData[_o30]._from=_r136,"Constant"===_i43.opType){if(!_i43.attribute||1!==_i43.attribute.length||!_i43.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!_i43.output||1!==_i43.output.length)throw new Error("missing output or incorrect number of outputs for this Constant operator");_n50.outputs.pop(),_n50.executeNode=!1,this._allData[_o30]._from=-1,this._allData[_o30].tensor=$e.fromProto(_i43.attribute[0].t);}}}catch(err){_iterator32.e(err);}finally{_iterator32.f();}}for(var _r137=0;_r137<this._nodes.length;_r137++){var _n51=this._nodes[_r137],_i44=e.node[_r137];if(!_i44.input)throw new Error("missing input for node: ".concat(_i44.name));var _iterator33=_createForOfIteratorHelper2(_i44.input),_step33;try{for(_iterator33.s();!(_step33=_iterator33.n()).done;){var _e182=_step33.value;var _o31=t.get(_e182);if(_typeof2(_o31)>"u"){if(""===_e182&&(3===_i44.input.length||4===_i44.input.length)&&"Resize"===_i44.opType)continue;throw new Error("unrecognized input '".concat(_e182,"' for node: ").concat(_i44.name));}_n51.inputs.push(_o31),this._allData[_o31]._to.push(_r137);}}catch(err){_iterator33.e(err);}finally{_iterator33.f();}}return!0;}},{key:"buildGraphFromOrtFormat",value:function buildGraphFromOrtFormat(e){var t=new Map();this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];var r=new Map(),n=[];for(var _r141=0;_r141<e.inputsLength();_r141++){var _i45=e.inputs(_r141);if(t.has(_i45))throw new Error("duplicated input name: ".concat(_i45));for(var _r142=0;_r142<e.nodeArgsLength();_r142++){var _e$nodeArgs;if(((_e$nodeArgs=e.nodeArgs(_r142))===null||_e$nodeArgs===void 0?void 0:_e$nodeArgs.name())===_i45){var _e$nodeArgs2;var _o32=new Rt();if(((_e$nodeArgs2=e.nodeArgs(_r142))===null||_e$nodeArgs2===void 0||(_e$nodeArgs2=_e$nodeArgs2.type())===null||_e$nodeArgs2===void 0?void 0:_e$nodeArgs2.valueType())!==Do.TypeInfoValue.tensor_type)throw new Error("Unexpected value type for the nodeArg.");var _a21=e.nodeArgs(_r142).type().value(new Do.TensorTypeAndShape()),_s17=Ve.tensorDataTypeFromProto(_a21.elemType()),_u16=_a21.shape(),_l12=[];for(var _e188=0;_e188<_u16.dimLength();_e188++)_l12.push(ot.longToNumber(_u16.dim(_e188).value().dimValue()));_o32.type={shape:{dims:_l12},tensorType:_s17};var _c11=this._allData.push(_o32)-1;t.set(_i45,_c11),n.push(_i45);}}}for(var _r143=0;_r143<e.initializersLength();_r143++){var _n54=e.initializers(_r143),_i46=t.get(_n54.name());if(void 0===_i46){var _e189=new Rt(),_r144=Ve.tensorDimsFromORTFormat(_n54),_o33=Ve.tensorDataTypeFromProto(_n54.dataType());_e189.type={shape:{dims:_r144},tensorType:_o33},_i46=this._allData.push(_e189)-1,t.set(_n54.name(),_i46);}this._allData[_i46]._from=-1,this._allData[_i46].tensor=$e.fromOrtTensor(_n54);}for(var _e190=0;_e190<this._allData.length;_e190++)this._allData[_e190].tensor||(this._allInputIndices.push(_e190),this._allInputNames.push(n[_e190]));for(var _r145=0;_r145<e.outputsLength();_r145++){var _n55=e.outputs(_r145);if(t.has(_n55))throw new Error("duplicated output name: ".concat(_n55));var _i47=this._allData.push(new Rt())-1;t.set(_n55,_i47),this._allOutputIndices.push(_i47),this._allOutputNames.push(_n55);}if(!e.nodes)throw new Error("missing information in graph: node");for(var _t103=0;_t103<e.nodesLength();_t103++){var _n56=e.nodes(_t103),_i48=_n56.name();if(!_i48)for(var _e191=0;_i48="unnamed_".concat(_n56.opType(),"_").concat(_e191),r.has(_i48);_e191++);if(r.has(_i48))throw new Error("duplicated node name: ".concat(_i48));var _o34=this._nodes.push(new Lo(_n56,_i48))-1;r.set(_i48,_o34);}for(var _r146=0;_r146<this._nodes.length;_r146++){var _n57=this._nodes[_r146],_i49=e.nodes(_r146);if(null==_i49)throw new Error("No node exists at index ".concat(_r146));if(0===(_i49===null||_i49===void 0?void 0:_i49.outputsLength()))throw new Error("missing output for node: ".concat(_i49.name));for(var _e192=0;_e192<(_i49===null||_i49===void 0?void 0:_i49.outputsLength());_e192++){var _o35=_i49===null||_i49===void 0?void 0:_i49.outputs(_e192),_a22=t.get(_o35);if(_typeof2(_a22)>"u"&&(_a22=this._allData.push(new Rt())-1,t.set(_o35,_a22)),_n57.outputs.push(_a22),void 0!==this._allData[_a22]._from)throw new Error("multiple nodes output to one data value: ".concat(_a22));if(this._allData[_a22]._from=_r146,"Constant"===_i49.opType()){if(1!==_i49.attributesLength()||!_i49.attributes(0).t())throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(1!==_i49.outputsLength())throw new Error("missing output or incorrect number of outputs for this Constant operator");_n57.outputs.pop(),_n57.executeNode=!1,this._allData[_a22]._from=-1,this._allData[_a22].tensor=$e.fromOrtTensor(_i49.attributes(0).t());}}}for(var _r147=0;_r147<this._nodes.length;_r147++){var _n58=this._nodes[_r147],_i50=e.nodes(_r147);if(0===_i50.inputsLength())throw new Error("missing input for node: ".concat(_i50.name));for(var _e193=0;_e193<_i50.inputsLength();_e193++){var _o36=_i50.inputs(_e193),_a23=t.get(_o36);if(_typeof2(_a23)>"u")throw new Error("unrecognized input '".concat(_o36,"' for node: ").concat(_i50.name()));_n58.inputs.push(_a23),this._allData[_a23]._to.push(_r147);}}}},{key:"checkIsAcyclic",value:function checkIsAcyclic(){var _this28=this;var e=new Set();this._allInputIndices.forEach(function(t){_this28._allData[t]._to.forEach(function(t){e.add(t);});});var t=Array.from(e),r=new Array(this._nodes.length).fill("white");var _loop6=function _loop6(){var e=t.pop();"gray"===r[e]?r[e]="black":(t.push(e),r[e]="gray",_this28._nodes[e].outputs.forEach(function(n){var i=_this28._allData[n];if(_typeof2(i.tensor)<"u")throw new Error("node outputs should not be initialized");if(i._from!==e)throw new Error("from property of the Value object doesn't match index of Node being processed");i._to.forEach(function(e){if("gray"===r[e])throw new Error("model graph is cyclic");"white"===r[e]&&t.push(e);});}));};for(;t.length>0;){_loop6();}}},{key:"transformGraph",value:function transformGraph(e){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),e&&e.transformGraph(this),this.finalizeGraph();}},{key:"finalizeGraph",value:function finalizeGraph(){var _this29=this;var e=0,t=new Array(this._nodes.length,0),r=0;for(var _e194=0;_e194<this._nodes.length;_e194++)t[_e194]=r,this._nodes[_e194].executeNode?(r!==_e194&&(this._nodes[r]=this._nodes[_e194]),r++):this._nodes[_e194].outputs.forEach(function(e){_this29._allData[e]._from=-2;});this._nodes.splice(r,this._nodes.length-r);for(var _e195=0;_e195<this._allData.length;_e195++){var _r148=this._allData[_e195];void 0!==_r148._from&&-1!==_r148._from&&-2!==_r148._from&&(_r148._from=t[_r148._from]);for(var _e196=0;_e196<_r148._to.length;_e196++){if(!(_r148._to[_e196]>=0))throw new Error("Trying to update a removed node");_r148._to[_e196]=t[_r148._to[_e196]];}}e=0;var _loop7=function _loop7(_t105){if(-2!==_this29._allData[_t105].from||-1!==_this29._allOutputIndices.indexOf(_t105+e)){if(e>0){var _r149=-1;void 0!==_this29._allData[_t105].from&&-1!==_this29._allData[_t105].from?(_r149=_this29._nodes[_this29._allData[_t105].from].outputs.indexOf(_t105+e),-1!==_r149&&(_this29._nodes[_this29._allData[_t105].from].outputs[_r149]=_t105)):(_r149=_this29._allInputIndices.indexOf(_t105+e),-1!==_r149&&(_this29._allInputIndices[_r149]=_t105)),_this29._allData[_t105].to.forEach(function(n){_r149=_this29._nodes[n].inputs.indexOf(_t105+e),-1!==_r149&&(_this29._nodes[n].inputs[_r149]=_t105);}),0===_this29._allData[_t105].to.length&&(_r149=_this29._allOutputIndices.indexOf(_t105+e),-1!==_r149&&(_this29._allOutputIndices[_r149]=_t105));}}else e++,_this29._allData.splice(_t105,1),_t105--;_t104=_t105;};for(var _t104=0;_t104<this._allData.length;_t104++){_loop7(_t104);}}},{key:"deleteNode",value:function deleteNode(e){var t=this._nodes[e];if(t.outputs.length>1)for(var _e197=1;_e197<t.outputs.length;_e197++)if(this._allData[t.outputs[_e197]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ");t.executeNode=!1;var r=t.inputs[0],n=t.outputs[0],i=this._allData[n].to;for(var _r150=0;_r150<t.inputs.length;_r150++){var _n59=this._allData[t.inputs[_r150]].to.indexOf(e);if(-1===_n59)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[t.inputs[_r150]].to.splice(_n59,1);}this._allData[n]._to=[];var o=this._allOutputIndices.indexOf(n);if(-1!==o&&(this._allOutputIndices[o]=r),i&&i.length>0){var _iterator34=_createForOfIteratorHelper2(i),_step34;try{for(_iterator34.s();!(_step34=_iterator34.n()).done;){var _e198=_step34.value;var _t106=this._nodes[_e198].inputs.indexOf(n);if(-1===_t106)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[_e198].inputs[_t106]=r,this._allData[r].to.push(_e198);}}catch(err){_iterator34.e(err);}finally{_iterator34.f();}}}},{key:"removeAllDropoutNodes",value:function removeAllDropoutNodes(){var e=0;var _iterator35=_createForOfIteratorHelper2(this._nodes),_step35;try{for(_iterator35.s();!(_step35=_iterator35.n()).done;){var _t107=_step35.value;if("Dropout"===_t107.opType){if(1!==_t107.inputs.length)throw new Error("Dropout nodes should only contain one input. ");if(1!==_t107.outputs.length&&2!==_t107.outputs.length)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(2===_t107.outputs.length&&0!==this._allData[_t107.outputs[1]]._to.length)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(e);}e++;}}catch(err){_iterator35.e(err);}finally{_iterator35.f();}}},{key:"removeAllIdentityNodes",value:function removeAllIdentityNodes(){var e=0;var _iterator36=_createForOfIteratorHelper2(this._nodes),_step36;try{for(_iterator36.s();!(_step36=_iterator36.n()).done;){var _t108=_step36.value;"Identity"===_t108.opType&&this.deleteNode(e),e++;}}catch(err){_iterator36.e(err);}finally{_iterator36.f();}}},{key:"isActivation",value:function isActivation(e){switch(e.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1;}}},{key:"fuseConvActivationNodes",value:function fuseConvActivationNodes(){var _iterator37=_createForOfIteratorHelper2(this._nodes),_step37;try{for(_iterator37.s();!(_step37=_iterator37.n()).done;){var _e199=_step37.value;if("Conv"===_e199.opType){var _t109=this._allData[_e199.outputs[0]]._to;if(1===_t109.length&&this.isActivation(this._nodes[_t109[0]])){var _r151=this._nodes[_t109[0]];if("Clip"===_r151.opType)if(1===_r151.inputs.length)try{_e199.attributes.set("activation_params","floats",[_r151.attributes.getFloat("min"),_r151.attributes.getFloat("max")]);}catch(_unused4){_e199.attributes.set("activation_params","floats",[vr,_r]);}else{if(!(_r151.inputs.length>=3&&void 0!==this._allData[_r151.inputs[1]].tensor&&void 0!==this._allData[_r151.inputs[2]].tensor))continue;_e199.attributes.set("activation_params","floats",[this._allData[_r151.inputs[1]].tensor.floatData[0],this._allData[_r151.inputs[2]].tensor.floatData[0]]);}_e199.attributes.set("activation","string",_r151.opType),this.deleteNode(_t109[0]);}}}}catch(err){_iterator37.e(err);}finally{_iterator37.f();}}}]);}();}),Sp,fg,Fo,Ap=L(function(){Jn(),Ip(),un(),Sp=Nr(Ur()),fe(),fg=H.experimental.fbs,Fo=/*#__PURE__*/function(){function Fo(){_classCallCheck2(this,Fo);}return _createClass2(Fo,[{key:"load",value:function load(e,t,r){if(!r)try{return void this.loadFromOnnxFormat(e,t);}catch(e){if(void 0!==r)throw e;}this.loadFromOrtFormat(e,t);}},{key:"loadFromOnnxFormat",value:function loadFromOnnxFormat(e,t){var r=Sp.onnx.ModelProto.decode(e);if(ot.longToNumber(r.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=r.opsetImport.map(function(e){return{domain:e.domain,version:ot.longToNumber(e.version)};}),this._graph=oa.from(r.graph,t);}},{key:"loadFromOrtFormat",value:function loadFromOrtFormat(e,t){var r=new I.ByteBuffer(e),n=fg.InferenceSession.getRootAsInferenceSession(r).model();if(ot.longToNumber(n.irVersion())<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(var _e200=0;_e200<n.opsetImportLength();_e200++){var _t110=n.opsetImport(_e200);this._opsets.push({domain:_t110===null||_t110===void 0?void 0:_t110.domain(),version:ot.longToNumber(_t110.version())});}this._graph=oa.from(n.graph(),t);}},{key:"graph",get:function get(){return this._graph;}},{key:"opsets",get:function get(){return this._opsets;}}]);}();}),Co,Ep=L(function(){vp(),_p(),dt(),Ap(),Co=/*#__PURE__*/function(){function Co(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck2(this,Co);this._initialized=!1,this.backendHint=e.backendHint,this.profiler=Xn.create(e.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]};}return _createClass2(Co,[{key:"inputNames",get:function get(){return this._model.graph.getInputNames();}},{key:"outputNames",get:function get(){return this._model.graph.getOutputNames();}},{key:"startProfiling",value:function startProfiling(){this.profiler.start();}},{key:"endProfiling",value:function endProfiling(){this.profiler.stop();}},{key:"loadModel",value:function(){var _loadModel=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee38(e,t,r){var _this30=this;return _regeneratorRuntime2().wrap(function _callee38$(_context39){while(1)switch(_context39.prev=_context39.next){case 0:_context39.next=2;return this.profiler.event("session","Session.loadModel",/*#__PURE__*/_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee37(){var n,_t111,_r152,_r153,_n60;return _regeneratorRuntime2().wrap(function _callee37$(_context38){while(1)switch(_context38.prev=_context38.next){case 0:_context38.next=2;return ea(_this30.backendHint);case 2:n=_context38.sent;if(!(_this30.sessionHandler=n.createSessionHandler(_this30.context),_this30._model=new Fo(),"string"==typeof e)){_context38.next=20;break;}_t111=e.endsWith(".ort");if(!(_typeof2(process)<"u"&&process.versions&&process.versions.node)){_context38.next=12;break;}_context38.next=8;return(void 0)(e);case 8:_r152=_context38.sent;_this30.initialize(_r152,_t111);_context38.next=18;break;case 12:_context38.next=14;return fetch(e);case 14:_context38.next=16;return _context38.sent.arrayBuffer();case 16:_r153=_context38.sent;_this30.initialize(new Uint8Array(_r153),_t111);case 18:_context38.next=21;break;case 20:if(ArrayBuffer.isView(e))_this30.initialize(e);else{_n60=new Uint8Array(e,t||0,r||e.byteLength);_this30.initialize(_n60);}case 21:case"end":return _context38.stop();}},_callee37);})));case 2:case"end":return _context39.stop();}},_callee38,this);}));function loadModel(_x44,_x45,_x46){return _loadModel.apply(this,arguments);}return loadModel;}()},{key:"initialize",value:function initialize(e,t){var _this31=this;if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",function(){var r=_this31.sessionHandler.transformGraph?_this31.sessionHandler:void 0;_this31._model.load(e,r,t),_this31.sessionHandler.onGraphInitialized&&_this31.sessionHandler.onGraphInitialized(_this31._model.graph),_this31.initializeOps(_this31._model.graph),_this31._executionPlan=new Po(_this31._model.graph,_this31._ops,_this31.profiler);}),this._initialized=!0;}},{key:"run",value:function(){var _run2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee40(e){var _this32=this;return _regeneratorRuntime2().wrap(function _callee40$(_context41){while(1)switch(_context41.prev=_context41.next){case 0:if(this._initialized){_context41.next=2;break;}throw new Error("session not initialized yet");case 2:return _context41.abrupt("return",this.profiler.event("session","Session.run",/*#__PURE__*/_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee39(){var t,r;return _regeneratorRuntime2().wrap(function _callee39$(_context40){while(1)switch(_context40.prev=_context40.next){case 0:t=_this32.normalizeAndValidateInputs(e);_context40.next=3;return _this32._executionPlan.execute(_this32.sessionHandler,t);case 3:r=_context40.sent;return _context40.abrupt("return",_this32.createOutput(r));case 5:case"end":return _context40.stop();}},_callee39);}))));case 3:case"end":return _context41.stop();}},_callee40,this);}));function run(_x47){return _run2.apply(this,arguments);}return run;}()},{key:"normalizeAndValidateInputs",value:function normalizeAndValidateInputs(e){var t=this._model.graph.getInputNames();if(Array.isArray(e)){if(e.length!==t.length)throw new Error("incorrect input array length: expected ".concat(t.length," but got ").concat(e.length));}else{if(e.size!==t.length)throw new Error("incorrect input map size: expected ".concat(t.length," but got ").concat(e.size));var _r154=new Array(e.size),_n61=0;for(var _i51=0;_i51<t.length;++_i51){var _o37=e.get(t[_i51]);if(!_o37)throw new Error("missing input tensor for: '".concat(name,"'"));_r154[_n61++]=_o37;}e=_r154;}if(this.context.graphInputTypes&&0!==this.context.graphInputTypes.length&&this.context.graphInputDims&&0!==this.context.graphInputDims.length)this.validateInputTensorDims(this.context.graphInputDims,e,!1);else{var _t112=this._model.graph.getInputIndices(),_r155=this._model.graph.getValues(),_n62=new Array(_t112.length);for(var _i52=0;_i52<_t112.length;++_i52){var _o38=_r155[_t112[_i52]];_n62[_i52]=_o38.type.shape.dims,this.context.graphInputTypes.push(_o38.type.tensorType),this.context.graphInputDims.push(e[_i52].dims);}this.validateInputTensorDims(_n62,e,!0);}return this.validateInputTensorTypes(this.context.graphInputTypes,e),e;}},{key:"validateInputTensorTypes",value:function validateInputTensorTypes(e,t){for(var _r156=0;_r156<t.length;_r156++){var _n63=e[_r156],_i53=t[_r156].type;if(_n63!==_i53)throw new Error("input tensor[".concat(_r156,"] check failed: expected type '").concat(_n63,"' but got ").concat(_i53));}}},{key:"validateInputTensorDims",value:function validateInputTensorDims(e,t,r){for(var _n64=0;_n64<t.length;_n64++){var _i54=e[_n64],_o39=t[_n64].dims;if(!this.compareTensorDims(_i54,_o39,r))throw new Error("input tensor[".concat(_n64,"] check failed: expected shape '[").concat(_i54.join(","),"]' but got [").concat(_o39.join(","),"]"));}}},{key:"compareTensorDims",value:function compareTensorDims(e,t,r){if(e.length!==t.length)return!1;for(var _n65=0;_n65<e.length;++_n65)if(e[_n65]!==t[_n65]&&(!r||0!==e[_n65]))return!1;return!0;}},{key:"createOutput",value:function createOutput(e){var t=this._model.graph.getOutputNames();if(e.length!==t.length)throw new Error("expected number of outputs do not match number of generated outputs");var r=new Map();for(var _n66=0;_n66<t.length;++_n66)r.set(t[_n66],e[_n66]);return r;}},{key:"initializeOps",value:function initializeOps(e){var t=e.getNodes();this._ops=new Array(t.length);for(var _r157=0;_r157<t.length;_r157++)this._ops[_r157]=this.sessionHandler.resolve(t[_r157],this._model.opsets,e);}}]);}();}),$o,Pp=L(function(){It(),Or(),$o=/*#__PURE__*/function(){function $o(e){_classCallCheck2(this,$o);this.session=e,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames;}return _createClass2($o,[{key:"dispose",value:function(){var _dispose=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee41(){return _regeneratorRuntime2().wrap(function _callee41$(_context42){while(1)switch(_context42.prev=_context42.next){case 0:case"end":return _context42.stop();}},_callee41);}));function dispose(){return _dispose.apply(this,arguments);}return dispose;}()},{key:"run",value:function(){var _run3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee42(e,t,r){var n,_t113,_r158,i,o;return _regeneratorRuntime2().wrap(function _callee42$(_context43){while(1)switch(_context43.prev=_context43.next){case 0:n=new Map();for(_t113 in e)if(Object.hasOwnProperty.call(e,_t113)){_r158=e[_t113];n.set(_t113,new $e(_r158.dims,_r158.type,void 0,void 0,_r158.data));}_context43.next=4;return this.session.run(n);case 4:i=_context43.sent;o={};return _context43.abrupt("return",(i.forEach(function(e,t){o[t]=new Ne(e.type,e.data,e.dims);}),o));case 7:case"end":return _context43.stop();}},_callee42,this);}));function run(_x48,_x49,_x50){return _run3.apply(this,arguments);}return run;}()},{key:"configure",value:function(){var _configure2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee43(e){return _regeneratorRuntime2().wrap(function _callee43$(_context44){while(1)switch(_context44.prev=_context44.next){case 0:return _context44.abrupt("return","");case 1:case"end":return _context44.stop();}},_callee43);}));function configure(_x51){return _configure2.apply(this,arguments);}return configure;}()},{key:"auth",value:function(){var _auth2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee44(e){return _regeneratorRuntime2().wrap(function _callee44$(_context45){while(1)switch(_context45.prev=_context45.next){case 0:return _context45.abrupt("return","");case 1:case"end":return _context45.stop();}},_callee44);}));function auth(_x52){return _auth2.apply(this,arguments);}return auth;}()},{key:"startProfiling",value:function startProfiling(){this.session.startProfiling();}},{key:"endProfiling",value:function endProfiling(){this.session.endProfiling();}}]);}();}),Dp={};cr(Dp,{onnxjsBackend:function onnxjsBackend(){return pg;}});var ia,pg,Lp=L(function(){Ep(),Pp(),ia=/*#__PURE__*/function(){function ia(){_classCallCheck2(this,ia);}return _createClass2(ia,[{key:"init",value:function(){var _init=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee45(){return _regeneratorRuntime2().wrap(function _callee45$(_context46){while(1)switch(_context46.prev=_context46.next){case 0:case"end":return _context46.stop();}},_callee45);}));function init(){return _init.apply(this,arguments);}return init;}()},{key:"createInferenceSessionHandler",value:function(){var _createInferenceSessionHandler=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee46(e,t){var r;return _regeneratorRuntime2().wrap(function _callee46$(_context47){while(1)switch(_context47.prev=_context47.next){case 0:r=new Co(t);_context47.next=3;return r.loadModel(e);case 3:return _context47.abrupt("return",new $o(r));case 4:case"end":return _context47.stop();}},_callee46);}));function createInferenceSessionHandler(_x53,_x54){return _createInferenceSessionHandler.apply(this,arguments);}return createInferenceSessionHandler;}()}]);}(),pg=new ia();}),aa={};cr(aa,{createReadStream:function createReadStream(){return Fp;},readFile:function readFile(){return dg;},readFileSync:function readFileSync(){return hg;}});var dg,hg,Fp,sa=L(function(){dg=void 0,hg=void 0,Fp=void 0;}),ua={};cr(ua,{join:function join(){return mg;}});var mg,la=L(function(){mg=void 0;}),fa={};cr(fa,{crypto:function crypto(){return bg;}});var bg,ca=L(function(){bg=void 0;}),Bp=ye(function(e,t){var r=function(){var e=(typeof document==="undefined"?"undefined":_typeof2(document))<"u"&&document.currentScript?document.currentScript.src:void 0;return(typeof __filename==="undefined"?"undefined":_typeof2(__filename))<"u"&&(e=e||__filename),function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r,n,i=t;i.ready=new Promise(function(e,t){r=e,n=t;});var o,a,s,u=Object.assign({},i),l="./this.program",c="object"==(typeof window==="undefined"?"undefined":_typeof2(window)),h="function"==typeof importScripts,f="object"==_typeof2(process)&&"object"==_typeof2(process.versions)&&"string"==typeof process.versions.node,d="";if(f){var p=(sa(),Ht(aa)),y=(la(),Ht(ua));d=h?y.dirname(d)+"/":__dirname+"/",o=function o(e,t){return e=D(e)?new URL(e):y.normalize(e),p.readFileSync(e,t?void 0:"utf8");},s=function s(e){return(e=o(e,!0)).buffer||(e=new Uint8Array(e)),e;},a=function a(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!0;e=D(e)?new URL(e):y.normalize(e),p.readFile(e,n?void 0:"utf8",function(e,i){e?r(e):t(n?i.buffer:i);});},!i.thisProgram&&1<process.argv.length&&(l=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),i.inspect=function(){return"[Emscripten Module object]";};}else(c||h)&&(h?d=self.location.href:(typeof document==="undefined"?"undefined":_typeof2(document))<"u"&&document.currentScript&&(d=document.currentScript.src),e&&(d=e),d=0!==d.indexOf("blob:")?d.substr(0,d.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=function o(e){var t=new XMLHttpRequest();return t.open("GET",e,!1),t.send(null),t.responseText;},h&&(s=function s(e){var t=new XMLHttpRequest();return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response);}),a=function a(e,t,r){var n=new XMLHttpRequest();n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):r();},n.onerror=r,n.send(null);});var m=console.log.bind(console),g=console.error.bind(console);Object.assign(i,u),u=null,"object"!=(typeof WebAssembly==="undefined"?"undefined":_typeof2(WebAssembly))&&R("no native wasm support detected");var w,b,_v2,x,_,S,T=!1;function I(){var e=w.buffer;i.HEAP8=b=new Int8Array(e),i.HEAP16=new Int16Array(e),i.HEAPU8=_v2=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAP32=x=new Int32Array(e),i.HEAPU32=_=new Uint32Array(e),i.HEAPF32=new Float32Array(e),i.HEAPF64=S=new Float64Array(e);}var E=[],A=[],C=[],O=0,P=null,k=null;function R(e){throw g(e="Aborted("+e+")"),T=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),n(e),e;}var B,$=function $(e){return e.startsWith("data:application/octet-stream;base64,");},D=function D(e){return e.startsWith("file://");};if(!$(B="ort-wasm.wasm")){var M=B;B=i.locateFile?i.locateFile(M,d):d+M;}function L(e){if(s)return s(e);throw"both async and sync fetching of the wasm failed";}function F(e,t,r){return function(e){if(c||h){if("function"==typeof fetch&&!D(e))return fetch(e,{credentials:"same-origin"}).then(function(t){if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer();})["catch"](function(){return L(e);});if(a)return new Promise(function(t,r){a(e,function(e){return t(new Uint8Array(e));},r);});}return Promise.resolve().then(function(){return L(e);});}(e).then(function(e){return WebAssembly.instantiate(e,t);}).then(function(e){return e;}).then(r,function(e){g("failed to asynchronously prepare wasm: ".concat(e)),R(e);});}var N,U={882112:function _(e,t,r,n){if(_typeof2(i)>"u"||!i.Ga)return 1;if((e=H(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=i.Ga.get(e)))return 2;if((t>>>=0)+(r>>>=0)>e.byteLength)return 3;try{return _v2.set(e.subarray(t,t+r),n>>>0>>>0),0;}catch(_unused5){return 4;}}};function G(e){this.Da=e-24,this.Fa=function(e){_[this.Da+4>>>2>>>0]=e;},this.Ea=function(e){_[this.Da+8>>>2>>>0]=e;},this.La=function(e,t){this.Ma(),this.Fa(e),this.Ea(t);},this.Ma=function(){_[this.Da+16>>>2>>>0]=0;};}var j,z=(typeof TextDecoder==="undefined"?"undefined":_typeof2(TextDecoder))<"u"?new TextDecoder("utf8"):void 0,V=function V(e,t,r){var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&z)return z.decode(e.subarray(t,r));for(n="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))n+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i));}}else n+=String.fromCharCode(i);}return n;},H=function H(e,t){return(e>>>=0)?V(_v2,e,t):"";},W=function W(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3;}return t;},Y=function Y(e,t,r,n){if(!(0<n))return 0;var i=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o);if(127>=a){if(r>=n)break;t[r++>>>0]=a;}else{if(2047>=a){if(r+1>=n)break;t[r++>>>0]=192|a>>6;}else{if(65535>=a){if(r+2>=n)break;t[r++>>>0]=224|a>>12;}else{if(r+3>=n)break;t[r++>>>0]=240|a>>18,t[r++>>>0]=128|a>>12&63;}t[r++>>>0]=128|a>>6&63;}t[r++>>>0]=128|63&a;}}return t[r>>>0]=0,r-i;},K=function K(e){return e%4==0&&(e%100!=0||e%400==0);},X=[0,31,60,91,121,152,182,213,244,274,305,335],Z=[0,31,59,90,120,151,181,212,243,273,304,334],q=function q(e){var t=W(e)+1,r=pe(t);return r&&Y(e,_v2,r,t),r;},J=[],Q={},ee=function ee(){if(!j){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==(typeof navigator==="undefined"?"undefined":_typeof2(navigator))&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:l||"./this.program"};for(e in Q)void 0===Q[e]?delete t[e]:t[e]=Q[e];var r=[];for(e in t)r.push("".concat(e,"=").concat(t[e]));j=r;}return j;},te=[null,[],[]],_re=function re(e){return(_re=function(){if("object"==(typeof crypto==="undefined"?"undefined":_typeof2(crypto))&&"function"==typeof crypto.getRandomValues)return function(e){return crypto.getRandomValues(e);};if(f)try{var e=(ca(),Ht(fa));if(e.randomFillSync)return function(t){return e.randomFillSync(t);};var t=e.randomBytes;return function(e){return e.set(t(e.byteLength)),e;};}catch(_unused6){}R("initRandomDevice");}())(e);},ne=[31,29,31,30,31,30,31,31,30,31,30,31],ie=[31,28,31,30,31,30,31,31,30,31,30,31];function oe(e,t,r,n){function i(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e;}function o(e,t){return i(e,t,"0");}function a(e,t){function r(e){return 0>e?-1:0<e?1:0;}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n;}function s(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30);}}function u(e){var t=e.ya;for(e=new Date(new Date(e.za+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(K(e.getFullYear())?ne:ie)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break;}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1));}return r=new Date(e.getFullYear()+1,0,4),t=s(new Date(e.getFullYear(),0,4)),r=s(r),0>=a(t,e)?0>=a(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1;}e>>>=0,t>>>=0,r>>>=0;var l=_[(n>>>=0)+40>>>2>>>0];for(var c in n={Ja:x[n>>>2>>>0],Ia:x[n+4>>>2>>>0],Aa:x[n+8>>>2>>>0],Ca:x[n+12>>>2>>>0],Ba:x[n+16>>>2>>>0],za:x[n+20>>>2>>>0],xa:x[n+24>>>2>>>0],ya:x[n+28>>>2>>>0],Na:x[n+32>>>2>>>0],Ha:x[n+36>>>2>>>0],Ka:l?H(l):""},r=H(r),l={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(c,"g"),l[c]);var h="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),f="January February March April May June July August September October November December".split(" ");for(c in l={"%a":function a(e){return h[e.xa].substring(0,3);},"%A":function A(e){return h[e.xa];},"%b":function b(e){return f[e.Ba].substring(0,3);},"%B":function B(e){return f[e.Ba];},"%C":function C(e){return o((e.za+1900)/100|0,2);},"%d":function d(e){return o(e.Ca,2);},"%e":function e(_e201){return i(_e201.Ca,2," ");},"%g":function g(e){return u(e).toString().substring(2);},"%G":function G(e){return u(e);},"%H":function H(e){return o(e.Aa,2);},"%I":function I(e){return 0==(e=e.Aa)?e=12:12<e&&(e-=12),o(e,2);},"%j":function j(e){for(var t=0,r=0;r<=e.Ba-1;t+=(K(e.za+1900)?ne:ie)[r++]);return o(e.Ca+t,3);},"%m":function m(e){return o(e.Ba+1,2);},"%M":function M(e){return o(e.Ia,2);},"%n":function n(){return"\n";},"%p":function p(e){return 0<=e.Aa&&12>e.Aa?"AM":"PM";},"%S":function S(e){return o(e.Ja,2);},"%t":function t(){return"\t";},"%u":function u(e){return e.xa||7;},"%U":function U(e){return o(Math.floor((e.ya+7-e.xa)/7),2);},"%V":function V(e){var t=Math.floor((e.ya+7-(e.xa+6)%7)/7);if(2>=(e.xa+371-e.ya-2)%7&&t++,t)53==t&&(4==(r=(e.xa+371-e.ya)%7)||3==r&&K(e.za)||(t=1));else{t=52;var r=(e.xa+7-e.ya-1)%7;(4==r||5==r&&K(e.za%400-1))&&t++;}return o(t,2);},"%w":function w(e){return e.xa;},"%W":function W(e){return o(Math.floor((e.ya+7-(e.xa+6)%7)/7),2);},"%y":function y(e){return(e.za+1900).toString().substring(2);},"%Y":function Y(e){return e.za+1900;},"%z":function z(e){return(0<=(e=e.Ha)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4);},"%Z":function Z(e){return e.Ka;},"%%":function _(){return"%";}},r=r.replace(/%%/g,"\0\0"),l)r.includes(c)&&(r=r.replace(new RegExp(c,"g"),l[c](n)));return c=function(e){var t=Array(W(e)+1);return Y(e,t,0,t.length),t;}(r=r.replace(/\0\0/g,"%")),c.length>t?0:(b.set(c,e>>>0),c.length-1);}var ae,se,ue=[],le=[],ce=function ce(e,t){if(!se){se=new WeakMap();var r=ae.length;if(se)for(var n=0;n<0+r;n++){var i=n,o=ue[i];o||(i>=ue.length&&(ue.length=i+1),ue[i]=o=ae.get(i)),(i=o)&&se.set(i,n);}}if(r=se.get(e)||0)return r;if(le.length)r=le.pop();else{try{ae.grow(1);}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e;}r=ae.length-1;}try{n=r,ae.set(n,e),ue[n]=ae.get(n);}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){n=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]};for(var a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new n(o,e);}else{for(n=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},n.push(96),128>(a=t.length)?n.push(a):n.push(a%128|128,a>>7),a=0;a<t.length;++a)n.push(o[t[a]]);"v"==i?n.push(0):n.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=n.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,n),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f;}n=r,ae.set(n,t),ue[n]=ae.get(n);}return se.set(e,r),r;},he={a:function a(e,t,r){throw new G(e>>>=0).La(t>>>0,r>>>0),e;},e:function e(){return 0;},L:function L(){},A:function A(){},C:function C(){},u:function u(){return 0;},J:function J(){},E:function E(){},I:function I(){},k:function k(){},B:function B(){},y:function y(){},K:function K(){},z:function z(){},l:function l(){return 1;},o:function o(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),x[r>>>2>>>0]=e.getUTCSeconds(),x[r+4>>>2>>>0]=e.getUTCMinutes(),x[r+8>>>2>>>0]=e.getUTCHours(),x[r+12>>>2>>>0]=e.getUTCDate(),x[r+16>>>2>>>0]=e.getUTCMonth(),x[r+20>>>2>>>0]=e.getUTCFullYear()-1900,x[r+24>>>2>>>0]=e.getUTCDay(),x[r+28>>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0;},p:function p(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),x[r>>>2>>>0]=e.getSeconds(),x[r+4>>>2>>>0]=e.getMinutes(),x[r+8>>>2>>>0]=e.getHours(),x[r+12>>>2>>>0]=e.getDate(),x[r+16>>>2>>>0]=e.getMonth(),x[r+20>>>2>>>0]=e.getFullYear()-1900,x[r+24>>>2>>>0]=e.getDay(),x[r+28>>>2>>>0]=(K(e.getFullYear())?X:Z)[e.getMonth()]+e.getDate()-1|0,x[r+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();x[r+32>>>2>>>0]=0|(t!=n&&e.getTimezoneOffset()==Math.min(n,t));},q:function q(e){e>>>=0;var t=new Date(x[e+20>>>2>>>0]+1900,x[e+16>>>2>>>0],x[e+12>>>2>>>0],x[e+8>>>2>>>0],x[e+4>>>2>>>0],x[e>>>2>>>0],0),r=x[e+32>>>2>>>0],n=t.getTimezoneOffset(),i=new Date(t.getFullYear(),6,1).getTimezoneOffset(),o=new Date(t.getFullYear(),0,1).getTimezoneOffset(),a=Math.min(o,i);return 0>r?x[e+32>>>2>>>0]=+(i!=o&&a==n):0<r!=(a==n)&&(i=Math.max(o,i),t.setTime(t.getTime()+6e4*((0<r?a:i)-n))),x[e+24>>>2>>>0]=t.getDay(),x[e+28>>>2>>>0]=(K(t.getFullYear())?X:Z)[t.getMonth()]+t.getDate()-1|0,x[e>>>2>>>0]=t.getSeconds(),x[e+4>>>2>>>0]=t.getMinutes(),x[e+8>>>2>>>0]=t.getHours(),x[e+12>>>2>>>0]=t.getDate(),x[e+16>>>2>>>0]=t.getMonth(),x[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(x[_de()>>>2>>>0]=61,e=-1):e/=1e3,_me((N=e,1<=+Math.abs(N)?0<N?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)),e>>>0;},m:function m(){return-52;},n:function n(){},w:function w(e,t,r){function n(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT";}r>>>=0;var i=new Date().getFullYear(),o=new Date(i,0,1),a=new Date(i,6,1);i=o.getTimezoneOffset();var s=a.getTimezoneOffset();_[e>>>0>>>2>>>0]=60*Math.max(i,s),x[t>>>0>>>2>>>0]=+(i!=s),e=n(o),t=n(a),e=q(e),t=q(t),s<i?(_[r>>>2>>>0]=e,_[r+4>>>2>>>0]=t):(_[r>>>2>>>0]=t,_[r+4>>>2>>>0]=e);},d:function d(){R("");},D:function D(e,t,r){e>>>=0,t>>>=0,r>>>=0,J.length=0;for(var n;n=_v2[t++>>>0];){var i=105!=n;r+=(i&=112!=n)&&r%8?4:0,J.push(112==n?_[r>>>2>>>0]:105==n?x[r>>>2>>>0]:S[r>>>3>>>0]),r+=i?8:4;}return U[e].apply(null,J);},g:function g(){return Date.now();},x:function x(){return 4294901760;},b:function b(){return performance.now();},H:function H(e,t,r){return t>>>=0,_v2.copyWithin(e>>>0>>>0,t>>>0,t+(r>>>0)>>>0);},v:function v(e){e>>>=0;var t=_v2.length;if(4294901760<e)return!1;for(var r=1;4>=r;r*=2){var n=t*(1+.2/r);n=Math.min(n,e+100663296);var i=Math;n=Math.max(e,n);e:{i=(i.min.call(i,4294901760,n+(65536-n%65536)%65536)-w.buffer.byteLength+65535)/65536;try{w.grow(i),I();var o=1;break e;}catch(_unused7){}o=void 0;}if(o)return!0;}return!1;},F:function F(e,t){e>>>=0,t>>>=0;var r=0;return ee().forEach(function(n,i){var o=t+r;for(i=_[e+4*i>>>2>>>0]=o,o=0;o<n.length;++o)b[i++>>>0>>>0]=n.charCodeAt(o);b[i>>>0>>>0]=0,r+=n.length+1;}),0;},G:function G(e,t){e>>>=0,t>>>=0;var r=ee();_[e>>>2>>>0]=r.length;var n=0;return r.forEach(function(e){return n+=e.length+1;}),_[t>>>2>>>0]=n,0;},f:function f(){return 52;},j:function j(){return 52;},r:function r(){return 70;},i:function i(e,t,r,n){t>>>=0,r>>>=0,n>>>=0;for(var i=0,o=0;o<r;o++){var a=_[t>>>2>>>0],s=_[t+4>>>2>>>0];t+=8;for(var u=0;u<s;u++){var l=_v2[a+u>>>0],c=te[e];0===l||10===l?((1===e?m:g)(V(c,0)),c.length=0):c.push(l);}i+=s;}return _[n>>>2>>>0]=i,0;},s:function s(e,t){return e>>>=0,_re(_v2.subarray(e>>>0,e+(t>>>0)>>>0)),0;},t:oe,c:function c(e,t,r,n){return oe(e>>>0,t>>>0,r>>>0,n>>>0);},h:function h(e,t,r,n){var i=ae.length;e=new Uint8Array(_v2.slice(e+t,e+r));try{var o,a=new WebAssembly.Module(e),s=new WebAssembly.Instance(a,{env:{memory:w}});for(o in s.exports)ce(s.exports[o]);return i<ae.length?i:n;}catch(e){return console.log(e),n;}}},fe=function(){function e(e){return fe=e.exports,fe=function(){var e=fe;e=Object.assign({},e);var t=function t(e){return function(){return e()>>>0;};},r=function r(e){return function(t){return e(t)>>>0;};};return e.pa=t(e.pa),e.qa=r(e.qa),e.ua=t(e.ua),e.wa=r(e.wa),e;}(),w=fe.M,I(),ae=fe.sa,A.unshift(fe.N),0==--O&&(null!==P&&(clearInterval(P),P=null),k&&(e=k,k=null,e())),fe;}var t={a:he};if(O++,i.instantiateWasm)try{return i.instantiateWasm(t,e);}catch(e){g("Module.instantiateWasm callback failed with error: ".concat(e)),n(e);}return function(e,t){var r=B;return"function"!=typeof WebAssembly.instantiateStreaming||$(r)||D(r)||f||"function"!=typeof fetch?F(r,e,t):fetch(r,{credentials:"same-origin"}).then(function(n){return WebAssembly.instantiateStreaming(n,e).then(t,function(n){return g("wasm streaming compile failed: ".concat(n)),g("falling back to ArrayBuffer instantiation"),F(r,e,t);});});}(t,function(t){e(t.instance);})["catch"](n),{};}();i._OrtInit=function(e,t){return(i._OrtInit=fe.O)(e,t);},i._OrtGetLastError=function(e,t){return(i._OrtGetLastError=fe.P)(e,t);},i._OrtCreateSessionOptions=function(e,t,r,n,o,a,s,u,l,c){return(i._OrtCreateSessionOptions=fe.Q)(e,t,r,n,o,a,s,u,l,c);},i._OrtAppendExecutionProvider=function(e,t){return(i._OrtAppendExecutionProvider=fe.R)(e,t);},i._OrtAddFreeDimensionOverride=function(e,t,r){return(i._OrtAddFreeDimensionOverride=fe.S)(e,t,r);},i._OrtAddSessionConfigEntry=function(e,t,r){return(i._OrtAddSessionConfigEntry=fe.T)(e,t,r);},i._OrtReleaseSessionOptions=function(e){return(i._OrtReleaseSessionOptions=fe.U)(e);},i._OrtCreateSession=function(e,t,r){return(i._OrtCreateSession=fe.V)(e,t,r);},i._OrtReleaseSession=function(e){return(i._OrtReleaseSession=fe.W)(e);},i._OrtGetInputOutputCount=function(e,t,r){return(i._OrtGetInputOutputCount=fe.X)(e,t,r);},i._OrtGetInputName=function(e,t){return(i._OrtGetInputName=fe.Y)(e,t);},i._OrtGetOutputName=function(e,t){return(i._OrtGetOutputName=fe.Z)(e,t);},i._OrtFree=function(e){return(i._OrtFree=fe._)(e);},i._OrtCreateTensor=function(e,t,r,n,o,a){return(i._OrtCreateTensor=fe.$)(e,t,r,n,o,a);},i._OrtGetTensorData=function(e,t,r,n,o){return(i._OrtGetTensorData=fe.aa)(e,t,r,n,o);},i._OrtReleaseTensor=function(e){return(i._OrtReleaseTensor=fe.ba)(e);},i._OrtCreateRunOptions=function(e,t,r,n){return(i._OrtCreateRunOptions=fe.ca)(e,t,r,n);},i._OrtAddRunConfigEntry=function(e,t,r){return(i._OrtAddRunConfigEntry=fe.da)(e,t,r);},i._OrtReleaseRunOptions=function(e){return(i._OrtReleaseRunOptions=fe.ea)(e);},i._OrtCreateBinding=function(e){return(i._OrtCreateBinding=fe.fa)(e);},i._OrtBindInput=function(e,t,r){return(i._OrtBindInput=fe.ga)(e,t,r);},i._OrtBindOutput=function(e,t,r,n){return(i._OrtBindOutput=fe.ha)(e,t,r,n);},i._OrtClearBoundOutputs=function(e){return(i._OrtClearBoundOutputs=fe.ia)(e);},i._OrtReleaseBinding=function(e){return(i._OrtReleaseBinding=fe.ja)(e);},i._OrtRunWithBinding=function(e,t,r,n,o){return(i._OrtRunWithBinding=fe.ka)(e,t,r,n,o);},i._OrtRun=function(e,t,r,n,o,a,s,u){return(i._OrtRun=fe.la)(e,t,r,n,o,a,s,u);},i._OrtEndProfiling=function(e){return(i._OrtEndProfiling=fe.ma)(e);},i._OrtConfigure=function(e,t){return(i._OrtConfigure=fe.na)(e,t);},i._OrtAuth=function(e,t){return(i._OrtAuth=fe.oa)(e,t);};var _de=function de(){return(_de=fe.pa)();},pe=i._malloc=function(e){return(pe=i._malloc=fe.qa)(e);};i._free=function(e){return(i._free=fe.ra)(e);};var ye,_me=function me(e){return(_me=fe.ta)(e);},_ge=function ge(){return(_ge=fe.ua)();},_we=function we(e){return(_we=fe.va)(e);},_be=function be(e){return(_be=fe.wa)(e);};function ve(){if(!(0<O)){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;){var e=i.preRun.shift();E.unshift(e);}for(;0<E.length;)E.shift()(i);if(!(0<O||ye||(ye=!0,i.calledRun=!0,T))){for(;0<A.length;)A.shift()(i);for(r(i);0<C.length;)C.shift()(i);}}}return i.___start_em_js=882613,i.___stop_em_js=883225,i.stackAlloc=_be,i.stackSave=_ge,i.stackRestore=_we,i.addFunction=ce,i.UTF8ToString=H,i.stringToUTF8=function(e,t,r){return Y(e,_v2,t,r);},i.lengthBytesUTF8=W,k=function e(){ye||ve(),ye||(k=e);},ve(),t.ready;};}();"object"==_typeof2(e)&&"object"==_typeof2(t)?t.exports=r:"function"==typeof define&&define.amd&&define([],function(){return r;});}),kp=ye(function(){}),Np=ye(function(){}),Rp={};cr(Rp,{cpus:function cpus(){return gg;}});var gg,Mp=L(function(){gg=void 0;}),zp=ye(function(e,t){var r=function(){var e=(typeof document==="undefined"?"undefined":_typeof2(document))<"u"&&document.currentScript?document.currentScript.src:void 0;return(typeof __filename==="undefined"?"undefined":_typeof2(__filename))<"u"&&(e=e||__filename),function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};function r(){return C.buffer!=k.buffer&&L(),k;}function n(){return C.buffer!=k.buffer&&L(),R;}function i(){return C.buffer!=k.buffer&&L(),B;}function o(){return C.buffer!=k.buffer&&L(),$;}function a(){return C.buffer!=k.buffer&&L(),D;}var s,u,l=t;l.ready=new Promise(function(e,t){s=e,u=t;});var c,h,f,d=Object.assign({},l),p="./this.program",y=function y(e,t){throw t;},m="object"==(typeof window==="undefined"?"undefined":_typeof2(window)),g="function"==typeof importScripts,w="object"==_typeof2(process)&&"object"==_typeof2(process.versions)&&"string"==typeof process.versions.node,b=l.ENVIRONMENT_IS_PTHREAD||!1,v="";function x(e){return l.locateFile?l.locateFile(e,v):v+e;}if(w){var _=(sa(),Ht(aa)),S=(la(),Ht(ua));var _e202;v=g?S.dirname(v)+"/":__dirname+"/",c=function c(e,t){return e=X(e)?new URL(e):S.normalize(e),_.readFileSync(e,t?void 0:"utf8");},f=function f(e){return(e=c(e,!0)).buffer||(e=new Uint8Array(e)),e;},h=function h(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!0;e=X(e)?new URL(e):S.normalize(e),_.readFile(e,n?void 0:"utf8",function(e,i){e?r(e):t(n?i.buffer:i);});},!l.thisProgram&&1<process.argv.length&&(p=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),y=function y(e,t){throw process.exitCode=e,t;},l.inspect=function(){return"[Emscripten Module object]";};try{_e202=kp();}catch(e){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),e;}global.Worker=_e202.Worker;}else(m||g)&&(g?v=self.location.href:(typeof document==="undefined"?"undefined":_typeof2(document))<"u"&&document.currentScript&&(v=document.currentScript.src),_typeof2(e)<"u"&&e&&(v=e),v=0!==v.indexOf("blob:")?v.substr(0,v.replace(/[?#].*/,"").lastIndexOf("/")+1):"",w||(c=function c(e){var t=new XMLHttpRequest();return t.open("GET",e,!1),t.send(null),t.responseText;},g&&(f=function f(e){var t=new XMLHttpRequest();return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response);}),h=function h(e,t,r){var n=new XMLHttpRequest();n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):r();},n.onerror=r,n.send(null);}));w&&(typeof performance==="undefined"?"undefined":_typeof2(performance))>"u"&&(global.performance=Np().performance);var T=console.log.bind(console),I=console.error.bind(console);w&&(T=function T(){for(var _len=arguments.length,e=new Array(_len),_key=0;_key<_len;_key++){e[_key]=arguments[_key];}return _.writeSync(1,e.join(" ")+"\n");},I=function I(){for(var _len2=arguments.length,e=new Array(_len2),_key2=0;_key2<_len2;_key2++){e[_key2]=arguments[_key2];}return _.writeSync(2,e.join(" ")+"\n");});var E=T,A=I;Object.assign(l,d),d=null,"object"!=(typeof WebAssembly==="undefined"?"undefined":_typeof2(WebAssembly))&&W("no native wasm support detected");var C,O,P,k,R,B,$,D,M=!1;function L(){var e=C.buffer;l.HEAP8=k=new Int8Array(e),l.HEAP16=new Int16Array(e),l.HEAPU8=R=new Uint8Array(e),l.HEAPU16=new Uint16Array(e),l.HEAP32=B=new Int32Array(e),l.HEAPU32=$=new Uint32Array(e),l.HEAPF32=new Float32Array(e),l.HEAPF64=D=new Float64Array(e);}var F=16777216;if(b)C=l.wasmMemory;else if(l.wasmMemory)C=l.wasmMemory;else if(!((C=new WebAssembly.Memory({initial:F/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw A("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),w&&A("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");L(),F=C.buffer.byteLength;var N=[],U=[],G=[],j=0,z=null,V=null;function H(){if(0==--j&&(null!==z&&(clearInterval(z),z=null),V)){var e=V;V=null,e();}}function W(e){throw A(e="Aborted("+e+")"),M=!0,P=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),u(e),e;}var Y,K=function K(e){return e.startsWith("data:application/octet-stream;base64,");},X=function X(e){return e.startsWith("file://");};function Z(e){if(f)return f(e);throw"both async and sync fetching of the wasm failed";}function q(e,t,r){return function(e){if(m||g){if("function"==typeof fetch&&!X(e))return fetch(e,{credentials:"same-origin"}).then(function(t){if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer();})["catch"](function(){return Z(e);});if(h)return new Promise(function(t,r){h(e,function(e){return t(new Uint8Array(e));},r);});}return Promise.resolve().then(function(){return Z(e);});}(e).then(function(e){return WebAssembly.instantiate(e,t);}).then(function(e){return e;}).then(r,function(e){A("failed to asynchronously prepare wasm: ".concat(e)),W(e);});}K(Y="ort-wasm-threaded.wasm")||(Y=x(Y));var J,Q={886500:function _(e,t,r,i){if(_typeof2(l)>"u"||!l.hb)return 1;if((e=ae(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=l.hb.get(e)))return 2;if(i>>>=0,(t>>>=0)+(r>>>=0)>e.byteLength)return 3;try{return n().set(e.subarray(t,t+r),i>>>0),0;}catch(_unused8){return 4;}}};function ee(e){this.name="ExitStatus",this.message="Program terminated with exit(".concat(e,")"),this.status=e;}var te=function te(e){e.terminate(),e.onmessage=function(){};},re=function re(e){0==fe.Ta.length&&(he(),fe.bb(fe.Ta[0]));var t=fe.Ta.pop();if(!t)return 6;fe.Ua.push(t),fe.Qa[e.Sa]=t,t.Sa=e.Sa;var r={cmd:"run",start_routine:e.ob,arg:e.lb,pthread_ptr:e.Sa};return w&&t.unref(),t.postMessage(r,e.ub),0;},ne=0,ie=(typeof TextDecoder==="undefined"?"undefined":_typeof2(TextDecoder))<"u"?new TextDecoder("utf8"):void 0,oe=function oe(e,t,r){var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&ie)return ie.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,r):e.subarray(t,r));for(n="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))n+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i));}}else n+=String.fromCharCode(i);}return n;},ae=function ae(e,t){return(e>>>=0)?oe(n(),e,t):"";};function se(e,t){var r=arguments.length-2,n=arguments;return function(e){var t=_Tt();return e=e(),_It(t),e;}(function(){for(var i=_Et(8*r),o=i>>>3,s=0;s<r;s++){var u=n[2+s];a()[o+s>>>0]=u;}return _wt(e,r,i,t);});}function ue(e){var _l$onExit;if(b)return se(0,1,e);P=e,0<ne||(fe.pb(),(_l$onExit=l.onExit)!==null&&_l$onExit!==void 0&&_l$onExit.call(l,e),M=!0),y(e,new ee(e));}var le=function le(e){if(P=e,b)throw pe(e),"unwind";ue(e);};function ce(){for(var e=l.numThreads;e--;)he();N.unshift(function(){j++,function(e){b?e():Promise.all(fe.Ta.map(fe.bb)).then(e);}(function(){return H();});});}function he(){var e=x("ort-wasm-threaded.worker.js");e=new Worker(e),fe.Ta.push(e);}var fe={Ta:[],Ua:[],gb:[],Qa:{},$a:function $a(){b?(fe.receiveObjectTransfer=fe.nb,fe.threadInitTLS=fe.fb,fe.setExitStatus=fe.eb):ce();},eb:function eb(e){return P=e;},xb:["$terminateWorker"],pb:function pb(){var _iterator38=_createForOfIteratorHelper2(fe.Ua),_step38;try{for(_iterator38.s();!(_step38=_iterator38.n()).done;){var e=_step38.value;te(e);}}catch(err){_iterator38.e(err);}finally{_iterator38.f();}var _iterator39=_createForOfIteratorHelper2(fe.Ta),_step39;try{for(_iterator39.s();!(_step39=_iterator39.n()).done;){e=_step39.value;te(e);}}catch(err){_iterator39.e(err);}finally{_iterator39.f();}fe.Ta=[],fe.Ua=[],fe.Qa=[];},cb:function cb(e){var t=e.Sa;delete fe.Qa[t],fe.Ta.push(e),fe.Ua.splice(fe.Ua.indexOf(e),1),e.Sa=0,_bt(t);},nb:function nb(){},fb:function fb(){fe.gb.forEach(function(e){return e();});},bb:function bb(t){return new Promise(function(r){t.onmessage=function(e){var n=(e=e.data).cmd;if(e.targetThread&&e.targetThread!=pt()){var i=fe.Qa[e.targetThread];i?i.postMessage(e,e.transferList):A("Internal error! Worker sent a message \"".concat(n,"\" to target pthread ").concat(e.targetThread,", but that thread no longer exists!"));}else"checkMailbox"===n?Fe():"spawnThread"===n?re(e):"cleanupThread"===n?fe.cb(fe.Qa[e.thread]):"killThread"===n?(e=e.thread,n=fe.Qa[e],delete fe.Qa[e],te(n),_bt(e),fe.Ua.splice(fe.Ua.indexOf(n),1),n.Sa=0):"cancelThread"===n?fe.Qa[e.thread].postMessage({cmd:"cancel"}):"loaded"===n?(t.loaded=!0,w&&!t.Sa&&t.unref(),r(t)):"alert"===n?alert("Thread ".concat(e.threadId,": ").concat(e.text)):"setimmediate"===e.target?t.postMessage(e):"callHandler"===n?l[e.handler].apply(l,_toConsumableArray2(e.args)):n&&A("worker sent an unknown command ".concat(n));},t.onerror=function(e){throw A("worker sent an error! ".concat(e.filename,":").concat(e.lineno,": ").concat(e.message)),e;},w&&(t.on("message",function(e){return t.onmessage({data:e});}),t.on("error",function(e){return t.onerror(e);}));var n,i=[];for(var _i55=0,_arr=["onExit"];_i55<_arr.length;_i55++){n=_arr[_i55];l.hasOwnProperty(n)&&i.push(n);}t.postMessage({cmd:"load",handlers:i,urlOrBlob:l.mainScriptUrlOrBlob||e,wasmMemory:C,wasmModule:O});});}};l.PThread=fe;var de=function de(e){for(;0<e.length;)e.shift()(l);};function pe(e){if(b)return se(1,0,e);le(e);}l.establishStackSpace=function(){var e=pt(),t=o()[e+52>>>2>>>0];e=o()[e+56>>>2>>>0],_St(t,t-e),_It(t);};var ye,me=[],ge=function ge(e){var t=me[e];return t||(e>=me.length&&(me.length=e+1),me[e]=t=ye.get(e)),t;};function we(e){this.Za=e-24,this.kb=function(e){o()[this.Za+4>>>2>>>0]=e;},this.jb=function(e){o()[this.Za+8>>>2>>>0]=e;},this.$a=function(e,t){this.ib(),this.kb(e),this.jb(t);},this.ib=function(){o()[this.Za+16>>>2>>>0]=0;};}l.invokeEntryPoint=function(e,t){e=ge(e)(t),0<ne?fe.eb(e):vt(e);};function be(e,t,r,n){return b?se(2,1,e,t,r,n):ve(e,t,r,n);}function ve(e,t,r,n){if(e>>>=0,t>>>=0,r>>>=0,n>>>=0,(typeof SharedArrayBuffer==="undefined"?"undefined":_typeof2(SharedArrayBuffer))>"u")return A("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var i=[];return b&&0===i.length?be(e,t,r,n):(e={ob:r,Sa:e,lb:n,ub:i},b?(e.wb="spawnThread",postMessage(e,i),0):re(e));}function xe(e,t,r){return b?se(3,1,e,t,r):0;}function _e(e,t){if(b)return se(4,1,e,t);}var Se=function Se(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3;}return t;},Te=function Te(e,t,r,n){if(!(0<n))return 0;var i=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o);if(127>=a){if(r>=n)break;t[r++>>>0]=a;}else{if(2047>=a){if(r+1>=n)break;t[r++>>>0]=192|a>>6;}else{if(65535>=a){if(r+2>=n)break;t[r++>>>0]=224|a>>12;}else{if(r+3>=n)break;t[r++>>>0]=240|a>>18,t[r++>>>0]=128|a>>12&63;}t[r++>>>0]=128|a>>6&63;}t[r++>>>0]=128|63&a;}}return t[r>>>0]=0,r-i;},Ie=function Ie(e,t,r){return Te(e,n(),t,r);};function Ee(e,t){if(b)return se(5,1,e,t);}function Ae(e,t,r){if(b)return se(6,1,e,t,r);}function Ce(e,t,r){return b?se(7,1,e,t,r):0;}function Oe(e,t){if(b)return se(8,1,e,t);}function Pe(e,t,r){if(b)return se(9,1,e,t,r);}function ke(e,t,r,n){if(b)return se(10,1,e,t,r,n);}function Re(e,t,r,n){if(b)return se(11,1,e,t,r,n);}function Be(e,t,r,n){if(b)return se(12,1,e,t,r,n);}function $e(e){if(b)return se(13,1,e);}function De(e,t){if(b)return se(14,1,e,t);}function Me(e,t,r){if(b)return se(15,1,e,t,r);}function Le(e){e>>>=0,"function"==typeof Atomics.vb&&(Atomics.vb(i(),e>>>2,e).value.then(Fe),e+=128,Atomics.store(i(),e>>>2,1));}l.__emscripten_thread_mailbox_await=Le;var Fe=function Fe(){var e=pt();if(e&&(Le(e),e=_xt,!M))try{if(e(),!(0<ne))try{b?vt(P):le(P);}catch(e){e instanceof ee||"unwind"==e||y(1,e);}}catch(e){e instanceof ee||"unwind"==e||y(1,e);}};l.checkMailbox=Fe;var Ne=[],Ue=function Ue(e){return e%4==0&&(e%100!=0||e%400==0);},Ge=[0,31,60,91,121,152,182,213,244,274,305,335],je=[0,31,59,90,120,151,181,212,243,273,304,334];function ze(e,t,r,n,i,o,a,s){return b?se(16,1,e,t,r,n,i,o,a,s):-52;}function Ve(e,t,r,n,i,o,a){if(b)return se(17,1,e,t,r,n,i,o,a);}var He,We=function We(e){var t=Se(e)+1,r=yt(t);return r&&Ie(e,r,t),r;},Ye=[],Ke={},Xe=function Xe(){if(!He){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==(typeof navigator==="undefined"?"undefined":_typeof2(navigator))&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"};for(e in Ke)void 0===Ke[e]?delete t[e]:t[e]=Ke[e];var r=[];for(e in t)r.push("".concat(e,"=").concat(t[e]));He=r;}return He;};function Ze(e,t){if(b)return se(18,1,e,t);e>>>=0,t>>>=0;var n=0;return Xe().forEach(function(i,a){var s=t+n;for(a=o()[e+4*a>>>2>>>0]=s,s=0;s<i.length;++s)r()[a++>>>0>>>0]=i.charCodeAt(s);r()[a>>>0>>>0]=0,n+=i.length+1;}),0;}function qe(e,t){if(b)return se(19,1,e,t);e>>>=0,t>>>=0;var r=Xe();o()[e>>>2>>>0]=r.length;var n=0;return r.forEach(function(e){return n+=e.length+1;}),o()[t>>>2>>>0]=n,0;}function Je(e){return b?se(20,1,e):52;}function Qe(e,t,r,n){return b?se(21,1,e,t,r,n):52;}function et(e,t,r,n,i){return b?se(22,1,e,t,r,n,i):70;}var tt=[null,[],[]];function rt(e,t,r,i){if(b)return se(23,1,e,t,r,i);t>>>=0,r>>>=0,i>>>=0;for(var a=0,s=0;s<r;s++){var u=o()[t>>>2>>>0],l=o()[t+4>>>2>>>0];t+=8;for(var c=0;c<l;c++){var h=n()[u+c>>>0],f=tt[e];0===h||10===h?((1===e?E:A)(oe(f,0)),f.length=0):f.push(h);}a+=l;}return o()[i>>>2>>>0]=a,0;}var _nt=function nt(e){return(_nt=function(){if("object"==(typeof crypto==="undefined"?"undefined":_typeof2(crypto))&&"function"==typeof crypto.getRandomValues)return function(e){return e.set(crypto.getRandomValues(new Uint8Array(e.byteLength))),e;};if(w)try{var e=(ca(),Ht(fa));if(e.randomFillSync)return function(t){return e.randomFillSync(t);};var t=e.randomBytes;return function(e){return e.set(t(e.byteLength)),e;};}catch(_unused9){}W("initRandomDevice");}())(e);},it=[31,29,31,30,31,30,31,31,30,31,30,31],ot=[31,28,31,30,31,30,31,31,30,31,30,31];function at(e,t,n,a){function s(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e;}function u(e,t){return s(e,t,"0");}function l(e,t){function r(e){return 0>e?-1:0<e?1:0;}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n;}function c(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30);}}function h(e){var t=e.Va;for(e=new Date(new Date(e.Wa+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(Ue(e.getFullYear())?it:ot)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break;}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1));}return r=new Date(e.getFullYear()+1,0,4),t=c(new Date(e.getFullYear(),0,4)),r=c(r),0>=l(t,e)?0>=l(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1;}e>>>=0,t>>>=0,n>>>=0,a>>>=0;var f=o()[a+40>>>2>>>0];for(var d in a={sb:i()[a>>>2>>>0],rb:i()[a+4>>>2>>>0],Xa:i()[a+8>>>2>>>0],ab:i()[a+12>>>2>>>0],Ya:i()[a+16>>>2>>>0],Wa:i()[a+20>>>2>>>0],Ra:i()[a+24>>>2>>>0],Va:i()[a+28>>>2>>>0],yb:i()[a+32>>>2>>>0],qb:i()[a+36>>>2>>>0],tb:f?ae(f):""},n=ae(n),f={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(d,"g"),f[d]);var p="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),y="January February March April May June July August September October November December".split(" ");for(d in f={"%a":function a(e){return p[e.Ra].substring(0,3);},"%A":function A(e){return p[e.Ra];},"%b":function b(e){return y[e.Ya].substring(0,3);},"%B":function B(e){return y[e.Ya];},"%C":function C(e){return u((e.Wa+1900)/100|0,2);},"%d":function d(e){return u(e.ab,2);},"%e":function e(_e203){return s(_e203.ab,2," ");},"%g":function g(e){return h(e).toString().substring(2);},"%G":function G(e){return h(e);},"%H":function H(e){return u(e.Xa,2);},"%I":function I(e){return 0==(e=e.Xa)?e=12:12<e&&(e-=12),u(e,2);},"%j":function j(e){for(var t=0,r=0;r<=e.Ya-1;t+=(Ue(e.Wa+1900)?it:ot)[r++]);return u(e.ab+t,3);},"%m":function m(e){return u(e.Ya+1,2);},"%M":function M(e){return u(e.rb,2);},"%n":function n(){return"\n";},"%p":function p(e){return 0<=e.Xa&&12>e.Xa?"AM":"PM";},"%S":function S(e){return u(e.sb,2);},"%t":function t(){return"\t";},"%u":function u(e){return e.Ra||7;},"%U":function U(e){return u(Math.floor((e.Va+7-e.Ra)/7),2);},"%V":function V(e){var t=Math.floor((e.Va+7-(e.Ra+6)%7)/7);if(2>=(e.Ra+371-e.Va-2)%7&&t++,t)53==t&&(4==(r=(e.Ra+371-e.Va)%7)||3==r&&Ue(e.Wa)||(t=1));else{t=52;var r=(e.Ra+7-e.Va-1)%7;(4==r||5==r&&Ue(e.Wa%400-1))&&t++;}return u(t,2);},"%w":function w(e){return e.Ra;},"%W":function W(e){return u(Math.floor((e.Va+7-(e.Ra+6)%7)/7),2);},"%y":function y(e){return(e.Wa+1900).toString().substring(2);},"%Y":function Y(e){return e.Wa+1900;},"%z":function z(e){return(0<=(e=e.qb)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4);},"%Z":function Z(e){return e.tb;},"%%":function _(){return"%";}},n=n.replace(/%%/g,"\0\0"),f)n.includes(d)&&(n=n.replace(new RegExp(d,"g"),f[d](a)));return d=function(e){var t=Array(Se(e)+1);return Te(e,t,0,t.length),t;}(n=n.replace(/\0\0/g,"%")),d.length>t?0:(function(e,t){r().set(e,t>>>0);}(d,e),d.length-1);}var st,ut=[],lt=function lt(e,t){if(!st){st=new WeakMap();var r=ye.length;if(st)for(var n=0;n<0+r;n++){var i=ge(n);i&&st.set(i,n);}}if(r=st.get(e)||0)return r;if(ut.length)r=ut.pop();else{try{ye.grow(1);}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e;}r=ye.length-1;}try{n=r,ye.set(n,e),me[n]=ye.get(n);}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){n=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]},a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new n(o,e);}else{for(n=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},n.push(96),128>(a=t.length)?n.push(a):n.push(a%128|128,a>>7),a=0;a<t.length;++a)n.push(o[t[a]]);"v"==i?n.push(0):n.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=n.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,n),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f;}n=r,ye.set(n,t),me[n]=ye.get(n);}return st.set(e,r),r;};fe.$a();var ct=[ue,pe,be,xe,_e,Ee,Ae,Ce,Oe,Pe,ke,Re,Be,$e,De,Me,ze,Ve,Ze,qe,Je,Qe,et,rt],ht={b:function b(e,t,r){throw new we(e>>>=0).$a(t>>>0,r>>>0),e;},O:function O(e){mt(e>>>0,!g,1,!m,131072,!1),fe.fb();},m:function m(e){e>>>=0,b?postMessage({cmd:"cleanupThread",thread:e}):fe.cb(fe.Qa[e]);},J:ve,h:xe,U:_e,F:Ee,H:Ae,y:Ce,S:Oe,L:Pe,R:ke,o:Re,G:Be,D:$e,T:De,E:Me,p:function p(){return 1;},B:function B(e,t){(e>>>=0)==t>>>0?setTimeout(function(){return Fe();}):b?postMessage({targetThread:e,cmd:"checkMailbox"}):(e=fe.Qa[e])&&e.postMessage({cmd:"checkMailbox"});},K:function K(e,t,r,n){t>>>=0,Ne.length=r,n=n>>>0>>>3;for(var i=0;i<r;i++)Ne[i]=a()[n+i>>>0];return e=0>e?Q[-e-1]:ct[e],fe.mb=t,t=e.apply(null,Ne),fe.mb=0,t;},M:Le,W:function W(e){w&&fe.Qa[e>>>0].ref();},s:function s(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),i()[r>>>2>>>0]=e.getUTCSeconds(),i()[r+4>>>2>>>0]=e.getUTCMinutes(),i()[r+8>>>2>>>0]=e.getUTCHours(),i()[r+12>>>2>>>0]=e.getUTCDate(),i()[r+16>>>2>>>0]=e.getUTCMonth(),i()[r+20>>>2>>>0]=e.getUTCFullYear()-1900,i()[r+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,i()[r+28>>>2>>>0]=e;},t:function t(e,_t114,r){e=_t114+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*_t114:NaN,r>>>=0,e=new Date(1e3*e),i()[r>>>2>>>0]=e.getSeconds(),i()[r+4>>>2>>>0]=e.getMinutes(),i()[r+8>>>2>>>0]=e.getHours(),i()[r+12>>>2>>>0]=e.getDate(),i()[r+16>>>2>>>0]=e.getMonth(),i()[r+20>>>2>>>0]=e.getFullYear()-1900,i()[r+24>>>2>>>0]=e.getDay(),_t114=(Ue(e.getFullYear())?Ge:je)[e.getMonth()]+e.getDate()-1|0,i()[r+28>>>2>>>0]=_t114,i()[r+36>>>2>>>0]=-60*e.getTimezoneOffset(),_t114=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=0|(_t114!=n&&e.getTimezoneOffset()==Math.min(n,_t114)),i()[r+32>>>2>>>0]=e;},u:function u(e){e>>>=0;var t=new Date(i()[e+20>>>2>>>0]+1900,i()[e+16>>>2>>>0],i()[e+12>>>2>>>0],i()[e+8>>>2>>>0],i()[e+4>>>2>>>0],i()[e>>>2>>>0],0),r=i()[e+32>>>2>>>0],n=t.getTimezoneOffset(),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),a=new Date(t.getFullYear(),0,1).getTimezoneOffset(),s=Math.min(a,o);return 0>r?i()[e+32>>>2>>>0]=+(o!=a&&s==n):0<r!=(s==n)&&(o=Math.max(a,o),t.setTime(t.getTime()+6e4*((0<r?s:o)-n))),i()[e+24>>>2>>>0]=t.getDay(),r=(Ue(t.getFullYear())?Ge:je)[t.getMonth()]+t.getDate()-1|0,i()[e+28>>>2>>>0]=r,i()[e>>>2>>>0]=t.getSeconds(),i()[e+4>>>2>>>0]=t.getMinutes(),i()[e+8>>>2>>>0]=t.getHours(),i()[e+12>>>2>>>0]=t.getDate(),i()[e+16>>>2>>>0]=t.getMonth(),i()[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(i()[_dt()>>>2>>>0]=61,e=-1):e/=1e3,_t115((J=e,1<=+Math.abs(J)?0<J?+Math.floor(J/4294967296)>>>0:~~+Math.ceil((J-+(~~J>>>0))/4294967296)>>>0:0)),e>>>0;},q:ze,r:Ve,A:function A(e,t,r){function n(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT";}e>>>=0,t>>>=0,r>>>=0;var a=new Date().getFullYear(),s=new Date(a,0,1),u=new Date(a,6,1);a=s.getTimezoneOffset();var l=u.getTimezoneOffset(),c=Math.max(a,l);o()[e>>>2>>>0]=60*c,i()[t>>>2>>>0]=+(a!=l),e=n(s),t=n(u),e=We(e),t=We(t),l<a?(o()[r>>>2>>>0]=e,o()[r+4>>>2>>>0]=t):(o()[r>>>2>>>0]=t,o()[r+4>>>2>>>0]=e);},c:function c(){W("");},N:function N(e,t,r){e>>>=0,t>>>=0,r>>>=0,Ye.length=0;for(var s;s=n()[t++>>>0];){var u=105!=s;r+=(u&=112!=s)&&r%8?4:0,Ye.push(112==s?o()[r>>>2>>>0]:105==s?i()[r>>>2>>>0]:a()[r>>>3>>>0]),r+=u?8:4;}return Q[e].apply(null,Ye);},n:function n(){},i:function i(){return Date.now();},V:function V(){throw ne+=1,"unwind";},C:function C(){return 4294901760;},e:function e(){return performance.timeOrigin+performance.now();},f:function f(){return w?(Mp(),Ht(Rp)).cpus().length:navigator.hardwareConcurrency;},z:function z(e){e>>>=0;var t=n().length;if(e<=t||4294901760<e)return!1;for(var r=1;4>=r;r*=2){var i=t*(1+.2/r);i=Math.min(i,e+100663296);var o=Math;i=Math.max(e,i);e:{o=(o.min.call(o,4294901760,i+(65536-i%65536)%65536)-C.buffer.byteLength+65535)/65536;try{C.grow(o),L();var a=1;break e;}catch(_unused10){}a=void 0;}if(a)return!0;}return!1;},P:Ze,Q:qe,I:le,g:Je,l:Qe,v:et,k:rt,w:function w(e,t){return e>>>=0,t>>>=0,_nt(n().subarray(e>>>0,e+t>>>0)),0;},a:C||l.wasmMemory,x:at,d:function d(e,t,r,n){return at(e>>>0,t>>>0,r>>>0,n>>>0);},j:function j(e,t,r,i){var o=ye.length;e=new Uint8Array(n().slice(e+t,e+r));try{var a,s=new WebAssembly.Module(e),u=new WebAssembly.Instance(s,{env:{memory:C}});for(a in u.exports)lt(u.exports[a]);return o<ye.length?o:i;}catch(e){return console.log(e),i;}}},ft=function(){function e(e,t){return ft=e.exports,ft=function(){var e=ft;e=Object.assign({},e);var t=function t(e){return function(){return e()>>>0;};},r=function r(e){return function(t){return e(t)>>>0;};};return e.za=t(e.za),e.Aa=t(e.Aa),e.Ba=r(e.Ba),e.emscripten_main_runtime_thread_id=t(e.emscripten_main_runtime_thread_id),e.Na=t(e.Na),e.Pa=r(e.Pa),e;}(),fe.gb.push(ft.Da),ye=ft.Ea,U.unshift(ft.X),O=t,H(),ft;}var t={a:ht};if(j++,l.instantiateWasm)try{return l.instantiateWasm(t,e);}catch(e){A("Module.instantiateWasm callback failed with error: ".concat(e)),u(e);}return function(e,t){var r=Y;return"function"!=typeof WebAssembly.instantiateStreaming||K(r)||X(r)||w||"function"!=typeof fetch?q(r,e,t):fetch(r,{credentials:"same-origin"}).then(function(n){return WebAssembly.instantiateStreaming(n,e).then(t,function(n){return A("wasm streaming compile failed: ".concat(n)),A("falling back to ArrayBuffer instantiation"),q(r,e,t);});});}(t,function(t){e(t.instance,t.module);})["catch"](u),{};}();l._OrtInit=function(e,t){return(l._OrtInit=ft.Y)(e,t);},l._OrtGetLastError=function(e,t){return(l._OrtGetLastError=ft.Z)(e,t);},l._OrtCreateSessionOptions=function(e,t,r,n,i,o,a,s,u,c){return(l._OrtCreateSessionOptions=ft._)(e,t,r,n,i,o,a,s,u,c);},l._OrtAppendExecutionProvider=function(e,t){return(l._OrtAppendExecutionProvider=ft.$)(e,t);},l._OrtAddFreeDimensionOverride=function(e,t,r){return(l._OrtAddFreeDimensionOverride=ft.aa)(e,t,r);},l._OrtAddSessionConfigEntry=function(e,t,r){return(l._OrtAddSessionConfigEntry=ft.ba)(e,t,r);},l._OrtReleaseSessionOptions=function(e){return(l._OrtReleaseSessionOptions=ft.ca)(e);},l._OrtCreateSession=function(e,t,r){return(l._OrtCreateSession=ft.da)(e,t,r);},l._OrtReleaseSession=function(e){return(l._OrtReleaseSession=ft.ea)(e);},l._OrtGetInputOutputCount=function(e,t,r){return(l._OrtGetInputOutputCount=ft.fa)(e,t,r);},l._OrtGetInputName=function(e,t){return(l._OrtGetInputName=ft.ga)(e,t);},l._OrtGetOutputName=function(e,t){return(l._OrtGetOutputName=ft.ha)(e,t);},l._OrtFree=function(e){return(l._OrtFree=ft.ia)(e);},l._OrtCreateTensor=function(e,t,r,n,i,o){return(l._OrtCreateTensor=ft.ja)(e,t,r,n,i,o);},l._OrtGetTensorData=function(e,t,r,n,i){return(l._OrtGetTensorData=ft.ka)(e,t,r,n,i);},l._OrtReleaseTensor=function(e){return(l._OrtReleaseTensor=ft.la)(e);},l._OrtCreateRunOptions=function(e,t,r,n){return(l._OrtCreateRunOptions=ft.ma)(e,t,r,n);},l._OrtAddRunConfigEntry=function(e,t,r){return(l._OrtAddRunConfigEntry=ft.na)(e,t,r);},l._OrtReleaseRunOptions=function(e){return(l._OrtReleaseRunOptions=ft.oa)(e);},l._OrtCreateBinding=function(e){return(l._OrtCreateBinding=ft.pa)(e);},l._OrtBindInput=function(e,t,r){return(l._OrtBindInput=ft.qa)(e,t,r);},l._OrtBindOutput=function(e,t,r,n){return(l._OrtBindOutput=ft.ra)(e,t,r,n);},l._OrtClearBoundOutputs=function(e){return(l._OrtClearBoundOutputs=ft.sa)(e);},l._OrtReleaseBinding=function(e){return(l._OrtReleaseBinding=ft.ta)(e);},l._OrtRunWithBinding=function(e,t,r,n,i){return(l._OrtRunWithBinding=ft.ua)(e,t,r,n,i);},l._OrtRun=function(e,t,r,n,i,o,a,s){return(l._OrtRun=ft.va)(e,t,r,n,i,o,a,s);},l._OrtEndProfiling=function(e){return(l._OrtEndProfiling=ft.wa)(e);},l._OrtConfigure=function(e,t){return(l._OrtConfigure=ft.xa)(e,t);},l._OrtAuth=function(e,t){return(l._OrtAuth=ft.ya)(e,t);};var _dt=function dt(){return(_dt=ft.za)();},pt=l._pthread_self=function(){return(pt=l._pthread_self=ft.Aa)();},yt=l._malloc=function(e){return(yt=l._malloc=ft.Ba)(e);};l._free=function(e){return(l._free=ft.Ca)(e);},l.__emscripten_tls_init=function(){return(l.__emscripten_tls_init=ft.Da)();};var mt=l.__emscripten_thread_init=function(e,t,r,n,i,o){return(mt=l.__emscripten_thread_init=ft.Fa)(e,t,r,n,i,o);};l.__emscripten_thread_crashed=function(){return(l.__emscripten_thread_crashed=ft.Ga)();};var gt,_wt=function wt(e,t,r,n){return(_wt=ft.Ha)(e,t,r,n);},_bt=function bt(e){return(_bt=ft.Ia)(e);},vt=l.__emscripten_thread_exit=function(e){return(vt=l.__emscripten_thread_exit=ft.Ja)(e);},_xt=function xt(){return(_xt=ft.Ka)();},_t115=function _t(e){return(_t115=ft.La)(e);},_St=function St(e,t){return(_St=ft.Ma)(e,t);},_Tt=function Tt(){return(_Tt=ft.Na)();},_It=function It(e){return(_It=ft.Oa)(e);},_Et=function Et(e){return(_Et=ft.Pa)(e);};function At(){if(!(0<j))if(b)s(l),b||de(U),startWorker(l);else{if(l.preRun)for("function"==typeof l.preRun&&(l.preRun=[l.preRun]);l.preRun.length;)N.unshift(l.preRun.shift());de(N),0<j||gt||(gt=!0,l.calledRun=!0,M||(b||de(U),s(l),b||de(G)));}}return l.___start_em_js=887001,l.___stop_em_js=887613,l.wasmMemory=C,l.stackAlloc=_Et,l.stackSave=_Tt,l.stackRestore=_It,l.keepRuntimeAlive=function(){return 0<ne;},l.addFunction=lt,l.UTF8ToString=ae,l.stringToUTF8=Ie,l.lengthBytesUTF8=Se,l.ExitStatus=ee,l.PThread=fe,V=function e(){gt||At(),gt||(V=e);},At(),t.ready;};}();"object"==_typeof2(e)&&"object"==_typeof2(t)?t.exports=r:"function"==typeof define&&define.amd&&define([],function(){return r;});}),Wp=ye(function(e,t){t.exports='"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\n';}),Hp,Tg,ha,ma,Bo,Vp,xg,wg,vg,jp,Oe,Kr=L(function(){Hp=Bp(),Tg=zp(),ma=!1,Bo=!1,Vp=!1,xg=function xg(e){if(1===e)return!1;if((typeof SharedArrayBuffer==="undefined"?"undefined":_typeof2(SharedArrayBuffer))>"u")return(typeof self==="undefined"?"undefined":_typeof2(self))<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;_typeof2(process)<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return(typeof MessageChannel==="undefined"?"undefined":_typeof2(MessageChannel))<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]));}catch(_unused11){return!1;}},wg=function wg(){try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]));}catch(_unused12){return!1;}},vg=function vg(e,t){return e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm";},jp=/*#__PURE__*/function(){var _ref14=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee47(e){var t,r,n,i,o,a,s,u,l,c,h;return _regeneratorRuntime2().wrap(function _callee47$(_context48){while(1)switch(_context48.prev=_context48.next){case 0:if(!ma){_context48.next=2;break;}return _context48.abrupt("return",Promise.resolve());case 2:if(!Bo){_context48.next=4;break;}throw new Error("multiple calls to 'initializeWebAssembly()' detected.");case 4:if(!Vp){_context48.next=6;break;}throw new Error("previous call to 'initializeWebAssembly()' failed.");case 6:Bo=!0;t=e.initTimeout,r=e.numThreads,n=e.simd,i=xg(r),o=n&&wg(),a=e.wasmPaths,s="string"==typeof a?a:void 0,u=vg(o,i),l="object"==_typeof2(a)?a[u]:void 0,c=!1,h=[];t>0&&h.push(new Promise(function(e){setTimeout(function(){c=!0,e();},t);}));h.push(new Promise(function(e,t){var n=i?Tg:Hp,o={locateFile:function locateFile(e,t){return i&&e.endsWith(".worker.js")&&(typeof Blob==="undefined"?"undefined":_typeof2(Blob))<"u"?URL.createObjectURL(new Blob([Wp()],{type:"text/javascript"})):e.endsWith(".wasm")?l||(s!==null&&s!==void 0?s:t)+u:t+e;}};if(i)if(o.numThreads=r,(typeof Blob==="undefined"?"undefined":_typeof2(Blob))>"u")o.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{var _e204="var ortWasmThreaded=".concat(n.toString(),";");o.mainScriptUrlOrBlob=new Blob([_e204],{type:"text/javascript"});}n(o).then(function(t){Bo=!1,ma=!0,ha=t,e();},function(e){Bo=!1,Vp=!0,t(e);});}));_context48.next=12;return Promise.race(h);case 12:if(!c){_context48.next=14;break;}throw new Error("WebAssembly backend initializing failed due to timeout: ".concat(t,"ms"));case 14:case"end":return _context48.stop();}},_callee47);}));return function jp(_x55){return _ref14.apply(this,arguments);};}(),Oe=function Oe(){if(ma&&ha)return ha;throw new Error("WebAssembly is not initialized yet.");};}),Ce,_vn,Ae,ko=L(function(){Kr(),Ce=function Ce(e,t){var r=Oe(),n=r.lengthBytesUTF8(e)+1,i=r._malloc(n);return r.stringToUTF8(e,i,n),t.push(i),i;},_vn=function vn(e,t,r,n){if("object"==_typeof2(e)&&null!==e){if(r.has(e))throw new Error("Circular reference in options");r.add(e);}Object.entries(e).forEach(function(_ref15){var _ref16=_slicedToArray2(_ref15,2),e=_ref16[0],i=_ref16[1];var o=t?t+e:e;if("object"==_typeof2(i))_vn(i,o+".",r,n);else if("string"==typeof i||"number"==typeof i)n(o,i.toString());else{if("boolean"!=typeof i)throw new Error("Can't handle extra config type: "+_typeof2(i));n(o,i?"1":"0");}});},Ae=function Ae(e){var t=Oe(),r=t.stackSave();try{var _r159=t.stackAlloc(8);t._OrtGetLastError(_r159,_r159+4);var _n67=t.HEAP32[_r159/4],_i56=t.HEAPU32[_r159/4+1],_o40=_i56?t.UTF8ToString(_i56):"";throw new Error("".concat(e," ERROR_CODE: ").concat(_n67,", ERROR_MESSAGE: ").concat(_o40));}finally{t.stackRestore(r);}};}),qp,Yp=L(function(){Kr(),ko(),qp=function qp(e){var t=Oe(),r=0,n=[],i=e||{};try{if(void 0===(e===null||e===void 0?void 0:e.logSeverityLevel))i.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error("log serverity level is not valid: ".concat(e.logSeverityLevel));if(void 0===(e===null||e===void 0?void 0:e.logVerbosityLevel))i.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw new Error("log verbosity level is not valid: ".concat(e.logVerbosityLevel));void 0===(e===null||e===void 0?void 0:e.terminate)&&(i.terminate=!1);var _o41=0;return void 0!==(e===null||e===void 0?void 0:e.tag)&&(_o41=Ce(e.tag,n)),r=t._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,_o41),0===r&&Ae("Can't create run options."),void 0!==(e===null||e===void 0?void 0:e.extra)&&_vn(e.extra,"",new WeakSet(),function(e,i){var o=Ce(e,n),a=Ce(i,n);0!==t._OrtAddRunConfigEntry(r,o,a)&&Ae("Can't set a run config entry: ".concat(e," - ").concat(i,"."));}),[r,n];}catch(e){throw 0!==r&&t._OrtReleaseRunOptions(r),n.forEach(function(e){return t._free(e);}),e;}};}),_g,Og,Ig,Sg,Xp,Kp=L(function(){Kr(),ko(),_g=function _g(e){switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error("unsupported graph optimization level: ".concat(e));}},Og=function Og(e){switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error("unsupported execution mode: ".concat(e));}},Ig=function Ig(e){e.extra||(e.extra={}),e.extra.session||(e.extra.session={});var t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(function(e){return"webgpu"===("string"==typeof e?e:e.name);})&&(e.enableMemPattern=!1);},Sg=function Sg(e,t,r){var _iterator40=_createForOfIteratorHelper2(t),_step40;try{for(_iterator40.s();!(_step40=_iterator40.n()).done;){var _n68=_step40.value;var _t116="string"==typeof _n68?_n68:_n68.name;switch(_t116){case"webnn":if(_t116="WEBNN","string"!=typeof _n68){var _t117=_n68;if(_t117!==null&&_t117!==void 0&&_t117.deviceType){var _n69=Ce("deviceType",r),_i57=Ce(_t117.deviceType,r);0!==Oe()._OrtAddSessionConfigEntry(e,_n69,_i57)&&Ae("Can't set a session config entry: 'deviceType' - ".concat(_t117.deviceType,"."));}if(_t117!==null&&_t117!==void 0&&_t117.numThreads){var _n70=_t117.numThreads;("number"!=typeof _n70||!Number.isInteger(_n70)||_n70<0)&&(_n70=0);var _i58=Ce("numThreads",r),_o42=Ce(_n70.toString(),r);0!==Oe()._OrtAddSessionConfigEntry(e,_i58,_o42)&&Ae("Can't set a session config entry: 'numThreads' - ".concat(_t117.numThreads,"."));}if(_t117!==null&&_t117!==void 0&&_t117.powerPreference){var _n71=Ce("powerPreference",r),_i59=Ce(_t117.powerPreference,r);0!==Oe()._OrtAddSessionConfigEntry(e,_n71,_i59)&&Ae("Can't set a session config entry: 'powerPreference' - ".concat(_t117.powerPreference,"."));}}break;case"webgpu":if(_t116="JS","string"!=typeof _n68){var _t118=_n68;if(_t118!==null&&_t118!==void 0&&_t118.preferredLayout){if("NCHW"!==_t118.preferredLayout&&"NHWC"!==_t118.preferredLayout)throw new Error("preferredLayout must be either 'NCHW' or 'NHWC': ".concat(_t118.preferredLayout));var _n72=Ce("preferredLayout",r),_i60=Ce(_t118.preferredLayout,r);0!==Oe()._OrtAddSessionConfigEntry(e,_n72,_i60)&&Ae("Can't set a session config entry: 'preferredLayout' - ".concat(_t118.preferredLayout,"."));}}break;case"wasm":case"cpu":continue;default:throw new Error("not supported execution provider: ".concat(_t116));}var _i61=Ce(_t116,r);0!==Oe()._OrtAppendExecutionProvider(e,_i61)&&Ae("Can't append execution provider: ".concat(_t116,"."));}}catch(err){_iterator40.e(err);}finally{_iterator40.f();}},Xp=function Xp(e){var t=Oe(),r=0,n=[],i=e||{};Ig(i);try{var _i$graphOptimizationL,_i$executionMode,_i$logSeverityLevel,_i$logVerbosityLevel;var _e205=_g((_i$graphOptimizationL=i.graphOptimizationLevel)!==null&&_i$graphOptimizationL!==void 0?_i$graphOptimizationL:"all"),_o43=Og((_i$executionMode=i.executionMode)!==null&&_i$executionMode!==void 0?_i$executionMode:"sequential"),_a24="string"==typeof i.logId?Ce(i.logId,n):0,_s18=(_i$logSeverityLevel=i.logSeverityLevel)!==null&&_i$logSeverityLevel!==void 0?_i$logSeverityLevel:2;if(!Number.isInteger(_s18)||_s18<0||_s18>4)throw new Error("log serverity level is not valid: ".concat(_s18));var _u17=(_i$logVerbosityLevel=i.logVerbosityLevel)!==null&&_i$logVerbosityLevel!==void 0?_i$logVerbosityLevel:0;if(!Number.isInteger(_u17)||_u17<0||_u17>4)throw new Error("log verbosity level is not valid: ".concat(_u17));var _l13="string"==typeof i.optimizedModelFilePath?Ce(i.optimizedModelFilePath,n):0;if(r=t._OrtCreateSessionOptions(_e205,!!i.enableCpuMemArena,!!i.enableMemPattern,_o43,!!i.enableProfiling,0,_a24,_s18,_u17,_l13),0===r&&Ae("Can't create session options."),i.executionProviders&&Sg(r,i.executionProviders,n),i.freeDimensionOverrides)for(var _i62=0,_Object$entries=Object.entries(i.freeDimensionOverrides);_i62<_Object$entries.length;_i62++){var _Object$entries$_i=_slicedToArray2(_Object$entries[_i62],2),_e206=_Object$entries$_i[0],_o44=_Object$entries$_i[1];if("string"!=typeof _e206)throw new Error("free dimension override name must be a string: ".concat(_e206));if("number"!=typeof _o44||!Number.isInteger(_o44)||_o44<0)throw new Error("free dimension override value must be a non-negative integer: ".concat(_o44));var _i63=Ce(_e206,n);0!==t._OrtAddFreeDimensionOverride(r,_i63,_o44)&&Ae("Can't set a free dimension override: ".concat(_e206," - ").concat(_o44,"."));}return void 0!==i.extra&&_vn(i.extra,"",new WeakSet(),function(e,i){var o=Ce(e,n),a=Ce(i,n);0!==t._OrtAddSessionConfigEntry(r,o,a)&&Ae("Can't set a session config entry: ".concat(e," - ").concat(i,"."));}),[r,n];}catch(e){throw 0!==r&&t._OrtReleaseSessionOptions(r),n.forEach(function(e){return t._free(e);}),e;}};}),ba,Jp,ga,Zp,Qp,No,ed,ya=L(function(){ba=function ba(e){switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error("unsupported data type: ".concat(e));}},Jp=function Jp(e){switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error("unsupported data type: ".concat(e));}},ga=function ga(e){return[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e];},Zp=function Zp(e){switch(e){case"float16":case"uint16":return Uint16Array;case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error("unsupported type: ".concat(e));}},Qp=function Qp(e){switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error("unsupported logging level: ".concat(e));}},No=function No(e){return"float32"===e||"int32"===e||"int64"===e||"bool"===e||"float16"===e||"uint32"===e;},ed=function ed(e){switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error("unsupported data location: ".concat(e));}};}),_n,Ta=L(function(){_n=/*#__PURE__*/function(){var _ref17=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee48(e){var _t119,_r160,_n73,_r161,_i64,_e207,_o45,_yield$_i64$read,_e208,_t120,_n74,_t121,_r162,_iteratorAbruptCompletion,_didIteratorError,_iteratorError,_iterator,_step,_e209;return _regeneratorRuntime2().wrap(function _callee48$(_context49){while(1)switch(_context49.prev=_context49.next){case 0:if(!("string"!=typeof e)){_context49.next=11;break;}if(!(e instanceof Blob)){_context49.next=9;break;}_context49.t1=Uint8Array;_context49.next=5;return e.arrayBuffer();case 5:_context49.t2=_context49.sent;_context49.t0=new _context49.t1(_context49.t2);_context49.next=10;break;case 9:_context49.t0=e instanceof Uint8Array?e:new Uint8Array(e);case 10:return _context49.abrupt("return",_context49.t0);case 11:if(_typeof2(process)<"u"&&process.versions&&process.versions.node){_context49.next=50;break;}_context49.next=14;return fetch(e);case 14:_t119=_context49.sent;if(_t119.ok){_context49.next=17;break;}throw new Error("failed to load external data file: ".concat(e));case 17:_r160=_t119.headers.get("Content-Length"),_n73=_r160?parseInt(_r160,10):0;if(!(_n73<1073741824)){_context49.next=24;break;}_context49.t3=Uint8Array;_context49.next=22;return _t119.arrayBuffer();case 22:_context49.t4=_context49.sent;return _context49.abrupt("return",new _context49.t3(_context49.t4));case 24:if(_t119.body){_context49.next=26;break;}throw new Error("failed to load external data file: ".concat(e,", no response body."));case 26:_i64=_t119.body.getReader();_context49.prev=27;_r161=new ArrayBuffer(_n73);_context49.next=37;break;case 31:_context49.prev=31;_context49.t5=_context49["catch"](27);if(_context49.t5 instanceof RangeError){_context49.next=35;break;}throw _context49.t5;case 35:_e207=Math.ceil(_n73/65536);_r161=new WebAssembly.Memory({initial:_e207,maximum:_e207}).buffer;case 37:_o45=0;case 38:_context49.next=40;return _i64.read();case 40:_yield$_i64$read=_context49.sent;_e208=_yield$_i64$read.done;_t120=_yield$_i64$read.value;if(!_e208){_context49.next=45;break;}return _context49.abrupt("break",49);case 45:_n74=_t120.byteLength;new Uint8Array(_r161,_o45,_n74).set(_t120),_o45+=_n74;case 47:_context49.next=38;break;case 49:return _context49.abrupt("return",new Uint8Array(_r161,0,_n73));case 50:_context49.prev=50;_context49.t6=Uint8Array;_context49.next=54;return(void 0)(e);case 54:_context49.t7=_context49.sent;return _context49.abrupt("return",new _context49.t6(_context49.t7));case 58:_context49.prev=58;_context49.t8=_context49["catch"](50);if(!("ERR_FS_FILE_TOO_LARGE"===_context49.t8.code)){_context49.next=91;break;}_t121=(void 0)(e),_r162=[];_iteratorAbruptCompletion=false;_didIteratorError=false;_context49.prev=64;_iterator=_asyncIterator(_t121);case 66:_context49.next=68;return _iterator.next();case 68:if(!(_iteratorAbruptCompletion=!(_step=_context49.sent).done)){_context49.next=74;break;}_e209=_step.value;_r162.push(_e209);case 71:_iteratorAbruptCompletion=false;_context49.next=66;break;case 74:_context49.next=80;break;case 76:_context49.prev=76;_context49.t9=_context49["catch"](64);_didIteratorError=true;_iteratorError=_context49.t9;case 80:_context49.prev=80;_context49.prev=81;if(!(_iteratorAbruptCompletion&&_iterator["return"]!=null)){_context49.next=85;break;}_context49.next=85;return _iterator["return"]();case 85:_context49.prev=85;if(!_didIteratorError){_context49.next=88;break;}throw _iteratorError;case 88:return _context49.finish(85);case 89:return _context49.finish(80);case 90:return _context49.abrupt("return",new Uint8Array(Buffer.concat(_r162)));case 91:throw _context49.t8;case 92:case"end":return _context49.stop();}},_callee48,null,[[27,31],[50,58],[64,76,80,90],[81,,85,89]]);}));return function _n(_x56){return _ref17.apply(this,arguments);};}();}),Ag,rd,nd,On,Eg,xa,od,id,Pg,td,ad,sd,ud,ld,wa,fd=L(function(){Yp(),Kp(),ya(),Kr(),ko(),Ta(),Ag=function Ag(e,t){0!==Oe()._OrtInit(e,t)&&Ae("Can't initialize onnxruntime.");},rd=/*#__PURE__*/function(){var _ref18=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee49(e){return _regeneratorRuntime2().wrap(function _callee49$(_context50){while(1)switch(_context50.prev=_context50.next){case 0:Ag(e.wasm.numThreads,Qp(e.logLevel));case 1:case"end":return _context50.stop();}},_callee49);}));return function rd(_x57){return _ref18.apply(this,arguments);};}(),nd=/*#__PURE__*/function(){var _ref19=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee50(e,t){return _regeneratorRuntime2().wrap(function _callee50$(_context51){while(1)switch(_context51.prev=_context51.next){case 0:case"end":return _context51.stop();}},_callee50);}));return function nd(_x58,_x59){return _ref19.apply(this,arguments);};}(),On=new Map(),Eg=function Eg(e){var t=Oe(),r=t.stackSave();try{var _r163=t.stackAlloc(8);return 0!==t._OrtGetInputOutputCount(e,_r163,_r163+4)&&Ae("Can't get session input/output count."),[t.HEAP32[_r163/4],t.HEAP32[_r163/4+1]];}finally{t.stackRestore(r);}},xa=function xa(e){var t=Oe(),r=t._malloc(e.byteLength);if(0===r)throw new Error("Can't create a session. failed to allocate a buffer of size ".concat(e.byteLength,"."));return t.HEAPU8.set(e,r),[r,e.byteLength];},od=/*#__PURE__*/function(){var _ref20=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee51(e,t){var _e210,_e211,_ref21,_xa,_xa2;var r,n,i,o,a,s,u,l,_Xp,_Xp2,_e212,_iterator41,_step41,_loop8,_Eg,_Eg2,_e213,_c12,_h10,_f9,_t122,_e214,_e215,_t123,_r164,_d8,_i$unmountExternalDat;return _regeneratorRuntime2().wrap(function _callee51$(_context53){while(1)switch(_context53.prev=_context53.next){case 0:i=Oe();Array.isArray(e)?(_e210=e,_e211=_slicedToArray2(_e210,2),r=_e211[0],n=_e211[1],_e210):e.buffer===i.HEAPU8.buffer?(_ref21=[e.byteOffset,e.byteLength],r=_ref21[0],n=_ref21[1],_ref21):(_xa=xa(e),_xa2=_slicedToArray2(_xa,2),r=_xa2[0],n=_xa2[1],_xa);o=0,a=0,s=[],u=[],l=[];_context53.prev=3;if(!(_Xp=Xp(t),_Xp2=_slicedToArray2(_Xp,2),a=_Xp2[0],s=_Xp2[1],t!==null&&t!==void 0&&t.externalData&&i.mountExternalData)){_context53.next=24;break;}_e212=[];_iterator41=_createForOfIteratorHelper2(t.externalData);_context53.prev=7;_loop8=/*#__PURE__*/_regeneratorRuntime2().mark(function _loop8(){var r,t;return _regeneratorRuntime2().wrap(function _loop8$(_context52){while(1)switch(_context52.prev=_context52.next){case 0:r=_step41.value;t="string"==typeof r?r:r.path;_e212.push(_n("string"==typeof r?r:r.data).then(function(e){i.mountExternalData(t,e);}));case 3:case"end":return _context52.stop();}},_loop8);});_iterator41.s();case 10:if((_step41=_iterator41.n()).done){_context53.next=14;break;}return _context53.delegateYield(_loop8(),"t0",12);case 12:_context53.next=10;break;case 14:_context53.next=19;break;case 16:_context53.prev=16;_context53.t1=_context53["catch"](7);_iterator41.e(_context53.t1);case 19:_context53.prev=19;_iterator41.f();return _context53.finish(19);case 22:_context53.next=24;return Promise.all(_e212);case 24:o=i._OrtCreateSession(r,n,a),0===o&&Ae("Can't create a session.");_Eg=Eg(o),_Eg2=_slicedToArray2(_Eg,2),_e213=_Eg2[0],_c12=_Eg2[1],_h10=[],_f9=[];for(_t122=0;_t122<_e213;_t122++){_e214=i._OrtGetInputName(o,_t122);0===_e214&&Ae("Can't get an input name."),u.push(_e214),_h10.push(i.UTF8ToString(_e214));}for(_e215=0;_e215<_c12;_e215++){_t123=i._OrtGetOutputName(o,_e215);0===_t123&&Ae("Can't get an output name."),l.push(_t123);_r164=i.UTF8ToString(_t123);_f9.push(_r164);}_d8=null;return _context53.abrupt("return",(On.set(o,[o,u,l,_d8]),[o,_h10,_f9]));case 32:_context53.prev=32;_context53.t2=_context53["catch"](3);throw u.forEach(function(e){return i._OrtFree(e);}),l.forEach(function(e){return i._OrtFree(e);}),0!==o&&i._OrtReleaseSession(o),_context53.t2;case 35:_context53.prev=35;i._free(r),0!==a&&i._OrtReleaseSessionOptions(a),s.forEach(function(e){return i._free(e);}),(_i$unmountExternalDat=i.unmountExternalData)===null||_i$unmountExternalDat===void 0?void 0:_i$unmountExternalDat.call(i);return _context53.finish(35);case 38:case"end":return _context53.stop();}},_callee51,null,[[3,32,35,38],[7,16,19,22]]);}));return function od(_x60,_x61){return _ref20.apply(this,arguments);};}(),id=function id(e){var _t$jsepUnregisterBuff;var t=Oe(),r=On.get(e);if(!r)throw new Error("cannot release session. invalid session id: ".concat(e));var _r165=_slicedToArray2(r,4),n=_r165[0],i=_r165[1],o=_r165[2],a=_r165[3];a&&t._OrtReleaseBinding(a.handle),(_t$jsepUnregisterBuff=t.jsepUnregisterBuffers)!==null&&_t$jsepUnregisterBuff!==void 0&&_t$jsepUnregisterBuff.call(t,e),i.forEach(function(e){return t._OrtFree(e);}),o.forEach(function(e){return t._OrtFree(e);}),t._OrtReleaseSession(n),On["delete"](e);},Pg=function Pg(e,t,r){if(null!==e&&e[0]===t){var _t124=e[2];if(_t124.length===r)return _t124;}return new(Zp(t))(r);},td=function td(e,t,r,n,i){if(!e)return void t.push(0);var o,a,s=Oe(),u=e[0],l=e[1],c=e[3];if("string"===u&&"gpu-buffer"===c)throw new Error("String tensor is not supported on GPU.");if("gpu-buffer"===c){var _t125=e[2].gpuBuffer,_r166=ga(ba(u));a=l.reduce(function(e,t){return e*t;},1)*_r166,o=s.jsepRegisterBuffer(n,i,_t125,a);}else{var _t126=e[2];if(Array.isArray(_t126)){a=4*_t126.length,o=s._malloc(a),r.push(o);var _e216=o/4;for(var _n75=0;_n75<_t126.length;_n75++){if("string"!=typeof _t126[_n75])throw new TypeError("tensor data at index ".concat(_n75," is not a string"));s.HEAPU32[_e216++]=Ce(_t126[_n75],r);}}else a=_t126.byteLength,o=s._malloc(a),r.push(o),s.HEAPU8.set(new Uint8Array(_t126.buffer,_t126.byteOffset,a),o);}var h=s.stackSave(),f=s.stackAlloc(4*l.length);try{var _e217=f/4;l.forEach(function(t){return s.HEAP32[_e217++]=t;});var _r167=s._OrtCreateTensor(ba(u),o,a,f,l.length,ed(c));0===_r167&&Ae("Can't create tensor for input/output. session=".concat(n,", index=").concat(i,".")),t.push(_r167);}finally{s.stackRestore(h);}},ad=function ad(e){var t=new TextEncoder().encode(e),r=Oe(),n=r._malloc(t.byteLength);r.HEAPU8.set(t,n);var i=r._OrtConfigure(n,t.byteLength);if(0===i)throw new Error("Can't get an configure key");var o=r.UTF8ToString(i);return r._OrtFree(i),o;},sd=function sd(e){var t=new TextEncoder().encode(e),r=Oe(),n=r._malloc(t.byteLength);r.HEAPU8.set(t,n);var i=r._OrtAuth(n,t.byteLength);if(0===i)throw new Error("Can't get an auth result");var o=r.UTF8ToString(i);return r._OrtFree(i),o;},ud=/*#__PURE__*/function(){var _ref22=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee52(e,t,r,n,i,o){var a,s,_s19,u,l,c,h,f,d,p,y,m,g,w,b,v,x,_,S,_qp,_qp2,_n76,_t127,_r168$,_r168,_s20,_b3,T,_I,_E,_e218,_e219,A,_loop9,_e220;return _regeneratorRuntime2().wrap(function _callee52$(_context55){while(1)switch(_context55.prev=_context55.next){case 0:a=Oe(),s=On.get(e);if(s){_context55.next=3;break;}throw new Error("cannot run inference. invalid session id: ".concat(e));case 3:_s19=_slicedToArray2(s,4),u=_s19[0],l=_s19[1],c=_s19[2],h=_s19[3],f=t.length,d=n.length,p=0,y=[],m=[],g=[],w=[],b=a.stackSave(),v=a.stackAlloc(4*f),x=a.stackAlloc(4*f),_=a.stackAlloc(4*d),S=a.stackAlloc(4*d);_context55.prev=4;_qp=qp(o);_qp2=_slicedToArray2(_qp,2);p=_qp2[0];y=_qp2[1];for(_n76=0;_n76<f;_n76++)td(r[_n76],m,w,e,t[_n76]);for(_t127=0;_t127<d;_t127++){_r168=i[_t127];td("gpu-buffer"===((_r168$=_r168===null||_r168===void 0?void 0:_r168[3])!==null&&_r168$!==void 0?_r168$:"")?_r168:null,g,w,e,f+n[_t127]);}_b3=v/4,T=x/4,_I=_/4,_E=S/4;for(_e218=0;_e218<f;_e218++)a.HEAPU32[_b3++]=m[_e218],a.HEAPU32[T++]=l[t[_e218]];for(_e219=0;_e219<d;_e219++)a.HEAPU32[_I++]=g[_e219],a.HEAPU32[_E++]=c[n[_e219]];_context55.next=16;return a._OrtRun(u,x,v,f,S,d,_,p);case 16:_s20=_context55.sent;0!==_s20&&Ae("failed to call OrtRun().");A=[];_loop9=/*#__PURE__*/_regeneratorRuntime2().mark(function _loop9(){var t,r,o,s,u,l,_o46,_c13,_f10,_d9,_p7,_e221,_y4,_m4,_e222,_t128,_r169,_n77,_i65,_e223,_n78,_t129;return _regeneratorRuntime2().wrap(function _loop9$(_context54){while(1)switch(_context54.prev=_context54.next){case 0:t=a.HEAPU32[_/4+_e220];if(!(t===g[_e220])){_context54.next=4;break;}A.push(i[_e220]);return _context54.abrupt("return",1);case 4:o=a.stackSave(),s=a.stackAlloc(16),u=!1,l=0;_context54.prev=5;0!==a._OrtGetTensorData(t,s,s+4,s+8,s+12)&&Ae("Can't access output tensor data on index ".concat(_e220,"."));_o46=s/4,_c13=a.HEAPU32[_o46++];l=a.HEAPU32[_o46++];_f10=a.HEAPU32[_o46++],_d9=a.HEAPU32[_o46++],_p7=[];for(_e221=0;_e221<_d9;_e221++)_p7.push(a.HEAPU32[_f10/4+_e221]);a._OrtFree(_f10);_y4=_p7.reduce(function(e,t){return e*t;},1);r=Jp(_c13);_m4=h===null||h===void 0?void 0:h.outputPreferredLocations[n[_e220]];if(!("string"===r)){_context54.next=23;break;}if(!("gpu-buffer"===_m4)){_context54.next=18;break;}throw new Error("String tensor is not supported on GPU.");case 18:_e222=[],_t128=l/4;for(_r169=0;_r169<_y4;_r169++){_n77=a.HEAPU32[_t128++],_i65=_r169===_y4-1?void 0:a.HEAPU32[_t128]-_n77;_e222.push(a.UTF8ToString(_n77,_i65));}A.push([r,_p7,_e222,"cpu"]);_context54.next=32;break;case 23:if(!("gpu-buffer"===_m4&&_y4>0)){_context54.next=30;break;}_e223=a.jsepGetBuffer(l),_n78=ga(_c13);if(!(void 0===_n78||!No(r))){_context54.next=27;break;}throw new Error("Unsupported data type: ".concat(r));case 27:u=!0,A.push([r,_p7,{gpuBuffer:_e223,download:a.jsepCreateDownloader(_e223,_y4*_n78,r),dispose:function dispose(){a._OrtReleaseTensor(t);}},"gpu-buffer"]);_context54.next=32;break;case 30:_t129=Pg(i[_e220],r,_y4);new Uint8Array(_t129.buffer,_t129.byteOffset,_t129.byteLength).set(a.HEAPU8.subarray(l,l+_t129.byteLength)),A.push([r,_p7,_t129,"cpu"]);case 32:_context54.prev=32;a.stackRestore(o),"string"===r&&l&&a._free(l),u||a._OrtReleaseTensor(t);return _context54.finish(32);case 35:case"end":return _context54.stop();}},_loop9,null,[[5,,32,35]]);});_e220=0;case 21:if(!(_e220<d)){_context55.next=28;break;}return _context55.delegateYield(_loop9(),"t0",23);case 23:if(!_context55.t0){_context55.next=25;break;}return _context55.abrupt("continue",25);case 25:_e220++;_context55.next=21;break;case 28:return _context55.abrupt("return",(h&&a._OrtClearBoundOutputs(h.handle),A));case 29:_context55.prev=29;a.stackRestore(b),m.forEach(function(e){return a._OrtReleaseTensor(e);}),g.forEach(function(e){return a._OrtReleaseTensor(e);}),w.forEach(function(e){return a._free(e);}),0!==p&&a._OrtReleaseRunOptions(p),y.forEach(function(e){return a._free(e);});return _context55.finish(29);case 32:case"end":return _context55.stop();}},_callee52,null,[[4,,29,32]]);}));return function ud(_x62,_x63,_x64,_x65,_x66,_x67){return _ref22.apply(this,arguments);};}(),ld=function ld(e){var t=Oe(),r=On.get(e);if(!r)throw new Error("invalid session id");var n=r[0],i=t._OrtEndProfiling(n);0===i&&Ae("Can't get an profile file name."),t._OrtFree(i);},wa=function wa(e){var t=[];var _iterator42=_createForOfIteratorHelper2(e),_step42;try{for(_iterator42.s();!(_step42=_iterator42.n()).done;){var _r170=_step42.value;var _e224=_r170[2];!Array.isArray(_e224)&&"buffer"in _e224&&t.push(_e224.buffer);}}catch(err){_iterator42.e(err);}finally{_iterator42.f();}return t;};}),cd=ye(function(e,t){t.exports='/*!\n * ONNX Runtime Web v1.17.0\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n"use strict";(()=>{var Dt=Object.defineProperty;var on=Object.getOwnPropertyDescriptor;var sn=Object.getOwnPropertyNames;var un=Object.prototype.hasOwnProperty;var Ot=(i,d)=>()=>(i&&(d=i(i=0)),d);var it=(i,d)=>()=>(d||i((d={exports:{}}).exports,d),d.exports),vt=(i,d)=>{for(var o in d)Dt(i,o,{get:d[o],enumerable:!0})},fn=(i,d,o,m)=>{if(d&&typeof d=="object"||typeof d=="function")for(let l of sn(d))!un.call(i,l)&&l!==o&&Dt(i,l,{get:()=>d[l],enumerable:!(m=on(d,l))||m.enumerable});return i};var ze=i=>fn(Dt({},"__esModule",{value:!0}),i);var Ft={};vt(Ft,{createReadStream:()=>Or,readFile:()=>ln,readFileSync:()=>cn});var ln,cn,Or,Ut=Ot(()=>{ln=void 0,cn=void 0,Or=void 0});var Rt={};vt(Rt,{join:()=>dn});var dn,Lt=Ot(()=>{dn=void 0});var Pt={};vt(Pt,{crypto:()=>pn});var pn,It=Ot(()=>{pn=void 0});var Er=it((_r,Bt)=>{"use strict";var vr=(()=>{var i=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(i=i||__filename),function(d={}){var o=d,m,l;o.ready=new Promise((r,a)=>{m=r,l=a});var b=Object.assign({},o),y="./this.program",f=typeof window=="object",x=typeof importScripts=="function",D=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",R="",W,U,P;if(D){var N=(Ut(),ze(Ft)),I=(Lt(),ze(Rt));R=x?I.dirname(R)+"/":__dirname+"/",W=(r,a)=>(r=be(r)?new URL(r):I.normalize(r),N.readFileSync(r,a?void 0:"utf8")),P=r=>(r=W(r,!0),r.buffer||(r=new Uint8Array(r)),r),U=(r,a,s,c=!0)=>{r=be(r)?new URL(r):I.normalize(r),N.readFile(r,c?void 0:"utf8",(O,_)=>{O?s(O):a(c?_.buffer:_)})},!o.thisProgram&&1<process.argv.length&&(y=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),o.inspect=()=>"[Emscripten Module object]"}else(f||x)&&(x?R=self.location.href:typeof document<"u"&&document.currentScript&&(R=document.currentScript.src),i&&(R=i),R.indexOf("blob:")!==0?R=R.substr(0,R.replace(/[?#].*/,"").lastIndexOf("/")+1):R="",W=r=>{var a=new XMLHttpRequest;return a.open("GET",r,!1),a.send(null),a.responseText},x&&(P=r=>{var a=new XMLHttpRequest;return a.open("GET",r,!1),a.responseType="arraybuffer",a.send(null),new Uint8Array(a.response)}),U=(r,a,s)=>{var c=new XMLHttpRequest;c.open("GET",r,!0),c.responseType="arraybuffer",c.onload=()=>{c.status==200||c.status==0&&c.response?a(c.response):s()},c.onerror=s,c.send(null)});var E=console.log.bind(console),F=console.error.bind(console);Object.assign(o,b),b=null,typeof WebAssembly!="object"&&ae("no native wasm support detected");var k,we=!1,ue,te,S,G,fe;function We(){var r=k.buffer;o.HEAP8=ue=new Int8Array(r),o.HEAP16=new Int16Array(r),o.HEAPU8=te=new Uint8Array(r),o.HEAPU16=new Uint16Array(r),o.HEAP32=S=new Int32Array(r),o.HEAPU32=G=new Uint32Array(r),o.HEAPF32=new Float32Array(r),o.HEAPF64=fe=new Float64Array(r)}var He=[],re=[],V=[],de=0,L=null,Z=null;function ae(r){throw r="Aborted("+r+")",F(r),we=!0,r=new WebAssembly.RuntimeError(r+". Build with -sASSERTIONS for more info."),l(r),r}var he=r=>r.startsWith("data:application/octet-stream;base64,"),be=r=>r.startsWith("file://"),K;if(K="ort-wasm.wasm",!he(K)){var le=K;K=o.locateFile?o.locateFile(le,R):R+le}function Ee(r){if(P)return P(r);throw"both async and sync fetching of the wasm failed"}function Ce(r){if(f||x){if(typeof fetch=="function"&&!be(r))return fetch(r,{credentials:"same-origin"}).then(a=>{if(!a.ok)throw"failed to load wasm binary file at \'"+r+"\'";return a.arrayBuffer()}).catch(()=>Ee(r));if(U)return new Promise((a,s)=>{U(r,c=>a(new Uint8Array(c)),s)})}return Promise.resolve().then(()=>Ee(r))}function De(r,a,s){return Ce(r).then(c=>WebAssembly.instantiate(c,a)).then(c=>c).then(s,c=>{F(`failed to asynchronously prepare wasm: ${c}`),ae(c)})}function Pe(r,a){var s=K;return typeof WebAssembly.instantiateStreaming!="function"||he(s)||be(s)||D||typeof fetch!="function"?De(s,r,a):fetch(s,{credentials:"same-origin"}).then(c=>WebAssembly.instantiateStreaming(c,r).then(a,function(O){return F(`wasm streaming compile failed: ${O}`),F("falling back to ArrayBuffer instantiation"),De(s,r,a)}))}var Me,pe={882112:(r,a,s,c)=>{if(typeof o>"u"||!o.Ga)return 1;if(r=Oe(r>>>0),r.startsWith("./")&&(r=r.substring(2)),r=o.Ga.get(r),!r)return 2;if(a>>>=0,s>>>=0,a+s>r.byteLength)return 3;try{return te.set(r.subarray(a,a+s),c>>>0>>>0),0}catch{return 4}}};function Se(r){this.Da=r-24,this.Fa=function(a){G[this.Da+4>>>2>>>0]=a},this.Ea=function(a){G[this.Da+8>>>2>>>0]=a},this.La=function(a,s){this.Ma(),this.Fa(a),this.Ea(s)},this.Ma=function(){G[this.Da+16>>>2>>>0]=0}}var Ae=0,J=0,ce=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Fe=(r,a,s)=>{a>>>=0;var c=a+s;for(s=a;r[s]&&!(s>=c);)++s;if(16<s-a&&r.buffer&&ce)return ce.decode(r.subarray(a,s));for(c="";a<s;){var O=r[a++];if(O&128){var _=r[a++]&63;if((O&224)==192)c+=String.fromCharCode((O&31)<<6|_);else{var A=r[a++]&63;O=(O&240)==224?(O&15)<<12|_<<6|A:(O&7)<<18|_<<12|A<<6|r[a++]&63,65536>O?c+=String.fromCharCode(O):(O-=65536,c+=String.fromCharCode(55296|O>>10,56320|O&1023))}}else c+=String.fromCharCode(O)}return c},Oe=(r,a)=>(r>>>=0)?Fe(te,r,a):"",Te=r=>{for(var a=0,s=0;s<r.length;++s){var c=r.charCodeAt(s);127>=c?a++:2047>=c?a+=2:55296<=c&&57343>=c?(a+=4,++s):a+=3}return a},Ye=(r,a,s,c)=>{if(s>>>=0,!(0<c))return 0;var O=s;c=s+c-1;for(var _=0;_<r.length;++_){var A=r.charCodeAt(_);if(55296<=A&&57343>=A){var $=r.charCodeAt(++_);A=65536+((A&1023)<<10)|$&1023}if(127>=A){if(s>=c)break;a[s++>>>0]=A}else{if(2047>=A){if(s+1>=c)break;a[s++>>>0]=192|A>>6}else{if(65535>=A){if(s+2>=c)break;a[s++>>>0]=224|A>>12}else{if(s+3>=c)break;a[s++>>>0]=240|A>>18,a[s++>>>0]=128|A>>12&63}a[s++>>>0]=128|A>>6&63}a[s++>>>0]=128|A&63}}return a[s>>>0]=0,s-O},Ie=r=>r%4===0&&(r%100!==0||r%400===0),Ke=[0,31,60,91,121,152,182,213,244,274,305,335],lt=[0,31,59,90,120,151,181,212,243,273,304,334],Ue=r=>{var a=Te(r)+1,s=me(a);return s&&Ye(r,te,s,a),s},Ge=[],Be={},Ve=()=>{if(!qe){var r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:y||"./this.program"},a;for(a in Be)Be[a]===void 0?delete r[a]:r[a]=Be[a];var s=[];for(a in r)s.push(`${a}=${r[a]}`);qe=s}return qe},qe,Ne=[null,[],[]],ct=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return s=>crypto.getRandomValues(s);if(D)try{var r=(It(),ze(Pt));if(r.randomFillSync)return s=>r.randomFillSync(s);var a=r.randomBytes;return s=>(s.set(a(s.byteLength)),s)}catch{}ae("initRandomDevice")},et=r=>(et=ct())(r),ke=[31,29,31,30,31,30,31,31,30,31,30,31],dt=[31,28,31,30,31,30,31,31,30,31,30,31];function z(r){var a=Array(Te(r)+1);return Ye(r,a,0,a.length),a}function tt(r,a,s,c){function O(p,H,Y){for(p=typeof p=="number"?p.toString():p||"";p.length<H;)p=Y[0]+p;return p}function _(p,H){return O(p,H,"0")}function A(p,H){function Y(Xe){return 0>Xe?-1:0<Xe?1:0}var ve;return(ve=Y(p.getFullYear()-H.getFullYear()))===0&&(ve=Y(p.getMonth()-H.getMonth()))===0&&(ve=Y(p.getDate()-H.getDate())),ve}function $(p){switch(p.getDay()){case 0:return new Date(p.getFullYear()-1,11,29);case 1:return p;case 2:return new Date(p.getFullYear(),0,3);case 3:return new Date(p.getFullYear(),0,2);case 4:return new Date(p.getFullYear(),0,1);case 5:return new Date(p.getFullYear()-1,11,31);case 6:return new Date(p.getFullYear()-1,11,30)}}function oe(p){var H=p.ya;for(p=new Date(new Date(p.za+1900,0,1).getTime());0<H;){var Y=p.getMonth(),ve=(Ie(p.getFullYear())?ke:dt)[Y];if(H>ve-p.getDate())H-=ve-p.getDate()+1,p.setDate(1),11>Y?p.setMonth(Y+1):(p.setMonth(0),p.setFullYear(p.getFullYear()+1));else{p.setDate(p.getDate()+H);break}}return Y=new Date(p.getFullYear()+1,0,4),H=$(new Date(p.getFullYear(),0,4)),Y=$(Y),0>=A(H,p)?0>=A(Y,p)?p.getFullYear()+1:p.getFullYear():p.getFullYear()-1}r>>>=0,a>>>=0,s>>>=0,c>>>=0;var se=G[c+40>>>2>>>0];c={Ja:S[c>>>2>>>0],Ia:S[c+4>>>2>>>0],Aa:S[c+8>>>2>>>0],Ca:S[c+12>>>2>>>0],Ba:S[c+16>>>2>>>0],za:S[c+20>>>2>>>0],xa:S[c+24>>>2>>>0],ya:S[c+28>>>2>>>0],Na:S[c+32>>>2>>>0],Ha:S[c+36>>>2>>>0],Ka:se?Oe(se):""},s=Oe(s),se={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var ie in se)s=s.replace(new RegExp(ie,"g"),se[ie]);var ot="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),st="January February March April May June July August September October November December".split(" ");se={"%a":p=>ot[p.xa].substring(0,3),"%A":p=>ot[p.xa],"%b":p=>st[p.Ba].substring(0,3),"%B":p=>st[p.Ba],"%C":p=>_((p.za+1900)/100|0,2),"%d":p=>_(p.Ca,2),"%e":p=>O(p.Ca,2," "),"%g":p=>oe(p).toString().substring(2),"%G":p=>oe(p),"%H":p=>_(p.Aa,2),"%I":p=>(p=p.Aa,p==0?p=12:12<p&&(p-=12),_(p,2)),"%j":p=>{for(var H=0,Y=0;Y<=p.Ba-1;H+=(Ie(p.za+1900)?ke:dt)[Y++]);return _(p.Ca+H,3)},"%m":p=>_(p.Ba+1,2),"%M":p=>_(p.Ia,2),"%n":()=>`\n`,"%p":p=>0<=p.Aa&&12>p.Aa?"AM":"PM","%S":p=>_(p.Ja,2),"%t":()=>"\t","%u":p=>p.xa||7,"%U":p=>_(Math.floor((p.ya+7-p.xa)/7),2),"%V":p=>{var H=Math.floor((p.ya+7-(p.xa+6)%7)/7);if(2>=(p.xa+371-p.ya-2)%7&&H++,H)H==53&&(Y=(p.xa+371-p.ya)%7,Y==4||Y==3&&Ie(p.za)||(H=1));else{H=52;var Y=(p.xa+7-p.ya-1)%7;(Y==4||Y==5&&Ie(p.za%400-1))&&H++}return _(H,2)},"%w":p=>p.xa,"%W":p=>_(Math.floor((p.ya+7-(p.xa+6)%7)/7),2),"%y":p=>(p.za+1900).toString().substring(2),"%Y":p=>p.za+1900,"%z":p=>{p=p.Ha;var H=0<=p;return p=Math.abs(p)/60,(H?"+":"-")+("0000"+(p/60*100+p%60)).slice(-4)},"%Z":p=>p.Ka,"%%":()=>"%"},s=s.replace(/%%/g,"\\0\\0");for(ie in se)s.includes(ie)&&(s=s.replace(new RegExp(ie,"g"),se[ie](c)));return s=s.replace(/\\0\\0/g,"%"),ie=z(s),ie.length>a?0:(ue.set(ie,r>>>0),ie.length-1)}var xe=[],ye,Re,pt=[],M=(r,a)=>{if(!Re){Re=new WeakMap;var s=ye.length;if(Re)for(var c=0;c<0+s;c++){var O=c,_=xe[O];_||(O>=xe.length&&(xe.length=O+1),xe[O]=_=ye.get(O)),(O=_)&&Re.set(O,c)}}if(s=Re.get(r)||0)return s;if(pt.length)s=pt.pop();else{try{ye.grow(1)}catch($){throw $ instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":$}s=ye.length-1}try{c=s,ye.set(c,r),xe[c]=ye.get(c)}catch($){if(!($ instanceof TypeError))throw $;if(typeof WebAssembly.Function=="function"){c=WebAssembly.Function,O={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},_={parameters:[],results:a[0]=="v"?[]:[O[a[0]]]};for(var A=1;A<a.length;++A)_.parameters.push(O[a[A]]);a=new c(_,r)}else{for(c=[1],O=a.slice(0,1),a=a.slice(1),_={i:127,p:127,j:126,f:125,d:124,e:111},c.push(96),A=a.length,128>A?c.push(A):c.push(A%128|128,A>>7),A=0;A<a.length;++A)c.push(_[a[A]]);O=="v"?c.push(0):c.push(1,_[O]),a=[0,97,115,109,1,0,0,0,1],O=c.length,128>O?a.push(O):a.push(O%128|128,O>>7),a.push.apply(a,c),a.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),a=new WebAssembly.Module(new Uint8Array(a)),a=new WebAssembly.Instance(a,{e:{f:r}}).exports.f}c=s,ye.set(c,a),xe[c]=ye.get(c)}return Re.set(r,s),s},Je={a:function(r,a,s){throw r>>>=0,new Se(r).La(a>>>0,s>>>0),Ae=r,J++,Ae},e:function(){return 0},L:function(){},A:function(){},C:function(){},u:function(){return 0},J:function(){},E:function(){},I:function(){},k:function(){},B:function(){},y:function(){},K:function(){},z:function(){},l:()=>1,o:function(r,a,s){r=a+2097152>>>0<4194305-!!r?(r>>>0)+4294967296*a:NaN,s>>>=0,r=new Date(1e3*r),S[s>>>2>>>0]=r.getUTCSeconds(),S[s+4>>>2>>>0]=r.getUTCMinutes(),S[s+8>>>2>>>0]=r.getUTCHours(),S[s+12>>>2>>>0]=r.getUTCDate(),S[s+16>>>2>>>0]=r.getUTCMonth(),S[s+20>>>2>>>0]=r.getUTCFullYear()-1900,S[s+24>>>2>>>0]=r.getUTCDay(),S[s+28>>>2>>>0]=(r.getTime()-Date.UTC(r.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},p:function(r,a,s){r=a+2097152>>>0<4194305-!!r?(r>>>0)+4294967296*a:NaN,s>>>=0,r=new Date(1e3*r),S[s>>>2>>>0]=r.getSeconds(),S[s+4>>>2>>>0]=r.getMinutes(),S[s+8>>>2>>>0]=r.getHours(),S[s+12>>>2>>>0]=r.getDate(),S[s+16>>>2>>>0]=r.getMonth(),S[s+20>>>2>>>0]=r.getFullYear()-1900,S[s+24>>>2>>>0]=r.getDay(),S[s+28>>>2>>>0]=(Ie(r.getFullYear())?Ke:lt)[r.getMonth()]+r.getDate()-1|0,S[s+36>>>2>>>0]=-(60*r.getTimezoneOffset()),a=new Date(r.getFullYear(),6,1).getTimezoneOffset();var c=new Date(r.getFullYear(),0,1).getTimezoneOffset();S[s+32>>>2>>>0]=(a!=c&&r.getTimezoneOffset()==Math.min(c,a))|0},q:function(r){r>>>=0;var a=new Date(S[r+20>>>2>>>0]+1900,S[r+16>>>2>>>0],S[r+12>>>2>>>0],S[r+8>>>2>>>0],S[r+4>>>2>>>0],S[r>>>2>>>0],0),s=S[r+32>>>2>>>0],c=a.getTimezoneOffset(),O=new Date(a.getFullYear(),6,1).getTimezoneOffset(),_=new Date(a.getFullYear(),0,1).getTimezoneOffset(),A=Math.min(_,O);return 0>s?S[r+32>>>2>>>0]=+(O!=_&&A==c):0<s!=(A==c)&&(O=Math.max(_,O),a.setTime(a.getTime()+6e4*((0<s?A:O)-c))),S[r+24>>>2>>>0]=a.getDay(),S[r+28>>>2>>>0]=(Ie(a.getFullYear())?Ke:lt)[a.getMonth()]+a.getDate()-1|0,S[r>>>2>>>0]=a.getSeconds(),S[r+4>>>2>>>0]=a.getMinutes(),S[r+8>>>2>>>0]=a.getHours(),S[r+12>>>2>>>0]=a.getDate(),S[r+16>>>2>>>0]=a.getMonth(),S[r+20>>>2>>>0]=a.getYear(),r=a.getTime(),isNaN(r)?(S[Le()>>>2>>>0]=61,r=-1):r/=1e3,rt((Me=r,1<=+Math.abs(Me)?0<Me?+Math.floor(Me/4294967296)>>>0:~~+Math.ceil((Me-+(~~Me>>>0))/4294967296)>>>0:0)),r>>>0},m:function(){return-52},n:function(){},w:function(r,a,s){function c(oe){return(oe=oe.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?oe[1]:"GMT"}s>>>=0;var O=new Date().getFullYear(),_=new Date(O,0,1),A=new Date(O,6,1);O=_.getTimezoneOffset();var $=A.getTimezoneOffset();G[r>>>0>>>2>>>0]=60*Math.max(O,$),S[a>>>0>>>2>>>0]=+(O!=$),r=c(_),a=c(A),r=Ue(r),a=Ue(a),$<O?(G[s>>>2>>>0]=r,G[s+4>>>2>>>0]=a):(G[s>>>2>>>0]=a,G[s+4>>>2>>>0]=r)},d:()=>{ae("")},D:function(r,a,s){r>>>=0,a>>>=0,s>>>=0,Ge.length=0;for(var c;c=te[a++>>>0];){var O=c!=105;O&=c!=112,s+=O&&s%8?4:0,Ge.push(c==112?G[s>>>2>>>0]:c==105?S[s>>>2>>>0]:fe[s>>>3>>>0]),s+=O?8:4}return pe[r].apply(null,Ge)},g:()=>Date.now(),x:function(){return 4294901760},b:()=>performance.now(),H:function(r,a,s){return a>>>=0,te.copyWithin(r>>>0>>>0,a>>>0,a+(s>>>0)>>>0)},v:function(r){r>>>=0;var a=te.length;if(4294901760<r)return!1;for(var s=1;4>=s;s*=2){var c=a*(1+.2/s);c=Math.min(c,r+100663296);var O=Math;c=Math.max(r,c);e:{O=(O.min.call(O,4294901760,c+(65536-c%65536)%65536)-k.buffer.byteLength+65535)/65536;try{k.grow(O),We();var _=1;break e}catch{}_=void 0}if(_)return!0}return!1},F:function(r,a){r>>>=0,a>>>=0;var s=0;return Ve().forEach((c,O)=>{var _=a+s;for(O=G[r+4*O>>>2>>>0]=_,_=0;_<c.length;++_)ue[O++>>>0>>>0]=c.charCodeAt(_);ue[O>>>0>>>0]=0,s+=c.length+1}),0},G:function(r,a){r>>>=0,a>>>=0;var s=Ve();G[r>>>2>>>0]=s.length;var c=0;return s.forEach(O=>c+=O.length+1),G[a>>>2>>>0]=c,0},f:()=>52,j:function(){return 52},r:function(){return 70},i:function(r,a,s,c){a>>>=0,s>>>=0,c>>>=0;for(var O=0,_=0;_<s;_++){var A=G[a>>>2>>>0],$=G[a+4>>>2>>>0];a+=8;for(var oe=0;oe<$;oe++){var se=te[A+oe>>>0],ie=Ne[r];se===0||se===10?((r===1?E:F)(Fe(ie,0)),ie.length=0):ie.push(se)}O+=$}return G[c>>>2>>>0]=O,0},s:function(r,a){return r>>>=0,et(te.subarray(r>>>0,r+(a>>>0)>>>0)),0},t:tt,c:function(r,a,s,c){return tt(r>>>0,a>>>0,s>>>0,c>>>0)},h:function(r,a,s,c){let O=ye.length;r=new Uint8Array(te.slice(r+a,r+s));try{var _=new WebAssembly.Module(r),A=new WebAssembly.Instance(_,{env:{memory:k}}),$;for($ in A.exports)M(A.exports[$]);return O<ye.length?O:c}catch(oe){return console.log(oe),c}}},C=function(){function r(s){return C=s.exports,C=ht(),k=C.M,We(),ye=C.sa,re.unshift(C.N),de--,de==0&&(L!==null&&(clearInterval(L),L=null),Z&&(s=Z,Z=null,s())),C}var a={a:Je};if(de++,o.instantiateWasm)try{return o.instantiateWasm(a,r)}catch(s){F(`Module.instantiateWasm callback failed with error: ${s}`),l(s)}return Pe(a,function(s){r(s.instance)}).catch(l),{}}();o._OrtInit=(r,a)=>(o._OrtInit=C.O)(r,a),o._OrtGetLastError=(r,a)=>(o._OrtGetLastError=C.P)(r,a),o._OrtCreateSessionOptions=(r,a,s,c,O,_,A,$,oe,se)=>(o._OrtCreateSessionOptions=C.Q)(r,a,s,c,O,_,A,$,oe,se),o._OrtAppendExecutionProvider=(r,a)=>(o._OrtAppendExecutionProvider=C.R)(r,a),o._OrtAddFreeDimensionOverride=(r,a,s)=>(o._OrtAddFreeDimensionOverride=C.S)(r,a,s),o._OrtAddSessionConfigEntry=(r,a,s)=>(o._OrtAddSessionConfigEntry=C.T)(r,a,s),o._OrtReleaseSessionOptions=r=>(o._OrtReleaseSessionOptions=C.U)(r),o._OrtCreateSession=(r,a,s)=>(o._OrtCreateSession=C.V)(r,a,s),o._OrtReleaseSession=r=>(o._OrtReleaseSession=C.W)(r),o._OrtGetInputOutputCount=(r,a,s)=>(o._OrtGetInputOutputCount=C.X)(r,a,s),o._OrtGetInputName=(r,a)=>(o._OrtGetInputName=C.Y)(r,a),o._OrtGetOutputName=(r,a)=>(o._OrtGetOutputName=C.Z)(r,a),o._OrtFree=r=>(o._OrtFree=C._)(r),o._OrtCreateTensor=(r,a,s,c,O,_)=>(o._OrtCreateTensor=C.$)(r,a,s,c,O,_),o._OrtGetTensorData=(r,a,s,c,O)=>(o._OrtGetTensorData=C.aa)(r,a,s,c,O),o._OrtReleaseTensor=r=>(o._OrtReleaseTensor=C.ba)(r),o._OrtCreateRunOptions=(r,a,s,c)=>(o._OrtCreateRunOptions=C.ca)(r,a,s,c),o._OrtAddRunConfigEntry=(r,a,s)=>(o._OrtAddRunConfigEntry=C.da)(r,a,s),o._OrtReleaseRunOptions=r=>(o._OrtReleaseRunOptions=C.ea)(r),o._OrtCreateBinding=r=>(o._OrtCreateBinding=C.fa)(r),o._OrtBindInput=(r,a,s)=>(o._OrtBindInput=C.ga)(r,a,s),o._OrtBindOutput=(r,a,s,c)=>(o._OrtBindOutput=C.ha)(r,a,s,c),o._OrtClearBoundOutputs=r=>(o._OrtClearBoundOutputs=C.ia)(r),o._OrtReleaseBinding=r=>(o._OrtReleaseBinding=C.ja)(r),o._OrtRunWithBinding=(r,a,s,c,O)=>(o._OrtRunWithBinding=C.ka)(r,a,s,c,O),o._OrtRun=(r,a,s,c,O,_,A,$)=>(o._OrtRun=C.la)(r,a,s,c,O,_,A,$),o._OrtEndProfiling=r=>(o._OrtEndProfiling=C.ma)(r),o._OrtConfigure=(r,a)=>(o._OrtConfigure=C.na)(r,a),o._OrtAuth=(r,a)=>(o._OrtAuth=C.oa)(r,a);var Le=()=>(Le=C.pa)(),me=o._malloc=r=>(me=o._malloc=C.qa)(r);o._free=r=>(o._free=C.ra)(r);var rt=r=>(rt=C.ta)(r),mt=()=>(mt=C.ua)(),nt=r=>(nt=C.va)(r),gt=r=>(gt=C.wa)(r);o.___start_em_js=882613,o.___stop_em_js=883225;function ht(){var r=C;r=Object.assign({},r);var a=c=>()=>c()>>>0,s=c=>O=>c(O)>>>0;return r.pa=a(r.pa),r.qa=s(r.qa),r.ua=a(r.ua),r.wa=s(r.wa),r}o.stackAlloc=gt,o.stackSave=mt,o.stackRestore=nt,o.addFunction=M,o.UTF8ToString=Oe,o.stringToUTF8=(r,a,s)=>Ye(r,te,a,s),o.lengthBytesUTF8=Te;var $e;Z=function r(){$e||at(),$e||(Z=r)};function at(){if(!(0<de)){if(o.preRun)for(typeof o.preRun=="function"&&(o.preRun=[o.preRun]);o.preRun.length;){var r=o.preRun.shift();He.unshift(r)}for(;0<He.length;)He.shift()(o);if(!(0<de||$e||($e=!0,o.calledRun=!0,we))){for(;0<re.length;)re.shift()(o);for(m(o);0<V.length;)V.shift()(o)}}}return at(),d.ready}})();typeof _r=="object"&&typeof Bt=="object"?Bt.exports=vr:typeof define=="function"&&define.amd&&define([],()=>vr)});var Sr=it(()=>{});var Ar=it(()=>{});var Tr={};vt(Tr,{cpus:()=>mn});var mn,Mr=Ot(()=>{mn=void 0});var Dr=it((Cr,Wt)=>{"use strict";var xr=(()=>{var i=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(i=i||__filename),function(d={}){function o(){return V.buffer!=ae.buffer&&Ee(),ae}function m(){return V.buffer!=ae.buffer&&Ee(),he}function l(){return V.buffer!=ae.buffer&&Ee(),be}function b(){return V.buffer!=ae.buffer&&Ee(),K}function y(){return V.buffer!=ae.buffer&&Ee(),le}var f=d,x,D;f.ready=new Promise((e,t)=>{x=e,D=t});var R=Object.assign({},f),W="./this.program",U=(e,t)=>{throw t},P=typeof window=="object",N=typeof importScripts=="function",I=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",E=f.ENVIRONMENT_IS_PTHREAD||!1,F="";function k(e){return f.locateFile?f.locateFile(e,F):F+e}var we,ue,te;if(I){var S=(Ut(),ze(Ft)),G=(Lt(),ze(Rt));F=N?G.dirname(F)+"/":__dirname+"/",we=(t,n)=>(t=Oe(t)?new URL(t):G.normalize(t),S.readFileSync(t,n?void 0:"utf8")),te=t=>(t=we(t,!0),t.buffer||(t=new Uint8Array(t)),t),ue=(t,n,u,h=!0)=>{t=Oe(t)?new URL(t):G.normalize(t),S.readFile(t,h?void 0:"utf8",(w,v)=>{w?u(w):n(h?v.buffer:v)})},!f.thisProgram&&1<process.argv.length&&(W=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),U=(t,n)=>{throw process.exitCode=t,n},f.inspect=()=>"[Emscripten Module object]";let e;try{e=Sr()}catch(t){throw console.error(\'The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?\'),t}global.Worker=e.Worker}else(P||N)&&(N?F=self.location.href:typeof document<"u"&&document.currentScript&&(F=document.currentScript.src),typeof i<"u"&&i&&(F=i),F.indexOf("blob:")!==0?F=F.substr(0,F.replace(/[?#].*/,"").lastIndexOf("/")+1):F="",I||(we=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},N&&(te=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),ue=(e,t,n)=>{var u=new XMLHttpRequest;u.open("GET",e,!0),u.responseType="arraybuffer",u.onload=()=>{u.status==200||u.status==0&&u.response?t(u.response):n()},u.onerror=n,u.send(null)}));I&&typeof performance>"u"&&(global.performance=Ar().performance);var fe=console.log.bind(console),We=console.error.bind(console);I&&(fe=(...e)=>S.writeSync(1,e.join(" ")+`\n`),We=(...e)=>S.writeSync(2,e.join(" ")+`\n`));var He=fe,re=We;Object.assign(f,R),R=null,typeof WebAssembly!="object"&&ce("no native wasm support detected");var V,de,L=!1,Z,ae,he,be,K,le;function Ee(){var e=V.buffer;f.HEAP8=ae=new Int8Array(e),f.HEAP16=new Int16Array(e),f.HEAPU8=he=new Uint8Array(e),f.HEAPU16=new Uint16Array(e),f.HEAP32=be=new Int32Array(e),f.HEAPU32=K=new Uint32Array(e),f.HEAPF32=new Float32Array(e),f.HEAPF64=le=new Float64Array(e)}var Ce=16777216;if(E)V=f.wasmMemory;else if(f.wasmMemory)V=f.wasmMemory;else if(V=new WebAssembly.Memory({initial:Ce/65536,maximum:65536,shared:!0}),!(V.buffer instanceof SharedArrayBuffer))throw re("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),I&&re("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");Ee(),Ce=V.buffer.byteLength;var De=[],Pe=[],Me=[],pe=0,Se=null,Ae=null;function J(){if(pe--,pe==0&&(Se!==null&&(clearInterval(Se),Se=null),Ae)){var e=Ae;Ae=null,e()}}function ce(e){throw e="Aborted("+e+")",re(e),L=!0,Z=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),D(e),e}var Fe=e=>e.startsWith("data:application/octet-stream;base64,"),Oe=e=>e.startsWith("file://"),Te;Te="ort-wasm-threaded.wasm",Fe(Te)||(Te=k(Te));function Ye(e){if(te)return te(e);throw"both async and sync fetching of the wasm failed"}function Ie(e){if(P||N){if(typeof fetch=="function"&&!Oe(e))return fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw"failed to load wasm binary file at \'"+e+"\'";return t.arrayBuffer()}).catch(()=>Ye(e));if(ue)return new Promise((t,n)=>{ue(e,u=>t(new Uint8Array(u)),n)})}return Promise.resolve().then(()=>Ye(e))}function Ke(e,t,n){return Ie(e).then(u=>WebAssembly.instantiate(u,t)).then(u=>u).then(n,u=>{re(`failed to asynchronously prepare wasm: ${u}`),ce(u)})}function lt(e,t){var n=Te;return typeof WebAssembly.instantiateStreaming!="function"||Fe(n)||Oe(n)||I||typeof fetch!="function"?Ke(n,e,t):fetch(n,{credentials:"same-origin"}).then(u=>WebAssembly.instantiateStreaming(u,e).then(t,function(h){return re(`wasm streaming compile failed: ${h}`),re("falling back to ArrayBuffer instantiation"),Ke(n,e,t)}))}var Ue,Ge={886500:(e,t,n,u)=>{if(typeof f>"u"||!f.hb)return 1;if(e=ke(e>>>0),e.startsWith("./")&&(e=e.substring(2)),e=f.hb.get(e),!e)return 2;if(t>>>=0,n>>>=0,u>>>=0,t+n>e.byteLength)return 3;try{return m().set(e.subarray(t,t+n),u>>>0),0}catch{return 4}}};function Be(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var Ve=e=>{e.terminate(),e.onmessage=()=>{}},qe=e=>{M.Ta.length==0&&(Re(),M.bb(M.Ta[0]));var t=M.Ta.pop();if(!t)return 6;M.Ua.push(t),M.Qa[e.Sa]=t,t.Sa=e.Sa;var n={cmd:"run",start_routine:e.ob,arg:e.lb,pthread_ptr:e.Sa};return I&&t.unref(),t.postMessage(n,e.ub),0},Ne=0,ct=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,et=(e,t,n)=>{t>>>=0;var u=t+n;for(n=t;e[n]&&!(n>=u);)++n;if(16<n-t&&e.buffer&&ct)return ct.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,n):e.subarray(t,n));for(u="";t<n;){var h=e[t++];if(h&128){var w=e[t++]&63;if((h&224)==192)u+=String.fromCharCode((h&31)<<6|w);else{var v=e[t++]&63;h=(h&240)==224?(h&15)<<12|w<<6|v:(h&7)<<18|w<<12|v<<6|e[t++]&63,65536>h?u+=String.fromCharCode(h):(h-=65536,u+=String.fromCharCode(55296|h>>10,56320|h&1023))}}else u+=String.fromCharCode(h)}return u},ke=(e,t)=>(e>>>=0)?et(m(),e,t):"",dt=e=>{var t=xt();return e=e(),wt(t),e};function z(e,t){var n=arguments.length-2,u=arguments;return dt(()=>{for(var h=Ct(8*n),w=h>>>3,v=0;v<n;v++){var B=u[2+v];y()[w+v>>>0]=B}return dr(e,n,h,t)})}function tt(e){if(E)return z(0,1,e);Z=e,0<Ne||(M.pb(),f.onExit?.(e),L=!0),U(e,new Be(e))}var xe=e=>{if(Z=e,E)throw C(e),"unwind";tt(e)};function ye(){for(var e=f.numThreads;e--;)Re();De.unshift(()=>{pe++,pt(()=>J())})}function Re(){var e=k("ort-wasm-threaded.worker.js");e=new Worker(e),M.Ta.push(e)}function pt(e){E?e():Promise.all(M.Ta.map(M.bb)).then(e)}var M={Ta:[],Ua:[],gb:[],Qa:{},$a(){E?(M.receiveObjectTransfer=M.nb,M.threadInitTLS=M.fb,M.setExitStatus=M.eb):ye()},eb:e=>Z=e,xb:["$terminateWorker"],pb:()=>{for(var e of M.Ua)Ve(e);for(e of M.Ta)Ve(e);M.Ta=[],M.Ua=[],M.Qa=[]},cb:e=>{var t=e.Sa;delete M.Qa[t],M.Ta.push(e),M.Ua.splice(M.Ua.indexOf(e),1),e.Sa=0,Tt(t)},nb(){},fb(){M.gb.forEach(e=>e())},bb:e=>new Promise(t=>{e.onmessage=w=>{w=w.data;var v=w.cmd;if(w.targetThread&&w.targetThread!=yt()){var B=M.Qa[w.targetThread];B?B.postMessage(w,w.transferList):re(`Internal error! Worker sent a message "${v}" to target pthread ${w.targetThread}, but that thread no longer exists!`)}else v==="checkMailbox"?ve():v==="spawnThread"?qe(w):v==="cleanupThread"?M.cb(M.Qa[w.thread]):v==="killThread"?(w=w.thread,v=M.Qa[w],delete M.Qa[w],Ve(v),Tt(w),M.Ua.splice(M.Ua.indexOf(v),1),v.Sa=0):v==="cancelThread"?M.Qa[w.thread].postMessage({cmd:"cancel"}):v==="loaded"?(e.loaded=!0,I&&!e.Sa&&e.unref(),t(e)):v==="alert"?alert(`Thread ${w.threadId}: ${w.text}`):w.target==="setimmediate"?e.postMessage(w):v==="callHandler"?f[w.handler](...w.args):v&&re(`worker sent an unknown command ${v}`)},e.onerror=w=>{throw re(`worker sent an error! ${w.filename}:${w.lineno}: ${w.message}`),w},I&&(e.on("message",w=>e.onmessage({data:w})),e.on("error",w=>e.onerror(w)));var n=[],u=["onExit"],h;for(h of u)f.hasOwnProperty(h)&&n.push(h);e.postMessage({cmd:"load",handlers:n,urlOrBlob:f.mainScriptUrlOrBlob||i,wasmMemory:V,wasmModule:de})})};f.PThread=M;var Je=e=>{for(;0<e.length;)e.shift()(f)};f.establishStackSpace=()=>{var e=yt(),t=b()[e+52>>>2>>>0];e=b()[e+56>>>2>>>0],gr(t,t-e),wt(t)};function C(e){if(E)return z(1,0,e);xe(e)}var Le=[],me,rt=e=>{var t=Le[e];return t||(e>=Le.length&&(Le.length=e+1),Le[e]=t=me.get(e)),t};f.invokeEntryPoint=(e,t)=>{e=rt(e)(t),0<Ne?M.eb(e):Mt(e)};function mt(e){this.Za=e-24,this.kb=function(t){b()[this.Za+4>>>2>>>0]=t},this.jb=function(t){b()[this.Za+8>>>2>>>0]=t},this.$a=function(t,n){this.ib(),this.kb(t),this.jb(n)},this.ib=function(){b()[this.Za+16>>>2>>>0]=0}}var nt=0,gt=0;function ht(e,t,n,u){return E?z(2,1,e,t,n,u):$e(e,t,n,u)}function $e(e,t,n,u){if(e>>>=0,t>>>=0,n>>>=0,u>>>=0,typeof SharedArrayBuffer>"u")return re("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var h=[];return E&&h.length===0?ht(e,t,n,u):(e={ob:n,Sa:e,lb:u,ub:h},E?(e.wb="spawnThread",postMessage(e,h),0):qe(e))}function at(e,t,n){return E?z(3,1,e,t,n):0}function r(e,t){if(E)return z(4,1,e,t)}var a=e=>{for(var t=0,n=0;n<e.length;++n){var u=e.charCodeAt(n);127>=u?t++:2047>=u?t+=2:55296<=u&&57343>=u?(t+=4,++n):t+=3}return t},s=(e,t,n,u)=>{if(n>>>=0,!(0<u))return 0;var h=n;u=n+u-1;for(var w=0;w<e.length;++w){var v=e.charCodeAt(w);if(55296<=v&&57343>=v){var B=e.charCodeAt(++w);v=65536+((v&1023)<<10)|B&1023}if(127>=v){if(n>=u)break;t[n++>>>0]=v}else{if(2047>=v){if(n+1>=u)break;t[n++>>>0]=192|v>>6}else{if(65535>=v){if(n+2>=u)break;t[n++>>>0]=224|v>>12}else{if(n+3>=u)break;t[n++>>>0]=240|v>>18,t[n++>>>0]=128|v>>12&63}t[n++>>>0]=128|v>>6&63}t[n++>>>0]=128|v&63}}return t[n>>>0]=0,n-h},c=(e,t,n)=>s(e,m(),t,n);function O(e,t){if(E)return z(5,1,e,t)}function _(e,t,n){if(E)return z(6,1,e,t,n)}function A(e,t,n){return E?z(7,1,e,t,n):0}function $(e,t){if(E)return z(8,1,e,t)}function oe(e,t,n){if(E)return z(9,1,e,t,n)}function se(e,t,n,u){if(E)return z(10,1,e,t,n,u)}function ie(e,t,n,u){if(E)return z(11,1,e,t,n,u)}function ot(e,t,n,u){if(E)return z(12,1,e,t,n,u)}function st(e){if(E)return z(13,1,e)}function p(e,t){if(E)return z(14,1,e,t)}function H(e,t,n){if(E)return z(15,1,e,t,n)}function Y(e){e>>>=0,typeof Atomics.vb=="function"&&(Atomics.vb(l(),e>>>2,e).value.then(ve),e+=128,Atomics.store(l(),e>>>2,1))}f.__emscripten_thread_mailbox_await=Y;var ve=()=>{var e=yt();if(e&&(Y(e),e=pr,!L))try{if(e(),!(0<Ne))try{E?Mt(Z):xe(Z)}catch(t){t instanceof Be||t=="unwind"||U(1,t)}}catch(t){t instanceof Be||t=="unwind"||U(1,t)}};f.checkMailbox=ve;var Xe=[],Qe=e=>e%4===0&&(e%100!==0||e%400===0),Yt=[0,31,60,91,121,152,182,213,244,274,305,335],Gt=[0,31,59,90,120,151,181,212,243,273,304,334];function Vt(e,t,n,u,h,w,v,B){return E?z(16,1,e,t,n,u,h,w,v,B):-52}function qt(e,t,n,u,h,w,v){if(E)return z(17,1,e,t,n,u,h,w,v)}var Jt=e=>{var t=a(e)+1,n=lr(t);return n&&c(e,n,t),n},Et=[],St={},Xt=()=>{if(!At){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:W||"./this.program"},t;for(t in St)St[t]===void 0?delete e[t]:e[t]=St[t];var n=[];for(t in e)n.push(`${t}=${e[t]}`);At=n}return At},At;function Qt(e,t){if(E)return z(18,1,e,t);e>>>=0,t>>>=0;var n=0;return Xt().forEach((u,h)=>{var w=t+n;for(h=b()[e+4*h>>>2>>>0]=w,w=0;w<u.length;++w)o()[h++>>>0>>>0]=u.charCodeAt(w);o()[h>>>0>>>0]=0,n+=u.length+1}),0}function Zt(e,t){if(E)return z(19,1,e,t);e>>>=0,t>>>=0;var n=Xt();b()[e>>>2>>>0]=n.length;var u=0;return n.forEach(h=>u+=h.length+1),b()[t>>>2>>>0]=u,0}function Kt(e){return E?z(20,1,e):52}function er(e,t,n,u){return E?z(21,1,e,t,n,u):52}function tr(e,t,n,u,h){return E?z(22,1,e,t,n,u,h):70}var Zr=[null,[],[]];function rr(e,t,n,u){if(E)return z(23,1,e,t,n,u);t>>>=0,n>>>=0,u>>>=0;for(var h=0,w=0;w<n;w++){var v=b()[t>>>2>>>0],B=b()[t+4>>>2>>>0];t+=8;for(var _e=0;_e<B;_e++){var ne=m()[v+_e>>>0],ge=Zr[e];ne===0||ne===10?((e===1?He:re)(et(ge,0)),ge.length=0):ge.push(ne)}h+=B}return b()[u>>>2>>>0]=h,0}var Kr=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return n=>(n.set(crypto.getRandomValues(new Uint8Array(n.byteLength))),n);if(I)try{var e=(It(),ze(Pt));if(e.randomFillSync)return n=>e.randomFillSync(n);var t=e.randomBytes;return n=>(n.set(t(n.byteLength)),n)}catch{}ce("initRandomDevice")},nr=e=>(nr=Kr())(e),ar=[31,29,31,30,31,30,31,31,30,31,30,31],or=[31,28,31,30,31,30,31,31,30,31,30,31];function en(e){var t=Array(a(e)+1);return s(e,t,0,t.length),t}var tn=(e,t)=>{o().set(e,t>>>0)};function sr(e,t,n,u){function h(g,j,X){for(g=typeof g=="number"?g.toString():g||"";g.length<j;)g=X[0]+g;return g}function w(g,j){return h(g,j,"0")}function v(g,j){function X(br){return 0>br?-1:0<br?1:0}var je;return(je=X(g.getFullYear()-j.getFullYear()))===0&&(je=X(g.getMonth()-j.getMonth()))===0&&(je=X(g.getDate()-j.getDate())),je}function B(g){switch(g.getDay()){case 0:return new Date(g.getFullYear()-1,11,29);case 1:return g;case 2:return new Date(g.getFullYear(),0,3);case 3:return new Date(g.getFullYear(),0,2);case 4:return new Date(g.getFullYear(),0,1);case 5:return new Date(g.getFullYear()-1,11,31);case 6:return new Date(g.getFullYear()-1,11,30)}}function _e(g){var j=g.Va;for(g=new Date(new Date(g.Wa+1900,0,1).getTime());0<j;){var X=g.getMonth(),je=(Qe(g.getFullYear())?ar:or)[X];if(j>je-g.getDate())j-=je-g.getDate()+1,g.setDate(1),11>X?g.setMonth(X+1):(g.setMonth(0),g.setFullYear(g.getFullYear()+1));else{g.setDate(g.getDate()+j);break}}return X=new Date(g.getFullYear()+1,0,4),j=B(new Date(g.getFullYear(),0,4)),X=B(X),0>=v(j,g)?0>=v(X,g)?g.getFullYear()+1:g.getFullYear():g.getFullYear()-1}e>>>=0,t>>>=0,n>>>=0,u>>>=0;var ne=b()[u+40>>>2>>>0];u={sb:l()[u>>>2>>>0],rb:l()[u+4>>>2>>>0],Xa:l()[u+8>>>2>>>0],ab:l()[u+12>>>2>>>0],Ya:l()[u+16>>>2>>>0],Wa:l()[u+20>>>2>>>0],Ra:l()[u+24>>>2>>>0],Va:l()[u+28>>>2>>>0],yb:l()[u+32>>>2>>>0],qb:l()[u+36>>>2>>>0],tb:ne?ke(ne):""},n=ke(n),ne={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var ge in ne)n=n.replace(new RegExp(ge,"g"),ne[ge]);var yr="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),wr="January February March April May June July August September October November December".split(" ");ne={"%a":g=>yr[g.Ra].substring(0,3),"%A":g=>yr[g.Ra],"%b":g=>wr[g.Ya].substring(0,3),"%B":g=>wr[g.Ya],"%C":g=>w((g.Wa+1900)/100|0,2),"%d":g=>w(g.ab,2),"%e":g=>h(g.ab,2," "),"%g":g=>_e(g).toString().substring(2),"%G":g=>_e(g),"%H":g=>w(g.Xa,2),"%I":g=>(g=g.Xa,g==0?g=12:12<g&&(g-=12),w(g,2)),"%j":g=>{for(var j=0,X=0;X<=g.Ya-1;j+=(Qe(g.Wa+1900)?ar:or)[X++]);return w(g.ab+j,3)},"%m":g=>w(g.Ya+1,2),"%M":g=>w(g.rb,2),"%n":()=>`\n`,"%p":g=>0<=g.Xa&&12>g.Xa?"AM":"PM","%S":g=>w(g.sb,2),"%t":()=>"\t","%u":g=>g.Ra||7,"%U":g=>w(Math.floor((g.Va+7-g.Ra)/7),2),"%V":g=>{var j=Math.floor((g.Va+7-(g.Ra+6)%7)/7);if(2>=(g.Ra+371-g.Va-2)%7&&j++,j)j==53&&(X=(g.Ra+371-g.Va)%7,X==4||X==3&&Qe(g.Wa)||(j=1));else{j=52;var X=(g.Ra+7-g.Va-1)%7;(X==4||X==5&&Qe(g.Wa%400-1))&&j++}return w(j,2)},"%w":g=>g.Ra,"%W":g=>w(Math.floor((g.Va+7-(g.Ra+6)%7)/7),2),"%y":g=>(g.Wa+1900).toString().substring(2),"%Y":g=>g.Wa+1900,"%z":g=>{g=g.qb;var j=0<=g;return g=Math.abs(g)/60,(j?"+":"-")+("0000"+(g/60*100+g%60)).slice(-4)},"%Z":g=>g.tb,"%%":()=>"%"},n=n.replace(/%%/g,"\\0\\0");for(ge in ne)n.includes(ge)&&(n=n.replace(new RegExp(ge,"g"),ne[ge](u)));return n=n.replace(/\\0\\0/g,"%"),ge=en(n),ge.length>t?0:(tn(ge,e),ge.length-1)}var Ze,ir=[],ur=(e,t)=>{if(!Ze){Ze=new WeakMap;var n=me.length;if(Ze)for(var u=0;u<0+n;u++){var h=rt(u);h&&Ze.set(h,u)}}if(n=Ze.get(e)||0)return n;if(ir.length)n=ir.pop();else{try{me.grow(1)}catch(B){throw B instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":B}n=me.length-1}try{u=n,me.set(u,e),Le[u]=me.get(u)}catch(B){if(!(B instanceof TypeError))throw B;if(typeof WebAssembly.Function=="function"){u=WebAssembly.Function,h={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var w={parameters:[],results:t[0]=="v"?[]:[h[t[0]]]},v=1;v<t.length;++v)w.parameters.push(h[t[v]]);t=new u(w,e)}else{for(u=[1],h=t.slice(0,1),t=t.slice(1),w={i:127,p:127,j:126,f:125,d:124,e:111},u.push(96),v=t.length,128>v?u.push(v):u.push(v%128|128,v>>7),v=0;v<t.length;++v)u.push(w[t[v]]);h=="v"?u.push(0):u.push(1,w[h]),t=[0,97,115,109,1,0,0,0,1],h=u.length,128>h?t.push(h):t.push(h%128|128,h>>7),t.push.apply(t,u),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}u=n,me.set(u,t),Le[u]=me.get(u)}return Ze.set(e,n),n};M.$a();var rn=[tt,C,ht,at,r,O,_,A,$,oe,se,ie,ot,st,p,H,Vt,qt,Qt,Zt,Kt,er,tr,rr],nn={b:function(e,t,n){throw e>>>=0,new mt(e).$a(t>>>0,n>>>0),nt=e,gt++,nt},O:function(e){cr(e>>>0,!N,1,!P,131072,!1),M.fb()},m:function(e){e>>>=0,E?postMessage({cmd:"cleanupThread",thread:e}):M.cb(M.Qa[e])},J:$e,h:at,U:r,F:O,H:_,y:A,S:$,L:oe,R:se,o:ie,G:ot,D:st,T:p,E:H,p:()=>1,B:function(e,t){e>>>=0,e==t>>>0?setTimeout(()=>ve()):E?postMessage({targetThread:e,cmd:"checkMailbox"}):(e=M.Qa[e])&&e.postMessage({cmd:"checkMailbox"})},K:function(e,t,n,u){t>>>=0,Xe.length=n,u=u>>>0>>>3;for(var h=0;h<n;h++)Xe[h]=y()[u+h>>>0];return e=0>e?Ge[-e-1]:rn[e],M.mb=t,t=e.apply(null,Xe),M.mb=0,t},M:Y,W:function(e){I&&M.Qa[e>>>0].ref()},s:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),l()[n>>>2>>>0]=e.getUTCSeconds(),l()[n+4>>>2>>>0]=e.getUTCMinutes(),l()[n+8>>>2>>>0]=e.getUTCHours(),l()[n+12>>>2>>>0]=e.getUTCDate(),l()[n+16>>>2>>>0]=e.getUTCMonth(),l()[n+20>>>2>>>0]=e.getUTCFullYear()-1900,l()[n+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,l()[n+28>>>2>>>0]=e},t:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),l()[n>>>2>>>0]=e.getSeconds(),l()[n+4>>>2>>>0]=e.getMinutes(),l()[n+8>>>2>>>0]=e.getHours(),l()[n+12>>>2>>>0]=e.getDate(),l()[n+16>>>2>>>0]=e.getMonth(),l()[n+20>>>2>>>0]=e.getFullYear()-1900,l()[n+24>>>2>>>0]=e.getDay(),t=(Qe(e.getFullYear())?Yt:Gt)[e.getMonth()]+e.getDate()-1|0,l()[n+28>>>2>>>0]=t,l()[n+36>>>2>>>0]=-(60*e.getTimezoneOffset()),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var u=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=(t!=u&&e.getTimezoneOffset()==Math.min(u,t))|0,l()[n+32>>>2>>>0]=e},u:function(e){e>>>=0;var t=new Date(l()[e+20>>>2>>>0]+1900,l()[e+16>>>2>>>0],l()[e+12>>>2>>>0],l()[e+8>>>2>>>0],l()[e+4>>>2>>>0],l()[e>>>2>>>0],0),n=l()[e+32>>>2>>>0],u=t.getTimezoneOffset(),h=new Date(t.getFullYear(),6,1).getTimezoneOffset(),w=new Date(t.getFullYear(),0,1).getTimezoneOffset(),v=Math.min(w,h);return 0>n?l()[e+32>>>2>>>0]=+(h!=w&&v==u):0<n!=(v==u)&&(h=Math.max(w,h),t.setTime(t.getTime()+6e4*((0<n?v:h)-u))),l()[e+24>>>2>>>0]=t.getDay(),n=(Qe(t.getFullYear())?Yt:Gt)[t.getMonth()]+t.getDate()-1|0,l()[e+28>>>2>>>0]=n,l()[e>>>2>>>0]=t.getSeconds(),l()[e+4>>>2>>>0]=t.getMinutes(),l()[e+8>>>2>>>0]=t.getHours(),l()[e+12>>>2>>>0]=t.getDate(),l()[e+16>>>2>>>0]=t.getMonth(),l()[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(l()[fr()>>>2>>>0]=61,e=-1):e/=1e3,mr((Ue=e,1<=+Math.abs(Ue)?0<Ue?+Math.floor(Ue/4294967296)>>>0:~~+Math.ceil((Ue-+(~~Ue>>>0))/4294967296)>>>0:0)),e>>>0},q:Vt,r:qt,A:function(e,t,n){function u(ne){return(ne=ne.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?ne[1]:"GMT"}e>>>=0,t>>>=0,n>>>=0;var h=new Date().getFullYear(),w=new Date(h,0,1),v=new Date(h,6,1);h=w.getTimezoneOffset();var B=v.getTimezoneOffset(),_e=Math.max(h,B);b()[e>>>2>>>0]=60*_e,l()[t>>>2>>>0]=+(h!=B),e=u(w),t=u(v),e=Jt(e),t=Jt(t),B<h?(b()[n>>>2>>>0]=e,b()[n+4>>>2>>>0]=t):(b()[n>>>2>>>0]=t,b()[n+4>>>2>>>0]=e)},c:()=>{ce("")},N:function(e,t,n){e>>>=0,t>>>=0,n>>>=0,Et.length=0;for(var u;u=m()[t++>>>0];){var h=u!=105;h&=u!=112,n+=h&&n%8?4:0,Et.push(u==112?b()[n>>>2>>>0]:u==105?l()[n>>>2>>>0]:y()[n>>>3>>>0]),n+=h?8:4}return Ge[e].apply(null,Et)},n:()=>{},i:()=>Date.now(),V:()=>{throw Ne+=1,"unwind"},C:function(){return 4294901760},e:()=>performance.timeOrigin+performance.now(),f:()=>I?(Mr(),ze(Tr)).cpus().length:navigator.hardwareConcurrency,z:function(e){e>>>=0;var t=m().length;if(e<=t||4294901760<e)return!1;for(var n=1;4>=n;n*=2){var u=t*(1+.2/n);u=Math.min(u,e+100663296);var h=Math;u=Math.max(e,u);e:{h=(h.min.call(h,4294901760,u+(65536-u%65536)%65536)-V.buffer.byteLength+65535)/65536;try{V.grow(h),Ee();var w=1;break e}catch{}w=void 0}if(w)return!0}return!1},P:Qt,Q:Zt,I:xe,g:Kt,l:er,v:tr,k:rr,w:function(e,t){return e>>>=0,t>>>=0,nr(m().subarray(e>>>0,e+t>>>0)),0},a:V||f.wasmMemory,x:sr,d:function(e,t,n,u){return sr(e>>>0,t>>>0,n>>>0,u>>>0)},j:function(e,t,n,u){let h=me.length;e=new Uint8Array(m().slice(e+t,e+n));try{var w=new WebAssembly.Module(e),v=new WebAssembly.Instance(w,{env:{memory:V}}),B;for(B in v.exports)ur(v.exports[B]);return h<me.length?h:u}catch(_e){return console.log(_e),u}}},T=function(){function e(n,u){return T=n.exports,T=an(),M.gb.push(T.Da),me=T.Ea,Pe.unshift(T.X),de=u,J(),T}var t={a:nn};if(pe++,f.instantiateWasm)try{return f.instantiateWasm(t,e)}catch(n){re(`Module.instantiateWasm callback failed with error: ${n}`),D(n)}return lt(t,function(n){e(n.instance,n.module)}).catch(D),{}}();f._OrtInit=(e,t)=>(f._OrtInit=T.Y)(e,t),f._OrtGetLastError=(e,t)=>(f._OrtGetLastError=T.Z)(e,t),f._OrtCreateSessionOptions=(e,t,n,u,h,w,v,B,_e,ne)=>(f._OrtCreateSessionOptions=T._)(e,t,n,u,h,w,v,B,_e,ne),f._OrtAppendExecutionProvider=(e,t)=>(f._OrtAppendExecutionProvider=T.$)(e,t),f._OrtAddFreeDimensionOverride=(e,t,n)=>(f._OrtAddFreeDimensionOverride=T.aa)(e,t,n),f._OrtAddSessionConfigEntry=(e,t,n)=>(f._OrtAddSessionConfigEntry=T.ba)(e,t,n),f._OrtReleaseSessionOptions=e=>(f._OrtReleaseSessionOptions=T.ca)(e),f._OrtCreateSession=(e,t,n)=>(f._OrtCreateSession=T.da)(e,t,n),f._OrtReleaseSession=e=>(f._OrtReleaseSession=T.ea)(e),f._OrtGetInputOutputCount=(e,t,n)=>(f._OrtGetInputOutputCount=T.fa)(e,t,n),f._OrtGetInputName=(e,t)=>(f._OrtGetInputName=T.ga)(e,t),f._OrtGetOutputName=(e,t)=>(f._OrtGetOutputName=T.ha)(e,t),f._OrtFree=e=>(f._OrtFree=T.ia)(e),f._OrtCreateTensor=(e,t,n,u,h,w)=>(f._OrtCreateTensor=T.ja)(e,t,n,u,h,w),f._OrtGetTensorData=(e,t,n,u,h)=>(f._OrtGetTensorData=T.ka)(e,t,n,u,h),f._OrtReleaseTensor=e=>(f._OrtReleaseTensor=T.la)(e),f._OrtCreateRunOptions=(e,t,n,u)=>(f._OrtCreateRunOptions=T.ma)(e,t,n,u),f._OrtAddRunConfigEntry=(e,t,n)=>(f._OrtAddRunConfigEntry=T.na)(e,t,n),f._OrtReleaseRunOptions=e=>(f._OrtReleaseRunOptions=T.oa)(e),f._OrtCreateBinding=e=>(f._OrtCreateBinding=T.pa)(e),f._OrtBindInput=(e,t,n)=>(f._OrtBindInput=T.qa)(e,t,n),f._OrtBindOutput=(e,t,n,u)=>(f._OrtBindOutput=T.ra)(e,t,n,u),f._OrtClearBoundOutputs=e=>(f._OrtClearBoundOutputs=T.sa)(e),f._OrtReleaseBinding=e=>(f._OrtReleaseBinding=T.ta)(e),f._OrtRunWithBinding=(e,t,n,u,h)=>(f._OrtRunWithBinding=T.ua)(e,t,n,u,h),f._OrtRun=(e,t,n,u,h,w,v,B)=>(f._OrtRun=T.va)(e,t,n,u,h,w,v,B),f._OrtEndProfiling=e=>(f._OrtEndProfiling=T.wa)(e),f._OrtConfigure=(e,t)=>(f._OrtConfigure=T.xa)(e,t),f._OrtAuth=(e,t)=>(f._OrtAuth=T.ya)(e,t);var fr=()=>(fr=T.za)(),yt=f._pthread_self=()=>(yt=f._pthread_self=T.Aa)(),lr=f._malloc=e=>(lr=f._malloc=T.Ba)(e);f._free=e=>(f._free=T.Ca)(e),f.__emscripten_tls_init=()=>(f.__emscripten_tls_init=T.Da)();var cr=f.__emscripten_thread_init=(e,t,n,u,h,w)=>(cr=f.__emscripten_thread_init=T.Fa)(e,t,n,u,h,w);f.__emscripten_thread_crashed=()=>(f.__emscripten_thread_crashed=T.Ga)();var dr=(e,t,n,u)=>(dr=T.Ha)(e,t,n,u),Tt=e=>(Tt=T.Ia)(e),Mt=f.__emscripten_thread_exit=e=>(Mt=f.__emscripten_thread_exit=T.Ja)(e),pr=()=>(pr=T.Ka)(),mr=e=>(mr=T.La)(e),gr=(e,t)=>(gr=T.Ma)(e,t),xt=()=>(xt=T.Na)(),wt=e=>(wt=T.Oa)(e),Ct=e=>(Ct=T.Pa)(e);f.___start_em_js=887001,f.___stop_em_js=887613;function an(){var e=T;e=Object.assign({},e);var t=u=>()=>u()>>>0,n=u=>h=>u(h)>>>0;return e.za=t(e.za),e.Aa=t(e.Aa),e.Ba=n(e.Ba),e.emscripten_main_runtime_thread_id=t(e.emscripten_main_runtime_thread_id),e.Na=t(e.Na),e.Pa=n(e.Pa),e}f.wasmMemory=V,f.stackAlloc=Ct,f.stackSave=xt,f.stackRestore=wt,f.keepRuntimeAlive=()=>0<Ne,f.addFunction=ur,f.UTF8ToString=ke,f.stringToUTF8=c,f.lengthBytesUTF8=a,f.ExitStatus=Be,f.PThread=M;var bt;Ae=function e(){bt||hr(),bt||(Ae=e)};function hr(){if(!(0<pe))if(E)x(f),E||Je(Pe),startWorker(f);else{if(f.preRun)for(typeof f.preRun=="function"&&(f.preRun=[f.preRun]);f.preRun.length;)De.unshift(f.preRun.shift());Je(De),0<pe||bt||(bt=!0,f.calledRun=!0,L||(E||Je(Pe),x(f),E||Je(Me)))}}return hr(),d.ready}})();typeof Cr=="object"&&typeof Wt=="object"?Wt.exports=xr:typeof define=="function"&&define.amd&&define([],()=>xr)});var Fr=it((Un,gn)=>{gn.exports=\'"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\\n\'});var Rr;Rr=Er();var hn=Dr(),Ht,Nt=!1,_t=!1,Ur=!1,yn=i=>{if(i===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+i+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+i+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},wn=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},bn=(i,d)=>i?d?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":d?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Lr=async i=>{if(Nt)return Promise.resolve();if(_t)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(Ur)throw new Error("previous call to \'initializeWebAssembly()\' failed.");_t=!0;let d=i.initTimeout,o=i.numThreads,m=i.simd,l=yn(o),b=m&&wn(),y=i.wasmPaths,f=typeof y=="string"?y:void 0,x=bn(b,l),D=typeof y=="object"?y[x]:void 0,R=!1,W=[];if(d>0&&W.push(new Promise(U=>{setTimeout(()=>{R=!0,U()},d)})),W.push(new Promise((U,P)=>{let N=l?hn:Rr,I={locateFile:(E,F)=>l&&E.endsWith(".worker.js")&&typeof Blob<"u"?URL.createObjectURL(new Blob([Fr()],{type:"text/javascript"})):E.endsWith(".wasm")?D||(f??F)+x:F+E};if(l)if(I.numThreads=o,typeof Blob>"u")I.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let E=`var ortWasmThreaded=${N.toString()};`;I.mainScriptUrlOrBlob=new Blob([E],{type:"text/javascript"})}N(I).then(E=>{_t=!1,Nt=!0,Ht=E,U()},E=>{_t=!1,Ur=!0,P(E)})})),await Promise.race(W),R)throw new Error(`WebAssembly backend initializing failed due to timeout: ${d}ms`)},q=()=>{if(Nt&&Ht)return Ht;throw new Error("WebAssembly is not initialized yet.")};var ee=(i,d)=>{let o=q(),m=o.lengthBytesUTF8(i)+1,l=o._malloc(m);return o.stringToUTF8(i,l,m),d.push(l),l},ut=(i,d,o,m)=>{if(typeof i=="object"&&i!==null){if(o.has(i))throw new Error("Circular reference in options");o.add(i)}Object.entries(i).forEach(([l,b])=>{let y=d?d+l:l;if(typeof b=="object")ut(b,y+".",o,m);else if(typeof b=="string"||typeof b=="number")m(y,b.toString());else if(typeof b=="boolean")m(y,b?"1":"0");else throw new Error(`Can\'t handle extra config type: ${typeof b}`)})},Q=i=>{let d=q(),o=d.stackSave();try{let m=d.stackAlloc(8);d._OrtGetLastError(m,m+4);let l=d.HEAP32[m/4],b=d.HEAPU32[m/4+1],y=b?d.UTF8ToString(b):"";throw new Error(`${i} ERROR_CODE: ${l}, ERROR_MESSAGE: ${y}`)}finally{d.stackRestore(o)}};var Pr=i=>{let d=q(),o=0,m=[],l=i||{};try{if(i?.logSeverityLevel===void 0)l.logSeverityLevel=2;else if(typeof i.logSeverityLevel!="number"||!Number.isInteger(i.logSeverityLevel)||i.logSeverityLevel<0||i.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${i.logSeverityLevel}`);if(i?.logVerbosityLevel===void 0)l.logVerbosityLevel=0;else if(typeof i.logVerbosityLevel!="number"||!Number.isInteger(i.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${i.logVerbosityLevel}`);i?.terminate===void 0&&(l.terminate=!1);let b=0;return i?.tag!==void 0&&(b=ee(i.tag,m)),o=d._OrtCreateRunOptions(l.logSeverityLevel,l.logVerbosityLevel,!!l.terminate,b),o===0&&Q("Can\'t create run options."),i?.extra!==void 0&&ut(i.extra,"",new WeakSet,(y,f)=>{let x=ee(y,m),D=ee(f,m);d._OrtAddRunConfigEntry(o,x,D)!==0&&Q(`Can\'t set a run config entry: ${y} - ${f}.`)}),[o,m]}catch(b){throw o!==0&&d._OrtReleaseRunOptions(o),m.forEach(y=>d._free(y)),b}};var On=i=>{switch(i){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${i}`)}},vn=i=>{switch(i){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${i}`)}},_n=i=>{i.extra||(i.extra={}),i.extra.session||(i.extra.session={});let d=i.extra.session;d.use_ort_model_bytes_directly||(d.use_ort_model_bytes_directly="1"),i.executionProviders&&i.executionProviders.some(o=>(typeof o=="string"?o:o.name)==="webgpu")&&(i.enableMemPattern=!1)},En=(i,d,o)=>{for(let m of d){let l=typeof m=="string"?m:m.name;switch(l){case"webnn":if(l="WEBNN",typeof m!="string"){let y=m;if(y?.deviceType){let f=ee("deviceType",o),x=ee(y.deviceType,o);q()._OrtAddSessionConfigEntry(i,f,x)!==0&&Q(`Can\'t set a session config entry: \'deviceType\' - ${y.deviceType}.`)}if(y?.numThreads){let f=y.numThreads;(typeof f!="number"||!Number.isInteger(f)||f<0)&&(f=0);let x=ee("numThreads",o),D=ee(f.toString(),o);q()._OrtAddSessionConfigEntry(i,x,D)!==0&&Q(`Can\'t set a session config entry: \'numThreads\' - ${y.numThreads}.`)}if(y?.powerPreference){let f=ee("powerPreference",o),x=ee(y.powerPreference,o);q()._OrtAddSessionConfigEntry(i,f,x)!==0&&Q(`Can\'t set a session config entry: \'powerPreference\' - ${y.powerPreference}.`)}}break;case"webgpu":if(l="JS",typeof m!="string"){let y=m;if(y?.preferredLayout){if(y.preferredLayout!=="NCHW"&&y.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either \'NCHW\' or \'NHWC\': ${y.preferredLayout}`);let f=ee("preferredLayout",o),x=ee(y.preferredLayout,o);q()._OrtAddSessionConfigEntry(i,f,x)!==0&&Q(`Can\'t set a session config entry: \'preferredLayout\' - ${y.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${l}`)}let b=ee(l,o);q()._OrtAppendExecutionProvider(i,b)!==0&&Q(`Can\'t append execution provider: ${l}.`)}},Ir=i=>{let d=q(),o=0,m=[],l=i||{};_n(l);try{let b=On(l.graphOptimizationLevel??"all"),y=vn(l.executionMode??"sequential"),f=typeof l.logId=="string"?ee(l.logId,m):0,x=l.logSeverityLevel??2;if(!Number.isInteger(x)||x<0||x>4)throw new Error(`log serverity level is not valid: ${x}`);let D=l.logVerbosityLevel??0;if(!Number.isInteger(D)||D<0||D>4)throw new Error(`log verbosity level is not valid: ${D}`);let R=typeof l.optimizedModelFilePath=="string"?ee(l.optimizedModelFilePath,m):0;if(o=d._OrtCreateSessionOptions(b,!!l.enableCpuMemArena,!!l.enableMemPattern,y,!!l.enableProfiling,0,f,x,D,R),o===0&&Q("Can\'t create session options."),l.executionProviders&&En(o,l.executionProviders,m),l.freeDimensionOverrides)for(let[W,U]of Object.entries(l.freeDimensionOverrides)){if(typeof W!="string")throw new Error(`free dimension override name must be a string: ${W}`);if(typeof U!="number"||!Number.isInteger(U)||U<0)throw new Error(`free dimension override value must be a non-negative integer: ${U}`);let P=ee(W,m);d._OrtAddFreeDimensionOverride(o,P,U)!==0&&Q(`Can\'t set a free dimension override: ${W} - ${U}.`)}return l.extra!==void 0&&ut(l.extra,"",new WeakSet,(W,U)=>{let P=ee(W,m),N=ee(U,m);d._OrtAddSessionConfigEntry(o,P,N)!==0&&Q(`Can\'t set a session config entry: ${W} - ${U}.`)}),[o,m]}catch(b){throw o!==0&&d._OrtReleaseSessionOptions(o),m.forEach(y=>d._free(y)),b}};var kt=i=>{switch(i){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${i}`)}},Br=i=>{switch(i){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${i}`)}},$t=i=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][i],Wr=i=>{switch(i){case"float16":return Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${i}`)}},Hr=i=>{switch(i){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${i}`)}},Nr=i=>i==="float32"||i==="int32"||i==="int64"||i==="bool"||i==="float16"||i==="uint32",kr=i=>{switch(i){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${i}`)}};var $r=async i=>{if(typeof i=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(i))}catch(d){if(d.code==="ERR_FS_FILE_TOO_LARGE"){let o=(void 0)(i),m=[];for await(let l of o)m.push(l);return new Uint8Array(Buffer.concat(m))}throw d}else{let d=await fetch(i);if(!d.ok)throw new Error(`failed to load external data file: ${i}`);let o=d.headers.get("Content-Length"),m=o?parseInt(o,10):0;if(m<1073741824)return new Uint8Array(await d.arrayBuffer());{if(!d.body)throw new Error(`failed to load external data file: ${i}, no response body.`);let l=d.body.getReader(),b;try{b=new ArrayBuffer(m)}catch(f){if(f instanceof RangeError){let x=Math.ceil(m/65536);b=new WebAssembly.Memory({initial:x,maximum:x}).buffer}else throw f}let y=0;for(;;){let{done:f,value:x}=await l.read();if(f)break;let D=x.byteLength;new Uint8Array(b,y,D).set(x),y+=D}return new Uint8Array(b,0,m)}}else return i instanceof Blob?new Uint8Array(await i.arrayBuffer()):i instanceof Uint8Array?i:new Uint8Array(i)};var Sn=(i,d)=>{q()._OrtInit(i,d)!==0&&Q("Can\'t initialize onnxruntime.")},zr=async i=>{Sn(i.wasm.numThreads,Hr(i.logLevel))},Yr=async(i,d)=>{},ft=new Map,An=i=>{let d=q(),o=d.stackSave();try{let m=d.stackAlloc(8);return d._OrtGetInputOutputCount(i,m,m+4)!==0&&Q("Can\'t get session input/output count."),[d.HEAP32[m/4],d.HEAP32[m/4+1]]}finally{d.stackRestore(o)}},jt=i=>{let d=q(),o=d._malloc(i.byteLength);if(o===0)throw new Error(`Can\'t create a session. failed to allocate a buffer of size ${i.byteLength}.`);return d.HEAPU8.set(i,o),[o,i.byteLength]},Gr=async(i,d)=>{let o,m,l=q();Array.isArray(i)?[o,m]=i:i.buffer===l.HEAPU8.buffer?[o,m]=[i.byteOffset,i.byteLength]:[o,m]=jt(i);let b=0,y=0,f=0,x=[],D=[],R=[];try{if([y,x]=Ir(d),d?.externalData&&l.mountExternalData){let F=[];for(let k of d.externalData){let we=typeof k=="string"?k:k.path;F.push($r(typeof k=="string"?k:k.data).then(ue=>{l.mountExternalData(we,ue)}))}await Promise.all(F)}b=l._OrtCreateSession(o,m,y),b===0&&Q("Can\'t create a session.");let[W,U]=An(b),P=[],N=[],I=[];for(let F=0;F<W;F++){let k=l._OrtGetInputName(b,F);k===0&&Q("Can\'t get an input name."),D.push(k),P.push(l.UTF8ToString(k))}for(let F=0;F<U;F++){let k=l._OrtGetOutputName(b,F);k===0&&Q("Can\'t get an output name."),R.push(k);let we=l.UTF8ToString(k);N.push(we)}let E=null;return ft.set(b,[b,D,R,E]),[b,P,N]}catch(W){throw D.forEach(U=>l._OrtFree(U)),R.forEach(U=>l._OrtFree(U)),f!==0&&l._OrtReleaseBinding(f),b!==0&&l._OrtReleaseSession(b),W}finally{l._free(o),y!==0&&l._OrtReleaseSessionOptions(y),x.forEach(W=>l._free(W)),l.unmountExternalData?.()}},Vr=i=>{let d=q(),o=ft.get(i);if(!o)throw new Error(`cannot release session. invalid session id: ${i}`);let[m,l,b,y]=o;y&&d._OrtReleaseBinding(y.handle),d.jsepUnregisterBuffers?.(i),l.forEach(f=>d._OrtFree(f)),b.forEach(f=>d._OrtFree(f)),d._OrtReleaseSession(m),ft.delete(i)},Tn=(i,d,o)=>{if(i!==null&&i[0]===d){let l=i[2];if(l.length===o)return l}let m=Wr(d);return new m(o)},jr=(i,d,o,m,l)=>{if(!i){d.push(0);return}let b=q(),y=i[0],f=i[1],x=i[3],D,R;if(y==="string"&&x==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(x==="gpu-buffer"){let P=i[2].gpuBuffer,N=$t(kt(y));R=f.reduce((I,E)=>I*E,1)*N,D=b.jsepRegisterBuffer(m,l,P,R)}else{let P=i[2];if(Array.isArray(P)){R=4*P.length,D=b._malloc(R),o.push(D);let N=D/4;for(let I=0;I<P.length;I++){if(typeof P[I]!="string")throw new TypeError(`tensor data at index ${I} is not a string`);b.HEAPU32[N++]=ee(P[I],o)}}else R=P.byteLength,D=b._malloc(R),o.push(D),b.HEAPU8.set(new Uint8Array(P.buffer,P.byteOffset,R),D)}let W=b.stackSave(),U=b.stackAlloc(4*f.length);try{let P=U/4;f.forEach(I=>b.HEAP32[P++]=I);let N=b._OrtCreateTensor(kt(y),D,R,U,f.length,kr(x));N===0&&Q(`Can\'t create tensor for input/output. session=${m}, index=${l}.`),d.push(N)}finally{b.stackRestore(W)}},qr=i=>{let o=new TextEncoder().encode(i),m=q(),l=m._malloc(o.byteLength);m.HEAPU8.set(o,l);let b=m._OrtConfigure(l,o.byteLength);if(b===0)throw new Error("Can\'t get an configure key");let y=m.UTF8ToString(b);return m._OrtFree(b),y},Jr=i=>{let o=new TextEncoder().encode(i),m=q(),l=m._malloc(o.byteLength);m.HEAPU8.set(o,l);let b=m._OrtAuth(l,o.byteLength);if(b===0)throw new Error("Can\'t get an auth result");let y=m.UTF8ToString(b);return m._OrtFree(b),y},Xr=async(i,d,o,m,l,b)=>{let y=q(),f=ft.get(i);if(!f)throw new Error(`cannot run inference. invalid session id: ${i}`);let[x,D,R,W]=f,U=d.length,P=m.length,N=0,I=[],E=[],F=[],k=[],we=y.stackSave(),ue=y.stackAlloc(U*4),te=y.stackAlloc(U*4),S=y.stackAlloc(P*4),G=y.stackAlloc(P*4);try{[N,I]=Pr(b);for(let L=0;L<U;L++)jr(o[L],E,k,i,d[L]);for(let L=0;L<P;L++){let Z=l[L],ae=Z?.[3]??"";jr(ae==="gpu-buffer"?Z:null,F,k,i,U+m[L])}let fe=ue/4,We=te/4,He=S/4,re=G/4;for(let L=0;L<U;L++)y.HEAPU32[fe++]=E[L],y.HEAPU32[We++]=D[d[L]];for(let L=0;L<P;L++)y.HEAPU32[He++]=F[L],y.HEAPU32[re++]=R[m[L]];let V;V=await y._OrtRun(x,te,ue,U,G,P,S,N),V!==0&&Q("failed to call OrtRun().");let de=[];for(let L=0;L<P;L++){let Z=y.HEAPU32[S/4+L];if(Z===F[L]){de.push(l[L]);continue}let ae=y.stackSave(),he=y.stackAlloc(4*4),be=!1,K,le=0;try{y._OrtGetTensorData(Z,he,he+4,he+8,he+12)!==0&&Q(`Can\'t access output tensor data on index ${L}.`);let Ce=he/4,De=y.HEAPU32[Ce++];le=y.HEAPU32[Ce++];let Pe=y.HEAPU32[Ce++],Me=y.HEAPU32[Ce++],pe=[];for(let J=0;J<Me;J++)pe.push(y.HEAPU32[Pe/4+J]);y._OrtFree(Pe);let Se=pe.reduce((J,ce)=>J*ce,1);K=Br(De);let Ae=W?.outputPreferredLocations[m[L]];if(K==="string"){if(Ae==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let J=[],ce=le/4;for(let Fe=0;Fe<Se;Fe++){let Oe=y.HEAPU32[ce++],Te=Fe===Se-1?void 0:y.HEAPU32[ce]-Oe;J.push(y.UTF8ToString(Oe,Te))}de.push([K,pe,J,"cpu"])}else if(Ae==="gpu-buffer"&&Se>0){let J=y.jsepGetBuffer(le),ce=$t(De);if(ce===void 0||!Nr(K))throw new Error(`Unsupported data type: ${K}`);be=!0,de.push([K,pe,{gpuBuffer:J,download:y.jsepCreateDownloader(J,Se*ce,K),dispose:()=>{y._OrtReleaseTensor(Z)}},"gpu-buffer"])}else{let J=Tn(l[L],K,Se);new Uint8Array(J.buffer,J.byteOffset,J.byteLength).set(y.HEAPU8.subarray(le,le+J.byteLength)),de.push([K,pe,J,"cpu"])}}finally{y.stackRestore(ae),K==="string"&&le&&y._free(le),be||y._OrtReleaseTensor(Z)}}return W&&y._OrtClearBoundOutputs(W.handle),de}finally{y.stackRestore(we),E.forEach(fe=>y._OrtReleaseTensor(fe)),F.forEach(fe=>y._OrtReleaseTensor(fe)),k.forEach(fe=>y._free(fe)),N!==0&&y._OrtReleaseRunOptions(N),I.forEach(fe=>y._free(fe))}},Qr=i=>{let d=q(),o=ft.get(i);if(!o)throw new Error("invalid session id");let m=o[0],l=d._OrtEndProfiling(m);l===0&&Q("Can\'t get an profile file name."),d._OrtFree(l)},zt=i=>{let d=[];for(let o of i){let m=o[2];!Array.isArray(m)&&"buffer"in m&&d.push(m.buffer)}return d};self.onmessage=i=>{let{type:d,in:o}=i.data;try{switch(d){case"init-wasm":Lr(o.wasm).then(()=>{zr(o).then(()=>{postMessage({type:d})},m=>{postMessage({type:d,err:m})})},m=>{postMessage({type:d,err:m})});break;case"init-ep":{let{epName:m,env:l}=o;Yr(l,m).then(()=>{postMessage({type:d})},b=>{postMessage({type:d,err:b})});break}case"copy-from":{let{buffer:m}=o,l=jt(m);postMessage({type:d,out:l});break}case"create":{let{model:m,options:l}=o;Gr(m,l).then(b=>{postMessage({type:d,out:b})},b=>{postMessage({type:d,err:b})});break}case"release":Vr(o),postMessage({type:d});break;case"run":{let{sessionId:m,inputIndices:l,inputs:b,outputIndices:y,options:f}=o,x=i.data.prealloc??[];for(;x.length<y.length;)x.push(null);Xr(m,l,b,y,x,f).then(D=>{D.some(R=>R[3]!=="cpu")?postMessage({type:d,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:d,out:D,inputsBack:b},zt(D).concat(zt(b)))},D=>{postMessage({type:d,err:D})});break}case"configure":try{let m=qr(i.data.in);postMessage({type:"configure",out:m})}catch(m){postMessage({type:"configure",err:m})}break;case"auth":try{let m=Jr(i.data.in);postMessage({type:"auth",out:m})}catch(m){postMessage({type:"auth",err:m})}break;case"end-profiling":Qr(o),postMessage({type:d});break;default:}}catch(m){postMessage({type:d,err:m})}};})();\n';}),Xt,it,In,Mo,Go,va,Uo,ir,ar,Fg,Ro,Cg,pd,dd,hd,md,bd,gd,yd,Td,xd,_a=L(function(){var _document;It(),fd(),Kr(),Xt=function Xt(){return!!ee.wasm.proxy&&(typeof document==="undefined"?"undefined":_typeof2(document))<"u";},In=!1,Mo=!1,Go=!1,Uo=new Map(),ir=function ir(e,t){var r=Uo.get(e);r?r.push(t):Uo.set(e,[t]);},ar=function ar(){if(In||!Mo||Go||!it)throw new Error("worker not ready");},Fg=function Fg(e){switch(e.data.type){case"init-wasm":In=!1,e.data.err?(Go=!0,va[1](e.data.err)):(Mo=!0,va[0]());break;case"init-ep":case"copy-from":case"create":case"configure":case"auth":case"release":case"end-profiling":{var _t130=Uo.get(e.data.type);e.data.err?_t130.shift()[1](e.data.err):_t130.shift()[0](e.data.out);break;}case"run":{var _t131=Uo.get(e.data.type);e.data.err?_t131.shift()[1](e.data.err):_t131.shift()[0](e.data.out.concat(e.data.inputsBack));break;}}},Ro=(typeof document==="undefined"?"undefined":_typeof2(document))<"u"?(_document=document)===null||_document===void 0||(_document=_document.currentScript)===null||_document===void 0?void 0:_document.src:void 0,Cg=function Cg(e){var t=[];for(var r=0;r<e.length;++r){var _n79=e[r];null!==_n79&&t.push(_n79);}return t;},pd=/*#__PURE__*/function(){var _ref23=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee53(){return _regeneratorRuntime2().wrap(function _callee53$(_context56){while(1)switch(_context56.prev=_context56.next){case 0:if(Mo){_context56.next=21;break;}if(!In){_context56.next=3;break;}throw new Error("multiple calls to 'initWasm()' detected.");case 3:if(!Go){_context56.next=5;break;}throw new Error("previous call to 'initWasm()' failed.");case 5:if(!(In=!0,Xt())){_context56.next=7;break;}return _context56.abrupt("return",(void 0===ee.wasm.wasmPaths&&Ro&&0!==Ro.indexOf("blob:")&&(ee.wasm.wasmPaths=Ro.substr(0,+Ro.lastIndexOf("/")+1)),new Promise(function(e,t){var _it;(_it=it)===null||_it===void 0||_it.terminate();var r=URL.createObjectURL(new Blob([cd()],{type:"text/javascript"}));(it=new Worker(r,{name:"ort-wasm-proxy-worker"})).onerror=function(e){return t(e);},it.onmessage=Fg,URL.revokeObjectURL(r),va=[e,t];var n={type:"init-wasm","in":ee};it.postMessage(n);})));case 7:_context56.prev=7;_context56.next=10;return jp(ee.wasm);case 10:_context56.next=12;return rd(ee);case 12:Mo=!0;_context56.next=18;break;case 15:_context56.prev=15;_context56.t0=_context56["catch"](7);throw Go=!0,_context56.t0;case 18:_context56.prev=18;In=!1;return _context56.finish(18);case 21:case"end":return _context56.stop();}},_callee53,null,[[7,15,18,21]]);}));return function pd(){return _ref23.apply(this,arguments);};}(),dd=/*#__PURE__*/function(){var _ref24=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee54(e){return _regeneratorRuntime2().wrap(function _callee54$(_context57){while(1)switch(_context57.prev=_context57.next){case 0:if(!Xt()){_context57.next=2;break;}return _context57.abrupt("return",(ar(),new Promise(function(t,r){ir("init-ep",[t,r]);var n={type:"init-ep","in":{epName:e,env:ee}};it.postMessage(n);})));case 2:_context57.next=4;return nd(ee,e);case 4:case"end":return _context57.stop();}},_callee54);}));return function dd(_x68){return _ref24.apply(this,arguments);};}(),hd=/*#__PURE__*/function(){var _ref25=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee55(e){return _regeneratorRuntime2().wrap(function _callee55$(_context58){while(1)switch(_context58.prev=_context58.next){case 0:return _context58.abrupt("return",Xt()?(ar(),new Promise(function(t,r){ir("copy-from",[t,r]);var n={type:"copy-from","in":{buffer:e}};it.postMessage(n,[e.buffer]);})):xa(e));case 1:case"end":return _context58.stop();}},_callee55);}));return function hd(_x69){return _ref25.apply(this,arguments);};}(),md=/*#__PURE__*/function(){var _ref26=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee56(e,t){return _regeneratorRuntime2().wrap(function _callee56$(_context59){while(1)switch(_context59.prev=_context59.next){case 0:if(!Xt()){_context59.next=4;break;}if(!(t!==null&&t!==void 0&&t.preferredOutputLocation)){_context59.next=3;break;}throw new Error('session option "preferredOutputLocation" is not supported for proxy.');case 3:return _context59.abrupt("return",(ar(),new Promise(function(r,n){ir("create",[r,n]);var i={type:"create","in":{model:e,options:t}},o=[];e instanceof Uint8Array&&o.push(e.buffer),it.postMessage(i,o);})));case 4:return _context59.abrupt("return",od(e,t));case 5:case"end":return _context59.stop();}},_callee56);}));return function md(_x70,_x71){return _ref26.apply(this,arguments);};}(),bd=/*#__PURE__*/function(){var _ref27=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee57(e){return _regeneratorRuntime2().wrap(function _callee57$(_context60){while(1)switch(_context60.prev=_context60.next){case 0:if(!Xt()){_context60.next=2;break;}return _context60.abrupt("return",(ar(),new Promise(function(t,r){ir("release",[t,r]);var n={type:"release","in":e};it.postMessage(n);})));case 2:id(e);case 3:case"end":return _context60.stop();}},_callee57);}));return function bd(_x72){return _ref27.apply(this,arguments);};}(),gd=/*#__PURE__*/function(){var _ref28=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee58(e){return _regeneratorRuntime2().wrap(function _callee58$(_context61){while(1)switch(_context61.prev=_context61.next){case 0:return _context61.abrupt("return",Xt()?(ar(),new Promise(function(t,r){ir("configure",[t,r]);var n={type:"configure","in":e};it.postMessage(n);})):ad(e));case 1:case"end":return _context61.stop();}},_callee58);}));return function gd(_x73){return _ref28.apply(this,arguments);};}(),yd=/*#__PURE__*/function(){var _ref29=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee59(e){return _regeneratorRuntime2().wrap(function _callee59$(_context62){while(1)switch(_context62.prev=_context62.next){case 0:return _context62.abrupt("return",Xt()?(ar(),new Promise(function(t,r){ir("auth",[t,r]);var n={type:"auth","in":e};it.postMessage(n);})):sd(e));case 1:case"end":return _context62.stop();}},_callee59);}));return function yd(_x74){return _ref29.apply(this,arguments);};}(),Td=/*#__PURE__*/function(){var _ref30=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee60(e,t,r,n,i,o){return _regeneratorRuntime2().wrap(function _callee60$(_context63){while(1)switch(_context63.prev=_context63.next){case 0:if(!Xt()){_context63.next=4;break;}if(!r.some(function(e){return"cpu"!==e[3];})){_context63.next=3;break;}throw new Error("input tensor on GPU is not supported for proxy.");case 3:return _context63.abrupt("return",(ar(),new Promise(function(a,s){ir("run",[a,s]);var u=r,l={type:"run","in":{sessionId:e,inputIndices:t,inputs:u,outputIndices:n,options:o},prealloc:i};it.postMessage(l,wa(u).concat(wa(Cg(i))));})));case 4:return _context63.abrupt("return",ud(e,t,r,n,i,o).then(function(e){return e.concat(r);}));case 5:case"end":return _context63.stop();}},_callee60);}));return function Td(_x75,_x76,_x77,_x78,_x79,_x80){return _ref30.apply(this,arguments);};}(),xd=/*#__PURE__*/function(){var _ref31=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee61(e){return _regeneratorRuntime2().wrap(function _callee61$(_context64){while(1)switch(_context64.prev=_context64.next){case 0:if(!Xt()){_context64.next=2;break;}return _context64.abrupt("return",(ar(),new Promise(function(t,r){ir("end-profiling",[t,r]);var n={type:"end-profiling","in":e};it.postMessage(n);})));case 2:ld(e);case 3:case"end":return _context64.stop();}},_callee61);}));return function xd(_x81){return _ref31.apply(this,arguments);};}();}),wd,vd,zo,_d=L(function(){It(),_a(),ya(),Ta(),wd=function wd(e,t){switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];default:throw new Error("invalid data location: ".concat(e.location," for ").concat(t()));}},vd=function vd(e){switch(e[3]){case"cpu":return new Ne(e[0],e[2],e[1]);case"gpu-buffer":{var _t132=e[0];if(!No(_t132))throw new Error("not supported data type: ".concat(_t132," for deserializing GPU tensor"));var _e$=e[2],_r171=_e$.gpuBuffer,_n80=_e$.download,_i66=_e$.dispose;return Ne.fromGpuBuffer(_r171,{dataType:_t132,dims:e[1],download:_n80,dispose:_i66});}default:throw new Error("invalid data location: ".concat(e[3]));}},zo=/*#__PURE__*/function(){function zo(){_classCallCheck2(this,zo);}return _createClass2(zo,[{key:"fetchModelAndCopyToWasmMemory",value:function(){var _fetchModelAndCopyToWasmMemory=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee62(e){return _regeneratorRuntime2().wrap(function _callee62$(_context65){while(1)switch(_context65.prev=_context65.next){case 0:_context65.t0=hd;_context65.next=3;return _n(e);case 3:_context65.t1=_context65.sent;return _context65.abrupt("return",(0,_context65.t0)(_context65.t1));case 5:case"end":return _context65.stop();}},_callee62);}));function fetchModelAndCopyToWasmMemory(_x82){return _fetchModelAndCopyToWasmMemory.apply(this,arguments);}return fetchModelAndCopyToWasmMemory;}()},{key:"loadModel",value:function(){var _loadModel2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee63(e,t){var _yield$md,_yield$md2;var r;return _regeneratorRuntime2().wrap(function _callee63$(_context66){while(1)switch(_context66.prev=_context66.next){case 0:mr();if(!("string"==typeof e)){_context66.next=14;break;}if(!(_typeof2(process)<"u"&&process.versions&&process.versions.node)){_context66.next=8;break;}_context66.next=5;return _n(e);case 5:_context66.t1=_context66.sent;_context66.next=11;break;case 8:_context66.next=10;return this.fetchModelAndCopyToWasmMemory(e);case 10:_context66.t1=_context66.sent;case 11:_context66.t0=_context66.t1;_context66.next=15;break;case 14:_context66.t0=e;case 15:r=_context66.t0;_context66.next=18;return md(r,t);case 18:_yield$md=_context66.sent;_yield$md2=_slicedToArray2(_yield$md,3);this.sessionId=_yield$md2[0];this.inputNames=_yield$md2[1];this.outputNames=_yield$md2[2];br();case 24:case"end":return _context66.stop();}},_callee63,this);}));function loadModel(_x83,_x84){return _loadModel2.apply(this,arguments);}return loadModel;}()},{key:"dispose",value:function(){var _dispose2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee64(){return _regeneratorRuntime2().wrap(function _callee64$(_context67){while(1)switch(_context67.prev=_context67.next){case 0:return _context67.abrupt("return",bd(this.sessionId));case 1:case"end":return _context67.stop();}},_callee64,this);}));function dispose(){return _dispose2.apply(this,arguments);}return dispose;}()},{key:"configure",value:function(){var _configure3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee65(e){return _regeneratorRuntime2().wrap(function _callee65$(_context68){while(1)switch(_context68.prev=_context68.next){case 0:return _context68.abrupt("return",gd(e));case 1:case"end":return _context68.stop();}},_callee65);}));function configure(_x85){return _configure3.apply(this,arguments);}return configure;}()},{key:"auth",value:function(){var _auth3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee66(e){return _regeneratorRuntime2().wrap(function _callee66$(_context69){while(1)switch(_context69.prev=_context69.next){case 0:return _context69.abrupt("return",yd(e));case 1:case"end":return _context69.stop();}},_callee66);}));function auth(_x86){return _auth3.apply(this,arguments);}return auth;}()},{key:"run",value:function(){var _run4=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee67(e,t,r){var _this33=this;var n,i,o,a,s,u,l,c,h,f,_e225,_s21;return _regeneratorRuntime2().wrap(function _callee67$(_context70){while(1)switch(_context70.prev=_context70.next){case 0:mr();n=[],i=[];Object.entries(e).forEach(function(e){var t=e[0],r=e[1],o=_this33.inputNames.indexOf(t);if(-1===o)throw new Error("invalid input '".concat(t,"'"));n.push(r),i.push(o);});o=[],a=[],s=function s(e){return null!==e&&"gpu-buffer"===e.location?e:null;};Object.entries(t).forEach(function(e){var t=e[0],r=e[1],n=_this33.outputNames.indexOf(t);if(-1===n)throw new Error("invalid output '".concat(t,"'"));o.push(r),a.push(n);});u=n.map(function(e,t){return wd(e,function(){return"input \"".concat(_this33.inputNames[i[t]],"\"");});});l=o.map(function(e,t){return e?wd(e,function(){return"output \"".concat(_this33.outputNames[a[t]],"\"");}):null;});_context70.next=9;return Td(this.sessionId,i,u,a,l,r);case 9:c=_context70.sent;h={};f=[];for(_e225=0;_e225<c.length;_e225++){_e225>=a.length?f.push(vd(c[_e225])):h[this.outputNames[a[_e225]]]=(_s21=s(o[_e225]))!==null&&_s21!==void 0?_s21:vd(c[_e225]);}return _context70.abrupt("return",(f.length>0&&(h.inputBack=f[0]),br(),h));case 14:case"end":return _context70.stop();}},_callee67,this);}));function run(_x87,_x88,_x89){return _run4.apply(this,arguments);}return run;}()},{key:"startProfiling",value:function startProfiling(){}},{key:"endProfiling",value:function endProfiling(){xd(this.sessionId);}}]);}();}),$g,Wo,Od=L(function(){It(),_a(),_d(),$g=function $g(){if(("number"!=typeof ee.wasm.initTimeout||ee.wasm.initTimeout<0)&&(ee.wasm.initTimeout=0),"boolean"!=typeof ee.wasm.simd&&(ee.wasm.simd=!0),"boolean"!=typeof ee.wasm.proxy&&(ee.wasm.proxy=!1),"boolean"!=typeof ee.wasm.trace&&(ee.wasm.trace=!1),"number"!=typeof ee.wasm.numThreads||!Number.isInteger(ee.wasm.numThreads)||ee.wasm.numThreads<=0){((typeof self==="undefined"?"undefined":_typeof2(self))<"u"&&!self.crossOriginIsolated||_typeof2(process)<"u"&&process.versions&&process.versions.node)&&(ee.wasm.numThreads=1);var _e226=(typeof navigator==="undefined"?"undefined":_typeof2(navigator))>"u"?(void 0)().length:navigator.hardwareConcurrency;ee.wasm.numThreads=Math.min(4,Math.ceil((_e226||1)/2));}},Wo=/*#__PURE__*/function(){function Wo(){_classCallCheck2(this,Wo);}return _createClass2(Wo,[{key:"init",value:function(){var _init2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee68(e){return _regeneratorRuntime2().wrap(function _callee68$(_context71){while(1)switch(_context71.prev=_context71.next){case 0:$g();_context71.next=3;return pd();case 3:_context71.next=5;return dd(e);case 5:case"end":return _context71.stop();}},_callee68);}));function init(_x90){return _init2.apply(this,arguments);}return init;}()},{key:"createInferenceSessionHandler",value:function(){var _createInferenceSessionHandler2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee69(e,t){var r;return _regeneratorRuntime2().wrap(function _callee69$(_context72){while(1)switch(_context72.prev=_context72.next){case 0:r=new zo();_context72.next=3;return r.loadModel(e,t);case 3:return _context72.abrupt("return",Promise.resolve(r));case 4:case"end":return _context72.stop();}},_callee69);}));function createInferenceSessionHandler(_x91,_x92){return _createInferenceSessionHandler2.apply(this,arguments);}return createInferenceSessionHandler;}()}]);}();}),Id={};cr(Id,{wasmBackend:function wasmBackend(){return Bg;}});var Bg,Sd=L(function(){Od(),Bg=new Wo();});It(),It(),It();var Ss="1.17.0",nI=ei;{var _e227=(Lp(),Ht(Dp)).onnxjsBackend;dr("webgl",_e227,-10);}{var _e228=(Sd(),Ht(Id)).wasmBackend;dr("cpu",_e228,10),dr("wasm",_e228,10),dr("webnn",_e228,9);}Object.defineProperty(ee.versions,"web",{value:Ss,enumerable:!0});}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.loaded=!0,r.exports;}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e["default"];}:function(){return e;};return __webpack_require__.d(t,{a:t}),t;},__webpack_require__.d=function(e,t){for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]});},__webpack_require__.g=function(){if("object"==(typeof globalThis==="undefined"?"undefined":_typeof2(globalThis)))return globalThis;try{return this||new Function("return this")();}catch(e){if("object"==(typeof window==="undefined"?"undefined":_typeof2(window)))return window;}}(),__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t);},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0});},__webpack_require__.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e;},__webpack_require__.b=document.baseURI||self.location.href;var __webpack_exports__={};__webpack_require__.d(__webpack_exports__,{o:function o(){return tsvb;}});var utils_lib_namespaceObject={};__webpack_require__.r(utils_lib_namespaceObject),__webpack_require__.d(utils_lib_namespaceObject,{BaseTextureCache:function BaseTextureCache(){return _BaseTextureCache;},BoundingBox:function BoundingBox(){return _BoundingBox2;},CanvasRenderTarget:function CanvasRenderTarget(){return _CanvasRenderTarget;},DATA_URI:function DATA_URI(){return _DATA_URI;},EventEmitter:function EventEmitter(){return utils_node_modules_eventemitter3;},ProgramCache:function ProgramCache(){return _ProgramCache;},TextureCache:function TextureCache(){return _TextureCache;},clearTextureCache:function clearTextureCache(){return _clearTextureCache;},correctBlendMode:function correctBlendMode(){return _correctBlendMode;},createIndicesForQuads:function createIndicesForQuads(){return _createIndicesForQuads;},decomposeDataUri:function decomposeDataUri(){return _decomposeDataUri;},deprecation:function deprecation(){return _deprecation;},destroyTextureCache:function destroyTextureCache(){return _destroyTextureCache;},detectVideoAlphaMode:function detectVideoAlphaMode(){return _detectVideoAlphaMode;},determineCrossOrigin:function determineCrossOrigin(){return _determineCrossOrigin;},earcut:function earcut(){return _earcut;},getBufferType:function getBufferType(){return _getBufferType;},getCanvasBoundingBox:function getCanvasBoundingBox(){return _getCanvasBoundingBox;},getResolutionOfUrl:function getResolutionOfUrl(){return _getResolutionOfUrl;},hex2rgb:function hex2rgb(){return _hex2rgb;},hex2string:function hex2string(){return _hex2string;},interleaveTypedArrays:function interleaveTypedArrays(){return _interleaveTypedArrays;},isMobile:function isMobile(){return isMobile_isMobile;},isPow2:function isPow2(){return _isPow;},isWebGLSupported:function isWebGLSupported(){return _isWebGLSupported;},log2:function log2(){return _log;},nextPow2:function nextPow2(){return _nextPow;},path:function path(){return _path;},premultiplyBlendMode:function premultiplyBlendMode(){return _premultiplyBlendMode;},premultiplyRgba:function premultiplyRgba(){return _premultiplyRgba;},premultiplyTint:function premultiplyTint(){return _premultiplyTint;},premultiplyTintToRgba:function premultiplyTintToRgba(){return _premultiplyTintToRgba;},removeItems:function removeItems(){return _removeItems;},rgb2hex:function rgb2hex(){return _rgb2hex;},sayHello:function sayHello(){return _sayHello;},sign:function sign(){return _sign;},skipHello:function skipHello(){return _skipHello;},string2hex:function string2hex(){return _string2hex;},trimCanvas:function trimCanvas(){return _trimCanvas;},uid:function uid(){return _uid;},url:function url(){return url_url;}});var pixi_js_lib_namespaceObject={};__webpack_require__.r(pixi_js_lib_namespaceObject),__webpack_require__.d(pixi_js_lib_namespaceObject,{ALPHA_MODES:function ALPHA_MODES(){return _ALPHA_MODES;},AbstractMultiResource:function AbstractMultiResource(){return _AbstractMultiResource;},AccessibilityManager:function AccessibilityManager(){return _AccessibilityManager;},AlphaFilter:function AlphaFilter(){return _AlphaFilter;},AnimatedSprite:function AnimatedSprite(){return _AnimatedSprite;},Application:function Application(){return _Application2;},ArrayResource:function ArrayResource(){return _ArrayResource;},Assets:function Assets(){return _Assets;},AssetsClass:function AssetsClass(){return _AssetsClass;},Attribute:function Attribute(){return _Attribute;},BLEND_MODES:function BLEND_MODES(){return _BLEND_MODES;},BUFFER_BITS:function BUFFER_BITS(){return _BUFFER_BITS;},BUFFER_TYPE:function BUFFER_TYPE(){return _BUFFER_TYPE;},BackgroundSystem:function BackgroundSystem(){return _BackgroundSystem;},BaseImageResource:function BaseImageResource(){return _BaseImageResource;},BasePrepare:function BasePrepare(){return _BasePrepare2;},BaseRenderTexture:function BaseRenderTexture(){return _BaseRenderTexture;},BaseTexture:function BaseTexture(){return _BaseTexture2;},BatchDrawCall:function BatchDrawCall(){return _BatchDrawCall;},BatchGeometry:function BatchGeometry(){return _BatchGeometry;},BatchRenderer:function BatchRenderer(){return _BatchRenderer2;},BatchShaderGenerator:function BatchShaderGenerator(){return _BatchShaderGenerator;},BatchSystem:function BatchSystem(){return _BatchSystem;},BatchTextureArray:function BatchTextureArray(){return _BatchTextureArray;},BitmapFont:function BitmapFont(){return _BitmapFont2;},BitmapFontData:function BitmapFontData(){return _BitmapFontData;},BitmapText:function BitmapText(){return _BitmapText2;},BlobResource:function BlobResource(){return _BlobResource;},BlurFilter:function BlurFilter(){return _BlurFilter;},BlurFilterPass:function BlurFilterPass(){return _BlurFilterPass;},Bounds:function Bounds(){return _Bounds;},BrowserAdapter:function BrowserAdapter(){return _BrowserAdapter;},Buffer:function Buffer(){return _Buffer;},BufferResource:function BufferResource(){return _BufferResource;},BufferSystem:function BufferSystem(){return _BufferSystem;},CLEAR_MODES:function CLEAR_MODES(){return _CLEAR_MODES;},COLOR_MASK_BITS:function COLOR_MASK_BITS(){return _COLOR_MASK_BITS;},Cache:function Cache(){return _Cache;},CanvasResource:function CanvasResource(){return _CanvasResource;},Circle:function Circle(){return _Circle;},Color:function Color(){return _Color2;},ColorMatrixFilter:function ColorMatrixFilter(){return _ColorMatrixFilter;},CompressedTextureResource:function CompressedTextureResource(){return _CompressedTextureResource;},Container:function Container(){return _Container2;},ContextSystem:function ContextSystem(){return _ContextSystem;},CountLimiter:function CountLimiter(){return _CountLimiter;},CubeResource:function CubeResource(){return _CubeResource2;},DEG_TO_RAD:function DEG_TO_RAD(){return _DEG_TO_RAD;},DRAW_MODES:function DRAW_MODES(){return _DRAW_MODES;},DisplacementFilter:function DisplacementFilter(){return _DisplacementFilter;},DisplayObject:function DisplayObject(){return _DisplayObject;},ENV:function ENV(){return _ENV;},Ellipse:function Ellipse(){return _Ellipse;},EventBoundary:function EventBoundary(){return _EventBoundary;},EventSystem:function EventSystem(){return _EventSystem2;},ExtensionType:function ExtensionType(){return _ExtensionType;},Extract:function Extract(){return _Extract2;},FORMATS:function FORMATS(){return _FORMATS;},FORMATS_TO_COMPONENTS:function FORMATS_TO_COMPONENTS(){return _FORMATS_TO_COMPONENTS;},FXAAFilter:function FXAAFilter(){return _FXAAFilter;},FederatedDisplayObject:function FederatedDisplayObject(){return _FederatedDisplayObject;},FederatedEvent:function FederatedEvent(){return _FederatedEvent;},FederatedMouseEvent:function FederatedMouseEvent(){return _FederatedMouseEvent;},FederatedPointerEvent:function FederatedPointerEvent(){return _FederatedPointerEvent;},FederatedWheelEvent:function FederatedWheelEvent(){return _FederatedWheelEvent;},FillStyle:function FillStyle(){return _FillStyle;},Filter:function Filter(){return _Filter2;},FilterState:function FilterState(){return _FilterState;},FilterSystem:function FilterSystem(){return _FilterSystem;},Framebuffer:function Framebuffer(){return _Framebuffer;},FramebufferSystem:function FramebufferSystem(){return _FramebufferSystem;},GC_MODES:function GC_MODES(){return _GC_MODES;},GLFramebuffer:function GLFramebuffer(){return _GLFramebuffer;},GLProgram:function GLProgram(){return _GLProgram;},GLTexture:function GLTexture(){return _GLTexture;},GRAPHICS_CURVES:function GRAPHICS_CURVES(){return _GRAPHICS_CURVES;},GenerateTextureSystem:function GenerateTextureSystem(){return _GenerateTextureSystem;},Geometry:function Geometry(){return _Geometry;},GeometrySystem:function GeometrySystem(){return _GeometrySystem;},Graphics:function Graphics(){return _Graphics2;},GraphicsData:function GraphicsData(){return _GraphicsData;},GraphicsGeometry:function GraphicsGeometry(){return _GraphicsGeometry2;},HTMLText:function HTMLText(){return _HTMLText2;},HTMLTextStyle:function HTMLTextStyle(){return _HTMLTextStyle2;},IGLUniformData:function IGLUniformData(){return _IGLUniformData;},INSTALLED:function INSTALLED(){return _INSTALLED;},INTERNAL_FORMATS:function INTERNAL_FORMATS(){return _INTERNAL_FORMATS;},INTERNAL_FORMAT_TO_BYTES_PER_PIXEL:function INTERNAL_FORMAT_TO_BYTES_PER_PIXEL(){return _INTERNAL_FORMAT_TO_BYTES_PER_PIXEL;},ImageBitmapResource:function ImageBitmapResource(){return _ImageBitmapResource;},ImageResource:function ImageResource(){return _ImageResource;},LINE_CAP:function LINE_CAP(){return _LINE_CAP;},LINE_JOIN:function LINE_JOIN(){return _LINE_JOIN;},LineStyle:function LineStyle(){return _LineStyle;},LoaderParserPriority:function LoaderParserPriority(){return _LoaderParserPriority;},MASK_TYPES:function MASK_TYPES(){return _MASK_TYPES;},MIPMAP_MODES:function MIPMAP_MODES(){return _MIPMAP_MODES;},MSAA_QUALITY:function MSAA_QUALITY(){return _MSAA_QUALITY;},MaskData:function MaskData(){return _MaskData;},MaskSystem:function MaskSystem(){return _MaskSystem;},Matrix:function Matrix(){return _Matrix;},Mesh:function Mesh(){return _Mesh2;},MeshBatchUvs:function MeshBatchUvs(){return _MeshBatchUvs;},MeshGeometry:function MeshGeometry(){return _MeshGeometry;},MeshMaterial:function MeshMaterial(){return _MeshMaterial;},MultisampleSystem:function MultisampleSystem(){return _MultisampleSystem;},NineSlicePlane:function NineSlicePlane(){return _NineSlicePlane;},NoiseFilter:function NoiseFilter(){return _NoiseFilter;},ObjectRenderer:function ObjectRenderer(){return _ObjectRenderer;},ObjectRendererSystem:function ObjectRendererSystem(){return _ObjectRendererSystem;},ObservablePoint:function ObservablePoint(){return _ObservablePoint;},PI_2:function PI_2(){return _PI_;},PRECISION:function PRECISION(){return _PRECISION;},ParticleContainer:function ParticleContainer(){return _ParticleContainer;},ParticleRenderer:function ParticleRenderer(){return _ParticleRenderer;},PlaneGeometry:function PlaneGeometry(){return _PlaneGeometry;},PluginSystem:function PluginSystem(){return _PluginSystem;},Point:function Point(){return _Point;},Polygon:function Polygon(){return _Polygon;},Prepare:function Prepare(){return _Prepare;},Program:function Program(){return _Program2;},ProjectionSystem:function ProjectionSystem(){return _ProjectionSystem;},Quad:function Quad(){return _Quad;},QuadUv:function QuadUv(){return _QuadUv;},RAD_TO_DEG:function RAD_TO_DEG(){return _RAD_TO_DEG;},RENDERER_TYPE:function RENDERER_TYPE(){return _RENDERER_TYPE;},Rectangle:function Rectangle(){return _Rectangle;},RenderTexture:function RenderTexture(){return _RenderTexture;},RenderTexturePool:function RenderTexturePool(){return _RenderTexturePool;},RenderTextureSystem:function RenderTextureSystem(){return _RenderTextureSystem;},Renderer:function Renderer(){return _Renderer2;},ResizePlugin:function ResizePlugin(){return _ResizePlugin;},Resource:function Resource(){return _Resource;},RopeGeometry:function RopeGeometry(){return _RopeGeometry;},RoundedRectangle:function RoundedRectangle(){return _RoundedRectangle;},Runner:function Runner(){return _Runner;},SAMPLER_TYPES:function SAMPLER_TYPES(){return _SAMPLER_TYPES;},SCALE_MODES:function SCALE_MODES(){return _SCALE_MODES;},SHAPES:function SHAPES(){return _SHAPES;},SVGResource:function SVGResource(){return _SVGResource2;},ScissorSystem:function ScissorSystem(){return _ScissorSystem2;},Shader:function Shader(){return _Shader;},ShaderSystem:function ShaderSystem(){return _ShaderSystem;},SimpleMesh:function SimpleMesh(){return _SimpleMesh;},SimplePlane:function SimplePlane(){return _SimplePlane;},SimpleRope:function SimpleRope(){return _SimpleRope;},Sprite:function Sprite(){return _Sprite;},SpriteMaskFilter:function SpriteMaskFilter(){return _SpriteMaskFilter;},Spritesheet:function Spritesheet(){return _Spritesheet2;},StartupSystem:function StartupSystem(){return _StartupSystem;},State:function State(){return _State;},StateSystem:function StateSystem(){return _StateSystem2;},StencilSystem:function StencilSystem(){return _StencilSystem;},SystemManager:function SystemManager(){return _SystemManager;},TARGETS:function TARGETS(){return _TARGETS;},TEXT_GRADIENT:function TEXT_GRADIENT(){return _TEXT_GRADIENT;},TYPES:function TYPES(){return _TYPES;},TYPES_TO_BYTES_PER_COMPONENT:function TYPES_TO_BYTES_PER_COMPONENT(){return _TYPES_TO_BYTES_PER_COMPONENT;},TYPES_TO_BYTES_PER_PIXEL:function TYPES_TO_BYTES_PER_PIXEL(){return _TYPES_TO_BYTES_PER_PIXEL;},TemporaryDisplayObject:function TemporaryDisplayObject(){return _TemporaryDisplayObject;},Text:function Text(){return _Text2;},TextFormat:function TextFormat(){return _TextFormat;},TextMetrics:function TextMetrics(){return _TextMetrics2;},TextStyle:function TextStyle(){return _TextStyle2;},Texture:function Texture(){return Texture_Texture;},TextureGCSystem:function TextureGCSystem(){return _TextureGCSystem2;},TextureMatrix:function TextureMatrix(){return _TextureMatrix;},TextureSystem:function TextureSystem(){return _TextureSystem;},TextureUvs:function TextureUvs(){return _TextureUvs;},Ticker:function Ticker(){return _Ticker2;},TickerPlugin:function TickerPlugin(){return _TickerPlugin;},TilingSprite:function TilingSprite(){return _TilingSprite;},TilingSpriteRenderer:function TilingSpriteRenderer(){return _TilingSpriteRenderer;},TimeLimiter:function TimeLimiter(){return _TimeLimiter;},Transform:function Transform(){return _Transform2;},TransformFeedback:function TransformFeedback(){return _TransformFeedback;},TransformFeedbackSystem:function TransformFeedbackSystem(){return _TransformFeedbackSystem;},UPDATE_PRIORITY:function UPDATE_PRIORITY(){return _UPDATE_PRIORITY;},UniformGroup:function UniformGroup(){return _UniformGroup;},VERSION:function VERSION(){return _VERSION;},VideoResource:function VideoResource(){return _VideoResource2;},ViewSystem:function ViewSystem(){return _ViewSystem;},ViewableBuffer:function ViewableBuffer(){return _ViewableBuffer;},WRAP_MODES:function WRAP_MODES(){return _WRAP_MODES;},XMLFormat:function XMLFormat(){return _XMLFormat;},XMLStringFormat:function XMLStringFormat(){return _XMLStringFormat;},accessibleTarget:function accessibleTarget(){return _accessibleTarget;},autoDetectFormat:function autoDetectFormat(){return _autoDetectFormat;},autoDetectRenderer:function autoDetectRenderer(){return _autoDetectRenderer;},autoDetectResource:function autoDetectResource(){return _autoDetectResource;},cacheTextureArray:function cacheTextureArray(){return _cacheTextureArray;},checkDataUrl:function checkDataUrl(){return _checkDataUrl;},checkExtension:function checkExtension(){return _checkExtension;},checkMaxIfStatementsInShader:function checkMaxIfStatementsInShader(){return _checkMaxIfStatementsInShader;},convertToList:function convertToList(){return _convertToList;},copySearchParams:function copySearchParams(){return _copySearchParams;},createStringVariations:function createStringVariations(){return _createStringVariations;},createTexture:function createTexture(){return _createTexture;},createUBOElements:function createUBOElements(){return _createUBOElements;},curves:function curves(){return _curves;},defaultFilterVertex:function defaultFilterVertex(){return _defaultFilterVertex;},defaultVertex:function defaultVertex(){return fragments_defaultVertex;},detectAvif:function detectAvif(){return _detectAvif;},detectCompressedTextures:function detectCompressedTextures(){return _detectCompressedTextures;},detectDefaults:function detectDefaults(){return _detectDefaults;},detectMp4:function detectMp4(){return _detectMp;},detectOgv:function detectOgv(){return _detectOgv;},detectWebm:function detectWebm(){return _detectWebm;},detectWebp:function detectWebp(){return _detectWebp;},extensions:function extensions(){return _extensions;},filters:function filters(){return _filters;},generateProgram:function generateProgram(){return _generateProgram;},generateUniformBufferSync:function generateUniformBufferSync(){return _generateUniformBufferSync;},getFontFamilyName:function getFontFamilyName(){return _getFontFamilyName;},getTestContext:function getTestContext(){return _getTestContext;},getUBOData:function getUBOData(){return _getUBOData;},graphicsUtils:function graphicsUtils(){return _graphicsUtils;},groupD8:function groupD8(){return _groupD;},isMobile:function isMobile(){return isMobile_isMobile;},isSingleItem:function isSingleItem(){return _isSingleItem;},loadBitmapFont:function loadBitmapFont(){return _loadBitmapFont;},loadDDS:function loadDDS(){return _loadDDS;},loadImageBitmap:function loadImageBitmap(){return _loadImageBitmap;},loadJson:function loadJson(){return _loadJson;},loadKTX:function loadKTX(){return _loadKTX;},loadSVG:function loadSVG(){return _loadSVG;},loadTextures:function loadTextures(){return _loadTextures;},loadTxt:function loadTxt(){return _loadTxt;},loadVideo:function loadVideo(){return _loadVideo;},loadWebFont:function loadWebFont(){return _loadWebFont;},parseDDS:function parseDDS(){return _parseDDS;},parseKTX:function parseKTX(){return _parseKTX;},resolveCompressedTextureUrl:function resolveCompressedTextureUrl(){return _resolveCompressedTextureUrl;},resolveTextureUrl:function resolveTextureUrl(){return _resolveTextureUrl;},settings:function settings(){return _settings;},spritesheetAsset:function spritesheetAsset(){return _spritesheetAsset;},uniformParsers:function uniformParsers(){return _uniformParsers;},unsafeEvalSupported:function unsafeEvalSupported(){return _unsafeEvalSupported;},utils:function utils(){return utils_lib_namespaceObject;}});var errorBus=__webpack_require__(9672),eventemitter3=__webpack_require__(228);var node_modules_eventemitter3=null;function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},_typeof(e);}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n);}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+"";}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r));}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e);}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!e;})();}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},_getPrototypeOf(e);}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t);}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},_setPrototypeOf(e,t);}var __classPrivateFieldSet=function __classPrivateFieldSet(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r;},__classPrivateFieldGet=function __classPrivateFieldGet(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e);},_VideoTrack_track,_VideoTrack_skip,_VideoTrack_counter,VideoTrack=function(e){function t(){var e;return _classCallCheck(this,t),e=_callSuper(this,t),_VideoTrack_track.set(e,void 0),_VideoTrack_skip.set(e,2),_VideoTrack_counter.set(e,0),e.width=0,e.height=0,e;}return _inherits(t,eventemitter3),_createClass(t,[{key:"setSkipCount",value:function value(e){__classPrivateFieldSet(this,_VideoTrack_skip,e,"f");}},{key:"set",value:function value(e){var t=this;e instanceof MediaStream?__classPrivateFieldSet(this,_VideoTrack_track,e.getVideoTracks()[0],"f"):__classPrivateFieldSet(this,_VideoTrack_track,e,"f"),null!=__classPrivateFieldGet(this,_VideoTrack_track,"f").getSettings().width&&(this.width=__classPrivateFieldGet(this,_VideoTrack_track,"f").getSettings().width),null!=__classPrivateFieldGet(this,_VideoTrack_track,"f").getSettings().height&&(this.height=__classPrivateFieldGet(this,_VideoTrack_track,"f").getSettings().height),__classPrivateFieldGet(this,_VideoTrack_track,"f").onended&&(__classPrivateFieldGet(this,_VideoTrack_track,"f").onended=function(){return t.emit("ended",t);});}},{key:"stop",value:function value(){__classPrivateFieldGet(this,_VideoTrack_track,"f")&&__classPrivateFieldGet(this,_VideoTrack_track,"f").stop();}},{key:"update",value:function value(e,t){var r;if(__classPrivateFieldGet(this,_VideoTrack_track,"f")&&(__classPrivateFieldSet(this,_VideoTrack_counter,(r=__classPrivateFieldGet(this,_VideoTrack_counter,"f"),++r),"f"),!(__classPrivateFieldGet(this,_VideoTrack_counter,"f")%__classPrivateFieldGet(this,_VideoTrack_skip,"f")))){var n=!1;if(!e&&!t){var i=__classPrivateFieldGet(this,_VideoTrack_track,"f").getSettings();i.width,i.height;}this.width!=e&&(n=!0,this.width=e),this.height!=t&&(n=!0,this.height=t),n&&this.emit("update",this);}}},{key:"getSettings",value:function value(e){return __classPrivateFieldGet(this,_VideoTrack_track,"f"),e||(e={width:this.width,height:this.height,aspectRatio:this.width/this.height}),Object.assign(__classPrivateFieldGet(this,_VideoTrack_track,"f").getSettings(),e);}},{key:"getConstraints",value:function value(e){return __classPrivateFieldGet(this,_VideoTrack_track,"f"),e||(e={width:this.width,height:this.height}),Object.assign(__classPrivateFieldGet(this,_VideoTrack_track,"f").getConstraints(),e);}},{key:"getCapabilities",value:function value(e){return __classPrivateFieldGet(this,_VideoTrack_track,"f"),Object.assign(__classPrivateFieldGet(this,_VideoTrack_track,"f").getCapabilities(),e);}},{key:"applyConstraints",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(__classPrivateFieldGet(this,_VideoTrack_track,"f")){e.next=2;break;}return e.abrupt("return");case 2:__classPrivateFieldGet(this,_VideoTrack_track,"f").applyConstraints(t);case 3:case"end":return e.stop();}},e,this);})),function(e){return r.apply(this,arguments);})}]);var r;}();function utils_typeof(e){return utils_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},utils_typeof(e);}function utils_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function utils_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,utils_toPropertyKey(n.key),n);}}function utils_createClass(e,t,r){return t&&utils_defineProperties(e.prototype,t),r&&utils_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function utils_toPropertyKey(e){var t=utils_toPrimitive(e,"string");return"symbol"==utils_typeof(t)?t:t+"";}function utils_toPrimitive(e,t){if("object"!=utils_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=utils_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}_VideoTrack_track=new WeakMap(),_VideoTrack_skip=new WeakMap(),_VideoTrack_counter=new WeakMap();var FrameTimer=function(){return utils_createClass(function e(){utils_classCallCheck(this,e),this.frame_count=30,this.frames=[1];},[{key:"start",value:function value(){this.t0=performance.now();}},{key:"finish",value:function value(){var e=performance.now()-this.t0;this.frames.push(e),this.frames.length>this.frame_count&&this.frames.shift();}},{key:"getFrameFps",value:function value(){var e=this.frames.reduce(function(e,t){return e+t;},0);return 0==e||isNaN(e)?1:Math.round(1e3/(e/this.frame_count));}},{key:"getFrameDuration",value:function value(){return Math.round(1e6/this.getFrameFps());}},{key:"getFrameTime",value:function value(){return Math.round(this.frames.reduce(function(e,t){return e+t;},0)/this.frame_count);}}]);}(),FrameStatistics=function(){return utils_createClass(function e(){utils_classCallCheck(this,e),this.pattern="Output FPS: {{output_fps}}\nFrame Draw Time: {{frame_time}}ms\nInference Time: {{inference_time}}ms",this.stats=new Map();},[{key:"updateStats",value:function value(e,t){return this.stats.set(e,t),!0;}},{key:"getText",value:function value(){var e=this.pattern;return this.stats.forEach(function(t,r){e=e.replaceAll("{{"+r+"}}",t.toString());}),e;}}]);}();function stream_processor_typeof(e){return stream_processor_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},stream_processor_typeof(e);}function stream_processor_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function stream_processor_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,stream_processor_toPropertyKey(n.key),n);}}function stream_processor_createClass(e,t,r){return t&&stream_processor_defineProperties(e.prototype,t),r&&stream_processor_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function stream_processor_toPropertyKey(e){var t=stream_processor_toPrimitive(e,"string");return"symbol"==stream_processor_typeof(t)?t:t+"";}function stream_processor_toPrimitive(e,t){if("object"!=stream_processor_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=stream_processor_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var StreamProcessor=function(){return stream_processor_createClass(function e(t){stream_processor_classCallCheck(this,e),this.video=null,this.stream=null,this.videoTrack=null,this.audioTrack=null,this.transformFrame=null,this.updateVideoTrack=null,this.toCanvas=null,this.lastFrameTime=0,this.fpsLimit=30,this.timestamp=0,this.isRunning=!1,this.isPaused=!1,this.sdkOptions=t,this.outputCanvas=document.createElement("canvas"),this.outputCanvas.width=this.sdkOptions.width,this.outputCanvas.height=this.sdkOptions.height,this.bufferCanvas=document.createElement("canvas"),this.bufferCanvas.width=this.sdkOptions.width,this.bufferCanvas.height=this.sdkOptions.height,this.frameTimer=new FrameTimer(),this.frameTime=0,this.fps=0,this.enableFps=!1,this.frame_count=0,this.videoTrackWrapper=new VideoTrack(),this.videoTrackWrapper.on("update",this.onTrackUpdate,this);},[{key:"onTrackUpdate",value:function value(){this.sdkOptions.setSize(this.videoTrackWrapper.width,this.videoTrackWrapper.height),"function"==typeof this.changeInputResolutionFuncition&&this.changeInputResolutionFuncition();}},{key:"clearBuffers",value:function value(){}},{key:"onChangeInputResolution",value:function value(e){var t="function"==typeof e;this.changeInputResolutionFuncition=t?e:void 0;}},{key:"onFrameDraw",value:function value(e){var t="function"==typeof e;this.frameDrawFunction=t?e:void 0;}},{key:"setOutputResolution",value:function value(e,t){this.sdkOptions.setCustomSize(e,t);}},{key:"clearOutputResolution",value:function value(){this.sdkOptions.customSize=!1,this.sdkOptions.setSize(this.videoTrackWrapper.width,this.videoTrackWrapper.height);}},{key:"useEffectProcessor",value:function value(e){this.effectProcessor=e;}},{key:"pause",value:function value(){this.isPaused=!0;}},{key:"unpause",value:function value(){this.isPaused=!1;}},{key:"setRenderer",value:function value(e){this.renderer=e;}},{key:"destroy",value:function value(){this.videoTrackWrapper.off("update",this.onTrackUpdate,this);}},{key:"setFpsLimit",value:function value(e){var t;this.fpsLimit=e,null===(t=this.getInputVideoTrack())||void 0===t||t.applyConstraints({frameRate:this.fpsLimit});}},{key:"useStream",value:function value(e){this.stream=e,this.useVideoTrack(this.stream.getVideoTracks()[0]);}},{key:"useVideoTrack",value:function value(e){this.videoTrack=e,this.videoTrackWrapper.set(this.videoTrack);}},{key:"getInputStream",value:function value(){return this.stream?this.stream:null;}},{key:"getInputVideoTrack",value:function value(){return this.videoTrack?this.videoTrack:null;}},{key:"showFps",value:function value(){this.enableFps=!0;}},{key:"hideFps",value:function value(){this.enableFps=!1,this.renderer.hideStatistics();}},{key:"drawFps",value:function value(){this.enableFps&&this.frame_count%30==0&&(this.renderer.updateStatistics("output_fps",this.frameTimer.getFrameFps()),this.renderer.drawStatistics());}},{key:"process",value:function value(){this.transformFrame&&this.transformFrame();}},{key:"clearTransformCallback",value:function value(){this.transformFrame=null;}},{key:"transformCallback",value:function value(e){this.transformFrame=e;}},{key:"renderToCanvas",value:function value(e){this.toCanvas=e;}},{key:"getCanvas",value:function value(){return this.outputCanvas;}},{key:"getStream",value:function value(){return this.stream;}}]);}(),_ENV=function(e){return e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2",e;}(_ENV||{}),_RENDERER_TYPE=function(e){return e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS",e;}(_RENDERER_TYPE||{}),_BUFFER_BITS=function(e){return e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e;}(_BUFFER_BITS||{}),_BLEND_MODES=function(e){return e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR",e;}(_BLEND_MODES||{}),_DRAW_MODES=function(e){return e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e;}(_DRAW_MODES||{}),_FORMATS=function(e){return e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e;}(_FORMATS||{}),_TARGETS=function(e){return e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e;}(_TARGETS||{}),_TYPES=function(e){return e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e;}(_TYPES||{}),_SAMPLER_TYPES=function(e){return e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT",e;}(_SAMPLER_TYPES||{}),_SCALE_MODES=function(e){return e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e;}(_SCALE_MODES||{}),_WRAP_MODES=function(e){return e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e;}(_WRAP_MODES||{}),_MIPMAP_MODES=function(e){return e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL",e;}(_MIPMAP_MODES||{}),_ALPHA_MODES=function(e){return e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",e;}(_ALPHA_MODES||{}),_CLEAR_MODES=function(e){return e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT",e;}(_CLEAR_MODES||{}),_GC_MODES=function(e){return e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",e;}(_GC_MODES||{}),_PRECISION=function(e){return e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp",e;}(_PRECISION||{}),_MASK_TYPES=function(e){return e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE",e[e.COLOR=4]="COLOR",e;}(_MASK_TYPES||{}),_COLOR_MASK_BITS=function(e){return e[e.RED=1]="RED",e[e.GREEN=2]="GREEN",e[e.BLUE=4]="BLUE",e[e.ALPHA=8]="ALPHA",e;}(_COLOR_MASK_BITS||{}),_MSAA_QUALITY=function(e){return e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e;}(_MSAA_QUALITY||{}),_BUFFER_TYPE=function(e){return e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e;}(_BUFFER_TYPE||{});var _BrowserAdapter={createCanvas:function createCanvas(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r;},getCanvasRenderingContext2D:function getCanvasRenderingContext2D(){return CanvasRenderingContext2D;},getWebGLRenderingContext:function getWebGLRenderingContext(){return WebGLRenderingContext;},getNavigator:function getNavigator(){return navigator;},getBaseUrl:function getBaseUrl(){var _document$baseURI;return(_document$baseURI=document.baseURI)!==null&&_document$baseURI!==void 0?_document$baseURI:window.location.href;},getFontFaceSet:function getFontFaceSet(){return document.fonts;},fetch:function(_fetch){function fetch(_x93,_x94){return _fetch.apply(this,arguments);}fetch.toString=function(){return _fetch.toString();};return fetch;}(function(e,t){return fetch(e,t);}),parseXML:function parseXML(e){return new DOMParser().parseFromString(e,"text/xml");}},_settings={ADAPTER:_BrowserAdapter,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var appleIphone=/iPhone/i,appleIpod=/iPod/i,appleTablet=/iPad/i,appleUniversal=/\biOS-universal(?:.+)Mac\b/i,androidPhone=/\bAndroid(?:.+)Mobile\b/i,androidTablet=/Android/i,amazonPhone=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,amazonTablet=/Silk/i,windowsPhone=/Windows Phone/i,windowsTablet=/\bWindows(?:.+)ARM\b/i,otherBlackBerry=/BlackBerry/i,otherBlackBerry10=/BB10/i,otherOpera=/Opera Mini/i,otherChrome=/\b(CriOS|Chrome)(?:.+)Mobile/i,otherFirefox=/Mobile(?:.+)Firefox\b/i,isAppleTabletOnIos13=function isAppleTabletOnIos13(e){return void 0!==e&&"MacIntel"===e.platform&&"number"==typeof e.maxTouchPoints&&e.maxTouchPoints>1&&"undefined"==typeof MSStream;};function createMatch(e){return function(t){return t.test(e);};}function isMobile(e){var t={userAgent:"",platform:"",maxTouchPoints:0};e||"undefined"==typeof navigator?"string"==typeof e?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0}):t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=t.userAgent,n=r.split("[FBAN");void 0!==n[1]&&(r=n[0]),void 0!==(n=r.split("Twitter"))[1]&&(r=n[0]);var i=createMatch(r),o={apple:{phone:i(appleIphone)&&!i(windowsPhone),ipod:i(appleIpod),tablet:!i(appleIphone)&&(i(appleTablet)||isAppleTabletOnIos13(t))&&!i(windowsPhone),universal:i(appleUniversal),device:(i(appleIphone)||i(appleIpod)||i(appleTablet)||i(appleUniversal)||isAppleTabletOnIos13(t))&&!i(windowsPhone)},amazon:{phone:i(amazonPhone),tablet:!i(amazonPhone)&&i(amazonTablet),device:i(amazonPhone)||i(amazonTablet)},android:{phone:!i(windowsPhone)&&i(amazonPhone)||!i(windowsPhone)&&i(androidPhone),tablet:!i(windowsPhone)&&!i(amazonPhone)&&!i(androidPhone)&&(i(amazonTablet)||i(androidTablet)),device:!i(windowsPhone)&&(i(amazonPhone)||i(amazonTablet)||i(androidPhone)||i(androidTablet))||i(/\bokhttp\b/i)},windows:{phone:i(windowsPhone),tablet:i(windowsTablet),device:i(windowsPhone)||i(windowsTablet)},other:{blackberry:i(otherBlackBerry),blackberry10:i(otherBlackBerry10),opera:i(otherOpera),firefox:i(otherFirefox),chrome:i(otherChrome),device:i(otherBlackBerry)||i(otherBlackBerry10)||i(otherOpera)||i(otherFirefox)||i(otherChrome)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o;}var isMobileCall=(_isMobile$default=isMobile["default"])!==null&&_isMobile$default!==void 0?_isMobile$default:isMobile,isMobile_isMobile=isMobileCall(globalThis.navigator);_settings.RETINA_PREFIX=/@([0-9\.]+)x/,_settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var utils_node_modules_eventemitter3=__webpack_require__(9452),_earcut=__webpack_require__(6570),url=__webpack_require__(8835);var warnings={};function _deprecation(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:3;if(warnings[t])return;var n=new Error().stack;_typeof2(n)>"u"?console.warn("PixiJS Deprecation Warning: ","".concat(t,"\nDeprecated since v").concat(e)):(n=n.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6","".concat(t,"\nDeprecated since v").concat(e)),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ","".concat(t,"\nDeprecated since v").concat(e)),console.warn(n))),warnings[t]=!0;}var url_url={get parse(){return _deprecation("7.3.0","utils.url.parse is deprecated, use native URL API instead."),url.qg;},get format(){return _deprecation("7.3.0","utils.url.format is deprecated, use native URL API instead."),url.GP;},get resolve(){return _deprecation("7.3.0","utils.url.resolve is deprecated, use native URL API instead."),url.hd;}};function assertPath(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received ".concat(JSON.stringify(e)));}function removeUrlParams(e){return e.split("?")[0].split("#")[0];}function escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");}function replaceAll(e,t,r){return e.replace(new RegExp(escapeRegExp(t),"g"),r);}function normalizeStringPosix(e,t){var r="",n=0,i=-1,o=0,a=-1;for(var _s22=0;_s22<=e.length;++_s22){if(_s22<e.length)a=e.charCodeAt(_s22);else{if(47===a)break;a=47;}if(47===a){if(i!==_s22-1&&1!==o)if(i!==_s22-1&&2===o){if(r.length<2||2!==n||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var _e230=r.lastIndexOf("/");if(_e230!==r.length-1){-1===_e230?(r="",n=0):(r=r.slice(0,_e230),n=r.length-1-r.lastIndexOf("/")),i=_s22,o=0;continue;}}else if(2===r.length||1===r.length){r="",n=0,i=_s22,o=0;continue;}t&&(r.length>0?r+="/..":r="..",n=2);}else r.length>0?r+="/".concat(e.slice(i+1,_s22)):r=e.slice(i+1,_s22),n=_s22-i-1;i=_s22,o=0;}else 46===a&&-1!==o?++o:o=-1;}return r;}var _path={toPosix:function toPosix(e){return replaceAll(e,"\\","/");},isUrl:function isUrl(e){return /^https?:/.test(this.toPosix(e));},isDataUrl:function isDataUrl(e){return /^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e);},isBlobUrl:function isBlobUrl(e){return e.startsWith("blob:");},hasProtocol:function hasProtocol(e){return /^[^/:]+:/.test(this.toPosix(e));},getProtocol:function getProtocol(e){assertPath(e),e=this.toPosix(e);var t=/^file:\/\/\//.exec(e);if(t)return t[0];var r=/^[^/:]+:\/{0,2}/.exec(e);return r?r[0]:"";},toAbsolute:function toAbsolute(e,t,r){if(assertPath(e),this.isDataUrl(e)||this.isBlobUrl(e))return e;var n=removeUrlParams(this.toPosix(t!==null&&t!==void 0?t:_settings.ADAPTER.getBaseUrl())),i=removeUrlParams(this.toPosix(r!==null&&r!==void 0?r:this.rootname(n)));return(e=this.toPosix(e)).startsWith("/")?_path.join(i,e.slice(1)):this.isAbsolute(e)?e:this.join(n,e);},normalize:function normalize(e){if(assertPath(e),0===e.length)return".";if(this.isDataUrl(e)||this.isBlobUrl(e))return e;var t="";var r=(e=this.toPosix(e)).startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));var n=e.endsWith("/");return(e=normalizeStringPosix(e,!1)).length>0&&n&&(e+="/"),r?"/".concat(e):t+e;},isAbsolute:function isAbsolute(e){return assertPath(e),e=this.toPosix(e),!!this.hasProtocol(e)||e.startsWith("/");},join:function join(){if(0===arguments.length)return".";var t;for(var r=0;r<arguments.length;++r){var _n82=r<0||arguments.length<=r?undefined:arguments[r];if(assertPath(_n82),_n82.length>0)if(void 0===t)t=_n82;else{var _ref32;var _i67=(_ref32=r-1<0||arguments.length<=r-1?undefined:arguments[r-1])!==null&&_ref32!==void 0?_ref32:"";this.joinExtensions.includes(this.extname(_i67).toLowerCase())?t+="/../".concat(_n82):t+="/".concat(_n82);}}return void 0===t?".":this.normalize(t);},dirname:function dirname(e){if(assertPath(e),0===e.length)return".";var t=(e=this.toPosix(e)).charCodeAt(0);var r=47===t;var n=-1,i=!0;var o=this.getProtocol(e),a=e;for(var _r172=(e=e.slice(o.length)).length-1;_r172>=1;--_r172)if(t=e.charCodeAt(_r172),47===t){if(!i){n=_r172;break;}}else i=!1;return-1===n?r?"/":this.isUrl(a)?o+e:o:r&&1===n?"//":o+e.slice(0,n);},rootname:function rootname(e){assertPath(e);var t="";if(t=(e=this.toPosix(e)).startsWith("/")?"/":this.getProtocol(e),this.isUrl(e)){var r=e.indexOf("/",t.length);t=-1!==r?e.slice(0,r):e,t.endsWith("/")||(t+="/");}return t;},basename:function basename(e,t){assertPath(e),t&&assertPath(t),e=removeUrlParams(this.toPosix(e));var r,n=0,i=-1,o=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var _a26=t.length-1,_s23=-1;for(r=e.length-1;r>=0;--r){var _u18=e.charCodeAt(r);if(47===_u18){if(!o){n=r+1;break;}}else-1===_s23&&(o=!1,_s23=r+1),_a26>=0&&(_u18===t.charCodeAt(_a26)?-1==--_a26&&(i=r):(_a26=-1,i=_s23));}return n===i?i=_s23:-1===i&&(i=e.length),e.slice(n,i);}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!o){n=r+1;break;}}else-1===i&&(o=!1,i=r+1);return-1===i?"":e.slice(n,i);},extname:function extname(e){assertPath(e);var t=-1,r=0,n=-1,i=!0,o=0;for(var _a27=(e=removeUrlParams(this.toPosix(e))).length-1;_a27>=0;--_a27){var _s24=e.charCodeAt(_a27);if(47!==_s24)-1===n&&(i=!1,n=_a27+1),46===_s24?-1===t?t=_a27:1!==o&&(o=1):-1!==t&&(o=-1);else if(!i){r=_a27+1;break;}}return-1===t||-1===n||0===o||1===o&&t===n-1&&t===r+1?"":e.slice(t,n);},parse:function parse(e){assertPath(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var r=(e=removeUrlParams(this.toPosix(e))).charCodeAt(0);var n=this.isAbsolute(e);var i;t.root=this.rootname(e),i=n||this.hasProtocol(e)?1:0;var o=-1,a=0,s=-1,u=!0,l=e.length-1,c=0;for(;l>=i;--l)if(r=e.charCodeAt(l),47!==r)-1===s&&(u=!1,s=l+1),46===r?-1===o?o=l:1!==c&&(c=1):-1!==o&&(c=-1);else if(!u){a=l+1;break;}return-1===o||-1===s||0===c||1===c&&o===s-1&&o===a+1?-1!==s&&(t.base=t.name=0===a&&n?e.slice(1,s):e.slice(a,s)):(0===a&&n?(t.name=e.slice(1,o),t.base=e.slice(1,s)):(t.name=e.slice(a,o),t.base=e.slice(a,s)),t.ext=e.slice(o,s)),t.dir=this.dirname(e),t;},sep:"/",delimiter:":",joinExtensions:[".html"]};var promise,supported;function _detectVideoAlphaMode(){return _detectVideoAlphaMode2.apply(this,arguments);}function _detectVideoAlphaMode2(){_detectVideoAlphaMode2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee186(){var _promise;return _regeneratorRuntime2().wrap(function _callee186$(_context192){while(1)switch(_context192.prev=_context192.next){case 0:return _context192.abrupt("return",((_promise=promise)!==null&&_promise!==void 0?_promise:promise=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee185(){var _e$getExtension;var e,t,r,n,i;return _regeneratorRuntime2().wrap(function _callee185$(_context191){while(1)switch(_context191.prev=_context191.next){case 0:e=document.createElement("canvas").getContext("webgl");if(e){_context191.next=3;break;}return _context191.abrupt("return",_ALPHA_MODES.UNPACK);case 3:_context191.next=5;return new Promise(function(e){var t=document.createElement("video");t.onloadeddata=function(){return e(t);},t.onerror=function(){return e(null);},t.autoplay=!1,t.crossOrigin="anonymous",t.preload="auto",t.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",t.load();});case 5:t=_context191.sent;if(t){_context191.next=8;break;}return _context191.abrupt("return",_ALPHA_MODES.UNPACK);case 8:r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);i=new Uint8Array(4);return _context191.abrupt("return",(e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,i),e.deleteFramebuffer(n),e.deleteTexture(r),(_e$getExtension=e.getExtension("WEBGL_lose_context"))!==null&&_e$getExtension!==void 0&&_e$getExtension.loseContext(),i[0]<=i[3]?_ALPHA_MODES.PMA:_ALPHA_MODES.UNPACK));case 14:case"end":return _context191.stop();}},_callee185);}))(),promise));case 1:case"end":return _context192.stop();}},_callee186);}));return _detectVideoAlphaMode2.apply(this,arguments);}function _skipHello(){_deprecation("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello");}function _sayHello(){_deprecation("7.0.0",'sayHello is deprecated, please use Renderer\'s "hello" option');}function _isWebGLSupported(){return _typeof2(supported)>"u"&&(supported=function(){var e={stencil:!0,failIfMajorPerformanceCaveat:_settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{var _r173;if(!_settings.ADAPTER.getWebGLRenderingContext())return!1;var _t135=_settings.ADAPTER.createCanvas();var r=_t135.getContext("webgl",e)||_t135.getContext("experimental-webgl",e);var _n83=!!((_r173=r)!==null&&_r173!==void 0&&(_r173=_r173.getContextAttributes())!==null&&_r173!==void 0&&_r173.stencil);if(r){var _e231=r.getExtension("WEBGL_lose_context");_e231&&_e231.loseContext();}return r=null,_n83;}catch(_unused13){return!1;}}()),supported;}var r={grad:.9,turn:360,rad:360/(2*Math.PI)},t=function t(e){return"string"==typeof e?e.length>0:"number"==typeof e;},n=function n(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=Math.pow(10,t)),Math.round(r*e)/r+0;},e=function e(_e232,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),_e232>r?r:_e232>t?_e232:t;},u=function u(e){return(e=isFinite(e)?e%360:0)>0?e:e+360;},a=function a(t){return{r:e(t.r,0,255),g:e(t.g,0,255),b:e(t.b,0,255),a:e(t.a)};},o=function o(e){return{r:n(e.r),g:n(e.g),b:n(e.b),a:n(e.a,3)};},i=/^#([0-9a-f]{3,8})$/i,s=function s(e){var t=e.toString(16);return t.length<2?"0"+t:t;},h=function h(e){var t=e.r,r=e.g,n=e.b,i=e.a,o=Math.max(t,r,n),a=o-Math.min(t,r,n),s=a?o===t?(r-n)/a:o===r?2+(n-t)/a:4+(t-r)/a:0;return{h:60*(s<0?s+6:s),s:o?a/o*100:0,v:o/255*100,a:i};},b=function b(e){var t=e.h,r=e.s,n=e.v,i=e.a;t=t/360*6,r/=100,n/=100;var o=Math.floor(t),a=n*(1-r),s=n*(1-(t-o)*r),u=n*(1-(1-t+o)*r),l=o%6;return{r:255*[n,s,a,a,u,n][l],g:255*[u,n,n,s,a,a][l],b:255*[a,a,u,n,n,s][l],a:i};},g=function g(t){return{h:u(t.h),s:e(t.s,0,100),l:e(t.l,0,100),a:e(t.a)};},d=function d(e){return{h:n(e.h),s:n(e.s),l:n(e.l),a:n(e.a,3)};},f=function f(e){return b((r=(t=e).s,{h:t.h,s:(r*=((n=t.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:t.a}));var t,r,n;},c=function c(e){return{h:(t=h(e)).h,s:(i=(200-(r=t.s))*(n=t.v)/100)>0&&i<200?r*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,r,n,i;},l=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,p=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,m=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y={string:[[function(e){var t=i.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?n(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?n(parseInt(e.substr(6,2),16)/255,2):1}:null:null;},"hex"],[function(e){var t=v.exec(e)||m.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:a({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null;},"rgb"],[function(e){var t=l.exec(e)||p.exec(e);if(!t)return null;var n,i,o=g({h:(n=t[1],i=t[2],void 0===i&&(i="deg"),Number(n)*(r[i]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return f(o);},"hsl"]],object:[[function(e){var r=e.r,n=e.g,i=e.b,o=e.a,s=void 0===o?1:o;return t(r)&&t(n)&&t(i)?a({r:Number(r),g:Number(n),b:Number(i),a:Number(s)}):null;},"rgb"],[function(e){var r=e.h,n=e.s,i=e.l,o=e.a,a=void 0===o?1:o;if(!t(r)||!t(n)||!t(i))return null;var s=g({h:Number(r),s:Number(n),l:Number(i),a:Number(a)});return f(s);},"hsl"],[function(r){var n=r.h,i=r.s,o=r.v,a=r.a,s=void 0===a?1:a;if(!t(n)||!t(i)||!t(o))return null;var l=function(t){return{h:u(t.h),s:e(t.s,0,100),v:e(t.v,0,100),a:e(t.a)};}({h:Number(n),s:Number(i),v:Number(o),a:Number(s)});return b(l);},"hsv"]]},N=function N(e,t){for(var r=0;r<t.length;r++){var n=t[r][0](e);if(n)return[n,t[r][1]];}return[null,void 0];},x=function x(e){return"string"==typeof e?N(e.trim(),y.string):"object"==_typeof2(e)&&null!==e?N(e,y.object):[null,void 0];},I=function I(e){return x(e)[1];},M=function M(t,r){var n=c(t);return{h:n.h,s:e(n.s+100*r,0,100),l:n.l,a:n.a};},H=function H(e){return(299*e.r+587*e.g+114*e.b)/1e3/255;},$=function $(t,r){var n=c(t);return{h:n.h,s:n.s,l:e(n.l+100*r,0,100),a:n.a};},j=function(){function e(e){this.parsed=x(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1};}return e.prototype.isValid=function(){return null!==this.parsed;},e.prototype.brightness=function(){return n(H(this.rgba),2);},e.prototype.isDark=function(){return H(this.rgba)<.5;},e.prototype.isLight=function(){return H(this.rgba)>=.5;},e.prototype.toHex=function(){return t=(e=o(this.rgba)).r,r=e.g,i=e.b,u=(a=e.a)<1?s(n(255*a)):"","#"+s(t)+s(r)+s(i)+u;var e,t,r,i,a,u;},e.prototype.toRgb=function(){return o(this.rgba);},e.prototype.toRgbString=function(){return t=(e=o(this.rgba)).r,r=e.g,n=e.b,(i=e.a)<1?"rgba("+t+", "+r+", "+n+", "+i+")":"rgb("+t+", "+r+", "+n+")";var e,t,r,n,i;},e.prototype.toHsl=function(){return d(c(this.rgba));},e.prototype.toHslString=function(){return t=(e=d(c(this.rgba))).h,r=e.s,n=e.l,(i=e.a)<1?"hsla("+t+", "+r+"%, "+n+"%, "+i+")":"hsl("+t+", "+r+"%, "+n+"%)";var e,t,r,n,i;},e.prototype.toHsv=function(){return e=h(this.rgba),{h:n(e.h),s:n(e.s),v:n(e.v),a:n(e.a,3)};var e;},e.prototype.invert=function(){return w({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e;},e.prototype.saturate=function(e){return void 0===e&&(e=.1),w(M(this.rgba,e));},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),w(M(this.rgba,-e));},e.prototype.grayscale=function(){return w(M(this.rgba,-1));},e.prototype.lighten=function(e){return void 0===e&&(e=.1),w($(this.rgba,e));},e.prototype.darken=function(e){return void 0===e&&(e=.1),w($(this.rgba,-e));},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e);},e.prototype.alpha=function(e){return"number"==typeof e?w({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):n(this.rgba.a,3);var t;},e.prototype.hue=function(e){var t=c(this.rgba);return"number"==typeof e?w({h:e,s:t.s,l:t.l,a:t.a}):n(t.h);},e.prototype.isEqual=function(e){return this.toHex()===w(e).toHex();},e;}(),w=function w(e){return e instanceof j?e:new j(e);},S=[],k=function k(e){e.forEach(function(e){S.indexOf(e)<0&&(e(j,y),S.push(e));});},E=function E(){return new j({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()});};function names(e,t){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var i in r)n[r[i]]=i;var o={};e.prototype.toName=function(t){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var i,a,s=n[this.toHex()];if(s)return s;if(null==t?void 0:t.closest){var u=this.toRgb(),l=1/0,c="black";if(!o.length)for(var h in r)o[h]=new e(r[h]).toRgb();for(var f in r){var d=(i=u,a=o[f],Math.pow(i.r-a.r,2)+Math.pow(i.g-a.g,2)+Math.pow(i.b-a.b,2));d<l&&(l=d,c=f);}return c;}},t.string.push([function(t){var n=t.toLowerCase(),i="transparent"===n?"#0000":r[n];return i?new e(i).toRgb():null;},"name"]);}k([names]);var _Color=/*#__PURE__*/function(){function e(){var _e233=arguments.length>0&&arguments[0]!==undefined?arguments[0]:16777215;_classCallCheck2(this,e);this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=_e233;}return _createClass2(e,[{key:"red",get:function get(){return this._components[0];}},{key:"green",get:function get(){return this._components[1];}},{key:"blue",get:function get(){return this._components[2];}},{key:"alpha",get:function get(){return this._components[3];}},{key:"setValue",value:function setValue(_e234){return this.value=_e234,this;}},{key:"value",get:function get(){return this._value;},set:function set(t){if(t instanceof e)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(null===t)throw new Error("Cannot set PIXI.Color#value to null");(null===this._value||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t));}}},{key:"cloneSource",value:function cloneSource(_e235){return"string"==typeof _e235||"number"==typeof _e235||_e235 instanceof Number||null===_e235?_e235:Array.isArray(_e235)||ArrayBuffer.isView(_e235)?_e235.slice(0):"object"==_typeof2(_e235)&&null!==_e235?_objectSpread({},_e235):_e235;}},{key:"isSourceEqual",value:function isSourceEqual(_e236,t){var r=_typeof2(_e236);if(r!==_typeof2(t))return!1;if("number"===r||"string"===r||_e236 instanceof Number)return _e236===t;if(Array.isArray(_e236)&&Array.isArray(t)||ArrayBuffer.isView(_e236)&&ArrayBuffer.isView(t))return _e236.length===t.length&&_e236.every(function(_e237,r){return _e237===t[r];});if(null!==_e236&&null!==t){var _r174=Object.keys(_e236),_n84=Object.keys(t);return _r174.length===_n84.length&&_r174.every(function(r){return _e236[r]===t[r];});}return _e236===t;}},{key:"toRgba",value:function toRgba(){var _this$_components=_slicedToArray2(this._components,4),_e238=_this$_components[0],t=_this$_components[1],r=_this$_components[2],n=_this$_components[3];return{r:_e238,g:t,b:r,a:n};}},{key:"toRgb",value:function toRgb(){var _this$_components2=_slicedToArray2(this._components,3),_e239=_this$_components2[0],t=_this$_components2[1],r=_this$_components2[2];return{r:_e239,g:t,b:r};}},{key:"toRgbaString",value:function toRgbaString(){var _this$toUint8RgbArray=this.toUint8RgbArray(),_this$toUint8RgbArray2=_slicedToArray2(_this$toUint8RgbArray,3),_e240=_this$toUint8RgbArray2[0],t=_this$toUint8RgbArray2[1],r=_this$toUint8RgbArray2[2];return"rgba(".concat(_e240,",").concat(t,",").concat(r,",").concat(this.alpha,")");}},{key:"toUint8RgbArray",value:function toUint8RgbArray(_e241){var _e253;var _this$_components3=_slicedToArray2(this._components,3),t=_this$_components3[0],r=_this$_components3[1],n=_this$_components3[2];return(_e241=(_e253=_e241)!==null&&_e253!==void 0?_e253:[])[0]=Math.round(255*t),_e241[1]=Math.round(255*r),_e241[2]=Math.round(255*n),_e241;}},{key:"toRgbArray",value:function toRgbArray(_e242){var _e254;_e242=(_e254=_e242)!==null&&_e254!==void 0?_e254:[];var _this$_components4=_slicedToArray2(this._components,3),t=_this$_components4[0],r=_this$_components4[1],n=_this$_components4[2];return _e242[0]=t,_e242[1]=r,_e242[2]=n,_e242;}},{key:"toNumber",value:function toNumber(){return this._int;}},{key:"toLittleEndianNumber",value:function toLittleEndianNumber(){var _e243=this._int;return(_e243>>16)+(65280&_e243)+((255&_e243)<<16);}},{key:"multiply",value:function multiply(t){var _e$temp$setValue$_com=_slicedToArray2(e.temp.setValue(t)._components,4),r=_e$temp$setValue$_com[0],n=_e$temp$setValue$_com[1],i=_e$temp$setValue$_com[2],o=_e$temp$setValue$_com[3];return this._components[0]*=r,this._components[1]*=n,this._components[2]*=i,this._components[3]*=o,this.refreshInt(),this._value=null,this;}},{key:"premultiply",value:function premultiply(_e244){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;return t&&(this._components[0]*=_e244,this._components[1]*=_e244,this._components[2]*=_e244),this._components[3]=_e244,this.refreshInt(),this._value=null,this;}},{key:"toPremultiplied",value:function toPremultiplied(_e245){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;if(1===_e245)return(255<<24)+this._int;if(0===_e245)return t?0:this._int;var r=this._int>>16&255,n=this._int>>8&255,i=255&this._int;return t&&(r=r*_e245+.5|0,n=n*_e245+.5|0,i=i*_e245+.5|0),(255*_e245<<24)+(r<<16)+(n<<8)+i;}},{key:"toHex",value:function toHex(){var _e246=this._int.toString(16);return"#".concat("000000".substring(0,6-_e246.length)+_e246);}},{key:"toHexa",value:function toHexa(){var _e247=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-_e247.length)+_e247;}},{key:"setAlpha",value:function setAlpha(_e248){return this._components[3]=this._clamp(_e248),this;}},{key:"round",value:function round(_e249){var _this$_components5=_slicedToArray2(this._components,3),t=_this$_components5[0],r=_this$_components5[1],n=_this$_components5[2];return this._components[0]=Math.round(t*_e249)/_e249,this._components[1]=Math.round(r*_e249)/_e249,this._components[2]=Math.round(n*_e249)/_e249,this.refreshInt(),this._value=null,this;}},{key:"toArray",value:function toArray(_e250){var _e255;_e250=(_e255=_e250)!==null&&_e255!==void 0?_e255:[];var _this$_components6=_slicedToArray2(this._components,4),t=_this$_components6[0],r=_this$_components6[1],n=_this$_components6[2],i=_this$_components6[3];return _e250[0]=t,_e250[1]=r,_e250[2]=n,_e250[3]=i,_e250;}},{key:"normalize",value:function normalize(t){var _t136,_t137,_t137$,_t138,_t139,_t139$;var r,n,i,o;if(("number"==typeof t||t instanceof Number)&&t>=0&&t<=16777215){r=(t>>16&255)/255,n=(t>>8&255)/255,i=(255&t)/255,o=1;}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),_t136=t,_t137=_slicedToArray2(_t136,4),r=_t137[0],n=_t137[1],i=_t137[2],_t137$=_t137[3],o=_t137$===void 0?1:_t137$;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),_t138=t,_t139=_slicedToArray2(_t138,4),r=_t139[0],n=_t139[1],i=_t139[2],_t139$=_t139[3],o=_t139$===void 0?255:_t139$,r/=255,n/=255,i/=255,o/=255;else if("string"==typeof t||"object"==_typeof2(t)){var _a28$rgba;if("string"==typeof t){var _r175=e.HEX_PATTERN.exec(t);_r175&&(t="#".concat(_r175[2]));}var _a28=w(t);_a28.isValid()&&(_a28$rgba=_a28.rgba,r=_a28$rgba.r,n=_a28$rgba.g,i=_a28$rgba.b,o=_a28$rgba.a,r/=255,n/=255,i/=255);}if(void 0===r)throw new Error("Unable to convert color ".concat(t));this._components[0]=r,this._components[1]=n,this._components[2]=i,this._components[3]=o,this.refreshInt();}},{key:"refreshInt",value:function refreshInt(){this._clamp(this._components);var _this$_components7=_slicedToArray2(this._components,3),_e251=_this$_components7[0],t=_this$_components7[1],r=_this$_components7[2];this._int=(255*_e251<<16)+(255*t<<8)+(255*r|0);}},{key:"_clamp",value:function _clamp(_e252){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;return"number"==typeof _e252?Math.min(Math.max(_e252,t),r):(_e252.forEach(function(n,i){_e252[i]=Math.min(Math.max(n,t),r);}),_e252);}}]);}();_Color.shared=new _Color(),_Color.temp=new _Color(),_Color.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;var _Color2=_Color;function _hex2rgb(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return _deprecation("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),_Color2.shared.setValue(e).toRgbArray(t);}function _hex2string(e){return _deprecation("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),_Color2.shared.setValue(e).toHex();}function _string2hex(e){return _deprecation("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),_Color2.shared.setValue(e).toNumber();}function _rgb2hex(e){return _deprecation("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),_Color2.shared.setValue(e).toNumber();}function mapPremultipliedBlendModes(){var e=[],t=[];for(var _r176=0;_r176<32;_r176++)e[_r176]=_r176,t[_r176]=_r176;e[_BLEND_MODES.NORMAL_NPM]=_BLEND_MODES.NORMAL,e[_BLEND_MODES.ADD_NPM]=_BLEND_MODES.ADD,e[_BLEND_MODES.SCREEN_NPM]=_BLEND_MODES.SCREEN,t[_BLEND_MODES.NORMAL]=_BLEND_MODES.NORMAL_NPM,t[_BLEND_MODES.ADD]=_BLEND_MODES.ADD_NPM,t[_BLEND_MODES.SCREEN]=_BLEND_MODES.SCREEN_NPM;var r=[];return r.push(t),r.push(e),r;}var _premultiplyBlendMode=mapPremultipliedBlendModes();function _correctBlendMode(e,t){return _premultiplyBlendMode[t?1:0][e];}function _premultiplyRgba(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!0;return _deprecation("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),_Color2.shared.setValue(e).premultiply(t,n).toArray(r!==null&&r!==void 0?r:new Float32Array(4));}function _premultiplyTint(e,t){return _deprecation("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),_Color2.shared.setValue(e).toPremultiplied(t);}function _premultiplyTintToRgba(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!0;return _deprecation("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),_Color2.shared.setValue(e).premultiply(t,n).toArray(r!==null&&r!==void 0?r:new Float32Array(4));}var _DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function _createIndicesForQuads(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var r=6*e;if((t=t||new Uint16Array(r)).length!==r)throw new Error("Out buffer length is incorrect, got ".concat(t.length," and expected ").concat(r));for(var _e256=0,_n85=0;_e256<r;_e256+=6,_n85+=4)t[_e256+0]=_n85+0,t[_e256+1]=_n85+1,t[_e256+2]=_n85+2,t[_e256+3]=_n85+0,t[_e256+4]=_n85+2,t[_e256+5]=_n85+3;return t;}function _getBufferType(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array";}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null;}var map={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function _interleaveTypedArrays(e,t){var r=0,n=0;var i={};for(var _i68=0;_i68<e.length;_i68++)n+=t[_i68],r+=e[_i68].length;var o=new ArrayBuffer(4*r);var a=null,s=0;for(var _r177=0;_r177<e.length;_r177++){var _u19=t[_r177],_l14=e[_r177],_c14=_getBufferType(_l14);i[_c14]||(i[_c14]=new map[_c14](o)),a=i[_c14];for(var _e257=0;_e257<_l14.length;_e257++){a[(_e257/_u19|0)*n+s+_e257%_u19]=_l14[_e257];}s+=_u19;}return new Float32Array(o);}function _nextPow(e){return e+=0===e?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1;}function _isPow(e){return!(e&e-1||!e);}function _log(e){var t=(e>65535?1:0)<<4,r=((e>>>=t)>255?1:0)<<3;return t|=r,r=((e>>>=r)>15?1:0)<<2,t|=r,r=((e>>>=r)>3?1:0)<<1,t|=r,t|(e>>>=r)>>1;}function _removeItems(e,t,r){var n=e.length;var i;if(t>=n||0===r)return;var o=n-(r=t+r>n?n-t:r);for(i=t;i<o;++i)e[i]=e[i+r];e.length=o;}function _sign(e){return 0===e?0:e<0?-1:1;}var nextUid=0;function _uid(){return++nextUid;}var _BoundingBox=/*#__PURE__*/function(){function _BoundingBox(e,t,r,n){_classCallCheck2(this,_BoundingBox);this.left=e,this.top=t,this.right=r,this.bottom=n;}return _createClass2(_BoundingBox,[{key:"width",get:function get(){return this.right-this.left;}},{key:"height",get:function get(){return this.bottom-this.top;}},{key:"isEmpty",value:function isEmpty(){return this.left===this.right||this.top===this.bottom;}}]);}();_BoundingBox.EMPTY=new _BoundingBox(0,0,0,0);var _BoundingBox2=_BoundingBox;var _ProgramCache={},_TextureCache=Object.create(null),_BaseTextureCache=Object.create(null);function _destroyTextureCache(){var e;for(e in _TextureCache)_TextureCache[e].destroy();for(e in _BaseTextureCache)_BaseTextureCache[e].destroy();}function _clearTextureCache(){var e;for(e in _TextureCache)delete _TextureCache[e];for(e in _BaseTextureCache)delete _BaseTextureCache[e];}var _CanvasRenderTarget=/*#__PURE__*/function(){function _CanvasRenderTarget(e,t,r){_classCallCheck2(this,_CanvasRenderTarget);this._canvas=_settings.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=r||_settings.RESOLUTION,this.resize(e,t);}return _createClass2(_CanvasRenderTarget,[{key:"clear",value:function clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height);}},{key:"resize",value:function resize(e,t){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(t*this.resolution);}},{key:"destroy",value:function destroy(){this._context=null,this._canvas=null;}},{key:"width",get:function get(){return this._checkDestroyed(),this._canvas.width;},set:function set(e){this._checkDestroyed(),this._canvas.width=Math.round(e);}},{key:"height",get:function get(){return this._checkDestroyed(),this._canvas.height;},set:function set(e){this._checkDestroyed(),this._canvas.height=Math.round(e);}},{key:"canvas",get:function get(){return this._checkDestroyed(),this._canvas;}},{key:"context",get:function get(){return this._checkDestroyed(),this._context;}},{key:"_checkDestroyed",value:function _checkDestroyed(){if(null===this._canvas)throw new TypeError("The CanvasRenderTarget has already been destroyed");}}]);}();function checkRow(e,t,r){for(var _n86=0,_i69=4*r*t;_n86<t;++_n86,_i69+=4)if(0!==e[_i69+3])return!1;return!0;}function checkColumn(e,t,r,n,i){var o=4*t;for(var _t140=n,_a29=n*o+4*r;_t140<=i;++_t140,_a29+=o)if(0!==e[_a29+3])return!1;return!0;}function _getCanvasBoundingBox(e){var t=e.width,r=e.height,n=e.getContext("2d",{willReadFrequently:!0});if(null===n)throw new TypeError("Failed to get canvas 2D context");var i=n.getImageData(0,0,t,r).data;var o=0,a=0,s=t-1,u=r-1;for(;a<r&&checkRow(i,t,a);)++a;if(a===r)return _BoundingBox2.EMPTY;for(;checkRow(i,t,u);)--u;for(;checkColumn(i,t,o,a,u);)++o;for(;checkColumn(i,t,s,a,u);)--s;return++s,++u,new _BoundingBox2(o,a,s,u);}function _trimCanvas(e){var t=_getCanvasBoundingBox(e),r=t.width,n=t.height;var i=null;if(!t.isEmpty()){var _o47=e.getContext("2d");if(null===_o47)throw new TypeError("Failed to get canvas 2D context");i=_o47.getImageData(t.left,t.top,r,n);}return{width:r,height:n,data:i};}function _decomposeDataUri(e){var t=_DATA_URI.exec(e);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]};}function _determineCrossOrigin(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:globalThis.location;if(e.startsWith("data:"))return"";t=t||globalThis.location;var r=new URL(e,document.baseURI);return r.hostname!==t.hostname||r.port!==t.port||r.protocol!==t.protocol?"anonymous":"";}function _getResolutionOfUrl(e){var _settings$RETINA_PREF;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var r=(_settings$RETINA_PREF=_settings.RETINA_PREFIX)===null||_settings$RETINA_PREF===void 0?void 0:_settings$RETINA_PREF.exec(e);return r?parseFloat(r[1]):t;}var _ExtensionType=function(e){return e.Renderer="renderer",e.Application="application",e.RendererSystem="renderer-webgl-system",e.RendererPlugin="renderer-webgl-plugin",e.CanvasRendererSystem="renderer-canvas-system",e.CanvasRendererPlugin="renderer-canvas-plugin",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e;}(_ExtensionType||{});var normalizeExtension=function normalizeExtension(e){if("function"==typeof e||"object"==_typeof2(e)&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e=_objectSpread(_objectSpread({},"object"!=_typeof2(e.extension)?{type:e.extension}:e.extension),{},{ref:e});}if("object"!=_typeof2(e))throw new Error("Invalid extension type");return"string"==typeof(e=_objectSpread({},e)).type&&(e.type=[e.type]),e;},normalizePriority=function normalizePriority(e,t){var _normalizeExtension$p;return(_normalizeExtension$p=normalizeExtension(e).priority)!==null&&_normalizeExtension$p!==void 0?_normalizeExtension$p:t;},_extensions={_addHandlers:{},_removeHandlers:{},_queue:{},remove:function remove(){var _this34=this;for(var _len3=arguments.length,e=new Array(_len3),_key3=0;_key3<_len3;_key3++){e[_key3]=arguments[_key3];}return e.map(normalizeExtension).forEach(function(e){e.type.forEach(function(t){var _this34$_removeHandle,_this34$_removeHandle2;return(_this34$_removeHandle=(_this34$_removeHandle2=_this34._removeHandlers)[t])===null||_this34$_removeHandle===void 0?void 0:_this34$_removeHandle.call(_this34$_removeHandle2,e);});}),this;},add:function add(){var _this35=this;for(var _len4=arguments.length,e=new Array(_len4),_key4=0;_key4<_len4;_key4++){e[_key4]=arguments[_key4];}return e.map(normalizeExtension).forEach(function(e){e.type.forEach(function(t){var _r$t,_n$t;var r=_this35._addHandlers,n=_this35._queue;r[t]?(_r$t=r[t])===null||_r$t===void 0?void 0:_r$t.call(r,e):(n[t]=n[t]||[],(_n$t=n[t])===null||_n$t===void 0?void 0:_n$t.push(e));});}),this;},handle:function handle(e,t,r){var _o$e;var n=this._addHandlers,i=this._removeHandlers;if(n[e]||i[e])throw new Error("Extension type ".concat(e," already has a handler"));n[e]=t,i[e]=r;var o=this._queue;return o[e]&&((_o$e=o[e])!==null&&_o$e!==void 0&&_o$e.forEach(function(e){return t(e);}),delete o[e]),this;},handleByMap:function handleByMap(e,t){return this.handle(e,function(e){e.name&&(t[e.name]=e.ref);},function(e){e.name&&delete t[e.name];});},handleByList:function handleByList(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:-1;return this.handle(e,function(e){t.includes(e.ref)||(t.push(e.ref),t.sort(function(e,t){return normalizePriority(t,r)-normalizePriority(e,r);}));},function(e){var r=t.indexOf(e.ref);-1!==r&&t.splice(r,1);});}};var _ViewableBuffer=/*#__PURE__*/function(){function _ViewableBuffer(e){_classCallCheck2(this,_ViewableBuffer);"number"==typeof e?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData);}return _createClass2(_ViewableBuffer,[{key:"int8View",get:function get(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View;}},{key:"uint8View",get:function get(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View;}},{key:"int16View",get:function get(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View;}},{key:"uint16View",get:function get(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View;}},{key:"int32View",get:function get(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View;}},{key:"view",value:function view(e){return this["".concat(e,"View")];}},{key:"destroy",value:function destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null;}}],[{key:"sizeOf",value:function sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error("".concat(e," isn't a valid view type"));}}}]);}();var fragTemplate=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function generateIfTestSrc(e){var t="";for(var r=0;r<e;++r)r>0&&(t+="\nelse "),r<e-1&&(t+="if(test == ".concat(r,".0){}"));return t;}function _checkMaxIfStatementsInShader(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");var r=t.createShader(t.FRAGMENT_SHADER);for(;;){var _n87=fragTemplate.replace(/%forloop%/gi,generateIfTestSrc(e));if(t.shaderSource(r,_n87),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))break;e=e/2|0;}return e;}var BLEND=0,OFFSET=1,CULLING=2,DEPTH_TEST=3,WINDING=4,DEPTH_MASK=5;var _State=/*#__PURE__*/function(){function _State(){_classCallCheck2(this,_State);this.data=0,this.blendMode=_BLEND_MODES.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0;}return _createClass2(_State,[{key:"blend",get:function get(){return!!(this.data&1<<BLEND);},set:function set(e){!!(this.data&1<<BLEND)!==e&&(this.data^=1<<BLEND);}},{key:"offsets",get:function get(){return!!(this.data&1<<OFFSET);},set:function set(e){!!(this.data&1<<OFFSET)!==e&&(this.data^=1<<OFFSET);}},{key:"culling",get:function get(){return!!(this.data&1<<CULLING);},set:function set(e){!!(this.data&1<<CULLING)!==e&&(this.data^=1<<CULLING);}},{key:"depthTest",get:function get(){return!!(this.data&1<<DEPTH_TEST);},set:function set(e){!!(this.data&1<<DEPTH_TEST)!==e&&(this.data^=1<<DEPTH_TEST);}},{key:"depthMask",get:function get(){return!!(this.data&1<<DEPTH_MASK);},set:function set(e){!!(this.data&1<<DEPTH_MASK)!==e&&(this.data^=1<<DEPTH_MASK);}},{key:"clockwiseFrontFace",get:function get(){return!!(this.data&1<<WINDING);},set:function set(e){!!(this.data&1<<WINDING)!==e&&(this.data^=1<<WINDING);}},{key:"blendMode",get:function get(){return this._blendMode;},set:function set(e){this.blend=e!==_BLEND_MODES.NONE,this._blendMode=e;}},{key:"polygonOffset",get:function get(){return this._polygonOffset;},set:function set(e){this.offsets=!!e,this._polygonOffset=e;}}],[{key:"for2d",value:function for2d(){var e=new _State();return e.depthTest=!1,e.blend=!0,e;}}]);}();_State.prototype.toString=function(){return"[@pixi/core:State blendMode=".concat(this.blendMode," clockwiseFrontFace=").concat(this.clockwiseFrontFace," culling=").concat(this.culling," depthMask=").concat(this.depthMask," polygonOffset=").concat(this.polygonOffset,"]");};var _INSTALLED=[];function _autoDetectResource(e,t){if(!e)return null;var r="";if("string"==typeof e){var _t141=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);_t141&&(r=_t141[1].toLowerCase());}for(var _n88=_INSTALLED.length-1;_n88>=0;--_n88){var _i70=_INSTALLED[_n88];if(_i70.test&&_i70.test(e,r))return new _i70(e,t);}throw new Error("Unrecognized source type to auto-detect Resource");}var _Runner=/*#__PURE__*/function(){function _Runner(e){_classCallCheck2(this,_Runner);this.items=[],this._name=e,this._aliasCount=0;}return _createClass2(_Runner,[{key:"emit",value:function emit(e,t,r,n,i,o,a,s){if(arguments.length>8)throw new Error("max arguments reached");var u=this.name,l=this.items;this._aliasCount++;for(var _c15=0,_h11=l.length;_c15<_h11;_c15++)l[_c15][u](e,t,r,n,i,o,a,s);return l===this.items&&this._aliasCount--,this;}},{key:"ensureNonAliasedItems",value:function ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0));}},{key:"add",value:function add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this;}},{key:"remove",value:function remove(e){var t=this.items.indexOf(e);return-1!==t&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this;}},{key:"contains",value:function contains(e){return this.items.includes(e);}},{key:"removeAll",value:function removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this;}},{key:"destroy",value:function destroy(){this.removeAll(),this.items.length=0,this._name="";}},{key:"empty",get:function get(){return 0===this.items.length;}},{key:"name",get:function get(){return this._name;}}]);}();Object.defineProperties(_Runner.prototype,{dispatch:{value:_Runner.prototype.emit},run:{value:_Runner.prototype.emit}});var _Resource=/*#__PURE__*/function(){function _Resource(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;_classCallCheck2(this,_Resource);this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new _Runner("setRealSize"),this.onUpdate=new _Runner("update"),this.onError=new _Runner("onError");}return _createClass2(_Resource,[{key:"bind",value:function bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height);}},{key:"unbind",value:function unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e);}},{key:"resize",value:function resize(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t));}},{key:"valid",get:function get(){return!!this._width&&!!this._height;}},{key:"update",value:function update(){this.destroyed||this.onUpdate.emit();}},{key:"load",value:function load(){return Promise.resolve(this);}},{key:"width",get:function get(){return this._width;}},{key:"height",get:function get(){return this._height;}},{key:"style",value:function style(e,t,r){return!1;}},{key:"dispose",value:function dispose(){}},{key:"destroy",value:function destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null);}}],[{key:"test",value:function test(e,t){return!1;}}]);}();var _BufferResource=/*#__PURE__*/function(_Resource2){function _BufferResource(e,t){var _t$unpackAlignment;var _this36;_classCallCheck2(this,_BufferResource);var _ref33=t||{},r=_ref33.width,n=_ref33.height;if(!r||!n)throw new Error("BufferResource width or height invalid");_this36=_callSuper2(this,_BufferResource,[r,n]),_this36.data=e,_this36.unpackAlignment=(_t$unpackAlignment=t.unpackAlignment)!==null&&_t$unpackAlignment!==void 0?_t$unpackAlignment:4;return _this36;}_inherits2(_BufferResource,_Resource2);return _createClass2(_BufferResource,[{key:"upload",value:function upload(e,t,r){var n=e.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,this.unpackAlignment),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===_ALPHA_MODES.UNPACK);var i=t.realWidth,o=t.realHeight;return r.width===i&&r.height===o?n.texSubImage2D(t.target,0,0,0,i,o,t.format,r.type,this.data):(r.width=i,r.height=o,n.texImage2D(t.target,0,r.internalFormat,i,o,0,t.format,r.type,this.data)),!0;}},{key:"dispose",value:function dispose(){this.data=null;}}],[{key:"test",value:function test(e){return null===e||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array;}}]);}(_Resource);var defaultBufferOptions={scaleMode:_SCALE_MODES.NEAREST,alphaMode:_ALPHA_MODES.NPM},_BaseTexture=/*#__PURE__*/function(_utils_node_modules_e){function e(){var _this37;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;_classCallCheck2(this,e);_this37=_callSuper2(this,e),r=Object.assign({},e.defaultOptions,r);var _r178=r,n=_r178.alphaMode,i=_r178.mipmap,o=_r178.anisotropicLevel,a=_r178.scaleMode,s=_r178.width,u=_r178.height,l=_r178.wrapMode,c=_r178.format,h=_r178.type,f=_r178.target,d=_r178.resolution,p=_r178.resourceOptions;t&&!(t instanceof _Resource)&&((t=_autoDetectResource(t,p)).internal=!0),_this37.resolution=d||_settings.RESOLUTION,_this37.width=Math.round((s||0)*_this37.resolution)/_this37.resolution,_this37.height=Math.round((u||0)*_this37.resolution)/_this37.resolution,_this37._mipmap=i,_this37.anisotropicLevel=o,_this37._wrapMode=l,_this37._scaleMode=a,_this37.format=c,_this37.type=h,_this37.target=f,_this37.alphaMode=n,_this37.uid=_uid(),_this37.touched=0,_this37.isPowerOfTwo=!1,_this37._refreshPOT(),_this37._glTextures={},_this37.dirtyId=0,_this37.dirtyStyleId=0,_this37.cacheId=null,_this37.valid=s>0&&u>0,_this37.textureCacheIds=[],_this37.destroyed=!1,_this37.resource=null,_this37._batchEnabled=0,_this37._batchLocation=0,_this37.parentTextureArray=null,_this37.setResource(t);return _this37;}_inherits2(e,_utils_node_modules_e);return _createClass2(e,[{key:"realWidth",get:function get(){return Math.round(this.width*this.resolution);}},{key:"realHeight",get:function get(){return Math.round(this.height*this.resolution);}},{key:"mipmap",get:function get(){return this._mipmap;},set:function set(_e258){this._mipmap!==_e258&&(this._mipmap=_e258,this.dirtyStyleId++);}},{key:"scaleMode",get:function get(){return this._scaleMode;},set:function set(_e259){this._scaleMode!==_e259&&(this._scaleMode=_e259,this.dirtyStyleId++);}},{key:"wrapMode",get:function get(){return this._wrapMode;},set:function set(_e260){this._wrapMode!==_e260&&(this._wrapMode=_e260,this.dirtyStyleId++);}},{key:"setStyle",value:function setStyle(_e261,t){var r;return void 0!==_e261&&_e261!==this.scaleMode&&(this.scaleMode=_e261,r=!0),void 0!==t&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this;}},{key:"setSize",value:function setSize(_e262,t,r){return r=r||this.resolution,this.setRealSize(_e262*r,t*r,r);}},{key:"setRealSize",value:function setRealSize(_e263,t,r){return this.resolution=r||this.resolution,this.width=Math.round(_e263)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this;}},{key:"_refreshPOT",value:function _refreshPOT(){this.isPowerOfTwo=_isPow(this.realWidth)&&_isPow(this.realHeight);}},{key:"setResolution",value:function setResolution(_e264){var t=this.resolution;return t===_e264||(this.resolution=_e264,this.valid&&(this.width=Math.round(this.width*t)/_e264,this.height=Math.round(this.height*t)/_e264,this.emit("update",this)),this._refreshPOT()),this;}},{key:"setResource",value:function setResource(_e265){if(this.resource===_e265)return this;if(this.resource)throw new Error("Resource can be set only once");return _e265.bind(this),this.resource=_e265,this;}},{key:"update",value:function update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this));}},{key:"onError",value:function onError(_e266){this.emit("error",this,_e266);}},{key:"destroy",value:function destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete _BaseTextureCache[this.cacheId],delete _TextureCache[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners();}},{key:"dispose",value:function dispose(){this.emit("dispose",this);}},{key:"castToBaseTexture",value:function castToBaseTexture(){return this;}}],[{key:"from",value:function from(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:_settings.STRICT_TEXTURE_CACHE;var i="string"==typeof t;var o=null;if(i)o=t;else{if(!t._pixiId){var _e267=(r===null||r===void 0?void 0:r.pixiIdPrefix)||"pixiid";t._pixiId="".concat(_e267,"_").concat(_uid());}o=t._pixiId;}var a=_BaseTextureCache[o];if(i&&n&&!a)throw new Error("The cacheId \"".concat(o,"\" does not exist in BaseTextureCache."));return a||(a=new e(t,r),a.cacheId=o,e.addToCache(a,o)),a;}},{key:"fromBuffer",value:function fromBuffer(t,r,n,i){t=t||new Float32Array(r*n*4);var o=new _BufferResource(t,_objectSpread({width:r,height:n},i===null||i===void 0?void 0:i.resourceOptions));var a,s;return t instanceof Float32Array?(a=_FORMATS.RGBA,s=_TYPES.FLOAT):t instanceof Int32Array?(a=_FORMATS.RGBA_INTEGER,s=_TYPES.INT):t instanceof Uint32Array?(a=_FORMATS.RGBA_INTEGER,s=_TYPES.UNSIGNED_INT):t instanceof Int16Array?(a=_FORMATS.RGBA_INTEGER,s=_TYPES.SHORT):t instanceof Uint16Array?(a=_FORMATS.RGBA_INTEGER,s=_TYPES.UNSIGNED_SHORT):t instanceof Int8Array?(a=_FORMATS.RGBA,s=_TYPES.BYTE):(a=_FORMATS.RGBA,s=_TYPES.UNSIGNED_BYTE),o.internal=!0,new e(o,Object.assign({},defaultBufferOptions,{type:s,format:a},i));}},{key:"addToCache",value:function addToCache(_e268,t){t&&(_e268.textureCacheIds.includes(t)||_e268.textureCacheIds.push(t),_BaseTextureCache[t]&&_BaseTextureCache[t]!==_e268&&console.warn("BaseTexture added to the cache with an id [".concat(t,"] that already had an entry")),_BaseTextureCache[t]=_e268);}},{key:"removeFromCache",value:function removeFromCache(_e269){if("string"==typeof _e269){var _t142=_BaseTextureCache[_e269];if(_t142){var r=_t142.textureCacheIds.indexOf(_e269);return r>-1&&_t142.textureCacheIds.splice(r,1),delete _BaseTextureCache[_e269],_t142;}}else if(_e269!==null&&_e269!==void 0&&_e269.textureCacheIds){for(var _t143=0;_t143<_e269.textureCacheIds.length;++_t143)delete _BaseTextureCache[_e269.textureCacheIds[_t143]];return _e269.textureCacheIds.length=0,_e269;}return null;}}]);}(utils_node_modules_eventemitter3);_BaseTexture.defaultOptions={mipmap:_MIPMAP_MODES.POW2,anisotropicLevel:0,scaleMode:_SCALE_MODES.LINEAR,wrapMode:_WRAP_MODES.CLAMP,alphaMode:_ALPHA_MODES.UNPACK,target:_TARGETS.TEXTURE_2D,format:_FORMATS.RGBA,type:_TYPES.UNSIGNED_BYTE},_BaseTexture._globalBatch=0;var _BaseTexture2=_BaseTexture;var _BatchDrawCall=/*#__PURE__*/_createClass2(function _BatchDrawCall(){_classCallCheck2(this,_BatchDrawCall);this.texArray=null,this.blend=0,this.type=_DRAW_MODES.TRIANGLES,this.start=0,this.size=0,this.data=null;});var UID=0;var _Buffer=/*#__PURE__*/function(){function _Buffer(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;_classCallCheck2(this,_Buffer);this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this["static"]=t,this.id=UID++,this.disposeRunner=new _Runner("disposeBuffer");}return _createClass2(_Buffer,[{key:"update",value:function update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++;}},{key:"dispose",value:function dispose(){this.disposeRunner.emit(this,!1);}},{key:"destroy",value:function destroy(){this.dispose(),this.data=null;}},{key:"index",get:function get(){return this.type===_BUFFER_TYPE.ELEMENT_ARRAY_BUFFER;},set:function set(e){this.type=e?_BUFFER_TYPE.ELEMENT_ARRAY_BUFFER:_BUFFER_TYPE.ARRAY_BUFFER;}}],[{key:"from",value:function from(e){return e instanceof Array&&(e=new Float32Array(e)),new _Buffer(e);}}]);}();var _Attribute=/*#__PURE__*/function(){function _Attribute(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:_TYPES.FLOAT;var i=arguments.length>4?arguments[4]:undefined;var o=arguments.length>5?arguments[5]:undefined;var a=arguments.length>6?arguments[6]:undefined;var s=arguments.length>7&&arguments[7]!==undefined?arguments[7]:1;_classCallCheck2(this,_Attribute);this.buffer=e,this.size=t,this.normalized=r,this.type=n,this.stride=i,this.start=o,this.instance=a,this.divisor=s;}return _createClass2(_Attribute,[{key:"destroy",value:function destroy(){this.buffer=null;}}],[{key:"from",value:function from(e,t,r,n,i){return new _Attribute(e,t,r,n,i);}}]);}();var interleaveTypedArrays_map={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function interleaveTypedArrays_interleaveTypedArrays(e,t){var r=0,n=0;var i={};for(var _i71=0;_i71<e.length;_i71++)n+=t[_i71],r+=e[_i71].length;var o=new ArrayBuffer(4*r);var a=null,s=0;for(var _r179=0;_r179<e.length;_r179++){var _u20=t[_r179],_l15=e[_r179],_c16=_getBufferType(_l15);i[_c16]||(i[_c16]=new interleaveTypedArrays_map[_c16](o)),a=i[_c16];for(var _e270=0;_e270<_l15.length;_e270++){a[(_e270/_u20|0)*n+s+_e270%_u20]=_l15[_e270];}s+=_u20;}return new Float32Array(o);}var byteSizeMap={5126:4,5123:2,5121:1};var Geometry_UID=0;var Geometry_map={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};var _Geometry=/*#__PURE__*/function(){function _Geometry(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck2(this,_Geometry);this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=Geometry_UID++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new _Runner("disposeGeometry"),this.refCount=0;}return _createClass2(_Geometry,[{key:"addAttribute",value:function addAttribute(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1;var i=arguments.length>4?arguments[4]:undefined;var o=arguments.length>5?arguments[5]:undefined;var a=arguments.length>6?arguments[6]:undefined;var s=arguments.length>7&&arguments[7]!==undefined?arguments[7]:!1;if(!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof _Buffer||(t instanceof Array&&(t=new Float32Array(t)),t=new _Buffer(t));var u=e.split("|");if(u.length>1){for(var _e271=0;_e271<u.length;_e271++)this.addAttribute(u[_e271],t,r,n,i);return this;}var l=this.buffers.indexOf(t);return-1===l&&(this.buffers.push(t),l=this.buffers.length-1),this.attributes[e]=new _Attribute(l,r,n,i,o,a,s),this.instanced=this.instanced||s,this;}},{key:"getAttribute",value:function getAttribute(e){return this.attributes[e];}},{key:"getBuffer",value:function getBuffer(e){return this.buffers[this.getAttribute(e).buffer];}},{key:"addIndex",value:function addIndex(e){return e instanceof _Buffer||(e instanceof Array&&(e=new Uint16Array(e)),e=new _Buffer(e)),e.type=_BUFFER_TYPE.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this;}},{key:"getIndex",value:function getIndex(){return this.indexBuffer;}},{key:"interleave",value:function interleave(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var e=[],t=[],r=new _Buffer();var n;for(n in this.attributes){var _r180=this.attributes[n],_i72=this.buffers[_r180.buffer];e.push(_i72.data),t.push(_r180.size*byteSizeMap[_r180.type]/4),_r180.buffer=0;}for(r.data=interleaveTypedArrays_interleaveTypedArrays(e,t),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this;}},{key:"getSize",value:function getSize(){for(var _e272 in this.attributes){var _t144=this.attributes[_e272];return this.buffers[_t144.buffer].data.length/(_t144.stride/4||_t144.size);}return 0;}},{key:"dispose",value:function dispose(){this.disposeRunner.emit(this,!1);}},{key:"destroy",value:function destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null;}},{key:"clone",value:function clone(){var e=new _Geometry();for(var _t145=0;_t145<this.buffers.length;_t145++)e.buffers[_t145]=new _Buffer(this.buffers[_t145].data.slice(0));for(var _t146 in this.attributes){var r=this.attributes[_t146];e.attributes[_t146]=new _Attribute(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance);}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=_BUFFER_TYPE.ELEMENT_ARRAY_BUFFER),e;}}],[{key:"merge",value:function merge(e){var t=new _Geometry(),r=[],n=[],i=[];var o;for(var _t147=0;_t147<e.length;_t147++){o=e[_t147];for(var _e273=0;_e273<o.buffers.length;_e273++)n[_e273]=n[_e273]||0,n[_e273]+=o.buffers[_e273].data.length,i[_e273]=0;}for(var _e274=0;_e274<o.buffers.length;_e274++)r[_e274]=new Geometry_map[_getBufferType(o.buffers[_e274].data)](n[_e274]),t.buffers[_e274]=new _Buffer(r[_e274]);for(var _t148=0;_t148<e.length;_t148++){o=e[_t148];for(var _e275=0;_e275<o.buffers.length;_e275++)r[_e275].set(o.buffers[_e275].data,i[_e275]),i[_e275]+=o.buffers[_e275].data.length;}if(t.attributes=o.attributes,o.indexBuffer){t.indexBuffer=t.buffers[o.buffers.indexOf(o.indexBuffer)],t.indexBuffer.type=_BUFFER_TYPE.ELEMENT_ARRAY_BUFFER;var _r181=0,_n89=0,_i73=0,_a30=0;for(var _e276=0;_e276<o.buffers.length;_e276++)if(o.buffers[_e276]!==o.indexBuffer){_a30=_e276;break;}for(var _e277 in o.attributes){var _t149=o.attributes[_e277];(0|_t149.buffer)===_a30&&(_n89+=_t149.size*byteSizeMap[_t149.type]/4);}for(var _o48=0;_o48<e.length;_o48++){var _s25=e[_o48].indexBuffer.data;for(var _e278=0;_e278<_s25.length;_e278++)t.indexBuffer.data[_e278+_i73]+=_r181;_r181+=e[_o48].buffers[_a30].data.length/_n89,_i73+=_s25.length;}}return t;}}]);}();var _BatchGeometry=/*#__PURE__*/function(_Geometry2){function _BatchGeometry(){var _this38;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;_classCallCheck2(this,_BatchGeometry);_this38=_callSuper2(this,_BatchGeometry),_this38._buffer=new _Buffer(null,e,!1),_this38._indexBuffer=new _Buffer(null,e,!0),_this38.addAttribute("aVertexPosition",_this38._buffer,2,!1,_TYPES.FLOAT).addAttribute("aTextureCoord",_this38._buffer,2,!1,_TYPES.FLOAT).addAttribute("aColor",_this38._buffer,4,!0,_TYPES.UNSIGNED_BYTE).addAttribute("aTextureId",_this38._buffer,1,!0,_TYPES.FLOAT).addIndex(_this38._indexBuffer);return _this38;}_inherits2(_BatchGeometry,_Geometry2);return _createClass2(_BatchGeometry);}(_Geometry);var _PI_=2*Math.PI,_RAD_TO_DEG=180/Math.PI,_DEG_TO_RAD=Math.PI/180;var _SHAPES=function(e){return e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC",e;}(_SHAPES||{});var _Point=/*#__PURE__*/function(){function _Point(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;_classCallCheck2(this,_Point);this.x=0,this.y=0,this.x=e,this.y=t;}return _createClass2(_Point,[{key:"clone",value:function clone(){return new _Point(this.x,this.y);}},{key:"copyFrom",value:function copyFrom(e){return this.set(e.x,e.y),this;}},{key:"copyTo",value:function copyTo(e){return e.set(this.x,this.y),e;}},{key:"equals",value:function equals(e){return e.x===this.x&&e.y===this.y;}},{key:"set",value:function set(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:e;return this.x=e,this.y=t,this;}}]);}();_Point.prototype.toString=function(){return"[@pixi/math:Point x=".concat(this.x," y=").concat(this.y,"]");};var tempPoints=[new _Point(),new _Point(),new _Point(),new _Point()];var _Rectangle=/*#__PURE__*/function(){function _Rectangle(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;_classCallCheck2(this,_Rectangle);this.x=Number(e),this.y=Number(t),this.width=Number(r),this.height=Number(n),this.type=_SHAPES.RECT;}return _createClass2(_Rectangle,[{key:"left",get:function get(){return this.x;}},{key:"right",get:function get(){return this.x+this.width;}},{key:"top",get:function get(){return this.y;}},{key:"bottom",get:function get(){return this.y+this.height;}},{key:"clone",value:function clone(){return new _Rectangle(this.x,this.y,this.width,this.height);}},{key:"copyFrom",value:function copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this;}},{key:"copyTo",value:function copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e;}},{key:"contains",value:function contains(e,t){return!(this.width<=0||this.height<=0)&&e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height;}},{key:"intersects",value:function intersects(e,t){if(!t){var _t150=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=_t150)return!1;var _r182=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>_r182;}var r=this.left,n=this.right,i=this.top,o=this.bottom;if(n<=r||o<=i)return!1;var a=tempPoints[0].set(e.left,e.top),s=tempPoints[1].set(e.left,e.bottom),u=tempPoints[2].set(e.right,e.top),l=tempPoints[3].set(e.right,e.bottom);if(u.x<=a.x||s.y<=a.y)return!1;var c=Math.sign(t.a*t.d-t.b*t.c);if(0===c||(t.apply(a,a),t.apply(s,s),t.apply(u,u),t.apply(l,l),Math.max(a.x,s.x,u.x,l.x)<=r||Math.min(a.x,s.x,u.x,l.x)>=n||Math.max(a.y,s.y,u.y,l.y)<=i||Math.min(a.y,s.y,u.y,l.y)>=o))return!1;var h=c*(s.y-a.y),f=c*(a.x-s.x),d=h*r+f*i,p=h*n+f*i,y=h*r+f*o,m=h*n+f*o;if(Math.max(d,p,y,m)<=h*a.x+f*a.y||Math.min(d,p,y,m)>=h*l.x+f*l.y)return!1;var g=c*(a.y-u.y),w=c*(u.x-a.x),b=g*r+w*i,v=g*n+w*i,x=g*r+w*o,_=g*n+w*o;return!(Math.max(b,v,x,_)<=g*a.x+w*a.y||Math.min(b,v,x,_)>=g*l.x+w*l.y);}},{key:"pad",value:function pad(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:e;return this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t,this;}},{key:"fit",value:function fit(e){var t=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(r-t,0),this.y=n,this.height=Math.max(i-n,0),this;}},{key:"ceil",value:function ceil(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:.001;var r=Math.ceil((this.x+this.width-t)*e)/e,n=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=r-this.x,this.height=n-this.y,this;}},{key:"enlarge",value:function enlarge(e){var t=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=r-t,this.y=n,this.height=i-n,this;}}],[{key:"EMPTY",get:function get(){return new _Rectangle(0,0,0,0);}}]);}();_Rectangle.prototype.toString=function(){return"[@pixi/math:Rectangle x=".concat(this.x," y=").concat(this.y," width=").concat(this.width," height=").concat(this.height,"]");};var _Circle=/*#__PURE__*/function(){function _Circle(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;_classCallCheck2(this,_Circle);this.x=e,this.y=t,this.radius=r,this.type=_SHAPES.CIRC;}return _createClass2(_Circle,[{key:"clone",value:function clone(){return new _Circle(this.x,this.y,this.radius);}},{key:"contains",value:function contains(e,t){if(this.radius<=0)return!1;var r=this.radius*this.radius;var n=this.x-e,i=this.y-t;return n*=n,i*=i,n+i<=r;}},{key:"getBounds",value:function getBounds(){return new _Rectangle(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius);}}]);}();_Circle.prototype.toString=function(){return"[@pixi/math:Circle x=".concat(this.x," y=").concat(this.y," radius=").concat(this.radius,"]");};var _Ellipse=/*#__PURE__*/function(){function _Ellipse(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;_classCallCheck2(this,_Ellipse);this.x=e,this.y=t,this.width=r,this.height=n,this.type=_SHAPES.ELIP;}return _createClass2(_Ellipse,[{key:"clone",value:function clone(){return new _Ellipse(this.x,this.y,this.width,this.height);}},{key:"contains",value:function contains(e,t){if(this.width<=0||this.height<=0)return!1;var r=(e-this.x)/this.width,n=(t-this.y)/this.height;return r*=r,n*=n,r+n<=1;}},{key:"getBounds",value:function getBounds(){return new _Rectangle(this.x-this.width,this.y-this.height,this.width,this.height);}}]);}();_Ellipse.prototype.toString=function(){return"[@pixi/math:Ellipse x=".concat(this.x," y=").concat(this.y," width=").concat(this.width," height=").concat(this.height,"]");};var _Polygon=/*#__PURE__*/function(){function _Polygon(){_classCallCheck2(this,_Polygon);for(var _len5=arguments.length,e=new Array(_len5),_key5=0;_key5<_len5;_key5++){e[_key5]=arguments[_key5];}var t=Array.isArray(e[0])?e[0]:e;if("number"!=typeof t[0]){var _e279=[];for(var r=0,_n90=t.length;r<_n90;r++)_e279.push(t[r].x,t[r].y);t=_e279;}this.points=t,this.type=_SHAPES.POLY,this.closeStroke=!0;}return _createClass2(_Polygon,[{key:"clone",value:function clone(){var e=this.points.slice(),t=new _Polygon(e);return t.closeStroke=this.closeStroke,t;}},{key:"contains",value:function contains(e,t){var r=!1;var n=this.points.length/2;for(var _i74=0,_o49=n-1;_i74<n;_o49=_i74++){var _n91=this.points[2*_i74],_a31=this.points[2*_i74+1],_s26=this.points[2*_o49],_u21=this.points[2*_o49+1];_a31>t!=_u21>t&&e<(t-_a31)/(_u21-_a31)*(_s26-_n91)+_n91&&(r=!r);}return r;}}]);}();_Polygon.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke=".concat(this.closeStroke,"points=").concat(this.points.reduce(function(e,t){return"".concat(e,", ").concat(t);},""),"]");};var _RoundedRectangle=/*#__PURE__*/function(){function _RoundedRectangle(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:20;_classCallCheck2(this,_RoundedRectangle);this.x=e,this.y=t,this.width=r,this.height=n,this.radius=i,this.type=_SHAPES.RREC;}return _createClass2(_RoundedRectangle,[{key:"clone",value:function clone(){return new _RoundedRectangle(this.x,this.y,this.width,this.height,this.radius);}},{key:"contains",value:function contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){var r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+r&&t<=this.y+this.height-r||e>=this.x+r&&e<=this.x+this.width-r)return!0;var _n92=e-(this.x+r),_i75=t-(this.y+r);var _o50=r*r;if(_n92*_n92+_i75*_i75<=_o50||(_n92=e-(this.x+this.width-r),_n92*_n92+_i75*_i75<=_o50)||(_i75=t-(this.y+this.height-r),_n92*_n92+_i75*_i75<=_o50)||(_n92=e-(this.x+r),_n92*_n92+_i75*_i75<=_o50))return!0;}return!1;}}]);}();_RoundedRectangle.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x=".concat(this.x," y=").concat(this.y,"width=").concat(this.width," height=").concat(this.height," radius=").concat(this.radius,"]");};var _Matrix=/*#__PURE__*/function(){function _Matrix(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1;var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;var o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:0;_classCallCheck2(this,_Matrix);this.array=null,this.a=e,this.b=t,this.c=r,this.d=n,this.tx=i,this.ty=o;}return _createClass2(_Matrix,[{key:"fromArray",value:function fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5];}},{key:"set",value:function set(e,t,r,n,i,o){return this.a=e,this.b=t,this.c=r,this.d=n,this.tx=i,this.ty=o,this;}},{key:"toArray",value:function toArray(e,t){this.array||(this.array=new Float32Array(9));var r=t||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r;}},{key:"apply",value:function apply(e,t){t=t||new _Point();var r=e.x,n=e.y;return t.x=this.a*r+this.c*n+this.tx,t.y=this.b*r+this.d*n+this.ty,t;}},{key:"applyInverse",value:function applyInverse(e,t){t=t||new _Point();var r=1/(this.a*this.d+this.c*-this.b),n=e.x,i=e.y;return t.x=this.d*r*n+-this.c*r*i+(this.ty*this.c-this.tx*this.d)*r,t.y=this.a*r*i+-this.b*r*n+(-this.ty*this.a+this.tx*this.b)*r,t;}},{key:"translate",value:function translate(e,t){return this.tx+=e,this.ty+=t,this;}},{key:"scale",value:function scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this;}},{key:"rotate",value:function rotate(e){var t=Math.cos(e),r=Math.sin(e),n=this.a,i=this.c,o=this.tx;return this.a=n*t-this.b*r,this.b=n*r+this.b*t,this.c=i*t-this.d*r,this.d=i*r+this.d*t,this.tx=o*t-this.ty*r,this.ty=o*r+this.ty*t,this;}},{key:"append",value:function append(e){var t=this.a,r=this.b,n=this.c,i=this.d;return this.a=e.a*t+e.b*n,this.b=e.a*r+e.b*i,this.c=e.c*t+e.d*n,this.d=e.c*r+e.d*i,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*r+e.ty*i+this.ty,this;}},{key:"setTransform",value:function setTransform(e,t,r,n,i,o,a,s,u){return this.a=Math.cos(a+u)*i,this.b=Math.sin(a+u)*i,this.c=-Math.sin(a-s)*o,this.d=Math.cos(a-s)*o,this.tx=e-(r*this.a+n*this.c),this.ty=t-(r*this.b+n*this.d),this;}},{key:"prepend",value:function prepend(e){var t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){var _t151=this.a,r=this.c;this.a=_t151*e.a+this.b*e.c,this.b=_t151*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d;}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this;}},{key:"decompose",value:function decompose(e){var t=this.a,r=this.b,n=this.c,i=this.d,o=e.pivot,a=-Math.atan2(-n,i),s=Math.atan2(r,t),u=Math.abs(a+s);return u<1e-5||Math.abs(_PI_-u)<1e-5?(e.rotation=s,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=s),e.scale.x=Math.sqrt(t*t+r*r),e.scale.y=Math.sqrt(n*n+i*i),e.position.x=this.tx+(o.x*t+o.y*n),e.position.y=this.ty+(o.x*r+o.y*i),e;}},{key:"invert",value:function invert(){var e=this.a,t=this.b,r=this.c,n=this.d,i=this.tx,o=e*n-t*r;return this.a=n/o,this.b=-t/o,this.c=-r/o,this.d=e/o,this.tx=(r*this.ty-n*i)/o,this.ty=-(e*this.ty-t*i)/o,this;}},{key:"identity",value:function identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this;}},{key:"clone",value:function clone(){var e=new _Matrix();return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e;}},{key:"copyTo",value:function copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e;}},{key:"copyFrom",value:function copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this;}}],[{key:"IDENTITY",get:function get(){return new _Matrix();}},{key:"TEMP_MATRIX",get:function get(){return new _Matrix();}}]);}();_Matrix.prototype.toString=function(){return"[@pixi/math:Matrix a=".concat(this.a," b=").concat(this.b," c=").concat(this.c," d=").concat(this.d," tx=").concat(this.tx," ty=").concat(this.ty,"]");};var ux=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],uy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],rotationCayley=[],rotationMatrices=[],signum=Math.sign;function init(){for(var _e280=0;_e280<16;_e280++){var _t152=[];rotationCayley.push(_t152);for(var r=0;r<16;r++){var _n93=signum(ux[_e280]*ux[r]+vx[_e280]*uy[r]),_i76=signum(uy[_e280]*ux[r]+vy[_e280]*uy[r]),_o51=signum(ux[_e280]*vx[r]+vx[_e280]*vy[r]),_a32=signum(uy[_e280]*vx[r]+vy[_e280]*vy[r]);for(var _e281=0;_e281<16;_e281++)if(ux[_e281]===_n93&&uy[_e281]===_i76&&vx[_e281]===_o51&&vy[_e281]===_a32){_t152.push(_e281);break;}}}for(var _e282=0;_e282<16;_e282++){var _t153=new _Matrix();_t153.set(ux[_e282],uy[_e282],vx[_e282],vy[_e282],0,0),rotationMatrices.push(_t153);}}init();var _groupD={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function uX(e){return ux[e];},uY:function uY(e){return uy[e];},vX:function vX(e){return vx[e];},vY:function vY(e){return vy[e];},inv:function inv(e){return 8&e?15&e:7&-e;},add:function add(e,t){return rotationCayley[e][t];},sub:function sub(e,t){return rotationCayley[e][_groupD.inv(t)];},rotate180:function rotate180(e){return 4^e;},isVertical:function isVertical(e){return 2==(3&e);},byDirection:function byDirection(e,t){return 2*Math.abs(e)<=Math.abs(t)?t>=0?_groupD.S:_groupD.N:2*Math.abs(t)<=Math.abs(e)?e>0?_groupD.E:_groupD.W:t>0?e>0?_groupD.SE:_groupD.SW:e>0?_groupD.NE:_groupD.NW;},matrixAppendRotationInv:function matrixAppendRotationInv(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var i=rotationMatrices[_groupD.inv(t)];i.tx=r,i.ty=n,e.append(i);}};var _ObservablePoint=/*#__PURE__*/function(){function _ObservablePoint(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;_classCallCheck2(this,_ObservablePoint);this._x=r,this._y=n,this.cb=e,this.scope=t;}return _createClass2(_ObservablePoint,[{key:"clone",value:function clone(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.cb;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.scope;return new _ObservablePoint(e,t,this._x,this._y);}},{key:"set",value:function set(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:e;return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this;}},{key:"copyFrom",value:function copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this;}},{key:"copyTo",value:function copyTo(e){return e.set(this._x,this._y),e;}},{key:"equals",value:function equals(e){return e.x===this._x&&e.y===this._y;}},{key:"x",get:function get(){return this._x;},set:function set(e){this._x!==e&&(this._x=e,this.cb.call(this.scope));}},{key:"y",get:function get(){return this._y;},set:function set(e){this._y!==e&&(this._y=e,this.cb.call(this.scope));}}]);}();_ObservablePoint.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=".concat(this.x," y=").concat(this.y," scope=").concat(this.scope,"]");};var _Transform=/*#__PURE__*/function(){function _Transform(){_classCallCheck2(this,_Transform);this.worldTransform=new _Matrix(),this.localTransform=new _Matrix(),this.position=new _ObservablePoint(this.onChange,this,0,0),this.scale=new _ObservablePoint(this.onChange,this,1,1),this.pivot=new _ObservablePoint(this.onChange,this,0,0),this.skew=new _ObservablePoint(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0;}return _createClass2(_Transform,[{key:"onChange",value:function onChange(){this._localID++;}},{key:"updateSkew",value:function updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++;}},{key:"updateLocalTransform",value:function updateLocalTransform(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1);}},{key:"updateTransform",value:function updateTransform(e){var t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){var r=e.worldTransform,_n94=this.worldTransform;_n94.a=t.a*r.a+t.b*r.c,_n94.b=t.a*r.b+t.b*r.d,_n94.c=t.c*r.a+t.d*r.c,_n94.d=t.c*r.b+t.d*r.d,_n94.tx=t.tx*r.a+t.ty*r.c+r.tx,_n94.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++;}}},{key:"setFromMatrix",value:function setFromMatrix(e){e.decompose(this),this._localID++;}},{key:"rotation",get:function get(){return this._rotation;},set:function set(e){this._rotation!==e&&(this._rotation=e,this.updateSkew());}}]);}();_Transform.IDENTITY=new _Transform();var _Transform2=_Transform;_Transform2.prototype.toString=function(){return"[@pixi/math:Transform position=(".concat(this.position.x,", ").concat(this.position.y,") rotation=").concat(this.rotation," scale=(").concat(this.scale.x,", ").concat(this.scale.y,") skew=(").concat(this.skew.x,", ").concat(this.skew.y,") ]");};var defaultFragment="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}",defaultVertex="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n";var _uniformParsers=[{test:function test(e){return"float"===e.type&&1===e.size&&!e.isArray;},code:function code(e){return"\n            if(uv[\"".concat(e,"\"] !== ud[\"").concat(e,"\"].value)\n            {\n                ud[\"").concat(e,"\"].value = uv[\"").concat(e,"\"]\n                gl.uniform1f(ud[\"").concat(e,"\"].location, uv[\"").concat(e,"\"])\n            }\n            ");}},{test:function test(e,t){return!("sampler2D"!==e.type&&"samplerCube"!==e.type&&"sampler2DArray"!==e.type||1!==e.size||e.isArray||null!=t&&void 0===t.castToBaseTexture);},code:function code(e){return"t = syncData.textureCount++;\n\n            renderer.texture.bind(uv[\"".concat(e,"\"], t);\n\n            if(ud[\"").concat(e,"\"].value !== t)\n            {\n                ud[\"").concat(e,"\"].value = t;\n                gl.uniform1i(ud[\"").concat(e,"\"].location, t);\n; // eslint-disable-line max-len\n            }");}},{test:function test(e,t){return"mat3"===e.type&&1===e.size&&!e.isArray&&void 0!==t.a;},code:function code(e){return"\n            gl.uniformMatrix3fv(ud[\"".concat(e,"\"].location, false, uv[\"").concat(e,"\"].toArray(true));\n            ");},codeUbo:function codeUbo(e){return"\n                var ".concat(e,"_matrix = uv.").concat(e,".toArray(true);\n\n                data[offset] = ").concat(e,"_matrix[0];\n                data[offset+1] = ").concat(e,"_matrix[1];\n                data[offset+2] = ").concat(e,"_matrix[2];\n        \n                data[offset + 4] = ").concat(e,"_matrix[3];\n                data[offset + 5] = ").concat(e,"_matrix[4];\n                data[offset + 6] = ").concat(e,"_matrix[5];\n        \n                data[offset + 8] = ").concat(e,"_matrix[6];\n                data[offset + 9] = ").concat(e,"_matrix[7];\n                data[offset + 10] = ").concat(e,"_matrix[8];\n            ");}},{test:function test(e,t){return"vec2"===e.type&&1===e.size&&!e.isArray&&void 0!==t.x;},code:function code(e){return"\n                cv = ud[\"".concat(e,"\"].value;\n                v = uv[\"").concat(e,"\"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud[\"").concat(e,"\"].location, v.x, v.y);\n                }");},codeUbo:function codeUbo(e){return"\n                v = uv.".concat(e,";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            ");}},{test:function test(e){return"vec2"===e.type&&1===e.size&&!e.isArray;},code:function code(e){return"\n                cv = ud[\"".concat(e,"\"].value;\n                v = uv[\"").concat(e,"\"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud[\"").concat(e,"\"].location, v[0], v[1]);\n                }\n            ");}},{test:function test(e,t){return"vec4"===e.type&&1===e.size&&!e.isArray&&void 0!==t.width;},code:function code(e){return"\n                cv = ud[\"".concat(e,"\"].value;\n                v = uv[\"").concat(e,"\"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud[\"").concat(e,"\"].location, v.x, v.y, v.width, v.height)\n                }");},codeUbo:function codeUbo(e){return"\n                    v = uv.".concat(e,";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                ");}},{test:function test(e,t){return"vec4"===e.type&&1===e.size&&!e.isArray&&void 0!==t.red;},code:function code(e){return"\n                cv = ud[\"".concat(e,"\"].value;\n                v = uv[\"").concat(e,"\"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n                    cv[3] = v.alpha;\n                    gl.uniform4f(ud[\"").concat(e,"\"].location, v.red, v.green, v.blue, v.alpha)\n                }");},codeUbo:function codeUbo(e){return"\n                    v = uv.".concat(e,";\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                    data[offset+3] = v.alpha;\n                ");}},{test:function test(e,t){return"vec3"===e.type&&1===e.size&&!e.isArray&&void 0!==t.red;},code:function code(e){return"\n                cv = ud[\"".concat(e,"\"].value;\n                v = uv[\"").concat(e,"\"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n    \n                    gl.uniform3f(ud[\"").concat(e,"\"].location, v.red, v.green, v.blue)\n                }");},codeUbo:function codeUbo(e){return"\n                    v = uv.".concat(e,";\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                ");}},{test:function test(e){return"vec4"===e.type&&1===e.size&&!e.isArray;},code:function code(e){return"\n                cv = ud[\"".concat(e,"\"].value;\n                v = uv[\"").concat(e,"\"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud[\"").concat(e,"\"].location, v[0], v[1], v[2], v[3])\n                }");}}],GLSL_TO_SINGLE_SETTERS_CACHED={"float":"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }","int":"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},GLSL_TO_ARRAY_SETTERS={"float":"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)","int":"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function generateUniformsSync(e,t){var r=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(var _n95 in e.uniforms){var _i77=t[_n95];if(!_i77){var _e$uniforms$_n;!0===((_e$uniforms$_n=e.uniforms[_n95])===null||_e$uniforms$_n===void 0?void 0:_e$uniforms$_n.group)&&(e.uniforms[_n95].ubo?r.push("\n                        renderer.shader.syncUniformBufferGroup(uv.".concat(_n95,", '").concat(_n95,"');\n                    ")):r.push("\n                        renderer.shader.syncUniformGroup(uv.".concat(_n95,", syncData);\n                    ")));continue;}var _o52=e.uniforms[_n95];var _a33=!1;for(var _e283=0;_e283<_uniformParsers.length;_e283++)if(_uniformParsers[_e283].test(_i77,_o52)){r.push(_uniformParsers[_e283].code(_n95,_o52)),_a33=!0;break;}if(!_a33){var _e284=(1!==_i77.size||_i77.isArray?GLSL_TO_ARRAY_SETTERS:GLSL_TO_SINGLE_SETTERS_CACHED)[_i77.type].replace("location","ud[\"".concat(_n95,"\"].location"));r.push("\n            cu = ud[\"".concat(_n95,"\"];\n            cv = cu.value;\n            v = uv[\"").concat(_n95,"\"];\n            ").concat(_e284,";"));}}return new Function("ud","uv","renderer","syncData",r.join("\n"));}var unknownContext={};var context=unknownContext,maxFragmentPrecision;function _getTestContext(){var _context76;if(context===unknownContext||(_context76=context)!==null&&_context76!==void 0&&_context76.isContextLost()){var _e285=_settings.ADAPTER.createCanvas();var _t154;_settings.PREFER_ENV>=_ENV.WEBGL2&&(_t154=_e285.getContext("webgl2",{})),_t154||(_t154=_e285.getContext("webgl",{})||_e285.getContext("experimental-webgl",{}),_t154?_t154.getExtension("WEBGL_draw_buffers"):_t154=null),context=_t154;}return context;}function getMaxFragmentPrecision(){if(!maxFragmentPrecision){maxFragmentPrecision=_PRECISION.MEDIUM;var _e286=_getTestContext();if(_e286&&_e286.getShaderPrecisionFormat){var _t155=_e286.getShaderPrecisionFormat(_e286.FRAGMENT_SHADER,_e286.HIGH_FLOAT);_t155&&(maxFragmentPrecision=_t155.precision?_PRECISION.HIGH:_PRECISION.MEDIUM);}}return maxFragmentPrecision;}var GLSL_TO_SIZE={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function mapSize(e){return GLSL_TO_SIZE[e];}var GL_TABLE=null;var GL_TO_GLSL_TYPES={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function mapType(e,t){if(!GL_TABLE){var _t156=Object.keys(GL_TO_GLSL_TYPES);GL_TABLE={};for(var r=0;r<_t156.length;++r){var _n96=_t156[r];GL_TABLE[e[_n96]]=GL_TO_GLSL_TYPES[_n96];}}return GL_TABLE[t];}function setPrecision(e,t,r){if("precision"!==e.substring(0,9)){var _n97=t;return t===_PRECISION.HIGH&&r!==_PRECISION.HIGH&&(_n97=_PRECISION.MEDIUM),"precision ".concat(_n97," float;\n").concat(e);}return r!==_PRECISION.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e;}var Program_UID=0;var nameCache={},_Program=/*#__PURE__*/function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"pixi-shader";var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};_classCallCheck2(this,e);this.extra={},this.id=Program_UID++,this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=r||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,"#version"!==this.vertexSrc.substring(0,8)&&(n=n.replace(/\s+/g,"-"),nameCache[n]?(nameCache[n]++,n+="-".concat(nameCache[n])):nameCache[n]=1,this.vertexSrc="#define SHADER_NAME ".concat(n,"\n").concat(this.vertexSrc),this.fragmentSrc="#define SHADER_NAME ".concat(n,"\n").concat(this.fragmentSrc),this.vertexSrc=setPrecision(this.vertexSrc,e.defaultVertexPrecision,_PRECISION.HIGH),this.fragmentSrc=setPrecision(this.fragmentSrc,e.defaultFragmentPrecision,getMaxFragmentPrecision())),this.glPrograms={},this.syncUniforms=null;}return _createClass2(e,null,[{key:"defaultVertexSrc",get:function get(){return defaultVertex;}},{key:"defaultFragmentSrc",get:function get(){return defaultFragment;}},{key:"from",value:function from(t,r,n){var i=t+r;var o=_ProgramCache[i];return o||(_ProgramCache[i]=o=new e(t,r,n)),o;}}]);}();_Program.defaultVertexPrecision=_PRECISION.HIGH,_Program.defaultFragmentPrecision=isMobile_isMobile.apple.device?_PRECISION.HIGH:_PRECISION.MEDIUM;var _Program2=_Program,UniformGroup_UID=0;var _UniformGroup=/*#__PURE__*/function(){function _UniformGroup(e,t,r){_classCallCheck2(this,_UniformGroup);this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=UniformGroup_UID++,this["static"]=!!t,this.ubo=!!r,e instanceof _Buffer?(this.buffer=e,this.buffer.type=_BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new _Buffer(new Float32Array(1)),this.buffer.type=_BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!0));}return _createClass2(_UniformGroup,[{key:"update",value:function update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update();}},{key:"add",value:function add(e,t,r){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[e]=new _UniformGroup(t,r);}}],[{key:"from",value:function from(e,t,r){return new _UniformGroup(e,t,r);}},{key:"uboFrom",value:function uboFrom(e,t){return new _UniformGroup(e,t!==null&&t!==void 0?t:!0,!0);}}]);}();var _Shader=/*#__PURE__*/function(){function _Shader(e,t){_classCallCheck2(this,_Shader);this.uniformBindCount=0,this.program=e,this.uniformGroup=t?t instanceof _UniformGroup?t:new _UniformGroup(t):new _UniformGroup({}),this.disposeRunner=new _Runner("disposeShader");}return _createClass2(_Shader,[{key:"checkUniformExists",value:function checkUniformExists(e,t){if(t.uniforms[e])return!0;for(var r in t.uniforms){var _n98=t.uniforms[r];if(!0===_n98.group&&this.checkUniformExists(e,_n98))return!0;}return!1;}},{key:"destroy",value:function destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy();}},{key:"uniforms",get:function get(){return this.uniformGroup.uniforms;}}],[{key:"from",value:function from(e,t,r){var n=_Program2.from(e,t);return new _Shader(n,r);}}]);}();var _BatchShaderGenerator=/*#__PURE__*/function(){function _BatchShaderGenerator(e,t){_classCallCheck2(this,_BatchShaderGenerator);if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},!t.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!t.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".');}return _createClass2(_BatchShaderGenerator,[{key:"generateShader",value:function generateShader(e){if(!this.programCache[e]){var _t157=new Int32Array(e);for(var _r183=0;_r183<e;_r183++)_t157[_r183]=_r183;this.defaultGroupCache[e]=_UniformGroup.from({uSamplers:_t157},!0);var r=this.fragTemplate;r=r.replace(/%count%/gi,"".concat(e)),r=r.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new _Program2(this.vertexSrc,r);}var t={tint:new Float32Array([1,1,1,1]),translationMatrix:new _Matrix(),"default":this.defaultGroupCache[e]};return new _Shader(this.programCache[e],t);}},{key:"generateSampleSrc",value:function generateSampleSrc(e){var t="";t+="\n",t+="\n";for(var r=0;r<e;r++)r>0&&(t+="\nelse "),r<e-1&&(t+="if(vTextureId < ".concat(r,".5)")),t+="\n{",t+="\n\tcolor = texture2D(uSamplers[".concat(r,"], vTextureCoord);"),t+="\n}";return t+="\n",t+="\n",t;}}]);}();var _BatchTextureArray=/*#__PURE__*/function(){function _BatchTextureArray(){_classCallCheck2(this,_BatchTextureArray);this.elements=[],this.ids=[],this.count=0;}return _createClass2(_BatchTextureArray,[{key:"clear",value:function clear(){for(var _e287=0;_e287<this.count;_e287++)this.elements[_e287]=null;this.count=0;}}]);}();function canUploadSameBuffer(){return!isMobile_isMobile.apple.device;}function maxRecommendedTextures(e){var t=!0;var r=_settings.ADAPTER.getNavigator();if(isMobile_isMobile.tablet||isMobile_isMobile.phone){if(isMobile_isMobile.apple.device){var _e288=r.userAgent.match(/OS (\d+)_(\d+)?/);_e288&&parseInt(_e288[1],10)<11&&(t=!1);}if(isMobile_isMobile.android.device){var _e289=r.userAgent.match(/Android\s([0-9.]*)/);_e289&&parseInt(_e289[1],10)<7&&(t=!1);}}return t?e:4;}var _ObjectRenderer=/*#__PURE__*/function(){function _ObjectRenderer(e){_classCallCheck2(this,_ObjectRenderer);this.renderer=e;}return _createClass2(_ObjectRenderer,[{key:"flush",value:function flush(){}},{key:"destroy",value:function destroy(){this.renderer=null;}},{key:"start",value:function start(){}},{key:"stop",value:function stop(){this.flush();}},{key:"render",value:function render(e){}}]);}();var texture_frag_defaultFragment="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",texture_vert_defaultVertex="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n";var _BatchRenderer=/*#__PURE__*/function(_ObjectRenderer2){function e(t){var _this39;_classCallCheck2(this,e);_this39=_callSuper2(this,e,[t]),_this39.setShaderGenerator(),_this39.geometryClass=_BatchGeometry,_this39.vertexSize=6,_this39.state=_State.for2d(),_this39.size=4*e.defaultBatchSize,_this39._vertexCount=0,_this39._indexCount=0,_this39._bufferedElements=[],_this39._bufferedTextures=[],_this39._bufferSize=0,_this39._shader=null,_this39._packedGeometries=[],_this39._packedGeometryPoolSize=2,_this39._flushId=0,_this39._aBuffers={},_this39._iBuffers={},_this39.maxTextures=1,_this39.renderer.on("prerender",_this39.onPrerender,_assertThisInitialized2(_this39)),t.runners.contextChange.add(_assertThisInitialized2(_this39)),_this39._dcIndex=0,_this39._aIndex=0,_this39._iIndex=0,_this39._attributeBuffer=null,_this39._indexBuffer=null,_this39._tempBoundTextures=[];return _this39;}_inherits2(e,_ObjectRenderer2);return _createClass2(e,[{key:"MAX_TEXTURES",get:function get(){return _deprecation("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures;}},{key:"setShaderGenerator",value:function setShaderGenerator(){var _ref34=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref34$vertex=_ref34.vertex,t=_ref34$vertex===void 0?e.defaultVertexSrc:_ref34$vertex,_ref34$fragment=_ref34.fragment,r=_ref34$fragment===void 0?e.defaultFragmentTemplate:_ref34$fragment;this.shaderGenerator=new _BatchShaderGenerator(t,r);}},{key:"contextChange",value:function contextChange(){var t=this.renderer.gl;_settings.PREFER_ENV===_ENV.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),e.defaultMaxTextures),this.maxTextures=_checkMaxIfStatementsInShader(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(var _e306=0;_e306<this._packedGeometryPoolSize;_e306++)this._packedGeometries[_e306]=new this.geometryClass();this.initFlushBuffers();}},{key:"initFlushBuffers",value:function initFlushBuffers(){var t=e._drawCallPool,r=e._textureArrayPool,n=this.size/4,i=Math.floor(n/this.maxTextures)+1;for(;t.length<n;)t.push(new _BatchDrawCall());for(;r.length<i;)r.push(new _BatchTextureArray());for(var _e307=0;_e307<this.maxTextures;_e307++)this._tempBoundTextures[_e307]=null;}},{key:"onPrerender",value:function onPrerender(){this._flushId=0;}},{key:"render",value:function render(_e294){_e294._texture.valid&&(this._vertexCount+_e294.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=_e294.vertexData.length/2,this._indexCount+=_e294.indices.length,this._bufferedTextures[this._bufferSize]=_e294._texture.baseTexture,this._bufferedElements[this._bufferSize++]=_e294);}},{key:"buildTexturesAndDrawCalls",value:function buildTexturesAndDrawCalls(){var t=this._bufferedTextures,r=this.maxTextures,n=e._textureArrayPool,i=this.renderer.batch,o=this._tempBoundTextures,a=this.renderer.textureGC.count;var s=++_BaseTexture2._globalBatch,u=0,l=n[0],c=0;i.copyBoundTextures(o,r);for(var _e308=0;_e308<this._bufferSize;++_e308){var _h12=t[_e308];t[_e308]=null,_h12._batchEnabled!==s&&(l.count>=r&&(i.boundArray(l,o,s,r),this.buildDrawCalls(l,c,_e308),c=_e308,l=n[++u],++s),_h12._batchEnabled=s,_h12.touched=a,l.elements[l.count++]=_h12);}l.count>0&&(i.boundArray(l,o,s,r),this.buildDrawCalls(l,c,this._bufferSize),++u,++s);for(var _e309=0;_e309<o.length;_e309++)o[_e309]=null;_BaseTexture2._globalBatch=s;}},{key:"buildDrawCalls",value:function buildDrawCalls(t,r,n){var i=this._bufferedElements,o=this._attributeBuffer,a=this._indexBuffer,s=this.vertexSize,u=e._drawCallPool;var l=this._dcIndex,c=this._aIndex,h=this._iIndex,f=u[l];f.start=this._iIndex,f.texArray=t;for(var _e310=r;_e310<n;++_e310){var _n99=i[_e310],_d10=_n99._texture.baseTexture,_p8=_premultiplyBlendMode[_d10.alphaMode?1:0][_n99.blendMode];i[_e310]=null,r<_e310&&f.blend!==_p8&&(f.size=h-f.start,r=_e310,f=u[++l],f.texArray=t,f.start=h),this.packInterleavedGeometry(_n99,o,a,c,h),c+=_n99.vertexData.length/2*s,h+=_n99.indices.length,f.blend=_p8;}r<n&&(f.size=h-f.start,++l),this._dcIndex=l,this._aIndex=c,this._iIndex=h;}},{key:"bindAndClearTexArray",value:function bindAndClearTexArray(_e298){var t=this.renderer.texture;for(var r=0;r<_e298.count;r++)t.bind(_e298.elements[r],_e298.ids[r]),_e298.elements[r]=null;_e298.count=0;}},{key:"updateGeometry",value:function updateGeometry(){var t=this._packedGeometries,r=this._attributeBuffer,n=this._indexBuffer;e.canUploadSameBuffer?(t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass()),t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++);}},{key:"drawBatches",value:function drawBatches(){var t=this._dcIndex,_this$renderer=this.renderer,r=_this$renderer.gl,n=_this$renderer.state,i=e._drawCallPool;var o=null;for(var _e311=0;_e311<t;_e311++){var _i$_e=i[_e311],_t158=_i$_e.texArray,_a34=_i$_e.type,_s27=_i$_e.size,_u22=_i$_e.start,_l16=_i$_e.blend;o!==_t158&&(o=_t158,this.bindAndClearTexArray(_t158)),this.state.blendMode=_l16,n.set(this.state),r.drawElements(_a34,_s27,r.UNSIGNED_SHORT,2*_u22);}}},{key:"flush",value:function flush(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0);}},{key:"start",value:function start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),e.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId]);}},{key:"stop",value:function stop(){this.flush();}},{key:"destroy",value:function destroy(){for(var _e312=0;_e312<this._packedGeometryPoolSize;_e312++)this._packedGeometries[_e312]&&this._packedGeometries[_e312].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),_superPropGet2(e,"destroy",this,3)([]);}},{key:"getAttributeBuffer",value:function getAttributeBuffer(_e301){var t=_nextPow(Math.ceil(_e301/8)),r=_log(t),n=8*t;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var i=this._aBuffers[n];return i||(this._aBuffers[n]=i=new _ViewableBuffer(n*this.vertexSize*4)),i;}},{key:"getIndexBuffer",value:function getIndexBuffer(_e302){var t=_nextPow(Math.ceil(_e302/12)),r=_log(t),n=12*t;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var i=this._iBuffers[r];return i||(this._iBuffers[r]=i=new Uint16Array(n)),i;}},{key:"packInterleavedGeometry",value:function packInterleavedGeometry(_e303,t,r,n,i){var o=t.uint32View,a=t.float32View,s=n/this.vertexSize,u=_e303.uvs,l=_e303.indices,c=_e303.vertexData,h=_e303._texture.baseTexture._batchLocation,f=Math.min(_e303.worldAlpha,1),d=_Color2.shared.setValue(_e303._tintRGB).toPremultiplied(f,_e303._texture.baseTexture.alphaMode>0);for(var _e313=0;_e313<c.length;_e313+=2)a[n++]=c[_e313],a[n++]=c[_e313+1],a[n++]=u[_e313],a[n++]=u[_e313+1],o[n++]=d,a[n++]=h;for(var _e314=0;_e314<l.length;_e314++)r[i++]=s+l[_e314];}}],[{key:"defaultMaxTextures",get:function get(){var _this$_defaultMaxText;return this._defaultMaxTextures=(_this$_defaultMaxText=this._defaultMaxTextures)!==null&&_this$_defaultMaxText!==void 0?_this$_defaultMaxText:maxRecommendedTextures(32),this._defaultMaxTextures;},set:function set(_e290){this._defaultMaxTextures=_e290;}},{key:"canUploadSameBuffer",get:function get(){var _this$_canUploadSameB;return this._canUploadSameBuffer=(_this$_canUploadSameB=this._canUploadSameBuffer)!==null&&_this$_canUploadSameB!==void 0?_this$_canUploadSameB:canUploadSameBuffer(),this._canUploadSameBuffer;},set:function set(_e291){this._canUploadSameBuffer=_e291;}},{key:"defaultVertexSrc",get:function get(){return texture_vert_defaultVertex;}},{key:"defaultFragmentTemplate",get:function get(){return texture_frag_defaultFragment;}}]);}(_ObjectRenderer);_BatchRenderer.defaultBatchSize=4096,_BatchRenderer.extension={name:"batch",type:_ExtensionType.RendererPlugin},_BatchRenderer._drawCallPool=[],_BatchRenderer._textureArrayPool=[];var _BatchRenderer2=_BatchRenderer;_extensions.add(_BatchRenderer2);var defaultFilter_frag_defaultFragment="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n",defaultFilter_vert_defaultVertex="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";var _Filter=/*#__PURE__*/function(_Shader2){function e(t,r,n){var _this40;_classCallCheck2(this,e);_this40=_callSuper2(this,e,[_Program2.from(t||e.defaultVertexSrc,r||e.defaultFragmentSrc),n]),_this40.padding=0,_this40.resolution=e.defaultResolution,_this40.multisample=e.defaultMultisample,_this40.enabled=!0,_this40.autoFit=!0,_this40.state=new _State();return _this40;}_inherits2(e,_Shader2);return _createClass2(e,[{key:"apply",value:function apply(_e315,t,r,n,i){_e315.applyFilter(this,t,r,n);}},{key:"blendMode",get:function get(){return this.state.blendMode;},set:function set(_e316){this.state.blendMode=_e316;}},{key:"resolution",get:function get(){return this._resolution;},set:function set(_e317){this._resolution=_e317;}}],[{key:"defaultVertexSrc",get:function get(){return defaultFilter_vert_defaultVertex;}},{key:"defaultFragmentSrc",get:function get(){return defaultFilter_frag_defaultFragment;}}]);}(_Shader);_Filter.defaultResolution=1,_Filter.defaultMultisample=_MSAA_QUALITY.NONE;var _Filter2=_Filter;var _BackgroundSystem=/*#__PURE__*/function(){function _BackgroundSystem(){_classCallCheck2(this,_BackgroundSystem);this.clearBeforeRender=!0,this._backgroundColor=new _Color2(0),this.alpha=1;}return _createClass2(_BackgroundSystem,[{key:"init",value:function init(e){this.clearBeforeRender=e.clearBeforeRender;var t=e.backgroundColor,r=e.background,n=e.backgroundAlpha,i=r!==null&&r!==void 0?r:t;void 0!==i&&(this.color=i),this.alpha=n;}},{key:"color",get:function get(){return this._backgroundColor.value;},set:function set(e){this._backgroundColor.setValue(e);}},{key:"alpha",get:function get(){return this._backgroundColor.alpha;},set:function set(e){this._backgroundColor.setAlpha(e);}},{key:"backgroundColor",get:function get(){return this._backgroundColor;}},{key:"destroy",value:function destroy(){}}]);}();_BackgroundSystem.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},_BackgroundSystem.extension={type:[_ExtensionType.RendererSystem,_ExtensionType.CanvasRendererSystem],name:"background"},_extensions.add(_BackgroundSystem);var _BatchSystem=/*#__PURE__*/function(){function _BatchSystem(e){_classCallCheck2(this,_BatchSystem);this.renderer=e,this.emptyRenderer=new _ObjectRenderer(e),this.currentRenderer=this.emptyRenderer;}return _createClass2(_BatchSystem,[{key:"setObjectRenderer",value:function setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start());}},{key:"flush",value:function flush(){this.setObjectRenderer(this.emptyRenderer);}},{key:"reset",value:function reset(){this.setObjectRenderer(this.emptyRenderer);}},{key:"copyBoundTextures",value:function copyBoundTextures(e,t){var r=this.renderer.texture.boundTextures;for(var _n100=t-1;_n100>=0;--_n100)e[_n100]=r[_n100]||null,e[_n100]&&(e[_n100]._batchLocation=_n100);}},{key:"boundArray",value:function boundArray(e,t,r,n){var i=e.elements,o=e.ids,a=e.count;var s=0;for(var _e318=0;_e318<a;_e318++){var _a35=i[_e318],_u23=_a35._batchLocation;if(_u23>=0&&_u23<n&&t[_u23]===_a35)o[_e318]=_u23;else for(;s<n;){var _n101=t[s];if(!_n101||_n101._batchEnabled!==r||_n101._batchLocation!==s){o[_e318]=s,_a35._batchLocation=s,t[s]=_a35;break;}s++;}}}},{key:"destroy",value:function destroy(){this.renderer=null;}}]);}();_BatchSystem.extension={type:_ExtensionType.RendererSystem,name:"batch"},_extensions.add(_BatchSystem);var CONTEXT_UID_COUNTER=0;var _ContextSystem=/*#__PURE__*/function(){function _ContextSystem(e){_classCallCheck2(this,_ContextSystem);this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this);}return _createClass2(_ContextSystem,[{key:"isLost",get:function get(){return!this.gl||this.gl.isContextLost();}},{key:"contextChange",value:function contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++;}},{key:"init",value:function init(e){if(e.context)this.initFromContext(e.context);else{var _t159=this.renderer.background.alpha<1,r=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:_t159,premultipliedAlpha:r,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference});}}},{key:"initFromContext",value:function initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++,this.renderer.runners.contextChange.emit(e);var t=this.renderer.view;void 0!==t.addEventListener&&(t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1));}},{key:"initFromOptions",value:function initFromOptions(e){var t=this.createContext(this.renderer.view,e);this.initFromContext(t);}},{key:"createContext",value:function createContext(e,t){var r;if(_settings.PREFER_ENV>=_ENV.WEBGL2&&(r=e.getContext("webgl2",t)),r)this.webGLVersion=2;else if(this.webGLVersion=1,r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!r)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl;}},{key:"getExtensions",value:function getExtensions(){var e=this.gl,t={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};1===this.webGLVersion?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")});}},{key:"handleContextLost",value:function handleContextLost(e){var _this41=this;e.preventDefault(),setTimeout(function(){_this41.gl.isContextLost()&&_this41.extensions.loseContext&&_this41.extensions.loseContext.restoreContext();},0);}},{key:"handleContextRestored",value:function handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl);}},{key:"destroy",value:function destroy(){var e=this.renderer.view;this.renderer=null,void 0!==e.removeEventListener&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext();}},{key:"postrender",value:function postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush();}},{key:"validateContext",value:function validateContext(e){var t=e.getContextAttributes(),r="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;r&&(this.webGLVersion=2),t&&!t.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var n=r||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly");}}]);}();_ContextSystem.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},_ContextSystem.extension={type:_ExtensionType.RendererSystem,name:"context"},_extensions.add(_ContextSystem);var _Framebuffer=/*#__PURE__*/function(){function _Framebuffer(e,t){_classCallCheck2(this,_Framebuffer);if(this.width=Math.round(e),this.height=Math.round(t),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new _Runner("disposeFramebuffer"),this.multisample=_MSAA_QUALITY.NONE;}return _createClass2(_Framebuffer,[{key:"colorTexture",get:function get(){return this.colorTextures[0];}},{key:"addColorTexture",value:function addColorTexture(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1?arguments[1]:undefined;return this.colorTextures[e]=t||new _BaseTexture2(null,{scaleMode:_SCALE_MODES.NEAREST,resolution:1,mipmap:_MIPMAP_MODES.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this;}},{key:"addDepthTexture",value:function addDepthTexture(e){return this.depthTexture=e||new _BaseTexture2(null,{scaleMode:_SCALE_MODES.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:_MIPMAP_MODES.OFF,format:_FORMATS.DEPTH_COMPONENT,type:_TYPES.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this;}},{key:"enableDepth",value:function enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this;}},{key:"enableStencil",value:function enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this;}},{key:"resize",value:function resize(e,t){if(e=Math.round(e),t=Math.round(t),!e||!t)throw new Error("Framebuffer width and height must not be zero");if(e!==this.width||t!==this.height){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var _n102=this.colorTextures[r],_i78=_n102.resolution;_n102.setSize(e/_i78,t/_i78);}if(this.depthTexture){var _r184=this.depthTexture.resolution;this.depthTexture.setSize(e/_r184,t/_r184);}}}},{key:"dispose",value:function dispose(){this.disposeRunner.emit(this,!1);}},{key:"destroyDepthTexture",value:function destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat);}}]);}();var _BaseRenderTexture=/*#__PURE__*/function(_BaseTexture3){function _BaseRenderTexture(){var _e$width,_e$height,_e$multisample;var _this42;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck2(this,_BaseRenderTexture);if("number"==typeof e){e={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]};}e.width=(_e$width=e.width)!==null&&_e$width!==void 0?_e$width:100,e.height=(_e$height=e.height)!==null&&_e$height!==void 0?_e$height:100,(_e$multisample=e.multisample)!==null&&_e$multisample!==void 0?_e$multisample:e.multisample=_MSAA_QUALITY.NONE,_this42=_callSuper2(this,_BaseRenderTexture,[null,e]),_this42.mipmap=_MIPMAP_MODES.OFF,_this42.valid=!0,_this42._clear=new _Color2([0,0,0,0]),_this42.framebuffer=new _Framebuffer(_this42.realWidth,_this42.realHeight).addColorTexture(0,_assertThisInitialized2(_this42)),_this42.framebuffer.multisample=e.multisample,_this42.maskStack=[],_this42.filterStack=[{}];return _this42;}_inherits2(_BaseRenderTexture,_BaseTexture3);return _createClass2(_BaseRenderTexture,[{key:"clearColor",get:function get(){return this._clear.value;},set:function set(e){this._clear.setValue(e);}},{key:"clear",get:function get(){return this._clear;}},{key:"multisample",get:function get(){return this.framebuffer.multisample;},set:function set(e){this.framebuffer.multisample=e;}},{key:"resize",value:function resize(e,t){this.framebuffer.resize(e*this.resolution,t*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height);}},{key:"dispose",value:function dispose(){this.framebuffer.dispose(),_superPropGet2(_BaseRenderTexture,"dispose",this,3)([]);}},{key:"destroy",value:function destroy(){_superPropGet2(_BaseRenderTexture,"destroy",this,3)([]),this.framebuffer.destroyDepthTexture(),this.framebuffer=null;}}]);}(_BaseTexture2);var _BaseImageResource=/*#__PURE__*/function(_Resource3){function _BaseImageResource(e){var _this43;_classCallCheck2(this,_BaseImageResource);var t=e;_this43=_callSuper2(this,_BaseImageResource,[t.naturalWidth||t.videoWidth||t.displayWidth||t.width,t.naturalHeight||t.videoHeight||t.displayHeight||t.height]),_this43.source=e,_this43.noSubImage=!1;return _this43;}_inherits2(_BaseImageResource,_Resource3);return _createClass2(_BaseImageResource,[{key:"upload",value:function upload(e,t,r,n){var i=e.gl,o=t.realWidth,a=t.realHeight;if(n=n||this.source,(typeof HTMLImageElement==="undefined"?"undefined":_typeof2(HTMLImageElement))<"u"&&n instanceof HTMLImageElement){if(!n.complete||0===n.naturalWidth)return!1;}else if((typeof HTMLVideoElement==="undefined"?"undefined":_typeof2(HTMLVideoElement))<"u"&&n instanceof HTMLVideoElement&&n.readyState<=1)return!1;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===_ALPHA_MODES.UNPACK),this.noSubImage||t.target!==i.TEXTURE_2D||r.width!==o||r.height!==a?(r.width=o,r.height=a,i.texImage2D(t.target,0,r.internalFormat,t.format,r.type,n)):i.texSubImage2D(i.TEXTURE_2D,0,0,0,t.format,r.type,n),!0;}},{key:"update",value:function update(){if(this.destroyed)return;var e=this.source,t=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;this.resize(t,r),_superPropGet2(_BaseImageResource,"update",this,3)([]);}},{key:"dispose",value:function dispose(){this.source=null;}}],[{key:"crossOrigin",value:function crossOrigin(e,t,r){void 0!==r||t.startsWith("data:")?!1!==r&&(e.crossOrigin="string"==typeof r?r:"anonymous"):e.crossOrigin=_determineCrossOrigin(t);}}]);}(_Resource);var _ImageResource=/*#__PURE__*/function(_BaseImageResource2){function _ImageResource(e,t){var _t$createBitmap;var _this44;_classCallCheck2(this,_ImageResource);if(t=t||{},"string"==typeof e){var r=new Image();_BaseImageResource.crossOrigin(r,e,t.crossorigin),r.src=e,e=r;}_this44=_callSuper2(this,_ImageResource,[e]),!e.complete&&_this44._width&&_this44._height&&(_this44._width=0,_this44._height=0),_this44.url=e.src,_this44._process=null,_this44.preserveBitmap=!1,_this44.createBitmap=((_t$createBitmap=t.createBitmap)!==null&&_t$createBitmap!==void 0?_t$createBitmap:_settings.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,_this44.alphaMode="number"==typeof t.alphaMode?t.alphaMode:null,_this44.bitmap=null,_this44._load=null,!1!==t.autoLoad&&_this44.load();return _this44;}_inherits2(_ImageResource,_BaseImageResource2);return _createClass2(_ImageResource,[{key:"load",value:function load(e){var _this45=this;return this._load||(void 0!==e&&(this.createBitmap=e),this._load=new Promise(function(e,t){var r=_this45.source;_this45.url=r.src;var n=function n(){_this45.destroyed||(r.onload=null,r.onerror=null,_this45.update(),_this45._load=null,_this45.createBitmap?e(_this45.process()):e(_this45));};r.complete&&r.src?n():(r.onload=n,r.onerror=function(e){t(e),_this45.onError.emit(e);});})),this._load;}},{key:"process",value:function process(){var _this46=this;var e=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);var t=globalThis.createImageBitmap,r=!e.crossOrigin||"anonymous"===e.crossOrigin;return this._process=fetch(e.src,{mode:r?"cors":"no-cors"}).then(function(e){return e.blob();}).then(function(r){return t(r,0,0,e.width,e.height,{premultiplyAlpha:null===_this46.alphaMode||_this46.alphaMode===_ALPHA_MODES.UNPACK?"premultiply":"none"});}).then(function(e){return _this46.destroyed?Promise.reject():(_this46.bitmap=e,_this46.update(),_this46._process=null,Promise.resolve(_this46));}),this._process;}},{key:"upload",value:function upload(e,t,r){if("number"==typeof this.alphaMode&&(t.alphaMode=this.alphaMode),!this.createBitmap)return _superPropGet2(_ImageResource,"upload",this,3)([e,t,r]);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(_superPropGet2(_ImageResource,"upload",this,3)([e,t,r,this.bitmap]),!this.preserveBitmap){var _e319=!0;var _n103=t._glTextures;for(var _i79 in _n103){var _o53=_n103[_i79];if(_o53!==r&&_o53.dirtyId!==t.dirtyId){_e319=!1;break;}}_e319&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null);}return!0;}},{key:"dispose",value:function dispose(){this.source.onload=null,this.source.onerror=null,_superPropGet2(_ImageResource,"dispose",this,3)([]),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null;}}],[{key:"test",value:function test(e){return(typeof HTMLImageElement==="undefined"?"undefined":_typeof2(HTMLImageElement))<"u"&&("string"==typeof e||e instanceof HTMLImageElement);}}]);}(_BaseImageResource);var _TextureUvs=/*#__PURE__*/function(){function _TextureUvs(){_classCallCheck2(this,_TextureUvs);this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8);}return _createClass2(_TextureUvs,[{key:"set",value:function set(e,t,r){var n=t.width,i=t.height;if(r){var _t160=e.width/2/n,_o54=e.height/2/i,_a36=e.x/n+_t160,_s28=e.y/i+_o54;r=_groupD.add(r,_groupD.NW),this.x0=_a36+_t160*_groupD.uX(r),this.y0=_s28+_o54*_groupD.uY(r),r=_groupD.add(r,2),this.x1=_a36+_t160*_groupD.uX(r),this.y1=_s28+_o54*_groupD.uY(r),r=_groupD.add(r,2),this.x2=_a36+_t160*_groupD.uX(r),this.y2=_s28+_o54*_groupD.uY(r),r=_groupD.add(r,2),this.x3=_a36+_t160*_groupD.uX(r),this.y3=_s28+_o54*_groupD.uY(r);}else this.x0=e.x/n,this.y0=e.y/i,this.x1=(e.x+e.width)/n,this.y1=e.y/i,this.x2=(e.x+e.width)/n,this.y2=(e.y+e.height)/i,this.x3=e.x/n,this.y3=(e.y+e.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3;}}]);}();_TextureUvs.prototype.toString=function(){return"[@pixi/core:TextureUvs x0=".concat(this.x0," y0=").concat(this.y0," x1=").concat(this.x1," y1=").concat(this.y1," x2=").concat(this.x2," y2=").concat(this.y2," x3=").concat(this.x3," y3=").concat(this.y3,"]");};var DEFAULT_UVS=new _TextureUvs();function removeAllHandlers(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){};}var Texture_Texture=/*#__PURE__*/function(_utils_node_modules_e2){function Texture_Texture(e,t,r,n,i,o,a){var _this47;_classCallCheck2(this,Texture_Texture);if(_this47=_callSuper2(this,Texture_Texture),_this47.noFrame=!1,t||(_this47.noFrame=!0,t=new _Rectangle(0,0,1,1)),e instanceof Texture_Texture&&(e=e.baseTexture),_this47.baseTexture=e,_this47._frame=t,_this47.trim=n,_this47.valid=!1,_this47.destroyed=!1,_this47._uvs=DEFAULT_UVS,_this47.uvMatrix=null,_this47.orig=r||t,_this47._rotate=Number(i||0),!0===i)_this47._rotate=2;else if(_this47._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");_this47.defaultAnchor=o?new _Point(o.x,o.y):new _Point(0,0),_this47.defaultBorders=a,_this47._updateID=0,_this47.textureCacheIds=[],e.valid?_this47.noFrame?e.valid&&_this47.onBaseTextureUpdated(e):_this47.frame=t:e.once("loaded",_this47.onBaseTextureUpdated,_this47),_this47.noFrame&&e.on("update",_this47.onBaseTextureUpdated,_this47);return _this47;}_inherits2(Texture_Texture,_utils_node_modules_e2);return _createClass2(Texture_Texture,[{key:"update",value:function update(){this.baseTexture.resource&&this.baseTexture.resource.update();}},{key:"onBaseTextureUpdated",value:function onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs();}else this.frame=this._frame;this.emit("update",this);}},{key:"destroy",value:function destroy(e){if(this.baseTexture){if(e){var _e320=this.baseTexture.resource;_e320!==null&&_e320!==void 0&&_e320.url&&_TextureCache[_e320.url]&&Texture_Texture.removeFromCache(_e320.url),this.baseTexture.destroy();}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null;}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Texture_Texture.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners();}},{key:"clone",value:function clone(){var _this$trim;var e=this._frame.clone(),t=this._frame===this.orig?e:this.orig.clone(),r=new Texture_Texture(this.baseTexture,!this.noFrame&&e,t,(_this$trim=this.trim)===null||_this$trim===void 0?void 0:_this$trim.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(r._frame=e),r;}},{key:"updateUvs",value:function updateUvs(){this._uvs===DEFAULT_UVS&&(this._uvs=new _TextureUvs()),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++;}},{key:"resolution",get:function get(){return this.baseTexture.resolution;}},{key:"frame",get:function get(){return this._frame;},set:function set(e){this._frame=e,this.noFrame=!1;var t=e.x,r=e.y,n=e.width,i=e.height,o=t+n>this.baseTexture.width,a=r+i>this.baseTexture.height;if(o||a){var _e321=o&&a?"and":"or",_s29="X: ".concat(t," + ").concat(n," = ").concat(t+n," > ").concat(this.baseTexture.width),_u24="Y: ".concat(r," + ").concat(i," = ").concat(r+i," > ").concat(this.baseTexture.height);throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: ".concat(_s29," ").concat(_e321," ").concat(_u24));}this.valid=n&&i&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs();}},{key:"rotate",get:function get(){return this._rotate;},set:function set(e){this._rotate=e,this.valid&&this.updateUvs();}},{key:"width",get:function get(){return this.orig.width;}},{key:"height",get:function get(){return this.orig.height;}},{key:"castToBaseTexture",value:function castToBaseTexture(){return this.baseTexture;}}],[{key:"from",value:function from(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:_settings.STRICT_TEXTURE_CACHE;var n="string"==typeof e;var i=null;if(n)i=e;else if(e instanceof _BaseTexture2){if(!e.cacheId){var _r185=(t===null||t===void 0?void 0:t.pixiIdPrefix)||"pixiid";e.cacheId="".concat(_r185,"-").concat(_uid()),_BaseTexture2.addToCache(e,e.cacheId);}i=e.cacheId;}else{if(!e._pixiId){var _r186=(t===null||t===void 0?void 0:t.pixiIdPrefix)||"pixiid";e._pixiId="".concat(_r186,"_").concat(_uid());}i=e._pixiId;}var o=_TextureCache[i];if(n&&r&&!o)throw new Error("The cacheId \"".concat(i,"\" does not exist in TextureCache."));return o||e instanceof _BaseTexture2?!o&&e instanceof _BaseTexture2&&(o=new Texture_Texture(e),Texture_Texture.addToCache(o,i)):(t.resolution||(t.resolution=_getResolutionOfUrl(e)),o=new Texture_Texture(new _BaseTexture2(e,t)),o.baseTexture.cacheId=i,_BaseTexture2.addToCache(o.baseTexture,i),Texture_Texture.addToCache(o,i)),o;}},{key:"fromURL",value:function fromURL(e,t){var r=Object.assign({autoLoad:!1},t===null||t===void 0?void 0:t.resourceOptions),n=Texture_Texture.from(e,Object.assign({resourceOptions:r},t),!1),i=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):i.load().then(function(){return Promise.resolve(n);});}},{key:"fromBuffer",value:function fromBuffer(e,t,r,n){return new Texture_Texture(_BaseTexture2.fromBuffer(e,t,r,n));}},{key:"fromLoader",value:function fromLoader(e,t,r,n){var i=new _BaseTexture2(e,Object.assign({scaleMode:_BaseTexture2.defaultOptions.scaleMode,resolution:_getResolutionOfUrl(t)},n)),o=i.resource;o instanceof _ImageResource&&(o.url=t);var a=new Texture_Texture(i);return r||(r=t),_BaseTexture2.addToCache(a.baseTexture,r),Texture_Texture.addToCache(a,r),r!==t&&(_BaseTexture2.addToCache(a.baseTexture,t),Texture_Texture.addToCache(a,t)),a.baseTexture.valid?Promise.resolve(a):new Promise(function(e){a.baseTexture.once("loaded",function(){return e(a);});});}},{key:"addToCache",value:function addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),_TextureCache[t]&&_TextureCache[t]!==e&&console.warn("Texture added to the cache with an id [".concat(t,"] that already had an entry")),_TextureCache[t]=e);}},{key:"removeFromCache",value:function removeFromCache(e){if("string"==typeof e){var _t161=_TextureCache[e];if(_t161){var r=_t161.textureCacheIds.indexOf(e);return r>-1&&_t161.textureCacheIds.splice(r,1),delete _TextureCache[e],_t161;}}else if(e!==null&&e!==void 0&&e.textureCacheIds){for(var _t162=0;_t162<e.textureCacheIds.length;++_t162)_TextureCache[e.textureCacheIds[_t162]]===e&&delete _TextureCache[e.textureCacheIds[_t162]];return e.textureCacheIds.length=0,e;}return null;}},{key:"EMPTY",get:function get(){return Texture_Texture._EMPTY||(Texture_Texture._EMPTY=new Texture_Texture(new _BaseTexture2()),removeAllHandlers(Texture_Texture._EMPTY),removeAllHandlers(Texture_Texture._EMPTY.baseTexture)),Texture_Texture._EMPTY;}},{key:"WHITE",get:function get(){if(!Texture_Texture._WHITE){var _e322=_settings.ADAPTER.createCanvas(16,16),_t163=_e322.getContext("2d");_e322.width=16,_e322.height=16,_t163.fillStyle="white",_t163.fillRect(0,0,16,16),Texture_Texture._WHITE=new Texture_Texture(_BaseTexture2.from(_e322)),removeAllHandlers(Texture_Texture._WHITE),removeAllHandlers(Texture_Texture._WHITE.baseTexture);}return Texture_Texture._WHITE;}}]);}(utils_node_modules_eventemitter3);var _RenderTexture=/*#__PURE__*/function(_Texture_Texture){function _RenderTexture(e,t){var _this48;_classCallCheck2(this,_RenderTexture);_this48=_callSuper2(this,_RenderTexture,[e,t]),_this48.valid=!0,_this48.filterFrame=null,_this48.filterPoolKey=null,_this48.updateUvs();return _this48;}_inherits2(_RenderTexture,_Texture_Texture);return _createClass2(_RenderTexture,[{key:"framebuffer",get:function get(){return this.baseTexture.framebuffer;}},{key:"multisample",get:function get(){return this.framebuffer.multisample;},set:function set(e){this.framebuffer.multisample=e;}},{key:"resize",value:function resize(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0;var n=this.baseTexture.resolution,i=Math.round(e*n)/n,o=Math.round(t*n)/n;this.valid=i>0&&o>0,this._frame.width=this.orig.width=i,this._frame.height=this.orig.height=o,r&&this.baseTexture.resize(i,o),this.updateUvs();}},{key:"setResolution",value:function setResolution(e){var t=this.baseTexture;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1));}}],[{key:"create",value:function create(e){return new _RenderTexture(new _BaseRenderTexture(e));}}]);}(Texture_Texture);var _RenderTexturePool=/*#__PURE__*/function(){function _RenderTexturePool(e){_classCallCheck2(this,_RenderTexturePool);this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0;}return _createClass2(_RenderTexturePool,[{key:"createTexture",value:function createTexture(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:_MSAA_QUALITY.NONE;var n=new _BaseRenderTexture(Object.assign({width:e,height:t,resolution:1,multisample:r},this.textureOptions));return new _RenderTexture(n);}},{key:"getOptimalTexture",value:function getOptimalTexture(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:_MSAA_QUALITY.NONE;var i;e=Math.max(Math.ceil(e*r-1e-6),1),t=Math.max(Math.ceil(t*r-1e-6),1),this.enableFullScreen&&e===this._pixelsWidth&&t===this._pixelsHeight?i=n>1?-n:-1:(i=((65535&(e=_nextPow(e)))<<16|65535&(t=_nextPow(t)))>>>0,n>1&&(i+=4294967296*n)),this.texturePool[i]||(this.texturePool[i]=[]);var o=this.texturePool[i].pop();return o||(o=this.createTexture(e,t,n)),o.filterPoolKey=i,o.setResolution(r),o;}},{key:"getFilterTexture",value:function getFilterTexture(e,t,r){var n=this.getOptimalTexture(e.width,e.height,t||e.resolution,r||_MSAA_QUALITY.NONE);return n.filterFrame=e.filterFrame,n;}},{key:"returnTexture",value:function returnTexture(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e);}},{key:"returnFilterTexture",value:function returnFilterTexture(e){this.returnTexture(e);}},{key:"clear",value:function clear(e){if(e=!1!==e)for(var _e323 in this.texturePool){var _t164=this.texturePool[_e323];if(_t164)for(var _e324=0;_e324<_t164.length;_e324++)_t164[_e324].destroy(!0);}this.texturePool={};}},{key:"setScreenSize",value:function setScreenSize(e){if(e.width!==this._pixelsWidth||e.height!==this._pixelsHeight){this.enableFullScreen=e.width>0&&e.height>0;for(var _e325 in this.texturePool){if(!(Number(_e325)<0))continue;var _t165=this.texturePool[_e325];if(_t165)for(var _e326=0;_e326<_t165.length;_e326++)_t165[_e326].destroy(!0);this.texturePool[_e325]=[];}this._pixelsWidth=e.width,this._pixelsHeight=e.height;}}}]);}();_RenderTexturePool.SCREEN_KEY=-1;var _Quad=/*#__PURE__*/function(_Geometry3){function _Quad(){var _this49;_classCallCheck2(this,_Quad);_this49=_callSuper2(this,_Quad),_this49.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]);return _this49;}_inherits2(_Quad,_Geometry3);return _createClass2(_Quad);}(_Geometry);var _QuadUv=/*#__PURE__*/function(_Geometry4){function _QuadUv(){var _this50;_classCallCheck2(this,_QuadUv);_this50=_callSuper2(this,_QuadUv),_this50.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),_this50.uvs=new Float32Array([0,0,1,0,1,1,0,1]),_this50.vertexBuffer=new _Buffer(_this50.vertices),_this50.uvBuffer=new _Buffer(_this50.uvs),_this50.addAttribute("aVertexPosition",_this50.vertexBuffer).addAttribute("aTextureCoord",_this50.uvBuffer).addIndex([0,1,2,0,2,3]);return _this50;}_inherits2(_QuadUv,_Geometry4);return _createClass2(_QuadUv,[{key:"map",value:function map(e,t){var r=0,n=0;return this.uvs[0]=r,this.uvs[1]=n,this.uvs[2]=r+t.width/e.width,this.uvs[3]=n,this.uvs[4]=r+t.width/e.width,this.uvs[5]=n+t.height/e.height,this.uvs[6]=r,this.uvs[7]=n+t.height/e.height,r=t.x,n=t.y,this.vertices[0]=r,this.vertices[1]=n,this.vertices[2]=r+t.width,this.vertices[3]=n,this.vertices[4]=r+t.width,this.vertices[5]=n+t.height,this.vertices[6]=r,this.vertices[7]=n+t.height,this.invalidate(),this;}},{key:"invalidate",value:function invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this;}}]);}(_Geometry);var _FilterState=/*#__PURE__*/function(){function _FilterState(){_classCallCheck2(this,_FilterState);this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=_MSAA_QUALITY.NONE,this.sourceFrame=new _Rectangle(),this.destinationFrame=new _Rectangle(),this.bindingSourceFrame=new _Rectangle(),this.bindingDestinationFrame=new _Rectangle(),this.filters=[],this.transform=null;}return _createClass2(_FilterState,[{key:"clear",value:function clear(){this.target=null,this.filters=null,this.renderTexture=null;}}]);}();var FilterSystem_tempPoints=[new _Point(),new _Point(),new _Point(),new _Point()],tempMatrix=new _Matrix();var _FilterSystem=/*#__PURE__*/function(){function _FilterSystem(e){_classCallCheck2(this,_FilterSystem);this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new _RenderTexturePool(),this.statePool=[],this.quad=new _Quad(),this.quadUv=new _QuadUv(),this.tempRect=new _Rectangle(),this.activeState={},this.globalUniforms=new _UniformGroup({outputFrame:new _Rectangle(),inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1;}return _createClass2(_FilterSystem,[{key:"init",value:function init(){this.texturePool.setScreenSize(this.renderer.view);}},{key:"push",value:function push(e,t){var _t$0$multisample,_t$0$legacy;var r=this.renderer,n=this.defaultFilterStack,i=this.statePool.pop()||new _FilterState(),o=r.renderTexture;var a,s;if(o.current){var _e327=o.current;a=_e327.resolution,s=_e327.multisample;}else a=r.resolution,s=r.multisample;var u=t[0].resolution||a,l=(_t$0$multisample=t[0].multisample)!==null&&_t$0$multisample!==void 0?_t$0$multisample:s,c=t[0].padding,h=t[0].autoFit,f=(_t$0$legacy=t[0].legacy)!==null&&_t$0$legacy!==void 0?_t$0$legacy:!0;for(var _e328=1;_e328<t.length;_e328++){var _r187$multisample,_r187$legacy;var _r187=t[_e328];u=Math.min(u,_r187.resolution||a),l=Math.min(l,(_r187$multisample=_r187.multisample)!==null&&_r187$multisample!==void 0?_r187$multisample:s),c=this.useMaxPadding?Math.max(c,_r187.padding):c+_r187.padding,h=h&&_r187.autoFit,f=f||((_r187$legacy=_r187.legacy)!==null&&_r187$legacy!==void 0?_r187$legacy:!0);}1===n.length&&(this.defaultFilterStack[0].renderTexture=o.current),n.push(i),i.resolution=u,i.multisample=l,i.legacy=f,i.target=e,i.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),i.sourceFrame.pad(c);var d=this.tempRect.copyFrom(o.sourceFrame);r.projection.transform&&this.transformAABB(tempMatrix.copyFrom(r.projection.transform).invert(),d),h?(i.sourceFrame.fit(d),(i.sourceFrame.width<=0||i.sourceFrame.height<=0)&&(i.sourceFrame.width=0,i.sourceFrame.height=0)):i.sourceFrame.intersects(d)||(i.sourceFrame.width=0,i.sourceFrame.height=0),this.roundFrame(i.sourceFrame,o.current?o.current.resolution:r.resolution,o.sourceFrame,o.destinationFrame,r.projection.transform),i.renderTexture=this.getOptimalFilterTexture(i.sourceFrame.width,i.sourceFrame.height,u,l),i.filters=t,i.destinationFrame.width=i.renderTexture.width,i.destinationFrame.height=i.renderTexture.height;var p=this.tempRect;p.x=0,p.y=0,p.width=i.sourceFrame.width,p.height=i.sourceFrame.height,i.renderTexture.filterFrame=i.sourceFrame,i.bindingSourceFrame.copyFrom(o.sourceFrame),i.bindingDestinationFrame.copyFrom(o.destinationFrame),i.transform=r.projection.transform,r.projection.transform=null,o.bind(i.renderTexture,i.sourceFrame,p),r.framebuffer.clear(0,0,0,0);}},{key:"pop",value:function pop(){var e=this.defaultFilterStack,t=e.pop(),r=t.filters;this.activeState=t;var n=this.globalUniforms.uniforms;n.outputFrame=t.sourceFrame,n.resolution=t.resolution;var i=n.inputSize,o=n.inputPixel,a=n.inputClamp;if(i[0]=t.destinationFrame.width,i[1]=t.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],o[0]=Math.round(i[0]*t.resolution),o[1]=Math.round(i[1]*t.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=t.sourceFrame.width*i[2]-.5*o[2],a[3]=t.sourceFrame.height*i[3]-.5*o[3],t.legacy){var _e329=n.filterArea;_e329[0]=t.destinationFrame.width,_e329[1]=t.destinationFrame.height,_e329[2]=t.sourceFrame.x,_e329[3]=t.sourceFrame.y,n.filterClamp=n.inputClamp;}this.globalUniforms.update();var s=e[e.length-1];if(this.renderer.framebuffer.blit(),1===r.length)r[0].apply(this,t.renderTexture,s.renderTexture,_CLEAR_MODES.BLEND,t),this.returnFilterTexture(t.renderTexture);else{var _e330=t.renderTexture,_n104=this.getOptimalFilterTexture(_e330.width,_e330.height,t.resolution);_n104.filterFrame=_e330.filterFrame;var _i80=0;for(_i80=0;_i80<r.length-1;++_i80){1===_i80&&t.multisample>1&&(_n104=this.getOptimalFilterTexture(_e330.width,_e330.height,t.resolution),_n104.filterFrame=_e330.filterFrame),r[_i80].apply(this,_e330,_n104,_CLEAR_MODES.CLEAR,t);var _o55=_e330;_e330=_n104,_n104=_o55;}r[_i80].apply(this,_e330,s.renderTexture,_CLEAR_MODES.BLEND,t),_i80>1&&t.multisample>1&&this.returnFilterTexture(t.renderTexture),this.returnFilterTexture(_e330),this.returnFilterTexture(_n104);}t.clear(),this.statePool.push(t);}},{key:"bindAndClear",value:function bindAndClear(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:_CLEAR_MODES.CLEAR;var _this$renderer2=this.renderer,r=_this$renderer2.renderTexture,n=_this$renderer2.state;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e!==null&&e!==void 0&&e.filterFrame){var _t166=this.tempRect;_t166.x=0,_t166.y=0,_t166.width=e.filterFrame.width,_t166.height=e.filterFrame.height,r.bind(e,e.filterFrame,_t166);}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var i=1&n.stateId||this.forceClear;(t===_CLEAR_MODES.CLEAR||t===_CLEAR_MODES.BLIT&&i)&&this.renderer.framebuffer.clear(0,0,0,0);}},{key:"applyFilter",value:function applyFilter(e,t,r,n){var i=this.renderer;i.state.set(e.state),this.bindAndClear(r,n),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,i.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(_DRAW_MODES.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(_DRAW_MODES.TRIANGLE_STRIP));}},{key:"calculateSpriteMatrix",value:function calculateSpriteMatrix(e,t){var _this$activeState=this.activeState,r=_this$activeState.sourceFrame,n=_this$activeState.destinationFrame,i=t._texture.orig,o=e.set(n.width,0,0,n.height,r.x,r.y),a=t.worldTransform.copyTo(_Matrix.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/i.width,1/i.height),o.translate(t.anchor.x,t.anchor.y),o;}},{key:"destroy",value:function destroy(){this.renderer=null,this.texturePool.clear(!1);}},{key:"getOptimalFilterTexture",value:function getOptimalFilterTexture(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:_MSAA_QUALITY.NONE;return this.texturePool.getOptimalTexture(e,t,r,n);}},{key:"getFilterTexture",value:function getFilterTexture(e,t,r){if("number"==typeof e){var _r188=e;e=t,t=_r188;}e=e||this.activeState.renderTexture;var n=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,r||_MSAA_QUALITY.NONE);return n.filterFrame=e.filterFrame,n;}},{key:"returnFilterTexture",value:function returnFilterTexture(e){this.texturePool.returnTexture(e);}},{key:"emptyPool",value:function emptyPool(){this.texturePool.clear(!0);}},{key:"resize",value:function resize(){this.texturePool.setScreenSize(this.renderer.view);}},{key:"transformAABB",value:function transformAABB(e,t){var r=FilterSystem_tempPoints[0],n=FilterSystem_tempPoints[1],i=FilterSystem_tempPoints[2],o=FilterSystem_tempPoints[3];r.set(t.left,t.top),n.set(t.left,t.bottom),i.set(t.right,t.top),o.set(t.right,t.bottom),e.apply(r,r),e.apply(n,n),e.apply(i,i),e.apply(o,o);var a=Math.min(r.x,n.x,i.x,o.x),s=Math.min(r.y,n.y,i.y,o.y),u=Math.max(r.x,n.x,i.x,o.x),l=Math.max(r.y,n.y,i.y,o.y);t.x=a,t.y=s,t.width=u-a,t.height=l-s;}},{key:"roundFrame",value:function roundFrame(e,t,r,n,i){if(!(e.width<=0||e.height<=0||r.width<=0||r.height<=0)){if(i){var _i81=i,_e331=_i81.a,_t167=_i81.b,_r189=_i81.c,_n105=_i81.d;if((Math.abs(_t167)>1e-4||Math.abs(_r189)>1e-4)&&(Math.abs(_e331)>1e-4||Math.abs(_n105)>1e-4))return;}(i=i?tempMatrix.copyFrom(i):tempMatrix.identity()).translate(-r.x,-r.y).scale(n.width/r.width,n.height/r.height).translate(n.x,n.y),this.transformAABB(i,e),e.ceil(t),this.transformAABB(i.invert(),e);}}}]);}();_FilterSystem.extension={type:_ExtensionType.RendererSystem,name:"filter"},_extensions.add(_FilterSystem);var _GLFramebuffer=/*#__PURE__*/_createClass2(function _GLFramebuffer(e){_classCallCheck2(this,_GLFramebuffer);this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=_MSAA_QUALITY.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0;});var tempRectangle=new _Rectangle();var _FramebufferSystem=/*#__PURE__*/function(){function _FramebufferSystem(e){_classCallCheck2(this,_FramebufferSystem);this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new _Framebuffer(10,10),this.msaaSamples=null;}return _createClass2(_FramebufferSystem,[{key:"contextChange",value:function contextChange(){this.disposeAll(!0);var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new _Rectangle(),this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){var _t168=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;_settings.PREFER_ENV===_ENV.WEBGL_LEGACY&&(_t168=null,r=null),_t168?e.drawBuffers=function(e){return _t168.drawBuffersWEBGL(e);}:(this.hasMRT=!1,e.drawBuffers=function(){}),r||(this.writeDepthTexture=!1);}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES);}},{key:"bind",value:function bind(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var n=this.gl;if(e){var _i82=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,n.bindFramebuffer(n.FRAMEBUFFER,_i82.framebuffer)),_i82.mipLevel!==r&&(e.dirtyId++,e.dirtyFormat++,_i82.mipLevel=r),_i82.dirtyId!==e.dirtyId&&(_i82.dirtyId=e.dirtyId,_i82.dirtyFormat!==e.dirtyFormat?(_i82.dirtyFormat=e.dirtyFormat,_i82.dirtySize=e.dirtySize,this.updateFramebuffer(e,r)):_i82.dirtySize!==e.dirtySize&&(_i82.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(var _t169=0;_t169<e.colorTextures.length;_t169++){var _r190=e.colorTextures[_t169];this.renderer.texture.unbind(_r190.parentTextureArray||_r190);}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t){var _e332=t.width>>r,_n106=t.height>>r,_i83=_e332/t.width;this.setViewport(t.x*_i83,t.y*_i83,_e332,_n106);}else{var _t170=e.width>>r,_n107=e.height>>r;this.setViewport(0,0,_t170,_n107);}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height);}},{key:"setViewport",value:function setViewport(e,t,r,n){var i=this.viewport;e=Math.round(e),t=Math.round(t),r=Math.round(r),n=Math.round(n),(i.width!==r||i.height!==n||i.x!==e||i.y!==t)&&(i.x=e,i.y=t,i.width=r,i.height=n,this.gl.viewport(e,t,r,n));}},{key:"size",get:function get(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height};}},{key:"clear",value:function clear(e,t,r,n){var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:_BUFFER_BITS.COLOR|_BUFFER_BITS.DEPTH;var o=this.gl;o.clearColor(e,t,r,n),o.clear(i);}},{key:"initFramebuffer",value:function initFramebuffer(e){var t=this.gl,r=new _GLFramebuffer(t.createFramebuffer());return r.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(e),e.disposeRunner.add(this),r;}},{key:"resizeFramebuffer",value:function resizeFramebuffer(e){var t=this.gl,r=e.glFramebuffers[this.CONTEXT_UID];if(r.stencil){var _n108;t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),_n108=1===this.renderer.context.webGLVersion?t.DEPTH_STENCIL:e.depth&&e.stencil?t.DEPTH24_STENCIL8:e.depth?t.DEPTH_COMPONENT24:t.STENCIL_INDEX8,r.msaaBuffer?t.renderbufferStorageMultisample(t.RENDERBUFFER,r.multisample,_n108,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,_n108,e.width,e.height);}var n=e.colorTextures;var i=n.length;t.drawBuffers||(i=Math.min(i,1));for(var _o56=0;_o56<i;_o56++){var _i84=n[_o56],_a37=_i84.parentTextureArray||_i84;this.renderer.texture.bind(_a37,0),0===_o56&&r.msaaBuffer&&(t.bindRenderbuffer(t.RENDERBUFFER,r.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,r.multisample,_a37._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height));}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0);}},{key:"updateFramebuffer",value:function updateFramebuffer(e,t){var r=this.gl,n=e.glFramebuffers[this.CONTEXT_UID],i=e.colorTextures;var o=i.length;r.drawBuffers||(o=Math.min(o,1)),n.multisample>1&&this.canMultisampleFramebuffer(e)?n.msaaBuffer=n.msaaBuffer||r.createRenderbuffer():n.msaaBuffer&&(r.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null,n.blitFramebuffer&&(n.blitFramebuffer.dispose(),n.blitFramebuffer=null));var a=[];for(var _s30=0;_s30<o;_s30++){var _o57=i[_s30],_u25=_o57.parentTextureArray||_o57;this.renderer.texture.bind(_u25,0),0===_s30&&n.msaaBuffer?(r.bindRenderbuffer(r.RENDERBUFFER,n.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,_u25._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,n.msaaBuffer)):(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+_s30,_o57.target,_u25._glTextures[this.CONTEXT_UID].texture,t),a.push(r.COLOR_ATTACHMENT0+_s30));}if(a.length>1&&r.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){var _n109=e.depthTexture;this.renderer.texture.bind(_n109,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,_n109._glTextures[this.CONTEXT_UID].texture,t);}if(!e.stencil&&!e.depth||e.depthTexture&&this.writeDepthTexture)n.stencil&&(r.deleteRenderbuffer(n.stencil),n.stencil=null);else{var _t171,_i85;n.stencil=n.stencil||r.createRenderbuffer(),1===this.renderer.context.webGLVersion?(_t171=r.DEPTH_STENCIL_ATTACHMENT,_i85=r.DEPTH_STENCIL):e.depth&&e.stencil?(_t171=r.DEPTH_STENCIL_ATTACHMENT,_i85=r.DEPTH24_STENCIL8):e.depth?(_t171=r.DEPTH_ATTACHMENT,_i85=r.DEPTH_COMPONENT24):(_t171=r.STENCIL_ATTACHMENT,_i85=r.STENCIL_INDEX8),r.bindRenderbuffer(r.RENDERBUFFER,n.stencil),n.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,_i85,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,_i85,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,_t171,r.RENDERBUFFER,n.stencil);}}},{key:"canMultisampleFramebuffer",value:function canMultisampleFramebuffer(e){return 1!==this.renderer.context.webGLVersion&&e.colorTextures.length<=1&&!e.depthTexture;}},{key:"detectSamples",value:function detectSamples(e){var t=this.msaaSamples;var r=_MSAA_QUALITY.NONE;if(e<=1||null===t)return r;for(var _n110=0;_n110<t.length;_n110++)if(t[_n110]<=e){r=t[_n110];break;}return 1===r&&(r=_MSAA_QUALITY.NONE),r;}},{key:"blit",value:function blit(e,t,r){var n=this.current,i=this.renderer,o=this.gl,a=this.CONTEXT_UID;if(2!==i.context.webGLVersion||!n)return;var s=n.glFramebuffers[a];if(!s)return;if(!e){if(!s.msaaBuffer)return;var _t172=n.colorTextures[0];if(!_t172)return;s.blitFramebuffer||(s.blitFramebuffer=new _Framebuffer(n.width,n.height),s.blitFramebuffer.addColorTexture(0,_t172)),(e=s.blitFramebuffer).colorTextures[0]!==_t172&&(e.colorTextures[0]=_t172,e.dirtyId++,e.dirtyFormat++),(e.width!==n.width||e.height!==n.height)&&(e.width=n.width,e.height=n.height,e.dirtyId++,e.dirtySize++);}t||((t=tempRectangle).width=n.width,t.height=n.height),r||(r=t);var u=t.width===r.width&&t.height===r.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,s.framebuffer),o.blitFramebuffer(t.left,t.top,t.right,t.bottom,r.left,r.top,r.right,r.bottom,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer);}},{key:"disposeFramebuffer",value:function disposeFramebuffer(e,t){var r=e.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(!r)return;delete e.glFramebuffers[this.CONTEXT_UID];var i=this.managedFramebuffers.indexOf(e);i>=0&&this.managedFramebuffers.splice(i,1),e.disposeRunner.remove(this),t||(n.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&n.deleteRenderbuffer(r.msaaBuffer),r.stencil&&n.deleteRenderbuffer(r.stencil)),r.blitFramebuffer&&this.disposeFramebuffer(r.blitFramebuffer,t);}},{key:"disposeAll",value:function disposeAll(e){var t=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<t.length;r++)this.disposeFramebuffer(t[r],e);}},{key:"forceStencil",value:function forceStencil(){var e=this.current;if(!e)return;var t=e.glFramebuffers[this.CONTEXT_UID];if(!t||t.stencil&&e.stencil)return;e.stencil=!0;var r=e.width,n=e.height,i=this.gl,o=t.stencil=i.createRenderbuffer();var a,s;i.bindRenderbuffer(i.RENDERBUFFER,o),1===this.renderer.context.webGLVersion?(a=i.DEPTH_STENCIL_ATTACHMENT,s=i.DEPTH_STENCIL):e.depth?(a=i.DEPTH_STENCIL_ATTACHMENT,s=i.DEPTH24_STENCIL8):(a=i.STENCIL_ATTACHMENT,s=i.STENCIL_INDEX8),t.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,t.multisample,s,r,n):i.renderbufferStorage(i.RENDERBUFFER,s,r,n),i.framebufferRenderbuffer(i.FRAMEBUFFER,a,i.RENDERBUFFER,o);}},{key:"reset",value:function reset(){this.current=this.unknownFramebuffer,this.viewport=new _Rectangle();}},{key:"destroy",value:function destroy(){this.renderer=null;}}]);}();_FramebufferSystem.extension={type:_ExtensionType.RendererSystem,name:"framebuffer"},_extensions.add(_FramebufferSystem);var GeometrySystem_byteSizeMap={5126:4,5123:2,5121:1};var _GeometrySystem=/*#__PURE__*/function(){function _GeometrySystem(e){_classCallCheck2(this,_GeometrySystem);this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={};}return _createClass2(_GeometrySystem,[{key:"contextChange",value:function contextChange(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==t.webGLVersion){var _t173=this.renderer.context.extensions.vertexArrayObject;_settings.PREFER_ENV===_ENV.WEBGL_LEGACY&&(_t173=null),_t173?(e.createVertexArray=function(){return _t173.createVertexArrayOES();},e.bindVertexArray=function(e){return _t173.bindVertexArrayOES(e);},e.deleteVertexArray=function(e){return _t173.deleteVertexArrayOES(e);}):(this.hasVao=!1,e.createVertexArray=function(){return null;},e.bindVertexArray=function(){return null;},e.deleteVertexArray=function(){return null;});}if(2!==t.webGLVersion){var _t174=e.getExtension("ANGLE_instanced_arrays");_t174?(e.vertexAttribDivisor=function(e,r){return _t174.vertexAttribDivisorANGLE(e,r);},e.drawElementsInstanced=function(e,r,n,i,o){return _t174.drawElementsInstancedANGLE(e,r,n,i,o);},e.drawArraysInstanced=function(e,r,n,i){return _t174.drawArraysInstancedANGLE(e,r,n,i);}):this.hasInstance=!1;}this.canUseUInt32ElementIndex=2===t.webGLVersion||!!t.extensions.uint32ElementIndex;}},{key:"bind",value:function bind(e,t){t=t||this.renderer.shader.shader;var r=this.gl;var n=e.glVertexArrayObjects[this.CONTEXT_UID],i=!1;n||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=n={},i=!0);var o=n[t.program.id]||this.initGeometryVao(e,t,i);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?r.bindVertexArray(o):this.activateVao(e,t.program)),this.updateBuffers();}},{key:"reset",value:function reset(){this.unbind();}},{key:"updateBuffers",value:function updateBuffers(){var e=this._activeGeometry,t=this.renderer.buffer;for(var r=0;r<e.buffers.length;r++){var _n111=e.buffers[r];t.update(_n111);}}},{key:"checkCompatibility",value:function checkCompatibility(e,t){var r=e.attributes,n=t.attributeData;for(var _e333 in n)if(!r[_e333])throw new Error("shader and geometry incompatible, geometry missing the \"".concat(_e333,"\" attribute"));}},{key:"getSignature",value:function getSignature(e,t){var r=e.attributes,n=t.attributeData,i=["g",e.id];for(var _e334 in r)n[_e334]&&i.push(_e334,n[_e334].location);return i.join("-");}},{key:"initGeometryVao",value:function initGeometryVao(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0;var n=this.gl,i=this.CONTEXT_UID,o=this.renderer.buffer,a=t.program;a.glPrograms[i]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,a);var s=this.getSignature(e,a),u=e.glVertexArrayObjects[this.CONTEXT_UID];var l=u[s];if(l)return u[a.id]=l,l;var c=e.buffers,h=e.attributes,f={},d={};for(var _e335 in c)f[_e335]=0,d[_e335]=0;for(var _e336 in h)!h[_e336].size&&a.attributeData[_e336]?h[_e336].size=a.attributeData[_e336].size:h[_e336].size||console.warn("PIXI Geometry attribute '".concat(_e336,"' size cannot be determined (likely the bound shader does not have the attribute)")),f[h[_e336].buffer]+=h[_e336].size*GeometrySystem_byteSizeMap[h[_e336].type];for(var _e337 in h){var _t175=h[_e337],_r191=_t175.size;void 0===_t175.stride&&(f[_t175.buffer]===_r191*GeometrySystem_byteSizeMap[_t175.type]?_t175.stride=0:_t175.stride=f[_t175.buffer]),void 0===_t175.start&&(_t175.start=d[_t175.buffer],d[_t175.buffer]+=_r191*GeometrySystem_byteSizeMap[_t175.type]);}l=n.createVertexArray(),n.bindVertexArray(l);for(var _e338=0;_e338<c.length;_e338++){var _t176=c[_e338];o.bind(_t176),r&&_t176._glBuffers[i].refCount++;}return this.activateVao(e,a),u[a.id]=l,u[s]=l,n.bindVertexArray(null),o.unbind(_BUFFER_TYPE.ARRAY_BUFFER),l;}},{key:"disposeGeometry",value:function disposeGeometry(e,t){var _this$renderer3;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];var r=e.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,i=e.buffers,o=(_this$renderer3=this.renderer)===null||_this$renderer3===void 0?void 0:_this$renderer3.buffer;if(e.disposeRunner.remove(this),r){if(o)for(var _e339=0;_e339<i.length;_e339++){var _r192=i[_e339]._glBuffers[this.CONTEXT_UID];_r192&&(_r192.refCount--,0===_r192.refCount&&!t&&o.dispose(i[_e339],t));}if(!t)for(var _e340 in r)if("g"===_e340[0]){var _t177=r[_e340];this._activeVao===_t177&&this.unbind(),n.deleteVertexArray(_t177);}delete e.glVertexArrayObjects[this.CONTEXT_UID];}}},{key:"disposeAll",value:function disposeAll(e){var t=Object.keys(this.managedGeometries);for(var r=0;r<t.length;r++)this.disposeGeometry(this.managedGeometries[t[r]],e);}},{key:"activateVao",value:function activateVao(e,t){var r=this.gl,n=this.CONTEXT_UID,i=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&i.bind(e.indexBuffer);var s=null;for(var _e341 in a){var _u26=a[_e341],_l17=o[_u26.buffer],_c17=_l17._glBuffers[n];if(t.attributeData[_e341]){s!==_c17&&(i.bind(_l17),s=_c17);var _n112=t.attributeData[_e341].location;if(r.enableVertexAttribArray(_n112),r.vertexAttribPointer(_n112,_u26.size,_u26.type||r.FLOAT,_u26.normalized,_u26.stride,_u26.start),_u26.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(_n112,_u26.divisor);}}}}},{key:"draw",value:function draw(e,t,r,n){var i=this.gl,o=this._activeGeometry;if(o.indexBuffer){var _a38=o.indexBuffer.data.BYTES_PER_ELEMENT,_s31=2===_a38?i.UNSIGNED_SHORT:i.UNSIGNED_INT;2===_a38||4===_a38&&this.canUseUInt32ElementIndex?o.instanced?i.drawElementsInstanced(e,t||o.indexBuffer.data.length,_s31,(r||0)*_a38,n||1):i.drawElements(e,t||o.indexBuffer.data.length,_s31,(r||0)*_a38):console.warn("unsupported index buffer type: uint32");}else o.instanced?i.drawArraysInstanced(e,r,t||o.getSize(),n||1):i.drawArrays(e,r,t||o.getSize());return this;}},{key:"unbind",value:function unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null;}},{key:"destroy",value:function destroy(){this.renderer=null;}}]);}();_GeometrySystem.extension={type:_ExtensionType.RendererSystem,name:"geometry"},_extensions.add(_GeometrySystem);var tempMat=new _Matrix();var _TextureMatrix=/*#__PURE__*/function(){function _TextureMatrix(e,t){_classCallCheck2(this,_TextureMatrix);this._texture=e,this.mapCoord=new _Matrix(),this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=_typeof2(t)>"u"?.5:t,this.isSimple=!1;}return _createClass2(_TextureMatrix,[{key:"texture",get:function get(){return this._texture;},set:function set(e){this._texture=e,this._textureID=-1;}},{key:"multiplyUvs",value:function multiplyUvs(e,t){void 0===t&&(t=e);var r=this.mapCoord;for(var _n113=0;_n113<e.length;_n113+=2){var _i86=e[_n113],_o58=e[_n113+1];t[_n113]=_i86*r.a+_o58*r.c+r.tx,t[_n113+1]=_i86*r.b+_o58*r.d+r.ty;}return t;}},{key:"update",value:function update(e){var t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;var r=t._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var n=t.orig,i=t.trim;i&&(tempMat.set(n.width/i.width,0,0,n.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(tempMat));var o=t.baseTexture,a=this.uClampFrame,s=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(t._frame.x+s+u)/o.width,a[1]=(t._frame.y+s+u)/o.height,a[2]=(t._frame.x+t._frame.width-s+u)/o.width,a[3]=(t._frame.y+t._frame.height-s+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=t._frame.width===o.width&&t._frame.height===o.height&&0===t.rotate,!0;}}]);}();var fragment="varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",vertex="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n";var _SpriteMaskFilter=/*#__PURE__*/function(_Filter3){function _SpriteMaskFilter(e,t,r){var _this51;_classCallCheck2(this,_SpriteMaskFilter);var n=null;"string"!=typeof e&&void 0===t&&void 0===r&&(n=e,e=void 0,t=void 0,r=void 0),_this51=_callSuper2(this,_SpriteMaskFilter,[e||vertex,t||fragment,r]),_this51.maskSprite=n,_this51.maskMatrix=new _Matrix();return _this51;}_inherits2(_SpriteMaskFilter,_Filter3);return _createClass2(_SpriteMaskFilter,[{key:"maskSprite",get:function get(){return this._maskSprite;},set:function set(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1);}},{key:"apply",value:function apply(e,t,r,n){var i=this._maskSprite,o=i._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new _TextureMatrix(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,i).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,t,r,n));}}]);}(_Filter2);var _MaskData=/*#__PURE__*/function(){function _MaskData(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;_classCallCheck2(this,_MaskData);this.type=_MASK_TYPES.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=_Filter2.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null;}return _createClass2(_MaskData,[{key:"filter",get:function get(){return this._filters?this._filters[0]:null;},set:function set(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null;}},{key:"reset",value:function reset(){this.pooled&&(this.maskObject=null,this.type=_MASK_TYPES.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null;}},{key:"copyCountersOrReset",value:function copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null);}}]);}();var _MaskSystem=/*#__PURE__*/function(){function _MaskSystem(e){_classCallCheck2(this,_MaskSystem);this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0;}return _createClass2(_MaskSystem,[{key:"setMaskStack",value:function setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e);}},{key:"push",value:function push(e,t){var r=t;if(!r.isMaskData){var _e342=this.maskDataPool.pop()||new _MaskData();_e342.pooled=!0,_e342.maskObject=t,r=_e342;}var n=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(n),r._colorMask=n?n._colorMask:15,r.autoDetect&&this.detect(r),r._target=e,r.type!==_MASK_TYPES.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case _MASK_TYPES.SCISSOR:this.renderer.scissor.push(r);break;case _MASK_TYPES.STENCIL:this.renderer.stencil.push(r);break;case _MASK_TYPES.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case _MASK_TYPES.COLOR:this.pushColorMask(r);}r.type===_MASK_TYPES.SPRITE&&this.maskStack.push(r);}},{key:"pop",value:function pop(e){var t=this.maskStack.pop();if(t&&t._target===e){if(t.enabled)switch(t.type){case _MASK_TYPES.SCISSOR:this.renderer.scissor.pop(t);break;case _MASK_TYPES.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case _MASK_TYPES.SPRITE:this.popSpriteMask(t);break;case _MASK_TYPES.COLOR:this.popColorMask(t);}if(t.reset(),t.pooled&&this.maskDataPool.push(t),0!==this.maskStack.length){var _e343=this.maskStack[this.maskStack.length-1];_e343.type===_MASK_TYPES.SPRITE&&_e343._filters&&(_e343._filters[0].maskSprite=_e343.maskObject);}}}},{key:"detect",value:function detect(e){var t=e.maskObject;t?t.isSprite?e.type=_MASK_TYPES.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=_MASK_TYPES.SCISSOR:e.type=_MASK_TYPES.STENCIL:e.type=_MASK_TYPES.COLOR;}},{key:"pushSpriteMask",value:function pushSpriteMask(e){var t=e.maskObject,r=e._target;var n=e._filters;n||(n=this.alphaMaskPool[this.alphaMaskIndex],n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new _SpriteMaskFilter()])),n[0].resolution=e.resolution,n[0].multisample=e.multisample,n[0].maskSprite=t;var i=r.filterArea;r.filterArea=t.getBounds(!0),this.renderer.filter.push(r,n),r.filterArea=i,e._filters||this.alphaMaskIndex++;}},{key:"popSpriteMask",value:function popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null);}},{key:"pushColorMask",value:function pushColorMask(e){var t=e._colorMask,r=e._colorMask=t&e.colorMask;r!==t&&this.renderer.gl.colorMask(!!(1&r),!!(2&r),!!(4&r),!!(8&r));}},{key:"popColorMask",value:function popColorMask(e){var t=e._colorMask,r=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;r!==t&&this.renderer.gl.colorMask(!!(1&r),!!(2&r),!!(4&r),!!(8&r));}},{key:"destroy",value:function destroy(){this.renderer=null;}}]);}();_MaskSystem.extension={type:_ExtensionType.RendererSystem,name:"mask"},_extensions.add(_MaskSystem);var AbstractMaskSystem=/*#__PURE__*/function(){function AbstractMaskSystem(e){_classCallCheck2(this,AbstractMaskSystem);this.renderer=e,this.maskStack=[],this.glConst=0;}return _createClass2(AbstractMaskSystem,[{key:"getStackLength",value:function getStackLength(){return this.maskStack.length;}},{key:"setMaskStack",value:function setMaskStack(e){var t=this.renderer.gl,r=this.getStackLength();this.maskStack=e;var n=this.getStackLength();n!==r&&(0===n?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()));}},{key:"_useCurrent",value:function _useCurrent(){}},{key:"destroy",value:function destroy(){this.renderer=null,this.maskStack=null;}}]);}();var ScissorSystem_tempMatrix=new _Matrix(),rectPool=[],_ScissorSystem=/*#__PURE__*/function(_AbstractMaskSystem){function e(_e344){var _this52;_classCallCheck2(this,e);_this52=_callSuper2(this,e,[_e344]),_this52.glConst=_settings.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST;return _this52;}_inherits2(e,_AbstractMaskSystem);return _createClass2(e,[{key:"getStackLength",value:function getStackLength(){var _e345=this.maskStack[this.maskStack.length-1];return _e345?_e345._scissorCounter:0;}},{key:"calcScissorRect",value:function calcScissorRect(_e346){var _rectPool$pop;if(_e346._scissorRectLocal)return;var t=_e346._scissorRect,r=_e346.maskObject,n=this.renderer,i=n.renderTexture,o=r.getBounds(!0,(_rectPool$pop=rectPool.pop())!==null&&_rectPool$pop!==void 0?_rectPool$pop:new _Rectangle());this.roundFrameToPixels(o,i.current?i.current.resolution:n.resolution,i.sourceFrame,i.destinationFrame,n.projection.transform),t&&o.fit(t),_e346._scissorRectLocal=o;}},{key:"testScissor",value:function testScissor(t){var r=t.maskObject;if(!r.isFastRect||!r.isFastRect()||e.isMatrixRotated(r.worldTransform)||e.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);var n=t._scissorRectLocal;return n.width>0&&n.height>0;}},{key:"roundFrameToPixels",value:function roundFrameToPixels(t,r,n,i,o){e.isMatrixRotated(o)||((o=o?ScissorSystem_tempMatrix.copyFrom(o):ScissorSystem_tempMatrix.identity()).translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.renderer.filter.transformAABB(o,t),t.fit(i),t.x=Math.round(t.x*r),t.y=Math.round(t.y*r),t.width=Math.round(t.width*r),t.height=Math.round(t.height*r));}},{key:"push",value:function push(_e348){_e348._scissorRectLocal||this.calcScissorRect(_e348);var t=this.renderer.gl;_e348._scissorRect||t.enable(t.SCISSOR_TEST),_e348._scissorCounter++,_e348._scissorRect=_e348._scissorRectLocal,this._useCurrent();}},{key:"pop",value:function pop(_e349){var t=this.renderer.gl;_e349&&rectPool.push(_e349._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST);}},{key:"_useCurrent",value:function _useCurrent(){var _e350=this.maskStack[this.maskStack.length-1]._scissorRect;var t;t=this.renderer.renderTexture.current?_e350.y:this.renderer.height-_e350.height-_e350.y,this.renderer.gl.scissor(_e350.x,t,_e350.width,_e350.height);}}],[{key:"isMatrixRotated",value:function isMatrixRotated(_e347){if(!_e347)return!1;var t=_e347.a,r=_e347.b,n=_e347.c,i=_e347.d;return(Math.abs(r)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(i)>1e-4);}}]);}(AbstractMaskSystem);_ScissorSystem.extension={type:_ExtensionType.RendererSystem,name:"scissor"};var _ScissorSystem2=_ScissorSystem;_extensions.add(_ScissorSystem2);var _StencilSystem=/*#__PURE__*/function(_AbstractMaskSystem2){function _StencilSystem(e){var _this53;_classCallCheck2(this,_StencilSystem);_this53=_callSuper2(this,_StencilSystem,[e]),_this53.glConst=_settings.ADAPTER.getWebGLRenderingContext().STENCIL_TEST;return _this53;}_inherits2(_StencilSystem,_AbstractMaskSystem2);return _createClass2(_StencilSystem,[{key:"getStackLength",value:function getStackLength(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0;}},{key:"push",value:function push(e){var t=e.maskObject,r=this.renderer.gl,n=e._stencilCounter;0===n&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),e._stencilCounter++;var i=e._colorMask;0!==i&&(e._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,n,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==i&&(e._colorMask=i,r.colorMask(!!(1&i),!!(2&i),!!(4&i),!!(8&i))),this._useCurrent();}},{key:"pop",value:function pop(e){var t=this.renderer.gl;if(0===this.getStackLength())t.disable(t.STENCIL_TEST);else{var r=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,_n114=r?r._colorMask:15;0!==_n114&&(r._colorMask=0,t.colorMask(!1,!1,!1,!1)),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==_n114&&(r._colorMask=_n114,t.colorMask(!!(1&_n114),!!(2&_n114),!!(4&_n114),!!(8&_n114))),this._useCurrent();}}},{key:"_useCurrent",value:function _useCurrent(){var e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP);}}]);}(AbstractMaskSystem);_StencilSystem.extension={type:_ExtensionType.RendererSystem,name:"stencil"},_extensions.add(_StencilSystem);var _PluginSystem=/*#__PURE__*/function(){function _PluginSystem(e){_classCallCheck2(this,_PluginSystem);this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get:function get(){return _deprecation("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract;}},prepare:{enumerable:!1,get:function get(){return _deprecation("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare;}},interaction:{enumerable:!1,get:function get(){return _deprecation("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events;}}});}return _createClass2(_PluginSystem,[{key:"init",value:function init(){var e=this.rendererPlugins;for(var _t178 in e)this.plugins[_t178]=new e[_t178](this.renderer);}},{key:"destroy",value:function destroy(){for(var _e351 in this.plugins)this.plugins[_e351].destroy(),this.plugins[_e351]=null;}}]);}();_PluginSystem.extension={type:[_ExtensionType.RendererSystem,_ExtensionType.CanvasRendererSystem],name:"_plugin"},_extensions.add(_PluginSystem);var _ProjectionSystem=/*#__PURE__*/function(){function _ProjectionSystem(e){_classCallCheck2(this,_ProjectionSystem);this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new _Matrix(),this.transform=null;}return _createClass2(_ProjectionSystem,[{key:"update",value:function update(e,t,r,n){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,n),this.transform&&this.projectionMatrix.append(this.transform);var i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals);}},{key:"calculateProjection",value:function calculateProjection(e,t,r,n){var i=this.projectionMatrix,o=n?-1:1;i.identity(),i.a=1/t.width*2,i.d=o*(1/t.height*2),i.tx=-1-t.x*i.a,i.ty=-o-t.y*i.d;}},{key:"setTransform",value:function setTransform(e){}},{key:"destroy",value:function destroy(){this.renderer=null;}}]);}();_ProjectionSystem.extension={type:_ExtensionType.RendererSystem,name:"projection"},_extensions.add(_ProjectionSystem);var tempTransform=new _Transform2(),tempRect=new _Rectangle();var _GenerateTextureSystem=/*#__PURE__*/function(){function _GenerateTextureSystem(e){_classCallCheck2(this,_GenerateTextureSystem);this.renderer=e,this._tempMatrix=new _Matrix();}return _createClass2(_GenerateTextureSystem,[{key:"generateTexture",value:function generateTexture(e,t){var _n$multisample;var _ref35=t||{},r=_ref35.region,n=_objectWithoutProperties(_ref35,_excluded),i=(r===null||r===void 0?void 0:r.copyTo(tempRect))||e.getLocalBounds(tempRect,!0),o=n.resolution||this.renderer.resolution;i.width=Math.max(i.width,1/o),i.height=Math.max(i.height,1/o),n.width=i.width,n.height=i.height,n.resolution=o,(_n$multisample=n.multisample)!==null&&_n$multisample!==void 0?_n$multisample:n.multisample=this.renderer.multisample;var a=_RenderTexture.create(n);this._tempMatrix.tx=-i.x,this._tempMatrix.ty=-i.y;var s=e.transform;return e.transform=tempTransform,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=s,a;}},{key:"destroy",value:function destroy(){}}]);}();_GenerateTextureSystem.extension={type:[_ExtensionType.RendererSystem,_ExtensionType.CanvasRendererSystem],name:"textureGenerator"},_extensions.add(_GenerateTextureSystem);var RenderTextureSystem_tempRect=new _Rectangle(),tempRect2=new _Rectangle();var _RenderTextureSystem=/*#__PURE__*/function(){function _RenderTextureSystem(e){_classCallCheck2(this,_RenderTextureSystem);this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new _Rectangle(),this.destinationFrame=new _Rectangle(),this.viewportFrame=new _Rectangle();}return _createClass2(_RenderTextureSystem,[{key:"contextChange",value:function contextChange(){var _this$renderer4;var e=(_this$renderer4=this.renderer)===null||_this$renderer4===void 0?void 0:_this$renderer4.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha);}},{key:"bind",value:function bind(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var t=arguments.length>1?arguments[1]:undefined;var r=arguments.length>2?arguments[2]:undefined;var n=this.renderer;var i,o,a;this.current=e,e?(i=e.baseTexture,a=i.resolution,t||(RenderTextureSystem_tempRect.width=e.frame.width,RenderTextureSystem_tempRect.height=e.frame.height,t=RenderTextureSystem_tempRect),r||(tempRect2.x=e.frame.x,tempRect2.y=e.frame.y,tempRect2.width=t.width,tempRect2.height=t.height,r=tempRect2),o=i.framebuffer):(a=n.resolution,t||(RenderTextureSystem_tempRect.width=n._view.screen.width,RenderTextureSystem_tempRect.height=n._view.screen.height,t=RenderTextureSystem_tempRect),r||((r=RenderTextureSystem_tempRect).width=t.width,r.height=t.height));var s=this.viewportFrame;s.x=r.x*a,s.y=r.y*a,s.width=r.width*a,s.height=r.height*a,e||(s.y=n.view.height-(s.y+s.height)),s.ceil(),this.renderer.framebuffer.bind(o,s),this.renderer.projection.update(r,t,a,!o),e?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(r);}},{key:"clear",value:function clear(e,t){var r=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,n=_Color2.shared.setValue(e||r);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&n.premultiply(n.alpha);var i=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=i.width!==o.width||i.height!==o.height;if(a){var _this$viewportFrame=this.viewportFrame,_e352=_this$viewportFrame.x,_t179=_this$viewportFrame.y,_r193=_this$viewportFrame.width,_n115=_this$viewportFrame.height;_e352=Math.round(_e352),_t179=Math.round(_t179),_r193=Math.round(_r193),_n115=Math.round(_n115),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(_e352,_t179,_r193,_n115);}this.renderer.framebuffer.clear(n.red,n.green,n.blue,n.alpha,t),a&&this.renderer.scissor.pop();}},{key:"resize",value:function resize(){this.bind(null);}},{key:"reset",value:function reset(){this.bind(null);}},{key:"destroy",value:function destroy(){this.renderer=null;}}]);}();_RenderTextureSystem.extension={type:_ExtensionType.RendererSystem,name:"renderTexture"},_extensions.add(_RenderTextureSystem);var _IGLUniformData=/*#__PURE__*/_createClass2(function _IGLUniformData(){_classCallCheck2(this,_IGLUniformData);});var _GLProgram=/*#__PURE__*/function(){function _GLProgram(e,t){_classCallCheck2(this,_GLProgram);this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={};}return _createClass2(_GLProgram,[{key:"destroy",value:function destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null;}}]);}();function compileShader(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n;}function booleanArray(e){var t=new Array(e);for(var _e353=0;_e353<t.length;_e353++)t[_e353]=!1;return t;}function defaultValue(e,t){switch(e){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return booleanArray(2*t);case"bvec3":return booleanArray(3*t);case"bvec4":return booleanArray(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);}return null;}function getAttributeData(e,t){var r={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(var _i87=0;_i87<n;_i87++){var _n116=t.getActiveAttrib(e,_i87);if(_n116.name.startsWith("gl_"))continue;var _o59=mapType(t,_n116.type),_a39={type:_o59,name:_n116.name,size:mapSize(_o59),location:t.getAttribLocation(e,_n116.name)};r[_n116.name]=_a39;}return r;}function getUniformData(e,t){var r={},n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(var _i88=0;_i88<n;_i88++){var _n117=t.getActiveUniform(e,_i88),_o60=_n117.name.replace(/\[.*?\]$/,""),_a40=!!_n117.name.match(/\[.*?\]$/),_s32=mapType(t,_n117.type);r[_o60]={name:_o60,index:_i88,type:_s32,size:_n117.size,isArray:_a40,value:defaultValue(_s32,_n117.size)};}return r;}function logPrettyShaderError(e,t){var _console;var r=e.getShaderSource(t).split("\n").map(function(e,t){return"".concat(t,": ").concat(e);}),n=e.getShaderInfoLog(t),i=n.split("\n"),o={},a=i.map(function(e){return parseFloat(e.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"));}).filter(function(e){return!(!e||o[e])&&(o[e]=!0,!0);}),s=[""];a.forEach(function(e){r[e-1]="%c".concat(r[e-1],"%c"),s.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px");});var u=r.join("\n");s[0]=u,console.error(n),console.groupCollapsed("click to view full shader code"),(_console=console).warn.apply(_console,s),console.groupEnd();}function logProgramError(e,t,r,n){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(r,e.COMPILE_STATUS)||logPrettyShaderError(e,r),e.getShaderParameter(n,e.COMPILE_STATUS)||logPrettyShaderError(e,n),console.error("PixiJS Error: Could not initialize shader."),""!==e.getProgramInfoLog(t)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)));}function _generateProgram(e,t){var _t$extra;var r=compileShader(e,e.VERTEX_SHADER,t.vertexSrc),n=compileShader(e,e.FRAGMENT_SHADER,t.fragmentSrc),i=e.createProgram();e.attachShader(i,r),e.attachShader(i,n);var o=(_t$extra=t.extra)===null||_t$extra===void 0?void 0:_t$extra.transformFeedbackVaryings;if(o&&("function"!=typeof e.transformFeedbackVaryings?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(i,o.names,"separate"===o.bufferMode?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS)||logProgramError(e,i,r,n),t.attributeData=getAttributeData(i,e),t.uniformData=getUniformData(i,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){var _r194=Object.keys(t.attributeData);_r194.sort(function(e,t){return e>t?1:-1;});for(var _n118=0;_n118<_r194.length;_n118++)t.attributeData[_r194[_n118]].location=_n118,e.bindAttribLocation(i,_n118,_r194[_n118]);e.linkProgram(i);}e.deleteShader(r),e.deleteShader(n);var a={};for(var _r195 in t.uniformData){var _n119=t.uniformData[_r195];a[_r195]={location:e.getUniformLocation(i,_r195),value:defaultValue(_n119.type,_n119.size)};}return new _GLProgram(i,a);}function uboUpdate(e,t,r,n,i){r.buffer.update(i);}var UBO_TO_SINGLE_SETTERS={"float":"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},GLSL_TO_STD40_SIZE={"float":4,vec2:8,vec3:12,vec4:16,"int":4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function _createUBOElements(e){var t=e.map(function(e){return{data:e,offset:0,dataLen:0,dirty:0};});var r=0,n=0,i=0;for(var _e354=0;_e354<t.length;_e354++){var _o61=t[_e354];if(r=GLSL_TO_STD40_SIZE[_o61.data.type],_o61.data.size>1&&(r=Math.max(r,16)*_o61.data.size),_o61.dataLen=r,n%r!=0&&n<16){var _e355=n%r%16;n+=_e355,i+=_e355;}n+r>16?(i=16*Math.ceil(i/16),_o61.offset=i,i+=r,n=r):(_o61.offset=i,n+=r,i+=r);}return i=16*Math.ceil(i/16),{uboElements:t,size:i};}function _getUBOData(e,t){var r=[];for(var _n120 in e)t[_n120]&&r.push(t[_n120]);return r.sort(function(e,t){return e.index-t.index;}),r;}function _generateUniformBufferSync(e,t){if(!e.autoManage)return{size:0,syncFunc:uboUpdate};var r=_getUBOData(e.uniforms,t),_createUBOElements2=_createUBOElements(r),n=_createUBOElements2.uboElements,i=_createUBOElements2.size,o=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "];for(var _t180=0;_t180<n.length;_t180++){var _r196=n[_t180],_i89=e.uniforms[_r196.data.name],_a41=_r196.data.name;var _s33=!1;for(var _e356=0;_e356<_uniformParsers.length;_e356++){var _t181=_uniformParsers[_e356];if(_t181.codeUbo&&_t181.test(_r196.data,_i89)){o.push("offset = ".concat(_r196.offset/4,";"),_uniformParsers[_e356].codeUbo(_r196.data.name,_i89)),_s33=!0;break;}}if(!_s33)if(_r196.data.size>1){var _e357=mapSize(_r196.data.type),_t182=Math.max(GLSL_TO_STD40_SIZE[_r196.data.type]/16,1),_n121=_e357/_t182,_i90=(4-_n121%4)%4;o.push("\n                cv = ud.".concat(_a41,".value;\n                v = uv.").concat(_a41,";\n                offset = ").concat(_r196.offset/4,";\n\n                t = 0;\n\n                for(var i=0; i < ").concat(_r196.data.size*_t182,"; i++)\n                {\n                    for(var j = 0; j < ").concat(_n121,"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += ").concat(_i90,";\n                }\n\n                "));}else{var _e358=UBO_TO_SINGLE_SETTERS[_r196.data.type];o.push("\n                cv = ud.".concat(_a41,".value;\n                v = uv.").concat(_a41,";\n                offset = ").concat(_r196.offset/4,";\n                ").concat(_e358,";\n                "));}}return o.push("\n       renderer.buffer.update(buffer);\n    "),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join("\n"))};}var unsafeEval;function _unsafeEvalSupported(){if("boolean"==typeof unsafeEval)return unsafeEval;try{unsafeEval=!0===new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b");}catch(_unused14){unsafeEval=!1;}return unsafeEval;}var ShaderSystem_UID=0;var defaultSyncData={textureCount:0,uboCount:0};var _ShaderSystem=/*#__PURE__*/function(){function _ShaderSystem(e){_classCallCheck2(this,_ShaderSystem);this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=ShaderSystem_UID++;}return _createClass2(_ShaderSystem,[{key:"systemCheck",value:function systemCheck(){if(!_unsafeEvalSupported())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.");}},{key:"contextChange",value:function contextChange(e){this.gl=e,this.reset();}},{key:"bind",value:function bind(e,t){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;var r=e.program,n=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==r&&(this.program=r,this.gl.useProgram(n.program)),t||(defaultSyncData.textureCount=0,defaultSyncData.uboCount=0,this.syncUniformGroup(e.uniformGroup,defaultSyncData)),n;}},{key:"setUniforms",value:function setUniforms(e){var t=this.shader.program,r=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(r.uniformData,e,this.renderer);}},{key:"syncUniformGroup",value:function syncUniformGroup(e,t){var r=this.getGlProgram();(!e["static"]||e.dirtyId!==r.uniformDirtyGroups[e.id])&&(r.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,r,t));}},{key:"syncUniforms",value:function syncUniforms(e,t,r){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,r);}},{key:"createSyncGroups",value:function createSyncGroups(e){var t=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[t]||(this.cache[t]=generateUniformsSync(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id];}},{key:"syncUniformBufferGroup",value:function syncUniformBufferGroup(e,t){var r=this.getGlProgram();if(!e["static"]||0!==e.dirtyId||!r.uniformGroups[e.id]){e.dirtyId=0;var _n122=r.uniformGroups[e.id]||this.createSyncBufferGroup(e,r,t);e.buffer.update(),_n122(r.uniformData,e.uniforms,this.renderer,defaultSyncData,e.buffer);}this.renderer.buffer.bindBufferBase(e.buffer,r.uniformBufferBindings[t]);}},{key:"createSyncBufferGroup",value:function createSyncBufferGroup(e,t,r){var n=this.renderer.gl;this.renderer.buffer.bind(e.buffer);var i=this.gl.getUniformBlockIndex(t.program,r);t.uniformBufferBindings[r]=this.shader.uniformBindCount,n.uniformBlockBinding(t.program,i,this.shader.uniformBindCount),this.shader.uniformBindCount++;var o=this.getSignature(e,this.shader.program.uniformData,"ubo");var a=this._uboCache[o];if(a||(a=this._uboCache[o]=_generateUniformBufferSync(e,this.shader.program.uniformData)),e.autoManage){var _t183=new Float32Array(a.size/4);e.buffer.update(_t183);}return t.uniformGroups[e.id]=a.syncFunc,t.uniformGroups[e.id];}},{key:"getSignature",value:function getSignature(e,t,r){var n=e.uniforms,i=["".concat(r,"-")];for(var _e359 in n)i.push(_e359),t[_e359]&&i.push(t[_e359].type);return i.join("-");}},{key:"getGlProgram",value:function getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null;}},{key:"generateProgram",value:function generateProgram(e){var t=this.gl,r=e.program,n=_generateProgram(t,r);return r.glPrograms[this.renderer.CONTEXT_UID]=n,n;}},{key:"reset",value:function reset(){this.program=null,this.shader=null;}},{key:"disposeShader",value:function disposeShader(e){this.shader===e&&(this.shader=null);}},{key:"destroy",value:function destroy(){this.renderer=null,this.destroyed=!0;}}]);}();_ShaderSystem.extension={type:_ExtensionType.RendererSystem,name:"shader"},_extensions.add(_ShaderSystem);var _StartupSystem=/*#__PURE__*/function(){function _StartupSystem(e){_classCallCheck2(this,_StartupSystem);this.renderer=e;}return _createClass2(_StartupSystem,[{key:"run",value:function run(e){var t=this.renderer;t.runners.init.emit(t.options),e.hello&&console.log("PixiJS 7.4.2 - ".concat(t.rendererLogId," - https://pixijs.com")),t.resize(t.screen.width,t.screen.height);}},{key:"destroy",value:function destroy(){}}]);}();function mapWebGLBlendModesToPixi(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return t[_BLEND_MODES.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.ADD]=[e.ONE,e.ONE],t[_BLEND_MODES.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.NONE]=[0,0],t[_BLEND_MODES.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[_BLEND_MODES.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[_BLEND_MODES.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[_BLEND_MODES.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[_BLEND_MODES.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[_BLEND_MODES.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[_BLEND_MODES.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[_BLEND_MODES.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t;}_StartupSystem.defaultOptions={hello:!1},_StartupSystem.extension={type:[_ExtensionType.RendererSystem,_ExtensionType.CanvasRendererSystem],name:"startup"},_extensions.add(_StartupSystem);var StateSystem_BLEND=0,StateSystem_OFFSET=1,StateSystem_CULLING=2,StateSystem_DEPTH_TEST=3,StateSystem_WINDING=4,StateSystem_DEPTH_MASK=5,_StateSystem=/*#__PURE__*/function(){function e(){_classCallCheck2(this,e);this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=_BLEND_MODES.NONE,this._blendEq=!1,this.map=[],this.map[StateSystem_BLEND]=this.setBlend,this.map[StateSystem_OFFSET]=this.setOffset,this.map[StateSystem_CULLING]=this.setCullFace,this.map[StateSystem_DEPTH_TEST]=this.setDepthTest,this.map[StateSystem_WINDING]=this.setFrontFace,this.map[StateSystem_DEPTH_MASK]=this.setDepthMask,this.checks=[],this.defaultState=new _State(),this.defaultState.blend=!0;}return _createClass2(e,[{key:"contextChange",value:function contextChange(_e360){this.gl=_e360,this.blendModes=mapWebGLBlendModesToPixi(_e360),this.set(this.defaultState),this.reset();}},{key:"set",value:function set(_e361){if(_e361=_e361||this.defaultState,this.stateId!==_e361.data){var _t184=this.stateId^_e361.data,r=0;for(;_t184;)1&_t184&&this.map[r].call(this,!!(_e361.data&1<<r)),_t184>>=1,r++;this.stateId=_e361.data;}for(var _t185=0;_t185<this.checks.length;_t185++)this.checks[_t185](this,_e361);}},{key:"forceState",value:function forceState(_e362){_e362=_e362||this.defaultState;for(var _t186=0;_t186<this.map.length;_t186++)this.map[_t186].call(this,!!(_e362.data&1<<_t186));for(var _t187=0;_t187<this.checks.length;_t187++)this.checks[_t187](this,_e362);this.stateId=_e362.data;}},{key:"setBlend",value:function setBlend(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND);}},{key:"setOffset",value:function setOffset(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL);}},{key:"setDepthTest",value:function setDepthTest(_e363){this.gl[_e363?"enable":"disable"](this.gl.DEPTH_TEST);}},{key:"setDepthMask",value:function setDepthMask(_e364){this.gl.depthMask(_e364);}},{key:"setCullFace",value:function setCullFace(_e365){this.gl[_e365?"enable":"disable"](this.gl.CULL_FACE);}},{key:"setFrontFace",value:function setFrontFace(_e366){this.gl.frontFace(this.gl[_e366?"CW":"CCW"]);}},{key:"setBlendMode",value:function setBlendMode(_e367){if(_e367===this.blendMode)return;this.blendMode=_e367;var t=this.blendModes[_e367],r=this.gl;2===t.length?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD));}},{key:"setPolygonOffset",value:function setPolygonOffset(_e368,t){this.gl.polygonOffset(_e368,t);}},{key:"reset",value:function reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0);}},{key:"updateCheck",value:function updateCheck(_e369,t){var r=this.checks.indexOf(_e369);t&&-1===r?this.checks.push(_e369):!t&&-1!==r&&this.checks.splice(r,1);}},{key:"destroy",value:function destroy(){this.gl=null;}}],[{key:"checkBlendMode",value:function checkBlendMode(_e370,t){_e370.setBlendMode(t.blendMode);}},{key:"checkPolygonOffset",value:function checkPolygonOffset(_e371,t){_e371.setPolygonOffset(1,t.polygonOffset);}}]);}();_StateSystem.extension={type:_ExtensionType.RendererSystem,name:"state"};var _StateSystem2=_StateSystem;_extensions.add(_StateSystem2);var _SystemManager=/*#__PURE__*/function(_utils_node_modules_e3){function _SystemManager(){var _this54;_classCallCheck2(this,_SystemManager);_this54=_callSuper2(this,_SystemManager,arguments),_this54.runners={},_this54._systemsHash={};return _this54;}_inherits2(_SystemManager,_utils_node_modules_e3);return _createClass2(_SystemManager,[{key:"setup",value:function setup(e){var _e$priority;this.addRunners.apply(this,_toConsumableArray2(e.runners));var t=((_e$priority=e.priority)!==null&&_e$priority!==void 0?_e$priority:[]).filter(function(t){return e.systems[t];}),r=[].concat(_toConsumableArray2(t),_toConsumableArray2(Object.keys(e.systems).filter(function(e){return!t.includes(e);})));var _iterator44=_createForOfIteratorHelper2(r),_step44;try{for(_iterator44.s();!(_step44=_iterator44.n()).done;){var _t188=_step44.value;this.addSystem(e.systems[_t188],_t188);}}catch(err){_iterator44.e(err);}finally{_iterator44.f();}}},{key:"addRunners",value:function addRunners(){var _this55=this;for(var _len6=arguments.length,e=new Array(_len6),_key6=0;_key6<_len6;_key6++){e[_key6]=arguments[_key6];}e.forEach(function(e){_this55.runners[e]=new _Runner(e);});}},{key:"addSystem",value:function addSystem(e,t){var r=new e(this);if(this[t])throw new Error("Whoops! The name \"".concat(t,"\" is already in use"));this[t]=r,this._systemsHash[t]=r;for(var _e372 in this.runners)this.runners[_e372].add(r);return this;}},{key:"emitWithCustomOptions",value:function emitWithCustomOptions(e,t){var _this56=this;var r=Object.keys(this._systemsHash);e.items.forEach(function(n){var i=r.find(function(e){return _this56._systemsHash[e]===n;});n[e.name](t[i]);});}},{key:"destroy",value:function destroy(){Object.values(this.runners).forEach(function(e){e.destroy();}),this._systemsHash={};}}]);}(utils_node_modules_eventemitter3);var _TextureGCSystem=/*#__PURE__*/function(){function e(t){_classCallCheck2(this,e);this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=e.defaultMaxIdle,this.checkCountMax=e.defaultCheckCountMax,this.mode=e.defaultMode;}return _createClass2(e,[{key:"postrender",value:function postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==_GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())));}},{key:"run",value:function run(){var _e373=this.renderer.texture,t=_e373.managedTextures;var r=!1;for(var _n123=0;_n123<t.length;_n123++){var _i91=t[_n123];_i91.resource&&this.count-_i91.touched>this.maxIdle&&(_e373.destroyTexture(_i91,!0),t[_n123]=null,r=!0);}if(r){var _e374=0;for(var _r197=0;_r197<t.length;_r197++)null!==t[_r197]&&(t[_e374++]=t[_r197]);t.length=_e374;}}},{key:"unload",value:function unload(_e375){var t=this.renderer.texture,r=_e375._texture;r&&!r.framebuffer&&t.destroyTexture(r);for(var _t189=_e375.children.length-1;_t189>=0;_t189--)this.unload(_e375.children[_t189]);}},{key:"destroy",value:function destroy(){this.renderer=null;}}]);}();_TextureGCSystem.defaultMode=_GC_MODES.AUTO,_TextureGCSystem.defaultMaxIdle=3600,_TextureGCSystem.defaultCheckCountMax=600,_TextureGCSystem.extension={type:_ExtensionType.RendererSystem,name:"textureGC"};var _TextureGCSystem2=_TextureGCSystem;_extensions.add(_TextureGCSystem2);var _GLTexture=/*#__PURE__*/_createClass2(function _GLTexture(e){_classCallCheck2(this,_GLTexture);this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=_TYPES.UNSIGNED_BYTE,this.internalFormat=_FORMATS.RGBA,this.samplerType=0;});function mapInternalFormatToSamplerType(e){var _ref36;var t;return t="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?(_ref36={},_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_ref36,e.RGB,_SAMPLER_TYPES.FLOAT),e.RGBA,_SAMPLER_TYPES.FLOAT),e.ALPHA,_SAMPLER_TYPES.FLOAT),e.LUMINANCE,_SAMPLER_TYPES.FLOAT),e.LUMINANCE_ALPHA,_SAMPLER_TYPES.FLOAT),e.R8,_SAMPLER_TYPES.FLOAT),e.R8_SNORM,_SAMPLER_TYPES.FLOAT),e.RG8,_SAMPLER_TYPES.FLOAT),e.RG8_SNORM,_SAMPLER_TYPES.FLOAT),e.RGB8,_SAMPLER_TYPES.FLOAT),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_ref36,e.RGB8_SNORM,_SAMPLER_TYPES.FLOAT),e.RGB565,_SAMPLER_TYPES.FLOAT),e.RGBA4,_SAMPLER_TYPES.FLOAT),e.RGB5_A1,_SAMPLER_TYPES.FLOAT),e.RGBA8,_SAMPLER_TYPES.FLOAT),e.RGBA8_SNORM,_SAMPLER_TYPES.FLOAT),e.RGB10_A2,_SAMPLER_TYPES.FLOAT),e.RGB10_A2UI,_SAMPLER_TYPES.FLOAT),e.SRGB8,_SAMPLER_TYPES.FLOAT),e.SRGB8_ALPHA8,_SAMPLER_TYPES.FLOAT),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_ref36,e.R16F,_SAMPLER_TYPES.FLOAT),e.RG16F,_SAMPLER_TYPES.FLOAT),e.RGB16F,_SAMPLER_TYPES.FLOAT),e.RGBA16F,_SAMPLER_TYPES.FLOAT),e.R32F,_SAMPLER_TYPES.FLOAT),e.RG32F,_SAMPLER_TYPES.FLOAT),e.RGB32F,_SAMPLER_TYPES.FLOAT),e.RGBA32F,_SAMPLER_TYPES.FLOAT),e.R11F_G11F_B10F,_SAMPLER_TYPES.FLOAT),e.RGB9_E5,_SAMPLER_TYPES.FLOAT),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_ref36,e.R8I,_SAMPLER_TYPES.INT),e.R8UI,_SAMPLER_TYPES.UINT),e.R16I,_SAMPLER_TYPES.INT),e.R16UI,_SAMPLER_TYPES.UINT),e.R32I,_SAMPLER_TYPES.INT),e.R32UI,_SAMPLER_TYPES.UINT),e.RG8I,_SAMPLER_TYPES.INT),e.RG8UI,_SAMPLER_TYPES.UINT),e.RG16I,_SAMPLER_TYPES.INT),e.RG16UI,_SAMPLER_TYPES.UINT),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_ref36,e.RG32I,_SAMPLER_TYPES.INT),e.RG32UI,_SAMPLER_TYPES.UINT),e.RGB8I,_SAMPLER_TYPES.INT),e.RGB8UI,_SAMPLER_TYPES.UINT),e.RGB16I,_SAMPLER_TYPES.INT),e.RGB16UI,_SAMPLER_TYPES.UINT),e.RGB32I,_SAMPLER_TYPES.INT),e.RGB32UI,_SAMPLER_TYPES.UINT),e.RGBA8I,_SAMPLER_TYPES.INT),e.RGBA8UI,_SAMPLER_TYPES.UINT),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_ref36,e.RGBA16I,_SAMPLER_TYPES.INT),e.RGBA16UI,_SAMPLER_TYPES.UINT),e.RGBA32I,_SAMPLER_TYPES.INT),e.RGBA32UI,_SAMPLER_TYPES.UINT),e.DEPTH_COMPONENT16,_SAMPLER_TYPES.FLOAT),e.DEPTH_COMPONENT24,_SAMPLER_TYPES.FLOAT),e.DEPTH_COMPONENT32F,_SAMPLER_TYPES.FLOAT),e.DEPTH_STENCIL,_SAMPLER_TYPES.FLOAT),e.DEPTH24_STENCIL8,_SAMPLER_TYPES.FLOAT),e.DEPTH32F_STENCIL8,_SAMPLER_TYPES.FLOAT)):_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},e.RGB,_SAMPLER_TYPES.FLOAT),e.RGBA,_SAMPLER_TYPES.FLOAT),e.ALPHA,_SAMPLER_TYPES.FLOAT),e.LUMINANCE,_SAMPLER_TYPES.FLOAT),e.LUMINANCE_ALPHA,_SAMPLER_TYPES.FLOAT),e.DEPTH_STENCIL,_SAMPLER_TYPES.FLOAT),t;}function mapTypeAndFormatToInternalFormat(e){var _TYPES$UNSIGNED_BYTE,_ref38;var t;return t="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?(_ref38={},_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_ref38,_TYPES.UNSIGNED_BYTE,(_TYPES$UNSIGNED_BYTE={},_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_TYPES$UNSIGNED_BYTE,_FORMATS.RGBA,e.RGBA8),_FORMATS.RGB,e.RGB8),_FORMATS.RG,e.RG8),_FORMATS.RED,e.R8),_FORMATS.RGBA_INTEGER,e.RGBA8UI),_FORMATS.RGB_INTEGER,e.RGB8UI),_FORMATS.RG_INTEGER,e.RG8UI),_FORMATS.RED_INTEGER,e.R8UI),_FORMATS.ALPHA,e.ALPHA),_FORMATS.LUMINANCE,e.LUMINANCE),_defineProperty(_TYPES$UNSIGNED_BYTE,_FORMATS.LUMINANCE_ALPHA,e.LUMINANCE_ALPHA))),_TYPES.BYTE,_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},_FORMATS.RGBA,e.RGBA8_SNORM),_FORMATS.RGB,e.RGB8_SNORM),_FORMATS.RG,e.RG8_SNORM),_FORMATS.RED,e.R8_SNORM),_FORMATS.RGBA_INTEGER,e.RGBA8I),_FORMATS.RGB_INTEGER,e.RGB8I),_FORMATS.RG_INTEGER,e.RG8I),_FORMATS.RED_INTEGER,e.R8I)),_TYPES.UNSIGNED_SHORT,_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},_FORMATS.RGBA_INTEGER,e.RGBA16UI),_FORMATS.RGB_INTEGER,e.RGB16UI),_FORMATS.RG_INTEGER,e.RG16UI),_FORMATS.RED_INTEGER,e.R16UI),_FORMATS.DEPTH_COMPONENT,e.DEPTH_COMPONENT16)),_TYPES.SHORT,_defineProperty(_defineProperty(_defineProperty(_defineProperty({},_FORMATS.RGBA_INTEGER,e.RGBA16I),_FORMATS.RGB_INTEGER,e.RGB16I),_FORMATS.RG_INTEGER,e.RG16I),_FORMATS.RED_INTEGER,e.R16I)),_TYPES.UNSIGNED_INT,_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},_FORMATS.RGBA_INTEGER,e.RGBA32UI),_FORMATS.RGB_INTEGER,e.RGB32UI),_FORMATS.RG_INTEGER,e.RG32UI),_FORMATS.RED_INTEGER,e.R32UI),_FORMATS.DEPTH_COMPONENT,e.DEPTH_COMPONENT24)),_TYPES.INT,_defineProperty(_defineProperty(_defineProperty(_defineProperty({},_FORMATS.RGBA_INTEGER,e.RGBA32I),_FORMATS.RGB_INTEGER,e.RGB32I),_FORMATS.RG_INTEGER,e.RG32I),_FORMATS.RED_INTEGER,e.R32I)),_TYPES.FLOAT,_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},_FORMATS.RGBA,e.RGBA32F),_FORMATS.RGB,e.RGB32F),_FORMATS.RG,e.RG32F),_FORMATS.RED,e.R32F),_FORMATS.DEPTH_COMPONENT,e.DEPTH_COMPONENT32F)),_TYPES.HALF_FLOAT,_defineProperty(_defineProperty(_defineProperty(_defineProperty({},_FORMATS.RGBA,e.RGBA16F),_FORMATS.RGB,e.RGB16F),_FORMATS.RG,e.RG16F),_FORMATS.RED,e.R16F)),_TYPES.UNSIGNED_SHORT_5_6_5,_defineProperty({},_FORMATS.RGB,e.RGB565)),_TYPES.UNSIGNED_SHORT_4_4_4_4,_defineProperty({},_FORMATS.RGBA,e.RGBA4)),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_ref38,_TYPES.UNSIGNED_SHORT_5_5_5_1,_defineProperty({},_FORMATS.RGBA,e.RGB5_A1)),_TYPES.UNSIGNED_INT_2_10_10_10_REV,_defineProperty(_defineProperty({},_FORMATS.RGBA,e.RGB10_A2),_FORMATS.RGBA_INTEGER,e.RGB10_A2UI)),_TYPES.UNSIGNED_INT_10F_11F_11F_REV,_defineProperty({},_FORMATS.RGB,e.R11F_G11F_B10F)),_TYPES.UNSIGNED_INT_5_9_9_9_REV,_defineProperty({},_FORMATS.RGB,e.RGB9_E5)),_TYPES.UNSIGNED_INT_24_8,_defineProperty({},_FORMATS.DEPTH_STENCIL,e.DEPTH24_STENCIL8)),_TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV,_defineProperty({},_FORMATS.DEPTH_STENCIL,e.DEPTH32F_STENCIL8))):_defineProperty(_defineProperty(_defineProperty(_defineProperty({},_TYPES.UNSIGNED_BYTE,_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},_FORMATS.RGBA,e.RGBA),_FORMATS.RGB,e.RGB),_FORMATS.ALPHA,e.ALPHA),_FORMATS.LUMINANCE,e.LUMINANCE),_FORMATS.LUMINANCE_ALPHA,e.LUMINANCE_ALPHA)),_TYPES.UNSIGNED_SHORT_5_6_5,_defineProperty({},_FORMATS.RGB,e.RGB)),_TYPES.UNSIGNED_SHORT_4_4_4_4,_defineProperty({},_FORMATS.RGBA,e.RGBA)),_TYPES.UNSIGNED_SHORT_5_5_5_1,_defineProperty({},_FORMATS.RGBA,e.RGBA)),t;}var _TextureSystem=/*#__PURE__*/function(){function _TextureSystem(e){_classCallCheck2(this,_TextureSystem);this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new _BaseTexture2(),this.hasIntegerTextures=!1;}return _createClass2(_TextureSystem,[{key:"contextChange",value:function contextChange(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=mapTypeAndFormatToInternalFormat(e),this.samplerTypes=mapInternalFormatToSamplerType(e);var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(var _e376=0;_e376<t;_e376++)this.boundTextures[_e376]=null;this.emptyTextures={};var r=new _GLTexture(e.createTexture());e.bindTexture(e.TEXTURE_2D,r.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=r,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new _GLTexture(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(var _t190=0;_t190<6;_t190++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+_t190,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(var _e377=0;_e377<this.boundTextures.length;_e377++)this.bind(null,_e377);}},{key:"bind",value:function bind(e){var _e378,_e379;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r=this.gl;if(e=(_e378=e)===null||_e378===void 0?void 0:_e378.castToBaseTexture(),(_e379=e)!==null&&_e379!==void 0&&_e379.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;var _n124=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(e.target,_n124.texture)),_n124.dirtyId!==e.dirtyId?(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),this.updateTexture(e)):_n124.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[t]=e;}else this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[t]=null;}},{key:"reset",value:function reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var _e380=0;_e380<this.boundTextures.length;_e380++)this.boundTextures[_e380]=this.unknownTexture;}},{key:"unbind",value:function unbind(e){var t=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var _e381=0;_e381<r.length;_e381++)r[_e381]===this.unknownTexture&&this.bind(null,_e381);}for(var _n125=0;_n125<r.length;_n125++)r[_n125]===e&&(this.currentLocation!==_n125&&(t.activeTexture(t.TEXTURE0+_n125),this.currentLocation=_n125),t.bindTexture(e.target,this.emptyTextures[e.target].texture),r[_n125]=null);}},{key:"ensureSamplerType",value:function ensureSamplerType(e){var t=this.boundTextures,r=this.hasIntegerTextures,n=this.CONTEXT_UID;if(r)for(var _r198=e-1;_r198>=0;--_r198){var _e382=t[_r198];_e382&&_e382._glTextures[n].samplerType!==_SAMPLER_TYPES.FLOAT&&this.renderer.texture.unbind(_e382);}}},{key:"initTexture",value:function initTexture(e){var t=new _GLTexture(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t;}},{key:"initTextureType",value:function initTextureType(e,t){var _this$internalFormats,_this$internalFormats2,_this$samplerTypes$t$;t.internalFormat=(_this$internalFormats=(_this$internalFormats2=this.internalFormats[e.type])===null||_this$internalFormats2===void 0?void 0:_this$internalFormats2[e.format])!==null&&_this$internalFormats!==void 0?_this$internalFormats:e.format,t.samplerType=(_this$samplerTypes$t$=this.samplerTypes[t.internalFormat])!==null&&_this$samplerTypes$t$!==void 0?_this$samplerTypes$t$:_SAMPLER_TYPES.FLOAT,2===this.webGLVersion&&e.type===_TYPES.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type;}},{key:"updateTexture",value:function updateTexture(e){var _e$resource;var t=e._glTextures[this.CONTEXT_UID];if(!t)return;var r=this.renderer;if(this.initTextureType(e,t),(_e$resource=e.resource)!==null&&_e$resource!==void 0&&_e$resource.upload(r,e,t))t.samplerType!==_SAMPLER_TYPES.FLOAT&&(this.hasIntegerTextures=!0);else{var _n126=e.realWidth,_i92=e.realHeight,_o62=r.gl;(t.width!==_n126||t.height!==_i92||t.dirtyId<0)&&(t.width=_n126,t.height=_i92,_o62.texImage2D(e.target,0,t.internalFormat,_n126,_i92,0,e.format,t.type,null));}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId;}},{key:"destroyTexture",value:function destroyTexture(e,t){var r=this.gl;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),r.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){var _t191=this.managedTextures.indexOf(e);-1!==_t191&&_removeItems(this.managedTextures,_t191,1);}}},{key:"updateTextureStyle",value:function updateTextureStyle(e){var _e$resource2;var t=e._glTextures[this.CONTEXT_UID];t&&(e.mipmap!==_MIPMAP_MODES.POW2&&2===this.webGLVersion||e.isPowerOfTwo?t.mipmap=e.mipmap>=1:t.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?t.wrapMode=e.wrapMode:t.wrapMode=_WRAP_MODES.CLAMP,(_e$resource2=e.resource)!==null&&_e$resource2!==void 0&&_e$resource2.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId);}},{key:"setStyle",value:function setStyle(e,t){var r=this.gl;if(t.mipmap&&e.mipmap!==_MIPMAP_MODES.ON_MANUAL&&r.generateMipmap(e.target),r.texParameteri(e.target,r.TEXTURE_WRAP_S,t.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===_SCALE_MODES.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var _t192=this.renderer.context.extensions.anisotropicFiltering;if(_t192&&e.anisotropicLevel>0&&e.scaleMode===_SCALE_MODES.LINEAR){var _n127=Math.min(e.anisotropicLevel,r.getParameter(_t192.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(e.target,_t192.TEXTURE_MAX_ANISOTROPY_EXT,_n127);}}else r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===_SCALE_MODES.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,e.scaleMode===_SCALE_MODES.LINEAR?r.LINEAR:r.NEAREST);}},{key:"destroy",value:function destroy(){this.renderer=null;}}]);}();_TextureSystem.extension={type:_ExtensionType.RendererSystem,name:"texture"},_extensions.add(_TextureSystem);var _TransformFeedbackSystem=/*#__PURE__*/function(){function _TransformFeedbackSystem(e){_classCallCheck2(this,_TransformFeedbackSystem);this.renderer=e;}return _createClass2(_TransformFeedbackSystem,[{key:"contextChange",value:function contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID;}},{key:"bind",value:function bind(e){var t=this.gl,r=this.CONTEXT_UID,n=e._glTransformFeedbacks[r]||this.createGLTransformFeedback(e);t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,n);}},{key:"unbind",value:function unbind(){var e=this.gl;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null);}},{key:"beginTransformFeedback",value:function beginTransformFeedback(e,t){var r=this.gl,n=this.renderer;t&&n.shader.bind(t),r.beginTransformFeedback(e);}},{key:"endTransformFeedback",value:function endTransformFeedback(){var e=this.gl;e.endTransformFeedback();}},{key:"createGLTransformFeedback",value:function createGLTransformFeedback(e){var t=this.gl,r=this.renderer,n=this.CONTEXT_UID,i=t.createTransformFeedback();e._glTransformFeedbacks[n]=i,t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,i);for(var _i93=0;_i93<e.buffers.length;_i93++){var _o63=e.buffers[_i93];_o63&&(r.buffer.update(_o63),_o63._glBuffers[n].refCount++,t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,_i93,_o63._glBuffers[n].buffer||null));}return t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),i;}},{key:"disposeTransformFeedback",value:function disposeTransformFeedback(e,t){var r=e._glTransformFeedbacks[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this);var i=this.renderer.buffer;if(i)for(var _r199=0;_r199<e.buffers.length;_r199++){var _n128=e.buffers[_r199];if(!_n128)continue;var _o64=_n128._glBuffers[this.CONTEXT_UID];_o64&&(_o64.refCount--,0===_o64.refCount&&!t&&i.dispose(_n128,t));}r&&(t||n.deleteTransformFeedback(r),delete e._glTransformFeedbacks[this.CONTEXT_UID]);}},{key:"destroy",value:function destroy(){this.renderer=null;}}]);}();_TransformFeedbackSystem.extension={type:_ExtensionType.RendererSystem,name:"transformFeedback"},_extensions.add(_TransformFeedbackSystem);var _ViewSystem=/*#__PURE__*/function(){function _ViewSystem(e){_classCallCheck2(this,_ViewSystem);this.renderer=e;}return _createClass2(_ViewSystem,[{key:"init",value:function init(e){this.screen=new _Rectangle(0,0,e.width,e.height),this.element=e.view||_settings.ADAPTER.createCanvas(),this.resolution=e.resolution||_settings.RESOLUTION,this.autoDensity=!!e.autoDensity;}},{key:"resizeView",value:function resizeView(e,t){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(t*this.resolution);var r=this.element.width/this.resolution,n=this.element.height/this.resolution;this.screen.width=r,this.screen.height=n,this.autoDensity&&(this.element.style.width="".concat(r,"px"),this.element.style.height="".concat(n,"px")),this.renderer.emit("resize",r,n),this.renderer.runners.resize.emit(this.screen.width,this.screen.height);}},{key:"destroy",value:function destroy(e){var _this$element$parentN;e&&(_this$element$parentN=this.element.parentNode)!==null&&_this$element$parentN!==void 0&&_this$element$parentN.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null;}}]);}();_ViewSystem.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},_ViewSystem.extension={type:[_ExtensionType.RendererSystem,_ExtensionType.CanvasRendererSystem],name:"_view"},_extensions.add(_ViewSystem),_settings.PREFER_ENV=_ENV.WEBGL2,_settings.STRICT_TEXTURE_CACHE=!1,_settings.RENDER_OPTIONS=_objectSpread(_objectSpread(_objectSpread(_objectSpread({},_ContextSystem.defaultOptions),_BackgroundSystem.defaultOptions),_ViewSystem.defaultOptions),_StartupSystem.defaultOptions),Object.defineProperties(_settings,{WRAP_MODE:{get:function get(){return _BaseTexture2.defaultOptions.wrapMode;},set:function set(e){_deprecation("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),_BaseTexture2.defaultOptions.wrapMode=e;}},SCALE_MODE:{get:function get(){return _BaseTexture2.defaultOptions.scaleMode;},set:function set(e){_deprecation("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),_BaseTexture2.defaultOptions.scaleMode=e;}},MIPMAP_TEXTURES:{get:function get(){return _BaseTexture2.defaultOptions.mipmap;},set:function set(e){_deprecation("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),_BaseTexture2.defaultOptions.mipmap=e;}},ANISOTROPIC_LEVEL:{get:function get(){return _BaseTexture2.defaultOptions.anisotropicLevel;},set:function set(e){_deprecation("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),_BaseTexture2.defaultOptions.anisotropicLevel=e;}},FILTER_RESOLUTION:{get:function get(){return _deprecation("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),_Filter2.defaultResolution;},set:function set(e){_Filter2.defaultResolution=e;}},FILTER_MULTISAMPLE:{get:function get(){return _deprecation("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),_Filter2.defaultMultisample;},set:function set(e){_Filter2.defaultMultisample=e;}},SPRITE_MAX_TEXTURES:{get:function get(){return _BatchRenderer2.defaultMaxTextures;},set:function set(e){_deprecation("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),_BatchRenderer2.defaultMaxTextures=e;}},SPRITE_BATCH_SIZE:{get:function get(){return _BatchRenderer2.defaultBatchSize;},set:function set(e){_deprecation("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),_BatchRenderer2.defaultBatchSize=e;}},CAN_UPLOAD_SAME_BUFFER:{get:function get(){return _BatchRenderer2.canUploadSameBuffer;},set:function set(e){_deprecation("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),_BatchRenderer2.canUploadSameBuffer=e;}},GC_MODE:{get:function get(){return _TextureGCSystem2.defaultMode;},set:function set(e){_deprecation("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),_TextureGCSystem2.defaultMode=e;}},GC_MAX_IDLE:{get:function get(){return _TextureGCSystem2.defaultMaxIdle;},set:function set(e){_deprecation("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),_TextureGCSystem2.defaultMaxIdle=e;}},GC_MAX_CHECK_COUNT:{get:function get(){return _TextureGCSystem2.defaultCheckCountMax;},set:function set(e){_deprecation("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),_TextureGCSystem2.defaultCheckCountMax=e;}},PRECISION_VERTEX:{get:function get(){return _Program2.defaultVertexPrecision;},set:function set(e){_deprecation("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),_Program2.defaultVertexPrecision=e;}},PRECISION_FRAGMENT:{get:function get(){return _Program2.defaultFragmentPrecision;},set:function set(e){_deprecation("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),_Program2.defaultFragmentPrecision=e;}}});var _UPDATE_PRIORITY=function(e){return e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e;}(_UPDATE_PRIORITY||{});var TickerListener=/*#__PURE__*/function(){function TickerListener(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1;_classCallCheck2(this,TickerListener);this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=r,this.once=n;}return _createClass2(TickerListener,[{key:"match",value:function match(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return this.fn===e&&this.context===t;}},{key:"emit",value:function emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));var t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t;}},{key:"connect",value:function connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this;}},{key:"destroy",value:function destroy(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.next;return this.next=e?null:t,this.previous=null,t;}}]);}();var _Ticker=/*#__PURE__*/function(){function e(){var _this57=this;_classCallCheck2(this,e);this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new TickerListener(null,null,1/0),this.deltaMS=1/e.targetFPMS,this.elapsedMS=1/e.targetFPMS,this._tick=function(_e383){_this57._requestId=null,_this57.started&&(_this57.update(_e383),_this57.started&&null===_this57._requestId&&_this57._head.next&&(_this57._requestId=requestAnimationFrame(_this57._tick)));};}return _createClass2(e,[{key:"_requestIfNeeded",value:function _requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick));}},{key:"_cancelIfNeeded",value:function _cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null);}},{key:"_startIfPossible",value:function _startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start();}},{key:"add",value:function add(_e384,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:_UPDATE_PRIORITY.NORMAL;return this._addListener(new TickerListener(_e384,t,r));}},{key:"addOnce",value:function addOnce(_e385,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:_UPDATE_PRIORITY.NORMAL;return this._addListener(new TickerListener(_e385,t,r,!0));}},{key:"_addListener",value:function _addListener(_e386){var t=this._head.next,r=this._head;if(t){for(;t;){if(_e386.priority>t.priority){_e386.connect(r);break;}r=t,t=t.next;}_e386.previous||_e386.connect(r);}else _e386.connect(r);return this._startIfPossible(),this;}},{key:"remove",value:function remove(_e387,t){var r=this._head.next;for(;r;)r=r.match(_e387,t)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this;}},{key:"count",get:function get(){if(!this._head)return 0;var _e388=0,t=this._head;for(;t=t.next;)_e388++;return _e388;}},{key:"start",value:function start(){this.started||(this.started=!0,this._requestIfNeeded());}},{key:"stop",value:function stop(){this.started&&(this.started=!1,this._cancelIfNeeded());}},{key:"destroy",value:function destroy(){if(!this._protected){this.stop();var _e389=this._head.next;for(;_e389;)_e389=_e389.destroy(!0);this._head.destroy(),this._head=null;}}},{key:"update",value:function update(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:performance.now();var r;if(t>this.lastTime){if(r=this.elapsedMS=t-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){var _e390=t-this._lastFrame|0;if(_e390<this._minElapsedMS)return;this._lastFrame=t-_e390%this._minElapsedMS;}this.deltaMS=r,this.deltaTime=this.deltaMS*e.targetFPMS;var _n129=this._head;var _i94=_n129.next;for(;_i94;)_i94=_i94.emit(this.deltaTime);_n129.next||this._cancelIfNeeded();}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t;}},{key:"FPS",get:function get(){return 1e3/this.elapsedMS;}},{key:"minFPS",get:function get(){return 1e3/this._maxElapsedMS;},set:function set(t){var r=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,r)/1e3,e.targetFPMS);this._maxElapsedMS=1/n;}},{key:"maxFPS",get:function get(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0;},set:function set(_e391){if(0===_e391)this._minElapsedMS=0;else{var _t193=Math.max(this.minFPS,_e391);this._minElapsedMS=1/(_t193/1e3);}}}],[{key:"shared",get:function get(){if(!e._shared){var _t194=e._shared=new e();_t194.autoStart=!0,_t194._protected=!0;}return e._shared;}},{key:"system",get:function get(){if(!e._system){var _t195=e._system=new e();_t195.autoStart=!0,_t195._protected=!0;}return e._system;}}]);}();_Ticker.targetFPMS=.06;var _Ticker2=_Ticker;Object.defineProperties(_settings,{TARGET_FPMS:{get:function get(){return _Ticker2.targetFPMS;},set:function set(e){_deprecation("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),_Ticker2.targetFPMS=e;}}});var _TickerPlugin=/*#__PURE__*/function(){function _TickerPlugin(){_classCallCheck2(this,_TickerPlugin);}return _createClass2(_TickerPlugin,null,[{key:"init",value:function init(e){var _this58=this;e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set:function set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,_UPDATE_PRIORITY.LOW);},get:function get(){return this._ticker;}}),this.stop=function(){_this58._ticker.stop();},this.start=function(){_this58._ticker.start();},this._ticker=null,this.ticker=e.sharedTicker?_Ticker2.shared:new _Ticker2(),e.autoStart&&this.start();}},{key:"destroy",value:function destroy(){if(this._ticker){var _e392=this._ticker;this.ticker=null,_e392.destroy();}}}]);}();_TickerPlugin.extension=_ExtensionType.Application,_extensions.add(_TickerPlugin);var renderers=[];function _autoDetectRenderer(e){var _iterator45=_createForOfIteratorHelper2(renderers),_step45;try{for(_iterator45.s();!(_step45=_iterator45.n()).done;){var _t196=_step45.value;if(_t196.test(e))return new _t196(e);}}catch(err){_iterator45.e(err);}finally{_iterator45.f();}throw new Error("Unable to auto-detect a suitable renderer.");}_extensions.handleByList(_ExtensionType.Renderer,renderers);var $defaultVertex="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",$defaultFilterVertex="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";var fragments_defaultVertex=$defaultVertex,_defaultFilterVertex=$defaultFilterVertex;var _MultisampleSystem=/*#__PURE__*/function(){function _MultisampleSystem(e){_classCallCheck2(this,_MultisampleSystem);this.renderer=e;}return _createClass2(_MultisampleSystem,[{key:"contextChange",value:function contextChange(e){var t;if(1===this.renderer.context.webGLVersion){var r=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,r);}else{var _r200=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,_r200);}t>=_MSAA_QUALITY.HIGH?this.multisample=_MSAA_QUALITY.HIGH:t>=_MSAA_QUALITY.MEDIUM?this.multisample=_MSAA_QUALITY.MEDIUM:t>=_MSAA_QUALITY.LOW?this.multisample=_MSAA_QUALITY.LOW:this.multisample=_MSAA_QUALITY.NONE;}},{key:"destroy",value:function destroy(){}}]);}();_MultisampleSystem.extension={type:_ExtensionType.RendererSystem,name:"_multisample"},_extensions.add(_MultisampleSystem);var GLBuffer=/*#__PURE__*/_createClass2(function GLBuffer(e){_classCallCheck2(this,GLBuffer);this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0;});var _BufferSystem=/*#__PURE__*/function(){function _BufferSystem(e){_classCallCheck2(this,_BufferSystem);this.renderer=e,this.managedBuffers={},this.boundBufferBases={};}return _createClass2(_BufferSystem,[{key:"destroy",value:function destroy(){this.renderer=null;}},{key:"contextChange",value:function contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID;}},{key:"bind",value:function bind(e){var t=this.gl,r=this.CONTEXT_UID,n=e._glBuffers[r]||this.createGLBuffer(e);t.bindBuffer(e.type,n.buffer);}},{key:"unbind",value:function unbind(e){var t=this.gl;t.bindBuffer(e,null);}},{key:"bindBufferBase",value:function bindBufferBase(e,t){var r=this.gl,n=this.CONTEXT_UID;if(this.boundBufferBases[t]!==e){var _i95=e._glBuffers[n]||this.createGLBuffer(e);this.boundBufferBases[t]=e,r.bindBufferBase(r.UNIFORM_BUFFER,t,_i95.buffer);}}},{key:"bindBufferRange",value:function bindBufferRange(e,t,r){var n=this.gl,i=this.CONTEXT_UID;r=r||0;var o=e._glBuffers[i]||this.createGLBuffer(e);n.bindBufferRange(n.UNIFORM_BUFFER,t||0,o.buffer,256*r,256);}},{key:"update",value:function update(e){var t=this.gl,r=this.CONTEXT_UID,n=e._glBuffers[r]||this.createGLBuffer(e);if(e._updateID!==n.updateID)if(n.updateID=e._updateID,t.bindBuffer(e.type,n.buffer),n.byteLength>=e.data.byteLength)t.bufferSubData(e.type,0,e.data);else{var _r201=e["static"]?t.STATIC_DRAW:t.DYNAMIC_DRAW;n.byteLength=e.data.byteLength,t.bufferData(e.type,e.data,_r201);}}},{key:"dispose",value:function dispose(e,t){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];var r=e._glBuffers[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this),r&&(t||n.deleteBuffer(r.buffer),delete e._glBuffers[this.CONTEXT_UID]);}},{key:"disposeAll",value:function disposeAll(e){var t=Object.keys(this.managedBuffers);for(var r=0;r<t.length;r++)this.dispose(this.managedBuffers[t[r]],e);}},{key:"createGLBuffer",value:function createGLBuffer(e){var t=this.CONTEXT_UID,r=this.gl;return e._glBuffers[t]=new GLBuffer(r.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[t];}}]);}();_BufferSystem.extension={type:_ExtensionType.RendererSystem,name:"buffer"},_extensions.add(_BufferSystem);var _ObjectRendererSystem=/*#__PURE__*/function(){function _ObjectRendererSystem(e){_classCallCheck2(this,_ObjectRendererSystem);this.renderer=e;}return _createClass2(_ObjectRendererSystem,[{key:"render",value:function render(e,t){var r=this.renderer;var n,i,o,a;if(t&&(n=t.renderTexture,i=t.clear,o=t.transform,a=t.skipUpdateTransform),this.renderingToScreen=!n,r.runners.prerender.emit(),r.emit("prerender"),r.projection.transform=o,!r.context.isLost){var _i96;if(n||(this.lastObjectRendered=e),!a){var _t197=e.enableTempParent();e.updateTransform(),e.disableTempParent(_t197);}r.renderTexture.bind(n),r.batch.currentRenderer.start(),((_i96=i)!==null&&_i96!==void 0?_i96:r.background.clearBeforeRender)&&r.renderTexture.clear(),e.render(r),r.batch.currentRenderer.flush(),n&&(t.blit&&r.framebuffer.blit(),n.baseTexture.update()),r.runners.postrender.emit(),r.projection.transform=null,r.emit("postrender");}}},{key:"destroy",value:function destroy(){this.renderer=null,this.lastObjectRendered=null;}}]);}();_ObjectRendererSystem.extension={type:_ExtensionType.RendererSystem,name:"objectRenderer"},_extensions.add(_ObjectRendererSystem);var _Renderer=/*#__PURE__*/function(_SystemManager2){function e(t){var _this59;_classCallCheck2(this,e);_this59=_callSuper2(this,e),_this59.type=_RENDERER_TYPE.WEBGL,t=Object.assign({},_settings.RENDER_OPTIONS,t),_this59.gl=null,_this59.CONTEXT_UID=0,_this59.globalUniforms=new _UniformGroup({projectionMatrix:new _Matrix()},!0);var r={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:e.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};_this59.setup(r),"useContextAlpha"in t&&(_deprecation("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&"notMultiplied"!==t.useContextAlpha,t.backgroundAlpha=!1===t.useContextAlpha?1:t.backgroundAlpha),_this59._plugin.rendererPlugins=e.__plugins,_this59.options=t,_this59.startup.run(_this59.options);return _this59;}_inherits2(e,_SystemManager2);return _createClass2(e,[{key:"render",value:function render(_e394,t){this.objectRenderer.render(_e394,t);}},{key:"resize",value:function resize(_e395,t){this._view.resizeView(_e395,t);}},{key:"reset",value:function reset(){return this.runners.reset.emit(),this;}},{key:"clear",value:function clear(){this.renderTexture.bind(),this.renderTexture.clear();}},{key:"destroy",value:function destroy(){var _e396=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:_e396}),_superPropGet2(e,"destroy",this,3)([]);}},{key:"plugins",get:function get(){return this._plugin.plugins;}},{key:"multisample",get:function get(){return this._multisample.multisample;}},{key:"width",get:function get(){return this._view.element.width;}},{key:"height",get:function get(){return this._view.element.height;}},{key:"resolution",get:function get(){return this._view.resolution;},set:function set(_e397){this._view.resolution=_e397,this.runners.resolutionChange.emit(_e397);}},{key:"autoDensity",get:function get(){return this._view.autoDensity;}},{key:"view",get:function get(){return this._view.element;}},{key:"screen",get:function get(){return this._view.screen;}},{key:"lastObjectRendered",get:function get(){return this.objectRenderer.lastObjectRendered;}},{key:"renderingToScreen",get:function get(){return this.objectRenderer.renderingToScreen;}},{key:"rendererLogId",get:function get(){return"WebGL ".concat(this.context.webGLVersion);}},{key:"clearBeforeRender",get:function get(){return _deprecation("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender;}},{key:"useContextAlpha",get:function get(){return _deprecation("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha;}},{key:"preserveDrawingBuffer",get:function get(){return _deprecation("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer;}},{key:"backgroundColor",get:function get(){return _deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color;},set:function set(_e398){_deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=_e398;}},{key:"backgroundAlpha",get:function get(){return _deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha;},set:function set(_e399){_deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=_e399;}},{key:"powerPreference",get:function get(){return _deprecation("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference;}},{key:"generateTexture",value:function generateTexture(_e400,t){return this.textureGenerator.generateTexture(_e400,t);}}],[{key:"test",value:function test(_e393){return!(_e393!==null&&_e393!==void 0&&_e393.forceCanvas)&&_isWebGLSupported();}}]);}(_SystemManager);_Renderer.extension={type:_ExtensionType.Renderer,priority:1},_Renderer.__plugins={},_Renderer.__systems={};var _Renderer2=_Renderer;_extensions.handleByMap(_ExtensionType.RendererPlugin,_Renderer2.__plugins),_extensions.handleByMap(_ExtensionType.RendererSystem,_Renderer2.__systems),_extensions.add(_Renderer2);var _AbstractMultiResource=/*#__PURE__*/function(_Resource4){function _AbstractMultiResource(e,t){var _this60;_classCallCheck2(this,_AbstractMultiResource);var _ref40=t||{},r=_ref40.width,n=_ref40.height;_this60=_callSuper2(this,_AbstractMultiResource,[r,n]),_this60.items=[],_this60.itemDirtyIds=[];for(var _t198=0;_t198<e;_t198++){var _e401=new _BaseTexture2();_this60.items.push(_e401),_this60.itemDirtyIds.push(-2);}_this60.length=e,_this60._load=null,_this60.baseTexture=null;return _this60;}_inherits2(_AbstractMultiResource,_Resource4);return _createClass2(_AbstractMultiResource,[{key:"initFromArray",value:function initFromArray(e,t){for(var r=0;r<this.length;r++)e[r]&&(e[r].castToBaseTexture?this.addBaseTextureAt(e[r].castToBaseTexture(),r):e[r]instanceof _Resource?this.addResourceAt(e[r],r):this.addResourceAt(_autoDetectResource(e[r],t),r));}},{key:"dispose",value:function dispose(){for(var _e402=0,_t199=this.length;_e402<_t199;_e402++)this.items[_e402].destroy();this.items=null,this.itemDirtyIds=null,this._load=null;}},{key:"addResourceAt",value:function addResourceAt(e,t){if(!this.items[t])throw new Error("Index ".concat(t," is out of bounds"));return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this;}},{key:"bind",value:function bind(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");_superPropGet2(_AbstractMultiResource,"bind",this,3)([e]);for(var _t200=0;_t200<this.length;_t200++)this.items[_t200].parentTextureArray=e,this.items[_t200].on("update",e.update,e);}},{key:"unbind",value:function unbind(e){_superPropGet2(_AbstractMultiResource,"unbind",this,3)([e]);for(var _t201=0;_t201<this.length;_t201++)this.items[_t201].parentTextureArray=null,this.items[_t201].off("update",e.update,e);}},{key:"load",value:function load(){var _this61=this;if(this._load)return this._load;var e=this.items.map(function(e){return e.resource;}).filter(function(e){return e;}).map(function(e){return e.load();});return this._load=Promise.all(e).then(function(){var _this61$items$=_this61.items[0],e=_this61$items$.realWidth,t=_this61$items$.realHeight;return _this61.resize(e,t),_this61.update(),Promise.resolve(_this61);}),this._load;}}]);}(_Resource);var _ArrayResource=/*#__PURE__*/function(_AbstractMultiResourc){function _ArrayResource(e,t){var _this62;_classCallCheck2(this,_ArrayResource);var _ref41=t||{},r=_ref41.width,n=_ref41.height;var i,o;Array.isArray(e)?(i=e,o=e.length):o=e,_this62=_callSuper2(this,_ArrayResource,[o,{width:r,height:n}]),i&&_this62.initFromArray(i,t);return _this62;}_inherits2(_ArrayResource,_AbstractMultiResourc);return _createClass2(_ArrayResource,[{key:"addBaseTextureAt",value:function addBaseTextureAt(e,t){if(!e.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(e.resource,t),this;}},{key:"bind",value:function bind(e){_superPropGet2(_ArrayResource,"bind",this,3)([e]),e.target=_TARGETS.TEXTURE_2D_ARRAY;}},{key:"upload",value:function upload(e,t,r){var n=this.length,i=this.itemDirtyIds,o=this.items,a=e.gl;r.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,n,0,t.format,r.type,null);for(var _e403=0;_e403<n;_e403++){var _n130=o[_e403];i[_e403]<_n130.dirtyId&&(i[_e403]=_n130.dirtyId,_n130.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,_e403,_n130.resource.width,_n130.resource.height,1,t.format,r.type,_n130.resource.source));}return!0;}}]);}(_AbstractMultiResource);var _CanvasResource=/*#__PURE__*/function(_BaseImageResource3){function _CanvasResource(e){_classCallCheck2(this,_CanvasResource);return _callSuper2(this,_CanvasResource,[e]);}_inherits2(_CanvasResource,_BaseImageResource3);return _createClass2(_CanvasResource,null,[{key:"test",value:function test(e){var t=globalThis.OffscreenCanvas;return!!(t&&e instanceof t)||globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement;}}]);}(_BaseImageResource);var _CubeResource=/*#__PURE__*/function(_AbstractMultiResourc2){function e(t,r){var _this63;_classCallCheck2(this,e);var _ref42=r||{},n=_ref42.width,i=_ref42.height,o=_ref42.autoLoad,a=_ref42.linkBaseTexture;if(t&&t.length!==e.SIDES)throw new Error("Invalid length. Got ".concat(t.length,", expected 6"));_this63=_callSuper2(this,e,[6,{width:n,height:i}]);for(var _t202=0;_t202<e.SIDES;_t202++)_this63.items[_t202].target=_TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+_t202;_this63.linkBaseTexture=!1!==a,t&&_this63.initFromArray(t,r),!1!==o&&_this63.load();return _this63;}_inherits2(e,_AbstractMultiResourc2);return _createClass2(e,[{key:"bind",value:function bind(_e404){_superPropGet2(e,"bind",this,3)([_e404]),_e404.target=_TARGETS.TEXTURE_CUBE_MAP;}},{key:"addBaseTextureAt",value:function addBaseTextureAt(_e405,t,r){if(void 0===r&&(r=this.linkBaseTexture),!this.items[t])throw new Error("Index ".concat(t," is out of bounds"));if(!this.linkBaseTexture||_e405.parentTextureArray||Object.keys(_e405._glTextures).length>0){if(!_e405.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(_e405.resource,t);}else _e405.target=_TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+t,_e405.parentTextureArray=this.baseTexture,this.items[t]=_e405;return _e405.valid&&!this.valid&&this.resize(_e405.realWidth,_e405.realHeight),this.items[t]=_e405,this;}},{key:"upload",value:function upload(t,r,n){var i=this.itemDirtyIds;for(var _o65=0;_o65<e.SIDES;_o65++){var _e406=this.items[_o65];(i[_o65]<_e406.dirtyId||n.dirtyId<r.dirtyId)&&(_e406.valid&&_e406.resource?(_e406.resource.upload(t,_e406,n),i[_o65]=_e406.dirtyId):i[_o65]<-1&&(t.gl.texImage2D(_e406.target,0,n.internalFormat,r.realWidth,r.realHeight,0,r.format,n.type,null),i[_o65]=-1));}return!0;}}],[{key:"test",value:function test(t){return Array.isArray(t)&&t.length===e.SIDES;}}]);}(_AbstractMultiResource);_CubeResource.SIDES=6;var _CubeResource2=_CubeResource;var _ImageBitmapResource=/*#__PURE__*/function(_BaseImageResource4){function _ImageBitmapResource(e,t){var _t$crossOrigin,_t$ownsImageBitmap;var _this64;_classCallCheck2(this,_ImageBitmapResource);var r,n,i;t=t||{},"string"==typeof e?(r=_ImageBitmapResource.EMPTY,n=e,i=!0):(r=e,n=null,i=!1),_this64=_callSuper2(this,_ImageBitmapResource,[r]),_this64.url=n,_this64.crossOrigin=(_t$crossOrigin=t.crossOrigin)!==null&&_t$crossOrigin!==void 0?_t$crossOrigin:!0,_this64.alphaMode="number"==typeof t.alphaMode?t.alphaMode:null,_this64.ownsImageBitmap=(_t$ownsImageBitmap=t.ownsImageBitmap)!==null&&_t$ownsImageBitmap!==void 0?_t$ownsImageBitmap:i,_this64._load=null,!1!==t.autoLoad&&_this64.load();return _this64;}_inherits2(_ImageBitmapResource,_BaseImageResource4);return _createClass2(_ImageBitmapResource,[{key:"load",value:function load(){var _this65=this;return this._load||(this._load=new Promise(/*#__PURE__*/function(){var _ref43=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee73(e,t){var _t203,r,_n131;return _regeneratorRuntime2().wrap(function _callee73$(_context77){while(1)switch(_context77.prev=_context77.next){case 0:if(!(null!==_this65.url)){_context77.next=27;break;}_context77.prev=1;_context77.next=4;return _settings.ADAPTER.fetch(_this65.url,{mode:_this65.crossOrigin?"cors":"no-cors"});case 4:_t203=_context77.sent;if(!_this65.destroyed){_context77.next=7;break;}return _context77.abrupt("return");case 7:_context77.next=9;return _t203.blob();case 9:r=_context77.sent;if(!_this65.destroyed){_context77.next=12;break;}return _context77.abrupt("return");case 12:_context77.next=14;return createImageBitmap(r,{premultiplyAlpha:null===_this65.alphaMode||_this65.alphaMode===_ALPHA_MODES.UNPACK?"premultiply":"none"});case 14:_n131=_context77.sent;if(!_this65.destroyed){_context77.next=17;break;}return _context77.abrupt("return",void _n131.close());case 17:_this65.source=_n131,_this65.update(),e(_this65);_context77.next=25;break;case 20:_context77.prev=20;_context77.t0=_context77["catch"](1);if(!_this65.destroyed){_context77.next=24;break;}return _context77.abrupt("return");case 24:t(_context77.t0),_this65.onError.emit(_context77.t0);case 25:_context77.next=28;break;case 27:e(_this65);case 28:case"end":return _context77.stop();}},_callee73,null,[[1,20]]);}));return function(_x95,_x96){return _ref43.apply(this,arguments);};}())),this._load;}},{key:"upload",value:function upload(e,t,r){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(t.alphaMode=this.alphaMode),_superPropGet2(_ImageBitmapResource,"upload",this,3)([e,t,r])):(this.load(),!1);}},{key:"dispose",value:function dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),_superPropGet2(_ImageBitmapResource,"dispose",this,3)([]),this._load=null;}}],[{key:"test",value:function test(e){return!!globalThis.createImageBitmap&&(typeof ImageBitmap==="undefined"?"undefined":_typeof2(ImageBitmap))<"u"&&("string"==typeof e||e instanceof ImageBitmap);}},{key:"EMPTY",get:function get(){var _ImageBitmapResource$;return _ImageBitmapResource._EMPTY=(_ImageBitmapResource$=_ImageBitmapResource._EMPTY)!==null&&_ImageBitmapResource$!==void 0?_ImageBitmapResource$:_settings.ADAPTER.createCanvas(0,0),_ImageBitmapResource._EMPTY;}}]);}(_BaseImageResource);var _SVGResource=/*#__PURE__*/function(_BaseImageResource5){function e(_e407,t){var _this66;_classCallCheck2(this,e);t=t||{},_this66=_callSuper2(this,e,[_settings.ADAPTER.createCanvas()]),_this66._width=0,_this66._height=0,_this66.svg=_e407,_this66.scale=t.scale||1,_this66._overrideWidth=t.width,_this66._overrideHeight=t.height,_this66._resolve=null,_this66._crossorigin=t.crossorigin,_this66._load=null,!1!==t.autoLoad&&_this66.load();return _this66;}_inherits2(e,_BaseImageResource5);return _createClass2(e,[{key:"load",value:function load(){var _this67=this;return this._load||(this._load=new Promise(function(t){if(_this67._resolve=function(){_this67.update(),t(_this67);},e.SVG_XML.test(_this67.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");_this67.svg="data:image/svg+xml;base64,".concat(btoa(unescape(encodeURIComponent(_this67.svg))));}_this67._loadSvg();})),this._load;}},{key:"_loadSvg",value:function _loadSvg(){var _this68=this;var _e408=new Image();_BaseImageResource.crossOrigin(_e408,this.svg,this._crossorigin),_e408.src=this.svg,_e408.onerror=function(t){_this68._resolve&&(_e408.onerror=null,_this68.onError.emit(t));},_e408.onload=function(){if(!_this68._resolve)return;var t=_e408.width,r=_e408.height;if(!t||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=t*_this68.scale,i=r*_this68.scale;(_this68._overrideWidth||_this68._overrideHeight)&&(n=_this68._overrideWidth||_this68._overrideHeight/r*t,i=_this68._overrideHeight||_this68._overrideWidth/t*r),n=Math.round(n),i=Math.round(i);var o=_this68.source;o.width=n,o.height=i,o._pixiId="canvas_".concat(_uid()),o.getContext("2d").drawImage(_e408,0,0,t,r,0,0,n,i),_this68._resolve(),_this68._resolve=null;};}},{key:"dispose",value:function dispose(){_superPropGet2(e,"dispose",this,3)([]),this._resolve=null,this._crossorigin=null;}}],[{key:"getSize",value:function getSize(t){var r=e.SVG_SIZE.exec(t),n={};return r&&(n[r[1]]=Math.round(parseFloat(r[3])),n[r[5]]=Math.round(parseFloat(r[7]))),n;}},{key:"test",value:function test(t,r){return"svg"===r||"string"==typeof t&&t.startsWith("data:image/svg+xml")||"string"==typeof t&&e.SVG_XML.test(t);}}]);}(_BaseImageResource);_SVGResource.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,_SVGResource.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var _SVGResource2=_SVGResource;var VideoFrameResource=/*#__PURE__*/function(_BaseImageResource6){function VideoFrameResource(e){_classCallCheck2(this,VideoFrameResource);return _callSuper2(this,VideoFrameResource,[e]);}_inherits2(VideoFrameResource,_BaseImageResource6);return _createClass2(VideoFrameResource,null,[{key:"test",value:function test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame;}}]);}(_BaseImageResource);var _VideoResource=/*#__PURE__*/function(_BaseImageResource7){function e(t,r){var _this69;_classCallCheck2(this,e);if(r=r||{},!(t instanceof HTMLVideoElement)){var _n132=document.createElement("video");!1!==r.autoLoad&&_n132.setAttribute("preload","auto"),!1!==r.playsinline&&(_n132.setAttribute("webkit-playsinline",""),_n132.setAttribute("playsinline","")),!0===r.muted&&(_n132.setAttribute("muted",""),_n132.muted=!0),!0===r.loop&&_n132.setAttribute("loop",""),!1!==r.autoPlay&&_n132.setAttribute("autoplay",""),"string"==typeof t&&(t=[t]);var _i97=t[0].src||t[0];_BaseImageResource.crossOrigin(_n132,_i97,r.crossorigin);for(var _r202=0;_r202<t.length;++_r202){var _i98=document.createElement("source");var _t$_r=t[_r202],_o66=_t$_r.src,_a42=_t$_r.mime;if(_o66=_o66||t[_r202],_o66.startsWith("data:"))_a42=_o66.slice(5,_o66.indexOf(";"));else if(!_o66.startsWith("blob:")){var _t204=_o66.split("?").shift().toLowerCase(),_r203=_t204.slice(_t204.lastIndexOf(".")+1);_a42=_a42||e.MIME_TYPES[_r203]||"video/".concat(_r203);}_i98.src=_o66,_a42&&(_i98.type=_a42),_n132.appendChild(_i98);}t=_n132;}_this69=_callSuper2(this,e,[t]),_this69.noSubImage=!0,_this69._autoUpdate=!0,_this69._isConnectedToTicker=!1,_this69._updateFPS=r.updateFPS||0,_this69._msToNextUpdate=0,_this69.autoPlay=!1!==r.autoPlay,_this69._videoFrameRequestCallback=_this69._videoFrameRequestCallback.bind(_assertThisInitialized2(_this69)),_this69._videoFrameRequestCallbackHandle=null,_this69._load=null,_this69._resolve=null,_this69._reject=null,_this69._onCanPlay=_this69._onCanPlay.bind(_assertThisInitialized2(_this69)),_this69._onError=_this69._onError.bind(_assertThisInitialized2(_this69)),_this69._onPlayStart=_this69._onPlayStart.bind(_assertThisInitialized2(_this69)),_this69._onPlayStop=_this69._onPlayStop.bind(_assertThisInitialized2(_this69)),_this69._onSeeked=_this69._onSeeked.bind(_assertThisInitialized2(_this69)),!1!==r.autoLoad&&_this69.load();return _this69;}_inherits2(e,_BaseImageResource7);return _createClass2(e,[{key:"update",value:function update(){var _e409=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(!this.destroyed){if(this._updateFPS){var _e410=_Ticker2.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-_e410);}(!this._updateFPS||this._msToNextUpdate<=0)&&(_superPropGet2(e,"update",this,3)([]),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0);}}},{key:"_videoFrameRequestCallback",value:function _videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback);}},{key:"load",value:function load(){var _this70=this;if(this._load)return this._load;var _e411=this.source;return(_e411.readyState===_e411.HAVE_ENOUGH_DATA||_e411.readyState===_e411.HAVE_FUTURE_DATA)&&_e411.width&&_e411.height&&(_e411.complete=!0),_e411.addEventListener("play",this._onPlayStart),_e411.addEventListener("pause",this._onPlayStop),_e411.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(_e411.addEventListener("canplay",this._onCanPlay),_e411.addEventListener("canplaythrough",this._onCanPlay),_e411.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t,r){_this70.valid?t(_this70):(_this70._resolve=t,_this70._reject=r,_e411.load());}),this._load;}},{key:"_onError",value:function _onError(_e412){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(_e412),this._reject&&(this._reject(_e412),this._reject=null,this._resolve=null);}},{key:"_isSourcePlaying",value:function _isSourcePlaying(){var _e413=this.source;return!_e413.paused&&!_e413.ended;}},{key:"_isSourceReady",value:function _isSourceReady(){return this.source.readyState>2;}},{key:"_onPlayStart",value:function _onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate();}},{key:"_onPlayStop",value:function _onPlayStop(){this._configureAutoUpdate();}},{key:"_onSeeked",value:function _onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0);}},{key:"_onCanPlay",value:function _onCanPlay(){var _e414=this.source;_e414.removeEventListener("canplay",this._onCanPlay),_e414.removeEventListener("canplaythrough",this._onCanPlay);var t=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!t&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&_e414.play();}},{key:"dispose",value:function dispose(){this._configureAutoUpdate();var _e415=this.source;_e415&&(_e415.removeEventListener("play",this._onPlayStart),_e415.removeEventListener("pause",this._onPlayStop),_e415.removeEventListener("seeked",this._onSeeked),_e415.removeEventListener("canplay",this._onCanPlay),_e415.removeEventListener("canplaythrough",this._onCanPlay),_e415.removeEventListener("error",this._onError,!0),_e415.pause(),_e415.src="",_e415.load()),_superPropGet2(e,"dispose",this,3)([]);}},{key:"autoUpdate",get:function get(){return this._autoUpdate;},set:function set(_e416){_e416!==this._autoUpdate&&(this._autoUpdate=_e416,this._configureAutoUpdate());}},{key:"updateFPS",get:function get(){return this._updateFPS;},set:function set(_e417){_e417!==this._updateFPS&&(this._updateFPS=_e417,this._configureAutoUpdate());}},{key:"_configureAutoUpdate",value:function _configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(_Ticker2.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(_Ticker2.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(_Ticker2.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0));}}],[{key:"test",value:function test(t,r){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.includes(r);}}]);}(_BaseImageResource);_VideoResource.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],_VideoResource.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};var _VideoResource2=_VideoResource;_INSTALLED.push(_ImageBitmapResource,_ImageResource,_CanvasResource,_VideoResource2,VideoFrameResource,_SVGResource2,_BufferResource,_CubeResource2,_ArrayResource);var _TransformFeedback=/*#__PURE__*/function(){function _TransformFeedback(){_classCallCheck2(this,_TransformFeedback);this._glTransformFeedbacks={},this.buffers=[],this.disposeRunner=new _Runner("disposeTransformFeedback");}return _createClass2(_TransformFeedback,[{key:"bindBuffer",value:function bindBuffer(e,t){this.buffers[e]=t;}},{key:"destroy",value:function destroy(){this.disposeRunner.emit(this,!1);}}]);}();var _VERSION="7.4.2";var _Bounds=/*#__PURE__*/function(){function _Bounds(){_classCallCheck2(this,_Bounds);this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1;}return _createClass2(_Bounds,[{key:"isEmpty",value:function isEmpty(){return this.minX>this.maxX||this.minY>this.maxY;}},{key:"clear",value:function clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0;}},{key:"getRectangle",value:function getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?_Rectangle.EMPTY:((e=e||new _Rectangle(0,0,1,1)).x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e);}},{key:"addPoint",value:function addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y);}},{key:"addPointMatrix",value:function addPointMatrix(e,t){var r=e.a,n=e.b,i=e.c,o=e.d,a=e.tx,s=e.ty,u=r*t.x+i*t.y+a,l=n*t.x+o*t.y+s;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,l),this.maxY=Math.max(this.maxY,l);}},{key:"addQuad",value:function addQuad(e){var t=this.minX,r=this.minY,n=this.maxX,i=this.maxY,o=e[0],a=e[1];t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,i=a>i?a:i,o=e[2],a=e[3],t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,i=a>i?a:i,o=e[4],a=e[5],t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,i=a>i?a:i,o=e[6],a=e[7],t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,i=a>i?a:i,this.minX=t,this.minY=r,this.maxX=n,this.maxY=i;}},{key:"addFrame",value:function addFrame(e,t,r,n,i){this.addFrameMatrix(e.worldTransform,t,r,n,i);}},{key:"addFrameMatrix",value:function addFrameMatrix(e,t,r,n,i){var o=e.a,a=e.b,s=e.c,u=e.d,l=e.tx,c=e.ty;var h=this.minX,f=this.minY,d=this.maxX,p=this.maxY,y=o*t+s*r+l,m=a*t+u*r+c;h=y<h?y:h,f=m<f?m:f,d=y>d?y:d,p=m>p?m:p,y=o*n+s*r+l,m=a*n+u*r+c,h=y<h?y:h,f=m<f?m:f,d=y>d?y:d,p=m>p?m:p,y=o*t+s*i+l,m=a*t+u*i+c,h=y<h?y:h,f=m<f?m:f,d=y>d?y:d,p=m>p?m:p,y=o*n+s*i+l,m=a*n+u*i+c,h=y<h?y:h,f=m<f?m:f,d=y>d?y:d,p=m>p?m:p,this.minX=h,this.minY=f,this.maxX=d,this.maxY=p;}},{key:"addVertexData",value:function addVertexData(e,t,r){var n=this.minX,i=this.minY,o=this.maxX,a=this.maxY;for(var _s34=t;_s34<r;_s34+=2){var _t205=e[_s34],_r204=e[_s34+1];n=_t205<n?_t205:n,i=_r204<i?_r204:i,o=_t205>o?_t205:o,a=_r204>a?_r204:a;}this.minX=n,this.minY=i,this.maxX=o,this.maxY=a;}},{key:"addVertices",value:function addVertices(e,t,r,n){this.addVerticesMatrix(e.worldTransform,t,r,n);}},{key:"addVerticesMatrix",value:function addVerticesMatrix(e,t,r,n){var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;var o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:i;var a=e.a,s=e.b,u=e.c,l=e.d,c=e.tx,h=e.ty;var f=this.minX,d=this.minY,p=this.maxX,y=this.maxY;for(var _e418=r;_e418<n;_e418+=2){var _r205=t[_e418],_n133=t[_e418+1],_m5=a*_r205+u*_n133+c,_g3=l*_n133+s*_r205+h;f=Math.min(f,_m5-i),p=Math.max(p,_m5+i),d=Math.min(d,_g3-o),y=Math.max(y,_g3+o);}this.minX=f,this.minY=d,this.maxX=p,this.maxY=y;}},{key:"addBounds",value:function addBounds(e){var t=this.minX,r=this.minY,n=this.maxX,i=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<r?e.minY:r,this.maxX=e.maxX>n?e.maxX:n,this.maxY=e.maxY>i?e.maxY:i;}},{key:"addBoundsMask",value:function addBoundsMask(e,t){var r=e.minX>t.minX?e.minX:t.minX,n=e.minY>t.minY?e.minY:t.minY,i=e.maxX<t.maxX?e.maxX:t.maxX,o=e.maxY<t.maxY?e.maxY:t.maxY;if(r<=i&&n<=o){var _e419=this.minX,_t206=this.minY,_a43=this.maxX,_s35=this.maxY;this.minX=r<_e419?r:_e419,this.minY=n<_t206?n:_t206,this.maxX=i>_a43?i:_a43,this.maxY=o>_s35?o:_s35;}}},{key:"addBoundsMatrix",value:function addBoundsMatrix(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY);}},{key:"addBoundsArea",value:function addBoundsArea(e,t){var r=e.minX>t.x?e.minX:t.x,n=e.minY>t.y?e.minY:t.y,i=e.maxX<t.x+t.width?e.maxX:t.x+t.width,o=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(r<=i&&n<=o){var _e420=this.minX,_t207=this.minY,_a44=this.maxX,_s36=this.maxY;this.minX=r<_e420?r:_e420,this.minY=n<_t207?n:_t207,this.maxX=i>_a44?i:_a44,this.maxY=o>_s36?o:_s36;}}},{key:"pad",value:function pad(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:e;this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t);}},{key:"addFramePad",value:function addFramePad(e,t,r,n,i,o){e-=i,t-=o,r+=i,n+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>n?this.maxY:n;}}]);}();var _DisplayObject=/*#__PURE__*/function(_utils_node_modules_e4){function _DisplayObject(){var _this71;_classCallCheck2(this,_DisplayObject);_this71=_callSuper2(this,_DisplayObject),_this71.tempDisplayObjectParent=null,_this71.transform=new _Transform2(),_this71.alpha=1,_this71.visible=!0,_this71.renderable=!0,_this71.cullable=!1,_this71.cullArea=null,_this71.parent=null,_this71.worldAlpha=1,_this71._lastSortedIndex=0,_this71._zIndex=0,_this71.filterArea=null,_this71.filters=null,_this71._enabledFilters=null,_this71._bounds=new _Bounds(),_this71._localBounds=null,_this71._boundsID=0,_this71._boundsRect=null,_this71._localBoundsRect=null,_this71._mask=null,_this71._maskRefCount=0,_this71._destroyed=!1,_this71.isSprite=!1,_this71.isMask=!1;return _this71;}_inherits2(_DisplayObject,_utils_node_modules_e4);return _createClass2(_DisplayObject,[{key:"destroyed",get:function get(){return this._destroyed;}},{key:"_recursivePostUpdateTransform",value:function _recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform);}},{key:"updateTransform",value:function updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;}},{key:"getBounds",value:function getBounds(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),t||(this._boundsRect||(this._boundsRect=new _Rectangle()),t=this._boundsRect),this._bounds.getRectangle(t);}},{key:"getLocalBounds",value:function getLocalBounds(e){var _r$worldAlpha;e||(this._localBoundsRect||(this._localBoundsRect=new _Rectangle()),e=this._localBoundsRect),this._localBounds||(this._localBounds=new _Bounds());var t=this.transform,r=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(_r$worldAlpha=r===null||r===void 0?void 0:r.worldAlpha)!==null&&_r$worldAlpha!==void 0?_r$worldAlpha:1,this.transform=this._tempDisplayObjectParent.transform;var n=this._bounds,i=this._boundsID;this._bounds=this._localBounds;var o=this.getBounds(!1,e);return this.parent=r,this.transform=t,this._bounds=n,this._bounds.updateID+=this._boundsID-i,o;}},{key:"toGlobal",value:function toGlobal(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;return r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t);}},{key:"toLocal",value:function toLocal(e,t,r,n){return t&&(e=t.toGlobal(e,r,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,r);}},{key:"setParent",value:function setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e;}},{key:"removeFromParent",value:function removeFromParent(){var _this$parent;(_this$parent=this.parent)===null||_this$parent===void 0||_this$parent.removeChild(this);}},{key:"setTransform",value:function setTransform(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1;var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;var o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:0;var a=arguments.length>6&&arguments[6]!==undefined?arguments[6]:0;var s=arguments.length>7&&arguments[7]!==undefined?arguments[7]:0;var u=arguments.length>8&&arguments[8]!==undefined?arguments[8]:0;return this.position.x=e,this.position.y=t,this.scale.x=r||1,this.scale.y=n||1,this.rotation=i,this.skew.x=o,this.skew.y=a,this.pivot.x=s,this.pivot.y=u,this;}},{key:"destroy",value:function destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners();}},{key:"_tempDisplayObjectParent",get:function get(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new _TemporaryDisplayObject()),this.tempDisplayObjectParent;}},{key:"enableTempParent",value:function enableTempParent(){var e=this.parent;return this.parent=this._tempDisplayObjectParent,e;}},{key:"disableTempParent",value:function disableTempParent(e){this.parent=e;}},{key:"x",get:function get(){return this.position.x;},set:function set(e){this.transform.position.x=e;}},{key:"y",get:function get(){return this.position.y;},set:function set(e){this.transform.position.y=e;}},{key:"worldTransform",get:function get(){return this.transform.worldTransform;}},{key:"localTransform",get:function get(){return this.transform.localTransform;}},{key:"position",get:function get(){return this.transform.position;},set:function set(e){this.transform.position.copyFrom(e);}},{key:"scale",get:function get(){return this.transform.scale;},set:function set(e){this.transform.scale.copyFrom(e);}},{key:"pivot",get:function get(){return this.transform.pivot;},set:function set(e){this.transform.pivot.copyFrom(e);}},{key:"skew",get:function get(){return this.transform.skew;},set:function set(e){this.transform.skew.copyFrom(e);}},{key:"rotation",get:function get(){return this.transform.rotation;},set:function set(e){this.transform.rotation=e;}},{key:"angle",get:function get(){return this.transform.rotation*_RAD_TO_DEG;},set:function set(e){this.transform.rotation=e*_DEG_TO_RAD;}},{key:"zIndex",get:function get(){return this._zIndex;},set:function set(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0));}},{key:"worldVisible",get:function get(){var e=this;do{if(!e.visible)return!1;e=e.parent;}while(e);return!0;}},{key:"mask",get:function get(){return this._mask;},set:function set(e){if(this._mask!==e){if(this._mask){var _e421=this._mask.isMaskData?this._mask.maskObject:this._mask;_e421&&(_e421._maskRefCount--,0===_e421._maskRefCount&&(_e421.renderable=!0,_e421.isMask=!1));}if(this._mask=e,this._mask){var _e422=this._mask.isMaskData?this._mask.maskObject:this._mask;_e422&&(0===_e422._maskRefCount&&(_e422.renderable=!1,_e422.isMask=!0),_e422._maskRefCount++);}}}}],[{key:"mixin",value:function mixin(e){var t=Object.keys(e);for(var r=0;r<t.length;++r){var _n134=t[r];Object.defineProperty(_DisplayObject.prototype,_n134,Object.getOwnPropertyDescriptor(e,_n134));}}}]);}(utils_node_modules_eventemitter3);var _TemporaryDisplayObject=/*#__PURE__*/function(_DisplayObject2){function _TemporaryDisplayObject(){var _this72;_classCallCheck2(this,_TemporaryDisplayObject);_this72=_callSuper2(this,_TemporaryDisplayObject,arguments),_this72.sortDirty=null;return _this72;}_inherits2(_TemporaryDisplayObject,_DisplayObject2);return _createClass2(_TemporaryDisplayObject);}(_DisplayObject);_DisplayObject.prototype.displayObjectUpdateTransform=_DisplayObject.prototype.updateTransform;var Container_tempMatrix=new _Matrix();function _sortChildren(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex;}var _Container=/*#__PURE__*/function(_DisplayObject3){function e(){var _this73;_classCallCheck2(this,e);_this73=_callSuper2(this,e),_this73.children=[],_this73.sortableChildren=e.defaultSortableChildren,_this73.sortDirty=!1;return _this73;}_inherits2(e,_DisplayObject3);return _createClass2(e,[{key:"onChildrenChange",value:function onChildrenChange(_e423){}},{key:"addChild",value:function addChild(){if(arguments.length>1)for(var _t208=0;_t208<arguments.length;_t208++)this.addChild(_t208<0||arguments.length<=_t208?undefined:arguments[_t208]);else{var _t209=arguments.length<=0?undefined:arguments[0];_t209.parent&&_t209.parent.removeChild(_t209),_t209.parent=this,this.sortDirty=!0,_t209.transform._parentID=-1,this.children.push(_t209),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",_t209,this,this.children.length-1),_t209.emit("added",this);}return arguments.length<=0?undefined:arguments[0];}},{key:"addChildAt",value:function addChildAt(_e425,t){if(t<0||t>this.children.length)throw new Error("".concat(_e425,"addChildAt: The index ").concat(t," supplied is out of bounds ").concat(this.children.length));return _e425.parent&&_e425.parent.removeChild(_e425),_e425.parent=this,this.sortDirty=!0,_e425.transform._parentID=-1,this.children.splice(t,0,_e425),this._boundsID++,this.onChildrenChange(t),_e425.emit("added",this),this.emit("childAdded",_e425,this,t),_e425;}},{key:"swapChildren",value:function swapChildren(_e426,t){if(_e426===t)return;var r=this.getChildIndex(_e426),n=this.getChildIndex(t);this.children[r]=t,this.children[n]=_e426,this.onChildrenChange(r<n?r:n);}},{key:"getChildIndex",value:function getChildIndex(_e427){var t=this.children.indexOf(_e427);if(-1===t)throw new Error("The supplied DisplayObject must be a child of the caller");return t;}},{key:"setChildIndex",value:function setChildIndex(_e428,t){if(t<0||t>=this.children.length)throw new Error("The index ".concat(t," supplied is out of bounds ").concat(this.children.length));var r=this.getChildIndex(_e428);_removeItems(this.children,r,1),this.children.splice(t,0,_e428),this.onChildrenChange(t);}},{key:"getChildAt",value:function getChildAt(_e429){if(_e429<0||_e429>=this.children.length)throw new Error("getChildAt: Index (".concat(_e429,") does not exist."));return this.children[_e429];}},{key:"removeChild",value:function removeChild(){if(arguments.length>1)for(var _t210=0;_t210<arguments.length;_t210++)this.removeChild(_t210<0||arguments.length<=_t210?undefined:arguments[_t210]);else{var _t211=arguments.length<=0?undefined:arguments[0],r=this.children.indexOf(_t211);if(-1===r)return null;_t211.parent=null,_t211.transform._parentID=-1,_removeItems(this.children,r,1),this._boundsID++,this.onChildrenChange(r),_t211.emit("removed",this),this.emit("childRemoved",_t211,this,r);}return arguments.length<=0?undefined:arguments[0];}},{key:"removeChildAt",value:function removeChildAt(_e431){var t=this.getChildAt(_e431);return t.parent=null,t.transform._parentID=-1,_removeItems(this.children,_e431,1),this._boundsID++,this.onChildrenChange(_e431),t.emit("removed",this),this.emit("childRemoved",t,this,_e431),t;}},{key:"removeChildren",value:function removeChildren(){var _e432=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.children.length;var r=_e432,n=t-r;var i;if(n>0&&n<=t){i=this.children.splice(r,n);for(var _e449=0;_e449<i.length;++_e449)i[_e449].parent=null,i[_e449].transform&&(i[_e449].transform._parentID=-1);this._boundsID++,this.onChildrenChange(_e432);for(var _e450=0;_e450<i.length;++_e450)i[_e450].emit("removed",this),this.emit("childRemoved",i[_e450],this,_e450);return i;}if(0===n&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.");}},{key:"sortChildren",value:function sortChildren(){var _e435=!1;for(var _t212=0,r=this.children.length;_t212<r;++_t212){var _r206=this.children[_t212];_r206._lastSortedIndex=_t212,!_e435&&0!==_r206.zIndex&&(_e435=!0);}_e435&&this.children.length>1&&this.children.sort(_sortChildren),this.sortDirty=!1;}},{key:"updateTransform",value:function updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var _e451=0,_t213=this.children.length;_e451<_t213;++_e451){var _t214=this.children[_e451];_t214.visible&&_t214.updateTransform();}}},{key:"calculateBounds",value:function calculateBounds(){this._bounds.clear(),this._calculateBounds();for(var _e452=0;_e452<this.children.length;_e452++){var _t215=this.children[_e452];if(_t215.visible&&_t215.renderable)if(_t215.calculateBounds(),_t215._mask){var _e438=_t215._mask.isMaskData?_t215._mask.maskObject:_t215._mask;_e438?(_e438.calculateBounds(),this._bounds.addBoundsMask(_t215._bounds,_e438._bounds)):this._bounds.addBounds(_t215._bounds);}else _t215.filterArea?this._bounds.addBoundsArea(_t215._bounds,_t215.filterArea):this._bounds.addBounds(_t215._bounds);}this._bounds.updateID=this._boundsID;}},{key:"getLocalBounds",value:function getLocalBounds(_e439){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var r=_superPropGet2(e,"getLocalBounds",this,3)([_e439]);if(!t)for(var _e453=0,_t216=this.children.length;_e453<_t216;++_e453){var _t217=this.children[_e453];_t217.visible&&_t217.updateTransform();}return r;}},{key:"_calculateBounds",value:function _calculateBounds(){}},{key:"_renderWithCulling",value:function _renderWithCulling(t){var r=t.renderTexture.sourceFrame;if(!(r.width>0&&r.height>0))return;var n,i;this.cullArea?(n=this.cullArea,i=this.worldTransform):this._render!==e.prototype._render&&(n=this.getBounds(!0));var o=t.projection.transform;if(o&&(i?(i=Container_tempMatrix.copyFrom(i),i.prepend(o)):i=o),n&&r.intersects(n,i))this._render(t);else if(this.cullArea)return;for(var _e454=0,_r207=this.children.length;_e454<_r207;++_e454){var _r208=this.children[_e454],_n135=_r208.cullable;_r208.cullable=_n135||!this.cullArea,_r208.render(t),_r208.cullable=_n135;}}},{key:"render",value:function render(_e442){var _this$filters;if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||(_this$filters=this.filters)!==null&&_this$filters!==void 0&&_this$filters.length)this.renderAdvanced(_e442);else if(this.cullable)this._renderWithCulling(_e442);else{this._render(_e442);for(var _t218=0,r=this.children.length;_t218<r;++_t218)this.children[_t218].render(_e442);}}},{key:"renderAdvanced",value:function renderAdvanced(_e443){var _this$_enabledFilters,_this$_enabledFilters2,_this$_enabledFilters3;var t=this.filters,r=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var _e455=0;_e455<t.length;_e455++)t[_e455].enabled&&this._enabledFilters.push(t[_e455]);}var n=t&&((_this$_enabledFilters=this._enabledFilters)===null||_this$_enabledFilters===void 0?void 0:_this$_enabledFilters.length)||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==_MASK_TYPES.NONE));if(n&&_e443.batch.flush(),t&&(_this$_enabledFilters2=this._enabledFilters)!==null&&_this$_enabledFilters2!==void 0&&_this$_enabledFilters2.length&&_e443.filter.push(this,this._enabledFilters),r&&_e443.mask.push(this,this._mask),this.cullable)this._renderWithCulling(_e443);else{this._render(_e443);for(var _t219=0,_r209=this.children.length;_t219<_r209;++_t219)this.children[_t219].render(_e443);}n&&_e443.batch.flush(),r&&_e443.mask.pop(this),t&&((_this$_enabledFilters3=this._enabledFilters)===null||_this$_enabledFilters3===void 0?void 0:_this$_enabledFilters3.length)&&_e443.filter.pop();}},{key:"_render",value:function _render(_e445){}},{key:"destroy",value:function destroy(_e446){_superPropGet2(e,"destroy",this,3)([]),this.sortDirty=!1;var t="boolean"==typeof _e446?_e446:_e446===null||_e446===void 0?void 0:_e446.children,r=this.removeChildren(0,this.children.length);if(t)for(var _t220=0;_t220<r.length;++_t220)r[_t220].destroy(_e446);}},{key:"width",get:function get(){return this.scale.x*this.getLocalBounds().width;},set:function set(_e447){var t=this.getLocalBounds().width;this.scale.x=0!==t?_e447/t:1,this._width=_e447;}},{key:"height",get:function get(){return this.scale.y*this.getLocalBounds().height;},set:function set(_e448){var t=this.getLocalBounds().height;this.scale.y=0!==t?_e448/t:1,this._height=_e448;}}]);}(_DisplayObject);_Container.defaultSortableChildren=!1;var _Container2=_Container;_Container2.prototype.containerUpdateTransform=_Container2.prototype.updateTransform,Object.defineProperties(_settings,{SORTABLE_CHILDREN:{get:function get(){return _Container2.defaultSortableChildren;},set:function set(e){_deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),_Container2.defaultSortableChildren=e;}}});var tempPoint=new _Point(),indices=new Uint16Array([0,1,2,0,2,3]);var _Sprite=/*#__PURE__*/function(_Container3){function _Sprite(e){var _this74;_classCallCheck2(this,_Sprite);_this74=_callSuper2(this,_Sprite),_this74._anchor=new _ObservablePoint(_this74._onAnchorUpdate,_assertThisInitialized2(_this74),e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),_this74._texture=null,_this74._width=0,_this74._height=0,_this74._tintColor=new _Color2(16777215),_this74._tintRGB=null,_this74.tint=16777215,_this74.blendMode=_BLEND_MODES.NORMAL,_this74._cachedTint=16777215,_this74.uvs=null,_this74.texture=e||Texture_Texture.EMPTY,_this74.vertexData=new Float32Array(8),_this74.vertexTrimmedData=null,_this74._transformID=-1,_this74._textureID=-1,_this74._transformTrimmedID=-1,_this74._textureTrimmedID=-1,_this74.indices=indices,_this74.pluginName="batch",_this74.isSprite=!0,_this74._roundPixels=_settings.ROUND_PIXELS;return _this74;}_inherits2(_Sprite,_Container3);return _createClass2(_Sprite,[{key:"_onTextureUpdate",value:function _onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=_sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=_sign(this.scale.y)*this._height/this._texture.orig.height);}},{key:"_onAnchorUpdate",value:function _onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1;}},{key:"calculateVertices",value:function calculateVertices(){var e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;var t=this.transform.worldTransform,r=t.a,n=t.b,i=t.c,o=t.d,a=t.tx,s=t.ty,u=this.vertexData,l=e.trim,c=e.orig,h=this._anchor;var f=0,d=0,p=0,y=0;if(l?(d=l.x-h._x*c.width,f=d+l.width,y=l.y-h._y*c.height,p=y+l.height):(d=-h._x*c.width,f=d+c.width,y=-h._y*c.height,p=y+c.height),u[0]=r*d+i*y+a,u[1]=o*y+n*d+s,u[2]=r*f+i*y+a,u[3]=o*y+n*f+s,u[4]=r*f+i*p+a,u[5]=o*p+n*f+s,u[6]=r*d+i*p+a,u[7]=o*p+n*d+s,this._roundPixels){var _e456=_settings.RESOLUTION;for(var _t221=0;_t221<u.length;++_t221)u[_t221]=Math.round(u[_t221]*_e456)/_e456;}}},{key:"calculateTrimmedVertices",value:function calculateTrimmedVertices(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,t=this.vertexTrimmedData,r=e.orig,n=this._anchor,i=this.transform.worldTransform,o=i.a,a=i.b,s=i.c,u=i.d,l=i.tx,c=i.ty,h=-n._x*r.width,f=h+r.width,d=-n._y*r.height,p=d+r.height;if(t[0]=o*h+s*d+l,t[1]=u*d+a*h+c,t[2]=o*f+s*d+l,t[3]=u*d+a*f+c,t[4]=o*f+s*p+l,t[5]=u*p+a*f+c,t[6]=o*h+s*p+l,t[7]=u*p+a*h+c,this._roundPixels){var _e457=_settings.RESOLUTION;for(var _r210=0;_r210<t.length;++_r210)t[_r210]=Math.round(t[_r210]*_e457)/_e457;}}},{key:"_render",value:function _render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this);}},{key:"_calculateBounds",value:function _calculateBounds(){var e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData));}},{key:"getLocalBounds",value:function getLocalBounds(e){return 0===this.children.length?(this._localBounds||(this._localBounds=new _Bounds()),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new _Rectangle()),e=this._localBoundsRect),this._localBounds.getRectangle(e)):_superPropGet2(_Sprite,"getLocalBounds",this,1).call(this,e);}},{key:"containsPoint",value:function containsPoint(e){this.worldTransform.applyInverse(e,tempPoint);var t=this._texture.orig.width,r=this._texture.orig.height,n=-t*this.anchor.x;var i=0;return tempPoint.x>=n&&tempPoint.x<n+t&&(i=-r*this.anchor.y,tempPoint.y>=i&&tempPoint.y<i+r);}},{key:"destroy",value:function destroy(e){if(_superPropGet2(_Sprite,"destroy",this,3)([e]),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e===null||e===void 0?void 0:e.texture){var _t222="boolean"==typeof e?e:e===null||e===void 0?void 0:e.baseTexture;this._texture.destroy(!!_t222);}this._texture=null;}},{key:"roundPixels",get:function get(){return this._roundPixels;},set:function set(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e;}},{key:"width",get:function get(){return Math.abs(this.scale.x)*this._texture.orig.width;},set:function set(e){var t=_sign(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e;}},{key:"height",get:function get(){return Math.abs(this.scale.y)*this._texture.orig.height;},set:function set(e){var t=_sign(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e;}},{key:"anchor",get:function get(){return this._anchor;},set:function set(e){this._anchor.copyFrom(e);}},{key:"tint",get:function get(){return this._tintColor.value;},set:function set(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber();}},{key:"tintValue",get:function get(){return this._tintColor.toNumber();}},{key:"texture",get:function get(){return this._texture;},set:function set(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||Texture_Texture.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)));}}],[{key:"from",value:function from(e,t){var r=e instanceof Texture_Texture?e:Texture_Texture.from(e,t);return new _Sprite(r);}}]);}(_Container2);var _tempMatrix=new _Matrix();_DisplayObject.prototype._cacheAsBitmap=!1,_DisplayObject.prototype._cacheData=null,_DisplayObject.prototype._cacheAsBitmapResolution=null,_DisplayObject.prototype._cacheAsBitmapMultisample=null;var CacheData=/*#__PURE__*/_createClass2(function CacheData(){_classCallCheck2(this,CacheData);this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null;});Object.defineProperties(_DisplayObject.prototype,{cacheAsBitmapResolution:{get:function get(){return this._cacheAsBitmapResolution;},set:function set(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0));}},cacheAsBitmapMultisample:{get:function get(){return this._cacheAsBitmapMultisample;},set:function set(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0));}},cacheAsBitmap:{get:function get(){return this._cacheAsBitmap;},set:function set(e){if(this._cacheAsBitmap===e)return;var t;this._cacheAsBitmap=e,e?(this._cacheData||(this._cacheData=new CacheData()),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea);}}}),_DisplayObject.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e));},_DisplayObject.prototype._initCachedDisplayObject=function(e){var _this$_cacheData,_this$filters2,_this$cacheAsBitmapMu;if((_this$_cacheData=this._cacheData)!==null&&_this$_cacheData!==void 0&&_this$_cacheData.sprite)return;var t=this.alpha;this.alpha=1,e.batch.flush();var r=this.getLocalBounds(new _Rectangle(),!0);if((_this$filters2=this.filters)!==null&&_this$filters2!==void 0&&_this$filters2.length){var _e458=this.filters[0].padding;r.pad(_e458);}var n=this.cacheAsBitmapResolution||e.resolution;r.ceil(n),r.width=Math.max(r.width,1/n),r.height=Math.max(r.height,1/n);var i=e.renderTexture.current,o=e.renderTexture.sourceFrame.clone(),a=e.renderTexture.destinationFrame.clone(),s=e.projection.transform,u=_RenderTexture.create({width:r.width,height:r.height,resolution:n,multisample:(_this$cacheAsBitmapMu=this.cacheAsBitmapMultisample)!==null&&_this$cacheAsBitmapMu!==void 0?_this$cacheAsBitmapMu:e.multisample}),l="cacheAsBitmap_".concat(_uid());this._cacheData.textureCacheId=l,_BaseTexture2.addToCache(u.baseTexture,l),Texture_Texture.addToCache(u,l);var c=this.transform.localTransform.copyTo(_tempMatrix).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:u,clear:!0,transform:c,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=s,e.renderTexture.bind(i,o,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;var h=new _Sprite(u);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-r.x/r.width,h.anchor.y=-r.y/r.height,h.alpha=t,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=h.containsPoint.bind(h);},_DisplayObject.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e));},_DisplayObject.prototype._initCachedDisplayObjectCanvas=function(e){var _this$_cacheData2;if((_this$_cacheData2=this._cacheData)!==null&&_this$_cacheData2!==void 0&&_this$_cacheData2.sprite)return;var t=this.getLocalBounds(new _Rectangle(),!0),r=this.alpha;this.alpha=1;var n=e.canvasContext.activeContext,i=e._projTransform,o=this.cacheAsBitmapResolution||e.resolution;t.ceil(o),t.width=Math.max(t.width,1/o),t.height=Math.max(t.height,1/o);var a=_RenderTexture.create({width:t.width,height:t.height,resolution:o}),s="cacheAsBitmap_".concat(_uid());this._cacheData.textureCacheId=s,_BaseTexture2.addToCache(a.baseTexture,s),Texture_Texture.addToCache(a,s);var u=_tempMatrix;this.transform.localTransform.copyTo(u),u.invert(),u.tx-=t.x,u.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:a,clear:!0,transform:u,skipUpdateTransform:!1}),e.canvasContext.activeContext=n,e._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;var l=new _Sprite(a);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-t.x/t.width,l.anchor.y=-t.y/t.height,l.alpha=r,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l);},_DisplayObject.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID;},_DisplayObject.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null);},_DisplayObject.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,_BaseTexture2.removeFromCache(this._cacheData.textureCacheId),Texture_Texture.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null;},_DisplayObject.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e);},_DisplayObject.prototype.name=null,_Container2.prototype.getChildByName=function(e,t){for(var _t223=0,r=this.children.length;_t223<r;_t223++)if(this.children[_t223].name===e)return this.children[_t223];if(t)for(var _t224=0,_r211=this.children.length;_t224<_r211;_t224++){var _r212=this.children[_t224];if(!_r212.getChildByName)continue;var _n136=_r212.getChildByName(e,!0);if(_n136)return _n136;}return null;},_DisplayObject.prototype.getGlobalPosition=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:new _Point();var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;return this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e;};var alpha_frag_fragment="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n";var _AlphaFilter=/*#__PURE__*/function(_Filter4){function _AlphaFilter(){var _this75;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;_classCallCheck2(this,_AlphaFilter);_this75=_callSuper2(this,_AlphaFilter,[fragments_defaultVertex,alpha_frag_fragment,{uAlpha:1}]),_this75.alpha=e;return _this75;}_inherits2(_AlphaFilter,_Filter4);return _createClass2(_AlphaFilter,[{key:"alpha",get:function get(){return this.uniforms.uAlpha;},set:function set(e){this.uniforms.uAlpha=e;}}]);}(_Filter2);var GAUSSIAN_VALUES={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},generateBlurFragSource_fragTemplate=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");function generateBlurFragSource(e){var t=GAUSSIAN_VALUES[e],r=t.length;var n=generateBlurFragSource_fragTemplate,i="";var o;for(var _n137=0;_n137<e;_n137++){var _a45="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",_n137.toString());o=_n137,_n137>=r&&(o=e-_n137-1),_a45=_a45.replace("%value%",t[o].toString()),i+=_a45,i+="\n";}return n=n.replace("%blur%",i),n=n.replace("%size%",e.toString()),n;}var vertTemplate="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }";function generateBlurVertSource(e,t){var r=Math.ceil(e/2);var n,i=vertTemplate,o="";n=t?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var _t225=0;_t225<e;_t225++){var _e459=n.replace("%index%",_t225.toString());_e459=_e459.replace("%sampleIndex%",_t225-(r-1)+".0"),o+=_e459,o+="\n";}return i=i.replace("%blur%",o),i=i.replace("%size%",e.toString()),i;}var _BlurFilterPass=/*#__PURE__*/function(_Filter5){function _BlurFilterPass(e){var _this76;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:8;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:4;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:_Filter2.defaultResolution;var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:5;_classCallCheck2(this,_BlurFilterPass);_this76=_callSuper2(this,_BlurFilterPass,[generateBlurVertSource(i,e),generateBlurFragSource(i)]),_this76.horizontal=e,_this76.resolution=n,_this76._quality=0,_this76.quality=r,_this76.blur=t;return _this76;}_inherits2(_BlurFilterPass,_Filter5);return _createClass2(_BlurFilterPass,[{key:"apply",value:function apply(e,t,r,n){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/t.width):this.uniforms.strength=1/r.height*(r.height/t.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/t.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/t.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)e.applyFilter(this,t,r,n);else{var _i99=e.getFilterTexture(),_o67=e.renderer;var _a46=t,_s37=_i99;this.state.blend=!1,e.applyFilter(this,_a46,_s37,_CLEAR_MODES.CLEAR);for(var _t226=1;_t226<this.passes-1;_t226++){e.bindAndClear(_a46,_CLEAR_MODES.BLIT),this.uniforms.uSampler=_s37;var _t227=_s37;_s37=_a46,_a46=_t227,_o67.shader.bind(this),_o67.geometry.draw(5);}this.state.blend=!0,e.applyFilter(this,_s37,r,n),e.returnFilterTexture(_i99);}}},{key:"blur",get:function get(){return this.strength;},set:function set(e){this.padding=1+2*Math.abs(e),this.strength=e;}},{key:"quality",get:function get(){return this._quality;},set:function set(e){this._quality=e,this.passes=e;}}]);}(_Filter2);var _BlurFilter=/*#__PURE__*/function(_Filter6){function _BlurFilter(){var _this77;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:8;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:4;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:_Filter2.defaultResolution;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:5;_classCallCheck2(this,_BlurFilter);_this77=_callSuper2(this,_BlurFilter),_this77._repeatEdgePixels=!1,_this77.blurXFilter=new _BlurFilterPass(!0,e,t,r,n),_this77.blurYFilter=new _BlurFilterPass(!1,e,t,r,n),_this77.resolution=r,_this77.quality=t,_this77.blur=e,_this77.repeatEdgePixels=!1;return _this77;}_inherits2(_BlurFilter,_Filter6);return _createClass2(_BlurFilter,[{key:"apply",value:function apply(e,t,r,n){var i=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(i&&o){var _i100=e.getFilterTexture();this.blurXFilter.apply(e,t,_i100,_CLEAR_MODES.CLEAR),this.blurYFilter.apply(e,_i100,r,n),e.returnFilterTexture(_i100);}else o?this.blurYFilter.apply(e,t,r,n):this.blurXFilter.apply(e,t,r,n);}},{key:"updatePadding",value:function updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength));}},{key:"blur",get:function get(){return this.blurXFilter.blur;},set:function set(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding();}},{key:"quality",get:function get(){return this.blurXFilter.quality;},set:function set(e){this.blurXFilter.quality=this.blurYFilter.quality=e;}},{key:"blurX",get:function get(){return this.blurXFilter.blur;},set:function set(e){this.blurXFilter.blur=e,this.updatePadding();}},{key:"blurY",get:function get(){return this.blurYFilter.blur;},set:function set(e){this.blurYFilter.blur=e,this.updatePadding();}},{key:"blendMode",get:function get(){return this.blurYFilter.blendMode;},set:function set(e){this.blurYFilter.blendMode=e;}},{key:"repeatEdgePixels",get:function get(){return this._repeatEdgePixels;},set:function set(e){this._repeatEdgePixels=e,this.updatePadding();}}]);}(_Filter2);var colorMatrix_frag_fragment="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n";var _ColorMatrixFilter=/*#__PURE__*/function(_Filter7){function _ColorMatrixFilter(){var _this78;_classCallCheck2(this,_ColorMatrixFilter);var e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};_this78=_callSuper2(this,_ColorMatrixFilter,[_defaultFilterVertex,colorMatrix_frag_fragment,e]),_this78.alpha=1;return _this78;}_inherits2(_ColorMatrixFilter,_Filter7);return _createClass2(_ColorMatrixFilter,[{key:"_loadMatrix",value:function _loadMatrix(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var r=e;t&&(this._multiply(r,this.uniforms.m,e),r=this._colorMatrix(r)),this.uniforms.m=r;}},{key:"_multiply",value:function _multiply(e,t,r){return e[0]=t[0]*r[0]+t[1]*r[5]+t[2]*r[10]+t[3]*r[15],e[1]=t[0]*r[1]+t[1]*r[6]+t[2]*r[11]+t[3]*r[16],e[2]=t[0]*r[2]+t[1]*r[7]+t[2]*r[12]+t[3]*r[17],e[3]=t[0]*r[3]+t[1]*r[8]+t[2]*r[13]+t[3]*r[18],e[4]=t[0]*r[4]+t[1]*r[9]+t[2]*r[14]+t[3]*r[19]+t[4],e[5]=t[5]*r[0]+t[6]*r[5]+t[7]*r[10]+t[8]*r[15],e[6]=t[5]*r[1]+t[6]*r[6]+t[7]*r[11]+t[8]*r[16],e[7]=t[5]*r[2]+t[6]*r[7]+t[7]*r[12]+t[8]*r[17],e[8]=t[5]*r[3]+t[6]*r[8]+t[7]*r[13]+t[8]*r[18],e[9]=t[5]*r[4]+t[6]*r[9]+t[7]*r[14]+t[8]*r[19]+t[9],e[10]=t[10]*r[0]+t[11]*r[5]+t[12]*r[10]+t[13]*r[15],e[11]=t[10]*r[1]+t[11]*r[6]+t[12]*r[11]+t[13]*r[16],e[12]=t[10]*r[2]+t[11]*r[7]+t[12]*r[12]+t[13]*r[17],e[13]=t[10]*r[3]+t[11]*r[8]+t[12]*r[13]+t[13]*r[18],e[14]=t[10]*r[4]+t[11]*r[9]+t[12]*r[14]+t[13]*r[19]+t[14],e[15]=t[15]*r[0]+t[16]*r[5]+t[17]*r[10]+t[18]*r[15],e[16]=t[15]*r[1]+t[16]*r[6]+t[17]*r[11]+t[18]*r[16],e[17]=t[15]*r[2]+t[16]*r[7]+t[17]*r[12]+t[18]*r[17],e[18]=t[15]*r[3]+t[16]*r[8]+t[17]*r[13]+t[18]*r[18],e[19]=t[15]*r[4]+t[16]*r[9]+t[17]*r[14]+t[18]*r[19]+t[19],e;}},{key:"_colorMatrix",value:function _colorMatrix(e){var t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t;}},{key:"brightness",value:function brightness(e,t){var r=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(r,t);}},{key:"tint",value:function tint(e,t){var _Color2$shared$setVal=_Color2.shared.setValue(e).toArray(),_Color2$shared$setVal2=_slicedToArray2(_Color2$shared$setVal,3),r=_Color2$shared$setVal2[0],n=_Color2$shared$setVal2[1],i=_Color2$shared$setVal2[2],o=[r,0,0,0,0,0,n,0,0,0,0,0,i,0,0,0,0,0,1,0];this._loadMatrix(o,t);}},{key:"greyscale",value:function greyscale(e,t){var r=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(r,t);}},{key:"blackAndWhite",value:function blackAndWhite(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e);}},{key:"hue",value:function hue(e,t){e=(e||0)/180*Math.PI;var r=Math.cos(e),n=Math.sin(e),i=1/3,o=(0,Math.sqrt)(i),a=[r+(1-r)*i,i*(1-r)-o*n,i*(1-r)+o*n,0,0,i*(1-r)+o*n,r+i*(1-r),i*(1-r)-o*n,0,0,i*(1-r)-o*n,i*(1-r)+o*n,r+i*(1-r),0,0,0,0,0,1,0];this._loadMatrix(a,t);}},{key:"contrast",value:function contrast(e,t){var r=(e||0)+1,n=-.5*(r-1),i=[r,0,0,0,n,0,r,0,0,n,0,0,r,0,n,0,0,0,1,0];this._loadMatrix(i,t);}},{key:"saturate",value:function saturate(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1?arguments[1]:undefined;var r=2*e/3+1,n=-.5*(r-1),i=[r,n,n,0,0,n,r,n,0,0,n,n,r,0,0,0,0,0,1,0];this._loadMatrix(i,t);}},{key:"desaturate",value:function desaturate(){this.saturate(-1);}},{key:"negative",value:function negative(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e);}},{key:"sepia",value:function sepia(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e);}},{key:"technicolor",value:function technicolor(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e);}},{key:"polaroid",value:function polaroid(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e);}},{key:"toBGR",value:function toBGR(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e);}},{key:"kodachrome",value:function kodachrome(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e);}},{key:"browni",value:function browni(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e);}},{key:"vintage",value:function vintage(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e);}},{key:"colorTone",value:function colorTone(e,t,r,n,i){e=e||.2,t=t||.15,r=r||16770432,n=n||3375104;var o=_Color2.shared,_o$setValue$toArray=o.setValue(r).toArray(),_o$setValue$toArray2=_slicedToArray2(_o$setValue$toArray,3),a=_o$setValue$toArray2[0],s=_o$setValue$toArray2[1],u=_o$setValue$toArray2[2],_o$setValue$toArray3=o.setValue(n).toArray(),_o$setValue$toArray4=_slicedToArray2(_o$setValue$toArray3,3),l=_o$setValue$toArray4[0],c=_o$setValue$toArray4[1],h=_o$setValue$toArray4[2],f=[.3,.59,.11,0,0,a,s,u,e,0,l,c,h,t,0,a-l,s-c,u-h,0,0];this._loadMatrix(f,i);}},{key:"night",value:function night(e,t){var r=[-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(r,t);}},{key:"predator",value:function predator(e,t){var r=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(r,t);}},{key:"lsd",value:function lsd(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e);}},{key:"reset",value:function reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1);}},{key:"matrix",get:function get(){return this.uniforms.m;},set:function set(e){this.uniforms.m=e;}},{key:"alpha",get:function get(){return this.uniforms.uAlpha;},set:function set(e){this.uniforms.uAlpha=e;}}]);}(_Filter2);_ColorMatrixFilter.prototype.grayscale=_ColorMatrixFilter.prototype.greyscale;var displacement_frag_fragment="varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",displacement_vert_vertex="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n";var _DisplacementFilter=/*#__PURE__*/function(_Filter8){function _DisplacementFilter(e,t){var _this79;_classCallCheck2(this,_DisplacementFilter);var r=new _Matrix();e.renderable=!1,_this79=_callSuper2(this,_DisplacementFilter,[displacement_vert_vertex,displacement_frag_fragment,{mapSampler:e._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}]),_this79.maskSprite=e,_this79.maskMatrix=r,null==t&&(t=20),_this79.scale=new _Point(t,t);return _this79;}_inherits2(_DisplacementFilter,_Filter8);return _createClass2(_DisplacementFilter,[{key:"apply",value:function apply(e,t,r,n){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var i=this.maskSprite.worldTransform,o=Math.sqrt(i.a*i.a+i.b*i.b),a=Math.sqrt(i.c*i.c+i.d*i.d);0!==o&&0!==a&&(this.uniforms.rotation[0]=i.a/o,this.uniforms.rotation[1]=i.b/o,this.uniforms.rotation[2]=i.c/a,this.uniforms.rotation[3]=i.d/a),e.applyFilter(this,t,r,n);}},{key:"map",get:function get(){return this.uniforms.mapSampler;},set:function set(e){this.uniforms.mapSampler=e;}}]);}(_Filter2);var fxaa_frag_fragment='varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n',fxaa_vert_vertex="\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n";var _FXAAFilter=/*#__PURE__*/function(_Filter9){function _FXAAFilter(){_classCallCheck2(this,_FXAAFilter);return _callSuper2(this,_FXAAFilter,[fxaa_vert_vertex,fxaa_frag_fragment]);}_inherits2(_FXAAFilter,_Filter9);return _createClass2(_FXAAFilter);}(_Filter2);var noise_frag_fragment="precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n";var _NoiseFilter=/*#__PURE__*/function(_Filter10){function _NoiseFilter(){var _this80;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:.5;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Math.random();_classCallCheck2(this,_NoiseFilter);_this80=_callSuper2(this,_NoiseFilter,[_defaultFilterVertex,noise_frag_fragment,{uNoise:0,uSeed:0}]),_this80.noise=e,_this80.seed=t;return _this80;}_inherits2(_NoiseFilter,_Filter10);return _createClass2(_NoiseFilter,[{key:"noise",get:function get(){return this.uniforms.uNoise;},set:function set(e){this.uniforms.uNoise=e;}},{key:"seed",get:function get(){return this.uniforms.uSeed;},set:function set(e){this.uniforms.uSeed=e;}}]);}(_Filter2);var _filters={AlphaFilter:_AlphaFilter,BlurFilter:_BlurFilter,BlurFilterPass:_BlurFilterPass,ColorMatrixFilter:_ColorMatrixFilter,DisplacementFilter:_DisplacementFilter,FXAAFilter:_FXAAFilter,NoiseFilter:_NoiseFilter};Object.entries(_filters).forEach(function(_ref44){var _ref45=_slicedToArray2(_ref44,2),e=_ref45[0],t=_ref45[1];Object.defineProperty(_filters,e,{get:function get(){return _deprecation("7.1.0","filters.".concat(e," has moved to ").concat(e)),t;}});});var EventsTickerClass=/*#__PURE__*/function(){function EventsTickerClass(){_classCallCheck2(this,EventsTickerClass);this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0;}return _createClass2(EventsTickerClass,[{key:"init",value:function init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0;}},{key:"pauseUpdate",get:function get(){return this._pauseUpdate;},set:function set(e){this._pauseUpdate=e;}},{key:"addTickerListener",value:function addTickerListener(){this.tickerAdded||!this.domElement||(_Ticker2.system.add(this.tickerUpdate,this,_UPDATE_PRIORITY.INTERACTION),this.tickerAdded=!0);}},{key:"removeTickerListener",value:function removeTickerListener(){this.tickerAdded&&(_Ticker2.system.remove(this.tickerUpdate,this),this.tickerAdded=!1);}},{key:"pointerMoved",value:function pointerMoved(){this._didMove=!0;}},{key:"update",value:function update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove)return void(this._didMove=!1);var e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&"touch"===e.pointerType||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}));}},{key:"tickerUpdate",value:function tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update());}}]);}();var EventsTicker=new EventsTickerClass();var _FederatedEvent=/*#__PURE__*/function(){function _FederatedEvent(e){_classCallCheck2(this,_FederatedEvent);this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=_FederatedEvent.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new _Point(),this.page=new _Point(),this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e;}return _createClass2(_FederatedEvent,[{key:"layerX",get:function get(){return this.layer.x;}},{key:"layerY",get:function get(){return this.layer.y;}},{key:"pageX",get:function get(){return this.page.x;}},{key:"pageY",get:function get(){return this.page.y;}},{key:"data",get:function get(){return this;}},{key:"composedPath",value:function composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path;}},{key:"initEvent",value:function initEvent(e,t,r){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.");}},{key:"initUIEvent",value:function initUIEvent(e,t,r,n,i){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.");}},{key:"preventDefault",value:function preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0;}},{key:"stopImmediatePropagation",value:function stopImmediatePropagation(){this.propagationImmediatelyStopped=!0;}},{key:"stopPropagation",value:function stopPropagation(){this.propagationStopped=!0;}}]);}();var _FederatedMouseEvent=/*#__PURE__*/function(_FederatedEvent2){function _FederatedMouseEvent(){var _this81;_classCallCheck2(this,_FederatedMouseEvent);_this81=_callSuper2(this,_FederatedMouseEvent,arguments),_this81.client=new _Point(),_this81.movement=new _Point(),_this81.offset=new _Point(),_this81.global=new _Point(),_this81.screen=new _Point();return _this81;}_inherits2(_FederatedMouseEvent,_FederatedEvent2);return _createClass2(_FederatedMouseEvent,[{key:"clientX",get:function get(){return this.client.x;}},{key:"clientY",get:function get(){return this.client.y;}},{key:"x",get:function get(){return this.clientX;}},{key:"y",get:function get(){return this.clientY;}},{key:"movementX",get:function get(){return this.movement.x;}},{key:"movementY",get:function get(){return this.movement.y;}},{key:"offsetX",get:function get(){return this.offset.x;}},{key:"offsetY",get:function get(){return this.offset.y;}},{key:"globalX",get:function get(){return this.global.x;}},{key:"globalY",get:function get(){return this.global.y;}},{key:"screenX",get:function get(){return this.screen.x;}},{key:"screenY",get:function get(){return this.screen.y;}},{key:"getLocalPosition",value:function getLocalPosition(e,t,r){return e.worldTransform.applyInverse(r||this.global,t);}},{key:"getModifierState",value:function getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e);}},{key:"initMouseEvent",value:function initMouseEvent(e,t,r,n,i,o,a,s,u,l,c,h,f,d,p){throw new Error("Method not implemented.");}}]);}(_FederatedEvent);var _FederatedPointerEvent=/*#__PURE__*/function(_FederatedMouseEvent2){function _FederatedPointerEvent(){var _this82;_classCallCheck2(this,_FederatedPointerEvent);_this82=_callSuper2(this,_FederatedPointerEvent,arguments),_this82.width=0,_this82.height=0,_this82.isPrimary=!1;return _this82;}_inherits2(_FederatedPointerEvent,_FederatedMouseEvent2);return _createClass2(_FederatedPointerEvent,[{key:"getCoalescedEvents",value:function getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[];}},{key:"getPredictedEvents",value:function getPredictedEvents(){throw new Error("getPredictedEvents is not supported!");}}]);}(_FederatedMouseEvent);var _FederatedWheelEvent=/*#__PURE__*/function(_FederatedMouseEvent3){function _FederatedWheelEvent(){var _this83;_classCallCheck2(this,_FederatedWheelEvent);_this83=_callSuper2(this,_FederatedWheelEvent,arguments),_this83.DOM_DELTA_PIXEL=0,_this83.DOM_DELTA_LINE=1,_this83.DOM_DELTA_PAGE=2;return _this83;}_inherits2(_FederatedWheelEvent,_FederatedMouseEvent3);return _createClass2(_FederatedWheelEvent);}(_FederatedMouseEvent);_FederatedWheelEvent.DOM_DELTA_PIXEL=0,_FederatedWheelEvent.DOM_DELTA_LINE=1,_FederatedWheelEvent.DOM_DELTA_PAGE=2;var PROPAGATION_LIMIT=2048,tempHitLocation=new _Point(),tempLocalMapping=new _Point();var _EventBoundary=/*#__PURE__*/function(){function _EventBoundary(e){_classCallCheck2(this,_EventBoundary);this.dispatch=new utils_node_modules_eventemitter3(),this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map(),this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel);}return _createClass2(_EventBoundary,[{key:"addEventMapping",value:function addEventMapping(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(function(e,t){return e.priority-t.priority;});}},{key:"dispatchEvent",value:function dispatchEvent(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e);}},{key:"mapEvent",value:function mapEvent(e){if(!this.rootTarget)return;var t=this.mappingTable[e.type];if(t)for(var r=0,_n138=t.length;r<_n138;r++)t[r].fn(e);else console.warn("[EventBoundary]: Event mapping not defined for ".concat(e.type));}},{key:"hitTest",value:function hitTest(e,t){EventsTicker.pauseUpdate=!0;var r=this[this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,tempHitLocation.set(e,t),this.hitTestFn,this.hitPruneFn);return r&&r[0];}},{key:"propagate",value:function propagate(e,t){if(!e.target)return;var r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var _n139=0,_i101=r.length-1;_n139<_i101;_n139++)if(e.currentTarget=r[_n139],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!e.propagationStopped&&!e.propagationImmediatelyStopped){e.eventPhase=e.BUBBLING_PHASE;for(var _n140=r.length-2;_n140>=0;_n140--)if(e.currentTarget=r[_n140],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;}}},{key:"all",value:function all(e,t){var _this84=this;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this._allInteractiveElements;if(0===r.length)return;e.eventPhase=e.BUBBLING_PHASE;var n=Array.isArray(t)?t:[t];var _loop10=function _loop10(_t228){n.forEach(function(n){e.currentTarget=r[_t228],_this84.notifyTarget(e,n);});};for(var _t228=r.length-1;_t228>=0;_t228--){_loop10(_t228);}}},{key:"propagationPath",value:function propagationPath(e){var t=[e];for(var r=0;r<PROPAGATION_LIMIT&&e!==this.rootTarget;r++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");t.push(e.parent),e=e.parent;}return t.reverse(),t;}},{key:"hitTestMoveRecursive",value:function hitTestMoveRecursive(e,t,r,n,i){var o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:!1;var a=!1;if(this._interactivePrune(e))return null;if(("dynamic"===e.eventMode||"dynamic"===t)&&(EventsTicker.pauseUpdate=!1),e.interactiveChildren&&e.children){var _s38=e.children;for(var _u27=_s38.length-1;_u27>=0;_u27--){var _l18=_s38[_u27],_c18=this.hitTestMoveRecursive(_l18,this._isInteractive(t)?t:_l18.eventMode,r,n,i,o||i(e,r));if(_c18){if(_c18.length>0&&!_c18[_c18.length-1].parent)continue;var _t229=e.isInteractive();(_c18.length>0||_t229)&&(_t229&&this._allInteractiveElements.push(e),_c18.push(e)),0===this._hitElements.length&&(this._hitElements=_c18),a=!0;}}}var s=this._isInteractive(t),u=e.isInteractive();return s&&u&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:s&&!i(e,r)&&n(e,r)?u?[e]:[]:null;}},{key:"hitTestRecursive",value:function hitTestRecursive(e,t,r,n,i){if(this._interactivePrune(e)||i(e,r))return null;if(("dynamic"===e.eventMode||"dynamic"===t)&&(EventsTicker.pauseUpdate=!1),e.interactiveChildren&&e.children){var _o68=e.children;for(var _a47=_o68.length-1;_a47>=0;_a47--){var _s39=_o68[_a47],_u28=this.hitTestRecursive(_s39,this._isInteractive(t)?t:_s39.eventMode,r,n,i);if(_u28){if(_u28.length>0&&!_u28[_u28.length-1].parent)continue;var _t230=e.isInteractive();return(_u28.length>0||_t230)&&_u28.push(e),_u28;}}}var o=this._isInteractive(t),a=e.isInteractive();return o&&n(e,r)?a?[e]:[]:null;}},{key:"_isInteractive",value:function _isInteractive(e){return"static"===e||"dynamic"===e;}},{key:"_interactivePrune",value:function _interactivePrune(e){return!(e&&!e.isMask&&e.visible&&e.renderable&&"none"!==e.eventMode&&("passive"!==e.eventMode||e.interactiveChildren)&&!e.isMask);}},{key:"hitPruneFn",value:function hitPruneFn(e,t){if(e.hitArea&&(e.worldTransform.applyInverse(t,tempLocalMapping),!e.hitArea.contains(tempLocalMapping.x,tempLocalMapping.y)))return!0;if(e._mask){var _r$containsPoint;var r=e._mask.isMaskData?e._mask.maskObject:e._mask;if(r&&!((_r$containsPoint=r.containsPoint)!==null&&_r$containsPoint!==void 0&&_r$containsPoint.call(r,t)))return!0;}return!1;}},{key:"hitTestFn",value:function hitTestFn(e,t){return"passive"!==e.eventMode&&(!!e.hitArea||!!e.containsPoint&&e.containsPoint(t));}},{key:"notifyTarget",value:function notifyTarget(e,t){var _t231,_e$currentTarget$r,_e$currentTarget;var r="on".concat(t=(_t231=t)!==null&&_t231!==void 0?_t231:e.type);(_e$currentTarget$r=(_e$currentTarget=e.currentTarget)[r])===null||_e$currentTarget$r===void 0||_e$currentTarget$r.call(_e$currentTarget,e);var n=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this.notifyListeners(e,n),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t);}},{key:"mapPointerDown",value:function mapPointerDown(e){if(!(e instanceof _FederatedPointerEvent))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");var t=this.createPointerEvent(e);if(this.dispatchEvent(t,"pointerdown"),"touch"===t.pointerType)this.dispatchEvent(t,"touchstart");else if("mouse"===t.pointerType||"pen"===t.pointerType){var _e460=2===t.button;this.dispatchEvent(t,_e460?"rightdown":"mousedown");}this.trackingData(e.pointerId).pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t);}},{key:"mapPointerMove",value:function mapPointerMove(e){var _n$overTargets,_this$enableGlobalMov,_t$target;if(!(e instanceof _FederatedPointerEvent))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;var t=this.createPointerEvent(e);this._isPointerMoveEvent=!1;var r="mouse"===t.pointerType||"pen"===t.pointerType,n=this.trackingData(e.pointerId),i=this.findMountedTarget(n.overTargets);if(((_n$overTargets=n.overTargets)===null||_n$overTargets===void 0?void 0:_n$overTargets.length)>0&&i!==t.target){var _n141="mousemove"===e.type?"mouseout":"pointerout",_o69=this.createPointerEvent(e,_n141,i);if(this.dispatchEvent(_o69,"pointerout"),r&&this.dispatchEvent(_o69,"mouseout"),!t.composedPath().includes(i)){var _n142=this.createPointerEvent(e,"pointerleave",i);for(_n142.eventPhase=_n142.AT_TARGET;_n142.target&&!t.composedPath().includes(_n142.target);)_n142.currentTarget=_n142.target,this.notifyTarget(_n142),r&&this.notifyTarget(_n142,"mouseleave"),_n142.target=_n142.target.parent;this.freeEvent(_n142);}this.freeEvent(_o69);}if(i!==t.target){var _n143="mousemove"===e.type?"mouseover":"pointerover",_o70=this.clonePointerEvent(t,_n143);this.dispatchEvent(_o70,"pointerover"),r&&this.dispatchEvent(_o70,"mouseover");var _a48=i===null||i===void 0?void 0:i.parent;for(;_a48&&_a48!==this.rootTarget.parent&&_a48!==t.target;)_a48=_a48.parent;if(!_a48||_a48===this.rootTarget.parent){var _e461=this.clonePointerEvent(t,"pointerenter");for(_e461.eventPhase=_e461.AT_TARGET;_e461.target&&_e461.target!==i&&_e461.target!==this.rootTarget.parent;)_e461.currentTarget=_e461.target,this.notifyTarget(_e461),r&&this.notifyTarget(_e461,"mouseenter"),_e461.target=_e461.target.parent;this.freeEvent(_e461);}this.freeEvent(_o70);}var o=[],a=(_this$enableGlobalMov=this.enableGlobalMoveEvents)!==null&&_this$enableGlobalMov!==void 0?_this$enableGlobalMov:!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(t,"pointermove"),a&&o.push("globalpointermove"),"touch"===t.pointerType&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(t,"touchmove"),a&&o.push("globaltouchmove")),r&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(t,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(_t$target=t.target)===null||_t$target===void 0?void 0:_t$target.cursor),o.length>0&&this.all(t,o),this._allInteractiveElements.length=0,this._hitElements.length=0,n.overTargets=t.composedPath(),this.freeEvent(t);}},{key:"mapPointerOver",value:function mapPointerOver(e){var _r$target;if(!(e instanceof _FederatedPointerEvent))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");var t=this.trackingData(e.pointerId),r=this.createPointerEvent(e),n="mouse"===r.pointerType||"pen"===r.pointerType;this.dispatchEvent(r,"pointerover"),n&&this.dispatchEvent(r,"mouseover"),"mouse"===r.pointerType&&(this.cursor=(_r$target=r.target)===null||_r$target===void 0?void 0:_r$target.cursor);var i=this.clonePointerEvent(r,"pointerenter");for(i.eventPhase=i.AT_TARGET;i.target&&i.target!==this.rootTarget.parent;)i.currentTarget=i.target,this.notifyTarget(i),n&&this.notifyTarget(i,"mouseenter"),i.target=i.target.parent;t.overTargets=r.composedPath(),this.freeEvent(r),this.freeEvent(i);}},{key:"mapPointerOut",value:function mapPointerOut(e){if(!(e instanceof _FederatedPointerEvent))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");var t=this.trackingData(e.pointerId);if(t.overTargets){var r="mouse"===e.pointerType||"pen"===e.pointerType,_n144=this.findMountedTarget(t.overTargets),_i102=this.createPointerEvent(e,"pointerout",_n144);this.dispatchEvent(_i102),r&&this.dispatchEvent(_i102,"mouseout");var _o71=this.createPointerEvent(e,"pointerleave",_n144);for(_o71.eventPhase=_o71.AT_TARGET;_o71.target&&_o71.target!==this.rootTarget.parent;)_o71.currentTarget=_o71.target,this.notifyTarget(_o71),r&&this.notifyTarget(_o71,"mouseleave"),_o71.target=_o71.target.parent;t.overTargets=null,this.freeEvent(_i102),this.freeEvent(_o71);}this.cursor=null;}},{key:"mapPointerUp",value:function mapPointerUp(e){if(!(e instanceof _FederatedPointerEvent))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");var t=performance.now(),r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerup"),"touch"===r.pointerType)this.dispatchEvent(r,"touchend");else if("mouse"===r.pointerType||"pen"===r.pointerType){var _e462=2===r.button;this.dispatchEvent(r,_e462?"rightup":"mouseup");}var n=this.trackingData(e.pointerId),i=this.findMountedTarget(n.pressTargetsByButton[e.button]);var o=i;if(i&&!r.composedPath().includes(i)){var _t232=i;for(;_t232&&!r.composedPath().includes(_t232);){if(r.currentTarget=_t232,this.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType)this.notifyTarget(r,"touchendoutside");else if("mouse"===r.pointerType||"pen"===r.pointerType){var _e463=2===r.button;this.notifyTarget(r,_e463?"rightupoutside":"mouseupoutside");}_t232=_t232.parent;}delete n.pressTargetsByButton[e.button],o=_t232;}if(o){var _i103=this.clonePointerEvent(r,"click");_i103.target=o,_i103.path=null,n.clicksByButton[e.button]||(n.clicksByButton[e.button]={clickCount:0,target:_i103.target,timeStamp:t});var _a49=n.clicksByButton[e.button];if(_a49.target===_i103.target&&t-_a49.timeStamp<200?++_a49.clickCount:_a49.clickCount=1,_a49.target=_i103.target,_a49.timeStamp=t,_i103.detail=_a49.clickCount,"mouse"===_i103.pointerType){var _e464=2===_i103.button;this.dispatchEvent(_i103,_e464?"rightclick":"click");}else"touch"===_i103.pointerType&&this.dispatchEvent(_i103,"tap");this.dispatchEvent(_i103,"pointertap"),this.freeEvent(_i103);}this.freeEvent(r);}},{key:"mapPointerUpOutside",value:function mapPointerUpOutside(e){if(!(e instanceof _FederatedPointerEvent))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");var t=this.trackingData(e.pointerId),r=this.findMountedTarget(t.pressTargetsByButton[e.button]),n=this.createPointerEvent(e);if(r){var _i104=r;for(;_i104;)n.currentTarget=_i104,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType?this.notifyTarget(n,"touchendoutside"):("mouse"===n.pointerType||"pen"===n.pointerType)&&this.notifyTarget(n,2===n.button?"rightupoutside":"mouseupoutside"),_i104=_i104.parent;delete t.pressTargetsByButton[e.button];}this.freeEvent(n);}},{key:"mapWheel",value:function mapWheel(e){if(!(e instanceof _FederatedWheelEvent))return void console.warn("EventBoundary cannot map a non-wheel event as a wheel event");var t=this.createWheelEvent(e);this.dispatchEvent(t),this.freeEvent(t);}},{key:"findMountedTarget",value:function findMountedTarget(e){if(!e)return null;var t=e[0];for(var r=1;r<e.length&&e[r].parent===t;r++)t=e[r];return t;}},{key:"createPointerEvent",value:function createPointerEvent(e,t,r){var _ref46;var n=this.allocateEvent(_FederatedPointerEvent);return this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e,n.target=(_ref46=r!==null&&r!==void 0?r:this.hitTest(n.global.x,n.global.y))!==null&&_ref46!==void 0?_ref46:this._hitElements[0],"string"==typeof t&&(n.type=t),n;}},{key:"createWheelEvent",value:function createWheelEvent(e){var t=this.allocateEvent(_FederatedWheelEvent);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t;}},{key:"clonePointerEvent",value:function clonePointerEvent(e,t){var r=this.allocateEvent(_FederatedPointerEvent);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=t!==null&&t!==void 0?t:r.type,r;}},{key:"copyWheelData",value:function copyWheelData(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;}},{key:"copyPointerData",value:function copyPointerData(e,t){e instanceof _FederatedPointerEvent&&t instanceof _FederatedPointerEvent&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist);}},{key:"copyMouseData",value:function copyMouseData(e,t){e instanceof _FederatedMouseEvent&&t instanceof _FederatedMouseEvent&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.shiftKey=e.shiftKey,t.global.copyFrom(e.global));}},{key:"copyData",value:function copyData(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page);}},{key:"trackingData",value:function trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e];}},{key:"allocateEvent",value:function allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=null,t.target=null,t;}},{key:"freeEvent",value:function freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e);}},{key:"notifyListeners",value:function notifyListeners(e,t){var r=e.currentTarget._events[t];if(r&&e.currentTarget.isInteractive())if("fn"in r)r.once&&e.currentTarget.removeListener(t,r.fn,void 0,!0),r.fn.call(r.context,e);else for(var _n145=0,_i105=r.length;_n145<_i105&&!e.propagationImmediatelyStopped;_n145++)r[_n145].once&&e.currentTarget.removeListener(t,r[_n145].fn,void 0,!0),r[_n145].fn.call(r[_n145].context,e);}}]);}();var MOUSE_POINTER_ID=1,TOUCH_TO_POINTER={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},_EventSystem=/*#__PURE__*/function(){function e(t){var _this85=this;_classCallCheck2(this,e);this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new _EventBoundary(null),EventsTicker.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new _FederatedPointerEvent(null),this.rootWheelEvent=new _FederatedWheelEvent(null),this.cursorStyles={"default":"inherit",pointer:"pointer"},this.features=new Proxy(_objectSpread({},e.defaultEventFeatures),{set:function set(_e465,t,r){return"globalMove"===t&&(_this85.rootBoundary.enableGlobalMoveEvents=r),_e465[t]=r,!0;}}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this);}return _createClass2(e,[{key:"init",value:function init(t){var _t$eventMode,_t$eventFeatures;var _this$renderer5=this.renderer,r=_this$renderer5.view,n=_this$renderer5.resolution;this.setTargetElement(r),this.resolution=n,e._defaultEventMode=(_t$eventMode=t.eventMode)!==null&&_t$eventMode!==void 0?_t$eventMode:"auto",Object.assign(this.features,(_t$eventFeatures=t.eventFeatures)!==null&&_t$eventFeatures!==void 0?_t$eventFeatures:{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove;}},{key:"resolutionChange",value:function resolutionChange(_e466){this.resolution=_e466;}},{key:"destroy",value:function destroy(){this.setTargetElement(null),this.renderer=null;}},{key:"setCursor",value:function setCursor(_e467){_e467=_e467||"default";var t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===_e467)return;this.currentCursor=_e467;var r=this.cursorStyles[_e467];if(r)switch(_typeof2(r)){case"string":t&&(this.domElement.style.cursor=r);break;case"function":r(_e467);break;case"object":t&&Object.assign(this.domElement.style,r);}else t&&"string"==typeof _e467&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,_e467)&&(this.domElement.style.cursor=_e467);}},{key:"pointer",get:function get(){return this.rootPointerEvent;}},{key:"onPointerDown",value:function onPointerDown(_e468){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;var t=this.normalizeToPointerData(_e468);this.autoPreventDefault&&t[0].isNormalized&&(_e468.cancelable||!("cancelable"in _e468))&&_e468.preventDefault();for(var _e485=0,r=t.length;_e485<r;_e485++){var _r213=t[_e485],_n146=this.bootstrapEvent(this.rootPointerEvent,_r213);this.rootBoundary.mapEvent(_n146);}this.setCursor(this.rootBoundary.cursor);}},{key:"onPointerMove",value:function onPointerMove(_e470){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,EventsTicker.pointerMoved();var t=this.normalizeToPointerData(_e470);for(var _e486=0,r=t.length;_e486<r;_e486++){var _r214=this.bootstrapEvent(this.rootPointerEvent,t[_e486]);this.rootBoundary.mapEvent(_r214);}this.setCursor(this.rootBoundary.cursor);}},{key:"onPointerUp",value:function onPointerUp(_e472){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;var t=_e472.target;_e472.composedPath&&_e472.composedPath().length>0&&(t=_e472.composedPath()[0]);var r=t!==this.domElement?"outside":"",n=this.normalizeToPointerData(_e472);for(var _e487=0,_t233=n.length;_e487<_t233;_e487++){var _t234=this.bootstrapEvent(this.rootPointerEvent,n[_e487]);_t234.type+=r,this.rootBoundary.mapEvent(_t234);}this.setCursor(this.rootBoundary.cursor);}},{key:"onPointerOverOut",value:function onPointerOverOut(_e474){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;var t=this.normalizeToPointerData(_e474);for(var _e488=0,r=t.length;_e488<r;_e488++){var _r215=this.bootstrapEvent(this.rootPointerEvent,t[_e488]);this.rootBoundary.mapEvent(_r215);}this.setCursor(this.rootBoundary.cursor);}},{key:"onWheel",value:function onWheel(_e476){if(!this.features.wheel)return;var t=this.normalizeWheelEvent(_e476);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t);}},{key:"setTargetElement",value:function setTargetElement(_e477){this.removeEvents(),this.domElement=_e477,EventsTicker.domElement=_e477,this.addEvents();}},{key:"addEvents",value:function addEvents(){if(this.eventsAdded||!this.domElement)return;EventsTicker.addTickerListener();var _e478=this.domElement.style;_e478&&(globalThis.navigator.msPointerEnabled?(_e478.msContentZooming="none",_e478.msTouchAction="none"):this.supportsPointerEvents&&(_e478.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0;}},{key:"removeEvents",value:function removeEvents(){if(!this.eventsAdded||!this.domElement)return;EventsTicker.removeTickerListener();var _e479=this.domElement.style;globalThis.navigator.msPointerEnabled?(_e479.msContentZooming="",_e479.msTouchAction=""):this.supportsPointerEvents&&(_e479.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1;}},{key:"mapPositionToPoint",value:function mapPositionToPoint(_e480,t,r){var n=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},i=1/this.resolution;_e480.x=(t-n.left)*(this.domElement.width/n.width)*i,_e480.y=(r-n.top)*(this.domElement.height/n.height)*i;}},{key:"normalizeToPointerData",value:function normalizeToPointerData(_e481){var t=[];if(this.supportsTouchEvents&&_e481 instanceof TouchEvent)for(var r=0,_n147=_e481.changedTouches.length;r<_n147;r++){var _n148=_e481.changedTouches[r];_typeof2(_n148.button)>"u"&&(_n148.button=0),_typeof2(_n148.buttons)>"u"&&(_n148.buttons=1),_typeof2(_n148.isPrimary)>"u"&&(_n148.isPrimary=1===_e481.touches.length&&"touchstart"===_e481.type),_typeof2(_n148.width)>"u"&&(_n148.width=_n148.radiusX||1),_typeof2(_n148.height)>"u"&&(_n148.height=_n148.radiusY||1),_typeof2(_n148.tiltX)>"u"&&(_n148.tiltX=0),_typeof2(_n148.tiltY)>"u"&&(_n148.tiltY=0),_typeof2(_n148.pointerType)>"u"&&(_n148.pointerType="touch"),_typeof2(_n148.pointerId)>"u"&&(_n148.pointerId=_n148.identifier||0),_typeof2(_n148.pressure)>"u"&&(_n148.pressure=_n148.force||.5),_typeof2(_n148.twist)>"u"&&(_n148.twist=0),_typeof2(_n148.tangentialPressure)>"u"&&(_n148.tangentialPressure=0),_typeof2(_n148.layerX)>"u"&&(_n148.layerX=_n148.offsetX=_n148.clientX),_typeof2(_n148.layerY)>"u"&&(_n148.layerY=_n148.offsetY=_n148.clientY),_n148.isNormalized=!0,_n148.type=_e481.type,t.push(_n148);}else if(globalThis.MouseEvent&&(!(_e481 instanceof MouseEvent)||this.supportsPointerEvents&&_e481 instanceof globalThis.PointerEvent))t.push(_e481);else{var _r216=_e481;_typeof2(_r216.isPrimary)>"u"&&(_r216.isPrimary=!0),_typeof2(_r216.width)>"u"&&(_r216.width=1),_typeof2(_r216.height)>"u"&&(_r216.height=1),_typeof2(_r216.tiltX)>"u"&&(_r216.tiltX=0),_typeof2(_r216.tiltY)>"u"&&(_r216.tiltY=0),_typeof2(_r216.pointerType)>"u"&&(_r216.pointerType="mouse"),_typeof2(_r216.pointerId)>"u"&&(_r216.pointerId=MOUSE_POINTER_ID),_typeof2(_r216.pressure)>"u"&&(_r216.pressure=.5),_typeof2(_r216.twist)>"u"&&(_r216.twist=0),_typeof2(_r216.tangentialPressure)>"u"&&(_r216.tangentialPressure=0),_r216.isNormalized=!0,t.push(_r216);}return t;}},{key:"normalizeWheelEvent",value:function normalizeWheelEvent(_e482){var t=this.rootWheelEvent;return this.transferMouseData(t,_e482),t.deltaX=_e482.deltaX,t.deltaY=_e482.deltaY,t.deltaZ=_e482.deltaZ,t.deltaMode=_e482.deltaMode,this.mapPositionToPoint(t.screen,_e482.clientX,_e482.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=_e482,t.type=_e482.type,t;}},{key:"bootstrapEvent",value:function bootstrapEvent(_e483,t){return _e483.originalEvent=null,_e483.nativeEvent=t,_e483.pointerId=t.pointerId,_e483.width=t.width,_e483.height=t.height,_e483.isPrimary=t.isPrimary,_e483.pointerType=t.pointerType,_e483.pressure=t.pressure,_e483.tangentialPressure=t.tangentialPressure,_e483.tiltX=t.tiltX,_e483.tiltY=t.tiltY,_e483.twist=t.twist,this.transferMouseData(_e483,t),this.mapPositionToPoint(_e483.screen,t.clientX,t.clientY),_e483.global.copyFrom(_e483.screen),_e483.offset.copyFrom(_e483.screen),_e483.isTrusted=t.isTrusted,"pointerleave"===_e483.type&&(_e483.type="pointerout"),_e483.type.startsWith("mouse")&&(_e483.type=_e483.type.replace("mouse","pointer")),_e483.type.startsWith("touch")&&(_e483.type=TOUCH_TO_POINTER[_e483.type]||_e483.type),_e483;}},{key:"transferMouseData",value:function transferMouseData(_e484,t){_e484.isTrusted=t.isTrusted,_e484.srcElement=t.srcElement,_e484.timeStamp=performance.now(),_e484.type=t.type,_e484.altKey=t.altKey,_e484.button=t.button,_e484.buttons=t.buttons,_e484.client.x=t.clientX,_e484.client.y=t.clientY,_e484.ctrlKey=t.ctrlKey,_e484.metaKey=t.metaKey,_e484.movement.x=t.movementX,_e484.movement.y=t.movementY,_e484.page.x=t.pageX,_e484.page.y=t.pageY,_e484.relatedTarget=null,_e484.shiftKey=t.shiftKey;}}],[{key:"defaultEventMode",get:function get(){return this._defaultEventMode;}}]);}();_EventSystem.extension={name:"events",type:[_ExtensionType.RendererSystem,_ExtensionType.CanvasRendererSystem]},_EventSystem.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};var _EventSystem2=_EventSystem;function convertEventModeToInteractiveMode(e){return"dynamic"===e||"static"===e;}_extensions.add(_EventSystem2);var _FederatedDisplayObject={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){var _this$_internalIntera;return(_this$_internalIntera=this._internalInteractive)!==null&&_this$_internalIntera!==void 0?_this$_internalIntera:convertEventModeToInteractiveMode(_EventSystem2.defaultEventMode);},set interactive(e){_deprecation("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=e,this.eventMode=e?"static":"auto";},_internalEventMode:void 0,get eventMode(){var _this$_internalEventM;return(_this$_internalEventM=this._internalEventMode)!==null&&_this$_internalEventM!==void 0?_this$_internalEventM:_EventSystem2.defaultEventMode;},set eventMode(e){this._internalInteractive=convertEventModeToInteractiveMode(e),this._internalEventMode=e;},isInteractive:function isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode;},interactiveChildren:!0,hitArea:null,addEventListener:function addEventListener(e,t,r){var n="boolean"==typeof r&&r||"object"==_typeof2(r)&&r.capture,i="object"==_typeof2(r)?r.signal:void 0,o="object"==_typeof2(r)&&!0===r.once,a="function"==typeof t?void 0:t;e=n?"".concat(e,"capture"):e;var s="function"==typeof t?t:t.handleEvent,u=this;i&&i.addEventListener("abort",function(){u.off(e,s,a);}),o?u.once(e,s,a):u.on(e,s,a);},removeEventListener:function removeEventListener(e,t,r){var n="function"==typeof t?void 0:t;e="boolean"==typeof r&&r||"object"==_typeof2(r)&&r.capture?"".concat(e,"capture"):e,t="function"==typeof t?t:t.handleEvent,this.off(e,t,n);},dispatchEvent:function dispatchEvent(e){if(!(e instanceof _FederatedEvent))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented;}};_DisplayObject.mixin(_FederatedDisplayObject);var _accessibleTarget={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};_DisplayObject.mixin(_accessibleTarget);var KEY_CODE_TAB=9,DIV_TOUCH_SIZE=100,DIV_TOUCH_POS_X=0,DIV_TOUCH_POS_Y=0,DIV_TOUCH_ZINDEX=2,DIV_HOOK_SIZE=1,DIV_HOOK_POS_X=-1e3,DIV_HOOK_POS_Y=-1e3,DIV_HOOK_ZINDEX=2;var _AccessibilityManager=/*#__PURE__*/function(){function _AccessibilityManager(e){_classCallCheck2(this,_AccessibilityManager);this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(isMobile_isMobile.tablet||isMobile_isMobile.phone)&&this.createTouchHook();var t=document.createElement("div");t.style.width="".concat(DIV_TOUCH_SIZE,"px"),t.style.height="".concat(DIV_TOUCH_SIZE,"px"),t.style.position="absolute",t.style.top="".concat(DIV_TOUCH_POS_X,"px"),t.style.left="".concat(DIV_TOUCH_POS_Y,"px"),t.style.zIndex=DIV_TOUCH_ZINDEX.toString(),this.div=t,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1);}return _createClass2(_AccessibilityManager,[{key:"isActive",get:function get(){return this._isActive;}},{key:"isMobileAccessibility",get:function get(){return this._isMobileAccessibility;}},{key:"createTouchHook",value:function createTouchHook(){var _this86=this;var e=document.createElement("button");e.style.width="".concat(DIV_HOOK_SIZE,"px"),e.style.height="".concat(DIV_HOOK_SIZE,"px"),e.style.position="absolute",e.style.top="".concat(DIV_HOOK_POS_X,"px"),e.style.left="".concat(DIV_HOOK_POS_Y,"px"),e.style.zIndex=DIV_HOOK_ZINDEX.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",function(){_this86._isMobileAccessibility=!0,_this86.activate(),_this86.destroyTouchHook();}),document.body.appendChild(e),this._hookDiv=e;}},{key:"destroyTouchHook",value:function destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null);}},{key:"activate",value:function activate(){var _this$renderer$view$p;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(_this$renderer$view$p=this.renderer.view.parentNode)===null||_this$renderer$view$p===void 0?void 0:_this$renderer$view$p.appendChild(this.div));}},{key:"deactivate",value:function deactivate(){var _this$div$parentNode;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(_this$div$parentNode=this.div.parentNode)===null||_this$div$parentNode===void 0?void 0:_this$div$parentNode.removeChild(this.div));}},{key:"updateAccessibleObjects",value:function updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);var t=e.children;if(t)for(var _e489=0;_e489<t.length;_e489++)this.updateAccessibleObjects(t[_e489]);}},{key:"update",value:function update(){var e=performance.now();if(isMobile_isMobile.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);var _this$renderer$view$g=this.renderer.view.getBoundingClientRect(),t=_this$renderer$view$g.x,r=_this$renderer$view$g.y,n=_this$renderer$view$g.width,i=_this$renderer$view$g.height,_this$renderer6=this.renderer,o=_this$renderer6.width,a=_this$renderer6.height,s=_this$renderer6.resolution,u=n/o*s,l=i/a*s;var c=this.div;c.style.left="".concat(t,"px"),c.style.top="".concat(r,"px"),c.style.width="".concat(o,"px"),c.style.height="".concat(a,"px");for(var _e490=0;_e490<this.children.length;_e490++){var _t235=this.children[_e490];if(_t235.renderId!==this.renderId)_t235._accessibleActive=!1,_removeItems(this.children,_e490,1),this.div.removeChild(_t235._accessibleDiv),this.pool.push(_t235._accessibleDiv),_t235._accessibleDiv=null,_e490--;else{c=_t235._accessibleDiv;var _e491=_t235.hitArea;var _r217=_t235.worldTransform;_t235.hitArea?(c.style.left=(_r217.tx+_e491.x*_r217.a)*u+"px",c.style.top=(_r217.ty+_e491.y*_r217.d)*l+"px",c.style.width=_e491.width*_r217.a*u+"px",c.style.height=_e491.height*_r217.d*l+"px"):(_e491=_t235.getBounds(),this.capHitArea(_e491),c.style.left=_e491.x*u+"px",c.style.top=_e491.y*l+"px",c.style.width=_e491.width*u+"px",c.style.height=_e491.height*l+"px",c.title!==_t235.accessibleTitle&&null!==_t235.accessibleTitle&&(c.title=_t235.accessibleTitle),c.getAttribute("aria-label")!==_t235.accessibleHint&&null!==_t235.accessibleHint&&c.setAttribute("aria-label",_t235.accessibleHint)),(_t235.accessibleTitle!==c.title||_t235.tabIndex!==c.tabIndex)&&(c.title=_t235.accessibleTitle,c.tabIndex=_t235.tabIndex,this.debug&&this.updateDebugHTML(c));}}this.renderId++;}},{key:"updateDebugHTML",value:function updateDebugHTML(e){e.innerHTML="type: ".concat(e.type,"</br> title : ").concat(e.title,"</br> tabIndex: ").concat(e.tabIndex);}},{key:"capHitArea",value:function capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);var _this$renderer7=this.renderer,t=_this$renderer7.width,r=_this$renderer7.height;e.x+e.width>t&&(e.width=t-e.x),e.y+e.height>r&&(e.height=r-e.y);}},{key:"addChild",value:function addChild(e){var t=this.pool.pop();t||(t=document.createElement("button"),t.style.width="".concat(DIV_TOUCH_SIZE,"px"),t.style.height="".concat(DIV_TOUCH_SIZE,"px"),t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=DIV_TOUCH_ZINDEX.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&null!==e.accessibleTitle?t.title=e.accessibleTitle:(!e.accessibleHint||null===e.accessibleHint)&&(t.title="displayObject ".concat(e.tabIndex)),e.accessibleHint&&null!==e.accessibleHint&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex;}},{key:"_dispatchEvent",value:function _dispatchEvent(e,t){var r=e.target.displayObject,n=this.renderer.events.rootBoundary,i=Object.assign(new _FederatedEvent(n),{target:r});n.rootTarget=this.renderer.lastObjectRendered,t.forEach(function(e){return n.dispatchEvent(i,e);});}},{key:"_onClick",value:function _onClick(e){this._dispatchEvent(e,["click","pointertap","tap"]);}},{key:"_onFocus",value:function _onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"]);}},{key:"_onFocusOut",value:function _onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"]);}},{key:"_onKeyDown",value:function _onKeyDown(e){e.keyCode===KEY_CODE_TAB&&this.activate();}},{key:"_onMouseMove",value:function _onMouseMove(e){0===e.movementX&&0===e.movementY||this.deactivate();}},{key:"destroy",value:function destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null;}}]);}();_AccessibilityManager.extension={name:"accessibility",type:[_ExtensionType.RendererPlugin,_ExtensionType.CanvasRendererPlugin]},_extensions.add(_AccessibilityManager);var _Application=/*#__PURE__*/function(){function e(t){var _this87=this;_classCallCheck2(this,e);this.stage=new _Container2(),t=Object.assign({forceCanvas:!1},t),this.renderer=_autoDetectRenderer(t),e._plugins.forEach(function(_e492){_e492.init.call(_this87,t);});}return _createClass2(e,[{key:"render",value:function render(){this.renderer.render(this.stage);}},{key:"view",get:function get(){var _this$renderer8;return(_this$renderer8=this.renderer)===null||_this$renderer8===void 0?void 0:_this$renderer8.view;}},{key:"screen",get:function get(){var _this$renderer9;return(_this$renderer9=this.renderer)===null||_this$renderer9===void 0?void 0:_this$renderer9.screen;}},{key:"destroy",value:function destroy(t,r){var _this88=this;var n=e._plugins.slice(0);n.reverse(),n.forEach(function(_e493){_e493.destroy.call(_this88);}),this.stage.destroy(r),this.stage=null,this.renderer.destroy(t),this.renderer=null;}}]);}();_Application._plugins=[];var _Application2=_Application;_extensions.handleByList(_ExtensionType.Application,_Application2._plugins);var _ResizePlugin=/*#__PURE__*/function(){function _ResizePlugin(){_classCallCheck2(this,_ResizePlugin);}return _createClass2(_ResizePlugin,null,[{key:"init",value:function init(e){var _this89=this;Object.defineProperty(this,"resizeTo",{set:function set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize());},get:function get(){return this._resizeTo;}}),this.queueResize=function(){_this89._resizeTo&&(_this89.cancelResize(),_this89._resizeId=requestAnimationFrame(function(){return _this89.resize();}));},this.cancelResize=function(){_this89._resizeId&&(cancelAnimationFrame(_this89._resizeId),_this89._resizeId=null);},this.resize=function(){if(!_this89._resizeTo)return;var e,t;if(_this89.cancelResize(),_this89._resizeTo===globalThis.window)e=globalThis.innerWidth,t=globalThis.innerHeight;else{var _this89$_resizeTo=_this89._resizeTo,r=_this89$_resizeTo.clientWidth,_n149=_this89$_resizeTo.clientHeight;e=r,t=_n149;}_this89.renderer.resize(e,t),_this89.render();},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null;}},{key:"destroy",value:function destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null;}}]);}();_ResizePlugin.extension=_ExtensionType.Application,_extensions.add(_ResizePlugin);var assetKeyMap={loader:_ExtensionType.LoadParser,resolver:_ExtensionType.ResolveParser,cache:_ExtensionType.CacheParser,detection:_ExtensionType.DetectionParser};_extensions.handle(_ExtensionType.Asset,function(e){var t=e.ref;Object.entries(assetKeyMap).filter(function(_ref47){var _ref48=_slicedToArray2(_ref47,1),e=_ref48[0];return!!t[e];}).forEach(function(_ref49){var _t$e$extension;var _ref50=_slicedToArray2(_ref49,2),e=_ref50[0],r=_ref50[1];return _extensions.add(Object.assign(t[e],{extension:(_t$e$extension=t[e].extension)!==null&&_t$e$extension!==void 0?_t$e$extension:r}));});},function(e){var t=e.ref;Object.keys(assetKeyMap).filter(function(e){return!!t[e];}).forEach(function(e){return _extensions.remove(t[e]);});});var BackgroundLoader=/*#__PURE__*/function(){function BackgroundLoader(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;_classCallCheck2(this,BackgroundLoader);this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t;}return _createClass2(BackgroundLoader,[{key:"add",value:function add(e){var _this90=this;e.forEach(function(e){_this90._assetList.push(e);}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next();}},{key:"_next",value:function(){var _next2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee74(){var _e494,_t236,r;return _regeneratorRuntime2().wrap(function _callee74$(_context78){while(1)switch(_context78.prev=_context78.next){case 0:if(!(this._assetList.length&&this._isActive)){_context78.next=8;break;}this._isLoading=!0;_e494=[],_t236=Math.min(this._assetList.length,this._maxConcurrent);for(r=0;r<_t236;r++)_e494.push(this._assetList.pop());_context78.next=6;return this._loader.load(_e494);case 6:this._isLoading=!1;this._next();case 8:case"end":return _context78.stop();}},_callee74,this);}));function _next(){return _next2.apply(this,arguments);}return _next;}()},{key:"active",get:function get(){return this._isActive;},set:function set(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next());}}]);}();function _checkExtension(e,t){var r=e.split("?")[0],n=_path.extname(r).toLowerCase();return Array.isArray(t)?t.includes(n):n===t;}var _convertToList=function _convertToList(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;return Array.isArray(e)||(e=[e]),t?e.map(function(e){return"string"==typeof e||r?t(e):e;}):e;};var CacheClass=/*#__PURE__*/function(){function CacheClass(){_classCallCheck2(this,CacheClass);this._parsers=[],this._cache=new Map(),this._cacheMap=new Map();}return _createClass2(CacheClass,[{key:"reset",value:function reset(){this._cacheMap.clear(),this._cache.clear();}},{key:"has",value:function has(e){return this._cache.has(e);}},{key:"get",value:function get(e){var t=this._cache.get(e);return t||console.warn("[Assets] Asset id ".concat(e," was not found in the Cache")),t;}},{key:"set",value:function set(e,t){var _this91=this;var r=_convertToList(e);var n;for(var _e495=0;_e495<this.parsers.length;_e495++){var _i106=this.parsers[_e495];if(_i106.test(t)){n=_i106.getCacheableAssets(r,t);break;}}n||(n={},r.forEach(function(e){n[e]=t;}));var i=Object.keys(n),o={cacheKeys:i,keys:r};if(r.forEach(function(e){_this91._cacheMap.set(e,o);}),i.forEach(function(e){_this91._cache.has(e)&&_this91._cache.get(e)!==t&&console.warn("[Cache] already has key:",e),_this91._cache.set(e,n[e]);}),t instanceof Texture_Texture){var _e496=t;r.forEach(function(t){_e496.baseTexture!==Texture_Texture.EMPTY.baseTexture&&_BaseTexture2.addToCache(_e496.baseTexture,t),Texture_Texture.addToCache(_e496,t);});}}},{key:"remove",value:function remove(e){var _this92=this;if(!this._cacheMap.has(e))return void console.warn("[Assets] Asset id ".concat(e," was not found in the Cache"));var t=this._cacheMap.get(e);t.cacheKeys.forEach(function(e){_this92._cache["delete"](e);}),t.keys.forEach(function(e){_this92._cacheMap["delete"](e);});}},{key:"parsers",get:function get(){return this._parsers;}}]);}();var _Cache=new CacheClass(),_isSingleItem=function _isSingleItem(e){return!Array.isArray(e);};var Loader=/*#__PURE__*/function(){function Loader(){var _this93=this;_classCallCheck2(this,Loader);this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:function set(e,t,r){return _this93._parsersValidated=!1,e[t]=r,!0;}}),this.promiseCache={};}return _createClass2(Loader,[{key:"reset",value:function reset(){this._parsersValidated=!1,this.promiseCache={};}},{key:"_getLoadPromiseAndParser",value:function _getLoadPromiseAndParser(e,t){var _this94=this;var r={promise:null,parser:null};return r.promise=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee75(){var n,i,_r218,_n150$test,_n150,_e497,_i107$testParse,_i107;return _regeneratorRuntime2().wrap(function _callee75$(_context79){while(1)switch(_context79.prev=_context79.next){case 0:n=null,i=null;if(!(t.loadParser&&(i=_this94._parserHash[t.loadParser],i||console.warn("[Assets] specified load parser \"".concat(t.loadParser,"\" not found while loading ").concat(e))),!i)){_context79.next=13;break;}_r218=0;case 3:if(!(_r218<_this94.parsers.length)){_context79.next=11;break;}_n150=_this94.parsers[_r218];if(!(_n150.load&&(_n150$test=_n150.test)!==null&&_n150$test!==void 0&&_n150$test.call(_n150,e,t,_this94))){_context79.next=8;break;}i=_n150;return _context79.abrupt("break",11);case 8:_r218++;_context79.next=3;break;case 11:if(i){_context79.next=13;break;}return _context79.abrupt("return",(console.warn("[Assets] ".concat(e," could not be loaded as we don't know how to parse it, ensure the correct parser has been added")),null));case 13:_context79.next=15;return i.load(e,t,_this94);case 15:n=_context79.sent;r.parser=i;_e497=0;case 18:if(!(_e497<_this94.parsers.length)){_context79.next=37;break;}_i107=_this94.parsers[_e497];_context79.t0=_i107.parse&&_i107.parse;if(!_context79.t0){_context79.next=25;break;}_context79.next=24;return(_i107$testParse=_i107.testParse)===null||_i107$testParse===void 0?void 0:_i107$testParse.call(_i107,n,t,_this94);case 24:_context79.t0=_context79.sent;case 25:_context79.t1=_context79.t0;if(!_context79.t1){_context79.next=34;break;}_context79.next=29;return _i107.parse(n,t,_this94);case 29:_context79.t2=_context79.sent;if(_context79.t2){_context79.next=32;break;}_context79.t2=n;case 32:n=_context79.t2;r.parser=_i107;case 34:_e497++;_context79.next=18;break;case 37:return _context79.abrupt("return",n);case 38:case"end":return _context79.stop();}},_callee75);}))(),r;}},{key:"load",value:function(){var _load=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee77(e,t){var _this95=this;var r,n,i,o,a,s;return _regeneratorRuntime2().wrap(function _callee77$(_context81){while(1)switch(_context81.prev=_context81.next){case 0:this._parsersValidated||this._validateParsers();r=0;n={},i=_isSingleItem(e),o=_convertToList(e,function(e){return{alias:[e],src:e};}),a=o.length,s=o.map(/*#__PURE__*/function(){var _ref52=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee76(e){var i;return _regeneratorRuntime2().wrap(function _callee76$(_context80){while(1)switch(_context80.prev=_context80.next){case 0:i=_path.toAbsolute(e.src);if(n[e.src]){_context80.next=13;break;}_context80.prev=2;_this95.promiseCache[i]||(_this95.promiseCache[i]=_this95._getLoadPromiseAndParser(i,e));_context80.next=6;return _this95.promiseCache[i].promise;case 6:n[e.src]=_context80.sent;t&&t(++r/a);_context80.next=13;break;case 10:_context80.prev=10;_context80.t0=_context80["catch"](2);throw delete _this95.promiseCache[i],delete n[e.src],new Error("[Loader.load] Failed to load ".concat(i,".\n").concat(_context80.t0));case 13:case"end":return _context80.stop();}},_callee76,null,[[2,10]]);}));return function(_x99){return _ref52.apply(this,arguments);};}());_context81.next=5;return Promise.all(s);case 5:return _context81.abrupt("return",i?n[o[0].src]:n);case 6:case"end":return _context81.stop();}},_callee77,this);}));function load(_x97,_x98){return _load.apply(this,arguments);}return load;}()},{key:"unload",value:function(){var _unload=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee79(e){var _this96=this;var t;return _regeneratorRuntime2().wrap(function _callee79$(_context83){while(1)switch(_context83.prev=_context83.next){case 0:t=_convertToList(e,function(e){return{alias:[e],src:e};}).map(/*#__PURE__*/function(){var _ref53=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee78(e){var t,r,_r$parser,_r$parser$unload,_n151;return _regeneratorRuntime2().wrap(function _callee78$(_context82){while(1)switch(_context82.prev=_context82.next){case 0:t=_path.toAbsolute(e.src),r=_this96.promiseCache[t];if(!r){_context82.next=6;break;}_context82.next=4;return r.promise;case 4:_n151=_context82.sent;delete _this96.promiseCache[t],(_r$parser=r.parser)===null||_r$parser===void 0||(_r$parser$unload=_r$parser.unload)===null||_r$parser$unload===void 0?void 0:_r$parser$unload.call(_r$parser,_n151,e,_this96);case 6:case"end":return _context82.stop();}},_callee78);}));return function(_x101){return _ref53.apply(this,arguments);};}());_context83.next=3;return Promise.all(t);case 3:case"end":return _context83.stop();}},_callee79);}));function unload(_x100){return _unload.apply(this,arguments);}return unload;}()},{key:"_validateParsers",value:function _validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(function(e){return e.name;}).reduce(function(e,t){return e[t.name]&&console.warn("[Assets] loadParser name conflict \"".concat(t.name,"\"")),_objectSpread(_objectSpread({},e),{},_defineProperty({},t.name,t));},{});}}]);}();var _LoaderParserPriority=function(e){return e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e;}(_LoaderParserPriority||{});function _checkDataUrl(e,t){if(Array.isArray(t)){var _iterator46=_createForOfIteratorHelper2(t),_step46;try{for(_iterator46.s();!(_step46=_iterator46.n()).done;){var r=_step46.value;if(e.startsWith("data:".concat(r)))return!0;}}catch(err){_iterator46.e(err);}finally{_iterator46.f();}return!1;}return e.startsWith("data:".concat(t));}var validJSONExtension=".json",validJSONMIME="application/json",_loadJson={extension:{type:_ExtensionType.LoadParser,priority:_LoaderParserPriority.Low},name:"loadJson",test:function test(e){return _checkDataUrl(e,validJSONMIME)||_checkExtension(e,validJSONExtension);},load:function(){var _load2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee80(e){return _regeneratorRuntime2().wrap(function _callee80$(_context84){while(1)switch(_context84.prev=_context84.next){case 0:_context84.next=2;return _settings.ADAPTER.fetch(e);case 2:_context84.next=4;return _context84.sent.json();case 4:return _context84.abrupt("return",_context84.sent);case 5:case"end":return _context84.stop();}},_callee80);}));function load(_x102){return _load2.apply(this,arguments);}return load;}()};_extensions.add(_loadJson);var validTXTExtension=".txt",validTXTMIME="text/plain",_loadTxt={name:"loadTxt",extension:{type:_ExtensionType.LoadParser,priority:_LoaderParserPriority.Low},test:function test(e){return _checkDataUrl(e,validTXTMIME)||_checkExtension(e,validTXTExtension);},load:function(){var _load3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee81(e){return _regeneratorRuntime2().wrap(function _callee81$(_context85){while(1)switch(_context85.prev=_context85.next){case 0:_context85.next=2;return _settings.ADAPTER.fetch(e);case 2:_context85.next=4;return _context85.sent.text();case 4:return _context85.abrupt("return",_context85.sent);case 5:case"end":return _context85.stop();}},_callee81);}));function load(_x103){return _load3.apply(this,arguments);}return load;}()};_extensions.add(_loadTxt);var validWeights=["normal","bold","100","200","300","400","500","600","700","800","900"],validFontExtensions=[".ttf",".otf",".woff",".woff2"],validFontMIMEs=["font/ttf","font/otf","font/woff","font/woff2"],CSS_IDENT_TOKEN_REGEX=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function _getFontFamilyName(e){var t=_path.extname(e),r=_path.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1);});var n=r.length>0;var _iterator47=_createForOfIteratorHelper2(r),_step47;try{for(_iterator47.s();!(_step47=_iterator47.n()).done;){var _e498=_step47.value;if(!_e498.match(CSS_IDENT_TOKEN_REGEX)){n=!1;break;}}}catch(err){_iterator47.e(err);}finally{_iterator47.f();}var i=r.join(" ");return n||(i="\"".concat(i.replace(/[\\"]/g,"\\$&"),"\"")),i;}var validURICharactersRegex=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function encodeURIWhenNeeded(e){return validURICharactersRegex.test(e)?e:encodeURI(e);}var _loadWebFont={extension:{type:_ExtensionType.LoadParser,priority:_LoaderParserPriority.Low},name:"loadWebFont",test:function test(e){return _checkDataUrl(e,validFontMIMEs)||_checkExtension(e,validFontExtensions);},load:function load(e,t){return _asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee82(){var r,_t$data$family,_t$data,_t$data$weights$filte,_t$data2,_t$data3,_n152,_i108,_o72,_a50,_t237,_s40,_u29;return _regeneratorRuntime2().wrap(function _callee82$(_context86){while(1)switch(_context86.prev=_context86.next){case 0:r=_settings.ADAPTER.getFontFaceSet();if(!r){_context86.next=14;break;}_n152=[],_i108=(_t$data$family=(_t$data=t.data)===null||_t$data===void 0?void 0:_t$data.family)!==null&&_t$data$family!==void 0?_t$data$family:_getFontFamilyName(e),_o72=(_t$data$weights$filte=(_t$data2=t.data)===null||_t$data2===void 0||(_t$data2=_t$data2.weights)===null||_t$data2===void 0?void 0:_t$data2.filter(function(e){return validWeights.includes(e);}))!==null&&_t$data$weights$filte!==void 0?_t$data$weights$filte:["normal"],_a50=(_t$data3=t.data)!==null&&_t$data3!==void 0?_t$data3:{};_t237=0;case 4:if(!(_t237<_o72.length)){_context86.next=13;break;}_s40=_o72[_t237],_u29=new FontFace(_i108,"url(".concat(encodeURIWhenNeeded(e),")"),_objectSpread(_objectSpread({},_a50),{},{weight:_s40}));_context86.next=8;return _u29.load();case 8:r.add(_u29);_n152.push(_u29);case 10:_t237++;_context86.next=4;break;case 13:return _context86.abrupt("return",1===_n152.length?_n152[0]:_n152);case 14:return _context86.abrupt("return",(console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null));case 15:case"end":return _context86.stop();}},_callee82);}))();},unload:function unload(e){(Array.isArray(e)?e:[e]).forEach(function(e){return _settings.ADAPTER.getFontFaceSet()["delete"](e);});}};_extensions.add(_loadWebFont);var WORKER_CODE='(function() {\n  "use strict";\n  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";\n  async function checkImageBitmap() {\n    try {\n      if (typeof createImageBitmap != "function")\n        return !1;\n      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);\n      return imageBitmap.width === 1 && imageBitmap.height === 1;\n    } catch {\n      return !1;\n    }\n  }\n  checkImageBitmap().then((result) => {\n    self.postMessage(result);\n  });\n})();\n';var WORKER_URL=null;var WorkerInstance=/*#__PURE__*/_createClass2(function WorkerInstance(){_classCallCheck2(this,WorkerInstance);WORKER_URL||(WORKER_URL=URL.createObjectURL(new Blob([WORKER_CODE],{type:"application/javascript"}))),this.worker=new Worker(WORKER_URL);});WorkerInstance.revokeObjectURL=function(){WORKER_URL&&(URL.revokeObjectURL(WORKER_URL),WORKER_URL=null);};var loadImageBitmap_worker_WORKER_CODE='(function() {\n  "use strict";\n  async function loadImageBitmap(url) {\n    const response = await fetch(url);\n    if (!response.ok)\n      throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\n    const imageBlob = await response.blob();\n    return await createImageBitmap(imageBlob);\n  }\n  self.onmessage = async (event) => {\n    try {\n      const imageBitmap = await loadImageBitmap(event.data.data[0]);\n      self.postMessage({\n        data: imageBitmap,\n        uuid: event.data.uuid,\n        id: event.data.id\n      }, [imageBitmap]);\n    } catch (e) {\n      self.postMessage({\n        error: e,\n        uuid: event.data.uuid,\n        id: event.data.id\n      });\n    }\n  };\n})();\n';var loadImageBitmap_worker_WORKER_URL=null;var loadImageBitmap_worker_WorkerInstance=/*#__PURE__*/_createClass2(function loadImageBitmap_worker_WorkerInstance(){_classCallCheck2(this,loadImageBitmap_worker_WorkerInstance);loadImageBitmap_worker_WORKER_URL||(loadImageBitmap_worker_WORKER_URL=URL.createObjectURL(new Blob([loadImageBitmap_worker_WORKER_CODE],{type:"application/javascript"}))),this.worker=new Worker(loadImageBitmap_worker_WORKER_URL);});loadImageBitmap_worker_WorkerInstance.revokeObjectURL=function(){loadImageBitmap_worker_WORKER_URL&&(URL.revokeObjectURL(loadImageBitmap_worker_WORKER_URL),loadImageBitmap_worker_WORKER_URL=null);};var UUID=0,MAX_WORKERS;var WorkerManagerClass=/*#__PURE__*/function(){function WorkerManagerClass(){_classCallCheck2(this,WorkerManagerClass);this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={};}return _createClass2(WorkerManagerClass,[{key:"isImageBitmapSupported",value:function isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise(function(e){var _WorkerInstance=new WorkerInstance(),t=_WorkerInstance.worker;t.addEventListener("message",function(r){t.terminate(),WorkerInstance.revokeObjectURL(),e(r.data);});})),this._isImageBitmapSupported;}},{key:"loadImageBitmap",value:function loadImageBitmap(e){return this._run("loadImageBitmap",[e]);}},{key:"_initWorkers",value:function(){var _initWorkers2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee83(){return _regeneratorRuntime2().wrap(function _callee83$(_context87){while(1)switch(_context87.prev=_context87.next){case 0:this._initialized||(this._initialized=!0);case 1:case"end":return _context87.stop();}},_callee83,this);}));function _initWorkers(){return _initWorkers2.apply(this,arguments);}return _initWorkers;}()},{key:"getWorker",value:function getWorker(){var _this97=this;void 0===MAX_WORKERS&&(MAX_WORKERS=navigator.hardwareConcurrency||4);var e=this.workerPool.pop();return!e&&this._createdWorkers<MAX_WORKERS&&(this._createdWorkers++,e=new loadImageBitmap_worker_WorkerInstance().worker,e.addEventListener("message",function(e){_this97.complete(e.data),_this97.returnWorker(e.target),_this97.next();})),e;}},{key:"returnWorker",value:function returnWorker(e){this.workerPool.push(e);}},{key:"complete",value:function complete(e){void 0!==e.error?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null;}},{key:"_run",value:function(){var _run5=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee84(e,t){var _this98=this;var r;return _regeneratorRuntime2().wrap(function _callee84$(_context88){while(1)switch(_context88.prev=_context88.next){case 0:_context88.next=2;return this._initWorkers();case 2:r=new Promise(function(r,n){_this98.queue.push({id:e,arguments:t,resolve:r,reject:n});});return _context88.abrupt("return",(this.next(),r));case 4:case"end":return _context88.stop();}},_callee84,this);}));function _run(_x104,_x105){return _run5.apply(this,arguments);}return _run;}()},{key:"next",value:function next(){if(!this.queue.length)return;var e=this.getWorker();if(!e)return;var t=this.queue.pop(),r=t.id;this.resolveHash[UUID]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:UUID++,id:r});}}]);}();var WorkerManager=new WorkerManagerClass();function _createTexture(e,t,r){e.resource.internal=!0;var n=new Texture_Texture(e),i=function i(){delete t.promiseCache[r],_Cache.has(r)&&_Cache.remove(r);};return n.baseTexture.once("destroyed",function(){r in t.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),i());}),n.once("destroyed",function(){e.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i());}),n;}var validImageExtensions=[".jpeg",".jpg",".png",".webp",".avif"],validImageMIMEs=["image/jpeg","image/png","image/webp","image/avif"];function _loadImageBitmap(_x106){return _loadImageBitmap2.apply(this,arguments);}function _loadImageBitmap2(){_loadImageBitmap2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee187(e){var t,r;return _regeneratorRuntime2().wrap(function _callee187$(_context193){while(1)switch(_context193.prev=_context193.next){case 0:_context193.next=2;return _settings.ADAPTER.fetch(e);case 2:t=_context193.sent;if(t.ok){_context193.next=5;break;}throw new Error("[loadImageBitmap] Failed to fetch ".concat(e,": ").concat(t.status," ").concat(t.statusText));case 5:_context193.next=7;return t.blob();case 7:r=_context193.sent;_context193.next=10;return createImageBitmap(r);case 10:return _context193.abrupt("return",_context193.sent);case 11:case"end":return _context193.stop();}},_callee187);}));return _loadImageBitmap2.apply(this,arguments);}var _loadTextures={name:"loadTextures",extension:{type:_ExtensionType.LoadParser,priority:_LoaderParserPriority.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:function test(e){return _checkDataUrl(e,validImageMIMEs)||_checkExtension(e,validImageExtensions);},load:function load(e,t,r){var _this99=this;return _asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee85(){var _o$resolution,_o$resourceOptions;var n,i,o,a;return _regeneratorRuntime2().wrap(function _callee85$(_context89){while(1)switch(_context89.prev=_context89.next){case 0:n=globalThis.createImageBitmap&&_this99.config.preferCreateImageBitmap;if(!n){_context89.next=19;break;}_context89.t1=_this99.config.preferWorkers;if(!_context89.t1){_context89.next=7;break;}_context89.next=6;return WorkerManager.isImageBitmapSupported();case 6:_context89.t1=_context89.sent;case 7:if(!_context89.t1){_context89.next=13;break;}_context89.next=10;return WorkerManager.loadImageBitmap(e);case 10:_context89.t2=_context89.sent;_context89.next=16;break;case 13:_context89.next=15;return _loadImageBitmap(e);case 15:_context89.t2=_context89.sent;case 16:_context89.t0=_context89.t2;_context89.next=22;break;case 19:_context89.next=21;return new Promise(function(t,r){var n=new Image();n.crossOrigin=_this99.config.crossOrigin,n.src=e,n.complete?t(n):(n.onload=function(){return t(n);},n.onerror=function(e){return r(e);});});case 21:_context89.t0=_context89.sent;case 22:i=_context89.t0;o=_objectSpread({},t.data);(_o$resolution=o.resolution)!==null&&_o$resolution!==void 0?_o$resolution:o.resolution=_getResolutionOfUrl(e),n&&void 0===((_o$resourceOptions=o.resourceOptions)===null||_o$resourceOptions===void 0?void 0:_o$resourceOptions.ownsImageBitmap)&&(o.resourceOptions=_objectSpread({},o.resourceOptions),o.resourceOptions.ownsImageBitmap=!0);a=new _BaseTexture2(i,o);return _context89.abrupt("return",(a.resource.src=e,_createTexture(a,r,e)));case 27:case"end":return _context89.stop();}},_callee85);}))();},unload:function unload(e){e.destroy(!0);}};_extensions.add(_loadTextures);var validSVGExtension=".svg",validSVGMIME="image/svg+xml",_loadSVG={extension:{type:_ExtensionType.LoadParser,priority:_LoaderParserPriority.High},name:"loadSVG",test:function test(e){return _checkDataUrl(e,validSVGMIME)||_checkExtension(e,validSVGExtension);},testParse:function(){var _testParse=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee86(e){return _regeneratorRuntime2().wrap(function _callee86$(_context90){while(1)switch(_context90.prev=_context90.next){case 0:return _context90.abrupt("return",_SVGResource2.test(e));case 1:case"end":return _context90.stop();}},_callee86);}));function testParse(_x107){return _testParse.apply(this,arguments);}return testParse;}(),parse:function parse(e,t,r){return _asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee87(){var _t$data4;var n,i;return _regeneratorRuntime2().wrap(function _callee87$(_context91){while(1)switch(_context91.prev=_context91.next){case 0:n=new _SVGResource2(e,t===null||t===void 0||(_t$data4=t.data)===null||_t$data4===void 0?void 0:_t$data4.resourceOptions);_context91.next=3;return n.load();case 3:i=new _BaseTexture2(n,_objectSpread({resolution:_getResolutionOfUrl(e)},t===null||t===void 0?void 0:t.data));return _context91.abrupt("return",(i.resource.src=t.src,_createTexture(i,r,t.src)));case 5:case"end":return _context91.stop();}},_callee87);}))();},load:function(){var _load4=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee88(e,t){return _regeneratorRuntime2().wrap(function _callee88$(_context92){while(1)switch(_context92.prev=_context92.next){case 0:_context92.next=2;return _settings.ADAPTER.fetch(e);case 2:return _context92.abrupt("return",_context92.sent.text());case 3:case"end":return _context92.stop();}},_callee88);}));function load(_x108,_x109){return _load4.apply(this,arguments);}return load;}(),unload:_loadTextures.unload};_extensions.add(_loadSVG);var validVideoExtensions=[".mp4",".m4v",".webm",".ogv"],validVideoMIMEs=["video/mp4","video/webm","video/ogg"],_loadVideo={name:"loadVideo",extension:{type:_ExtensionType.LoadParser,priority:_LoaderParserPriority.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test:function test(e){return _checkDataUrl(e,validVideoMIMEs)||_checkExtension(e,validVideoExtensions);},load:function load(e,t,r){var _this100=this;return _asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee89(){var n,i,o,_t$data5,_i109,_a51,_s41;return _regeneratorRuntime2().wrap(function _callee89$(_context93){while(1)switch(_context93.prev=_context93.next){case 0:_context93.next=2;return _settings.ADAPTER.fetch(e);case 2:_context93.next=4;return _context93.sent.blob();case 4:i=_context93.sent;o=URL.createObjectURL(i);_context93.prev=6;_i109=_objectSpread(_objectSpread({autoPlay:_this100.config.defaultAutoPlay,updateFPS:_this100.config.defaultUpdateFPS,loop:_this100.config.defaultLoop,muted:_this100.config.defaultMuted,playsinline:_this100.config.defaultPlaysinline},t===null||t===void 0||(_t$data5=t.data)===null||_t$data5===void 0?void 0:_t$data5.resourceOptions),{},{autoLoad:!0}),_a51=new _VideoResource2(o,_i109);_context93.next=10;return _a51.load();case 10:_context93.t0=_BaseTexture2;_context93.t1=_a51;_context93.t2=_objectSpread;_context93.next=15;return _detectVideoAlphaMode();case 15:_context93.t3=_context93.sent;_context93.t4=_getResolutionOfUrl(e);_context93.t5={alphaMode:_context93.t3,resolution:_context93.t4};_context93.t6=t===null||t===void 0?void 0:t.data;_context93.t7=(0,_context93.t2)(_context93.t5,_context93.t6);_s41=new _context93.t0(_context93.t1,_context93.t7);_s41.resource.src=e,n=_createTexture(_s41,r,e),n.baseTexture.once("destroyed",function(){URL.revokeObjectURL(o);});_context93.next=27;break;case 24:_context93.prev=24;_context93.t8=_context93["catch"](6);throw URL.revokeObjectURL(o),_context93.t8;case 27:return _context93.abrupt("return",n);case 28:case"end":return _context93.stop();}},_callee89,null,[[6,24]]);}))();},unload:function unload(e){e.destroy(!0);}};function processX(e,t,r,n,i){var o=t[r];for(var _a52=0;_a52<o.length;_a52++){var _s42=o[_a52];r<t.length-1?processX(e.replace(n[r],_s42),t,r+1,n,i):i.push(e.replace(n[r],_s42));}}function _createStringVariations(e){var t=e.match(/\{(.*?)\}/g),r=[];if(t){var n=[];t.forEach(function(e){var t=e.substring(1,e.length-1).split(",");n.push(t);}),processX(e,n,0,t,r);}else r.push(e);return r;}_extensions.add(_loadVideo);var Resolver=/*#__PURE__*/function(){function Resolver(){var _this101=this;_classCallCheck2(this,Resolver);this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:function createBundleAssetId(e,t){return"".concat(e).concat(_this101._bundleIdConnector).concat(t);},extractAssetIdFromBundle:function extractAssetIdFromBundle(e,t){return t.replace("".concat(e).concat(_this101._bundleIdConnector),"");}},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={};}return _createClass2(Resolver,[{key:"setBundleIdentifier",value:function setBundleIdentifier(e){var _e$connector,_e$createBundleAssetI,_e$extractAssetIdFrom;if(this._bundleIdConnector=(_e$connector=e.connector)!==null&&_e$connector!==void 0?_e$connector:this._bundleIdConnector,this._createBundleAssetId=(_e$createBundleAssetI=e.createBundleAssetId)!==null&&_e$createBundleAssetI!==void 0?_e$createBundleAssetI:this._createBundleAssetId,this._extractAssetIdFromBundle=(_e$extractAssetIdFrom=e.extractAssetIdFromBundle)!==null&&_e$extractAssetIdFrom!==void 0?_e$extractAssetIdFrom:this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly");}},{key:"prefer",value:function prefer(){var _this102=this;for(var _len7=arguments.length,e=new Array(_len7),_key7=0;_key7<_len7;_key7++){e[_key7]=arguments[_key7];}e.forEach(function(e){_this102._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params));}),this._resolverHash={};}},{key:"basePath",get:function get(){return this._basePath;},set:function set(e){this._basePath=e;}},{key:"rootPath",get:function get(){return this._rootPath;},set:function set(e){this._rootPath=e;}},{key:"parsers",get:function get(){return this._parsers;}},{key:"reset",value:function reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null;}},{key:"setDefaultSearchParams",value:function setDefaultSearchParams(e){if("string"==typeof e)this._defaultSearchParams=e;else{var _t238=e;this._defaultSearchParams=Object.keys(_t238).map(function(e){return"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(_t238[e]));}).join("&");}}},{key:"getAlias",value:function getAlias(e){var t=e.alias,r=e.name,n=e.src,i=e.srcs;return _convertToList(t||r||n||i,function(e){var _e$src2;return"string"==typeof e?e:Array.isArray(e)?e.map(function(e){var _ref54,_e$src;return(_ref54=(_e$src=e===null||e===void 0?void 0:e.src)!==null&&_e$src!==void 0?_e$src:e===null||e===void 0?void 0:e.srcs)!==null&&_ref54!==void 0?_ref54:e;}):e!==null&&e!==void 0&&e.src||e!==null&&e!==void 0&&e.srcs?(_e$src2=e.src)!==null&&_e$src2!==void 0?_e$src2:e.srcs:e;},!0);}},{key:"addManifest",value:function addManifest(e){var _this103=this;this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(function(e){_this103.addBundle(e.name,e.assets);});}},{key:"addBundle",value:function addBundle(e,t){var _this104=this;var r=[];Array.isArray(t)?t.forEach(function(t){var _t$src,_t$alias;var n=(_t$src=t.src)!==null&&_t$src!==void 0?_t$src:t.srcs,i=(_t$alias=t.alias)!==null&&_t$alias!==void 0?_t$alias:t.name;var o;if("string"==typeof i){var _t239=_this104._createBundleAssetId(e,i);r.push(_t239),o=[i,_t239];}else{var _t240=i.map(function(t){return _this104._createBundleAssetId(e,t);});r.push.apply(r,_toConsumableArray2(_t240)),o=[].concat(_toConsumableArray2(i),_toConsumableArray2(_t240));}_this104.add(_objectSpread(_objectSpread({},t),{},{alias:o,src:n}));}):Object.keys(t).forEach(function(n){var i=[n,_this104._createBundleAssetId(e,n)];if("string"==typeof t[n])_this104.add({alias:i,src:t[n]});else if(Array.isArray(t[n]))_this104.add({alias:i,src:t[n]});else{var _e499$src;var _e499=t[n],_r219=(_e499$src=_e499.src)!==null&&_e499$src!==void 0?_e499$src:_e499.srcs;_this104.add(_objectSpread(_objectSpread({},_e499),{},{alias:i,src:Array.isArray(_r219)?_r219:[_r219]}));}r.push.apply(r,i);}),this._bundles[e]=r;}},{key:"add",value:function add(e,t,r,n,i){var _this105=this;var o=[];var a;"string"==typeof e||Array.isArray(e)&&"string"==typeof e[0]?(_deprecation("7.2.0","Assets.add now uses an object instead of individual parameters.\nPlease use Assets.add({ alias, src, data, format, loadParser }) instead."),o.push({alias:e,src:t,data:r,format:n,loadParser:i})):Array.isArray(e)?o.push.apply(o,_toConsumableArray2(e)):o.push(e),a=function a(e){_this105.hasKey(e)&&console.warn("[Resolver] already has key: ".concat(e," overwriting"));},_convertToList(o).forEach(function(e){var t=e.src,r=e.srcs;var n=e.data,i=e.format,o=e.loadParser;var s=_convertToList(t||r).map(function(e){return"string"==typeof e?_createStringVariations(e):Array.isArray(e)?e:[e];}),u=_this105.getAlias(e);Array.isArray(u)?u.forEach(a):a(u);var l=[];s.forEach(function(e){e.forEach(function(e){var _e$data,_e$format,_e$loadParser;var t={};if("object"!=_typeof2(e)){t.src=e;for(var _r220=0;_r220<_this105._parsers.length;_r220++){var _n153=_this105._parsers[_r220];if(_n153.test(e)){t=_n153.parse(e);break;}}}else n=(_e$data=e.data)!==null&&_e$data!==void 0?_e$data:n,i=(_e$format=e.format)!==null&&_e$format!==void 0?_e$format:i,o=(_e$loadParser=e.loadParser)!==null&&_e$loadParser!==void 0?_e$loadParser:o,t=_objectSpread(_objectSpread({},t),e);if(!u)throw new Error("[Resolver] alias is undefined for this asset: ".concat(t.src));t=_this105.buildResolvedAsset(t,{aliases:u,data:n,format:i,loadParser:o}),l.push(t);});}),u.forEach(function(e){_this105._assetMap[e]=l;});});}},{key:"resolveBundle",value:function resolveBundle(e){var _this106=this;var t=_isSingleItem(e);e=_convertToList(e);var r={};return e.forEach(function(e){var t=_this106._bundles[e];if(t){var n=_this106.resolve(t),i={};for(var _t241 in n){var _r221=n[_t241];i[_this106._extractAssetIdFromBundle(e,_t241)]=_r221;}r[e]=i;}}),t?r[e[0]]:r;}},{key:"resolveUrl",value:function resolveUrl(e){var t=this.resolve(e);if("string"!=typeof e){var _e500={};for(var r in t)_e500[r]=t[r].src;return _e500;}return t.src;}},{key:"resolve",value:function resolve(e){var _this107=this;var t=_isSingleItem(e);e=_convertToList(e);var r={};return e.forEach(function(e){if(!_this107._resolverHash[e])if(_this107._assetMap[e]){var _t242$;var _t242=_this107._assetMap[e];var _r222=_t242[0],n=_this107._getPreferredOrder(_t242);n!==null&&n!==void 0&&n.priority.forEach(function(e){n.params[e].forEach(function(r){var n=_t242.filter(function(t){return!!t[e]&&t[e]===r;});n.length&&(_t242=n);});}),_this107._resolverHash[e]=(_t242$=_t242[0])!==null&&_t242$!==void 0?_t242$:_r222;}else _this107._resolverHash[e]=_this107.buildResolvedAsset({alias:[e],src:e},{});r[e]=_this107._resolverHash[e];}),t?r[e[0]]:r;}},{key:"hasKey",value:function hasKey(e){return!!this._assetMap[e];}},{key:"hasBundle",value:function hasBundle(e){return!!this._bundles[e];}},{key:"_getPreferredOrder",value:function _getPreferredOrder(e){var _this108=this;var _loop11=function _loop11(){var t=e[0],r=_this108._preferredOrder.find(function(e){return e.params.format.includes(t.format);});if(r)return{v:r};},_ret;for(var _t243=0;_t243<e.length;_t243++){_ret=_loop11();if(_ret)return _ret.v;}return this._preferredOrder[0];}},{key:"_appendDefaultSearchParams",value:function _appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;return"".concat(e).concat(/\?/.test(e)?"&":"?").concat(this._defaultSearchParams);}},{key:"buildResolvedAsset",value:function buildResolvedAsset(e,t){var _ref55,_ref56;var r=t.aliases,n=t.data,i=t.loadParser,o=t.format;return(this._basePath||this._rootPath)&&(e.src=_path.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=(_ref55=r!==null&&r!==void 0?r:e.alias)!==null&&_ref55!==void 0?_ref55:[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data=_objectSpread(_objectSpread({},n||{}),e.data),e.loadParser=i!==null&&i!==void 0?i:e.loadParser,e.format=(_ref56=o!==null&&o!==void 0?o:e.format)!==null&&_ref56!==void 0?_ref56:_path.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e;}}]);}();var _AssetsClass=/*#__PURE__*/function(){function _AssetsClass(){_classCallCheck2(this,_AssetsClass);this._detections=[],this._initialized=!1,this.resolver=new Resolver(),this.loader=new Loader(),this.cache=_Cache,this._backgroundLoader=new BackgroundLoader(this.loader),this._backgroundLoader.active=!0,this.reset();}return _createClass2(_AssetsClass,[{key:"init",value:function(){var _init3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee90(){var _e$texturePreference$,_e$texturePreference,_e$texturePreference2;var e,_t244,t,r,n,_args93=arguments;return _regeneratorRuntime2().wrap(function _callee90$(_context94){while(1)switch(_context94.prev=_context94.next){case 0:e=_args93.length>0&&_args93[0]!==undefined?_args93[0]:{};if(!this._initialized){_context94.next=3;break;}return _context94.abrupt("return",void console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?"));case 3:if(!(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest)){_context94.next=11;break;}_t244=e.manifest;_context94.t0="string"==typeof _t244;if(!_context94.t0){_context94.next=10;break;}_context94.next=9;return this.load(_t244);case 9:_t244=_context94.sent;case 10:this.resolver.addManifest(_t244);case 11:t=(_e$texturePreference$=(_e$texturePreference=e.texturePreference)===null||_e$texturePreference===void 0?void 0:_e$texturePreference.resolution)!==null&&_e$texturePreference$!==void 0?_e$texturePreference$:1;r="number"==typeof t?[t]:t;_context94.next=15;return this._detectFormats({preferredFormats:(_e$texturePreference2=e.texturePreference)===null||_e$texturePreference2===void 0?void 0:_e$texturePreference2.format,skipDetections:e.skipDetections,detections:this._detections});case 15:n=_context94.sent;this.resolver.prefer({params:{format:n,resolution:r}}),e.preferences&&this.setPreferences(e.preferences);case 17:case"end":return _context94.stop();}},_callee90,this);}));function init(){return _init3.apply(this,arguments);}return init;}()},{key:"add",value:function add(e,t,r,n,i){this.resolver.add(e,t,r,n,i);}},{key:"load",value:function(){var _load5=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee91(e,t){var _this109=this;var r,n,i,o;return _regeneratorRuntime2().wrap(function _callee91$(_context95){while(1)switch(_context95.prev=_context95.next){case 0:_context95.t0=this._initialized;if(_context95.t0){_context95.next=4;break;}_context95.next=4;return this.init();case 4:r=_isSingleItem(e);n=_convertToList(e).map(function(e){if("string"!=typeof e){var _t245=_this109.resolver.getAlias(e);return _t245.some(function(e){return!_this109.resolver.hasKey(e);})&&_this109.add(e),Array.isArray(_t245)?_t245[0]:_t245;}return _this109.resolver.hasKey(e)||_this109.add({alias:e,src:e}),e;});i=this.resolver.resolve(n);_context95.next=9;return this._mapLoadToResolve(i,t);case 9:o=_context95.sent;return _context95.abrupt("return",r?o[n[0]]:o);case 11:case"end":return _context95.stop();}},_callee91,this);}));function load(_x110,_x111){return _load5.apply(this,arguments);}return load;}()},{key:"addBundle",value:function addBundle(e,t){this.resolver.addBundle(e,t);}},{key:"loadBundle",value:function(){var _loadBundle=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee92(e,t){var _this110=this;var r,n,i,o,a,s,u,l;return _regeneratorRuntime2().wrap(function _callee92$(_context96){while(1)switch(_context96.prev=_context96.next){case 0:_context96.t0=this._initialized;if(_context96.t0){_context96.next=4;break;}_context96.next=4;return this.init();case 4:r=!1;"string"==typeof e&&(r=!0,e=[e]);n=this.resolver.resolveBundle(e),i={},o=Object.keys(n);a=0,s=0;u=function u(){t===null||t===void 0||t(++a/s);},l=o.map(function(e){var t=n[e];return s+=Object.keys(t).length,_this110._mapLoadToResolve(t,u).then(function(t){i[e]=t;});});_context96.next=11;return Promise.all(l);case 11:return _context96.abrupt("return",r?i[e[0]]:i);case 12:case"end":return _context96.stop();}},_callee92,this);}));function loadBundle(_x112,_x113){return _loadBundle.apply(this,arguments);}return loadBundle;}()},{key:"backgroundLoad",value:function(){var _backgroundLoad=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee93(e){var t;return _regeneratorRuntime2().wrap(function _callee93$(_context97){while(1)switch(_context97.prev=_context97.next){case 0:_context97.t0=this._initialized;if(_context97.t0){_context97.next=4;break;}_context97.next=4;return this.init();case 4:"string"==typeof e&&(e=[e]);t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t));case 7:case"end":return _context97.stop();}},_callee93,this);}));function backgroundLoad(_x114){return _backgroundLoad.apply(this,arguments);}return backgroundLoad;}()},{key:"backgroundLoadBundle",value:function(){var _backgroundLoadBundle=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee94(e){var _this111=this;var t;return _regeneratorRuntime2().wrap(function _callee94$(_context98){while(1)switch(_context98.prev=_context98.next){case 0:_context98.t0=this._initialized;if(_context98.t0){_context98.next=4;break;}_context98.next=4;return this.init();case 4:"string"==typeof e&&(e=[e]);t=this.resolver.resolveBundle(e);Object.values(t).forEach(function(e){_this111._backgroundLoader.add(Object.values(e));});case 7:case"end":return _context98.stop();}},_callee94,this);}));function backgroundLoadBundle(_x115){return _backgroundLoadBundle.apply(this,arguments);}return backgroundLoadBundle;}()},{key:"reset",value:function reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1;}},{key:"get",value:function get(e){if("string"==typeof e)return _Cache.get(e);var t={};for(var r=0;r<e.length;r++)t[r]=_Cache.get(e[r]);return t;}},{key:"_mapLoadToResolve",value:function(){var _mapLoadToResolve2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee95(e,t){var r,n,i,o;return _regeneratorRuntime2().wrap(function _callee95$(_context99){while(1)switch(_context99.prev=_context99.next){case 0:r=Object.values(e),n=Object.keys(e);this._backgroundLoader.active=!1;_context99.next=4;return this.loader.load(r,t);case 4:i=_context99.sent;this._backgroundLoader.active=!0;o={};return _context99.abrupt("return",(r.forEach(function(e,t){var r=i[e.src],a=[e.src];e.alias&&a.push.apply(a,_toConsumableArray2(e.alias)),o[n[t]]=r,_Cache.set(a,r);}),o));case 8:case"end":return _context99.stop();}},_callee95,this);}));function _mapLoadToResolve(_x116,_x117){return _mapLoadToResolve2.apply(this,arguments);}return _mapLoadToResolve;}()},{key:"unload",value:function(){var _unload2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee96(e){var t,r;return _regeneratorRuntime2().wrap(function _callee96$(_context100){while(1)switch(_context100.prev=_context100.next){case 0:_context100.t0=this._initialized;if(_context100.t0){_context100.next=4;break;}_context100.next=4;return this.init();case 4:t=_convertToList(e).map(function(e){return"string"!=typeof e?e.src:e;}),r=this.resolver.resolve(t);_context100.next=7;return this._unloadFromResolved(r);case 7:case"end":return _context100.stop();}},_callee96,this);}));function unload(_x118){return _unload2.apply(this,arguments);}return unload;}()},{key:"unloadBundle",value:function(){var _unloadBundle=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee97(e){var _this112=this;var t,r;return _regeneratorRuntime2().wrap(function _callee97$(_context101){while(1)switch(_context101.prev=_context101.next){case 0:_context101.t0=this._initialized;if(_context101.t0){_context101.next=4;break;}_context101.next=4;return this.init();case 4:e=_convertToList(e);t=this.resolver.resolveBundle(e),r=Object.keys(t).map(function(e){return _this112._unloadFromResolved(t[e]);});_context101.next=8;return Promise.all(r);case 8:case"end":return _context101.stop();}},_callee97,this);}));function unloadBundle(_x119){return _unloadBundle.apply(this,arguments);}return unloadBundle;}()},{key:"_unloadFromResolved",value:function(){var _unloadFromResolved2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee98(e){var t;return _regeneratorRuntime2().wrap(function _callee98$(_context102){while(1)switch(_context102.prev=_context102.next){case 0:t=Object.values(e);t.forEach(function(e){_Cache.remove(e.src);});_context102.next=4;return this.loader.unload(t);case 4:case"end":return _context102.stop();}},_callee98,this);}));function _unloadFromResolved(_x120){return _unloadFromResolved2.apply(this,arguments);}return _unloadFromResolved;}()},{key:"_detectFormats",value:function(){var _detectFormats2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee99(e){var t,_iterator48,_step48,r;return _regeneratorRuntime2().wrap(function _callee99$(_context103){while(1)switch(_context103.prev=_context103.next){case 0:t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);_iterator48=_createForOfIteratorHelper2(e.detections);_context103.prev=3;_iterator48.s();case 5:if((_step48=_iterator48.n()).done){_context103.next=25;break;}r=_step48.value;_context103.t0=e.skipDetections;if(_context103.t0){_context103.next=12;break;}_context103.next=11;return r.test();case 11:_context103.t0=_context103.sent;case 12:if(!_context103.t0){_context103.next=18;break;}_context103.next=15;return r.add(t);case 15:t=_context103.sent;_context103.next=23;break;case 18:_context103.t1=e.skipDetections;if(_context103.t1){_context103.next=23;break;}_context103.next=22;return r.remove(t);case 22:t=_context103.sent;case 23:_context103.next=5;break;case 25:_context103.next=30;break;case 27:_context103.prev=27;_context103.t2=_context103["catch"](3);_iterator48.e(_context103.t2);case 30:_context103.prev=30;_iterator48.f();return _context103.finish(30);case 33:return _context103.abrupt("return",(t=t.filter(function(e,r){return t.indexOf(e)===r;}),t));case 34:case"end":return _context103.stop();}},_callee99,null,[[3,27,30,33]]);}));function _detectFormats(_x121){return _detectFormats2.apply(this,arguments);}return _detectFormats;}()},{key:"detections",get:function get(){return this._detections;}},{key:"preferWorkers",get:function get(){return _loadTextures.config.preferWorkers;},set:function set(e){_deprecation("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e});}},{key:"setPreferences",value:function setPreferences(e){this.loader.parsers.forEach(function(t){t.config&&Object.keys(t.config).filter(function(t){return t in e;}).forEach(function(r){t.config[r]=e[r];});});}}]);}();var _Assets=new _AssetsClass();_extensions.handleByList(_ExtensionType.LoadParser,_Assets.loader.parsers).handleByList(_ExtensionType.ResolveParser,_Assets.resolver.parsers).handleByList(_ExtensionType.CacheParser,_Assets.cache.parsers).handleByList(_ExtensionType.DetectionParser,_Assets.detections);var _cacheTextureArray={extension:_ExtensionType.CacheParser,test:function test(e){return Array.isArray(e)&&e.every(function(e){return e instanceof Texture_Texture;});},getCacheableAssets:function getCacheableAssets(e,t){var r={};return e.forEach(function(e){t.forEach(function(t,n){r[e+(0===n?"":n+1)]=t;});}),r;}};function testImageFormat(_x122){return _testImageFormat.apply(this,arguments);}function _testImageFormat(){_testImageFormat=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee188(e){var _t416;return _regeneratorRuntime2().wrap(function _callee188$(_context194){while(1)switch(_context194.prev=_context194.next){case 0:if(!("Image"in globalThis)){_context194.next=2;break;}return _context194.abrupt("return",new Promise(function(t){var r=new Image();r.onload=function(){t(!0);},r.onerror=function(){t(!1);},r.src=e;}));case 2:if(!("createImageBitmap"in globalThis&&"fetch"in globalThis)){_context194.next=17;break;}_context194.prev=3;_context194.next=6;return fetch(e);case 6:_context194.next=8;return _context194.sent.blob();case 8:_t416=_context194.sent;_context194.next=11;return createImageBitmap(_t416);case 11:_context194.next=16;break;case 13:_context194.prev=13;_context194.t0=_context194["catch"](3);return _context194.abrupt("return",!1);case 16:return _context194.abrupt("return",!0);case 17:return _context194.abrupt("return",!1);case 18:case"end":return _context194.stop();}},_callee188,null,[[3,13]]);}));return _testImageFormat.apply(this,arguments);}_extensions.add(_cacheTextureArray);var _detectAvif={extension:{type:_ExtensionType.DetectionParser,priority:1},test:function(){var _test=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee100(){return _regeneratorRuntime2().wrap(function _callee100$(_context104){while(1)switch(_context104.prev=_context104.next){case 0:return _context104.abrupt("return",testImageFormat("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="));case 1:case"end":return _context104.stop();}},_callee100);}));function test(){return _test.apply(this,arguments);}return test;}(),add:function(){var _add=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee101(e){return _regeneratorRuntime2().wrap(function _callee101$(_context105){while(1)switch(_context105.prev=_context105.next){case 0:return _context105.abrupt("return",[].concat(_toConsumableArray2(e),["avif"]));case 1:case"end":return _context105.stop();}},_callee101);}));function add(_x123){return _add.apply(this,arguments);}return add;}(),remove:function(){var _remove=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee102(e){return _regeneratorRuntime2().wrap(function _callee102$(_context106){while(1)switch(_context106.prev=_context106.next){case 0:return _context106.abrupt("return",e.filter(function(e){return"avif"!==e;}));case 1:case"end":return _context106.stop();}},_callee102);}));function remove(_x124){return _remove.apply(this,arguments);}return remove;}()};_extensions.add(_detectAvif);var _detectWebp={extension:{type:_ExtensionType.DetectionParser,priority:0},test:function(){var _test2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee103(){return _regeneratorRuntime2().wrap(function _callee103$(_context107){while(1)switch(_context107.prev=_context107.next){case 0:return _context107.abrupt("return",testImageFormat("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="));case 1:case"end":return _context107.stop();}},_callee103);}));function test(){return _test2.apply(this,arguments);}return test;}(),add:function(){var _add2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee104(e){return _regeneratorRuntime2().wrap(function _callee104$(_context108){while(1)switch(_context108.prev=_context108.next){case 0:return _context108.abrupt("return",[].concat(_toConsumableArray2(e),["webp"]));case 1:case"end":return _context108.stop();}},_callee104);}));function add(_x125){return _add2.apply(this,arguments);}return add;}(),remove:function(){var _remove2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee105(e){return _regeneratorRuntime2().wrap(function _callee105$(_context109){while(1)switch(_context109.prev=_context109.next){case 0:return _context109.abrupt("return",e.filter(function(e){return"webp"!==e;}));case 1:case"end":return _context109.stop();}},_callee105);}));function remove(_x126){return _remove2.apply(this,arguments);}return remove;}()};_extensions.add(_detectWebp);var imageFormats=["png","jpg","jpeg"],_detectDefaults={extension:{type:_ExtensionType.DetectionParser,priority:-1},test:function test(){return Promise.resolve(!0);},add:function(){var _add3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee106(e){return _regeneratorRuntime2().wrap(function _callee106$(_context110){while(1)switch(_context110.prev=_context110.next){case 0:return _context110.abrupt("return",[].concat(_toConsumableArray2(e),imageFormats));case 1:case"end":return _context110.stop();}},_callee106);}));function add(_x127){return _add3.apply(this,arguments);}return add;}(),remove:function(){var _remove3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee107(e){return _regeneratorRuntime2().wrap(function _callee107$(_context111){while(1)switch(_context111.prev=_context111.next){case 0:return _context111.abrupt("return",e.filter(function(e){return!imageFormats.includes(e);}));case 1:case"end":return _context111.stop();}},_callee107);}));function remove(_x128){return _remove3.apply(this,arguments);}return remove;}()};_extensions.add(_detectDefaults);var inWorker="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function testVideoFormat(e){return!inWorker&&""!==document.createElement("video").canPlayType(e);}var _detectWebm={extension:{type:_ExtensionType.DetectionParser,priority:0},test:function(){var _test3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee108(){return _regeneratorRuntime2().wrap(function _callee108$(_context112){while(1)switch(_context112.prev=_context112.next){case 0:return _context112.abrupt("return",testVideoFormat("video/webm"));case 1:case"end":return _context112.stop();}},_callee108);}));function test(){return _test3.apply(this,arguments);}return test;}(),add:function(){var _add4=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee109(e){return _regeneratorRuntime2().wrap(function _callee109$(_context113){while(1)switch(_context113.prev=_context113.next){case 0:return _context113.abrupt("return",[].concat(_toConsumableArray2(e),["webm"]));case 1:case"end":return _context113.stop();}},_callee109);}));function add(_x129){return _add4.apply(this,arguments);}return add;}(),remove:function(){var _remove4=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee110(e){return _regeneratorRuntime2().wrap(function _callee110$(_context114){while(1)switch(_context114.prev=_context114.next){case 0:return _context114.abrupt("return",e.filter(function(e){return"webm"!==e;}));case 1:case"end":return _context114.stop();}},_callee110);}));function remove(_x130){return _remove4.apply(this,arguments);}return remove;}()};_extensions.add(_detectWebm);var _detectMp={extension:{type:_ExtensionType.DetectionParser,priority:0},test:function(){var _test4=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee111(){return _regeneratorRuntime2().wrap(function _callee111$(_context115){while(1)switch(_context115.prev=_context115.next){case 0:return _context115.abrupt("return",testVideoFormat("video/mp4"));case 1:case"end":return _context115.stop();}},_callee111);}));function test(){return _test4.apply(this,arguments);}return test;}(),add:function(){var _add5=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee112(e){return _regeneratorRuntime2().wrap(function _callee112$(_context116){while(1)switch(_context116.prev=_context116.next){case 0:return _context116.abrupt("return",[].concat(_toConsumableArray2(e),["mp4","m4v"]));case 1:case"end":return _context116.stop();}},_callee112);}));function add(_x131){return _add5.apply(this,arguments);}return add;}(),remove:function(){var _remove5=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee113(e){return _regeneratorRuntime2().wrap(function _callee113$(_context117){while(1)switch(_context117.prev=_context117.next){case 0:return _context117.abrupt("return",e.filter(function(e){return"mp4"!==e&&"m4v"!==e;}));case 1:case"end":return _context117.stop();}},_callee113);}));function remove(_x132){return _remove5.apply(this,arguments);}return remove;}()};_extensions.add(_detectMp);var _detectOgv={extension:{type:_ExtensionType.DetectionParser,priority:0},test:function(){var _test5=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee114(){return _regeneratorRuntime2().wrap(function _callee114$(_context118){while(1)switch(_context118.prev=_context118.next){case 0:return _context118.abrupt("return",testVideoFormat("video/ogg"));case 1:case"end":return _context118.stop();}},_callee114);}));function test(){return _test5.apply(this,arguments);}return test;}(),add:function(){var _add6=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee115(e){return _regeneratorRuntime2().wrap(function _callee115$(_context119){while(1)switch(_context119.prev=_context119.next){case 0:return _context119.abrupt("return",[].concat(_toConsumableArray2(e),["ogv"]));case 1:case"end":return _context119.stop();}},_callee115);}));function add(_x133){return _add6.apply(this,arguments);}return add;}(),remove:function(){var _remove6=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee116(e){return _regeneratorRuntime2().wrap(function _callee116$(_context120){while(1)switch(_context120.prev=_context120.next){case 0:return _context120.abrupt("return",e.filter(function(e){return"ogv"!==e;}));case 1:case"end":return _context120.stop();}},_callee116);}));function remove(_x134){return _remove6.apply(this,arguments);}return remove;}()};_extensions.add(_detectOgv);var _resolveTextureUrl={extension:_ExtensionType.ResolveParser,test:_loadTextures.test,parse:function parse(e){var _settings$RETINA_PREF2,_settings$RETINA_PREF3;return{resolution:parseFloat((_settings$RETINA_PREF2=(_settings$RETINA_PREF3=_settings.RETINA_PREFIX.exec(e))===null||_settings$RETINA_PREF3===void 0?void 0:_settings$RETINA_PREF3[1])!==null&&_settings$RETINA_PREF2!==void 0?_settings$RETINA_PREF2:"1"),format:_path.extname(e).slice(1),src:e};}};_extensions.add(_resolveTextureUrl);var _copySearchParams=function _copySearchParams(e,t){var r=t.split("?")[1];return r&&(e+="?".concat(r)),e;};var _INTERNAL_FORMATS=function(e){return e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e;}(_INTERNAL_FORMATS||{});var _INTERNAL_FORMAT_TO_BYTES_PER_PIXEL={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};var storedGl,detectCompressedTextures_extensions;function getCompressedTextureExtensions(){detectCompressedTextures_extensions={bptc:storedGl.getExtension("EXT_texture_compression_bptc"),astc:storedGl.getExtension("WEBGL_compressed_texture_astc"),etc:storedGl.getExtension("WEBGL_compressed_texture_etc"),s3tc:storedGl.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:storedGl.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:storedGl.getExtension("WEBGL_compressed_texture_pvrtc")||storedGl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:storedGl.getExtension("WEBGL_compressed_texture_etc1"),atc:storedGl.getExtension("WEBGL_compressed_texture_atc")};}var _detectCompressedTextures={extension:{type:_ExtensionType.DetectionParser,priority:2},test:function(){var _test6=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee117(){var e;return _regeneratorRuntime2().wrap(function _callee117$(_context121){while(1)switch(_context121.prev=_context121.next){case 0:e=_settings.ADAPTER.createCanvas().getContext("webgl");return _context121.abrupt("return",e?(storedGl=e,!0):(console.warn("WebGL not available for compressed textures."),!1));case 2:case"end":return _context121.stop();}},_callee117);}));function test(){return _test6.apply(this,arguments);}return test;}(),add:function(){var _add7=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee118(e){var t,_e501;return _regeneratorRuntime2().wrap(function _callee118$(_context122){while(1)switch(_context122.prev=_context122.next){case 0:detectCompressedTextures_extensions||getCompressedTextureExtensions();t=[];for(_e501 in detectCompressedTextures_extensions)detectCompressedTextures_extensions[_e501]&&t.push(_e501);return _context122.abrupt("return",[].concat(t,_toConsumableArray2(e)));case 4:case"end":return _context122.stop();}},_callee118);}));function add(_x135){return _add7.apply(this,arguments);}return add;}(),remove:function(){var _remove7=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee119(e){return _regeneratorRuntime2().wrap(function _callee119$(_context123){while(1)switch(_context123.prev=_context123.next){case 0:return _context123.abrupt("return",(detectCompressedTextures_extensions||getCompressedTextureExtensions(),e.filter(function(e){return!(e in detectCompressedTextures_extensions);})));case 1:case"end":return _context123.stop();}},_callee119);}));function remove(_x136){return _remove7.apply(this,arguments);}return remove;}()};_extensions.add(_detectCompressedTextures);var _BlobResource=/*#__PURE__*/function(_BufferResource2){function _BlobResource(e){var _this113;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{width:1,height:1,autoLoad:!0};_classCallCheck2(this,_BlobResource);var r,n;"string"==typeof e?(r=e,n=new Uint8Array()):(r=null,n=e),_this113=_callSuper2(this,_BlobResource,[n,t]),_this113.origin=r,_this113.buffer=n?new _ViewableBuffer(n):null,_this113._load=null,_this113.loaded=!1,null!==_this113.origin&&!1!==t.autoLoad&&_this113.load(),null===_this113.origin&&_this113.buffer&&(_this113._load=Promise.resolve(_assertThisInitialized2(_this113)),_this113.loaded=!0,_this113.onBlobLoaded(_this113.buffer.rawBinaryData));return _this113;}_inherits2(_BlobResource,_BufferResource2);return _createClass2(_BlobResource,[{key:"onBlobLoaded",value:function onBlobLoaded(e){}},{key:"load",value:function load(){var _this114=this;return this._load||(this._load=fetch(this.origin).then(function(e){return e.blob();}).then(function(e){return e.arrayBuffer();}).then(function(e){return _this114.data=new Uint32Array(e),_this114.buffer=new _ViewableBuffer(e),_this114.loaded=!0,_this114.onBlobLoaded(e),_this114.update(),_this114;})),this._load;}}]);}(_BufferResource);var _CompressedTextureResource=/*#__PURE__*/function(_BlobResource2){function _CompressedTextureResource(e,t){var _this115;_classCallCheck2(this,_CompressedTextureResource);_this115=_callSuper2(this,_CompressedTextureResource,[e,t]),_this115.format=t.format,_this115.levels=t.levels||1,_this115._width=t.width,_this115._height=t.height,_this115._extension=_CompressedTextureResource._formatToExtension(_this115.format),(t.levelBuffers||_this115.buffer)&&(_this115._levelBuffers=t.levelBuffers||_CompressedTextureResource._createLevelBuffers(e instanceof Uint8Array?e:_this115.buffer.uint8View,_this115.format,_this115.levels,4,4,_this115.width,_this115.height));return _this115;}_inherits2(_CompressedTextureResource,_BlobResource2);return _createClass2(_CompressedTextureResource,[{key:"upload",value:function upload(e,t,r){var n=e.gl;if(!e.context.extensions[this._extension])throw new Error("".concat(this._extension," textures are not supported on the current machine"));if(!this._levelBuffers)return!1;n.pixelStorei(n.UNPACK_ALIGNMENT,4);for(var _e502=0,_t246=this.levels;_e502<_t246;_e502++){var _this$_levelBuffers$_=this._levelBuffers[_e502],_t247=_this$_levelBuffers$_.levelID,_r223=_this$_levelBuffers$_.levelWidth,i=_this$_levelBuffers$_.levelHeight,_o73=_this$_levelBuffers$_.levelBuffer;n.compressedTexImage2D(n.TEXTURE_2D,_t247,this.format,_r223,i,0,_o73);}return!0;}},{key:"onBlobLoaded",value:function onBlobLoaded(){this._levelBuffers=_CompressedTextureResource._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height);}}],[{key:"_formatToExtension",value:function _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=35916&&e<=35919)return"s3tc_sRGB";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(36196===e)return"etc1";if(35986===e||35987===e||34798===e)return"atc";if(e>=36492&&e<=36495)return"bptc";if(37808===e)return"astc";throw new Error("Invalid (compressed) texture format given: ".concat(e));}},{key:"_createLevelBuffers",value:function _createLevelBuffers(e,t,r,n,i,o,a){var s=new Array(r);var u=e.byteOffset,l=o,c=a,h=l+n-1&~(n-1),f=c+i-1&~(i-1),d=h*f*_INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[t];for(var _o74=0;_o74<r;_o74++)s[_o74]={levelID:_o74,levelWidth:r>1?l:h,levelHeight:r>1?c:f,levelBuffer:new Uint8Array(e.buffer,u,d)},u+=d,l=l>>1||1,c=c>>1||1,h=l+n-1&~(n-1),f=c+i-1&~(i-1),d=h*f*_INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[t];return s;}}]);}(_BlobResource);var DDS_MAGIC_SIZE=4,DDS_HEADER_SIZE=124,DDS_HEADER_PF_SIZE=32,DDS_HEADER_DX10_SIZE=20,DDS_MAGIC=542327876,DDS_FIELDS={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},DDS_PF_FIELDS={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},DDS_DX10_FIELDS={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},PF_FLAGS=1,DDPF_ALPHA=2,DDPF_FOURCC=4,DDPF_RGB=64,DDPF_YUV=512,DDPF_LUMINANCE=131072,FOURCC_DXT1=827611204,FOURCC_DXT3=861165636,FOURCC_DXT5=894720068,FOURCC_DX10=808540228,DDS_RESOURCE_MISC_TEXTURECUBE=4,FOURCC_TO_FORMAT=_defineProperty(_defineProperty(_defineProperty({},FOURCC_DXT1,_INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT),FOURCC_DXT3,_INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT),FOURCC_DXT5,_INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT),DXGI_TO_FORMAT={70:_INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:_INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:_INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:_INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:_INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:_INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:_INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:_INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:_INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:_INTERNAL_FORMATS.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:_INTERNAL_FORMATS.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:_INTERNAL_FORMATS.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:_INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function _parseDDS(e){var t=new Uint32Array(e);if(t[0]!==DDS_MAGIC)throw new Error("Invalid DDS file magic word");var r=new Uint32Array(e,0,DDS_HEADER_SIZE/Uint32Array.BYTES_PER_ELEMENT),n=r[DDS_FIELDS.HEIGHT],i=r[DDS_FIELDS.WIDTH],o=r[DDS_FIELDS.MIPMAP_COUNT],a=new Uint32Array(e,DDS_FIELDS.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,DDS_HEADER_PF_SIZE/Uint32Array.BYTES_PER_ELEMENT),s=a[PF_FLAGS];if(s&DDPF_FOURCC){var _r224=a[DDS_PF_FIELDS.FOURCC];if(_r224!==FOURCC_DX10){var _t248=FOURCC_TO_FORMAT[_r224],_a53=new Uint8Array(e,DDS_MAGIC_SIZE+DDS_HEADER_SIZE);return[new _CompressedTextureResource(_a53,{format:_t248,width:i,height:n,levels:o})];}var _s43=DDS_MAGIC_SIZE+DDS_HEADER_SIZE,_u30=new Uint32Array(t.buffer,_s43,DDS_HEADER_DX10_SIZE/Uint32Array.BYTES_PER_ELEMENT),_l19=_u30[DDS_DX10_FIELDS.DXGI_FORMAT],_c19=_u30[DDS_DX10_FIELDS.RESOURCE_DIMENSION],_h13=_u30[DDS_DX10_FIELDS.MISC_FLAG],_f11=_u30[DDS_DX10_FIELDS.ARRAY_SIZE],_d11=DXGI_TO_FORMAT[_l19];if(void 0===_d11)throw new Error("DDSParser cannot parse texture data with DXGI format ".concat(_l19));if(_h13===DDS_RESOURCE_MISC_TEXTURECUBE)throw new Error("DDSParser does not support cubemap textures");if(6===_c19)throw new Error("DDSParser does not supported 3D texture data");var _p9=new Array(),_y5=DDS_MAGIC_SIZE+DDS_HEADER_SIZE+DDS_HEADER_DX10_SIZE;if(1===_f11)_p9.push(new Uint8Array(e,_y5));else{var _t249=_INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[_d11];var _r225=0,_a54=i,_s44=n;for(var _e503=0;_e503<o;_e503++){_r225+=Math.max(1,_a54+3&-4)*Math.max(1,_s44+3&-4)*_t249,_a54>>>=1,_s44>>>=1;}var _u31=_y5;for(var _t250=0;_t250<_f11;_t250++)_p9.push(new Uint8Array(e,_u31,_r225)),_u31+=_r225;}return _p9.map(function(e){return new _CompressedTextureResource(e,{format:_d11,width:i,height:n,levels:o});});}throw s&DDPF_RGB?new Error("DDSParser does not support uncompressed texture data."):s&DDPF_YUV?new Error("DDSParser does not supported YUV uncompressed texture data."):s&DDPF_LUMINANCE?new Error("DDSParser does not support single-channel (lumninance) texture data!"):s&DDPF_ALPHA?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!");}var FILE_IDENTIFIER=[171,75,84,88,32,49,49,187,13,10,26,10],ENDIANNESS=67305985,KTX_FIELDS={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},FILE_HEADER_SIZE=64,_TYPES_TO_BYTES_PER_COMPONENT=_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},_TYPES.UNSIGNED_BYTE,1),_TYPES.UNSIGNED_SHORT,2),_TYPES.INT,4),_TYPES.UNSIGNED_INT,4),_TYPES.FLOAT,4),_TYPES.HALF_FLOAT,8),_FORMATS_TO_COMPONENTS=_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},_FORMATS.RGBA,4),_FORMATS.RGB,3),_FORMATS.RG,2),_FORMATS.RED,1),_FORMATS.LUMINANCE,1),_FORMATS.LUMINANCE_ALPHA,2),_FORMATS.ALPHA,1),_TYPES_TO_BYTES_PER_PIXEL=_defineProperty(_defineProperty(_defineProperty({},_TYPES.UNSIGNED_SHORT_4_4_4_4,2),_TYPES.UNSIGNED_SHORT_5_5_5_1,2),_TYPES.UNSIGNED_SHORT_5_6_5,2);function _parseKTX(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;var n=new DataView(t);if(!tsvb_validate(e,n))return null;var i=n.getUint32(KTX_FIELDS.ENDIANNESS,!0)===ENDIANNESS,o=n.getUint32(KTX_FIELDS.GL_TYPE,i),a=n.getUint32(KTX_FIELDS.GL_FORMAT,i),s=n.getUint32(KTX_FIELDS.GL_INTERNAL_FORMAT,i),u=n.getUint32(KTX_FIELDS.PIXEL_WIDTH,i),l=n.getUint32(KTX_FIELDS.PIXEL_HEIGHT,i)||1,c=n.getUint32(KTX_FIELDS.PIXEL_DEPTH,i)||1,h=n.getUint32(KTX_FIELDS.NUMBER_OF_ARRAY_ELEMENTS,i)||1,f=n.getUint32(KTX_FIELDS.NUMBER_OF_FACES,i),d=n.getUint32(KTX_FIELDS.NUMBER_OF_MIPMAP_LEVELS,i),p=n.getUint32(KTX_FIELDS.BYTES_OF_KEY_VALUE_DATA,i);if(0===l||1!==c)throw new Error("Only 2D textures are supported");if(1!==f)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==h)throw new Error("WebGL does not support array textures");var y=u+3&-4,m=l+3&-4,g=new Array(h);var w,b=u*l;if(0===o&&(b=y*m),w=0!==o?_TYPES_TO_BYTES_PER_COMPONENT[o]?_TYPES_TO_BYTES_PER_COMPONENT[o]*_FORMATS_TO_COMPONENTS[a]:_TYPES_TO_BYTES_PER_PIXEL[o]:_INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[s],void 0===w)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");var v=r?parseKvData(n,p,i):null;var x=b*w,_=u,S=l,T=y,I=m,E=FILE_HEADER_SIZE+p;for(var _e504=0;_e504<d;_e504++){var _r226=n.getUint32(E,i);var _a55=E+4;for(var _r227=0;_r227<h;_r227++){var _n154=g[_r227];_n154||(_n154=g[_r227]=new Array(d)),_n154[_e504]={levelID:_e504,levelWidth:d>1||0!==o?_:T,levelHeight:d>1||0!==o?S:I,levelBuffer:new Uint8Array(t,_a55,x)},_a55+=x;}E+=_r226+4,E=E%4!=0?E+4-E%4:E,_=_>>1||1,S=S>>1||1,T=_+4-1&-4,I=S+4-1&-4,x=T*I*w;}return 0!==o?{uncompressed:g.map(function(e){var t=e[0].levelBuffer,r=!1;return o===_TYPES.FLOAT?t=new Float32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4):o===_TYPES.UNSIGNED_INT?(r=!0,t=new Uint32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)):o===_TYPES.INT&&(r=!0,t=new Int32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)),{resource:new _BufferResource(t,{width:e[0].levelWidth,height:e[0].levelHeight}),type:o,format:r?convertFormatToInteger(a):a};}),kvData:v}:{compressed:g.map(function(e){return new _CompressedTextureResource(null,{format:s,width:u,height:l,levels:d,levelBuffers:e});}),kvData:v};}function tsvb_validate(e,t){for(var r=0;r<FILE_IDENTIFIER.length;r++)if(t.getUint8(r)!==FILE_IDENTIFIER[r])return console.error("".concat(e," is not a valid *.ktx file!")),!1;return!0;}function convertFormatToInteger(e){switch(e){case _FORMATS.RGBA:return _FORMATS.RGBA_INTEGER;case _FORMATS.RGB:return _FORMATS.RGB_INTEGER;case _FORMATS.RG:return _FORMATS.RG_INTEGER;case _FORMATS.RED:return _FORMATS.RED_INTEGER;default:return e;}}function parseKvData(e,t,r){var n=new Map();var i=0;for(;i<t;){var _o75=e.getUint32(FILE_HEADER_SIZE+i,r),_a56=FILE_HEADER_SIZE+i+4,_s45=3-(_o75+3)%4;if(0===_o75||_o75>t-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break;}var _u32=0;for(;_u32<_o75&&0!==e.getUint8(_a56+_u32);_u32++);if(-1===_u32){console.error("KTXLoader: Failed to find null byte terminating kvData key");break;}var _l20=new TextDecoder().decode(new Uint8Array(e.buffer,_a56,_u32)),_c20=new DataView(e.buffer,_a56+_u32+1,_o75-_u32-1);n.set(_l20,_c20),i+=4+_o75+_s45;}return n;}var _loadDDS={extension:{type:_ExtensionType.LoadParser,priority:_LoaderParserPriority.High},name:"loadDDS",test:function test(e){return _checkExtension(e,".dds");},load:function load(e,t,r){return _asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee120(){var n;return _regeneratorRuntime2().wrap(function _callee120$(_context124){while(1)switch(_context124.prev=_context124.next){case 0:_context124.t0=_parseDDS;_context124.next=3;return _settings.ADAPTER.fetch(e);case 3:_context124.next=5;return _context124.sent.arrayBuffer();case 5:_context124.t1=_context124.sent;n=(0,_context124.t0)(_context124.t1).map(function(n){return _createTexture(new _BaseTexture2(n,_objectSpread({mipmap:_MIPMAP_MODES.OFF,alphaMode:_ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,resolution:_getResolutionOfUrl(e)},t.data)),r,e);});return _context124.abrupt("return",1===n.length?n[0]:n);case 8:case"end":return _context124.stop();}},_callee120);}))();},unload:function unload(e){Array.isArray(e)?e.forEach(function(e){return e.destroy(!0);}):e.destroy(!0);}};_extensions.add(_loadDDS);var _loadKTX={extension:{type:_ExtensionType.LoadParser,priority:_LoaderParserPriority.High},name:"loadKTX",test:function test(e){return _checkExtension(e,".ktx");},load:function load(e,t,r){return _asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee121(){var n,_parseKTX2,i,o,a,s,u,l;return _regeneratorRuntime2().wrap(function _callee121$(_context125){while(1)switch(_context125.prev=_context125.next){case 0:_context125.next=2;return _settings.ADAPTER.fetch(e);case 2:_context125.next=4;return _context125.sent.arrayBuffer();case 4:n=_context125.sent;_parseKTX2=_parseKTX(e,n);i=_parseKTX2.compressed;o=_parseKTX2.uncompressed;a=_parseKTX2.kvData;s=i!==null&&i!==void 0?i:o;u=_objectSpread({mipmap:_MIPMAP_MODES.OFF,alphaMode:_ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,resolution:_getResolutionOfUrl(e)},t.data);l=s.map(function(t){var _t$resource;s===o&&Object.assign(u,{type:t.type,format:t.format});var n=(_t$resource=t.resource)!==null&&_t$resource!==void 0?_t$resource:t,i=new _BaseTexture2(n,u);return i.ktxKeyValueData=a,_createTexture(i,r,e);});return _context125.abrupt("return",1===l.length?l[0]:l);case 13:case"end":return _context125.stop();}},_callee121);}))();},unload:function unload(e){Array.isArray(e)?e.forEach(function(e){return e.destroy(!0);}):e.destroy(!0);}};_extensions.add(_loadKTX);var knownFormats=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],_resolveCompressedTextureUrl={extension:_ExtensionType.ResolveParser,test:function test(e){var t=_path.extname(e).slice(1);return["basis","ktx","dds"].includes(t);},parse:function parse(e){var _settings$RETINA_PREF6,_settings$RETINA_PREF7;var t=e.split("."),r=t.pop();if(["ktx","dds"].includes(r)){var _settings$RETINA_PREF4,_settings$RETINA_PREF5;var _r228=t.pop();if(knownFormats.includes(_r228))return{resolution:parseFloat((_settings$RETINA_PREF4=(_settings$RETINA_PREF5=_settings.RETINA_PREFIX.exec(e))===null||_settings$RETINA_PREF5===void 0?void 0:_settings$RETINA_PREF5[1])!==null&&_settings$RETINA_PREF4!==void 0?_settings$RETINA_PREF4:"1"),format:_r228,src:e};}return{resolution:parseFloat((_settings$RETINA_PREF6=(_settings$RETINA_PREF7=_settings.RETINA_PREFIX.exec(e))===null||_settings$RETINA_PREF7===void 0?void 0:_settings$RETINA_PREF7[1])!==null&&_settings$RETINA_PREF6!==void 0?_settings$RETINA_PREF6:"1"),format:r,src:e};}};_extensions.add(_resolveCompressedTextureUrl);var TEMP_RECT=new _Rectangle(),BYTES_PER_PIXEL=4,_Extract=/*#__PURE__*/function(){function e(_e505){_classCallCheck2(this,e);this.renderer=_e505,this._rendererPremultipliedAlpha=!1;}return _createClass2(e,[{key:"contextChange",value:function contextChange(){var _this$renderer10;var _e506=(_this$renderer10=this.renderer)===null||_this$renderer10===void 0?void 0:_this$renderer10.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(_e506&&_e506.alpha&&_e506.premultipliedAlpha);}},{key:"image",value:function(){var _image=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee122(_e507,t,r,n){var i;return _regeneratorRuntime2().wrap(function _callee122$(_context126){while(1)switch(_context126.prev=_context126.next){case 0:i=new Image();_context126.next=3;return this.base64(_e507,t,r,n);case 3:i.src=_context126.sent;return _context126.abrupt("return",i);case 5:case"end":return _context126.stop();}},_callee122,this);}));function image(_x137,_x138,_x139,_x140){return _image.apply(this,arguments);}return image;}()},{key:"base64",value:function(){var _base=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee123(_e508,t,r,n){var i,_e510;return _regeneratorRuntime2().wrap(function _callee123$(_context127){while(1)switch(_context127.prev=_context127.next){case 0:i=this.canvas(_e508,n);if(!(void 0!==i.toBlob)){_context127.next=3;break;}return _context127.abrupt("return",new Promise(function(_e509,n){i.toBlob(function(t){if(!t)return void n(new Error("ICanvas.toBlob failed!"));var r=new FileReader();r.onload=function(){return _e509(r.result);},r.onerror=n,r.readAsDataURL(t);},t,r);}));case 3:if(!(void 0!==i.toDataURL)){_context127.next=5;break;}return _context127.abrupt("return",i.toDataURL(t,r));case 5:if(!(void 0!==i.convertToBlob)){_context127.next=10;break;}_context127.next=8;return i.convertToBlob({type:t,quality:r});case 8:_e510=_context127.sent;return _context127.abrupt("return",new Promise(function(t,r){var n=new FileReader();n.onload=function(){return t(n.result);},n.onerror=r,n.readAsDataURL(_e510);}));case 10:throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented");case 11:case"end":return _context127.stop();}},_callee123,this);}));function base64(_x141,_x142,_x143,_x144){return _base.apply(this,arguments);}return base64;}()},{key:"canvas",value:function canvas(t,r){var _this$_rawPixels=this._rawPixels(t,r),n=_this$_rawPixels.pixels,i=_this$_rawPixels.width,o=_this$_rawPixels.height,a=_this$_rawPixels.flipY,s=_this$_rawPixels.premultipliedAlpha;a&&e._flipY(n,i,o),s&&e._unpremultiplyAlpha(n);var u=new _CanvasRenderTarget(i,o,1),l=new ImageData(new Uint8ClampedArray(n.buffer),i,o);return u.context.putImageData(l,0,0),u.canvas;}},{key:"pixels",value:function pixels(t,r){var _this$_rawPixels2=this._rawPixels(t,r),n=_this$_rawPixels2.pixels,i=_this$_rawPixels2.width,o=_this$_rawPixels2.height,a=_this$_rawPixels2.flipY,s=_this$_rawPixels2.premultipliedAlpha;return a&&e._flipY(n,i,o),s&&e._unpremultiplyAlpha(n),n;}},{key:"_rawPixels",value:function _rawPixels(_e511,t){var _i110;var r=this.renderer;if(!r)throw new Error("The Extract has already been destroyed");var n,i,o=!1,a=!1,s=!1;_e511&&(_e511 instanceof _RenderTexture?i=_e511:(i=r.generateTexture(_e511,{region:t,resolution:r.resolution,multisample:r.multisample}),s=!0,t&&(TEMP_RECT.width=t.width,TEMP_RECT.height=t.height,t=TEMP_RECT)));var u=r.gl;if(i){var _t251;if(n=i.baseTexture.resolution,t=(_t251=t)!==null&&_t251!==void 0?_t251:i.frame,o=!1,a=i.baseTexture.alphaMode>0&&i.baseTexture.format===_FORMATS.RGBA,!s){r.renderTexture.bind(i);var _e512=i.framebuffer.glFramebuffers[r.CONTEXT_UID];_e512.blitFramebuffer&&r.framebuffer.bind(_e512.blitFramebuffer);}}else n=r.resolution,t||((t=TEMP_RECT).width=r.width/n,t.height=r.height/n),o=!0,a=this._rendererPremultipliedAlpha,r.renderTexture.bind();var l=Math.max(Math.round(t.width*n),1),c=Math.max(Math.round(t.height*n),1),h=new Uint8Array(BYTES_PER_PIXEL*l*c);return u.readPixels(Math.round(t.x*n),Math.round(t.y*n),l,c,u.RGBA,u.UNSIGNED_BYTE,h),s&&(_i110=i)!==null&&_i110!==void 0&&_i110.destroy(!0),{pixels:h,width:l,height:c,flipY:o,premultipliedAlpha:a};}},{key:"destroy",value:function destroy(){this.renderer=null;}}],[{key:"_flipY",value:function _flipY(_e513,t,r){var n=t<<2,i=r>>1,o=new Uint8Array(n);for(var _t252=0;_t252<i;_t252++){var _i111=_t252*n,_a57=(r-_t252-1)*n;o.set(_e513.subarray(_i111,_i111+n)),_e513.copyWithin(_i111,_a57,_a57+n),_e513.set(o,_a57);}}},{key:"_unpremultiplyAlpha",value:function _unpremultiplyAlpha(_e514){_e514 instanceof Uint8ClampedArray&&(_e514=new Uint8Array(_e514.buffer));var t=_e514.length;for(var r=0;r<t;r+=4){var _t253=_e514[r+3];if(0!==_t253){var n=255.001/_t253;_e514[r]=_e514[r]*n+.5,_e514[r+1]=_e514[r+1]*n+.5,_e514[r+2]=_e514[r+2]*n+.5;}}}}]);}();_Extract.extension={name:"extract",type:_ExtensionType.RendererSystem};var _Extract2=_Extract;_extensions.add(_Extract2);var buildCircle={build:function build(e){var t=e.points;var r,n,i,o,a,s;if(e.type===_SHAPES.CIRC){var _t254=e.shape;r=_t254.x,n=_t254.y,a=s=_t254.radius,i=o=0;}else if(e.type===_SHAPES.ELIP){var _t255=e.shape;r=_t255.x,n=_t255.y,a=_t255.width,s=_t255.height,i=o=0;}else{var _t256=e.shape,_u33=_t256.width/2,_l21=_t256.height/2;r=_t256.x+_u33,n=_t256.y+_l21,a=s=Math.max(0,Math.min(_t256.radius,Math.min(_u33,_l21))),i=_u33-a,o=_l21-s;}if(!(a>=0&&s>=0&&i>=0&&o>=0))return void(t.length=0);var u=Math.ceil(2.3*Math.sqrt(a+s)),l=8*u+(i?4:0)+(o?4:0);if(t.length=l,0===l)return;if(0===u)return t.length=8,t[0]=t[6]=r+i,t[1]=t[3]=n+o,t[2]=t[4]=r-i,void(t[5]=t[7]=n-o);var c=0,h=4*u+(i?2:0)+2,f=h,d=l;{var _e515=i+a,_s46=o,_u34=r+_e515,_l22=r-_e515,_p10=n+_s46;if(t[c++]=_u34,t[c++]=_p10,t[--h]=_p10,t[--h]=_l22,o){var _e516=n-_s46;t[f++]=_l22,t[f++]=_e516,t[--d]=_e516,t[--d]=_u34;}}for(var _e517=1;_e517<u;_e517++){var _l23=Math.PI/2*(_e517/u),_p11=i+Math.cos(_l23)*a,_y6=o+Math.sin(_l23)*s,_m6=r+_p11,_g4=r-_p11,_w2=n+_y6,_b4=n-_y6;t[c++]=_m6,t[c++]=_w2,t[--h]=_w2,t[--h]=_g4,t[f++]=_g4,t[f++]=_b4,t[--d]=_b4,t[--d]=_m6;}{var _e518=o+s,_a58=r+i,_u35=r-i,_l24=n+_e518,_h14=n-_e518;t[c++]=_a58,t[c++]=_l24,t[--d]=_h14,t[--d]=_a58,i&&(t[c++]=_u35,t[c++]=_l24,t[--d]=_h14,t[--d]=_u35);}},triangulate:function triangulate(e,t){var r=e.points,n=t.points,i=t.indices;if(0===r.length)return;var o=n.length/2;var a=o;var s,u;if(e.type!==_SHAPES.RREC){var _t257=e.shape;s=_t257.x,u=_t257.y;}else{var _t258=e.shape;s=_t258.x+_t258.width/2,u=_t258.y+_t258.height/2;}var l=e.matrix;n.push(e.matrix?l.a*s+l.c*u+l.tx:s,e.matrix?l.b*s+l.d*u+l.ty:u),o++,n.push(r[0],r[1]);for(var _e519=2;_e519<r.length;_e519+=2)n.push(r[_e519],r[_e519+1]),i.push(o++,a,o);i.push(a+1,a,o);}};function fixOrientation(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var r=e.length;if(r<6)return;var n=0;for(var _t259=0,i=e[r-2],_o76=e[r-1];_t259<r;_t259+=2){var _r229=e[_t259],_a59=e[_t259+1];n+=(_r229-i)*(_a59+_o76),i=_r229,_o76=_a59;}if(!t&&n>0||t&&n<=0){var _t260=r/2;for(var _n155=_t260+_t260%2;_n155<r;_n155+=2){var _ref57,_ref58;var _t261=r-_n155-2,_i112=r-_n155-1,_o77=_n155,_a60=_n155+1;_ref57=[e[_o77],e[_t261]],e[_t261]=_ref57[0],e[_o77]=_ref57[1],_ref58=[e[_a60],e[_i112]],e[_i112]=_ref58[0],e[_a60]=_ref58[1];}}}var buildPoly={build:function build(e){e.points=e.shape.points.slice();},triangulate:function triangulate(e,t){var r=e.points;var n=e.holes,i=t.points,o=t.indices;if(r.length>=6){fixOrientation(r,!1);var _e520=[];for(var _t262=0;_t262<n.length;_t262++){var _i113=n[_t262];fixOrientation(_i113.points,!0),_e520.push(r.length/2),r=r.concat(_i113.points);}var _t263=_earcut(r,_e520,2);if(!_t263)return;var _a61=i.length/2;for(var _e521=0;_e521<_t263.length;_e521+=3)o.push(_t263[_e521]+_a61),o.push(_t263[_e521+1]+_a61),o.push(_t263[_e521+2]+_a61);for(var _e522=0;_e522<r.length;_e522++)i.push(r[_e522]);}}},buildRectangle={build:function build(e){var t=e.shape,r=t.x,n=t.y,i=t.width,o=t.height,a=e.points;a.length=0,i>=0&&o>=0&&a.push(r,n,r+i,n,r+i,n+o,r,n+o);},triangulate:function triangulate(e,t){var r=e.points,n=t.points;if(0===r.length)return;var i=n.length/2;n.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),t.indices.push(i,i+1,i+2,i+1,i+2,i+3);}},buildRoundedRectangle={build:function build(e){buildCircle.build(e);},triangulate:function triangulate(e,t){buildCircle.triangulate(e,t);}};var _LINE_JOIN=function(e){return e.MITER="miter",e.BEVEL="bevel",e.ROUND="round",e;}(_LINE_JOIN||{}),_LINE_CAP=function(e){return e.BUTT="butt",e.ROUND="round",e.SQUARE="square",e;}(_LINE_CAP||{});var _curves={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function _segmentsCount(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:20;if(!this.adaptive||!e||isNaN(e))return t;var r=Math.ceil(e/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r;}},_GRAPHICS_CURVES=_curves;var ArcUtils=/*#__PURE__*/function(){function ArcUtils(){_classCallCheck2(this,ArcUtils);}return _createClass2(ArcUtils,null,[{key:"curveTo",value:function curveTo(e,t,r,n,i,o){var a=o[o.length-2],s=o[o.length-1]-t,u=a-e,l=n-t,c=r-e,h=Math.abs(s*c-u*l);if(h<1e-8||0===i)return(o[o.length-2]!==e||o[o.length-1]!==t)&&o.push(e,t),null;var f=s*s+u*u,d=l*l+c*c,p=s*l+u*c,y=i*Math.sqrt(f)/h,m=i*Math.sqrt(d)/h,g=y*p/f,w=m*p/d,b=y*c+m*u,v=y*l+m*s,x=u*(m+g),_=s*(m+g),S=c*(y+w),T=l*(y+w);return{cx:b+e,cy:v+t,radius:i,startAngle:Math.atan2(_-v,x-b),endAngle:Math.atan2(T-v,S-b),anticlockwise:u*l>c*s};}},{key:"arc",value:function arc(e,t,r,n,i,o,a,s,u){var l=a-o,c=_curves._segmentsCount(Math.abs(l)*i,40*Math.ceil(Math.abs(l)/_PI_)),h=l/(2*c),f=2*h,d=Math.cos(h),p=Math.sin(h),y=c-1,m=y%1/y;for(var _e523=0;_e523<=y;++_e523){var _t264=h+o+f*(_e523+m*_e523),_a62=Math.cos(_t264),_s47=-Math.sin(_t264);u.push((d*_a62+p*_s47)*i+r,(d*-_s47+p*_a62)*i+n);}}}]);}();var BezierUtils=/*#__PURE__*/function(){function BezierUtils(){_classCallCheck2(this,BezierUtils);}return _createClass2(BezierUtils,null,[{key:"curveLength",value:function curveLength(e,t,r,n,i,o,a,s){var u=0,l=0,c=0,h=0,f=0,d=0,p=0,y=0,m=0,g=0,w=0,b=e,v=t;for(var _x145=1;_x145<=10;++_x145)l=_x145/10,c=l*l,h=c*l,f=1-l,d=f*f,p=d*f,y=p*e+3*d*l*r+3*f*c*i+h*a,m=p*t+3*d*l*n+3*f*c*o+h*s,g=b-y,w=v-m,b=y,v=m,u+=Math.sqrt(g*g+w*w);return u;}},{key:"curveTo",value:function curveTo(e,t,r,n,i,o,a){var s=a[a.length-2],u=a[a.length-1];a.length-=2;var l=_curves._segmentsCount(BezierUtils.curveLength(s,u,e,t,r,n,i,o));var c=0,h=0,f=0,d=0,p=0;a.push(s,u);for(var _y7=1,_m7=0;_y7<=l;++_y7)_m7=_y7/l,c=1-_m7,h=c*c,f=h*c,d=_m7*_m7,p=d*_m7,a.push(f*s+3*h*_m7*e+3*c*d*r+p*i,f*u+3*h*_m7*t+3*c*d*n+p*o);}}]);}();function square(e,t,r,n,i,o,a,s){var u,l;a?(u=n,l=-r):(u=-n,l=r);var c=e-r*i+u,h=t-n*i+l,f=e+r*o+u,d=t+n*o+l;return s.push(c,h,f,d),2;}function round(e,t,r,n,i,o,a,s){var u=r-e,l=n-t;var c=Math.atan2(u,l),h=Math.atan2(i-e,o-t);s&&c<h?c+=2*Math.PI:!s&&c>h&&(h+=2*Math.PI);var f=c;var d=h-c,p=Math.abs(d),y=Math.sqrt(u*u+l*l),m=1+(15*p*Math.sqrt(y)/Math.PI|0),g=d/m;if(f+=g,s){a.push(e,t,r,n);for(var _r230=1,_n156=f;_r230<m;_r230++,_n156+=g)a.push(e,t,e+Math.sin(_n156)*y,t+Math.cos(_n156)*y);a.push(e,t,i,o);}else{a.push(r,n,e,t);for(var _r231=1,_n157=f;_r231<m;_r231++,_n157+=g)a.push(e+Math.sin(_n157)*y,t+Math.cos(_n157)*y,e,t);a.push(i,o,e,t);}return 2*m;}function buildNonNativeLine(e,t){var r=e.shape;var n=e.points||r.points.slice();var i=t.closePointEps;if(0===n.length)return;var o=e.lineStyle,a=new _Point(n[0],n[1]),s=new _Point(n[n.length-2],n[n.length-1]),u=r.type!==_SHAPES.POLY||r.closeStroke,l=Math.abs(a.x-s.x)<i&&Math.abs(a.y-s.y)<i;if(u){n=n.slice(),l&&(n.pop(),n.pop(),s.set(n[n.length-2],n[n.length-1]));var _e524=.5*(a.x+s.x),_t265=.5*(s.y+a.y);n.unshift(_e524,_t265),n.push(_e524,_t265);}var c=t.points,h=n.length/2;var f=n.length;var d=c.length/2,p=o.width/2,y=p*p,m=o.miterLimit*o.miterLimit;var g=n[0],w=n[1],b=n[2],v=n[3],x=0,_=0,S=-(w-v),T=g-b,I=0,E=0,A=Math.sqrt(S*S+T*T);S/=A,T/=A,S*=p,T*=p;var C=o.alignment,O=2*(1-C),P=2*C;u||(o.cap===_LINE_CAP.ROUND?f+=round(g-S*(O-P)*.5,w-T*(O-P)*.5,g-S*O,w-T*O,g+S*P,w+T*P,c,!0)+2:o.cap===_LINE_CAP.SQUARE&&(f+=square(g,w,S,T,O,P,!0,c))),c.push(g-S*O,w-T*O,g+S*P,w+T*P);for(var _e525=1;_e525<h-1;++_e525){g=n[2*(_e525-1)],w=n[2*(_e525-1)+1],b=n[2*_e525],v=n[2*_e525+1],x=n[2*(_e525+1)],_=n[2*(_e525+1)+1],S=-(w-v),T=g-b,A=Math.sqrt(S*S+T*T),S/=A,T/=A,S*=p,T*=p,I=-(v-_),E=b-x,A=Math.sqrt(I*I+E*E),I/=A,E/=A,I*=p,E*=p;var _t266=b-g,_r232=w-v,_i114=b-x,_a63=_-v,_s48=_t266*_i114+_r232*_a63,_u36=_r232*_i114-_a63*_t266,_l25=_u36<0;if(Math.abs(_u36)<.001*Math.abs(_s48)){c.push(b-S*O,v-T*O,b+S*P,v+T*P),_s48>=0&&(o.join===_LINE_JOIN.ROUND?f+=round(b,v,b-S*O,v-T*O,b-I*O,v-E*O,c,!1)+4:f+=2,c.push(b-I*P,v-E*P,b+I*O,v+E*O));continue;}var _h15=(-S+g)*(-T+v)-(-S+b)*(-T+w),_d12=(-I+x)*(-E+v)-(-I+b)*(-E+_),_C=(_t266*_d12-_i114*_h15)/_u36,_k=(_a63*_h15-_r232*_d12)/_u36,_R=(_C-b)*(_C-b)+(_k-v)*(_k-v),B=b+(_C-b)*O,_$=v+(_k-v)*O,D=b-(_C-b)*P,_M=v-(_k-v)*P,L=_l25?O:P,_F=_R<=Math.min(_t266*_t266+_r232*_r232,_i114*_i114+_a63*_a63)+L*L*y;var _N=o.join;if(_N===_LINE_JOIN.MITER&&_R/y>m&&(_N=_LINE_JOIN.BEVEL),_F)switch(_N){case _LINE_JOIN.MITER:c.push(B,_$,D,_M);break;case _LINE_JOIN.BEVEL:_l25?c.push(B,_$,b+S*P,v+T*P,B,_$,b+I*P,v+E*P):c.push(b-S*O,v-T*O,D,_M,b-I*O,v-E*O,D,_M),f+=2;break;case _LINE_JOIN.ROUND:_l25?(c.push(B,_$,b+S*P,v+T*P),f+=round(b,v,b+S*P,v+T*P,b+I*P,v+E*P,c,!0)+4,c.push(B,_$,b+I*P,v+E*P)):(c.push(b-S*O,v-T*O,D,_M),f+=round(b,v,b-S*O,v-T*O,b-I*O,v-E*O,c,!1)+4,c.push(b-I*O,v-E*O,D,_M));}else{switch(c.push(b-S*O,v-T*O,b+S*P,v+T*P),_N){case _LINE_JOIN.MITER:_l25?c.push(D,_M,D,_M):c.push(B,_$,B,_$),f+=2;break;case _LINE_JOIN.ROUND:f+=_l25?round(b,v,b+S*P,v+T*P,b+I*P,v+E*P,c,!0)+2:round(b,v,b-S*O,v-T*O,b-I*O,v-E*O,c,!1)+2;}c.push(b-I*O,v-E*O,b+I*P,v+E*P),f+=2;}}g=n[2*(h-2)],w=n[2*(h-2)+1],b=n[2*(h-1)],v=n[2*(h-1)+1],S=-(w-v),T=g-b,A=Math.sqrt(S*S+T*T),S/=A,T/=A,S*=p,T*=p,c.push(b-S*O,v-T*O,b+S*P,v+T*P),u||(o.cap===_LINE_CAP.ROUND?f+=round(b-S*(O-P)*.5,v-T*(O-P)*.5,b-S*O,v-T*O,b+S*P,v+T*P,c,!1)+2:o.cap===_LINE_CAP.SQUARE&&(f+=square(b,v,S,T,O,P,!1,c)));var k=t.indices,R=_curves.epsilon*_curves.epsilon;for(var _e526=d;_e526<f+d-2;++_e526)g=c[2*_e526],w=c[2*_e526+1],b=c[2*(_e526+1)],v=c[2*(_e526+1)+1],x=c[2*(_e526+2)],_=c[2*(_e526+2)+1],!(Math.abs(g*(v-_)+b*(_-w)+x*(w-v))<R)&&k.push(_e526,_e526+1,_e526+2);}function buildNativeLine(e,t){var r=0;var n=e.shape,i=e.points||n.points,o=n.type!==_SHAPES.POLY||n.closeStroke;if(0===i.length)return;var a=t.points,s=t.indices,u=i.length/2,l=a.length/2;var c=l;for(a.push(i[0],i[1]),r=1;r<u;r++)a.push(i[2*r],i[2*r+1]),s.push(c,c+1),c++;o&&s.push(c,l);}function buildLine(e,t){e.lineStyle["native"]?buildNativeLine(e,t):buildNonNativeLine(e,t);}var QuadraticUtils=/*#__PURE__*/function(){function QuadraticUtils(){_classCallCheck2(this,QuadraticUtils);}return _createClass2(QuadraticUtils,null,[{key:"curveLength",value:function curveLength(e,t,r,n,i,o){var a=e-2*r+i,s=t-2*n+o,u=2*r-2*e,l=2*n-2*t,c=4*(a*a+s*s),h=4*(a*u+s*l),f=u*u+l*l,d=2*Math.sqrt(c+h+f),p=Math.sqrt(c),y=2*c*p,m=2*Math.sqrt(f),g=h/p;return(y*d+p*h*(d-m)+(4*f*c-h*h)*Math.log((2*p+g+d)/(g+m)))/(4*y);}},{key:"curveTo",value:function curveTo(e,t,r,n,i){var o=i[i.length-2],a=i[i.length-1],s=_curves._segmentsCount(QuadraticUtils.curveLength(o,a,e,t,r,n));var u=0,l=0;for(var _c21=1;_c21<=s;++_c21){var _h16=_c21/s;u=o+(e-o)*_h16,l=a+(t-a)*_h16,i.push(u+(e+(r-e)*_h16-u)*_h16,l+(t+(n-t)*_h16-l)*_h16);}}}]);}();var FILL_COMMANDS=_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},_SHAPES.POLY,buildPoly),_SHAPES.CIRC,buildCircle),_SHAPES.ELIP,buildCircle),_SHAPES.RECT,buildRectangle),_SHAPES.RREC,buildRoundedRectangle),BATCH_POOL=[],DRAW_CALL_POOL=[];var _GraphicsData=/*#__PURE__*/function(){function _GraphicsData(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;_classCallCheck2(this,_GraphicsData);this.points=[],this.holes=[],this.shape=e,this.lineStyle=r,this.fillStyle=t,this.matrix=n,this.type=e.type;}return _createClass2(_GraphicsData,[{key:"clone",value:function clone(){return new _GraphicsData(this.shape,this.fillStyle,this.lineStyle,this.matrix);}},{key:"destroy",value:function destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null;}}]);}();var BatchPart=/*#__PURE__*/function(){function BatchPart(){_classCallCheck2(this,BatchPart);this.reset();}return _createClass2(BatchPart,[{key:"begin",value:function begin(e,t,r){this.reset(),this.style=e,this.start=t,this.attribStart=r;}},{key:"end",value:function end(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start;}},{key:"reset",value:function reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0;}}]);}();var tmpPoint=new _Point(),_GraphicsGeometry=/*#__PURE__*/function(_BatchGeometry2){function e(){var _this116;_classCallCheck2(this,e);_this116=_callSuper2(this,e),_this116.closePointEps=1e-4,_this116.boundsPadding=0,_this116.uvsFloat32=null,_this116.indicesUint16=null,_this116.batchable=!1,_this116.points=[],_this116.colors=[],_this116.uvs=[],_this116.indices=[],_this116.textureIds=[],_this116.graphicsData=[],_this116.drawCalls=[],_this116.batchDirty=-1,_this116.batches=[],_this116.dirty=0,_this116.cacheDirty=-1,_this116.clearDirty=0,_this116.shapeIndex=0,_this116._bounds=new _Bounds(),_this116.boundsDirty=-1;return _this116;}_inherits2(e,_BatchGeometry2);return _createClass2(e,[{key:"bounds",get:function get(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds;}},{key:"invalidate",value:function invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var _e553=0;_e553<this.drawCalls.length;_e553++)this.drawCalls[_e553].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[_e553]);this.drawCalls.length=0;for(var _e554=0;_e554<this.batches.length;_e554++){var _t267=this.batches[_e554];_t267.reset(),BATCH_POOL.push(_t267);}this.batches.length=0;}},{key:"clear",value:function clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this;}},{key:"drawShape",value:function drawShape(_e529){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;var i=new _GraphicsData(_e529,t,r,n);return this.graphicsData.push(i),this.dirty++,this;}},{key:"drawHole",value:function drawHole(_e530){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!this.graphicsData.length)return null;var r=new _GraphicsData(_e530,null,null,t),n=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=n.lineStyle,n.holes.push(r),this.dirty++,this;}},{key:"destroy",value:function destroy(){_superPropGet2(e,"destroy",this,3)([]);for(var _e555=0;_e555<this.graphicsData.length;++_e555)this.graphicsData[_e555].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null;}},{key:"containsPoint",value:function containsPoint(_e532){var t=this.graphicsData;for(var r=0;r<t.length;++r){var n=t[r];if(n.fillStyle.visible&&n.shape&&(n.matrix?n.matrix.applyInverse(_e532,tmpPoint):tmpPoint.copyFrom(_e532),n.shape.contains(tmpPoint.x,tmpPoint.y))){var _e533=!1;if(n.holes)for(var _t268=0;_t268<n.holes.length;_t268++)if(n.holes[_t268].shape.contains(tmpPoint.x,tmpPoint.y)){_e533=!0;break;}if(!_e533)return!0;}}return!1;}},{key:"updateBatches",value:function updateBatches(){if(!this.graphicsData.length)return void(this.batchable=!0);if(!this.validateBatching())return;this.cacheDirty=this.dirty;var _e534=this.uvs,t=this.graphicsData;var r=null,n=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],n=r.style);for(var _i115=this.shapeIndex;_i115<t.length;_i115++){this.shapeIndex++;var _o78=t[_i115],_a64=_o78.fillStyle,_s49=_o78.lineStyle;FILL_COMMANDS[_o78.type].build(_o78),_o78.matrix&&this.transformPoints(_o78.points,_o78.matrix),(_a64.visible||_s49.visible)&&this.processHoles(_o78.holes);for(var _t269=0;_t269<2;_t269++){var _i116=0===_t269?_a64:_s49;if(!_i116.visible)continue;var _u37=_i116.texture.baseTexture,_l26=this.indices.length,_c22=this.points.length/2;_u37.wrapMode=_WRAP_MODES.REPEAT,0===_t269?this.processFill(_o78):this.processLine(_o78);var _h17=this.points.length/2-_c22;0!==_h17&&(r&&!this._compareStyles(n,_i116)&&(r.end(_l26,_c22),r=null),r||(r=BATCH_POOL.pop()||new BatchPart(),r.begin(_i116,_l26,_c22),this.batches.push(r),n=_i116),this.addUvs(this.points,_e534,_i116.texture,_c22,_h17,_i116.matrix));}}var i=this.indices.length,o=this.points.length/2;if(r&&r.end(i,o),0===this.batches.length)return void(this.batchable=!0);var a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls();}},{key:"_compareStyles",value:function _compareStyles(_e535,t){return!(!_e535||!t||_e535.texture.baseTexture!==t.texture.baseTexture||_e535.color+_e535.alpha!==t.color+t.alpha||!!_e535["native"]!=!!t["native"]);}},{key:"validateBatching",value:function validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var _e556=0,_t270=this.graphicsData.length;_e556<_t270;_e556++){var _t271=this.graphicsData[_e556],r=_t271.fillStyle,n=_t271.lineStyle;if(r&&!r.texture.baseTexture.valid||n&&!n.texture.baseTexture.valid)return!1;}return!0;}},{key:"packBatches",value:function packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);var _e537=this.batches;for(var _t272=0,r=_e537.length;_t272<r;_t272++){var _r233=_e537[_t272];for(var _e557=0;_e557<_r233.size;_e557++){var _t273=_r233.start+_e557;this.indicesUint16[_t273]=this.indicesUint16[_t273]-_r233.attribStart;}}}},{key:"isBatchable",value:function isBatchable(){if(this.points.length>131070)return!1;var t=this.batches;for(var _e558=0;_e558<t.length;_e558++)if(t[_e558].style["native"])return!1;return this.points.length<2*e.BATCHABLE_SIZE;}},{key:"buildDrawCalls",value:function buildDrawCalls(){var _e540=++_BaseTexture2._globalBatch;for(var _e559=0;_e559<this.drawCalls.length;_e559++)this.drawCalls[_e559].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[_e559]);this.drawCalls.length=0;var t=this.colors,r=this.textureIds;var n=DRAW_CALL_POOL.pop();n||(n=new _BatchDrawCall(),n.texArray=new _BatchTextureArray()),n.texArray.count=0,n.start=0,n.size=0,n.type=_DRAW_MODES.TRIANGLES;var i=0,o=null,a=0,s=!1,u=_DRAW_MODES.TRIANGLES,l=0;this.drawCalls.push(n);for(var _c23=0;_c23<this.batches.length;_c23++){var _h18=this.batches[_c23],_f12=8,_d13=_h18.style,_p12=_d13.texture.baseTexture;s!==!!_d13["native"]&&(s=!!_d13["native"],u=s?_DRAW_MODES.LINES:_DRAW_MODES.TRIANGLES,o=null,i=_f12,_e540++),o!==_p12&&(o=_p12,_p12._batchEnabled!==_e540&&(i===_f12&&(_e540++,i=0,n.size>0&&(n=DRAW_CALL_POOL.pop(),n||(n=new _BatchDrawCall(),n.texArray=new _BatchTextureArray()),this.drawCalls.push(n)),n.start=l,n.size=0,n.texArray.count=0,n.type=u),_p12.touched=1,_p12._batchEnabled=_e540,_p12._batchLocation=i,_p12.wrapMode=_WRAP_MODES.REPEAT,n.texArray.elements[n.texArray.count++]=_p12,i++)),n.size+=_h18.size,l+=_h18.size,a=_p12._batchLocation,this.addColors(t,_d13.color,_d13.alpha,_h18.attribSize,_h18.attribStart),this.addTextureIds(r,a,_h18.attribSize,_h18.attribStart);}_BaseTexture2._globalBatch=_e540,this.packAttributes();}},{key:"packAttributes",value:function packAttributes(){var _e542=this.points,t=this.uvs,r=this.colors,n=this.textureIds,i=new ArrayBuffer(3*_e542.length*4),o=new Float32Array(i),a=new Uint32Array(i);var s=0;for(var _i117=0;_i117<_e542.length/2;_i117++)o[s++]=_e542[2*_i117],o[s++]=_e542[2*_i117+1],o[s++]=t[2*_i117],o[s++]=t[2*_i117+1],a[s++]=r[_i117],o[s++]=n[_i117];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16);}},{key:"processFill",value:function processFill(_e543){_e543.holes.length?buildPoly.triangulate(_e543,this):FILL_COMMANDS[_e543.type].triangulate(_e543,this);}},{key:"processLine",value:function processLine(_e544){buildLine(_e544,this);for(var _t274=0;_t274<_e544.holes.length;_t274++)buildLine(_e544.holes[_t274],this);}},{key:"processHoles",value:function processHoles(_e545){for(var _t275=0;_t275<_e545.length;_t275++){var r=_e545[_t275];FILL_COMMANDS[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix);}}},{key:"calculateBounds",value:function calculateBounds(){var _e546=this._bounds;_e546.clear(),_e546.addVertexData(this.points,0,this.points.length),_e546.pad(this.boundsPadding,this.boundsPadding);}},{key:"transformPoints",value:function transformPoints(_e547,t){for(var r=0;r<_e547.length/2;r++){var n=_e547[2*r],i=_e547[2*r+1];_e547[2*r]=t.a*n+t.c*i+t.tx,_e547[2*r+1]=t.b*n+t.d*i+t.ty;}}},{key:"addColors",value:function addColors(_e548,t,r,n){var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;var o=_Color2.shared.setValue(t).toLittleEndianNumber(),a=_Color2.shared.setValue(o).toPremultiplied(r);_e548.length=Math.max(_e548.length,i+n);for(var _t276=0;_t276<n;_t276++)_e548[i+_t276]=a;}},{key:"addTextureIds",value:function addTextureIds(_e549,t,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;_e549.length=Math.max(_e549.length,n+r);for(var i=0;i<r;i++)_e549[n+i]=t;}},{key:"addUvs",value:function addUvs(_e550,t,r,n,i){var o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:null;var a=0;var s=t.length,u=r.frame;for(;a<i;){var _r234=_e550[2*(n+a)],_i118=_e550[2*(n+a)+1];if(o){var _e551=o.a*_r234+o.c*_i118+o.tx;_i118=o.b*_r234+o.d*_i118+o.ty,_r234=_e551;}a++,t.push(_r234/u.width,_i118/u.height);}var l=r.baseTexture;(u.width<l.width||u.height<l.height)&&this.adjustUvs(t,r,s,i);}},{key:"adjustUvs",value:function adjustUvs(_e552,t,r,n){var i=t.baseTexture,o=1e-6,a=r+2*n,s=t.frame,u=s.width/i.width,l=s.height/i.height;var c=s.x/s.width,h=s.y/s.height,f=Math.floor(_e552[r]+o),d=Math.floor(_e552[r+1]+o);for(var _t277=r+2;_t277<a;_t277+=2)f=Math.min(f,Math.floor(_e552[_t277]+o)),d=Math.min(d,Math.floor(_e552[_t277+1]+o));c-=f,h-=d;for(var _t278=r;_t278<a;_t278+=2)_e552[_t278]=(_e552[_t278]+c)*u,_e552[_t278+1]=(_e552[_t278+1]+h)*l;}}]);}(_BatchGeometry);_GraphicsGeometry.BATCHABLE_SIZE=100;var _GraphicsGeometry2=_GraphicsGeometry;var _FillStyle=/*#__PURE__*/function(){function _FillStyle(){_classCallCheck2(this,_FillStyle);this.color=16777215,this.alpha=1,this.texture=Texture_Texture.WHITE,this.matrix=null,this.visible=!1,this.reset();}return _createClass2(_FillStyle,[{key:"clone",value:function clone(){var e=new _FillStyle();return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e;}},{key:"reset",value:function reset(){this.color=16777215,this.alpha=1,this.texture=Texture_Texture.WHITE,this.matrix=null,this.visible=!1;}},{key:"destroy",value:function destroy(){this.texture=null,this.matrix=null;}}]);}();var _LineStyle=/*#__PURE__*/function(_FillStyle2){function _LineStyle(){var _this117;_classCallCheck2(this,_LineStyle);_this117=_callSuper2(this,_LineStyle,arguments),_this117.width=0,_this117.alignment=.5,_this117["native"]=!1,_this117.cap=_LINE_CAP.BUTT,_this117.join=_LINE_JOIN.MITER,_this117.miterLimit=10;return _this117;}_inherits2(_LineStyle,_FillStyle2);return _createClass2(_LineStyle,[{key:"clone",value:function clone(){var e=new _LineStyle();return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e["native"]=this["native"],e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e;}},{key:"reset",value:function reset(){_superPropGet2(_LineStyle,"reset",this,3)([]),this.color=0,this.alignment=.5,this.width=0,this["native"]=!1,this.cap=_LINE_CAP.BUTT,this.join=_LINE_JOIN.MITER,this.miterLimit=10;}}]);}(_FillStyle);var DEFAULT_SHADERS={},_Graphics=/*#__PURE__*/function(_Container4){function e(){var _this118;var _e560=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;_classCallCheck2(this,e);_this118=_callSuper2(this,e),_this118.shader=null,_this118.pluginName="batch",_this118.currentPath=null,_this118.batches=[],_this118.batchTint=-1,_this118.batchDirty=-1,_this118.vertexData=null,_this118._fillStyle=new _FillStyle(),_this118._lineStyle=new _LineStyle(),_this118._matrix=null,_this118._holeMode=!1,_this118.state=_State.for2d(),_this118._geometry=_e560||new _GraphicsGeometry2(),_this118._geometry.refCount++,_this118._transformID=-1,_this118._tintColor=new _Color2(16777215),_this118.blendMode=_BLEND_MODES.NORMAL;return _this118;}_inherits2(e,_Container4);return _createClass2(e,[{key:"geometry",get:function get(){return this._geometry;}},{key:"clone",value:function clone(){return this.finishPoly(),new e(this._geometry);}},{key:"blendMode",get:function get(){return this.state.blendMode;},set:function set(_e561){this.state.blendMode=_e561;}},{key:"tint",get:function get(){return this._tintColor.value;},set:function set(_e562){this._tintColor.setValue(_e562);}},{key:"fill",get:function get(){return this._fillStyle;}},{key:"line",get:function get(){return this._lineStyle;}},{key:"lineStyle",value:function lineStyle(){var _e563=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r=arguments.length>2?arguments[2]:undefined;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:.5;var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!1;return"number"==typeof _e563&&(_e563={width:_e563,color:t,alpha:r,alignment:n,"native":i}),this.lineTextureStyle(_e563);}},{key:"lineTextureStyle",value:function lineTextureStyle(_e564){var _e599;var t={width:0,texture:Texture_Texture.WHITE,color:(_e599=_e564)!==null&&_e599!==void 0&&_e599.texture?16777215:0,matrix:null,alignment:.5,"native":!1,cap:_LINE_CAP.BUTT,join:_LINE_JOIN.MITER,miterLimit:10};_e564=Object.assign(t,_e564),this.normalizeColor(_e564),this.currentPath&&this.startPoly();var r=_e564.width>0&&_e564.alpha>0;return r?(_e564.matrix&&(_e564.matrix=_e564.matrix.clone(),_e564.matrix.invert()),Object.assign(this._lineStyle,{visible:r},_e564)):this._lineStyle.reset(),this;}},{key:"startPoly",value:function startPoly(){if(this.currentPath){var _e565=this.currentPath.points,_t279=this.currentPath.points.length;_t279>2&&(this.drawShape(this.currentPath),this.currentPath=new _Polygon(),this.currentPath.closeStroke=!1,this.currentPath.points.push(_e565[_t279-2],_e565[_t279-1]));}else this.currentPath=new _Polygon(),this.currentPath.closeStroke=!1;}},{key:"finishPoly",value:function finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0);}},{key:"moveTo",value:function moveTo(_e566,t){return this.startPoly(),this.currentPath.points[0]=_e566,this.currentPath.points[1]=t,this;}},{key:"lineTo",value:function lineTo(_e567,t){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,n=r[r.length-2],i=r[r.length-1];return(n!==_e567||i!==t)&&r.push(_e567,t),this;}},{key:"_initCurve",value:function _initCurve(){var _e568=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[_e568,t]):this.moveTo(_e568,t);}},{key:"quadraticCurveTo",value:function quadraticCurveTo(_e569,t,r,n){this._initCurve();var i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),QuadraticUtils.curveTo(_e569,t,r,n,i),this;}},{key:"bezierCurveTo",value:function bezierCurveTo(_e570,t,r,n,i,o){return this._initCurve(),BezierUtils.curveTo(_e570,t,r,n,i,o,this.currentPath.points),this;}},{key:"arcTo",value:function arcTo(_e571,t,r,n,i){this._initCurve(_e571,t);var o=this.currentPath.points,a=ArcUtils.curveTo(_e571,t,r,n,i,o);if(a){var _e572=a.cx,_t280=a.cy,_r235=a.radius,_n158=a.startAngle,_i119=a.endAngle,_o79=a.anticlockwise;this.arc(_e572,_t280,_r235,_n158,_i119,_o79);}return this;}},{key:"arc",value:function arc(_e573,t,r,n,i){var o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:!1;if(n===i)return this;if(!o&&i<=n?i+=_PI_:o&&n<=i&&(n+=_PI_),i-n==0)return this;var a=_e573+Math.cos(n)*r,s=t+Math.sin(n)*r,u=this._geometry.closePointEps;var l=this.currentPath?this.currentPath.points:null;if(l){var _e574=Math.abs(l[l.length-2]-a),_t281=Math.abs(l[l.length-1]-s);_e574<u&&_t281<u||l.push(a,s);}else this.moveTo(a,s),l=this.currentPath.points;return ArcUtils.arc(a,s,_e573,t,r,n,i,o,l),this;}},{key:"beginFill",value:function beginFill(){var _e575=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1?arguments[1]:undefined;return this.beginTextureFill({texture:Texture_Texture.WHITE,color:_e575,alpha:t});}},{key:"normalizeColor",value:function normalizeColor(_e576){var _e576$color,_e576$alpha;var t=_Color2.shared.setValue((_e576$color=_e576.color)!==null&&_e576$color!==void 0?_e576$color:0);_e576.color=t.toNumber(),(_e576$alpha=_e576.alpha)!==null&&_e576$alpha!==void 0?_e576$alpha:_e576.alpha=t.alpha;}},{key:"beginTextureFill",value:function beginTextureFill(_e577){var t={texture:Texture_Texture.WHITE,color:16777215,matrix:null};_e577=Object.assign(t,_e577),this.normalizeColor(_e577),this.currentPath&&this.startPoly();var r=_e577.alpha>0;return r?(_e577.matrix&&(_e577.matrix=_e577.matrix.clone(),_e577.matrix.invert()),Object.assign(this._fillStyle,{visible:r},_e577)):this._fillStyle.reset(),this;}},{key:"endFill",value:function endFill(){return this.finishPoly(),this._fillStyle.reset(),this;}},{key:"drawRect",value:function drawRect(_e578,t,r,n){return this.drawShape(new _Rectangle(_e578,t,r,n));}},{key:"drawRoundedRect",value:function drawRoundedRect(_e579,t,r,n,i){return this.drawShape(new _RoundedRectangle(_e579,t,r,n,i));}},{key:"drawCircle",value:function drawCircle(_e580,t,r){return this.drawShape(new _Circle(_e580,t,r));}},{key:"drawEllipse",value:function drawEllipse(_e581,t,r,n){return this.drawShape(new _Ellipse(_e581,t,r,n));}},{key:"drawPolygon",value:function drawPolygon(){var t,r=!0;for(var _len8=arguments.length,_e582=new Array(_len8),_key8=0;_key8<_len8;_key8++){_e582[_key8]=arguments[_key8];}var n=_e582[0];n.points?(r=n.closeStroke,t=n.points):t=Array.isArray(_e582[0])?_e582[0]:_e582;var i=new _Polygon(t);return i.closeStroke=r,this.drawShape(i),this;}},{key:"drawShape",value:function drawShape(_e583){return this._holeMode?this._geometry.drawHole(_e583,this._matrix):this._geometry.drawShape(_e583,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this;}},{key:"clear",value:function clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this;}},{key:"isFastRect",value:function isFastRect(){var _e584=this._geometry.graphicsData;return!(1!==_e584.length||_e584[0].shape.type!==_SHAPES.RECT||_e584[0].matrix||_e584[0].holes.length||_e584[0].lineStyle.visible&&_e584[0].lineStyle.width);}},{key:"_render",value:function _render(_e585){this.finishPoly();var t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(_e585)):(_e585.batch.flush(),this._renderDirect(_e585));}},{key:"_populateBatches",value:function _populateBatches(){var _e586=this._geometry,t=this.blendMode,r=_e586.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=_e586.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(_e586.points);for(var n=0;n<r;n++){var _r236=_e586.batches[n],i=_r236.style.color,_o80=new Float32Array(this.vertexData.buffer,4*_r236.attribStart*2,2*_r236.attribSize),_a65=new Float32Array(_e586.uvsFloat32.buffer,4*_r236.attribStart*2,2*_r236.attribSize),_s50={vertexData:_o80,blendMode:t,indices:new Uint16Array(_e586.indicesUint16.buffer,2*_r236.start,_r236.size),uvs:_a65,_batchRGB:_Color2.shared.setValue(i).toRgbArray(),_tintRGB:i,_texture:_r236.style.texture,alpha:_r236.style.alpha,worldAlpha:1};this.batches[n]=_s50;}}},{key:"_renderBatched",value:function _renderBatched(_e587){if(this.batches.length){_e587.batch.setObjectRenderer(_e587.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var _t282=0,r=this.batches.length;_t282<r;_t282++){var _r237=this.batches[_t282];_r237.worldAlpha=this.worldAlpha*_r237.alpha,_e587.plugins[this.pluginName].render(_r237);}}}},{key:"_renderDirect",value:function _renderDirect(_e588){var t=this._resolveDirectShader(_e588),r=this._geometry,n=this.worldAlpha,i=t.uniforms,o=r.drawCalls;i.translationMatrix=this.transform.worldTransform,_Color2.shared.setValue(this._tintColor).premultiply(n).toArray(i.tint),_e588.shader.bind(t),_e588.geometry.bind(r,t),_e588.state.set(this.state);for(var _t283=0,_n159=o.length;_t283<_n159;_t283++)this._renderDrawCallDirect(_e588,r.drawCalls[_t283]);}},{key:"_renderDrawCallDirect",value:function _renderDrawCallDirect(_e589,t){var r=t.texArray,n=t.type,i=t.size,o=t.start,a=r.count;for(var _t284=0;_t284<a;_t284++)_e589.texture.bind(r.elements[_t284],_t284);_e589.geometry.draw(n,i,o);}},{key:"_resolveDirectShader",value:function _resolveDirectShader(_e590){var t=this.shader;var r=this.pluginName;if(!t){if(!DEFAULT_SHADERS[r]){var _t285=_e590.plugins[r].maxTextures,n=new Int32Array(_t285);for(var _e600=0;_e600<_t285;_e600++)n[_e600]=_e600;var i={tint:new Float32Array([1,1,1,1]),translationMatrix:new _Matrix(),"default":_UniformGroup.from({uSamplers:n},!0)},_o81=_e590.plugins[r]._shader.program;DEFAULT_SHADERS[r]=new _Shader(_o81,i);}t=DEFAULT_SHADERS[r];}return t;}},{key:"_calculateBounds",value:function _calculateBounds(){this.finishPoly();var _e592=this._geometry;if(!_e592.graphicsData.length)return;var _e592$bounds=_e592.bounds,t=_e592$bounds.minX,r=_e592$bounds.minY,n=_e592$bounds.maxX,i=_e592$bounds.maxY;this._bounds.addFrame(this.transform,t,r,n,i);}},{key:"containsPoint",value:function containsPoint(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT);}},{key:"calculateTints",value:function calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(var _e601=0;_e601<this.batches.length;_e601++){var _t286=this.batches[_e601];_t286._tintRGB=_Color2.shared.setValue(this._tintColor).multiply(_t286._batchRGB).toLittleEndianNumber();}}}},{key:"calculateVertices",value:function calculateVertices(){var _e594=this.transform._worldID;if(this._transformID===_e594)return;this._transformID=_e594;var t=this.transform.worldTransform,r=t.a,n=t.b,i=t.c,o=t.d,a=t.tx,s=t.ty,u=this._geometry.points,l=this.vertexData;var c=0;for(var _e602=0;_e602<u.length;_e602+=2){var _t287=u[_e602],_h19=u[_e602+1];l[c++]=r*_t287+i*_h19+a,l[c++]=o*_h19+n*_t287+s;}}},{key:"closePath",value:function closePath(){var _e596=this.currentPath;return _e596&&(_e596.closeStroke=!0,this.finishPoly()),this;}},{key:"setMatrix",value:function setMatrix(_e597){return this._matrix=_e597,this;}},{key:"beginHole",value:function beginHole(){return this.finishPoly(),this._holeMode=!0,this;}},{key:"endHole",value:function endHole(){return this.finishPoly(),this._holeMode=!1,this;}},{key:"destroy",value:function destroy(_e598){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,_superPropGet2(e,"destroy",this,3)([_e598]);}}]);}(_Container2);_Graphics.curves=_curves,_Graphics._TEMP_POINT=new _Point();var _Graphics2=_Graphics;var _graphicsUtils={buildPoly:buildPoly,buildCircle:buildCircle,buildRectangle:buildRectangle,buildRoundedRectangle:buildRoundedRectangle,buildLine:buildLine,ArcUtils:ArcUtils,BezierUtils:BezierUtils,QuadraticUtils:QuadraticUtils,BatchPart:BatchPart,FILL_COMMANDS:FILL_COMMANDS,BATCH_POOL:BATCH_POOL,DRAW_CALL_POOL:DRAW_CALL_POOL};var _MeshBatchUvs=/*#__PURE__*/function(){function _MeshBatchUvs(e,t){_classCallCheck2(this,_MeshBatchUvs);this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0;}return _createClass2(_MeshBatchUvs,[{key:"update",value:function update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var t=this.uvBuffer.data;(!this.data||this.data.length!==t.length)&&(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++;}}]);}();var Mesh_tempPoint=new _Point(),tempPolygon=new _Polygon(),_Mesh=/*#__PURE__*/function(_Container5){function e(_e603,t,r){var _this119;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:_DRAW_MODES.TRIANGLES;_classCallCheck2(this,e);_this119=_callSuper2(this,e),_this119.geometry=_e603,_this119.shader=t,_this119.state=r||_State.for2d(),_this119.drawMode=n,_this119.start=0,_this119.size=0,_this119.uvs=null,_this119.indices=null,_this119.vertexData=new Float32Array(1),_this119.vertexDirty=-1,_this119._transformID=-1,_this119._roundPixels=_settings.ROUND_PIXELS,_this119.batchUvs=null;return _this119;}_inherits2(e,_Container5);return _createClass2(e,[{key:"geometry",get:function get(){return this._geometry;},set:function set(_e604){this._geometry!==_e604&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=_e604,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1);}},{key:"uvBuffer",get:function get(){return this.geometry.buffers[1];}},{key:"verticesBuffer",get:function get(){return this.geometry.buffers[0];}},{key:"material",get:function get(){return this.shader;},set:function set(_e605){this.shader=_e605;}},{key:"blendMode",get:function get(){return this.state.blendMode;},set:function set(_e606){this.state.blendMode=_e606;}},{key:"roundPixels",get:function get(){return this._roundPixels;},set:function set(_e607){this._roundPixels!==_e607&&(this._transformID=-1),this._roundPixels=_e607;}},{key:"tint",get:function get(){return"tint"in this.shader?this.shader.tint:null;},set:function set(_e608){this.shader.tint=_e608;}},{key:"tintValue",get:function get(){return this.shader.tintValue;}},{key:"texture",get:function get(){return"texture"in this.shader?this.shader.texture:null;},set:function set(_e609){this.shader.texture=_e609;}},{key:"_render",value:function _render(t){var r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===_DRAW_MODES.TRIANGLES&&r.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t);}},{key:"_renderDefault",value:function _renderDefault(_e610){var t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),_e610.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),_e610.shader.bind(t),_e610.state.set(this.state),_e610.geometry.bind(this.geometry,t),_e610.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount);}},{key:"_renderToBatch",value:function _renderToBatch(_e611){var t=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;var n=this.material.pluginName;_e611.batch.setObjectRenderer(_e611.plugins[n]),_e611.plugins[n].render(this);}},{key:"calculateVertices",value:function calculateVertices(){var _e612=this.geometry.buffers[0],t=_e612.data,r=_e612._updateID;if(r===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));var n=this.transform.worldTransform,i=n.a,o=n.b,a=n.c,s=n.d,u=n.tx,l=n.ty,c=this.vertexData;for(var _e619=0;_e619<c.length/2;_e619++){var _r238=t[2*_e619],_n160=t[2*_e619+1];c[2*_e619]=i*_r238+a*_n160+u,c[2*_e619+1]=o*_r238+s*_n160+l;}if(this._roundPixels){var _e614=_settings.RESOLUTION;for(var _t288=0;_t288<c.length;++_t288)c[_t288]=Math.round(c[_t288]*_e614)/_e614;}this.vertexDirty=r;}},{key:"calculateUvs",value:function calculateUvs(){var _e615=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=_e615.data:(this.batchUvs||(this.batchUvs=new _MeshBatchUvs(_e615,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data);}},{key:"_calculateBounds",value:function _calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length);}},{key:"containsPoint",value:function containsPoint(_e616){if(!this.getBounds().contains(_e616.x,_e616.y))return!1;this.worldTransform.applyInverse(_e616,Mesh_tempPoint);var t=this.geometry.getBuffer("aVertexPosition").data,r=tempPolygon.points,n=this.geometry.getIndex().data,i=n.length,o=4===this.drawMode?3:1;for(var _e620=0;_e620+2<i;_e620+=o){var _i120=2*n[_e620],_o82=2*n[_e620+1],_a66=2*n[_e620+2];if(r[0]=t[_i120],r[1]=t[_i120+1],r[2]=t[_o82],r[3]=t[_o82+1],r[4]=t[_a66],r[5]=t[_a66+1],tempPolygon.contains(Mesh_tempPoint.x,Mesh_tempPoint.y))return!0;}return!1;}},{key:"destroy",value:function destroy(_e618){_superPropGet2(e,"destroy",this,3)([_e618]),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null;}}]);}(_Container2);_Mesh.BATCHABLE_SIZE=100;var _Mesh2=_Mesh;var _MeshGeometry=/*#__PURE__*/function(_Geometry5){function _MeshGeometry(e,t,r){var _this120;_classCallCheck2(this,_MeshGeometry);_this120=_callSuper2(this,_MeshGeometry);var n=new _Buffer(e),i=new _Buffer(t,!0),o=new _Buffer(r,!0,!0);_this120.addAttribute("aVertexPosition",n,2,!1,_TYPES.FLOAT).addAttribute("aTextureCoord",i,2,!1,_TYPES.FLOAT).addIndex(o),_this120._updateId=-1;return _this120;}_inherits2(_MeshGeometry,_Geometry5);return _createClass2(_MeshGeometry,[{key:"vertexDirtyId",get:function get(){return this.buffers[0]._updateID;}}]);}(_Geometry);var mesh_frag_fragment="varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n",mesh_vert_vertex="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n";var _MeshMaterial=/*#__PURE__*/function(_Shader3){function _MeshMaterial(e,t){var _this121;_classCallCheck2(this,_MeshMaterial);var r={uSampler:e,alpha:1,uTextureMatrix:_Matrix.IDENTITY,uColor:new Float32Array([1,1,1,1])};(t=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},t)).uniforms&&Object.assign(r,t.uniforms),_this121=_callSuper2(this,_MeshMaterial,[t.program||_Program2.from(mesh_vert_vertex,mesh_frag_fragment),r]),_this121._colorDirty=!1,_this121.uvMatrix=new _TextureMatrix(e),_this121.batchable=void 0===t.program,_this121.pluginName=t.pluginName,_this121._tintColor=new _Color2(t.tint),_this121._tintRGB=_this121._tintColor.toLittleEndianNumber(),_this121._colorDirty=!0,_this121.alpha=t.alpha;return _this121;}_inherits2(_MeshMaterial,_Shader3);return _createClass2(_MeshMaterial,[{key:"texture",get:function get(){return this.uniforms.uSampler;},set:function set(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e);}},{key:"alpha",get:function get(){return this._alpha;},set:function set(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0);}},{key:"tint",get:function get(){return this._tintColor.value;},set:function set(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0);}},{key:"tintValue",get:function get(){return this._tintColor.toNumber();}},{key:"update",value:function update(){if(this._colorDirty){this._colorDirty=!1;var _e621=this.texture.baseTexture.alphaMode;_Color2.shared.setValue(this._tintColor).premultiply(this._alpha,_e621).toArray(this.uniforms.uColor);}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord);}}]);}(_Shader);var _PlaneGeometry=/*#__PURE__*/function(_MeshGeometry2){function _PlaneGeometry(){var _this122;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:10;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:10;_classCallCheck2(this,_PlaneGeometry);_this122=_callSuper2(this,_PlaneGeometry),_this122.segWidth=r,_this122.segHeight=n,_this122.width=e,_this122.height=t,_this122.build();return _this122;}_inherits2(_PlaneGeometry,_MeshGeometry2);return _createClass2(_PlaneGeometry,[{key:"build",value:function build(){var e=this.segWidth*this.segHeight,t=[],r=[],n=[],i=this.segWidth-1,o=this.segHeight-1,a=this.width/i,s=this.height/o;for(var _n161=0;_n161<e;_n161++){var _e622=_n161%this.segWidth,_u38=_n161/this.segWidth|0;t.push(_e622*a,_u38*s),r.push(_e622/i,_u38/o);}var u=i*o;for(var _e623=0;_e623<u;_e623++){var _t289=_e623%i,_r239=_e623/i|0,_o83=_r239*this.segWidth+_t289,_a67=_r239*this.segWidth+_t289+1,_s51=(_r239+1)*this.segWidth+_t289,_u39=(_r239+1)*this.segWidth+_t289+1;n.push(_o83,_a67,_s51,_a67,_u39,_s51);}this.buffers[0].data=new Float32Array(t),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint16Array(n),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update();}}]);}(_MeshGeometry);var _RopeGeometry=/*#__PURE__*/function(_MeshGeometry3){function _RopeGeometry(){var _this123;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:200;var t=arguments.length>1?arguments[1]:undefined;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;_classCallCheck2(this,_RopeGeometry);_this123=_callSuper2(this,_RopeGeometry,[new Float32Array(4*t.length),new Float32Array(4*t.length),new Uint16Array(6*(t.length-1))]),_this123.points=t,_this123._width=e,_this123.textureScale=r,_this123.build();return _this123;}_inherits2(_RopeGeometry,_MeshGeometry3);return _createClass2(_RopeGeometry,[{key:"width",get:function get(){return this._width;}},{key:"build",value:function build(){var e=this.points;if(!e)return;var t=this.getBuffer("aVertexPosition"),r=this.getBuffer("aTextureCoord"),n=this.getIndex();if(e.length<1)return;t.data.length/4!==e.length&&(t.data=new Float32Array(4*e.length),r.data=new Float32Array(4*e.length),n.data=new Uint16Array(6*(e.length-1)));var i=r.data,o=n.data;i[0]=0,i[1]=0,i[2]=0,i[3]=1;var a=0,s=e[0];var u=this._width*this.textureScale,l=e.length;for(var _t290=0;_t290<l;_t290++){var _r240=4*_t290;if(this.textureScale>0){var _r241=s.x-e[_t290].x,_n162=s.y-e[_t290].y,_i121=Math.sqrt(_r241*_r241+_n162*_n162);s=e[_t290],a+=_i121/u;}else a=_t290/(l-1);i[_r240]=a,i[_r240+1]=0,i[_r240+2]=a,i[_r240+3]=1;}var c=0;for(var _e624=0;_e624<l-1;_e624++){var _t291=2*_e624;o[c++]=_t291,o[c++]=_t291+1,o[c++]=_t291+2,o[c++]=_t291+2,o[c++]=_t291+1,o[c++]=_t291+3;}r.update(),n.update(),this.updateVertices();}},{key:"updateVertices",value:function updateVertices(){var e=this.points;if(e.length<1)return;var t,r=e[0],n=0,i=0;var o=this.buffers[0].data,a=e.length,s=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(var _u40=0;_u40<a;_u40++){var _l27=e[_u40],_c24=4*_u40;t=_u40<e.length-1?e[_u40+1]:_l27,i=-(t.x-r.x),n=t.y-r.y;var _h20=10*(1-_u40/(a-1));_h20>1&&(_h20=1);var _f13=Math.sqrt(n*n+i*i);_f13<1e-6?(n=0,i=0):(n/=_f13,i/=_f13,n*=s,i*=s),o[_c24]=_l27.x+n,o[_c24+1]=_l27.y+i,o[_c24+2]=_l27.x-n,o[_c24+3]=_l27.y-i,r=_l27;}this.buffers[0].update();}},{key:"update",value:function update(){this.textureScale>0?this.build():this.updateVertices();}}]);}(_MeshGeometry);var _SimplePlane=/*#__PURE__*/function(_Mesh3){function _SimplePlane(e,t,r){var _this124;_classCallCheck2(this,_SimplePlane);_this124=_callSuper2(this,_SimplePlane,[new _PlaneGeometry(e.width,e.height,t,r),new _MeshMaterial(Texture_Texture.WHITE)]),_this124.texture=e,_this124.autoResize=!0;return _this124;}_inherits2(_SimplePlane,_Mesh3);return _createClass2(_SimplePlane,[{key:"textureUpdated",value:function textureUpdated(){this._textureID=this.shader.texture._updateID;var e=this.geometry,_this$shader$texture=this.shader.texture,t=_this$shader$texture.width,r=_this$shader$texture.height;this.autoResize&&(e.width!==t||e.height!==r)&&(e.width=this.shader.texture.width,e.height=this.shader.texture.height,e.build());}},{key:"texture",get:function get(){return this.shader.texture;},set:function set(e){this.shader.texture!==e&&(this.shader.texture=e,this._textureID=-1,e.baseTexture.valid?this.textureUpdated():e.once("update",this.textureUpdated,this));}},{key:"_render",value:function _render(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),_superPropGet2(_SimplePlane,"_render",this,3)([e]);}},{key:"destroy",value:function destroy(e){this.shader.texture.off("update",this.textureUpdated,this),_superPropGet2(_SimplePlane,"destroy",this,3)([e]);}}]);}(_Mesh2);var DEFAULT_BORDER_SIZE=10;var _NineSlicePlane=/*#__PURE__*/function(_SimplePlane2){function _NineSlicePlane(e,t,r,n,i){var _ref59,_e$defaultBorders,_ref60,_e$defaultBorders2,_ref61,_e$defaultBorders3,_ref62,_e$defaultBorders4;var _this125;_classCallCheck2(this,_NineSlicePlane);_this125=_callSuper2(this,_NineSlicePlane,[Texture_Texture.WHITE,4,4]),_this125._origWidth=e.orig.width,_this125._origHeight=e.orig.height,_this125._width=_this125._origWidth,_this125._height=_this125._origHeight,_this125._leftWidth=(_ref59=t!==null&&t!==void 0?t:(_e$defaultBorders=e.defaultBorders)===null||_e$defaultBorders===void 0?void 0:_e$defaultBorders.left)!==null&&_ref59!==void 0?_ref59:DEFAULT_BORDER_SIZE,_this125._rightWidth=(_ref60=n!==null&&n!==void 0?n:(_e$defaultBorders2=e.defaultBorders)===null||_e$defaultBorders2===void 0?void 0:_e$defaultBorders2.right)!==null&&_ref60!==void 0?_ref60:DEFAULT_BORDER_SIZE,_this125._topHeight=(_ref61=r!==null&&r!==void 0?r:(_e$defaultBorders3=e.defaultBorders)===null||_e$defaultBorders3===void 0?void 0:_e$defaultBorders3.top)!==null&&_ref61!==void 0?_ref61:DEFAULT_BORDER_SIZE,_this125._bottomHeight=(_ref62=i!==null&&i!==void 0?i:(_e$defaultBorders4=e.defaultBorders)===null||_e$defaultBorders4===void 0?void 0:_e$defaultBorders4.bottom)!==null&&_ref62!==void 0?_ref62:DEFAULT_BORDER_SIZE,_this125.texture=e;return _this125;}_inherits2(_NineSlicePlane,_SimplePlane2);return _createClass2(_NineSlicePlane,[{key:"textureUpdated",value:function textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh();}},{key:"vertices",get:function get(){return this.geometry.getBuffer("aVertexPosition").data;},set:function set(e){this.geometry.getBuffer("aVertexPosition").data=e;}},{key:"updateHorizontalVertices",value:function updateHorizontalVertices(){var e=this.vertices,t=this._getMinScale();e[9]=e[11]=e[13]=e[15]=this._topHeight*t,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight*t,e[25]=e[27]=e[29]=e[31]=this._height;}},{key:"updateVerticalVertices",value:function updateVerticalVertices(){var e=this.vertices,t=this._getMinScale();e[2]=e[10]=e[18]=e[26]=this._leftWidth*t,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth*t,e[6]=e[14]=e[22]=e[30]=this._width;}},{key:"_getMinScale",value:function _getMinScale(){var e=this._leftWidth+this._rightWidth,t=this._width>e?1:this._width/e,r=this._topHeight+this._bottomHeight,n=this._height>r?1:this._height/r;return Math.min(t,n);}},{key:"width",get:function get(){return this._width;},set:function set(e){this._width=e,this._refresh();}},{key:"height",get:function get(){return this._height;},set:function set(e){this._height=e,this._refresh();}},{key:"leftWidth",get:function get(){return this._leftWidth;},set:function set(e){this._leftWidth=e,this._refresh();}},{key:"rightWidth",get:function get(){return this._rightWidth;},set:function set(e){this._rightWidth=e,this._refresh();}},{key:"topHeight",get:function get(){return this._topHeight;},set:function set(e){this._topHeight=e,this._refresh();}},{key:"bottomHeight",get:function get(){return this._bottomHeight;},set:function set(e){this._bottomHeight=e,this._refresh();}},{key:"_refresh",value:function _refresh(){var e=this.texture,t=this.geometry.buffers[1].data;this._origWidth=e.orig.width,this._origHeight=e.orig.height;var r=1/this._origWidth,n=1/this._origHeight;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1,t[2]=t[10]=t[18]=t[26]=r*this._leftWidth,t[4]=t[12]=t[20]=t[28]=1-r*this._rightWidth,t[9]=t[11]=t[13]=t[15]=n*this._topHeight,t[17]=t[19]=t[21]=t[23]=1-n*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update();}}]);}(_SimplePlane);var _SimpleMesh=/*#__PURE__*/function(_Mesh4){function _SimpleMesh(){var _this126;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:Texture_Texture.EMPTY;var t=arguments.length>1?arguments[1]:undefined;var r=arguments.length>2?arguments[2]:undefined;var n=arguments.length>3?arguments[3]:undefined;var i=arguments.length>4?arguments[4]:undefined;_classCallCheck2(this,_SimpleMesh);var o=new _MeshGeometry(t,r,n);o.getBuffer("aVertexPosition")["static"]=!1;_this126=_callSuper2(this,_SimpleMesh,[o,new _MeshMaterial(e),null,i]),_this126.autoUpdate=!0;return _this126;}_inherits2(_SimpleMesh,_Mesh4);return _createClass2(_SimpleMesh,[{key:"vertices",get:function get(){return this.geometry.getBuffer("aVertexPosition").data;},set:function set(e){this.geometry.getBuffer("aVertexPosition").data=e;}},{key:"_render",value:function _render(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),_superPropGet2(_SimpleMesh,"_render",this,3)([e]);}}]);}(_Mesh2);var _SimpleRope=/*#__PURE__*/function(_Mesh5){function _SimpleRope(e,t){var _this127;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;_classCallCheck2(this,_SimpleRope);var n=new _RopeGeometry(e.height,t,r),i=new _MeshMaterial(e);r>0&&(e.baseTexture.wrapMode=_WRAP_MODES.REPEAT),_this127=_callSuper2(this,_SimpleRope,[n,i]),_this127.autoUpdate=!0;return _this127;}_inherits2(_SimpleRope,_Mesh5);return _createClass2(_SimpleRope,[{key:"_render",value:function _render(e){var t=this.geometry;(this.autoUpdate||t._width!==this.shader.texture.height)&&(t._width=this.shader.texture.height,t.update()),_superPropGet2(_SimpleRope,"_render",this,3)([e]);}}]);}(_Mesh2);var _ParticleContainer=/*#__PURE__*/function(_Container6){function _ParticleContainer(){var _this128;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1500;var t=arguments.length>1?arguments[1]:undefined;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:16384;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1;_classCallCheck2(this,_ParticleContainer);_this128=_callSuper2(this,_ParticleContainer);r>16384&&(r=16384),_this128._properties=[!1,!0,!1,!1,!1],_this128._maxSize=e,_this128._batchSize=r,_this128._buffers=null,_this128._bufferUpdateIDs=[],_this128._updateID=0,_this128.interactiveChildren=!1,_this128.blendMode=_BLEND_MODES.NORMAL,_this128.autoResize=n,_this128.roundPixels=!0,_this128.baseTexture=null,_this128.setProperties(t),_this128._tintColor=new _Color2(0),_this128.tintRgb=new Float32Array(3),_this128.tint=16777215;return _this128;}_inherits2(_ParticleContainer,_Container6);return _createClass2(_ParticleContainer,[{key:"setProperties",value:function setProperties(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4]);}},{key:"updateTransform",value:function updateTransform(){this.displayObjectUpdateTransform();}},{key:"tint",get:function get(){return this._tintColor.value;},set:function set(e){this._tintColor.setValue(e),this._tintColor.toRgbArray(this.tintRgb);}},{key:"render",value:function render(e){var _this129=this;!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return _this129.onChildrenChange(0);})),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this));}},{key:"onChildrenChange",value:function onChildrenChange(e){var t=Math.floor(e/this._batchSize);for(;this._bufferUpdateIDs.length<t;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[t]=++this._updateID;}},{key:"dispose",value:function dispose(){if(this._buffers){for(var _e625=0;_e625<this._buffers.length;++_e625)this._buffers[_e625].destroy();this._buffers=null;}}},{key:"destroy",value:function destroy(e){_superPropGet2(_ParticleContainer,"destroy",this,3)([e]),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null;}}]);}(_Container2);var ParticleBuffer=/*#__PURE__*/function(){function ParticleBuffer(e,t,r){_classCallCheck2(this,ParticleBuffer);this.geometry=new _Geometry(),this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var _r242=0;_r242<e.length;++_r242){var n=e[_r242];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||_TYPES.FLOAT,offset:n.offset},t[_r242]?this.dynamicProperties.push(n):this.staticProperties.push(n);}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers();}return _createClass2(ParticleBuffer,[{key:"initBuffers",value:function initBuffers(){var e=this.geometry;var t=0;this.indexBuffer=new _Buffer(_createIndicesForQuads(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(var _e626=0;_e626<this.dynamicProperties.length;++_e626){var _r243=this.dynamicProperties[_e626];_r243.offset=t,t+=_r243.size,this.dynamicStride+=_r243.size;}var r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new _Buffer(this.dynamicData,!1,!1);var n=0;this.staticStride=0;for(var _e627=0;_e627<this.staticProperties.length;++_e627){var _t292=this.staticProperties[_e627];_t292.offset=n,n+=_t292.size,this.staticStride+=_t292.size;}var i=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(i),this.staticDataUint32=new Uint32Array(i),this.staticBuffer=new _Buffer(this.staticData,!0,!1);for(var _t293=0;_t293<this.dynamicProperties.length;++_t293){var _r244=this.dynamicProperties[_t293];e.addAttribute(_r244.attributeName,this.dynamicBuffer,0,_r244.type===_TYPES.UNSIGNED_BYTE,_r244.type,4*this.dynamicStride,4*_r244.offset);}for(var _t294=0;_t294<this.staticProperties.length;++_t294){var _r245=this.staticProperties[_t294];e.addAttribute(_r245.attributeName,this.staticBuffer,0,_r245.type===_TYPES.UNSIGNED_BYTE,_r245.type,4*this.staticStride,4*_r245.offset);}}},{key:"uploadDynamic",value:function uploadDynamic(e,t,r){for(var n=0;n<this.dynamicProperties.length;n++){var i=this.dynamicProperties[n];i.uploadFunction(e,t,r,i.type===_TYPES.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset);}this.dynamicBuffer._updateID++;}},{key:"uploadStatic",value:function uploadStatic(e,t,r){for(var n=0;n<this.staticProperties.length;n++){var i=this.staticProperties[n];i.uploadFunction(e,t,r,i.type===_TYPES.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,i.offset);}this.staticBuffer._updateID++;}},{key:"destroy",value:function destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy();}}]);}();var particles_frag_fragment="varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",particles_vert_vertex="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n";var _ParticleRenderer=/*#__PURE__*/function(_ObjectRenderer3){function _ParticleRenderer(e){var _this130;_classCallCheck2(this,_ParticleRenderer);_this130=_callSuper2(this,_ParticleRenderer,[e]),_this130.shader=null,_this130.properties=null,_this130.tempMatrix=new _Matrix(),_this130.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:_this130.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:_this130.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:_this130.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:_this130.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:_TYPES.UNSIGNED_BYTE,uploadFunction:_this130.uploadTint,offset:0}],_this130.shader=_Shader.from(particles_vert_vertex,particles_frag_fragment,{}),_this130.state=_State.for2d();return _this130;}_inherits2(_ParticleRenderer,_ObjectRenderer3);return _createClass2(_ParticleRenderer,[{key:"render",value:function render(e){var t=e.children,r=e._maxSize,n=e._batchSize,i=this.renderer;var o=t.length;if(0===o)return;o>r&&!e.autoResize&&(o=r);var a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));var s=t[0]._texture.baseTexture,u=s.alphaMode>0;this.state.blendMode=_correctBlendMode(e.blendMode,u),i.state.set(this.state);var l=i.gl,c=e.worldTransform.copyTo(this.tempMatrix);c.prepend(i.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=c.toArray(!0),this.shader.uniforms.uColor=_Color2.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,u).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=s,this.renderer.shader.bind(this.shader);var h=!1;for(var _r246=0,_s52=0;_r246<o;_r246+=n,_s52+=1){var _u41=o-_r246;_u41>n&&(_u41=n),_s52>=a.length&&a.push(this._generateOneMoreBuffer(e));var _c25=a[_s52];_c25.uploadDynamic(t,_r246,_u41);var _f14=e._bufferUpdateIDs[_s52]||0;h=h||_c25._updateID<_f14,h&&(_c25._updateID=e._updateID,_c25.uploadStatic(t,_r246,_u41)),i.geometry.bind(_c25.geometry),l.drawElements(l.TRIANGLES,6*_u41,l.UNSIGNED_SHORT,0);}}},{key:"generateBuffers",value:function generateBuffers(e){var t=[],r=e._maxSize,n=e._batchSize,i=e._properties;for(var _e628=0;_e628<r;_e628+=n)t.push(new ParticleBuffer(this.properties,i,n));return t;}},{key:"_generateOneMoreBuffer",value:function _generateOneMoreBuffer(e){var t=e._batchSize,r=e._properties;return new ParticleBuffer(this.properties,r,t);}},{key:"uploadVertices",value:function uploadVertices(e,t,r,n,i,o){var a=0,s=0,u=0,l=0;for(var _c26=0;_c26<r;++_c26){var _r247=e[t+_c26],_h21=_r247._texture,_f15=_r247.scale.x,_d14=_r247.scale.y,_p13=_h21.trim,_y8=_h21.orig;_p13?(s=_p13.x-_r247.anchor.x*_y8.width,a=s+_p13.width,l=_p13.y-_r247.anchor.y*_y8.height,u=l+_p13.height):(a=_y8.width*(1-_r247.anchor.x),s=_y8.width*-_r247.anchor.x,u=_y8.height*(1-_r247.anchor.y),l=_y8.height*-_r247.anchor.y),n[o]=s*_f15,n[o+1]=l*_d14,n[o+i]=a*_f15,n[o+i+1]=l*_d14,n[o+2*i]=a*_f15,n[o+2*i+1]=u*_d14,n[o+3*i]=s*_f15,n[o+3*i+1]=u*_d14,o+=4*i;}}},{key:"uploadPosition",value:function uploadPosition(e,t,r,n,i,o){for(var _a68=0;_a68<r;_a68++){var _r248=e[t+_a68].position;n[o]=_r248.x,n[o+1]=_r248.y,n[o+i]=_r248.x,n[o+i+1]=_r248.y,n[o+2*i]=_r248.x,n[o+2*i+1]=_r248.y,n[o+3*i]=_r248.x,n[o+3*i+1]=_r248.y,o+=4*i;}}},{key:"uploadRotation",value:function uploadRotation(e,t,r,n,i,o){for(var _a69=0;_a69<r;_a69++){var _r249=e[t+_a69].rotation;n[o]=_r249,n[o+i]=_r249,n[o+2*i]=_r249,n[o+3*i]=_r249,o+=4*i;}}},{key:"uploadUvs",value:function uploadUvs(e,t,r,n,i,o){for(var _a70=0;_a70<r;++_a70){var _r250=e[t+_a70]._texture._uvs;_r250?(n[o]=_r250.x0,n[o+1]=_r250.y0,n[o+i]=_r250.x1,n[o+i+1]=_r250.y1,n[o+2*i]=_r250.x2,n[o+2*i+1]=_r250.y2,n[o+3*i]=_r250.x3,n[o+3*i+1]=_r250.y3,o+=4*i):(n[o]=0,n[o+1]=0,n[o+i]=0,n[o+i+1]=0,n[o+2*i]=0,n[o+2*i+1]=0,n[o+3*i]=0,n[o+3*i+1]=0,o+=4*i);}}},{key:"uploadTint",value:function uploadTint(e,t,r,n,i,o){for(var _a71=0;_a71<r;++_a71){var _r251=e[t+_a71],_s53=_Color2.shared.setValue(_r251._tintRGB).toPremultiplied(_r251.alpha,_r251.texture.baseTexture.alphaMode>0);n[o]=_s53,n[o+i]=_s53,n[o+2*i]=_s53,n[o+3*i]=_s53,o+=4*i;}}},{key:"destroy",value:function destroy(){_superPropGet2(_ParticleRenderer,"destroy",this,3)([]),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null;}}]);}(_ObjectRenderer);_ParticleRenderer.extension={name:"particle",type:_ExtensionType.RendererPlugin},_extensions.add(_ParticleRenderer);var _TEXT_GRADIENT=function(e){return e[e.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",e[e.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",e;}(_TEXT_GRADIENT||{});var contextSettings={willReadFrequently:!0},_TextMetrics=/*#__PURE__*/function(){function e(_e629,t,r,n,i,o,a,s,u){_classCallCheck2(this,e);this.text=_e629,this.style=t,this.width=r,this.height=n,this.lines=i,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=s,this.fontProperties=u;}return _createClass2(e,null,[{key:"experimentalLetterSpacingSupported",get:function get(){var t=e._experimentalLetterSpacingSupported;if(void 0!==t){var r=_settings.ADAPTER.getCanvasRenderingContext2D().prototype;t=e._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r;}return t;}},{key:"measureText",value:function measureText(t,r,n){var _n163;var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:e._canvas;n=(_n163=n)!==null&&_n163!==void 0?_n163:r.wordWrap;var o=r.toFontString(),a=e.measureFont(o);0===a.fontSize&&(a.fontSize=r.fontSize,a.ascent=r.fontSize);var s=i.getContext("2d",contextSettings);s.font=o;var u=(n?e.wordWrap(t,r,i):t).split(/(?:\r\n|\r|\n)/),l=new Array(u.length);var c=0;for(var _t295=0;_t295<u.length;_t295++){var _n164=e._measureText(u[_t295],r.letterSpacing,s);l[_t295]=_n164,c=Math.max(c,_n164);}var h=c+r.strokeThickness;r.dropShadow&&(h+=r.dropShadowDistance);var f=r.lineHeight||a.fontSize+r.strokeThickness;var d=Math.max(f,a.fontSize+2*r.strokeThickness)+r.leading+(u.length-1)*(f+r.leading);return r.dropShadow&&(d+=r.dropShadowDistance),new e(t,r,h,d,u,l,f+r.leading,c,a);}},{key:"_measureText",value:function _measureText(t,r,n){var i=!1;e.experimentalLetterSpacingSupported&&(e.experimentalLetterSpacing?(n.letterSpacing="".concat(r,"px"),n.textLetterSpacing="".concat(r,"px"),i=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));var o=n.measureText(t).width;return o>0&&(i?o-=r:o+=(e.graphemeSegmenter(t).length-1)*r),o;}},{key:"wordWrap",value:function wordWrap(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:e._canvas;var i=n.getContext("2d",contextSettings);var o=0,a="",s="";var u=Object.create(null),l=r.letterSpacing,c=r.whiteSpace,h=e.collapseSpaces(c),f=e.collapseNewlines(c);var d=!h;var p=r.wordWrapWidth+l,y=e.tokenize(t);for(var _t296=0;_t296<y.length;_t296++){var _n165=y[_t296];if(e.isNewline(_n165)){if(!f){s+=e.addLine(a),d=!h,a="",o=0;continue;}_n165=" ";}if(h){var _t297=e.isBreakingSpace(_n165),_r252=e.isBreakingSpace(a[a.length-1]);if(_t297&&_r252)continue;}var _c27=e.getFromCache(_n165,l,u,i);if(_c27>p){if(""!==a&&(s+=e.addLine(a),a="",o=0),e.canBreakWords(_n165,r.breakWords)){var _t298=e.wordWrapSplit(_n165);for(var _c28=0;_c28<_t298.length;_c28++){var _h22=_t298[_c28],_f16=_h22,_y9=1;for(;_t298[_c28+_y9];){var _i122=_t298[_c28+_y9];if(e.canBreakChars(_f16,_i122,_n165,_c28,r.breakWords))break;_h22+=_i122,_f16=_i122,_y9++;}_c28+=_y9-1;var _m8=e.getFromCache(_h22,l,u,i);_m8+o>p&&(s+=e.addLine(a),d=!1,a="",o=0),a+=_h22,o+=_m8;}}else{a.length>0&&(s+=e.addLine(a),a="",o=0);var _r253=_t296===y.length-1;s+=e.addLine(_n165,!_r253),d=!1,a="",o=0;}}else _c27+o>p&&(d=!1,s+=e.addLine(a),a="",o=0),(a.length>0||!e.isBreakingSpace(_n165)||d)&&(a+=_n165,o+=_c27);}return s+=e.addLine(a,!1),s;}},{key:"addLine",value:function addLine(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;return t=e.trimRight(t),t=r?"".concat(t,"\n"):t;}},{key:"getFromCache",value:function getFromCache(t,r,n,i){var o=n[t];return"number"!=typeof o&&(o=e._measureText(t,r,i)+r,n[t]=o),o;}},{key:"collapseSpaces",value:function collapseSpaces(_e630){return"normal"===_e630||"pre-line"===_e630;}},{key:"collapseNewlines",value:function collapseNewlines(_e631){return"normal"===_e631;}},{key:"trimRight",value:function trimRight(t){if("string"!=typeof t)return"";for(var r=t.length-1;r>=0;r--){var n=t[r];if(!e.isBreakingSpace(n))break;t=t.slice(0,-1);}return t;}},{key:"isNewline",value:function isNewline(t){return"string"==typeof t&&e._newlines.includes(t.charCodeAt(0));}},{key:"isBreakingSpace",value:function isBreakingSpace(t,r){return"string"==typeof t&&e._breakingSpaces.includes(t.charCodeAt(0));}},{key:"tokenize",value:function tokenize(t){var r=[];var n="";if("string"!=typeof t)return r;for(var i=0;i<t.length;i++){var _o84=t[i],_a72=t[i+1];e.isBreakingSpace(_o84,_a72)||e.isNewline(_o84)?(""!==n&&(r.push(n),n=""),r.push(_o84)):n+=_o84;}return""!==n&&r.push(n),r;}},{key:"canBreakWords",value:function canBreakWords(_e632,t){return t;}},{key:"canBreakChars",value:function canBreakChars(_e633,t,r,n,i){return!0;}},{key:"wordWrapSplit",value:function wordWrapSplit(t){return e.graphemeSegmenter(t);}},{key:"measureFont",value:function measureFont(t){if(e._fonts[t])return e._fonts[t];var r={ascent:0,descent:0,fontSize:0},n=e._canvas,i=e._context;i.font=t;var o=e.METRICS_STRING+e.BASELINE_SYMBOL,a=Math.ceil(i.measureText(o).width);var s=Math.ceil(i.measureText(e.BASELINE_SYMBOL).width);var u=Math.ceil(e.HEIGHT_MULTIPLIER*s);if(s=s*e.BASELINE_MULTIPLIER|0,0===a||0===u)return e._fonts[t]=r,r;n.width=a,n.height=u,i.fillStyle="#f00",i.fillRect(0,0,a,u),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(o,0,s);var l=i.getImageData(0,0,a,u).data,c=l.length,h=4*a;var f=0,d=0,p=!1;for(f=0;f<s;++f){for(var _e636=0;_e636<h;_e636+=4)if(255!==l[d+_e636]){p=!0;break;}if(p)break;d+=h;}for(r.ascent=s-f,d=c-h,p=!1,f=u;f>s;--f){for(var _e637=0;_e637<h;_e637+=4)if(255!==l[d+_e637]){p=!0;break;}if(p)break;d-=h;}return r.descent=f-s,r.fontSize=r.ascent+r.descent,e._fonts[t]=r,r;}},{key:"clearMetrics",value:function clearMetrics(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";t?delete e._fonts[t]:e._fonts={};}},{key:"_canvas",get:function get(){if(!e.__canvas){var _t299;try{var _r$getContext;var r=new OffscreenCanvas(0,0);if((_r$getContext=r.getContext("2d",contextSettings))!==null&&_r$getContext!==void 0&&_r$getContext.measureText)return e.__canvas=r,r;_t299=_settings.ADAPTER.createCanvas();}catch(_unused15){_t299=_settings.ADAPTER.createCanvas();}_t299.width=_t299.height=10,e.__canvas=_t299;}return e.__canvas;}},{key:"_context",get:function get(){return e.__context||(e.__context=e._canvas.getContext("2d",contextSettings)),e.__context;}}]);}();_TextMetrics.METRICS_STRING="|ÉqÅ",_TextMetrics.BASELINE_SYMBOL="M",_TextMetrics.BASELINE_MULTIPLIER=1.4,_TextMetrics.HEIGHT_MULTIPLIER=2,_TextMetrics.graphemeSegmenter=function(_Intl){if("function"==typeof((_Intl=Intl)===null||_Intl===void 0?void 0:_Intl.Segmenter)){var _e638=new Intl.Segmenter();return function(t){return _toConsumableArray2(_e638.segment(t)).map(function(e){return e.segment;});};}return function(e){return _toConsumableArray2(e);};}(),_TextMetrics.experimentalLetterSpacing=!1,_TextMetrics._fonts={},_TextMetrics._newlines=[10,13],_TextMetrics._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var _TextMetrics2=_TextMetrics;var genericFontFamilies=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],_TextStyle=/*#__PURE__*/function(){function e(_e639){_classCallCheck2(this,e);this.styleID=0,this.reset(),deepCopyProperties(this,_e639,_e639);}return _createClass2(e,[{key:"clone",value:function clone(){var t={};return deepCopyProperties(t,this,e.defaultStyle),new e(t);}},{key:"reset",value:function reset(){deepCopyProperties(this,e.defaultStyle,e.defaultStyle);}},{key:"align",get:function get(){return this._align;},set:function set(_e640){this._align!==_e640&&(this._align=_e640,this.styleID++);}},{key:"breakWords",get:function get(){return this._breakWords;},set:function set(_e641){this._breakWords!==_e641&&(this._breakWords=_e641,this.styleID++);}},{key:"dropShadow",get:function get(){return this._dropShadow;},set:function set(_e642){this._dropShadow!==_e642&&(this._dropShadow=_e642,this.styleID++);}},{key:"dropShadowAlpha",get:function get(){return this._dropShadowAlpha;},set:function set(_e643){this._dropShadowAlpha!==_e643&&(this._dropShadowAlpha=_e643,this.styleID++);}},{key:"dropShadowAngle",get:function get(){return this._dropShadowAngle;},set:function set(_e644){this._dropShadowAngle!==_e644&&(this._dropShadowAngle=_e644,this.styleID++);}},{key:"dropShadowBlur",get:function get(){return this._dropShadowBlur;},set:function set(_e645){this._dropShadowBlur!==_e645&&(this._dropShadowBlur=_e645,this.styleID++);}},{key:"dropShadowColor",get:function get(){return this._dropShadowColor;},set:function set(_e646){var t=getColor(_e646);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++);}},{key:"dropShadowDistance",get:function get(){return this._dropShadowDistance;},set:function set(_e647){this._dropShadowDistance!==_e647&&(this._dropShadowDistance=_e647,this.styleID++);}},{key:"fill",get:function get(){return this._fill;},set:function set(_e648){var t=getColor(_e648);this._fill!==t&&(this._fill=t,this.styleID++);}},{key:"fillGradientType",get:function get(){return this._fillGradientType;},set:function set(_e649){this._fillGradientType!==_e649&&(this._fillGradientType=_e649,this.styleID++);}},{key:"fillGradientStops",get:function get(){return this._fillGradientStops;},set:function set(_e650){areArraysEqual(this._fillGradientStops,_e650)||(this._fillGradientStops=_e650,this.styleID++);}},{key:"fontFamily",get:function get(){return this._fontFamily;},set:function set(_e651){this.fontFamily!==_e651&&(this._fontFamily=_e651,this.styleID++);}},{key:"fontSize",get:function get(){return this._fontSize;},set:function set(_e652){this._fontSize!==_e652&&(this._fontSize=_e652,this.styleID++);}},{key:"fontStyle",get:function get(){return this._fontStyle;},set:function set(_e653){this._fontStyle!==_e653&&(this._fontStyle=_e653,this.styleID++);}},{key:"fontVariant",get:function get(){return this._fontVariant;},set:function set(_e654){this._fontVariant!==_e654&&(this._fontVariant=_e654,this.styleID++);}},{key:"fontWeight",get:function get(){return this._fontWeight;},set:function set(_e655){this._fontWeight!==_e655&&(this._fontWeight=_e655,this.styleID++);}},{key:"letterSpacing",get:function get(){return this._letterSpacing;},set:function set(_e656){this._letterSpacing!==_e656&&(this._letterSpacing=_e656,this.styleID++);}},{key:"lineHeight",get:function get(){return this._lineHeight;},set:function set(_e657){this._lineHeight!==_e657&&(this._lineHeight=_e657,this.styleID++);}},{key:"leading",get:function get(){return this._leading;},set:function set(_e658){this._leading!==_e658&&(this._leading=_e658,this.styleID++);}},{key:"lineJoin",get:function get(){return this._lineJoin;},set:function set(_e659){this._lineJoin!==_e659&&(this._lineJoin=_e659,this.styleID++);}},{key:"miterLimit",get:function get(){return this._miterLimit;},set:function set(_e660){this._miterLimit!==_e660&&(this._miterLimit=_e660,this.styleID++);}},{key:"padding",get:function get(){return this._padding;},set:function set(_e661){this._padding!==_e661&&(this._padding=_e661,this.styleID++);}},{key:"stroke",get:function get(){return this._stroke;},set:function set(_e662){var t=getColor(_e662);this._stroke!==t&&(this._stroke=t,this.styleID++);}},{key:"strokeThickness",get:function get(){return this._strokeThickness;},set:function set(_e663){this._strokeThickness!==_e663&&(this._strokeThickness=_e663,this.styleID++);}},{key:"textBaseline",get:function get(){return this._textBaseline;},set:function set(_e664){this._textBaseline!==_e664&&(this._textBaseline=_e664,this.styleID++);}},{key:"trim",get:function get(){return this._trim;},set:function set(_e665){this._trim!==_e665&&(this._trim=_e665,this.styleID++);}},{key:"whiteSpace",get:function get(){return this._whiteSpace;},set:function set(_e666){this._whiteSpace!==_e666&&(this._whiteSpace=_e666,this.styleID++);}},{key:"wordWrap",get:function get(){return this._wordWrap;},set:function set(_e667){this._wordWrap!==_e667&&(this._wordWrap=_e667,this.styleID++);}},{key:"wordWrapWidth",get:function get(){return this._wordWrapWidth;},set:function set(_e668){this._wordWrapWidth!==_e668&&(this._wordWrapWidth=_e668,this.styleID++);}},{key:"toFontString",value:function toFontString(){var _e669="number"==typeof this.fontSize?"".concat(this.fontSize,"px"):this.fontSize;var t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(var _e671=t.length-1;_e671>=0;_e671--){var r=t[_e671].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!genericFontFamilies.includes(r)&&(r="\"".concat(r,"\"")),t[_e671]=r;}return"".concat(this.fontStyle," ").concat(this.fontVariant," ").concat(this.fontWeight," ").concat(_e669," ").concat(t.join(","));}}]);}();_TextStyle.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:_TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};var _TextStyle2=_TextStyle;function getColor(e){var t=_Color2.shared,r=function r(e){var r=t.setValue(e);return 1===r.alpha?r.toHex():r.toRgbaString();};return Array.isArray(e)?e.map(r):r(e);}function areArraysEqual(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0;}function deepCopyProperties(e,t,r){for(var n in r)Array.isArray(t[n])?e[n]=t[n].slice():e[n]=t[n];}var defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},_Text=/*#__PURE__*/function(_Sprite2){function e(t,r,n){var _e$defaultResolution;var _this131;_classCallCheck2(this,e);var i=!1;n||(n=_settings.ADAPTER.createCanvas(),i=!0),n.width=3,n.height=3;var o=Texture_Texture.from(n);o.orig=new _Rectangle(),o.trim=new _Rectangle(),_this131=_callSuper2(this,e,[o]),_this131._ownCanvas=i,_this131.canvas=n,_this131.context=n.getContext("2d",{willReadFrequently:!0}),_this131._resolution=(_e$defaultResolution=e.defaultResolution)!==null&&_e$defaultResolution!==void 0?_e$defaultResolution:_settings.RESOLUTION,_this131._autoResolution=e.defaultAutoResolution,_this131._text=null,_this131._style=null,_this131._styleListener=null,_this131._font="",_this131.text=t,_this131.style=r,_this131.localStyleID=-1;return _this131;}_inherits2(e,_Sprite2);return _createClass2(e,[{key:"updateText",value:function updateText(_e673){var t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&_e673)return;this._font=this._style.toFontString();var r=this.context,n=_TextMetrics2.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),i=n.width,o=n.height,a=n.lines,s=n.lineHeight,u=n.lineWidths,l=n.maxLineWidth,c=n.fontProperties;var h,f;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,i)+2*t.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+2*t.padding)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=t.strokeThickness,r.textBaseline=t.textBaseline,r.lineJoin=t.lineJoin,r.miterLimit=t.miterLimit;var d=t.dropShadow?2:1;for(var _e694=0;_e694<d;++_e694){var _i123=t.dropShadow&&0===_e694,_d15=_i123?Math.ceil(Math.max(1,o)+2*t.padding):0,_p14=_d15*this._resolution;if(_i123){r.fillStyle="black",r.strokeStyle="black";var _e675=t.dropShadowColor,_n166=t.dropShadowBlur*this._resolution,_i124=t.dropShadowDistance*this._resolution;r.shadowColor=_Color2.shared.setValue(_e675).setAlpha(t.dropShadowAlpha).toRgbaString(),r.shadowBlur=_n166,r.shadowOffsetX=Math.cos(t.dropShadowAngle)*_i124,r.shadowOffsetY=Math.sin(t.dropShadowAngle)*_i124+_p14;}else r.fillStyle=this._generateFillStyle(t,a,n),r.strokeStyle=t.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;var _y10=(s-c.fontSize)/2;s-c.fontSize<0&&(_y10=0);for(var _e695=0;_e695<a.length;_e695++)h=t.strokeThickness/2,f=t.strokeThickness/2+_e695*s+c.ascent+_y10,"right"===t.align?h+=l-u[_e695]:"center"===t.align&&(h+=(l-u[_e695])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(a[_e695],h+t.padding,f+t.padding-_d15,!0),t.fill&&this.drawLetterSpacing(a[_e695],h+t.padding,f+t.padding-_d15);}this.updateTexture();}},{key:"drawLetterSpacing",value:function drawLetterSpacing(_e677,t,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1;var i=this._style.letterSpacing;var o=!1;if(_TextMetrics2.experimentalLetterSpacingSupported&&(_TextMetrics2.experimentalLetterSpacing?(this.context.letterSpacing="".concat(i,"px"),this.context.textLetterSpacing="".concat(i,"px"),o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),0===i||o)return void(n?this.context.strokeText(_e677,t,r):this.context.fillText(_e677,t,r));var a=t;var s=_TextMetrics2.graphemeSegmenter(_e677);var u=this.context.measureText(_e677).width,l=0;for(var _e696=0;_e696<s.length;++_e696){var _t300=s[_e696];n?this.context.strokeText(_t300,a,r):this.context.fillText(_t300,a,r);var _o85="";for(var _t301=_e696+1;_t301<s.length;++_t301)_o85+=s[_t301];l=this.context.measureText(_o85).width,a+=u-l+i,u=l;}}},{key:"updateTexture",value:function updateTexture(){var _e679=this.canvas;if(this._style.trim){var _t302=_trimCanvas(_e679);_t302.data&&(_e679.width=_t302.width,_e679.height=_t302.height,this.context.putImageData(_t302.data,0,0));}var t=this._texture,r=this._style,n=r.trim?0:r.padding,i=t.baseTexture;t.trim.width=t._frame.width=_e679.width/this._resolution,t.trim.height=t._frame.height=_e679.height/this._resolution,t.trim.x=-n,t.trim.y=-n,t.orig.width=t._frame.width-2*n,t.orig.height=t._frame.height-2*n,this._onTextureUpdate(),i.setRealSize(_e679.width,_e679.height,this._resolution),t.updateUvs(),this.dirty=!1;}},{key:"_render",value:function _render(_e680){this._autoResolution&&this._resolution!==_e680.resolution&&(this._resolution=_e680.resolution,this.dirty=!0),this.updateText(!0),_superPropGet2(e,"_render",this,3)([_e680]);}},{key:"updateTransform",value:function updateTransform(){this.updateText(!0),_superPropGet2(e,"updateTransform",this,3)([]);}},{key:"getBounds",value:function getBounds(_e681,t){return this.updateText(!0),-1===this._textureID&&(_e681=!1),_superPropGet2(e,"getBounds",this,3)([_e681,t]);}},{key:"getLocalBounds",value:function getLocalBounds(_e682){return this.updateText(!0),_superPropGet2(e,"getLocalBounds",this,1).call(this,_e682);}},{key:"_calculateBounds",value:function _calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData);}},{key:"_generateFillStyle",value:function _generateFillStyle(_e683,t,r){var n=_e683.fill;if(!Array.isArray(n))return n;if(1===n.length)return n[0];var i;var o=_e683.dropShadow?_e683.dropShadowDistance:0,a=_e683.padding||0,s=this.canvas.width/this._resolution-o-2*a,u=this.canvas.height/this._resolution-o-2*a,l=n.slice(),c=_e683.fillGradientStops.slice();if(!c.length){var _e684=l.length+1;for(var _t303=1;_t303<_e684;++_t303)c.push(_t303/_e684);}if(l.unshift(n[0]),c.unshift(0),l.push(n[n.length-1]),c.push(1),_e683.fillGradientType===_TEXT_GRADIENT.LINEAR_VERTICAL){i=this.context.createLinearGradient(s/2,a,s/2,u+a);var _n167=r.fontProperties.fontSize+_e683.strokeThickness;for(var _e697=0;_e697<t.length;_e697++){var _o86=r.lineHeight*(_e697-1)+_n167,_a73=r.lineHeight*_e697;var _s54=_a73;_e697>0&&_o86>_a73&&(_s54=(_a73+_o86)/2);var _h23=_a73+_n167,_f17=r.lineHeight*(_e697+1);var _d16=_h23;_e697+1<t.length&&_f17<_h23&&(_d16=(_h23+_f17)/2);var _p15=(_d16-_s54)/u;for(var _e698=0;_e698<l.length;_e698++){var _t304=0;_t304="number"==typeof c[_e698]?c[_e698]:_e698/l.length;var _r254=Math.min(1,Math.max(0,_s54/u+_t304*_p15));_r254=Number(_r254.toFixed(5)),i.addColorStop(_r254,l[_e698]);}}}else{i=this.context.createLinearGradient(a,u/2,s+a,u/2);var _e687=l.length+1;var _t305=1;for(var _r255=0;_r255<l.length;_r255++){var _n168=void 0;_n168="number"==typeof c[_r255]?c[_r255]:_t305/_e687,i.addColorStop(_n168,l[_r255]),_t305++;}}return i;}},{key:"destroy",value:function destroy(_e688){"boolean"==typeof _e688&&(_e688={children:_e688}),_e688=Object.assign({},defaultDestroyOptions,_e688),_superPropGet2(e,"destroy",this,3)([_e688]),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null;}},{key:"width",get:function get(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width;},set:function set(_e689){this.updateText(!0);var t=_sign(this.scale.x)||1;this.scale.x=t*_e689/this._texture.orig.width,this._width=_e689;}},{key:"height",get:function get(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height;},set:function set(_e690){this.updateText(!0);var t=_sign(this.scale.y)||1;this.scale.y=t*_e690/this._texture.orig.height,this._height=_e690;}},{key:"style",get:function get(){return this._style;},set:function set(_e691){_e691=_e691||{},this._style=_e691 instanceof _TextStyle2?_e691:new _TextStyle2(_e691),this.localStyleID=-1,this.dirty=!0;}},{key:"text",get:function get(){return this._text;},set:function set(_e692){var _e699;_e692=String((_e699=_e692)!==null&&_e699!==void 0?_e699:""),this._text!==_e692&&(this._text=_e692,this.dirty=!0);}},{key:"resolution",get:function get(){return this._resolution;},set:function set(_e693){this._autoResolution=!1,this._resolution!==_e693&&(this._resolution=_e693,this.dirty=!0);}}],[{key:"experimentalLetterSpacing",get:function get(){return _TextMetrics2.experimentalLetterSpacing;},set:function set(_e672){_deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),_TextMetrics2.experimentalLetterSpacing=_e672;}}]);}(_Sprite);_Text.defaultAutoResolution=!0;var _Text2=_Text;var _CountLimiter=/*#__PURE__*/function(){function _CountLimiter(e){_classCallCheck2(this,_CountLimiter);this.maxItemsPerFrame=e,this.itemsLeft=0;}return _createClass2(_CountLimiter,[{key:"beginFrame",value:function beginFrame(){this.itemsLeft=this.maxItemsPerFrame;}},{key:"allowedToUpload",value:function allowedToUpload(){return this.itemsLeft-->0;}}]);}();function findMultipleBaseTextures(e,t){var _e$_textures;var r=!1;if(e!==null&&e!==void 0&&(_e$_textures=e._textures)!==null&&_e$_textures!==void 0&&_e$_textures.length)for(var n=0;n<e._textures.length;n++)if(e._textures[n]instanceof Texture_Texture){var i=e._textures[n].baseTexture;t.includes(i)||(t.push(i),r=!0);}return r;}function findBaseTexture(e,t){if(e.baseTexture instanceof _BaseTexture2){var r=e.baseTexture;return t.includes(r)||t.push(r),!0;}return!1;}function findTexture(e,t){if(e._texture&&e._texture instanceof Texture_Texture){var r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0;}return!1;}function drawText(e,t){return t instanceof _Text2&&(t.updateText(!0),!0);}function calculateTextStyle(e,t){if(t instanceof _TextStyle2){var _e700=t.toFontString();return _TextMetrics2.measureFont(_e700),!0;}return!1;}function findText(e,t){if(e instanceof _Text2){t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e);var r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0;}return!1;}function findTextStyle(e,t){return e instanceof _TextStyle2&&(t.includes(e)||t.push(e),!0);}var _BasePrepare=/*#__PURE__*/function(){function e(t){var _this132=this;_classCallCheck2(this,e);this.limiter=new _CountLimiter(e.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){_this132.queue&&_this132.prepareItems();},this.registerFindHook(findText),this.registerFindHook(findTextStyle),this.registerFindHook(findMultipleBaseTextures),this.registerFindHook(findBaseTexture),this.registerFindHook(findTexture),this.registerUploadHook(drawText),this.registerUploadHook(calculateTextStyle);}return _createClass2(e,[{key:"upload",value:function upload(_e701){var _this133=this;return new Promise(function(t){_e701&&_this133.add(_e701),_this133.queue.length?(_this133.completes.push(t),_this133.ticking||(_this133.ticking=!0,_Ticker2.system.addOnce(_this133.tick,_this133,_UPDATE_PRIORITY.UTILITY))):t();});}},{key:"tick",value:function tick(){setTimeout(this.delayedTick,0);}},{key:"prepareItems",value:function prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var _e702=this.queue[0];var _t306=!1;if(_e702&&!_e702._destroyed)for(var r=0,n=this.uploadHooks.length;r<n;r++)if(this.uploadHooks[r](this.uploadHookHelper,_e702)){this.queue.shift(),_t306=!0;break;}_t306||this.queue.shift();}if(this.queue.length)_Ticker2.system.addOnce(this.tick,this,_UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;var _e703=this.completes.slice(0);this.completes.length=0;for(var _t307=0,_r256=_e703.length;_t307<_r256;_t307++)_e703[_t307]();}}},{key:"registerFindHook",value:function registerFindHook(_e704){return _e704&&this.addHooks.push(_e704),this;}},{key:"registerUploadHook",value:function registerUploadHook(_e705){return _e705&&this.uploadHooks.push(_e705),this;}},{key:"add",value:function add(_e706){for(var _t308=0,r=this.addHooks.length;_t308<r&&!this.addHooks[_t308](_e706,this.queue);_t308++);if(_e706 instanceof _Container2)for(var _t309=_e706.children.length-1;_t309>=0;_t309--)this.add(_e706.children[_t309]);return this;}},{key:"destroy",value:function destroy(){this.ticking&&_Ticker2.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null;}}]);}();_BasePrepare.uploadsPerFrame=4;var _BasePrepare2=_BasePrepare;function uploadBaseTextures(e,t){return t instanceof _BaseTexture2&&(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0);}function uploadGraphics(e,t){if(!(t instanceof _Graphics2))return!1;var r=t.geometry;t.finishPoly(),r.updateBatches();var n=r.batches;for(var _t310=0;_t310<n.length;_t310++){var _r257=n[_t310].style.texture;_r257&&uploadBaseTextures(e,_r257.baseTexture);}return r.batchable||e.geometry.bind(r,t._resolveDirectShader(e)),!0;}function findGraphics(e,t){return e instanceof _Graphics2&&(t.push(e),!0);}Object.defineProperties(_settings,{UPLOADS_PER_FRAME:{get:function get(){return _BasePrepare2.uploadsPerFrame;},set:function set(e){_deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),_BasePrepare2.uploadsPerFrame=e;}}});var _Prepare=/*#__PURE__*/function(_BasePrepare3){function _Prepare(e){var _this134;_classCallCheck2(this,_Prepare);_this134=_callSuper2(this,_Prepare,[e]),_this134.uploadHookHelper=_this134.renderer,_this134.registerFindHook(findGraphics),_this134.registerUploadHook(uploadBaseTextures),_this134.registerUploadHook(uploadGraphics);return _this134;}_inherits2(_Prepare,_BasePrepare3);return _createClass2(_Prepare);}(_BasePrepare2);_Prepare.extension={name:"prepare",type:_ExtensionType.RendererSystem},_extensions.add(_Prepare);var _TimeLimiter=/*#__PURE__*/function(){function _TimeLimiter(e){_classCallCheck2(this,_TimeLimiter);this.maxMilliseconds=e,this.frameStart=0;}return _createClass2(_TimeLimiter,[{key:"beginFrame",value:function beginFrame(){this.frameStart=Date.now();}},{key:"allowedToUpload",value:function allowedToUpload(){return Date.now()-this.frameStart<this.maxMilliseconds;}}]);}();var _AnimatedSprite=/*#__PURE__*/function(_Sprite3){function _AnimatedSprite(e){var _this135;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;_classCallCheck2(this,_AnimatedSprite);_this135=_callSuper2(this,_AnimatedSprite,[e[0]instanceof Texture_Texture?e[0]:e[0].texture]),_this135._textures=null,_this135._durations=null,_this135._autoUpdate=t,_this135._isConnectedToTicker=!1,_this135.animationSpeed=1,_this135.loop=!0,_this135.updateAnchor=!1,_this135.onComplete=null,_this135.onFrameChange=null,_this135.onLoop=null,_this135._currentTime=0,_this135._playing=!1,_this135._previousFrame=null,_this135.textures=e;return _this135;}_inherits2(_AnimatedSprite,_Sprite3);return _createClass2(_AnimatedSprite,[{key:"stop",value:function stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(_Ticker2.shared.remove(this.update,this),this._isConnectedToTicker=!1));}},{key:"play",value:function play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(_Ticker2.shared.add(this.update,this,_UPDATE_PRIORITY.HIGH),this._isConnectedToTicker=!0));}},{key:"gotoAndStop",value:function gotoAndStop(e){this.stop(),this.currentFrame=e;}},{key:"gotoAndPlay",value:function gotoAndPlay(e){this.currentFrame=e,this.play();}},{key:"update",value:function update(e){if(!this._playing)return;var t=this.animationSpeed*e,r=this.currentFrame;if(null!==this._durations){var _r258=this._currentTime%1*this._durations[this.currentFrame];for(_r258+=t/60*1e3;_r258<0;)this._currentTime--,_r258+=this._durations[this.currentFrame];var n=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);_r258>=this._durations[this.currentFrame];)_r258-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=_r258/this._durations[this.currentFrame];}else this._currentTime+=t;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this.updateTexture());}},{key:"updateTexture",value:function updateTexture(){var e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame));}},{key:"destroy",value:function destroy(e){this.stop(),_superPropGet2(_AnimatedSprite,"destroy",this,3)([e]),this.onComplete=null,this.onFrameChange=null,this.onLoop=null;}},{key:"totalFrames",get:function get(){return this._textures.length;}},{key:"textures",get:function get(){return this._textures;},set:function set(e){if(e[0]instanceof Texture_Texture)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var _t311=0;_t311<e.length;_t311++)this._textures.push(e[_t311].texture),this._durations.push(e[_t311].time);}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture();}},{key:"currentFrame",get:function get(){var e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e;},set:function set(e){if(e<0||e>this.totalFrames-1)throw new Error("[AnimatedSprite]: Invalid frame index value ".concat(e,", expected to be between 0 and totalFrames ").concat(this.totalFrames,"."));var t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture();}},{key:"playing",get:function get(){return this._playing;}},{key:"autoUpdate",get:function get(){return this._autoUpdate;},set:function set(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(_Ticker2.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(_Ticker2.shared.add(this.update,this),this._isConnectedToTicker=!0));}}],[{key:"fromFrames",value:function fromFrames(e){var t=[];for(var r=0;r<e.length;++r)t.push(Texture_Texture.from(e[r]));return new _AnimatedSprite(t);}},{key:"fromImages",value:function fromImages(e){var t=[];for(var r=0;r<e.length;++r)t.push(Texture_Texture.from(e[r]));return new _AnimatedSprite(t);}}]);}(_Sprite);var TilingSprite_tempPoint=new _Point();var _TilingSprite=/*#__PURE__*/function(_Sprite4){function _TilingSprite(e){var _this136;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:100;_classCallCheck2(this,_TilingSprite);_this136=_callSuper2(this,_TilingSprite,[e]),_this136.tileTransform=new _Transform2(),_this136._width=t,_this136._height=r,_this136.uvMatrix=_this136.texture.uvMatrix||new _TextureMatrix(e),_this136.pluginName="tilingSprite",_this136.uvRespectAnchor=!1;return _this136;}_inherits2(_TilingSprite,_Sprite4);return _createClass2(_TilingSprite,[{key:"clampMargin",get:function get(){return this.uvMatrix.clampMargin;},set:function set(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0);}},{key:"tileScale",get:function get(){return this.tileTransform.scale;},set:function set(e){this.tileTransform.scale.copyFrom(e);}},{key:"tilePosition",get:function get(){return this.tileTransform.position;},set:function set(e){this.tileTransform.position.copyFrom(e);}},{key:"_onTextureUpdate",value:function _onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215;}},{key:"_render",value:function _render(e){var t=this._texture;!t||!t.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this));}},{key:"_calculateBounds",value:function _calculateBounds(){var e=this._width*-this._anchor._x,t=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),n=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,t,r,n);}},{key:"getLocalBounds",value:function getLocalBounds(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new _Rectangle()),e=this._localBoundsRect),this._bounds.getRectangle(e)):_superPropGet2(_TilingSprite,"getLocalBounds",this,1).call(this,e);}},{key:"containsPoint",value:function containsPoint(e){this.worldTransform.applyInverse(e,TilingSprite_tempPoint);var t=this._width,r=this._height,n=-t*this.anchor._x;if(TilingSprite_tempPoint.x>=n&&TilingSprite_tempPoint.x<n+t){var _e707=-r*this.anchor._y;if(TilingSprite_tempPoint.y>=_e707&&TilingSprite_tempPoint.y<_e707+r)return!0;}return!1;}},{key:"destroy",value:function destroy(e){_superPropGet2(_TilingSprite,"destroy",this,3)([e]),this.tileTransform=null,this.uvMatrix=null;}},{key:"width",get:function get(){return this._width;},set:function set(e){this._width=e;}},{key:"height",get:function get(){return this._height;},set:function set(e){this._height=e;}}],[{key:"from",value:function from(e,t){var r=e instanceof Texture_Texture?e:Texture_Texture.from(e,t);return new _TilingSprite(r,t.width,t.height);}}]);}(_Sprite);var gl2FragmentSrc="#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",gl2VertexSrc="#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",gl1FragmentSrc="#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",gl1VertexSrc="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",fragmentSimpleSrc="#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n";var TilingSpriteRenderer_tempMat=new _Matrix();var _TilingSpriteRenderer=/*#__PURE__*/function(_ObjectRenderer4){function _TilingSpriteRenderer(e){var _this137;_classCallCheck2(this,_TilingSpriteRenderer);_this137=_callSuper2(this,_TilingSpriteRenderer,[e]),e.runners.contextChange.add(_assertThisInitialized2(_this137)),_this137.quad=new _QuadUv(),_this137.state=_State.for2d();return _this137;}_inherits2(_TilingSpriteRenderer,_ObjectRenderer4);return _createClass2(_TilingSpriteRenderer,[{key:"contextChange",value:function contextChange(){var e=this.renderer,t={globals:e.globalUniforms};this.simpleShader=_Shader.from(gl1VertexSrc,fragmentSimpleSrc,t),this.shader=e.context.webGLVersion>1?_Shader.from(gl2VertexSrc,gl2FragmentSrc,t):_Shader.from(gl1VertexSrc,gl1FragmentSrc,t);}},{key:"render",value:function render(e){var t=this.renderer,r=this.quad;var n=r.vertices;n[0]=n[6]=e._width*-e.anchor.x,n[1]=n[3]=e._height*-e.anchor.y,n[2]=n[4]=e._width*(1-e.anchor.x),n[5]=n[7]=e._height*(1-e.anchor.y);var i=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;n=r.uvs,n[0]=n[6]=-i,n[1]=n[3]=-o,n[2]=n[4]=1-i,n[5]=n[7]=1-o,r.invalidate();var a=e._texture,s=a.baseTexture,u=s.alphaMode>0,l=e.tileTransform.localTransform,c=e.uvMatrix;var h=s.isPowerOfTwo&&a.frame.width===s.width&&a.frame.height===s.height;h&&(s._glTextures[t.CONTEXT_UID]?h=s.wrapMode!==_WRAP_MODES.CLAMP:s.wrapMode===_WRAP_MODES.CLAMP&&(s.wrapMode=_WRAP_MODES.REPEAT));var f=h?this.simpleShader:this.shader,d=a.width,p=a.height,y=e._width,m=e._height;TilingSpriteRenderer_tempMat.set(l.a*d/y,l.b*d/m,l.c*p/y,l.d*p/m,l.tx/y,l.ty/m),TilingSpriteRenderer_tempMat.invert(),h?TilingSpriteRenderer_tempMat.prepend(c.mapCoord):(f.uniforms.uMapCoord=c.mapCoord.toArray(!0),f.uniforms.uClampFrame=c.uClampFrame,f.uniforms.uClampOffset=c.uClampOffset),f.uniforms.uTransform=TilingSpriteRenderer_tempMat.toArray(!0),f.uniforms.uColor=_Color2.shared.setValue(e.tint).premultiply(e.worldAlpha,u).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,t.shader.bind(f),t.geometry.bind(r),this.state.blendMode=_correctBlendMode(e.blendMode,u),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0);}}]);}(_ObjectRenderer);_TilingSpriteRenderer.extension={name:"tilingSprite",type:_ExtensionType.RendererPlugin},_extensions.add(_TilingSpriteRenderer);var _Spritesheet=/*#__PURE__*/function(){function e(_e708,t,r){_classCallCheck2(this,e);this.linkedSheets=[],(_e708 instanceof _BaseTexture2||_e708 instanceof Texture_Texture)&&(_e708={texture:_e708,data:t,resolutionFilename:r});var _e715=_e708,n=_e715.texture,i=_e715.data,_e715$resolutionFilen=_e715.resolutionFilename,o=_e715$resolutionFilen===void 0?null:_e715$resolutionFilen,_e715$cachePrefix=_e715.cachePrefix,a=_e715$cachePrefix===void 0?"":_e715$cachePrefix;this.cachePrefix=a,this._texture=n instanceof Texture_Texture?n:null,this.baseTexture=n instanceof _BaseTexture2?n:this._texture.baseTexture,this.textures={},this.animations={},this.data=i;var s=this.baseTexture.resource;this.resolution=this._updateResolution(o||(s?s.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null;}return _createClass2(e,[{key:"_updateResolution",value:function _updateResolution(){var _e709=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var t=this.data.meta.scale;var r=_getResolutionOfUrl(_e709,null);return null===r&&(r="number"==typeof t?t:parseFloat(t!==null&&t!==void 0?t:"1")),1!==r&&this.baseTexture.setResolution(r),r;}},{key:"parse",value:function parse(){var _this138=this;return new Promise(function(t){_this138._callback=t,_this138._batchIndex=0,_this138._frameKeys.length<=e.BATCH_SIZE?(_this138._processFrames(0),_this138._processAnimations(),_this138._parseComplete()):_this138._nextBatch();});}},{key:"_processFrames",value:function _processFrames(t){var r=t;var n=e.BATCH_SIZE;for(;r-t<n&&r<this._frameKeys.length;){var _e710=this._frameKeys[r],_t312=this._frames[_e710],_n169=_t312.frame;if(_n169){var _r259=null,i=null;var _o87=!1!==_t312.trimmed&&_t312.sourceSize?_t312.sourceSize:_t312.frame,_a74=new _Rectangle(0,0,Math.floor(_o87.w)/this.resolution,Math.floor(_o87.h)/this.resolution);_r259=_t312.rotated?new _Rectangle(Math.floor(_n169.x)/this.resolution,Math.floor(_n169.y)/this.resolution,Math.floor(_n169.h)/this.resolution,Math.floor(_n169.w)/this.resolution):new _Rectangle(Math.floor(_n169.x)/this.resolution,Math.floor(_n169.y)/this.resolution,Math.floor(_n169.w)/this.resolution,Math.floor(_n169.h)/this.resolution),!1!==_t312.trimmed&&_t312.spriteSourceSize&&(i=new _Rectangle(Math.floor(_t312.spriteSourceSize.x)/this.resolution,Math.floor(_t312.spriteSourceSize.y)/this.resolution,Math.floor(_n169.w)/this.resolution,Math.floor(_n169.h)/this.resolution)),this.textures[_e710]=new Texture_Texture(this.baseTexture,_r259,_a74,i,_t312.rotated?2:0,_t312.anchor,_t312.borders),Texture_Texture.addToCache(this.textures[_e710],this.cachePrefix+_e710.toString());}r++;}}},{key:"_processAnimations",value:function _processAnimations(){var _e711=this.data.animations||{};for(var _t313 in _e711){this.animations[_t313]=[];for(var r=0;r<_e711[_t313].length;r++){var n=_e711[_t313][r];this.animations[_t313].push(this.textures[n]);}}}},{key:"_parseComplete",value:function _parseComplete(){var _e712=this._callback;this._callback=null,this._batchIndex=0,_e712.call(this,this.textures);}},{key:"_nextBatch",value:function _nextBatch(){var _this139=this;this._processFrames(this._batchIndex*e.BATCH_SIZE),this._batchIndex++,setTimeout(function(){_this139._batchIndex*e.BATCH_SIZE<_this139._frameKeys.length?_this139._nextBatch():(_this139._processAnimations(),_this139._parseComplete());},0);}},{key:"destroy",value:function destroy(){var _this$_texture;var _e713=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;for(var _e716 in this.textures)this.textures[_e716].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,_e713&&((_this$_texture=this._texture)!==null&&_this$_texture!==void 0&&_this$_texture.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[];}}]);}();_Spritesheet.BATCH_SIZE=1e3;var _Spritesheet2=_Spritesheet;var validImages=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function _getCacheableAssets(e,t,r){var n={};if(e.forEach(function(e){n[e]=t;}),Object.keys(t.textures).forEach(function(e){n["".concat(t.cachePrefix).concat(e)]=t.textures[e];}),!r){var _r260=_path.dirname(e[0]);t.linkedSheets.forEach(function(e,i){Object.assign(n,_getCacheableAssets(["".concat(_r260,"/").concat(t.data.meta.related_multi_packs[i])],e,!0));});}return n;}var _spritesheetAsset={extension:_ExtensionType.Asset,cache:{test:function test(e){return e instanceof _Spritesheet2;},getCacheableAssets:function getCacheableAssets(e,t){return _getCacheableAssets(e,t,!1);}},resolver:{test:function test(e){var t=e.split("?")[0].split("."),r=t.pop(),n=t.pop();return"json"===r&&validImages.includes(n);},parse:function parse(e){var _settings$RETINA_PREF8,_settings$RETINA_PREF9;var t=e.split(".");return{resolution:parseFloat((_settings$RETINA_PREF8=(_settings$RETINA_PREF9=_settings.RETINA_PREFIX.exec(e))===null||_settings$RETINA_PREF9===void 0?void 0:_settings$RETINA_PREF9[1])!==null&&_settings$RETINA_PREF8!==void 0?_settings$RETINA_PREF8:"1"),format:t[t.length-2],src:e};}},loader:{name:"spritesheetLoader",extension:{type:_ExtensionType.LoadParser,priority:_LoaderParserPriority.Normal},testParse:function(){var _testParse2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee124(e,t){return _regeneratorRuntime2().wrap(function _callee124$(_context128){while(1)switch(_context128.prev=_context128.next){case 0:return _context128.abrupt("return",".json"===_path.extname(t.src).toLowerCase()&&!!e.frames);case 1:case"end":return _context128.stop();}},_callee124);}));function testParse(_x146,_x147){return _testParse2.apply(this,arguments);}return testParse;}(),parse:function parse(e,t,r){return _asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee125(){var _t$data6,_e$meta;var _ref63,n,i,o,a,s,_n170,u,l,_e717,_iterator49,_step49,_t$data7,_n172,_i125,_n171;return _regeneratorRuntime2().wrap(function _callee125$(_context129){while(1)switch(_context129.prev=_context129.next){case 0:_ref63=(_t$data6=t===null||t===void 0?void 0:t.data)!==null&&_t$data6!==void 0?_t$data6:{},n=_ref63.texture,i=_ref63.imageFilename,o=_ref63.cachePrefix;s=_path.dirname(t.src);if(!(s&&s.lastIndexOf("/")!==s.length-1&&(s+="/"),n&&n.baseTexture)){_context129.next=6;break;}a=n;_context129.next=11;break;case 6:_n170=_copySearchParams(s+(i!==null&&i!==void 0?i:e.meta.image),t.src);_context129.next=9;return r.load([_n170]);case 9:_context129.t0=_n170;a=_context129.sent[_context129.t0];case 11:u=new _Spritesheet2({texture:a.baseTexture,data:e,resolutionFilename:t.src,cachePrefix:o});_context129.next=14;return u.parse();case 14:l=e===null||e===void 0||(_e$meta=e.meta)===null||_e$meta===void 0?void 0:_e$meta.related_multi_packs;if(!Array.isArray(l)){_context129.next=40;break;}_e717=[];_iterator49=_createForOfIteratorHelper2(l);_context129.prev=18;_iterator49.s();case 20:if((_step49=_iterator49.n()).done){_context129.next=28;break;}_n172=_step49.value;if(!("string"!=typeof _n172)){_context129.next=24;break;}return _context129.abrupt("continue",26);case 24:_i125=s+_n172;((_t$data7=t.data)===null||_t$data7===void 0?void 0:_t$data7.ignoreMultiPack)||(_i125=_copySearchParams(_i125,t.src),_e717.push(r.load({src:_i125,data:{ignoreMultiPack:!0}})));case 26:_context129.next=20;break;case 28:_context129.next=33;break;case 30:_context129.prev=30;_context129.t1=_context129["catch"](18);_iterator49.e(_context129.t1);case 33:_context129.prev=33;_iterator49.f();return _context129.finish(33);case 36:_context129.next=38;return Promise.all(_e717);case 38:_n171=_context129.sent;u.linkedSheets=_n171,_n171.forEach(function(e){e.linkedSheets=[u].concat(u.linkedSheets.filter(function(t){return t!==e;}));});case 40:return _context129.abrupt("return",u);case 41:case"end":return _context129.stop();}},_callee125,null,[[18,30,33,36]]);}))();},unload:function unload(e){e.destroy(!0);}}};_extensions.add(_spritesheetAsset);var _BitmapFontData=/*#__PURE__*/_createClass2(function _BitmapFontData(){_classCallCheck2(this,_BitmapFontData);this.info=[],this.common=[],this.page=[],this["char"]=[],this.kerning=[],this.distanceField=[];});var _TextFormat=/*#__PURE__*/function(){function _TextFormat(){_classCallCheck2(this,_TextFormat);}return _createClass2(_TextFormat,null,[{key:"test",value:function test(e){return"string"==typeof e&&e.startsWith("info face=");}},{key:"parse",value:function parse(e){var t=e.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],"char":[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var _e718 in t){var _n173=t[_e718].match(/^[a-z]+/gm)[0],i=t[_e718].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),_o88={};for(var _e719 in i){var _t314=i[_e719].split("="),_r261=_t314[0],_n174=_t314[1].replace(/"/gm,""),_a75=parseFloat(_n174),_s55=isNaN(_a75)?_n174:_a75;_o88[_r261]=_s55;}r[_n173].push(_o88);}var n=new _BitmapFontData();return r.info.forEach(function(e){return n.info.push({face:e.face,size:parseInt(e.size,10)});}),r.common.forEach(function(e){return n.common.push({lineHeight:parseInt(e.lineHeight,10)});}),r.page.forEach(function(e){return n.page.push({id:parseInt(e.id,10),file:e.file});}),r["char"].forEach(function(e){return n["char"].push({id:parseInt(e.id,10),page:parseInt(e.page,10),x:parseInt(e.x,10),y:parseInt(e.y,10),width:parseInt(e.width,10),height:parseInt(e.height,10),xoffset:parseInt(e.xoffset,10),yoffset:parseInt(e.yoffset,10),xadvance:parseInt(e.xadvance,10)});}),r.kerning.forEach(function(e){return n.kerning.push({first:parseInt(e.first,10),second:parseInt(e.second,10),amount:parseInt(e.amount,10)});}),r.distanceField.forEach(function(e){return n.distanceField.push({distanceRange:parseInt(e.distanceRange,10),fieldType:e.fieldType});}),n;}}]);}();var _XMLFormat=/*#__PURE__*/function(){function _XMLFormat(){_classCallCheck2(this,_XMLFormat);}return _createClass2(_XMLFormat,null,[{key:"test",value:function test(e){var t=e;return"string"!=typeof e&&"getElementsByTagName"in e&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face");}},{key:"parse",value:function parse(e){var t=new _BitmapFontData(),r=e.getElementsByTagName("info"),n=e.getElementsByTagName("common"),i=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),s=e.getElementsByTagName("distanceField");for(var _e720=0;_e720<r.length;_e720++)t.info.push({face:r[_e720].getAttribute("face"),size:parseInt(r[_e720].getAttribute("size"),10)});for(var _e721=0;_e721<n.length;_e721++)t.common.push({lineHeight:parseInt(n[_e721].getAttribute("lineHeight"),10)});for(var _e722=0;_e722<i.length;_e722++)t.page.push({id:parseInt(i[_e722].getAttribute("id"),10)||0,file:i[_e722].getAttribute("file")});for(var _e723=0;_e723<o.length;_e723++){var _r262=o[_e723];t["char"].push({id:parseInt(_r262.getAttribute("id"),10),page:parseInt(_r262.getAttribute("page"),10)||0,x:parseInt(_r262.getAttribute("x"),10),y:parseInt(_r262.getAttribute("y"),10),width:parseInt(_r262.getAttribute("width"),10),height:parseInt(_r262.getAttribute("height"),10),xoffset:parseInt(_r262.getAttribute("xoffset"),10),yoffset:parseInt(_r262.getAttribute("yoffset"),10),xadvance:parseInt(_r262.getAttribute("xadvance"),10)});}for(var _e724=0;_e724<a.length;_e724++)t.kerning.push({first:parseInt(a[_e724].getAttribute("first"),10),second:parseInt(a[_e724].getAttribute("second"),10),amount:parseInt(a[_e724].getAttribute("amount"),10)});for(var _e725=0;_e725<s.length;_e725++)t.distanceField.push({fieldType:s[_e725].getAttribute("fieldType"),distanceRange:parseInt(s[_e725].getAttribute("distanceRange"),10)});return t;}}]);}();var _XMLStringFormat=/*#__PURE__*/function(){function _XMLStringFormat(){_classCallCheck2(this,_XMLStringFormat);}return _createClass2(_XMLStringFormat,null,[{key:"test",value:function test(e){return!("string"!=typeof e||!e.includes("<font>"))&&_XMLFormat.test(_settings.ADAPTER.parseXML(e));}},{key:"parse",value:function parse(e){return _XMLFormat.parse(_settings.ADAPTER.parseXML(e));}}]);}();var formats=[_TextFormat,_XMLFormat,_XMLStringFormat];function _autoDetectFormat(e){for(var _t315=0;_t315<formats.length;_t315++)if(formats[_t315].test(e))return formats[_t315];return null;}function generateFillStyle(e,t,r,n,i,o){var a=r.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];var s;var u=r.dropShadow?r.dropShadowDistance:0,l=r.padding||0,c=e.width/n-u-2*l,h=e.height/n-u-2*l,f=a.slice(),d=r.fillGradientStops.slice();if(!d.length){var _e726=f.length+1;for(var _t316=1;_t316<_e726;++_t316)d.push(_t316/_e726);}if(f.unshift(a[0]),d.unshift(0),f.push(a[a.length-1]),d.push(1),r.fillGradientType===_TEXT_GRADIENT.LINEAR_VERTICAL){s=t.createLinearGradient(c/2,l,c/2,h+l);var _e727=0;var _n175=(o.fontProperties.fontSize+r.strokeThickness)/h;for(var _t317=0;_t317<i.length;_t317++){var _r263=o.lineHeight*_t317;for(var _t318=0;_t318<f.length;_t318++){var _i126=0;_i126="number"==typeof d[_t318]?d[_t318]:_t318/f.length;var _o89=_r263/h+_i126*_n175;var _a76=Math.max(_e727,_o89);_a76=Math.min(_a76,1),s.addColorStop(_a76,f[_t318]),_e727=_a76;}}}else{s=t.createLinearGradient(l,h/2,c+l,h/2);var _e728=f.length+1;var _r264=1;for(var _t319=0;_t319<f.length;_t319++){var _n176=void 0;_n176="number"==typeof d[_t319]?d[_t319]:_r264/_e728,s.addColorStop(_n176,f[_t319]),_r264++;}}return s;}function drawGlyph(e,t,r,n,i,o,a){var s=r.text,u=r.fontProperties;t.translate(n,i),t.scale(o,o);var l=a.strokeThickness/2,c=-a.strokeThickness/2;if(t.font=a.toFontString(),t.lineWidth=a.strokeThickness,t.textBaseline=a.textBaseline,t.lineJoin=a.lineJoin,t.miterLimit=a.miterLimit,t.fillStyle=generateFillStyle(e,t,a,o,[s],r),t.strokeStyle=a.stroke,a.dropShadow){var _e729=a.dropShadowColor,_r265=a.dropShadowBlur*o,_n177=a.dropShadowDistance*o;t.shadowColor=_Color2.shared.setValue(_e729).setAlpha(a.dropShadowAlpha).toRgbaString(),t.shadowBlur=_r265,t.shadowOffsetX=Math.cos(a.dropShadowAngle)*_n177,t.shadowOffsetY=Math.sin(a.dropShadowAngle)*_n177;}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;a.stroke&&a.strokeThickness&&t.strokeText(s,l,c+r.lineHeight-u.descent),a.fill&&t.fillText(s,l,c+r.lineHeight-u.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)";}function splitTextToCharacters(e){return Array.from?Array.from(e):e.split("");}function resolveCharacters(e){"string"==typeof e&&(e=[e]);var t=[];for(var r=0,n=e.length;r<n;r++){var _n178=e[r];if(Array.isArray(_n178)){if(2!==_n178.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got ".concat(_n178.length,"."));var _e730=_n178[0].charCodeAt(0),_r266=_n178[1].charCodeAt(0);if(_r266<_e730)throw new Error("[BitmapFont]: Invalid character range.");for(var _n179=_e730,i=_r266;_n179<=i;_n179++)t.push(String.fromCharCode(_n179));}else t.push.apply(t,_toConsumableArray2(splitTextToCharacters(_n178)));}if(0===t.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t;}function extractCharCode(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0);}var _BitmapFont=/*#__PURE__*/function(){function e(_e731,t,r){var _a$fieldType$toLowerC,_a$fieldType;_classCallCheck2(this,e);var _e731$info=_slicedToArray2(_e731.info,1),n=_e731$info[0],_e731$common=_slicedToArray2(_e731.common,1),i=_e731$common[0],_e731$page=_slicedToArray2(_e731.page,1),o=_e731$page[0],_e731$distanceField=_slicedToArray2(_e731.distanceField,1),a=_e731$distanceField[0],s=_getResolutionOfUrl(o.file),u={};this._ownsTextures=r,this.font=n.face,this.size=n.size,this.lineHeight=i.lineHeight/s,this.chars={},this.pageTextures=u;for(var _r267=0;_r267<_e731.page.length;_r267++){var _e731$page$_r=_e731.page[_r267],_n180=_e731$page$_r.id,_i127=_e731$page$_r.file;u[_n180]=t instanceof Array?t[_r267]:t[_i127],(a===null||a===void 0?void 0:a.fieldType)&&"none"!==a.fieldType&&(u[_n180].baseTexture.alphaMode=_ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,u[_n180].baseTexture.mipmap=_MIPMAP_MODES.OFF);}for(var _t320=0;_t320<_e731["char"].length;_t320++){var _e731$char$_t=_e731["char"][_t320],_r268=_e731$char$_t.id,_n181=_e731$char$_t.page;var _e731$char$_t2=_e731["char"][_t320],_i128=_e731$char$_t2.x,_o90=_e731$char$_t2.y,_a77=_e731$char$_t2.width,_l28=_e731$char$_t2.height,_c29=_e731$char$_t2.xoffset,_h24=_e731$char$_t2.yoffset,_f18=_e731$char$_t2.xadvance;_i128/=s,_o90/=s,_a77/=s,_l28/=s,_c29/=s,_h24/=s,_f18/=s;var _d17=new _Rectangle(_i128+u[_n181].frame.x/s,_o90+u[_n181].frame.y/s,_a77,_l28);this.chars[_r268]={xOffset:_c29,yOffset:_h24,xAdvance:_f18,kerning:{},texture:new Texture_Texture(u[_n181].baseTexture,_d17),page:_n181};}for(var _t321=0;_t321<_e731.kerning.length;_t321++){var _e731$kerning$_t=_e731.kerning[_t321],_r269=_e731$kerning$_t.first,_n182=_e731$kerning$_t.second,_i129=_e731$kerning$_t.amount;_r269/=s,_n182/=s,_i129/=s,this.chars[_n182]&&(this.chars[_n182].kerning[_r269]=_i129);}this.distanceFieldRange=a===null||a===void 0?void 0:a.distanceRange,this.distanceFieldType=(_a$fieldType$toLowerC=a===null||a===void 0||(_a$fieldType=a.fieldType)===null||_a$fieldType===void 0?void 0:_a$fieldType.toLowerCase())!==null&&_a$fieldType$toLowerC!==void 0?_a$fieldType$toLowerC:"none";}return _createClass2(e,[{key:"destroy",value:function destroy(){for(var _e738 in this.chars)this.chars[_e738].texture.destroy(),this.chars[_e738].texture=null;for(var _e739 in this.pageTextures)this._ownsTextures&&this.pageTextures[_e739].destroy(!0),this.pageTextures[_e739]=null;this.chars=null,this.pageTextures=null;}}],[{key:"install",value:function install(t,r,n){var i;if(t instanceof _BitmapFontData)i=t;else{var _e734=_autoDetectFormat(t);if(!_e734)throw new Error("Unrecognized data format for font.");i=_e734.parse(t);}r instanceof Texture_Texture&&(r=[r]);var o=new e(i,r,n);return e.available[o.font]=o,o;}},{key:"uninstall",value:function uninstall(t){var r=e.available[t];if(!r)throw new Error("No font found named '".concat(t,"'"));r.destroy(),delete e.available[t];}},{key:"from",value:function from(t,r,n){if(!t)throw new Error("[BitmapFont] Property `name` is required.");var _Object$assign=Object.assign({},e.defaultOptions,n),i=_Object$assign.chars,o=_Object$assign.padding,a=_Object$assign.resolution,s=_Object$assign.textureWidth,u=_Object$assign.textureHeight,l=_objectWithoutProperties(_Object$assign,_excluded2),c=resolveCharacters(i),h=r instanceof _TextStyle2?r:new _TextStyle2(r),f=s,d=new _BitmapFontData();d.info[0]={face:h.fontFamily,size:h.fontSize},d.common[0]={lineHeight:h.fontSize};var p,y,m,g=0,w=0,b=0;var v=[],x=[];for(var _e740=0;_e740<c.length;_e740++){p||(p=_settings.ADAPTER.createCanvas(),p.width=s,p.height=u,y=p.getContext("2d"),m=new _BaseTexture2(p,_objectSpread({resolution:a},l)),v.push(m),x.push(new Texture_Texture(m)),d.page.push({id:x.length-1,file:""}));var _t322=c[_e740],_r270=_TextMetrics2.measureText(_t322,h,!1,p),_n183=_r270.width,_i130=Math.ceil(_r270.height),_2=Math.ceil(("italic"===h.fontStyle?2:1)*_n183);if(w>=u-_i130*a){if(0===w)throw new Error("[BitmapFont] textureHeight ".concat(u,"px is too small (fontFamily: '").concat(h.fontFamily,"', fontSize: ").concat(h.fontSize,"px, char: '").concat(_t322,"')"));--_e740,p=null,y=null,m=null,w=0,g=0,b=0;continue;}if(b=Math.max(_i130+_r270.fontProperties.descent,b),_2*a+g>=f){if(0===g)throw new Error("[BitmapFont] textureWidth ".concat(s,"px is too small (fontFamily: '").concat(h.fontFamily,"', fontSize: ").concat(h.fontSize,"px, char: '").concat(_t322,"')"));--_e740,w+=b*a,w=Math.ceil(w),g=0,b=0;continue;}drawGlyph(p,y,_r270,g,w,a,h);var _S=extractCharCode(_r270.text);d["char"].push({id:_S,page:x.length-1,x:g/a,y:w/a,width:_2,height:_i130,xoffset:0,yoffset:0,xadvance:_n183-(h.dropShadow?h.dropShadowDistance:0)-(h.stroke?h.strokeThickness:0)}),g+=(_2+2*o)*a,g=Math.ceil(g);}if(!(n!==null&&n!==void 0&&n.skipKerning))for(var _e741=0,_t323=c.length;_e741<_t323;_e741++){var _r271=c[_e741];for(var _e742=0;_e742<_t323;_e742++){var _t324=c[_e742],_n184=y.measureText(_r271).width,_i131=y.measureText(_t324).width,_o91=y.measureText(_r271+_t324).width-(_n184+_i131);_o91&&d.kerning.push({first:extractCharCode(_r271),second:extractCharCode(_t324),amount:_o91});}}var _=new e(d,x,!0);return void 0!==e.available[t]&&e.uninstall(t),e.available[t]=_,_;}}]);}();_BitmapFont.ALPHA=[["a","z"],["A","Z"]," "],_BitmapFont.NUMERIC=[["0","9"]],_BitmapFont.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],_BitmapFont.ASCII=[[" ","~"]],_BitmapFont.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:_BitmapFont.ALPHANUMERIC},_BitmapFont.available={};var _BitmapFont2=_BitmapFont;var msdfFrag="// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // Gamma correction for coverage-like alpha\r\n  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r\n  float gamma = mix(1.0, 1.0 / 2.2, luma);\r\n  float coverage = pow(uColor.a * alpha, gamma);  \r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, coverage);\r\n}\r\n",msdfVert="// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n";var pageMeshDataDefaultPageMeshData=[],pageMeshDataMSDFPageMeshData=[],charRenderDataPool=[],_BitmapText=/*#__PURE__*/function(_Container7){function e(t){var _this140;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck2(this,e);_this140=_callSuper2(this,e);var _Object$assign2=Object.assign({},e.styleDefaults,r),n=_Object$assign2.align,i=_Object$assign2.tint,o=_Object$assign2.maxWidth,a=_Object$assign2.letterSpacing,s=_Object$assign2.fontName,u=_Object$assign2.fontSize;if(!_BitmapFont2.available[s])throw new Error("Missing BitmapFont \"".concat(s,"\""));_this140._activePagesMeshData=[],_this140._textWidth=0,_this140._textHeight=0,_this140._align=n,_this140._tintColor=new _Color2(i),_this140._font=void 0,_this140._fontName=s,_this140._fontSize=u,_this140.text=t,_this140._maxWidth=o,_this140._maxLineHeight=0,_this140._letterSpacing=a,_this140._anchor=new _ObservablePoint(function(){_this140.dirty=!0;},_this140,0,0),_this140._roundPixels=_settings.ROUND_PIXELS,_this140.dirty=!0,_this140._resolution=_settings.RESOLUTION,_this140._autoResolution=!0,_this140._textureCache={};return _this140;}_inherits2(e,_Container7);return _createClass2(e,[{key:"updateText",value:function updateText(){var _e743=_BitmapFont2.available[this._fontName],t=this.fontSize,r=t/_e743.size,n=new _Point(),i=[],o=[],a=[],s=splitTextToCharacters(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),u=this._maxWidth*_e743.size/t,l="none"===_e743.distanceFieldType?pageMeshDataDefaultPageMeshData:pageMeshDataMSDFPageMeshData;var c=null,h=0,f=0,d=0,p=-1,y=0,m=0,g=0,w=0;for(var _t325=0;_t325<s.length;_t325++){var _r272=s[_t325],_l29=extractCharCode(_r272);if(/(?:\s)/.test(_r272)&&(p=_t325,y=h,w++),"\r"===_r272||"\n"===_r272){o.push(h),a.push(-1),f=Math.max(f,h),++d,++m,n.x=0,n.y+=_e743.lineHeight,c=null,w=0;continue;}var _b5=_e743.chars[_l29];if(!_b5)continue;c&&_b5.kerning[c]&&(n.x+=_b5.kerning[c]);var _v3=charRenderDataPool.pop()||{texture:Texture_Texture.EMPTY,line:0,charCode:0,prevSpaces:0,position:new _Point()};_v3.texture=_b5.texture,_v3.line=d,_v3.charCode=_l29,_v3.position.x=Math.round(n.x+_b5.xOffset+this._letterSpacing/2),_v3.position.y=Math.round(n.y+_b5.yOffset),_v3.prevSpaces=w,i.push(_v3),h=_v3.position.x+Math.max(_b5.xAdvance-_b5.xOffset,_b5.texture.orig.width),n.x+=_b5.xAdvance+this._letterSpacing,g=Math.max(g,_b5.yOffset+_b5.texture.height),c=_l29,-1!==p&&u>0&&n.x>u&&(++m,_removeItems(i,1+p-m,1+_t325-p),_t325=p,p=-1,o.push(y),a.push(i.length>0?i[i.length-1].prevSpaces:0),f=Math.max(f,y),d++,n.x=0,n.y+=_e743.lineHeight,c=null,w=0);}var b=s[s.length-1];"\r"!==b&&"\n"!==b&&(/(?:\s)/.test(b)&&(h=y),o.push(h),f=Math.max(f,h),a.push(-1));var v=[];for(var _e771=0;_e771<=d;_e771++){var _t326=0;"right"===this._align?_t326=f-o[_e771]:"center"===this._align?_t326=(f-o[_e771])/2:"justify"===this._align&&(_t326=a[_e771]<0?0:(f-o[_e771])/a[_e771]),v.push(_t326);}var x=i.length,_={},S=[],T=this._activePagesMeshData;l.push.apply(l,_toConsumableArray2(T));for(var _t327=0;_t327<x;_t327++){var _r273=i[_t327].texture,_n185=_r273.baseTexture.uid;if(!_[_n185]){var _t328=l.pop();if(!_t328){var _r274=new _MeshGeometry();var _n186=void 0,_i132=void 0;"none"===_e743.distanceFieldType?(_n186=new _MeshMaterial(Texture_Texture.EMPTY),_i132=_BLEND_MODES.NORMAL):(_n186=new _MeshMaterial(Texture_Texture.EMPTY,{program:_Program2.from(msdfVert,msdfFrag),uniforms:{uFWidth:0}}),_i132=_BLEND_MODES.NORMAL_NPM);var _o92=new _Mesh2(_r274,_n186);_o92.blendMode=_i132,_t328={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:_o92,vertices:null,uvs:null,indices:null};}_t328.index=0,_t328.indexCount=0,_t328.vertexCount=0,_t328.uvsCount=0,_t328.total=0;var _i133=this._textureCache;_i133[_n185]=_i133[_n185]||new Texture_Texture(_r273.baseTexture),_t328.mesh.texture=_i133[_n185],_t328.mesh.tint=this._tintColor.value,S.push(_t328),_[_n185]=_t328;}_[_n185].total++;}for(var _e772=0;_e772<T.length;_e772++)S.includes(T[_e772])||this.removeChild(T[_e772].mesh);for(var _e773=0;_e773<S.length;_e773++)S[_e773].mesh.parent!==this&&this.addChild(S[_e773].mesh);this._activePagesMeshData=S;for(var _e774 in _){var _t329$indices;var _t329=_[_e774],_r275=_t329.total;if(!(((_t329$indices=_t329.indices)===null||_t329$indices===void 0?void 0:_t329$indices.length)>6*_r275)||_t329.vertices.length<2*_Mesh2.BATCHABLE_SIZE)_t329.vertices=new Float32Array(8*_r275),_t329.uvs=new Float32Array(8*_r275),_t329.indices=new Uint16Array(6*_r275);else{var _e748=_t329.total,_r276=_t329.vertices;for(var _t330=4*_e748*2;_t330<_r276.length;_t330++)_r276[_t330]=0;}_t329.mesh.size=6*_r275;}for(var _e775=0;_e775<x;_e775++){var _t331=i[_e775];var _n187=_t331.position.x+v[_t331.line]*("justify"===this._align?_t331.prevSpaces:1);this._roundPixels&&(_n187=Math.round(_n187));var _o93=_n187*r,_a78=_t331.position.y*r,_s56=_t331.texture,_u42=_[_s56.baseTexture.uid],_l30=_s56.frame,_c30=_s56._uvs,_h25=_u42.index++;_u42.indices[6*_h25+0]=0+4*_h25,_u42.indices[6*_h25+1]=1+4*_h25,_u42.indices[6*_h25+2]=2+4*_h25,_u42.indices[6*_h25+3]=0+4*_h25,_u42.indices[6*_h25+4]=2+4*_h25,_u42.indices[6*_h25+5]=3+4*_h25,_u42.vertices[8*_h25+0]=_o93,_u42.vertices[8*_h25+1]=_a78,_u42.vertices[8*_h25+2]=_o93+_l30.width*r,_u42.vertices[8*_h25+3]=_a78,_u42.vertices[8*_h25+4]=_o93+_l30.width*r,_u42.vertices[8*_h25+5]=_a78+_l30.height*r,_u42.vertices[8*_h25+6]=_o93,_u42.vertices[8*_h25+7]=_a78+_l30.height*r,_u42.uvs[8*_h25+0]=_c30.x0,_u42.uvs[8*_h25+1]=_c30.y0,_u42.uvs[8*_h25+2]=_c30.x1,_u42.uvs[8*_h25+3]=_c30.y1,_u42.uvs[8*_h25+4]=_c30.x2,_u42.uvs[8*_h25+5]=_c30.y2,_u42.uvs[8*_h25+6]=_c30.x3,_u42.uvs[8*_h25+7]=_c30.y3;}this._textWidth=f*r,this._textHeight=(n.y+_e743.lineHeight)*r;for(var _e776 in _){var _t332=_[_e776];if(0!==this.anchor.x||0!==this.anchor.y){var _e751=0;var _r277=this._textWidth*this.anchor.x,_n188=this._textHeight*this.anchor.y;for(var _i134=0;_i134<_t332.total;_i134++)_t332.vertices[_e751++]-=_r277,_t332.vertices[_e751++]-=_n188,_t332.vertices[_e751++]-=_r277,_t332.vertices[_e751++]-=_n188,_t332.vertices[_e751++]-=_r277,_t332.vertices[_e751++]-=_n188,_t332.vertices[_e751++]-=_r277,_t332.vertices[_e751++]-=_n188;}this._maxLineHeight=g*r;var _n189=_t332.mesh.geometry.getBuffer("aVertexPosition"),_i135=_t332.mesh.geometry.getBuffer("aTextureCoord"),_o94=_t332.mesh.geometry.getIndex();_n189.data=_t332.vertices,_i135.data=_t332.uvs,_o94.data=_t332.indices,_n189.update(),_i135.update(),_o94.update();}for(var _e777=0;_e777<i.length;_e777++)charRenderDataPool.push(i[_e777]);this._font=_e743,this.dirty=!1;}},{key:"updateTransform",value:function updateTransform(){this.validate(),this.containerUpdateTransform();}},{key:"_render",value:function _render(_e753){this._autoResolution&&this._resolution!==_e753.resolution&&(this._resolution=_e753.resolution,this.dirty=!0);var _BitmapFont2$availabl=_BitmapFont2.available[this._fontName],t=_BitmapFont2$availabl.distanceFieldRange,r=_BitmapFont2$availabl.distanceFieldType,n=_BitmapFont2$availabl.size;if("none"!==r){var _this$worldTransform=this.worldTransform,_r278=_this$worldTransform.a,i=_this$worldTransform.b,_o95=_this$worldTransform.c,_a79=_this$worldTransform.d,_s57=Math.sqrt(_r278*_r278+i*i),_u43=Math.sqrt(_o95*_o95+_a79*_a79),_l31=(Math.abs(_s57)+Math.abs(_u43))/2,_c31=this.fontSize/n,_h26=_e753._view.resolution;var _iterator50=_createForOfIteratorHelper2(this._activePagesMeshData),_step50;try{for(_iterator50.s();!(_step50=_iterator50.n()).done;){var _e754=_step50.value;_e754.mesh.shader.uniforms.uFWidth=_l31*t*_c31*_h26;}}catch(err){_iterator50.e(err);}finally{_iterator50.f();}}_superPropGet2(e,"_render",this,3)([_e753]);}},{key:"getLocalBounds",value:function getLocalBounds(){return this.validate(),_superPropGet2(e,"getLocalBounds",this,3)([]);}},{key:"validate",value:function validate(){var _e755=_BitmapFont2.available[this._fontName];if(!_e755)throw new Error("Missing BitmapFont \"".concat(this._fontName,"\""));this._font!==_e755&&(this.dirty=!0),this.dirty&&this.updateText();}},{key:"tint",get:function get(){return this._tintColor.value;},set:function set(_e756){if(this.tint!==_e756){this._tintColor.setValue(_e756);for(var _t333=0;_t333<this._activePagesMeshData.length;_t333++)this._activePagesMeshData[_t333].mesh.tint=_e756;}}},{key:"align",get:function get(){return this._align;},set:function set(_e757){this._align!==_e757&&(this._align=_e757,this.dirty=!0);}},{key:"fontName",get:function get(){return this._fontName;},set:function set(_e758){if(!_BitmapFont2.available[_e758])throw new Error("Missing BitmapFont \"".concat(_e758,"\""));this._fontName!==_e758&&(this._fontName=_e758,this.dirty=!0);}},{key:"fontSize",get:function get(){var _this$_fontSize;return(_this$_fontSize=this._fontSize)!==null&&_this$_fontSize!==void 0?_this$_fontSize:_BitmapFont2.available[this._fontName].size;},set:function set(_e759){this._fontSize!==_e759&&(this._fontSize=_e759,this.dirty=!0);}},{key:"anchor",get:function get(){return this._anchor;},set:function set(_e760){"number"==typeof _e760?this._anchor.set(_e760):this._anchor.copyFrom(_e760);}},{key:"text",get:function get(){return this._text;},set:function set(_e761){var _e778;_e761=String((_e778=_e761)!==null&&_e778!==void 0?_e778:""),this._text!==_e761&&(this._text=_e761,this.dirty=!0);}},{key:"maxWidth",get:function get(){return this._maxWidth;},set:function set(_e762){this._maxWidth!==_e762&&(this._maxWidth=_e762,this.dirty=!0);}},{key:"maxLineHeight",get:function get(){return this.validate(),this._maxLineHeight;}},{key:"textWidth",get:function get(){return this.validate(),this._textWidth;}},{key:"letterSpacing",get:function get(){return this._letterSpacing;},set:function set(_e763){this._letterSpacing!==_e763&&(this._letterSpacing=_e763,this.dirty=!0);}},{key:"roundPixels",get:function get(){return this._roundPixels;},set:function set(_e764){_e764!==this._roundPixels&&(this._roundPixels=_e764,this.dirty=!0);}},{key:"textHeight",get:function get(){return this.validate(),this._textHeight;}},{key:"resolution",get:function get(){return this._resolution;},set:function set(_e765){this._autoResolution=!1,this._resolution!==_e765&&(this._resolution=_e765,this.dirty=!0);}},{key:"destroy",value:function destroy(_e766){var t=this._textureCache,r="none"===_BitmapFont2.available[this._fontName].distanceFieldType?pageMeshDataDefaultPageMeshData:pageMeshDataMSDFPageMeshData;r.push.apply(r,_toConsumableArray2(this._activePagesMeshData));var _iterator51=_createForOfIteratorHelper2(this._activePagesMeshData),_step51;try{for(_iterator51.s();!(_step51=_iterator51.n()).done;){var _e767=_step51.value;this.removeChild(_e767.mesh);}}catch(err){_iterator51.e(err);}finally{_iterator51.f();}this._activePagesMeshData=[],r.filter(function(_e768){return t[_e768.mesh.texture.baseTexture.uid];}).forEach(function(_e769){_e769.mesh.texture=Texture_Texture.EMPTY;});for(var _e779 in t)t[_e779].destroy(),delete t[_e779];this._font=null,this._tintColor=null,this._textureCache=null,_superPropGet2(e,"destroy",this,3)([_e766]);}}]);}(_Container2);_BitmapText.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};var _BitmapText2=_BitmapText;var validExtensions=[".xml",".fnt"],_loadBitmapFont={extension:{type:_ExtensionType.LoadParser,priority:_LoaderParserPriority.Normal},name:"loadBitmapFont",test:function test(e){return validExtensions.includes(_path.extname(e).toLowerCase());},testParse:function(){var _testParse3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee126(e){return _regeneratorRuntime2().wrap(function _callee126$(_context130){while(1)switch(_context130.prev=_context130.next){case 0:return _context130.abrupt("return",_TextFormat.test(e)||_XMLStringFormat.test(e));case 1:case"end":return _context130.stop();}},_callee126);}));function testParse(_x148){return _testParse3.apply(this,arguments);}return testParse;}(),parse:function parse(e,t,r){return _asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee127(){var n,i,o,a,_e780,_t334,_r279,s,u;return _regeneratorRuntime2().wrap(function _callee127$(_context131){while(1)switch(_context131.prev=_context131.next){case 0:n=_TextFormat.test(e)?_TextFormat.parse(e):_XMLStringFormat.parse(e),i=t.src,o=n.page,a=[];for(_e780=0;_e780<o.length;++_e780){_t334=o[_e780].file;_r279=_path.join(_path.dirname(i),_t334);_r279=_copySearchParams(_r279,i),a.push(_r279);}_context131.next=4;return r.load(a);case 4:s=_context131.sent;u=a.map(function(e){return s[e];});return _context131.abrupt("return",_BitmapFont2.install(n,u,!0));case 7:case"end":return _context131.stop();}},_callee127);}))();},load:function(){var _load6=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee128(e,t){return _regeneratorRuntime2().wrap(function _callee128$(_context132){while(1)switch(_context132.prev=_context132.next){case 0:_context132.next=2;return _settings.ADAPTER.fetch(e);case 2:return _context132.abrupt("return",_context132.sent.text());case 3:case"end":return _context132.stop();}},_callee128);}));function load(_x149,_x150){return _load6.apply(this,arguments);}return load;}(),unload:function unload(e){e.destroy();}};_extensions.add(_loadBitmapFont);var _HTMLTextStyle=/*#__PURE__*/function(_TextStyle3){function e(){var _this141;_classCallCheck2(this,e);_this141=_callSuper2(this,e,arguments),_this141._fonts=[],_this141._overrides=[],_this141._stylesheet="",_this141.fontsDirty=!1;return _this141;}_inherits2(e,_TextStyle3);return _createClass2(e,[{key:"cleanFonts",value:function cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(function(t){URL.revokeObjectURL(t.src),t.refs--,0===t.refs&&(t.fontFace&&document.fonts["delete"](t.fontFace),delete e.availableFonts[t.originalUrl]);}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0);}},{key:"loadFont",value:function loadFont(t){var _this142=this;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=e.availableFonts;if(n[t]){var _e782=n[t];return this._fonts.push(_e782),_e782.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve();}return _settings.ADAPTER.fetch(t).then(function(_e783){return _e783.blob();}).then(/*#__PURE__*/function(){var _ref64=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee129(_e784){return _regeneratorRuntime2().wrap(function _callee129$(_context133){while(1)switch(_context133.prev=_context133.next){case 0:return _context133.abrupt("return",new Promise(function(t,r){var n=URL.createObjectURL(_e784),i=new FileReader();i.onload=function(){return t([n,i.result]);},i.onerror=r,i.readAsDataURL(_e784);}));case 1:case"end":return _context133.stop();}},_callee129);}));return function(_x151){return _ref64.apply(this,arguments);};}()).then(/*#__PURE__*/function(){var _ref66=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee130(_ref65){var _ref67,_e785,i,o,a;return _regeneratorRuntime2().wrap(function _callee130$(_context134){while(1)switch(_context134.prev=_context134.next){case 0:_ref67=_slicedToArray2(_ref65,2),_e785=_ref67[0],i=_ref67[1];o=Object.assign({family:_path.basename(t,_path.extname(t)),weight:"normal",style:"normal",display:"auto",src:_e785,dataSrc:i,refs:1,originalUrl:t,fontFace:null},r);n[t]=o,_this142._fonts.push(o),_this142.styleID++;a=new FontFace(o.family,"url(".concat(o.src,")"),{weight:o.weight,style:o.style,display:o.display});o.fontFace=a;_context134.next=7;return a.load();case 7:document.fonts.add(a);_context134.next=10;return document.fonts.ready;case 10:_this142.styleID++;_this142.fontsDirty=!0;case 12:case"end":return _context134.stop();}},_callee130);}));return function(_x152){return _ref66.apply(this,arguments);};}());}},{key:"addOverride",value:function addOverride(){var _this143=this,_this$_overrides;for(var _len9=arguments.length,_e786=new Array(_len9),_key9=0;_key9<_len9;_key9++){_e786[_key9]=arguments[_key9];}var t=_e786.filter(function(_e787){return!_this143._overrides.includes(_e787);});t.length>0&&((_this$_overrides=this._overrides).push.apply(_this$_overrides,_toConsumableArray2(t)),this.styleID++);}},{key:"removeOverride",value:function removeOverride(){var _this144=this;for(var _len10=arguments.length,_e788=new Array(_len10),_key10=0;_key10<_len10;_key10++){_e788[_key10]=arguments[_key10];}var t=_e788.filter(function(_e789){return _this144._overrides.includes(_e789);});t.length>0&&(this._overrides=this._overrides.filter(function(_e790){return!t.includes(_e790);}),this.styleID++);}},{key:"toCSS",value:function toCSS(_e791){return["transform: scale(".concat(_e791,")"),"transform-origin: top left","display: inline-block","color: ".concat(this.normalizeColor(this.fill)),"font-size: ".concat(this.fontSize,"px"),"font-family: ".concat(this.fontFamily),"font-weight: ".concat(this.fontWeight),"font-style: ".concat(this.fontStyle),"font-variant: ".concat(this.fontVariant),"letter-spacing: ".concat(this.letterSpacing,"px"),"text-align: ".concat(this.align),"padding: ".concat(this.padding,"px"),"white-space: ".concat(this.whiteSpace)].concat(_toConsumableArray2(this.lineHeight?["line-height: ".concat(this.lineHeight,"px")]:[]),_toConsumableArray2(this.wordWrap?["word-wrap: "+(this.breakWords?"break-all":"break-word"),"max-width: ".concat(this.wordWrapWidth,"px")]:[]),_toConsumableArray2(this.strokeThickness?["-webkit-text-stroke-width: ".concat(this.strokeThickness,"px"),"-webkit-text-stroke-color: ".concat(this.normalizeColor(this.stroke)),"text-stroke-width: ".concat(this.strokeThickness,"px"),"text-stroke-color: ".concat(this.normalizeColor(this.stroke)),"paint-order: stroke"]:[]),_toConsumableArray2(this.dropShadow?[this.dropShadowToCSS()]:[]),_toConsumableArray2(this._overrides)).join(";");}},{key:"toGlobalCSS",value:function toGlobalCSS(){return this._fonts.reduce(function(_e792,t){return"".concat(_e792,"\n            @font-face {\n                font-family: \"").concat(t.family,"\";\n                src: url('").concat(t.dataSrc,"');\n                font-weight: ").concat(t.weight,";\n                font-style: ").concat(t.style,";\n                font-display: ").concat(t.display,";\n            }");},this._stylesheet);}},{key:"stylesheet",get:function get(){return this._stylesheet;},set:function set(_e793){this._stylesheet!==_e793&&(this._stylesheet=_e793,this.styleID++);}},{key:"normalizeColor",value:function normalizeColor(_e794){return Array.isArray(_e794)&&(_e794=_rgb2hex(_e794)),"number"==typeof _e794?_hex2string(_e794):_e794;}},{key:"dropShadowToCSS",value:function dropShadowToCSS(){var _e795=this.normalizeColor(this.dropShadowColor);var t=this.dropShadowAlpha,r=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),n=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);_e795.startsWith("#")&&t<1&&(_e795+=(255*t|0).toString(16).padStart(2,"0"));var i="".concat(r,"px ").concat(n,"px");return this.dropShadowBlur>0?"text-shadow: ".concat(i," ").concat(this.dropShadowBlur,"px ").concat(_e795):"text-shadow: ".concat(i," ").concat(_e795);}},{key:"reset",value:function reset(){Object.assign(this,e.defaultOptions);}},{key:"onBeforeDraw",value:function onBeforeDraw(){var _e796=this.fontsDirty;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&_e796?new Promise(function(_e797){return setTimeout(_e797,100);}):Promise.resolve();}},{key:"isSafari",get:function get(){var _settings$ADAPTER$get=_settings.ADAPTER.getNavigator(),_e798=_settings$ADAPTER$get.userAgent;return /^((?!chrome|android).)*safari/i.test(_e798);}},{key:"fillGradientStops",get:function get(){return _superPropGet2(e,"fillGradientStops",this,1);},set:function set(_e799){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText");}},{key:"fillGradientType",get:function get(){return _superPropGet2(e,"fillGradientType",this,1);},set:function set(_e800){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText");}},{key:"miterLimit",get:function get(){return _superPropGet2(e,"miterLimit",this,1);},set:function set(_e801){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText");}},{key:"trim",get:function get(){return _superPropGet2(e,"trim",this,1);},set:function set(_e802){console.warn("[HTMLTextStyle] trim is not supported by HTMLText");}},{key:"textBaseline",get:function get(){return _superPropGet2(e,"textBaseline",this,1);},set:function set(_e803){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText");}},{key:"leading",get:function get(){return _superPropGet2(e,"leading",this,1);},set:function set(_e804){console.warn("[HTMLTextStyle] leading is not supported by HTMLText");}},{key:"lineJoin",get:function get(){return _superPropGet2(e,"lineJoin",this,1);},set:function set(_e805){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText");}}],[{key:"from",value:function from(t){return new e(Object.keys(e.defaultOptions).reduce(function(_e781,r){return _objectSpread(_objectSpread({},_e781),{},_defineProperty({},r,t[r]));},{}));}}]);}(_TextStyle2);_HTMLTextStyle.availableFonts={},_HTMLTextStyle.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};var _HTMLTextStyle2=_HTMLTextStyle;var _HTMLText=/*#__PURE__*/function(_Sprite5){function e(){var _e$defaultResolution2;var _this145;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck2(this,e);_this145=_callSuper2(this,e,[Texture_Texture.EMPTY]),_this145._text=null,_this145._style=null,_this145._autoResolution=!0,_this145.localStyleID=-1,_this145.dirty=!1,_this145._updateID=0,_this145.ownsStyle=!1;var n=new Image(),i=Texture_Texture.from(n,{scaleMode:_settings.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new _Rectangle(),i.trim=new _Rectangle(),_this145.texture=i;var o="http://www.w3.org/2000/svg",a="http://www.w3.org/1999/xhtml",s=document.createElementNS(o,"svg"),u=document.createElementNS(o,"foreignObject"),l=document.createElementNS(a,"div"),c=document.createElementNS(a,"style");u.setAttribute("width","10000"),u.setAttribute("height","10000"),u.style.overflow="hidden",s.appendChild(u),_this145.maxWidth=e.defaultMaxWidth,_this145.maxHeight=e.defaultMaxHeight,_this145._domElement=l,_this145._styleElement=c,_this145._svgRoot=s,_this145._foreignObject=u,_this145._foreignObject.appendChild(c),_this145._foreignObject.appendChild(l),_this145._image=n,_this145._loadImage=new Image(),_this145._autoResolution=e.defaultAutoResolution,_this145._resolution=(_e$defaultResolution2=e.defaultResolution)!==null&&_e$defaultResolution2!==void 0?_e$defaultResolution2:_settings.RESOLUTION,_this145.text=t,_this145.style=r;return _this145;}_inherits2(e,_Sprite5);return _createClass2(e,[{key:"measureText",value:function measureText(_e806){var _this$_style,_this$_style2;var _Object$assign3=Object.assign({text:this._text,style:this._style,resolution:this._resolution},_e806),t=_Object$assign3.text,r=_Object$assign3.style,n=_Object$assign3.resolution;Object.assign(this._domElement,{innerHTML:t,style:r.toCSS(n)}),this._styleElement.textContent=r.toGlobalCSS(),document.body.appendChild(this._svgRoot);var i=this._domElement.getBoundingClientRect();this._svgRoot.remove();var o=i.width,a=i.height;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");var s=Math.min(this.maxWidth,Math.ceil(o)),u=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",s.toString()),this._svgRoot.setAttribute("height",u.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),r!==this._style&&(Object.assign(this._domElement,{style:(_this$_style=this._style)===null||_this$_style===void 0?void 0:_this$_style.toCSS(n)}),this._styleElement.textContent=(_this$_style2=this._style)===null||_this$_style2===void 0?void 0:_this$_style2.toGlobalCSS()),{width:s+2*r.padding,height:u+2*r.padding};}},{key:"updateText",value:function(){var _updateText=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee132(){var _this146=this;var _e807,t,r,n,_this$measureText,i,o,a,_args135=arguments;return _regeneratorRuntime2().wrap(function _callee132$(_context136){while(1)switch(_context136.prev=_context136.next){case 0:_e807=_args135.length>0&&_args135[0]!==undefined?_args135[0]:!0;t=this.style,r=this._image,n=this._loadImage;if(!(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&_e807)){_context136.next=4;break;}return _context136.abrupt("return");case 4:_this$measureText=this.measureText(),i=_this$measureText.width,o=_this$measureText.height;r.width=n.width=Math.ceil(Math.max(1,i)),r.height=n.height=Math.ceil(Math.max(1,o)),this._updateID++;a=this._updateID;_context136.next=9;return new Promise(function(_e808){n.onload=/*#__PURE__*/_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee131(){return _regeneratorRuntime2().wrap(function _callee131$(_context135){while(1)switch(_context135.prev=_context135.next){case 0:_context135.t0=a<_this146._updateID;if(_context135.t0){_context135.next=8;break;}_context135.next=4;return t.onBeforeDraw();case 4:r.src=n.src;n.onload=null;n.src="";_this146.updateTexture();case 8:_e808();case 9:case"end":return _context135.stop();}},_callee131);}));var i=new XMLSerializer().serializeToString(_this146._svgRoot);n.src="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(i));});case 9:case"end":return _context136.stop();}},_callee132,this);}));function updateText(){return _updateText.apply(this,arguments);}return updateText;}()},{key:"source",get:function get(){return this._image;}},{key:"updateTexture",value:function updateTexture(){var _e809=this.style,t=this.texture,r=this._image,n=this.resolution,i=_e809.padding,o=t.baseTexture;t.trim.width=t._frame.width=r.width/n,t.trim.height=t._frame.height=r.height/n,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-2*i,t.orig.height=t._frame.height-2*i,this._onTextureUpdate(),o.setRealSize(r.width,r.height,n),this.dirty=!1;}},{key:"_render",value:function _render(_e810){this._autoResolution&&this._resolution!==_e810.resolution&&(this._resolution=_e810.resolution,this.dirty=!0),this.updateText(!0),_superPropGet2(e,"_render",this,3)([_e810]);}},{key:"_renderCanvas",value:function _renderCanvas(_e811){this._autoResolution&&this._resolution!==_e811.resolution&&(this._resolution=_e811.resolution,this.dirty=!0),this.updateText(!0),_superPropGet2(e,"_renderCanvas",this,3)([_e811]);}},{key:"getLocalBounds",value:function getLocalBounds(_e812){return this.updateText(!0),_superPropGet2(e,"getLocalBounds",this,3)([_e812]);}},{key:"_calculateBounds",value:function _calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData);}},{key:"_onStyleChange",value:function _onStyleChange(){this.dirty=!0;}},{key:"destroy",value:function destroy(t){var _this$_style3,_this$_svgRoot,_this$_domElement,_this$_foreignObject,_this$_styleElement;"boolean"==typeof t&&(t={children:t}),t=Object.assign({},e.defaultDestroyOptions,t),_superPropGet2(e,"destroy",this,3)([t]);var r=null;this.ownsStyle&&(_this$_style3=this._style)!==null&&_this$_style3!==void 0&&_this$_style3.cleanFonts(),this._style=r,(_this$_svgRoot=this._svgRoot)!==null&&_this$_svgRoot!==void 0&&_this$_svgRoot.remove(),this._svgRoot=r,(_this$_domElement=this._domElement)!==null&&_this$_domElement!==void 0&&_this$_domElement.remove(),this._domElement=r,(_this$_foreignObject=this._foreignObject)!==null&&_this$_foreignObject!==void 0&&_this$_foreignObject.remove(),this._foreignObject=r,(_this$_styleElement=this._styleElement)!==null&&_this$_styleElement!==void 0&&_this$_styleElement.remove(),this._styleElement=r,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=r,this._image.src="",this._image=r;}},{key:"width",get:function get(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution;},set:function set(_e813){this.updateText(!0);var t=_sign(this.scale.x)||1;this.scale.x=t*_e813/this._image.width/this.resolution,this._width=_e813;}},{key:"height",get:function get(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution;},set:function set(_e814){this.updateText(!0);var t=_sign(this.scale.y)||1;this.scale.y=t*_e814/this._image.height/this.resolution,this._height=_e814;}},{key:"style",get:function get(){return this._style;},set:function set(_e815){this._style!==_e815&&((_e815=_e815||{})instanceof _HTMLTextStyle2?(this.ownsStyle=!1,this._style=_e815):_e815 instanceof _TextStyle2?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=_HTMLTextStyle2.from(_e815)):(this.ownsStyle=!0,this._style=new _HTMLTextStyle2(_e815)),this.localStyleID=-1,this.dirty=!0);}},{key:"text",get:function get(){return this._text;},set:function set(_e816){_e816=String(""===_e816||null==_e816?" ":_e816),_e816=this.sanitiseText(_e816),this._text!==_e816&&(this._text=_e816,this.dirty=!0);}},{key:"resolution",get:function get(){return this._resolution;},set:function set(_e817){this._autoResolution=!1,this._resolution!==_e817&&(this._resolution=_e817,this.dirty=!0);}},{key:"sanitiseText",value:function sanitiseText(_e818){return _e818.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;");}}]);}(_Sprite);_HTMLText.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},_HTMLText.defaultMaxWidth=2024,_HTMLText.defaultMaxHeight=2024,_HTMLText.defaultAutoResolution=!0;var _HTMLText2=_HTMLText;var bundle=__webpack_require__(8389);var isCallNotification=function isCallNotification(e){return void 0!==e.method&&"call"===e.method;},isClearResponse=function isClearResponse(e){return null===e.error&&"number"==typeof e.id;},load=function load(e){var t=new Map([[0,function(){}]]),r=new Map([[0,function(){}]]),n=new Map(),i=new Worker(e);i.addEventListener("message",function(_ref69){var e=_ref69.data;if(isCallNotification(e)){var _e$params=e.params,_i136=_e$params.timerId,_o96=_e$params.timerType;if("interval"===_o96){var _e819=t.get(_i136);if("number"==typeof _e819){var _t335=n.get(_e819);if(void 0===_t335||_t335.timerId!==_i136||_t335.timerType!==_o96)throw new Error("The timer is in an undefined state.");}else{if(void 0===_e819)throw new Error("The timer is in an undefined state.");_e819();}}else if("timeout"===_o96){var _e820=r.get(_i136);if("number"==typeof _e820){var _t336=n.get(_e820);if(void 0===_t336||_t336.timerId!==_i136||_t336.timerType!==_o96)throw new Error("The timer is in an undefined state.");}else{if(void 0===_e820)throw new Error("The timer is in an undefined state.");_e820(),r["delete"](_i136);}}}else{if(!isClearResponse(e)){var _t337=e.error.message;throw new Error(_t337);}{var _i137=e.id,_o97=n.get(_i137);if(void 0===_o97)throw new Error("The timer is in an undefined state.");var _a80=_o97.timerId,_s58=_o97.timerType;n["delete"](_i137),"interval"===_s58?t["delete"](_a80):r["delete"](_a80);}}});return{clearInterval:function clearInterval(e){var r=(0,bundle.generateUniqueNumber)(n);n.set(r,{timerId:e,timerType:"interval"}),t.set(e,r),i.postMessage({id:r,method:"clear",params:{timerId:e,timerType:"interval"}});},clearTimeout:function clearTimeout(e){var t=(0,bundle.generateUniqueNumber)(n);n.set(t,{timerId:e,timerType:"timeout"}),r.set(e,t),i.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"timeout"}});},setInterval:function setInterval(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var n=(0,bundle.generateUniqueNumber)(t);return t.set(n,function(){e(),"function"==typeof t.get(n)&&i.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:n,timerType:"interval"}});}),i.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:n,timerType:"interval"}}),n;},setTimeout:function setTimeout(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var n=(0,bundle.generateUniqueNumber)(r);return r.set(n,e),i.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:n,timerType:"timeout"}}),n;}};},createLoadOrReturnBroker=function createLoadOrReturnBroker(e,t){var r=null;return function(){if(null!==r)return r;var n=new Blob([t],{type:"application/javascript; charset=utf-8"}),i=URL.createObjectURL(n);return r=e(i),setTimeout(function(){return URL.revokeObjectURL(i);}),r;};},worker='(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error(\'There is no interval scheduled with the given id "\'.concat(t,\'".\'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error(\'The given type "\'.concat(i,\'" is not supported\'));(e=>{const r=t.get(e);if(void 0===r)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error(\'The given method "\'.concat(s.method,\'" is not supported\'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error(\'The given type "\'.concat(d,\'" is not supported\'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();',loadOrReturnBroker=createLoadOrReturnBroker(load,worker),module_clearInterval=function module_clearInterval(e){return loadOrReturnBroker().clearInterval(e);},module_clearTimeout=function module_clearTimeout(e){return loadOrReturnBroker().clearTimeout(e);},module_setInterval=function module_setInterval(){var _loadOrReturnBroker;return(_loadOrReturnBroker=loadOrReturnBroker()).setInterval.apply(_loadOrReturnBroker,arguments);},module_setTimeout=function module_setTimeout(){var _loadOrReturnBroker2;return(_loadOrReturnBroker2=loadOrReturnBroker()).setTimeout.apply(_loadOrReturnBroker2,arguments);};function Texture_typeof(e){return Texture_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},Texture_typeof(e);}function Texture_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function Texture_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Texture_toPropertyKey(n.key),n);}}function Texture_createClass(e,t,r){return t&&Texture_defineProperties(e.prototype,t),r&&Texture_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function Texture_toPropertyKey(e){var t=Texture_toPrimitive(e,"string");return"symbol"==Texture_typeof(t)?t:t+"";}function Texture_toPrimitive(e,t){if("object"!=Texture_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Texture_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function Texture_callSuper(e,t,r){return t=Texture_getPrototypeOf(t),Texture_possibleConstructorReturn(e,Texture_isNativeReflectConstruct()?Reflect.construct(t,r||[],Texture_getPrototypeOf(e).constructor):t.apply(e,r));}function Texture_possibleConstructorReturn(e,t){if(t&&("object"==Texture_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Texture_assertThisInitialized(e);}function Texture_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function Texture_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(Texture_isNativeReflectConstruct=function Texture_isNativeReflectConstruct(){return!!e;})();}function Texture_getPrototypeOf(e){return Texture_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},Texture_getPrototypeOf(e);}function Texture_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Texture_setPrototypeOf(e,t);}function Texture_setPrototypeOf(e,t){return Texture_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},Texture_setPrototypeOf(e,t);}var Texture=function(e){function t(e){var r;return Texture_classCallCheck(this,t),(r=Texture_callSuper(this,t)).shouldBeDestroed=!0,e?(r.texture=e instanceof Texture_Texture?e:Texture_Texture.from(e),r):(r.texture=new Texture_Texture(new _BaseTexture2()),Texture_possibleConstructorReturn(r));}return Texture_inherits(t,eventemitter3),Texture_createClass(t,[{key:"get",value:function value(){return this.texture;}},{key:"update",value:function value(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return this.texture.update(),void this.emit("update",this);this.texture&&this.shouldBeDestroed&&this.texture.destroy(!0),this.texture=e instanceof Texture_Texture?e:Texture_Texture.from(e),this.shouldBeDestroed=t,this.emit("replace",this);}},{key:"destroy",value:function value(){this.texture&&this.texture.destroy(!0),this.removeAllListeners();}}]);}();function Frame_typeof(e){return Frame_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},Frame_typeof(e);}function Frame_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function Frame_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Frame_toPropertyKey(n.key),n);}}function Frame_createClass(e,t,r){return t&&Frame_defineProperties(e.prototype,t),r&&Frame_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function Frame_toPropertyKey(e){var t=Frame_toPrimitive(e,"string");return"symbol"==Frame_typeof(t)?t:t+"";}function Frame_toPrimitive(e,t){if("object"!=Frame_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Frame_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function Frame_callSuper(e,t,r){return t=Frame_getPrototypeOf(t),Frame_possibleConstructorReturn(e,Frame_isNativeReflectConstruct()?Reflect.construct(t,r||[],Frame_getPrototypeOf(e).constructor):t.apply(e,r));}function Frame_possibleConstructorReturn(e,t){if(t&&("object"==Frame_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Frame_assertThisInitialized(e);}function Frame_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function Frame_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(Frame_isNativeReflectConstruct=function Frame_isNativeReflectConstruct(){return!!e;})();}function Frame_getPrototypeOf(e){return Frame_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},Frame_getPrototypeOf(e);}function Frame_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Frame_setPrototypeOf(e,t);}function Frame_setPrototypeOf(e,t){return Frame_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},Frame_setPrototypeOf(e,t);}var Frame=function(e){function t(e,r){var n;return Frame_classCallCheck(this,t),(n=Frame_callSuper(this,t)).active="origin",n.textures=new Map(),n.buffers=new Map(),e instanceof Texture?(n.frame=new _Sprite(e.get()),n.textures.set("origin",e.get()),e.on("replace",n.onReplace,n)):(n.frame=new _Sprite(e),n.textures.set("origin",e)),n.frame.width=r.width,n.frame.height=r.height,n;}return Frame_inherits(t,eventemitter3),Frame_createClass(t,[{key:"onReplace",value:function value(e){this.textures.set("origin",e.get()),"origin"==this.active&&(this.frame.texture=e.get());}},{key:"addTexture",value:function value(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.textures.has(e)&&(n&&(null===(r=this.textures.get(e))||void 0===r||r.destroy(!0)),this.textures["delete"](e)),this.textures.set(e,t),!0;}},{key:"getTexture",value:function value(e){if(this.textures.has(e))return this.textures.get(e);throw new Error("There is no such texture");}},{key:"addBuffer",value:function value(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.buffers.has(e)&&(r&&(null===(t=this.buffers.get(e))||void 0===t||t.destroy(!0)),this.buffers["delete"](e)),this.buffers.set(e,_RenderTexture.create({width:this.frame.width,height:this.frame.height})),!0;}},{key:"getBuffer",value:function value(e){if(this.buffers.has(e))return this.buffers.get(e);throw new Error("There is no such buffer");}},{key:"resize",value:function value(e,t){this.frame.width=e,this.frame.height=t,this.buffers.forEach(function(r,n){r.resize(e,t);});}},{key:"activateBuffer",value:function value(e){this.buffers.has(e)&&(this.frame.texture=this.buffers.get(e),this.active=e);}},{key:"activateTexture",value:function value(e){this.textures.has(e)&&(this.frame.texture=this.textures.get(e),this.active=e);}}]);}();function deferred_typeof(e){return deferred_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},deferred_typeof(e);}function deferred_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function deferred_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,deferred_toPropertyKey(n.key),n);}}function deferred_createClass(e,t,r){return t&&deferred_defineProperties(e.prototype,t),r&&deferred_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function deferred_toPropertyKey(e){var t=deferred_toPrimitive(e,"string");return"symbol"==deferred_typeof(t)?t:t+"";}function deferred_toPrimitive(e,t){if("object"!=deferred_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=deferred_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}Frame.defaultOptions={width:100,height:100};var Deferred=function(){return deferred_createClass(function e(){var t=this;deferred_classCallCheck(this,e),this.state="pending",this.fate="unresolved",this.promise=new Promise(function(e,r){t._resolve=e,t._reject=r;}),this.promise.then(function(){return t.state="fulfilled";},function(){return t.state="rejected";});},[{key:"resolve",value:function value(e){if("resolved"===this.fate)throw"Deferred cannot be resolved twice";this.fate="resolved",this._resolve(e);}},{key:"reject",value:function value(e){if("resolved"===this.fate)throw"Deferred cannot be resolved twice";this.fate="resolved",this._reject(e);}},{key:"isResolved",value:function value(){return"resolved"===this.fate;}},{key:"isPending",value:function value(){return"pending"===this.state;}},{key:"isFulfilled",value:function value(){return"fulfilled"===this.state;}},{key:"isRejected",value:function value(){return"rejected"===this.state;}}]);}();function frame_callback_typeof(e){return frame_callback_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},frame_callback_typeof(e);}function frame_callback_regeneratorRuntime(){frame_callback_regeneratorRuntime=function frame_callback_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==frame_callback_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(frame_callback_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function frame_callback_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function frame_callback_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){frame_callback_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){frame_callback_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function frame_callback_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function frame_callback_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,frame_callback_toPropertyKey(n.key),n);}}function frame_callback_createClass(e,t,r){return t&&frame_callback_defineProperties(e.prototype,t),r&&frame_callback_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function frame_callback_toPropertyKey(e){var t=frame_callback_toPrimitive(e,"string");return"symbol"==frame_callback_typeof(t)?t:t+"";}function frame_callback_toPrimitive(e,t){if("object"!=frame_callback_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=frame_callback_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function frame_callback_callSuper(e,t,r){return t=frame_callback_getPrototypeOf(t),frame_callback_possibleConstructorReturn(e,frame_callback_isNativeReflectConstruct()?Reflect.construct(t,r||[],frame_callback_getPrototypeOf(e).constructor):t.apply(e,r));}function frame_callback_possibleConstructorReturn(e,t){if(t&&("object"==frame_callback_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return frame_callback_assertThisInitialized(e);}function frame_callback_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function frame_callback_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(frame_callback_isNativeReflectConstruct=function frame_callback_isNativeReflectConstruct(){return!!e;})();}function _superPropGet(e,t,r,n){var i=_get(frame_callback_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e);}:i;}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value;}},_get.apply(null,arguments);}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=frame_callback_getPrototypeOf(e)););return e;}function frame_callback_getPrototypeOf(e){return frame_callback_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},frame_callback_getPrototypeOf(e);}function frame_callback_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&frame_callback_setPrototypeOf(e,t);}function frame_callback_setPrototypeOf(e,t){return frame_callback_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},frame_callback_setPrototypeOf(e,t);}var FrameCallbackStreamProcessor=function(e){function t(e){var r;return frame_callback_classCallCheck(this,t),(r=frame_callback_callSuper(this,t,[e])).inprocess=!1,r.duration=30,r.textures=[],r.inputVideo=document.createElement("video"),r.duration=1e3/r.fpsLimit,r;}return frame_callback_inherits(t,StreamProcessor),frame_callback_createClass(t,[{key:"onTrackUpdate",value:function value(){_superPropGet(t,"onTrackUpdate",this,3)([]),this.videoFrame&&this.videoFrame.resize(this.sdkOptions.width,this.sdkOptions.height);}},{key:"setFpsLimit",value:function value(e){var t=this;this.fpsLimit=e,this.duration=1e3/this.fpsLimit;try{this.gatherFramesInterval&&(module_clearInterval(this.gatherFramesInterval),this.gatherFramesInterval=0,this.gatherFramesInterval=module_setInterval(function(){t.gatherByTimers();},this.duration));}catch(e){}}},{key:"setRenderer",value:function value(e){this.renderer=e;}},{key:"destroy",value:function value(){this.stopTimers();}},{key:"clearBuffers",value:function value(){this.effectProcessor.clearBuffers();}},{key:"stopTimers",value:function value(){try{this.gatherFramesTimeout&&(module_clearTimeout(this.gatherFramesTimeout),this.gatherFramesTimeout=0),this.handleFramesTimeout&&(module_clearTimeout(this.handleFramesTimeout),this.handleFramesTimeout=0),this.gatherFramesInterval&&(module_clearInterval(this.gatherFramesInterval),this.gatherFramesInterval=0);}catch(e){}}},{key:"startTimers",value:function value(){var e=this;this.gatherFramesInterval=module_setInterval(function(){e.gatherByTimers();},this.duration),this.gatherByCallback(),this.handleFrames();}},{key:"gatherByCallback",value:(a=frame_callback_asyncToGenerator(frame_callback_regeneratorRuntime().mark(function e(){return frame_callback_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop();}},e);})),function(){return a.apply(this,arguments);})},{key:"gatherByTimers",value:(o=frame_callback_asyncToGenerator(frame_callback_regeneratorRuntime().mark(function e(){return frame_callback_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:document.hidden&&this.gatherFrames();case 1:case"end":return e.stop();}},e,this);})),function(){return o.apply(this,arguments);})},{key:"gatherFrames",value:(i=frame_callback_asyncToGenerator(frame_callback_regeneratorRuntime().mark(function e(){var t,r;return frame_callback_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.textures.length>3&&(null==(t=this.textures.shift())||t.destroy(!0)),this.videoTexture&&(this.videoTexture.update(),r=_RenderTexture.create({width:this.sdkOptions.width,height:this.sdkOptions.height}),this.renderer.renderTo(this.videoFrame.frame,r),this.textures.push(r));case 2:case"end":return e.stop();}},e,this);})),function(){return i.apply(this,arguments);})},{key:"nextTick",value:(n=frame_callback_asyncToGenerator(frame_callback_regeneratorRuntime().mark(function e(){var t,r;return frame_callback_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return null===(t=this.frameDrawFunction)||void 0===t||t.call(this),this.frame_count++,this.videoTrackWrapper.update(this.inputVideo.videoWidth,this.inputVideo.videoHeight),this.lastFrameTime=performance.now(),this.frameTimer.finish(),this.frameTimer.start(),e.next=8,this.effectProcessor.process();case 8:this.drawFps(),this.toCanvas&&(null===(r=this.toCanvas.getContext("2d"))||void 0===r||r.drawImage(this.renderer.renderer.view,0,0,this.toCanvas.width,this.toCanvas.height));case 10:case"end":return e.stop();}},e,this);})),function(){return n.apply(this,arguments);})},{key:"handleFrames",value:(r=frame_callback_asyncToGenerator(frame_callback_regeneratorRuntime().mark(function e(){var t,r,n,i=this;return frame_callback_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.textures.length){e.next=2;break;}return e.abrupt("return",this.handleFramesTimeout=module_setTimeout(function(){i.handleFrames();},10));case 2:if(this.inputVideo.paused&&this.inputVideo.play(),r=performance.now(),this.isRunning&&!this.isPaused&&this.effectProcessor){e.next=12;break;}return this.textures.forEach(function(e){return e.destroy(!0);}),this.textures=[],this.renderer.addToEffects(this.videoFrame.frame),this.renderer.render(),this.renderer.removeFromEffects(this.videoFrame.frame),this.toCanvas&&(null===(t=this.toCanvas.getContext("2d"))||void 0===t||t.drawImage(this.renderer.renderer.view,0,0,this.toCanvas.width,this.toCanvas.height)),e.abrupt("return",this.handleFramesTimeout=module_setTimeout(function(){i.handleFrames();},Math.max(0,this.duration-(performance.now()-r))));case 12:if(n=this.textures.shift(),this.effectProcessor.nextFrame(new Texture(n)),!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=17;break;}return e.next=17,this.onProcessPromise.promise;case 17:return this.onProcessPromise=new Deferred(),this.nextTick().then(function(){i.onProcessPromise.resolve();}),e.abrupt("return",this.handleFramesTimeout=module_setTimeout(function(){i.handleFrames();},0));case 20:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"process",value:function value(){var e=this;if(this.stopTimers(),this.getInputVideoTrack()){var t=this.getInputVideoStream();t&&(this.inputVideo.srcObject=t,this.inputVideo.muted=!0,this.inputVideo.setAttribute("playsinline",!0),this.inputVideo.playsInline=!0,this.inputVideo.play().then(function(){e.videoTexture=new Texture(e.inputVideo),e.videoFrame=new Frame(e.videoTexture,{width:e.sdkOptions.width,height:e.sdkOptions.height});})),this.startTimers();}else errorBus.bv.notify({message:"there is no videoTrack to process",emitter:errorBus.JK.SRTEAM_PROCESSOR});}},{key:"getInputVideoStream",value:function value(){return this.stream?this.stream:null;}},{key:"getStream",value:function value(){var e=this;return this.outputStream||(this.outputStream=this.renderer.renderer.view.captureStream(30),this.outputStream.getVideoTracks()[0].getSettings=function(){return e.videoTrackWrapper.getSettings();},this.outputStream.getVideoTracks()[0].getConstraints=function(){return e.videoTrackWrapper.getConstraints();},this.outputStream.getVideoTracks()[0].getCapabilities=function(){return e.videoTrackWrapper.getCapabilities();},this.outputStream.getVideoTracks()[0].applyConstraints=function(t){return e.videoTrackWrapper.applyConstraints(t);},this.stream&&this.stream.getAudioTracks().forEach(function(t,r){e.outputStream.addTrack(t);})),this.outputStream;}}]);var r,n,i,o,a;}();function animation_callback_typeof(e){return animation_callback_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},animation_callback_typeof(e);}function animation_callback_regeneratorRuntime(){animation_callback_regeneratorRuntime=function animation_callback_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==animation_callback_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(animation_callback_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function animation_callback_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function animation_callback_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){animation_callback_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){animation_callback_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function animation_callback_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function animation_callback_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,animation_callback_toPropertyKey(n.key),n);}}function animation_callback_createClass(e,t,r){return t&&animation_callback_defineProperties(e.prototype,t),r&&animation_callback_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function animation_callback_toPropertyKey(e){var t=animation_callback_toPrimitive(e,"string");return"symbol"==animation_callback_typeof(t)?t:t+"";}function animation_callback_toPrimitive(e,t){if("object"!=animation_callback_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=animation_callback_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function animation_callback_callSuper(e,t,r){return t=animation_callback_getPrototypeOf(t),animation_callback_possibleConstructorReturn(e,animation_callback_isNativeReflectConstruct()?Reflect.construct(t,r||[],animation_callback_getPrototypeOf(e).constructor):t.apply(e,r));}function animation_callback_possibleConstructorReturn(e,t){if(t&&("object"==animation_callback_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return animation_callback_assertThisInitialized(e);}function animation_callback_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function animation_callback_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(animation_callback_isNativeReflectConstruct=function animation_callback_isNativeReflectConstruct(){return!!e;})();}function animation_callback_superPropGet(e,t,r,n){var i=animation_callback_get(animation_callback_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e);}:i;}function animation_callback_get(){return animation_callback_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=animation_callback_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value;}},animation_callback_get.apply(null,arguments);}function animation_callback_superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=animation_callback_getPrototypeOf(e)););return e;}function animation_callback_getPrototypeOf(e){return animation_callback_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},animation_callback_getPrototypeOf(e);}function animation_callback_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&animation_callback_setPrototypeOf(e,t);}function animation_callback_setPrototypeOf(e,t){return animation_callback_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},animation_callback_setPrototypeOf(e,t);}var AnimationCallbackStreamProcessor=function(e){function t(e){var r;return animation_callback_classCallCheck(this,t),(r=animation_callback_callSuper(this,t,[e])).timing=performance.now(),r;}return animation_callback_inherits(t,FrameCallbackStreamProcessor),animation_callback_createClass(t,[{key:"gatherByCallback",value:(r=animation_callback_asyncToGenerator(animation_callback_regeneratorRuntime().mark(function e(){var t=this;return animation_callback_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.hidden){e.next=3;break;}return this.requestAnimationFrameID=window.requestAnimationFrame(function(){return t.gatherByCallback();}),e.abrupt("return");case 3:performance.now()-this.timing>.85*this.duration&&(this.gatherFrames(),this.timing=performance.now()),this.requestAnimationFrameID=window.requestAnimationFrame(function(){return t.gatherByCallback();});case 6:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"stopTimers",value:function value(){if(animation_callback_superPropGet(t,"stopTimers",this,3)([]),this.requestAnimationFrameID)try{cancelAnimationFrame(this.requestAnimationFrameID),this.requestAnimationFrameID=0;}catch(e){}}}]);var r;}();function transform_typeof(e){return transform_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},transform_typeof(e);}function transform_regeneratorRuntime(){transform_regeneratorRuntime=function transform_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==transform_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(transform_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function transform_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function transform_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){transform_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){transform_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function transform_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function transform_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,transform_toPropertyKey(n.key),n);}}function transform_createClass(e,t,r){return t&&transform_defineProperties(e.prototype,t),r&&transform_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function transform_toPropertyKey(e){var t=transform_toPrimitive(e,"string");return"symbol"==transform_typeof(t)?t:t+"";}function transform_toPrimitive(e,t){if("object"!=transform_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=transform_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function transform_callSuper(e,t,r){return t=transform_getPrototypeOf(t),transform_possibleConstructorReturn(e,transform_isNativeReflectConstruct()?Reflect.construct(t,r||[],transform_getPrototypeOf(e).constructor):t.apply(e,r));}function transform_possibleConstructorReturn(e,t){if(t&&("object"==transform_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return transform_assertThisInitialized(e);}function transform_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function transform_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(transform_isNativeReflectConstruct=function transform_isNativeReflectConstruct(){return!!e;})();}function transform_getPrototypeOf(e){return transform_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},transform_getPrototypeOf(e);}function transform_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&transform_setPrototypeOf(e,t);}function transform_setPrototypeOf(e,t){return transform_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},transform_setPrototypeOf(e,t);}var TransformStreamProcessor=function(e){function t(e){var r;return transform_classCallCheck(this,t),(r=transform_callSuper(this,t,[e])).frameTimes=[],r.aborter=new AbortController(),r;}return transform_inherits(t,StreamProcessor),transform_createClass(t,[{key:"clearBuffers",value:function value(){this.effectProcessor.clearBuffers();}},{key:"destroy",value:function value(){this.outputStream&&this.outputStream.getTracks().forEach(function(e){e.stop();}),this.aborter.abort("stream_processor is destroyed");}},{key:"nextTick",value:(n=transform_asyncToGenerator(transform_regeneratorRuntime().mark(function e(t,r){var n,i,o,a,s,u,l,c;return transform_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=this.frameDrawFunction)||void 0===n||n.call(this),this.videoTrackWrapper.update(t.displayWidth,t.displayHeight),this.frame_count++,this.lastFrameTime=performance.now(),this.frameTimer.finish(),this.frameTimer.start(),e.next=8,this.effectProcessor.process();case 8:this.drawFps();try{l=this.renderer.getVideoFrameSettings(),c=this.renderer.getVideoFrameData(),u=new VideoFrame(c,Object.assign({duration:this.frameTimer.getFrameDuration(),timestamp:t.timestamp},l)),t.close();try{r.enqueue(u);}catch(e){errorBus.bv.notify({message:null!==(i=e.message)&&void 0!==i?i:e,emitter:errorBus.JK.SRTEAM_PROCESSOR,cause:e}),u.close();}this.toCanvas&&(null===(o=this.toCanvas.getContext("2d"))||void 0===o||o.clearRect(0,0,this.toCanvas.width,this.toCanvas.height),null===(a=this.toCanvas.getContext("2d"))||void 0===a||a.drawImage(this.renderer.renderer.view,0,0,this.toCanvas.width,this.toCanvas.height));}catch(e){errorBus.bv.notify({message:null!==(s=e.message)&&void 0!==s?s:e,emitter:errorBus.JK.SRTEAM_PROCESSOR,cause:e}),t.close();}case 10:case"end":return e.stop();}},e,this);})),function(e,t){return n.apply(this,arguments);})},{key:"handleFrames",value:(r=transform_asyncToGenerator(transform_regeneratorRuntime().mark(function e(t,r){var n,i=this;return transform_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isRunning&&!this.isPaused&&this.effectProcessor){e.next=3;break;}try{r.enqueue(t),this.toCanvas&&(null===(n=this.toCanvas.getContext("2d"))||void 0===n||n.drawImage(t,0,0,this.toCanvas.width,this.toCanvas.height));}catch(e){t.close();}return e.abrupt("return");case 3:if(this.effectProcessor.nextFrame(new Texture(t)),!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=7;break;}return e.next=7,this.onProcessPromise.promise;case 7:this.onProcessPromise=new Deferred(),this.nextTick(t,r).then(function(){i.onProcessPromise.resolve();});case 9:case"end":return e.stop();}},e,this);})),function(e,t){return r.apply(this,arguments);})},{key:"process",value:function value(){var e=this,t=this.getInputVideoTrack();if(t){this.outputVideoTrack=new MediaStreamTrackGenerator({kind:"video"}),this.outputVideoTrack.getSettings=function(){return e.videoTrackWrapper.getSettings();},this.outputVideoTrack.getConstraints=function(){return e.videoTrackWrapper.getConstraints();},this.outputVideoTrack.getCapabilities=function(){return e.videoTrackWrapper.getCapabilities();},this.outputVideoTrack.applyConstraints=function(t){return e.videoTrackWrapper.applyConstraints(t);},this.outputStream&&this.outputStream.getTracks().forEach(function(e){e.stop();}),this.outputStream=new MediaStream([this.outputVideoTrack]),this.stream&&this.stream.getAudioTracks().forEach(function(t,r){e.outputStream.addTrack(t);}),this.trackProcessor=new MediaStreamTrackProcessor({track:t}),this.timestamp=performance.now();var r=this,n=new TransformStream({transform:function transform(e,t){return transform_asyncToGenerator(transform_regeneratorRuntime().mark(function n(){return transform_regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.handleFrames(e,t);case 2:case"end":return n.stop();}},n);}))();}});this.trackProcessor.readable.pipeThrough(n,{signal:this.aborter.signal}).pipeTo(this.outputVideoTrack.writable)["catch"](function(e){var t;errorBus.bv.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:errorBus.JK.SRTEAM_PROCESSOR,cause:e});});}else errorBus.bv.notify({message:"there is no videoTrack to process",emitter:errorBus.JK.SRTEAM_PROCESSOR});}},{key:"getStream",value:function value(){return this.outputStream;}}]);var r,n;}();function video_callback_typeof(e){return video_callback_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},video_callback_typeof(e);}function video_callback_regeneratorRuntime(){video_callback_regeneratorRuntime=function video_callback_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==video_callback_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(video_callback_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function video_callback_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function video_callback_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){video_callback_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){video_callback_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function video_callback_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function video_callback_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,video_callback_toPropertyKey(n.key),n);}}function video_callback_createClass(e,t,r){return t&&video_callback_defineProperties(e.prototype,t),r&&video_callback_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function video_callback_toPropertyKey(e){var t=video_callback_toPrimitive(e,"string");return"symbol"==video_callback_typeof(t)?t:t+"";}function video_callback_toPrimitive(e,t){if("object"!=video_callback_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=video_callback_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function video_callback_callSuper(e,t,r){return t=video_callback_getPrototypeOf(t),video_callback_possibleConstructorReturn(e,video_callback_isNativeReflectConstruct()?Reflect.construct(t,r||[],video_callback_getPrototypeOf(e).constructor):t.apply(e,r));}function video_callback_possibleConstructorReturn(e,t){if(t&&("object"==video_callback_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return video_callback_assertThisInitialized(e);}function video_callback_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function video_callback_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(video_callback_isNativeReflectConstruct=function video_callback_isNativeReflectConstruct(){return!!e;})();}function video_callback_superPropGet(e,t,r,n){var i=video_callback_get(video_callback_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e);}:i;}function video_callback_get(){return video_callback_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=video_callback_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value;}},video_callback_get.apply(null,arguments);}function video_callback_superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=video_callback_getPrototypeOf(e)););return e;}function video_callback_getPrototypeOf(e){return video_callback_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},video_callback_getPrototypeOf(e);}function video_callback_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&video_callback_setPrototypeOf(e,t);}function video_callback_setPrototypeOf(e,t){return video_callback_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},video_callback_setPrototypeOf(e,t);}var VideoCallbackStreamProcessor=function(e){function t(e){var r;return video_callback_classCallCheck(this,t),(r=video_callback_callSuper(this,t,[e])).timing=performance.now(),r;}return video_callback_inherits(t,FrameCallbackStreamProcessor),video_callback_createClass(t,[{key:"gatherByCallback",value:(r=video_callback_asyncToGenerator(video_callback_regeneratorRuntime().mark(function e(){var t=this;return video_callback_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.hidden){e.next=3;break;}return this.gatherFramesTimeout=setTimeout(function(){t.inputVideo.requestVideoFrameCallback(function(){return t.gatherByCallback();});},0),e.abrupt("return");case 3:performance.now()-this.timing>.85*this.duration&&(this.gatherFrames(),this.timing=performance.now()),this.gatherFramesTimeout=setTimeout(function(){t.inputVideo.requestVideoFrameCallback(function(){return t.gatherByCallback();});},0);case 6:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"stopTimers",value:function value(){if(video_callback_superPropGet(t,"stopTimers",this,3)([]),this.requestVideoFrameID)try{this.inputVideo.cancelVideoFrameCallback(this.requestVideoFrameID),this.requestVideoFrameID=0;}catch(e){}}}]);var r;}();function factory_typeof(e){return factory_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},factory_typeof(e);}function factory_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function factory_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,factory_toPropertyKey(n.key),n);}}function factory_createClass(e,t,r){return t&&factory_defineProperties(e.prototype,t),r&&factory_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function factory_toPropertyKey(e){var t=factory_toPrimitive(e,"string");return"symbol"==factory_typeof(t)?t:t+"";}function factory_toPrimitive(e,t){if("object"!=factory_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=factory_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var streamProcessorMap={transform:TransformStreamProcessor,videocallback:VideoCallbackStreamProcessor,animationcallback:AnimationCallbackStreamProcessor},StreamProcessorFactory=function(){return factory_createClass(function e(){factory_classCallCheck(this,e);},null,[{key:"getStreamProcessor",value:function value(e,t){return new streamProcessorMap[e](t);}}]);}(),ort_min=__webpack_require__(7734),process=__webpack_require__(5606),ort_webgpu_min_Buffer=__webpack_require__(8287).hp,Xn=Object.defineProperty,id=Object.getOwnPropertyDescriptor,od=Object.getOwnPropertyNames,sd=Object.prototype.hasOwnProperty,q=function q(e,t){return function(){return e&&(t=e(e=0)),t;};},ur=function ur(e,t){return function(){return t||e((t={exports:{}}).exports,t),t.exports;};},Ft=function Ft(e,t){for(var r in t)Xn(e,r,{get:t[r],enumerable:!0});},ud=function ud(e,t,r,n){if(t&&"object"==_typeof2(t)||"function"==typeof t){var _iterator52=_createForOfIteratorHelper2(od(t)),_step52;try{var _loop12=function _loop12(){var i=_step52.value;!sd.call(e,i)&&i!==r&&Xn(e,i,{get:function get(){return t[i];},enumerable:!(n=id(t,i))||n.enumerable});};for(_iterator52.s();!(_step52=_iterator52.n()).done;){_loop12();}}catch(err){_iterator52.e(err);}finally{_iterator52.f();}}return e;},Et=function Et(e){return ud(Xn({},"__esModule",{value:!0}),e);},rn,qt,lr,nn,an=q(function(){rn=new Map(),qt=[],lr=function lr(e,t,r){if(!t||"function"!=typeof t.init||"function"!=typeof t.createInferenceSessionHandler)throw new TypeError("not a valid backend");{var n=rn.get(e);if(void 0===n)rn.set(e,{backend:t,priority:r});else{if(n.priority>r)return;if(n.priority===r&&n.backend!==t)throw new Error("cannot register backend \"".concat(e,"\" using priority ").concat(r));}if(r>=0){var _t338=qt.indexOf(e);-1!==_t338&&qt.splice(_t338,1);for(var _t339=0;_t339<qt.length;_t339++)if(rn.get(qt[_t339]).priority<=r)return void qt.splice(_t339,0,e);qt.push(e);}}},nn=/*#__PURE__*/function(){var _ref70=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee133(e){var t,r,_iterator53,_step53,_e821,_t340,n;return _regeneratorRuntime2().wrap(function _callee133$(_context137){while(1)switch(_context137.prev=_context137.next){case 0:t=0===e.length?qt:e,r=[];_iterator53=_createForOfIteratorHelper2(t);_context137.prev=2;_iterator53.s();case 4:if((_step53=_iterator53.n()).done){_context137.next=29;break;}_e821=_step53.value;_t340=rn.get(_e821);if(!_t340){_context137.next=27;break;}if(!_t340.initialized){_context137.next=10;break;}return _context137.abrupt("return",_t340.backend);case 10:if(!_t340.aborted){_context137.next=12;break;}return _context137.abrupt("continue",27);case 12:n=!!_t340.initPromise;_context137.prev=13;n||(_t340.initPromise=_t340.backend.init(_e821));_context137.next=17;return _t340.initPromise;case 17:_t340.initialized=!0;return _context137.abrupt("return",_t340.backend);case 21:_context137.prev=21;_context137.t0=_context137["catch"](13);n||r.push({name:_e821,err:_context137.t0}),_t340.aborted=!0;case 24:_context137.prev=24;delete _t340.initPromise;return _context137.finish(24);case 27:_context137.next=4;break;case 29:_context137.next=34;break;case 31:_context137.prev=31;_context137.t1=_context137["catch"](2);_iterator53.e(_context137.t1);case 34:_context137.prev=34;_iterator53.f();return _context137.finish(34);case 37:throw new Error("no available backend found. ERR: ".concat(r.map(function(e){return"[".concat(e.name,"] ").concat(e.err);}).join(", ")));case 38:case"end":return _context137.stop();}},_callee133,null,[[2,31,34,37],[13,21,24,27]]);}));return function nn(_x153){return _ref70.apply(this,arguments);};}();}),ci=q(function(){an();}),pi,mi=q(function(){pi="1.17.0";}),fi,jt,Jn=q(function(){mi(),fi="warning",jt={wasm:{},webgl:{},webgpu:{},versions:{common:pi},set logLevel(e){if(void 0!==e){if("string"!=typeof e||-1===["verbose","info","warning","error","fatal"].indexOf(e))throw new Error("Unsupported logging level: ".concat(e));fi=e;}},get logLevel(){return fi;}},Object.defineProperty(jt,"logLevel",{enumerable:!0});}),Se,hi=q(function(){Jn(),Se=jt;}),gi,yi,bi=q(function(){gi=function gi(e,t){var r=(typeof document==="undefined"?"undefined":_typeof2(document))<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);r.width=e.dims[3],r.height=e.dims[2];var n=r.getContext("2d");if(null!=n){var i,_o98;void 0!==(t===null||t===void 0?void 0:t.tensorLayout)&&"NHWC"===t.tensorLayout?(i=e.dims[2],_o98=e.dims[3]):(i=e.dims[3],_o98=e.dims[2]);var _a81,_s59,_u44=void 0!==(t===null||t===void 0?void 0:t.format)?t.format:"RGB",_l32=t===null||t===void 0?void 0:t.norm;void 0===_l32||void 0===_l32.mean?_a81=[255,255,255,255]:"number"==typeof _l32.mean?_a81=[_l32.mean,_l32.mean,_l32.mean,_l32.mean]:(_a81=[_l32.mean[0],_l32.mean[1],_l32.mean[2],0],void 0!==_l32.mean[3]&&(_a81[3]=_l32.mean[3])),void 0===_l32||void 0===_l32.bias?_s59=[0,0,0,0]:"number"==typeof _l32.bias?_s59=[_l32.bias,_l32.bias,_l32.bias,_l32.bias]:(_s59=[_l32.bias[0],_l32.bias[1],_l32.bias[2],0],void 0!==_l32.bias[3]&&(_s59[3]=_l32.bias[3]));var _c32=_o98*i,_h27=0,_f19=_c32,_d18=2*_c32,_p16=-1;"RGBA"===_u44?(_h27=0,_f19=_c32,_d18=2*_c32,_p16=3*_c32):"RGB"===_u44?(_h27=0,_f19=_c32,_d18=2*_c32):"RBG"===_u44&&(_h27=0,_d18=_c32,_f19=2*_c32);for(var _t341=0;_t341<_o98;_t341++)for(var _r280=0;_r280<i;_r280++){var _i138=(e.data[_h27++]-_s59[0])*_a81[0],_o99=(e.data[_f19++]-_s59[1])*_a81[1],_u45=(e.data[_d18++]-_s59[2])*_a81[2],_l33=-1===_p16?255:(e.data[_p16++]-_s59[3])*_a81[3];n.fillStyle="rgba("+_i138+","+_o99+","+_u45+","+_l33+")",n.fillRect(_r280,_t341,1,1);}if("toDataURL"in r)return r.toDataURL();throw new Error("toDataURL is not supported");}throw new Error("Can not access image data");},yi=function yi(e,t){var r,n=(typeof document==="undefined"?"undefined":_typeof2(document))<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");if(null==n)throw new Error("Can not access image data");{var i,_o100,_a82;void 0!==(t===null||t===void 0?void 0:t.tensorLayout)&&"NHWC"===t.tensorLayout?(i=e.dims[2],_o100=e.dims[1],_a82=e.dims[3]):(i=e.dims[3],_o100=e.dims[2],_a82=e.dims[1]);var _s60,_u46,_l34=void 0!==t&&void 0!==t.format?t.format:"RGB",_c33=t===null||t===void 0?void 0:t.norm;void 0===_c33||void 0===_c33.mean?_s60=[255,255,255,255]:"number"==typeof _c33.mean?_s60=[_c33.mean,_c33.mean,_c33.mean,_c33.mean]:(_s60=[_c33.mean[0],_c33.mean[1],_c33.mean[2],255],void 0!==_c33.mean[3]&&(_s60[3]=_c33.mean[3])),void 0===_c33||void 0===_c33.bias?_u46=[0,0,0,0]:"number"==typeof _c33.bias?_u46=[_c33.bias,_c33.bias,_c33.bias,_c33.bias]:(_u46=[_c33.bias[0],_c33.bias[1],_c33.bias[2],0],void 0!==_c33.bias[3]&&(_u46[3]=_c33.bias[3]));var _h28=_o100*i;if(void 0!==t&&(void 0!==t.format&&4===_a82&&"RGBA"!==t.format||3===_a82&&"RGB"!==t.format&&"BGR"!==t.format))throw new Error("Tensor format doesn't match input tensor dims");var _f20=4,_d19=0,_p17=1,_y11=2,_m9=3,_g5=0,_w3=_h28,_b6=2*_h28,_v4=-1;"RGBA"===_l34?(_g5=0,_w3=_h28,_b6=2*_h28,_v4=3*_h28):"RGB"===_l34?(_g5=0,_w3=_h28,_b6=2*_h28):"RBG"===_l34&&(_g5=0,_b6=_h28,_w3=2*_h28),r=n.createImageData(i,_o100);for(var _t342=0;_t342<_o100*i;_d19+=_f20,_p17+=_f20,_y11+=_f20,_m9+=_f20,_t342++)r.data[_d19]=(e.data[_g5++]-_u46[0])*_s60[0],r.data[_p17]=(e.data[_w3++]-_u46[1])*_s60[1],r.data[_y11]=(e.data[_b6++]-_u46[2])*_s60[2],r.data[_m9]=-1===_v4?255:(e.data[_v4++]-_u46[3])*_s60[3];}return r;};}),Qn,wi,vi,$i,_i,xi=q(function(){on(),Qn=function Qn(e,t){var _t$norm2,_a$mean$2,_a$bias$2;if(void 0===e)throw new Error("Image buffer must be defined");if(void 0===t.height||void 0===t.width)throw new Error("Image height and width must be defined");if("NHWC"===t.tensorLayout)throw new Error("NHWC Tensor layout is not supported yet");var r,n,i=t.height,o=t.width,a=(_t$norm2=t.norm)!==null&&_t$norm2!==void 0?_t$norm2:{mean:255,bias:0};r="number"==typeof a.mean?[a.mean,a.mean,a.mean,a.mean]:[a.mean[0],a.mean[1],a.mean[2],(_a$mean$2=a.mean[3])!==null&&_a$mean$2!==void 0?_a$mean$2:255],n="number"==typeof a.bias?[a.bias,a.bias,a.bias,a.bias]:[a.bias[0],a.bias[1],a.bias[2],(_a$bias$2=a.bias[3])!==null&&_a$bias$2!==void 0?_a$bias$2:0];var s=void 0!==t.format?t.format:"RGBA",u=void 0!==t.tensorFormat&&void 0!==t.tensorFormat?t.tensorFormat:"RGB",l=i*o,c="RGBA"===u?new Float32Array(4*l):new Float32Array(3*l),h=4,f=0,d=1,p=2,y=3,m=0,g=l,w=2*l,b=-1;"RGB"===s&&(h=3,f=0,d=1,p=2,y=-1),"RGBA"===u?b=3*l:"RBG"===u?(m=0,w=l,g=2*l):"BGR"===u&&(w=0,g=l,m=2*l);for(var _t343=0;_t343<l;_t343++,f+=h,p+=h,d+=h,y+=h)c[m++]=(e[f]+n[0])/r[0],c[g++]=(e[d]+n[1])/r[1],c[w++]=(e[p]+n[2])/r[2],-1!==b&&-1!==y&&(c[b++]=(e[y]+n[3])/r[3]);return new et("float32",c,"RGBA"===u?[1,4,i,o]:[1,3,i,o]);},wi=/*#__PURE__*/function(){var _ref71=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee134(e,t){var r,n,i,o,a,s,u,l,_n190,_i139,_n191,_o101,_n192,_i140,_t344,_n193,_n194,_i141,_t345,_o102;return _regeneratorRuntime2().wrap(function _callee134$(_context138){while(1)switch(_context138.prev=_context138.next){case 0:n=(typeof HTMLImageElement==="undefined"?"undefined":_typeof2(HTMLImageElement))<"u"&&e instanceof HTMLImageElement,i=(typeof ImageData==="undefined"?"undefined":_typeof2(ImageData))<"u"&&e instanceof ImageData,o=(typeof ImageBitmap==="undefined"?"undefined":_typeof2(ImageBitmap))<"u"&&e instanceof ImageBitmap,a="string"==typeof e,s=t!==null&&t!==void 0?t:{},u=function u(){if((typeof document==="undefined"?"undefined":_typeof2(document))<"u")return document.createElement("canvas");if((typeof OffscreenCanvas==="undefined"?"undefined":_typeof2(OffscreenCanvas))<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported");},l=function l(e){return e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas?e.getContext("2d"):null;};if(!n){_context138.next=18;break;}_n190=u();_n190.width=e.width,_n190.height=e.height;_i139=l(_n190);if(!(null==_i139)){_context138.next=7;break;}throw new Error("Can not access image data");case 7:_n191=e.height,_o101=e.width;if(!(void 0!==t&&void 0!==t.resizedHeight&&void 0!==t.resizedWidth&&(_n191=t.resizedHeight,_o101=t.resizedWidth),void 0!==t)){_context138.next=14;break;}if(!(s=t,void 0!==t.tensorFormat)){_context138.next=11;break;}throw new Error("Image input config format must be RGBA for HTMLImageElement");case 11:s.tensorFormat="RGBA",s.height=_n191,s.width=_o101;_context138.next=15;break;case 14:s.tensorFormat="RGBA",s.height=_n191,s.width=_o101;case 15:_i139.drawImage(e,0,0),r=_i139.getImageData(0,0,_o101,_n191).data;_context138.next=42;break;case 18:if(i){_context138.next=32;break;}if(!o){_context138.next=29;break;}if(!(void 0===t)){_context138.next=22;break;}throw new Error("Please provide image config with format for Imagebitmap");case 22:_n192=u();_n192.width=e.width,_n192.height=e.height;_i140=l(_n192);if(!(null!=_i140)){_context138.next=28;break;}_t344=e.height,_n193=e.width;return _context138.abrupt("return",(_i140.drawImage(e,0,0,_n193,_t344),r=_i140.getImageData(0,0,_n193,_t344).data,s.height=_t344,s.width=_n193,Qn(r,s)));case 28:throw new Error("Can not access image data");case 29:if(!a){_context138.next=31;break;}return _context138.abrupt("return",new Promise(function(t,r){var n=u(),i=l(n);if(!e||!i)return r();var o=new Image();o.crossOrigin="Anonymous",o.src=e,o.onload=function(){n.width=o.width,n.height=o.height,i.drawImage(o,0,0,n.width,n.height);var e=i.getImageData(0,0,n.width,n.height);s.height=n.height,s.width=n.width,t(Qn(e.data,s));};}));case 31:throw new Error("Input data provided is not supported - aborted tensor creation");case 32:if(!(void 0!==t&&void 0!==t.resizedWidth&&void 0!==t.resizedHeight?(_n194=t.resizedHeight,_i141=t.resizedWidth):(_n194=e.height,_i141=e.width),void 0!==t&&(s=t),s.format="RGBA",s.height=_n194,s.width=_i141,void 0!==t)){_context138.next=41;break;}_t345=u();_t345.width=_i141,_t345.height=_n194;_o102=l(_t345);if(!(null==_o102)){_context138.next=38;break;}throw new Error("Can not access image data");case 38:_o102.putImageData(e,0,0),r=_o102.getImageData(0,0,_i141,_n194).data;_context138.next=42;break;case 41:r=e.data;case 42:if(!(void 0!==r)){_context138.next=44;break;}return _context138.abrupt("return",Qn(r,s));case 44:throw new Error("Input data provided is not supported - aborted tensor creation");case 45:case"end":return _context138.stop();}},_callee134);}));return function wi(_x154,_x155){return _ref71.apply(this,arguments);};}(),vi=function vi(e,t){var r=t.width,n=t.height,i=t.download,o=t.dispose;return new et({location:"texture",type:"float32",texture:e,dims:[1,n,r,4],download:i,dispose:o});},$i=function $i(e,t){var r=t.dataType,n=t.dims,i=t.download,o=t.dispose;return new et({location:"gpu-buffer",type:r!==null&&r!==void 0?r:"float32",gpuBuffer:e,dims:n,download:i,dispose:o});},_i=function _i(e,t,r){return new et({location:"cpu-pinned",type:e,data:t,dims:r!==null&&r!==void 0?r:[t.length]});};}),Or,sn,Si,Ii,Ci=q(function(){Or=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["float16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),sn=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),Si=!1,Ii=function Ii(){if(!Si){Si=!0;var _e822=(typeof BigInt64Array==="undefined"?"undefined":_typeof2(BigInt64Array))<"u"&&"function"==typeof BigInt64Array.from,_t346=(typeof BigUint64Array==="undefined"?"undefined":_typeof2(BigUint64Array))<"u"&&"function"==typeof BigUint64Array.from;_e822&&(Or.set("int64",BigInt64Array),sn.set(BigInt64Array,"int64")),_t346&&(Or.set("uint64",BigUint64Array),sn.set(BigUint64Array,"uint64"));}};}),Ai,Ti,Ei=q(function(){on(),Ai=function Ai(e){var t=1;for(var r=0;r<e.length;r++){var n=e[r];if("number"!=typeof n||!Number.isSafeInteger(n))throw new TypeError("dims[".concat(r,"] must be an integer, got: ").concat(n));if(n<0)throw new RangeError("dims[".concat(r,"] must be a non-negative integer, got: ").concat(n));t*=n;}return t;},Ti=function Ti(e,t){switch(e.location){case"cpu":return new et(e.type,e.data,t);case"cpu-pinned":return new et({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new et({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new et({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});default:throw new Error("tensorReshape: tensor location ".concat(e.location," is not supported"));}};}),et,on=q(function(){bi(),xi(),Ci(),Ei(),et=/*#__PURE__*/function(){function et(e,t,r){_classCallCheck2(this,et);var n,i;if(Ii(),"object"==_typeof2(e)&&"location"in e)switch(this.dataLocation=e.location,n=e.type,i=e.dims,e.location){case"cpu-pinned":{var _t347=Or.get(n);if(!_t347)throw new TypeError("unsupported type \"".concat(n,"\" to create tensor from pinned buffer"));if(!(e.data instanceof _t347))throw new TypeError("buffer should be of type ".concat(_t347.name));this.cpuData=e.data;break;}case"texture":if("float32"!==n)throw new TypeError("unsupported type \"".concat(n,"\" to create tensor from texture"));this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break;case"gpu-buffer":if("float32"!==n&&"float16"!==n&&"int32"!==n&&"int64"!==n&&"uint32"!==n&&"bool"!==n)throw new TypeError("unsupported type \"".concat(n,"\" to create tensor from gpu buffer"));this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break;default:throw new Error("Tensor constructor: unsupported location '".concat(this.dataLocation,"'"));}else{var _o103,_a83;if("string"==typeof e){if(n=e,_a83=r,"string"===e){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");_o103=t;}else{var _r281=Or.get(e);if(void 0===_r281)throw new TypeError("Unsupported tensor type: ".concat(e,"."));if(Array.isArray(t)){if("float16"===e)throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");_o103="uint64"===e||"int64"===e?_r281.from(t,BigInt):_r281.from(t);}else{if(!(t instanceof _r281))throw new TypeError("A ".concat(n," tensor's data must be type of ").concat(_r281));_o103=t;}}}else if(_a83=t,Array.isArray(e)){if(0===e.length)throw new TypeError("Tensor type cannot be inferred from an empty array.");var _t348=_typeof2(e[0]);if("string"===_t348)n="string",_o103=e;else{if("boolean"!==_t348)throw new TypeError("Invalid element type of data array: ".concat(_t348,"."));n="bool",_o103=Uint8Array.from(e);}}else{var _t349=sn.get(e.constructor);if(void 0===_t349)throw new TypeError("Unsupported type for tensor data: ".concat(e.constructor,"."));n=_t349,_o103=e;}if(void 0===_a83)_a83=[_o103.length];else if(!Array.isArray(_a83))throw new TypeError("A tensor's dims must be a number array");i=_a83,this.cpuData=_o103,this.dataLocation="cpu";}var o=Ai(i);if(this.cpuData&&o!==this.cpuData.length)throw new Error("Tensor's size(".concat(o,") does not match data length(").concat(this.cpuData.length,")."));this.type=n,this.dims=i,this.size=o;}return _createClass2(et,[{key:"toDataURL",value:function toDataURL(e){return gi(this,e);}},{key:"toImageData",value:function toImageData(e){return yi(this,e);}},{key:"data",get:function get(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData;}},{key:"location",get:function get(){return this.dataLocation;}},{key:"texture",get:function get(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData;}},{key:"gpuBuffer",get:function get(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData;}},{key:"getData",value:function(){var _getData3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee135(e){var _t350;return _regeneratorRuntime2().wrap(function _callee135$(_context139){while(1)switch(_context139.prev=_context139.next){case 0:_context139.t0=(this.ensureValid(),this.dataLocation);_context139.next=_context139.t0==="cpu"?3:_context139.t0==="cpu-pinned"?3:_context139.t0==="texture"?4:_context139.t0==="gpu-buffer"?4:17;break;case 3:return _context139.abrupt("return",this.data);case 4:if(this.downloader){_context139.next=6;break;}throw new Error("The current tensor is not created with a specified data downloader.");case 6:if(!this.isDownloading){_context139.next=8;break;}throw new Error("The current tensor is being downloaded.");case 8:_context139.prev=8;this.isDownloading=!0;_context139.next=12;return this.downloader();case 12:_t350=_context139.sent;return _context139.abrupt("return",(this.downloader=void 0,this.dataLocation="cpu",this.cpuData=_t350,e&&this.disposer&&(this.disposer(),this.disposer=void 0),_t350));case 14:_context139.prev=14;this.isDownloading=!1;return _context139.finish(14);case 17:throw new Error("cannot get data from location: ".concat(this.dataLocation));case 18:case"end":return _context139.stop();}},_callee135,this,[[8,,14,17]]);}));function getData(_x156){return _getData3.apply(this,arguments);}return getData;}()},{key:"dispose",value:function dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none";}},{key:"ensureValid",value:function ensureValid(){if("none"===this.dataLocation)throw new Error("The tensor is disposed.");}},{key:"reshape",value:function reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return Ti(this,e);}}],[{key:"fromImage",value:function(){var _fromImage2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee136(e,t){return _regeneratorRuntime2().wrap(function _callee136$(_context140){while(1)switch(_context140.prev=_context140.next){case 0:return _context140.abrupt("return",wi(e,t));case 1:case"end":return _context140.stop();}},_callee136);}));function fromImage(_x157,_x158){return _fromImage2.apply(this,arguments);}return fromImage;}()},{key:"fromTexture",value:function fromTexture(e,t){return vi(e,t);}},{key:"fromGpuBuffer",value:function fromGpuBuffer(e,t){return $i(e,t);}},{key:"fromPinnedBuffer",value:function fromPinnedBuffer(e,t,r){return _i(e,t,r);}}]);}();}),Xe,un=q(function(){on(),Xe=et;}),ln,Oi,st,ut,ea=q(function(){Jn(),ln=function ln(e,t){jt.wasm.trace&&console.timeStamp("".concat(e,"::ORT::").concat(t));},Oi=function Oi(e,t){var _Error$stack2;var r=((_Error$stack2=new Error().stack)===null||_Error$stack2===void 0?void 0:_Error$stack2.split(/\r\n|\r|\n/g))||[],n=!1;for(var i=0;i<r.length;i++){if(n&&!r[i].includes("TRACE_FUNC")){var _n195="FUNC_".concat(e,"::").concat(r[i].trim().split(" ")[1]);return t&&(_n195+="::".concat(t)),void ln("CPU",_n195);}r[i].includes("TRACE_FUNC")&&(n=!0);}},st=function st(e){jt.wasm.trace&&Oi("BEGIN",e);},ut=function ut(e){jt.wasm.trace&&Oi("END",e);};}),dn,ki=q(function(){an(),un(),ea(),dn=/*#__PURE__*/function(){function e(_e823){_classCallCheck2(this,e);this.handler=_e823;}return _createClass2(e,[{key:"run",value:function(){var _run6=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee137(_e824,t,r){var n,i,o,_iterator54,_step54,_e825,_e826,_a84,_iterator55,_step55,_r282,_i142,_iterator56,_step56,_t352,_iterator57,_step57,_e827,a,s,_e833,_t351;return _regeneratorRuntime2().wrap(function _callee137$(_context141){while(1)switch(_context141.prev=_context141.next){case 0:st();n={},i={};if(!("object"!=_typeof2(_e824)||null===_e824||_e824 instanceof Xe||Array.isArray(_e824))){_context141.next=4;break;}throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");case 4:o=!0;if(!("object"==_typeof2(t))){_context141.next=57;break;}if(!(null===t)){_context141.next=8;break;}throw new TypeError("Unexpected argument[1]: cannot be null.");case 8:if(!(t instanceof Xe)){_context141.next=10;break;}throw new TypeError("'fetches' cannot be a Tensor");case 10:if(!Array.isArray(t)){_context141.next=42;break;}if(!(0===t.length)){_context141.next=13;break;}throw new TypeError("'fetches' cannot be an empty array.");case 13:o=!1;_iterator54=_createForOfIteratorHelper2(t);_context141.prev=15;_iterator54.s();case 17:if((_step54=_iterator54.n()).done){_context141.next=26;break;}_e825=_step54.value;if(!("string"!=typeof _e825)){_context141.next=21;break;}throw new TypeError("'fetches' must be a string array or an object.");case 21:if(!(-1===this.outputNames.indexOf(_e825))){_context141.next=23;break;}throw new RangeError("'fetches' contains invalid output name: ".concat(_e825,"."));case 23:n[_e825]=null;case 24:_context141.next=17;break;case 26:_context141.next=31;break;case 28:_context141.prev=28;_context141.t0=_context141["catch"](15);_iterator54.e(_context141.t0);case 31:_context141.prev=31;_iterator54.f();return _context141.finish(31);case 34:if(!("object"==_typeof2(r)&&null!==r)){_context141.next=38;break;}i=r;_context141.next=40;break;case 38:if(!(_typeof2(r)<"u")){_context141.next=40;break;}throw new TypeError("'options' must be an object.");case 40:_context141.next=55;break;case 42:_e826=!1,_a84=Object.getOwnPropertyNames(t);_iterator55=_createForOfIteratorHelper2(this.outputNames);try{for(_iterator55.s();!(_step55=_iterator55.n()).done;){_r282=_step55.value;if(-1!==_a84.indexOf(_r282)){_i142=t[_r282];(null===_i142||_i142 instanceof Xe)&&(_e826=!0,o=!1,n[_r282]=_i142);}}}catch(err){_iterator55.e(err);}finally{_iterator55.f();}if(!_e826){_context141.next=54;break;}if(!("object"==_typeof2(r)&&null!==r)){_context141.next=50;break;}i=r;_context141.next=52;break;case 50:if(!(_typeof2(r)<"u")){_context141.next=52;break;}throw new TypeError("'options' must be an object.");case 52:_context141.next=55;break;case 54:i=t;case 55:_context141.next=59;break;case 57:if(!(_typeof2(t)<"u")){_context141.next=59;break;}throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");case 59:_iterator56=_createForOfIteratorHelper2(this.inputNames);_context141.prev=60;_iterator56.s();case 62:if((_step56=_iterator56.n()).done){_context141.next=68;break;}_t352=_step56.value;if(!(_typeof2(_e824[_t352])>"u")){_context141.next=66;break;}throw new Error("input '".concat(_t352,"' is missing in 'feeds'."));case 66:_context141.next=62;break;case 68:_context141.next=73;break;case 70:_context141.prev=70;_context141.t1=_context141["catch"](60);_iterator56.e(_context141.t1);case 73:_context141.prev=73;_iterator56.f();return _context141.finish(73);case 76:if(o){_iterator57=_createForOfIteratorHelper2(this.outputNames);try{for(_iterator57.s();!(_step57=_iterator57.n()).done;){_e827=_step57.value;n[_e827]=null;}}catch(err){_iterator57.e(err);}finally{_iterator57.f();}}_context141.next=79;return this.handler.run(_e824,n,i);case 79:a=_context141.sent;s={};for(_e833 in a)if(Object.hasOwnProperty.call(a,_e833)){_t351=a[_e833];s[_e833]=_t351 instanceof Xe?_t351:new Xe(_t351.type,_t351.data,_t351.dims);}return _context141.abrupt("return",(ut(),s));case 83:case"end":return _context141.stop();}},_callee137,this,[[15,28,31,34],[60,70,73,76]]);}));function run(_x159,_x160,_x161){return _run6.apply(this,arguments);}return run;}()},{key:"release",value:function(){var _release3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee138(){return _regeneratorRuntime2().wrap(function _callee138$(_context142){while(1)switch(_context142.prev=_context142.next){case 0:return _context142.abrupt("return",this.handler.dispose());case 1:case"end":return _context142.stop();}},_callee138,this);}));function release(){return _release3.apply(this,arguments);}return release;}()},{key:"configure",value:function(){var _configure4=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee139(_e829){return _regeneratorRuntime2().wrap(function _callee139$(_context143){while(1)switch(_context143.prev=_context143.next){case 0:_context143.next=2;return this.handler.configure(_e829);case 2:return _context143.abrupt("return",_context143.sent);case 3:case"end":return _context143.stop();}},_callee139,this);}));function configure(_x162){return _configure4.apply(this,arguments);}return configure;}()},{key:"auth",value:function(){var _auth4=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee140(_e830){return _regeneratorRuntime2().wrap(function _callee140$(_context144){while(1)switch(_context144.prev=_context144.next){case 0:_context144.next=2;return this.handler.auth(_e830);case 2:return _context144.abrupt("return",_context144.sent);case 3:case"end":return _context144.stop();}},_callee140,this);}));function auth(_x163){return _auth4.apply(this,arguments);}return auth;}()},{key:"startProfiling",value:function startProfiling(){this.handler.startProfiling();}},{key:"endProfiling",value:function endProfiling(){this.handler.endProfiling();}},{key:"inputNames",get:function get(){return this.handler.inputNames;}},{key:"outputNames",get:function get(){return this.handler.outputNames;}}],[{key:"create",value:function(){var _create3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee141(t,r,n,i){var o,a,_e831,_s61,_u47,s,u;return _regeneratorRuntime2().wrap(function _callee141$(_context145){while(1)switch(_context145.prev=_context145.next){case 0:st();a={};if(!("string"==typeof t)){_context145.next=11;break;}if(!(o=t,"object"==_typeof2(r)&&null!==r)){_context145.next=7;break;}a=r;_context145.next=9;break;case 7:if(!(_typeof2(r)<"u")){_context145.next=9;break;}throw new TypeError("'options' must be an object.");case 9:_context145.next=52;break;case 11:if(!(t instanceof Uint8Array)){_context145.next=20;break;}if(!(o=t,"object"==_typeof2(r)&&null!==r)){_context145.next=16;break;}a=r;_context145.next=18;break;case 16:if(!(_typeof2(r)<"u")){_context145.next=18;break;}throw new TypeError("'options' must be an object.");case 18:_context145.next=52;break;case 20:if(t instanceof ArrayBuffer||(typeof SharedArrayBuffer==="undefined"?"undefined":_typeof2(SharedArrayBuffer))<"u"&&t instanceof SharedArrayBuffer){_context145.next=22;break;}throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");case 22:_e831=t,_s61=0,_u47=t.byteLength;if(!("object"==_typeof2(r)&&null!==r)){_context145.next=27;break;}a=r;_context145.next=51;break;case 27:if(!("number"==typeof r)){_context145.next=49;break;}if(!(_s61=r,!Number.isSafeInteger(_s61))){_context145.next=30;break;}throw new RangeError("'byteOffset' must be an integer.");case 30:if(!(_s61<0||_s61>=_e831.byteLength)){_context145.next=32;break;}throw new RangeError("'byteOffset' is out of range [0, ".concat(_e831.byteLength,")."));case 32:if(!(_u47=t.byteLength-_s61,"number"==typeof n)){_context145.next=45;break;}if(!(_u47=n,!Number.isSafeInteger(_u47))){_context145.next=35;break;}throw new RangeError("'byteLength' must be an integer.");case 35:if(!(_u47<=0||_s61+_u47>_e831.byteLength)){_context145.next=37;break;}throw new RangeError("'byteLength' is out of range (0, ".concat(_e831.byteLength-_s61,"]."));case 37:if(!("object"==_typeof2(i)&&null!==i)){_context145.next=41;break;}a=i;_context145.next=43;break;case 41:if(!(_typeof2(i)<"u")){_context145.next=43;break;}throw new TypeError("'options' must be an object.");case 43:_context145.next=47;break;case 45:if(!(_typeof2(n)<"u")){_context145.next=47;break;}throw new TypeError("'byteLength' must be a number.");case 47:_context145.next=51;break;case 49:if(!(_typeof2(r)<"u")){_context145.next=51;break;}throw new TypeError("'options' must be an object.");case 51:o=new Uint8Array(_e831,_s61,_u47);case 52:s=(a.executionProviders||[]).map(function(_e832){return"string"==typeof _e832?_e832:_e832.name;});_context145.next=55;return nn(s);case 55:_context145.next=57;return _context145.sent.createInferenceSessionHandler(o,a);case 57:u=_context145.sent;return _context145.abrupt("return",(ut(),new e(u)));case 59:case"end":return _context145.stop();}},_callee141);}));function create(_x164,_x165,_x166,_x167){return _create3.apply(this,arguments);}return create;}()}]);}();}),ld,Bi=q(function(){ki(),ld=dn;}),Pi=q(function(){}),dd,cn,Ri=q(function(){an(),un(),dd="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",cn=/*#__PURE__*/function(){function e(_e834,t,r){_classCallCheck2(this,e);this.handler=_e834,this.hasOptimizerModel=t,this.hasEvalModel=r;}return _createClass2(e,[{key:"trainingInputNames",get:function get(){return this.handler.inputNames;}},{key:"trainingOutputNames",get:function get(){return this.handler.outputNames;}},{key:"evalInputNames",get:function get(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.");}},{key:"evalOutputNames",get:function get(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.");}},{key:"typeNarrowingForRunStep",value:function typeNarrowingForRunStep(_e836,t,r,n,i){var o={},a={};if("object"!=_typeof2(r)||null===r||r instanceof Xe||Array.isArray(r))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");var s=!0;if("object"==_typeof2(n)){if(null===n)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof Xe)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(0===n.length)throw new TypeError("'fetches' cannot be an empty array.");s=!1;var _iterator58=_createForOfIteratorHelper2(n),_step58;try{for(_iterator58.s();!(_step58=_iterator58.n()).done;){var _e837=_step58.value;if("string"!=typeof _e837)throw new TypeError("'fetches' must be a string array or an object.");if(-1===t.indexOf(_e837))throw new RangeError("'fetches' contains invalid output name: ".concat(_e837,"."));o[_e837]=null;}}catch(err){_iterator58.e(err);}finally{_iterator58.f();}if("object"==_typeof2(i)&&null!==i)a=i;else if(_typeof2(i)<"u")throw new TypeError("'options' must be an object.");}else{var _e838=!1,_r283=Object.getOwnPropertyNames(n);var _iterator59=_createForOfIteratorHelper2(t),_step59;try{for(_iterator59.s();!(_step59=_iterator59.n()).done;){var _i143=_step59.value;if(-1!==_r283.indexOf(_i143)){var _t353=n[_i143];(null===_t353||_t353 instanceof Xe)&&(_e838=!0,s=!1,o[_i143]=_t353);}}}catch(err){_iterator59.e(err);}finally{_iterator59.f();}if(_e838){if("object"==_typeof2(i)&&null!==i)a=i;else if(_typeof2(i)<"u")throw new TypeError("'options' must be an object.");}else a=n;}}else if(_typeof2(n)<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");var _iterator60=_createForOfIteratorHelper2(_e836),_step60;try{for(_iterator60.s();!(_step60=_iterator60.n()).done;){var _t354=_step60.value;if(_typeof2(r[_t354])>"u")throw new Error("input '".concat(_t354,"' is missing in 'feeds'."));}}catch(err){_iterator60.e(err);}finally{_iterator60.f();}if(s){var _iterator61=_createForOfIteratorHelper2(t),_step61;try{for(_iterator61.s();!(_step61=_iterator61.n()).done;){var _e839=_step61.value;o[_e839]=null;}}catch(err){_iterator61.e(err);}finally{_iterator61.f();}}return[o,a];}},{key:"convertHandlerReturnTypeToMapOfTensors",value:function convertHandlerReturnTypeToMapOfTensors(_e840){var t={};for(var r in _e840)if(Object.hasOwnProperty.call(_e840,r)){var n=_e840[r];t[r]=n instanceof Xe?n:new Xe(n.type,n.data,n.dims);}return t;}},{key:"lazyResetGrad",value:function(){var _lazyResetGrad2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee142(){return _regeneratorRuntime2().wrap(function _callee142$(_context146){while(1)switch(_context146.prev=_context146.next){case 0:_context146.next=2;return this.handler.lazyResetGrad();case 2:case"end":return _context146.stop();}},_callee142,this);}));function lazyResetGrad(){return _lazyResetGrad2.apply(this,arguments);}return lazyResetGrad;}()},{key:"runTrainStep",value:function(){var _runTrainStep2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee143(_e841,t,r){var _this$typeNarrowingFo5,_this$typeNarrowingFo6,n,i,o;return _regeneratorRuntime2().wrap(function _callee143$(_context147){while(1)switch(_context147.prev=_context147.next){case 0:_this$typeNarrowingFo5=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,_e841,t,r);_this$typeNarrowingFo6=_slicedToArray2(_this$typeNarrowingFo5,2);n=_this$typeNarrowingFo6[0];i=_this$typeNarrowingFo6[1];_context147.next=6;return this.handler.runTrainStep(_e841,n,i);case 6:o=_context147.sent;return _context147.abrupt("return",this.convertHandlerReturnTypeToMapOfTensors(o));case 8:case"end":return _context147.stop();}},_callee143,this);}));function runTrainStep(_x168,_x169,_x170){return _runTrainStep2.apply(this,arguments);}return runTrainStep;}()},{key:"runOptimizerStep",value:function(){var _runOptimizerStep2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee144(_e842){return _regeneratorRuntime2().wrap(function _callee144$(_context148){while(1)switch(_context148.prev=_context148.next){case 0:if(this.hasOptimizerModel){_context148.next=2;break;}throw new Error("This TrainingSession has no OptimizerModel loaded.");case 2:_context148.next=4;return this.handler.runOptimizerStep(_e842||{});case 4:case"end":return _context148.stop();}},_callee144,this);}));function runOptimizerStep(_x171){return _runOptimizerStep2.apply(this,arguments);}return runOptimizerStep;}()},{key:"runEvalStep",value:function(){var _runEvalStep2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee145(_e843,t,r){var _this$typeNarrowingFo7,_this$typeNarrowingFo8,n,i,_o104;return _regeneratorRuntime2().wrap(function _callee145$(_context149){while(1)switch(_context149.prev=_context149.next){case 0:if(!this.hasEvalModel){_context149.next=9;break;}_this$typeNarrowingFo7=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,_e843,t,r);_this$typeNarrowingFo8=_slicedToArray2(_this$typeNarrowingFo7,2);n=_this$typeNarrowingFo8[0];i=_this$typeNarrowingFo8[1];_context149.next=7;return this.handler.runEvalStep(_e843,n,i);case 7:_o104=_context149.sent;return _context149.abrupt("return",this.convertHandlerReturnTypeToMapOfTensors(_o104));case 9:throw new Error("This TrainingSession has no EvalModel loaded.");case 10:case"end":return _context149.stop();}},_callee145,this);}));function runEvalStep(_x172,_x173,_x174){return _runEvalStep2.apply(this,arguments);}return runEvalStep;}()},{key:"getParametersSize",value:function(){var _getParametersSize2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee146(){var _e844,_args149=arguments;return _regeneratorRuntime2().wrap(function _callee146$(_context150){while(1)switch(_context150.prev=_context150.next){case 0:_e844=_args149.length>0&&_args149[0]!==undefined?_args149[0]:!0;return _context150.abrupt("return",this.handler.getParametersSize(_e844));case 2:case"end":return _context150.stop();}},_callee146,this);}));function getParametersSize(){return _getParametersSize2.apply(this,arguments);}return getParametersSize;}()},{key:"loadParametersBuffer",value:function(){var _loadParametersBuffer2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee147(_e845){var t,r,_args150=arguments;return _regeneratorRuntime2().wrap(function _callee147$(_context151){while(1)switch(_context151.prev=_context151.next){case 0:t=_args150.length>1&&_args150[1]!==undefined?_args150[1]:!0;_context151.next=3;return this.getParametersSize(t);case 3:r=_context151.sent;if(!(_e845.length!==4*r)){_context151.next=6;break;}throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");case 6:return _context151.abrupt("return",this.handler.loadParametersBuffer(_e845,t));case 7:case"end":return _context151.stop();}},_callee147,this);}));function loadParametersBuffer(_x175){return _loadParametersBuffer2.apply(this,arguments);}return loadParametersBuffer;}()},{key:"getContiguousParameters",value:function(){var _getContiguousParameters2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee148(){var _e846,_args151=arguments;return _regeneratorRuntime2().wrap(function _callee148$(_context152){while(1)switch(_context152.prev=_context152.next){case 0:_e846=_args151.length>0&&_args151[0]!==undefined?_args151[0]:!0;return _context152.abrupt("return",this.handler.getContiguousParameters(_e846));case 2:case"end":return _context152.stop();}},_callee148,this);}));function getContiguousParameters(){return _getContiguousParameters2.apply(this,arguments);}return getContiguousParameters;}()},{key:"release",value:function(){var _release4=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee149(){return _regeneratorRuntime2().wrap(function _callee149$(_context153){while(1)switch(_context153.prev=_context153.next){case 0:return _context153.abrupt("return",this.handler.dispose());case 1:case"end":return _context153.stop();}},_callee149,this);}));function release(){return _release4.apply(this,arguments);}return release;}()}],[{key:"create",value:function(){var _create4=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee150(t,r){var n,i,o,a,s,_r284;return _regeneratorRuntime2().wrap(function _callee150$(_context154){while(1)switch(_context154.prev=_context154.next){case 0:n=t.evalModel||"";i=t.optimizerModel||"";o=r||{};a=(o.executionProviders||[]).map(function(_e835){return"string"==typeof _e835?_e835:_e835.name;});_context154.next=6;return nn(a);case 6:s=_context154.sent;if(!s.createTrainingSessionHandler){_context154.next=12;break;}_context154.next=10;return s.createTrainingSessionHandler(t.checkpointState,t.trainModel,n,i,o);case 10:_r284=_context154.sent;return _context154.abrupt("return",new e(_r284,!!t.optimizerModel,!!t.evalModel));case 12:throw new Error(dd);case 13:case"end":return _context154.stop();}},_callee150);}));function create(_x176,_x177){return _create4.apply(this,arguments);}return create;}()}]);}();}),cd,Di=q(function(){Ri(),cd=cn;}),ta={};Ft(ta,{InferenceSession:function InferenceSession(){return ld;},TRACE:function TRACE(){return ln;},TRACE_FUNC_BEGIN:function TRACE_FUNC_BEGIN(){return st;},TRACE_FUNC_END:function TRACE_FUNC_END(){return ut;},Tensor:function Tensor(){return Xe;},TrainingSession:function TrainingSession(){return cd;},env:function env(){return Se;},registerBackend:function registerBackend(){return lr;}});var dt=q(function(){ci(),hi(),Bi(),un(),ea(),Pi(),Di();}),ra={};Ft(ra,{createReadStream:function createReadStream(){return Ui;},readFile:function readFile(){return pd;},readFileSync:function readFileSync(){return md;}});var pd,md,Ui,na=q(function(){pd=void 0,md=void 0,Ui=void 0;}),aa={};Ft(aa,{join:function join(){return fd;}});var fd,ia=q(function(){fd=void 0;}),oa={};Ft(oa,{crypto:function crypto(){return hd;}});var hd,sa=q(function(){hd=void 0;}),Vi=ur(function(e,t){var r=function(){var e=(typeof document==="undefined"?"undefined":_typeof2(document))<"u"&&document.currentScript?document.currentScript.src:void 0;return(typeof __filename==="undefined"?"undefined":_typeof2(__filename))<"u"&&(e=e||__filename),function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r,n,i=t;i.ready=new Promise(function(e,t){r=e,n=t;}),i.mountExternalData=function(e,t){(i.Ka||(i.Ka=new Map())).set(e,t);},i.unmountExternalData=function(){delete i.Ka;},i.jsepInit=function(e,t,r,n,o,a,s,u){i.gb=e,i.Wa=t,i.Ya=r,i.Qa=n,i.Xa=o,i.Ba=a,i.Za=s,i.$a=u,t=function t(e,_t357,r){return function(){var _t355,_t356;for(var _len11=arguments.length,n=new Array(_len11),_key11=0;_key11<_len11;_key11++){n[_key11]=arguments[_key11];}var i=de,o=(_t355=_t357)===null||_t355===void 0?void 0:_t355();n=e.apply(void 0,_toConsumableArray2(n));var a=(_t356=_t357)===null||_t356===void 0?void 0:_t356();return o!==a&&(e=a,r(o),_t357=r=null),de!=i?new Promise(function(e,t){be={resolve:e,reject:t};}):n;};},r=function r(t){return/*#__PURE__*/_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee151(){var _n196,_o105,_a85,_e847,_args154=arguments;return _regeneratorRuntime2().wrap(function _callee151$(_context155){while(1)switch(_context155.prev=_context155.next){case 0:_context155.prev=0;if(!i.Ja){_context155.next=3;break;}throw Error("Session already started");case 3:_n196=i.Ja={ab:_args154.length<=0?undefined:_args154[0],errors:[]};_context155.next=6;return t.apply(void 0,_args154);case 6:_o105=_context155.sent;if(!(i.Ja!==_n196)){_context155.next=9;break;}throw Error("Session mismatch");case 9:e.flush();_a85=_n196.errors;if(!(0<_a85.length)){_context155.next=17;break;}_context155.next=14;return Promise.all(_a85);case 14:_e847=_context155.sent;if(!(_e847=_e847.filter(function(e){return e;}),0<_e847.length)){_context155.next=17;break;}throw Error(_e847.join("\n"));case 17:return _context155.abrupt("return",_o105);case 18:_context155.prev=18;i.Ja=null;return _context155.finish(18);case 21:case"end":return _context155.stop();}},_callee151,null,[[0,,18,21]]);}));},i._OrtRun=r(t(i._OrtRun,function(){return i._OrtRun;},function(e){return i._OrtRun=e;})),i._OrtRunWithBinding=r(t(i._OrtRunWithBinding,function(){return i._OrtRunWithBinding;},function(e){return i._OrtRunWithBinding=e;})),i._OrtBindInput=t(i._OrtBindInput,function(){return i._OrtBindInput;},function(e){return i._OrtBindInput=e;}),i.jsepRegisterBuffer=function(t,r,n,i){return e.registerBuffer(t,r,n,i);},i.jsepUnregisterBuffers=function(t){e.unregisterBuffers(t);},i.jsepGetBuffer=function(t){return e.getBuffer(t);},i.jsepCreateDownloader=function(t,r,n){return e.createDownloader(t,r,n);};};var o,a,s,u=Object.assign({},i),l="./this.program",c=function c(e,t){throw t;},h="object"==(typeof window==="undefined"?"undefined":_typeof2(window)),f="function"==typeof importScripts,d="object"==_typeof2(process)&&"object"==_typeof2(process.versions)&&"string"==typeof process.versions.node,p="";if(d){var y=(na(),Et(ra)),m=(ia(),Et(aa));p=f?m.dirname(p)+"/":__dirname+"/",o=function o(e,t){return e=F(e)?new URL(e):m.normalize(e),y.readFileSync(e,t?void 0:"utf8");},s=function s(e){return(e=o(e,!0)).buffer||(e=new Uint8Array(e)),e;},a=function a(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!0;e=F(e)?new URL(e):m.normalize(e),y.readFile(e,n?void 0:"utf8",function(e,i){e?r(e):t(n?i.buffer:i);});},!i.thisProgram&&1<process.argv.length&&(l=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),c=function c(e,t){throw process.exitCode=e,t;},i.inspect=function(){return"[Emscripten Module object]";};}else(h||f)&&(f?p=self.location.href:(typeof document==="undefined"?"undefined":_typeof2(document))<"u"&&document.currentScript&&(p=document.currentScript.src),e&&(p=e),p=0!==p.indexOf("blob:")?p.substr(0,p.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=function o(e){var t=new XMLHttpRequest();return t.open("GET",e,!1),t.send(null),t.responseText;},f&&(s=function s(e){var t=new XMLHttpRequest();return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response);}),a=function a(e,t,r){var n=new XMLHttpRequest();n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):r();},n.onerror=r,n.send(null);});var g=console.log.bind(console),w=console.error.bind(console);Object.assign(i,u),u=null,"object"!=(typeof WebAssembly==="undefined"?"undefined":_typeof2(WebAssembly))&&D("no native wasm support detected");var b,v,x,_3,S,T,I,E,A=!1;function C(){var e=b.buffer;i.HEAP8=x=new Int8Array(e),i.HEAP16=new Int16Array(e),i.HEAPU8=_3=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAP32=S=new Int32Array(e),i.HEAPU32=T=new Uint32Array(e),i.HEAPF32=I=new Float32Array(e),i.HEAPF64=E=new Float64Array(e);}var O=[],P=[],k=[],R=0,B=null,$=null;function D(e){throw w(e="Aborted("+e+")"),A=!0,v=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),n(e),e;}var M,L=function L(e){return e.startsWith("data:application/octet-stream;base64,");},F=function F(e){return e.startsWith("file://");};if(!L(M="ort-wasm-simd.wasm")){var N=M;M=i.locateFile?i.locateFile(N,p):p+N;}function U(e){if(s)return s(e);throw"both async and sync fetching of the wasm failed";}function G(e,t,r){return function(e){if(h||f){if("function"==typeof fetch&&!F(e))return fetch(e,{credentials:"same-origin"}).then(function(t){if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer();})["catch"](function(){return U(e);});if(a)return new Promise(function(t,r){a(e,function(e){return t(new Uint8Array(e));},r);});}return Promise.resolve().then(function(){return U(e);});}(e).then(function(e){return WebAssembly.instantiate(e,t);}).then(function(e){return e;}).then(r,function(e){w("failed to asynchronously prepare wasm: ".concat(e)),D(e);});}var j,z={898080:function _(e,t,r,n){if(_typeof2(i)>"u"||!i.Ka)return 1;if((e=X(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=i.Ka.get(e)))return 2;if((t>>>=0)+(r>>>=0)>e.byteLength)return 3;try{return _3.set(e.subarray(t,t+r),n>>>0>>>0),0;}catch(_unused16){return 4;}},898581:function _(e){return i.Wa(e);},898614:function _(e){return i.Ya(e);},898646:function _(e,t,r){i.Qa(e,t,r,!0);},898685:function _(e,t,r){i.Qa(e,t,r);},898718:function _(e){i.Ba("Abs",e,void 0);},898769:function _(e){i.Ba("Neg",e,void 0);},898820:function _(e){i.Ba("Floor",e,void 0);},898873:function _(e){i.Ba("Ceil",e,void 0);},898925:function _(e){i.Ba("Reciprocal",e,void 0);},898983:function _(e){i.Ba("Sqrt",e,void 0);},899035:function _(e){i.Ba("Exp",e,void 0);},899086:function _(e){i.Ba("Erf",e,void 0);},899137:function _(e){i.Ba("Sigmoid",e,void 0);},899192:function _(e){i.Ba("Log",e,void 0);},899243:function _(e){i.Ba("Sin",e,void 0);},899294:function _(e){i.Ba("Cos",e,void 0);},899345:function _(e){i.Ba("Tan",e,void 0);},899396:function _(e){i.Ba("Asin",e,void 0);},899448:function _(e){i.Ba("Acos",e,void 0);},899500:function _(e){i.Ba("Atan",e,void 0);},899552:function _(e){i.Ba("Sinh",e,void 0);},899604:function _(e){i.Ba("Cosh",e,void 0);},899656:function _(e){i.Ba("Asinh",e,void 0);},899709:function _(e){i.Ba("Acosh",e,void 0);},899762:function _(e){i.Ba("Atanh",e,void 0);},899815:function _(e){i.Ba("Tanh",e,void 0);},899867:function _(e){i.Ba("Not",e,void 0);},899918:function _(e,t,r){i.Ba("Clip",e,{min:t,max:r});},899987:function _(e){i.Ba("Clip",e,void 0);},900039:function _(e,t){i.Ba("Elu",e,{alpha:t});},900097:function _(e){i.Ba("Relu",e,void 0);},900149:function _(e,t){i.Ba("LeakyRelu",e,{alpha:t});},900213:function _(e,t){i.Ba("ThresholdedRelu",e,{alpha:t});},900283:function _(e,t){i.Ba("Cast",e,{to:t});},900341:function _(e){i.Ba("Add",e,void 0);},900392:function _(e){i.Ba("Sub",e,void 0);},900443:function _(e){i.Ba("Mul",e,void 0);},900494:function _(e){i.Ba("Div",e,void 0);},900545:function _(e){i.Ba("Pow",e,void 0);},900596:function _(e){i.Ba("Equal",e,void 0);},900649:function _(e){i.Ba("Greater",e,void 0);},900704:function _(e){i.Ba("GreaterOrEqual",e,void 0);},900766:function _(e){i.Ba("Less",e,void 0);},900818:function _(e){i.Ba("LessOrEqual",e,void 0);},900877:function _(e,t,r,n,o){i.Ba("ReduceMean",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]});},901036:function _(e,t,r,n,o){i.Ba("ReduceMax",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]});},901194:function _(e,t,r,n,o){i.Ba("ReduceMin",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]});},901352:function _(e,t,r,n,o){i.Ba("ReduceProd",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]});},901511:function _(e,t,r,n,o){i.Ba("ReduceSum",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]});},901669:function _(e,t,r,n,o){i.Ba("ReduceL1",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]});},901826:function _(e,t,r,n,o){i.Ba("ReduceL2",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]});},901983:function _(e,t,r,n,o){i.Ba("ReduceLogSum",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]});},902144:function _(e,t,r,n,o){i.Ba("ReduceSumSquare",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]});},902308:function _(e,t,r,n,o){i.Ba("ReduceLogSumExp",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]});},902472:function _(e){i.Ba("Where",e,void 0);},902525:function _(e,t,r){i.Ba("Transpose",e,{perm:t?Array.from(S.subarray(t>>>0,r>>>0)):[]});},902633:function _(e,t,r,n,o,a,s,u,l,c,h,f,d,p,y){i.Ba("ConvTranspose",e,{format:l?"NHWC":"NCHW",autoPad:t,dilations:[r],group:n,kernel_shape:[o],pads:[a,s],strides:[u],wIsConst:function wIsConst(){return!!x[c>>>0];},outputPadding:h?Array.from(S.subarray(h>>>0,f>>>0)):[],outputShape:d?Array.from(S.subarray(d>>>0,p>>>0)):[],activation:X(y)});},903035:function _(e,t,r,n,o,a,s,u,l,c,h,f,d,p){i.Ba("ConvTranspose",e,{format:u?"NHWC":"NCHW",autoPad:t,dilations:Array.from(S.subarray(r>>>0,2+(r>>>0)>>>0)),group:n,kernelShape:Array.from(S.subarray(o>>>0,2+(o>>>0)>>>0)),pads:Array.from(S.subarray(a>>>0,4+(a>>>0)>>>0)),strides:Array.from(S.subarray(s>>>0,2+(s>>>0)>>>0)),wIsConst:function wIsConst(){return!!x[l>>>0];},outputPadding:c?Array.from(S.subarray(c>>>0,h>>>0)):[],outputShape:f?Array.from(S.subarray(f>>>0,d>>>0)):[],activation:X(p)});},903600:function _(e,t,r,n,o,a,s,u,l,c,h,f,d,p,y){i.Ba("ConvTranspose",e,{format:l?"NHWC":"NCHW",autoPad:t,dilations:[r],group:n,kernel_shape:[o],pads:[a,s],strides:[u],wIsConst:function wIsConst(){return!!x[c>>>0];},outputPadding:h?Array.from(S.subarray(h>>>0,f>>>0)):[],outputShape:d?Array.from(S.subarray(d>>>0,p>>>0)):[],activation:X(y)});},904002:function _(e,t,r,n,o,a,s,u,l,c,h,f,d,p){i.Ba("ConvTranspose",e,{format:u?"NHWC":"NCHW",autoPad:t,dilations:Array.from(S.subarray(r>>>0,2+(r>>>0)>>>0)),group:n,kernelShape:Array.from(S.subarray(o>>>0,2+(o>>>0)>>>0)),pads:Array.from(S.subarray(a>>>0,4+(a>>>0)>>>0)),strides:Array.from(S.subarray(s>>>0,2+(s>>>0)>>>0)),wIsConst:function wIsConst(){return!!x[l>>>0];},outputPadding:c?Array.from(S.subarray(c>>>0,h>>>0)):[],outputShape:f?Array.from(S.subarray(f>>>0,d>>>0)):[],activation:X(p)});},904567:function _(e,t){i.Ba("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"});},904658:function _(e,t,r,n,o,a,s,u,l,c,h,f,d,p,y,m){i.Ba("AveragePool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:o,dilations:[a,s],kernel_shape:[u,l],pads:[c,h,f,d],strides:[p,y]});},904942:function _(e,t){i.Ba("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"});},905033:function _(e,t,r,n,o,a,s,u,l,c,h,f,d,p,y,m){i.Ba("AveragePool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:o,dilations:[a,s],kernel_shape:[u,l],pads:[c,h,f,d],strides:[p,y]});},905317:function _(e,t){i.Ba("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"});},905404:function _(e,t,r,n,o,a,s,u,l,c,h,f,d,p,y,m){i.Ba("MaxPool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:o,dilations:[a,s],kernel_shape:[u,l],pads:[c,h,f,d],strides:[p,y]});},905684:function _(e,t){i.Ba("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"});},905771:function _(e,t,r,n,o,a,s,u,l,c,h,f,d,p,y,m){i.Ba("MaxPool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:o,dilations:[a,s],kernel_shape:[u,l],pads:[c,h,f,d],strides:[p,y]});},906051:function _(e,t,r,n,o){i.Ba("Gemm",e,{alpha:t,beta:r,transA:n,transB:o});},906155:function _(e){i.Ba("MatMul",e,void 0);},906209:function _(e,t,r,n){i.Ba("ArgMax",e,{keepDims:!!t,selectLastIndex:!!r,axis:n});},906317:function _(e,t,r,n){i.Ba("ArgMin",e,{keepDims:!!t,selectLastIndex:!!r,axis:n});},906425:function _(e,t){i.Ba("Softmax",e,{axis:t});},906488:function _(e,t){i.Ba("Concat",e,{axis:t});},906548:function _(e,t,r,n,o){i.Ba("Split",e,{axis:t,numOutputs:r,splitSizes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]});},906688:function _(e){i.Ba("Expand",e,void 0);},906742:function _(e,t){i.Ba("Gather",e,{axis:Number(t)});},906813:function _(e,t){i.Ba("GatherElements",e,{axis:Number(t)});},906892:function _(e,t,r,n,o,a,s,u,l,c,h){i.Ba("Resize",e,{antialias:t,axes:r?Array.from(S.subarray(r>>>0,n>>>0)):[],coordinateTransformMode:X(o),cubicCoeffA:a,excludeOutside:s,extrapolationValue:u,keepAspectRatioPolicy:X(l),mode:X(c),nearestMode:X(h)});},907238:function _(e,t,r,n,o,a,s){i.Ba("Slice",e,{starts:t?Array.from(S.subarray(t>>>0,r>>>0)):[],ends:n?Array.from(S.subarray(n>>>0,o>>>0)):[],axes:a?Array.from(S.subarray(a>>>0,s>>>0)):[]});},907454:function _(e){i.Ba("Tile",e,void 0);},907506:function _(e,t,r){i.Ba("LayerNormalization",e,{axis:Number(t),epsilon:Number(r)});},907613:function _(e,t,r){i.Ba("InstanceNormalization",e,{epsilon:t,format:r?"NHWC":"NCHW"});},907727:function _(e,t,r){i.Ba("InstanceNormalization",e,{epsilon:t,format:r?"NHWC":"NCHW"});},907841:function _(e){i.Ba("Range",e,void 0);},907894:function _(e,t){i.Ba("Einsum",e,{equation:X(t)});},907975:function _(e,t,r,n,o){i.Ba("Pad",e,{mode:t,value:r,pads:n?Array.from(S.subarray(n>>>0,o>>>0)):[]});},908102:function _(e,t,r,n,o,a){i.Ba("BatchNormalization",e,{epsilon:t,momentum:r,spatial:!!o,trainingMode:!!n,format:a?"NHWC":"NCHW"});},908271:function _(e,t,r,n,o,a){i.Ba("BatchNormalization",e,{epsilon:t,momentum:r,spatial:!!o,trainingMode:!!n,format:a?"NHWC":"NCHW"});},908440:function _(e,t,r){i.Ba("CumSum",e,{exclusive:Number(t),reverse:Number(r)});},908537:function _(e,t,r,n,o,a,s,u,l){i.Ba("Attention",e,{numHeads:t,isUnidirectional:r,maskFilterValue:n,scale:o,doRotary:a,qkvHiddenSizes:s?Array.from(S.subarray(Number(u)>>>0,Number(u)+s>>>0)):[],pastPresentShareBuffer:!!l});},908809:function _(e){i.Ba("Gelu",e,void 0);},908861:function _(e,t,r,n,o,a){i.Ba("MultiHeadAttention",e,{numHeads:t,isUnidirectional:r,maskFilterValue:n,scale:o,doRotary:a});},909020:function _(e){i.Ba("BiasAdd",e,void 0);},909075:function _(e){i.Ba("BiasSplitGelu",e,void 0);},909136:function _(e,t){i.Ba("SkipLayerNormalization",e,{epsilon:t});},909217:function _(e,t,r,n,o,a,s,u,l,c,h,f,d){i.Ba("Conv",e,{format:l?"NHWC":"NCHW",auto_pad:t,dilations:[r],group:n,kernel_shape:[o],pads:a?Array.from(S.subarray(a>>>0,s>>>0)):[],strides:[u],w_is_const:function w_is_const(){return!!x[c>>>0];},activation:X(h),activation_params:f?Array.from(I.subarray(f>>>0,d>>>0)):[]});},909587:function _(e,t,r,n,o,a,s,u,l,c,h,f,d,p,y,m){i.Ba("Conv",e,{format:f?"NHWC":"NCHW",auto_pad:t,dilations:[r,n],group:o,kernel_shape:[a,s],pads:u?Array.from(S.subarray(u>>>0,l>>>0)):[],strides:[c,h],w_is_const:function w_is_const(){return!!x[d>>>0];},activation:X(p),activation_params:y?Array.from(I.subarray(y>>>0,m>>>0)):[]});},909978:function _(e){i.Za(e);},910012:function _(e,t){return i.$a(e,t,i.Ja.ab,i.Ja.errors);}};function V(e){this.name="ExitStatus",this.message="Program terminated with exit(".concat(e,")"),this.status=e;}function H(e){this.Na=e-24,this.Ua=function(e){T[this.Na+4>>>2>>>0]=e;},this.Ta=function(e){T[this.Na+8>>>2>>>0]=e;},this.Ra=function(e,t){this.Sa(),this.Ua(e),this.Ta(t);},this.Sa=function(){T[this.Na+16>>>2>>>0]=0;};}var W,Y=(typeof TextDecoder==="undefined"?"undefined":_typeof2(TextDecoder))<"u"?new TextDecoder("utf8"):void 0,K=function K(e,t,r){var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&Y)return Y.decode(e.subarray(t,r));for(n="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))n+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i));}}else n+=String.fromCharCode(i);}return n;},X=function X(e,t){return(e>>>=0)?K(_3,e,t):"";},Z=function Z(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3;}return t;},q=function q(e,t,r,n){if(!(0<n))return 0;var i=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o);if(127>=a){if(r>=n)break;t[r++>>>0]=a;}else{if(2047>=a){if(r+1>=n)break;t[r++>>>0]=192|a>>6;}else{if(65535>=a){if(r+2>=n)break;t[r++>>>0]=224|a>>12;}else{if(r+3>=n)break;t[r++>>>0]=240|a>>18,t[r++>>>0]=128|a>>12&63;}t[r++>>>0]=128|a>>6&63;}t[r++>>>0]=128|63&a;}}return t[r>>>0]=0,r-i;},J=function J(e){return e%4==0&&(e%100!=0||e%400==0);},Q=[0,31,60,91,121,152,182,213,244,274,305,335],ee=[0,31,59,90,120,151,181,212,243,273,304,334],te=function te(e){var t=Z(e)+1,r=ke(t);return r&&q(e,_3,r,t),r;},re=[],ne=function ne(e,t){re.length=0;for(var r;r=_3[e++>>>0];){var n=105!=r;t+=(n&=112!=r)&&t%8?4:0,re.push(112==r?T[t>>>2>>>0]:105==r?S[t>>>2>>>0]:E[t>>>3>>>0]),t+=n?8:4;}return re;},ie={},oe=function oe(){if(!W){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==(typeof navigator==="undefined"?"undefined":_typeof2(navigator))&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:l||"./this.program"};for(e in ie)void 0===ie[e]?delete t[e]:t[e]=ie[e];var r=[];for(e in t)r.push("".concat(e,"=").concat(t[e]));W=r;}return W;},ae=[null,[],[]],_se=function se(e){return(_se=function(){if("object"==(typeof crypto==="undefined"?"undefined":_typeof2(crypto))&&"function"==typeof crypto.getRandomValues)return function(e){return crypto.getRandomValues(e);};if(d)try{var e=(sa(),Et(oa));if(e.randomFillSync)return function(t){return e.randomFillSync(t);};var t=e.randomBytes;return function(e){return e.set(t(e.byteLength)),e;};}catch(_unused17){}D("initRandomDevice");}())(e);},ue=[31,29,31,30,31,30,31,31,30,31,30,31],le=[31,28,31,30,31,30,31,31,30,31,30,31];function ce(e,t,r,n){function i(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e;}function o(e,t){return i(e,t,"0");}function a(e,t){function r(e){return 0>e?-1:0<e?1:0;}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n;}function s(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30);}}function u(e){var t=e.Ha;for(e=new Date(new Date(e.Ia+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(J(e.getFullYear())?ue:le)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break;}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1));}return r=new Date(e.getFullYear()+1,0,4),t=s(new Date(e.getFullYear(),0,4)),r=s(r),0>=a(t,e)?0>=a(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1;}e>>>=0,t>>>=0,r>>>=0;var l=T[(n>>>=0)+40>>>2>>>0];for(var c in n={eb:S[n>>>2>>>0],cb:S[n+4>>>2>>>0],La:S[n+8>>>2>>>0],Pa:S[n+12>>>2>>>0],Ma:S[n+16>>>2>>>0],Ia:S[n+20>>>2>>>0],Ga:S[n+24>>>2>>>0],Ha:S[n+28>>>2>>>0],hb:S[n+32>>>2>>>0],bb:S[n+36>>>2>>>0],fb:l?X(l):""},r=X(r),l={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(c,"g"),l[c]);var h="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),f="January February March April May June July August September October November December".split(" ");for(c in l={"%a":function a(e){return h[e.Ga].substring(0,3);},"%A":function A(e){return h[e.Ga];},"%b":function b(e){return f[e.Ma].substring(0,3);},"%B":function B(e){return f[e.Ma];},"%C":function C(e){return o((e.Ia+1900)/100|0,2);},"%d":function d(e){return o(e.Pa,2);},"%e":function e(_e848){return i(_e848.Pa,2," ");},"%g":function g(e){return u(e).toString().substring(2);},"%G":function G(e){return u(e);},"%H":function H(e){return o(e.La,2);},"%I":function I(e){return 0==(e=e.La)?e=12:12<e&&(e-=12),o(e,2);},"%j":function j(e){for(var t=0,r=0;r<=e.Ma-1;t+=(J(e.Ia+1900)?ue:le)[r++]);return o(e.Pa+t,3);},"%m":function m(e){return o(e.Ma+1,2);},"%M":function M(e){return o(e.cb,2);},"%n":function n(){return"\n";},"%p":function p(e){return 0<=e.La&&12>e.La?"AM":"PM";},"%S":function S(e){return o(e.eb,2);},"%t":function t(){return"\t";},"%u":function u(e){return e.Ga||7;},"%U":function U(e){return o(Math.floor((e.Ha+7-e.Ga)/7),2);},"%V":function V(e){var t=Math.floor((e.Ha+7-(e.Ga+6)%7)/7);if(2>=(e.Ga+371-e.Ha-2)%7&&t++,t)53==t&&(4==(r=(e.Ga+371-e.Ha)%7)||3==r&&J(e.Ia)||(t=1));else{t=52;var r=(e.Ga+7-e.Ha-1)%7;(4==r||5==r&&J(e.Ia%400-1))&&t++;}return o(t,2);},"%w":function w(e){return e.Ga;},"%W":function W(e){return o(Math.floor((e.Ha+7-(e.Ga+6)%7)/7),2);},"%y":function y(e){return(e.Ia+1900).toString().substring(2);},"%Y":function Y(e){return e.Ia+1900;},"%z":function z(e){return(0<=(e=e.bb)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4);},"%Z":function Z(e){return e.fb;},"%%":function _(){return"%";}},r=r.replace(/%%/g,"\0\0"),l)r.includes(c)&&(r=r.replace(new RegExp(c,"g"),l[c](n)));return c=function(e){var t=Array(Z(e)+1);return q(e,t,0,t.length),t;}(r=r.replace(/\0\0/g,"%")),c.length>t?0:(x.set(c,e>>>0),c.length-1);}var he=function he(e){try{e();}catch(e){D(e);}};var fe=0,de=null,pe=0,ye=[],me={},ge={},we=0,be=null,ve=[];function xe(e){if(!A){if(0===fe){var t=!1,r=!1;e(function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(!A&&(pe=e,t=!0,r)){fe=2,he(function(){return _Ne(de);}),(typeof Browser==="undefined"?"undefined":_typeof2(Browser))<"u"&&Browser.Oa.Va&&Browser.Oa.resume(),e=!1;try{var n=(0,Ce[ge[S[de+8>>>2>>>0]]])();}catch(t){n=t,e=!0;}var i=!1;if(!de){var o=be;o&&(be=null,(e?o.reject:o.resolve)(n),i=!0);}if(e&&!i)throw n;}}),r=!0,t||(fe=1,de=function(){var e=ke(65548),t=e+12;T[e>>>2>>>0]=t,T[e+4>>>2>>>0]=t+65536,t=ye[0];var r=me[t];return void 0===r&&(r=we++,me[t]=r,ge[r]=t),S[e+8>>>2>>>0]=r,e;}(),(typeof Browser==="undefined"?"undefined":_typeof2(Browser))<"u"&&Browser.Oa.Va&&Browser.Oa.pause(),he(function(){return _Le(de);}));}else 2===fe?(fe=0,he(_Ue),Re(de),de=null,ve.forEach(function(e){if(!A)try{e();try{var _i$onExit;v=v=e=v,(_i$onExit=i.onExit)!==null&&_i$onExit!==void 0&&_i$onExit.call(i,e),A=!0,c(e,new V(e));}catch(e){e instanceof V||"unwind"==e||c(1,e);}}catch(e){e instanceof V||"unwind"==e||c(1,e);}})):D("invalid state: ".concat(fe));return pe;}}var _e,Se,Te=[],Ie=[],Ee=function Ee(e,t){if(!Se){Se=new WeakMap();var r=_e.length;if(Se)for(var n=0;n<0+r;n++){var i=n,o=Te[i];o||(i>=Te.length&&(Te.length=i+1),Te[i]=o=_e.get(i)),(i=o)&&Se.set(i,n);}}if(r=Se.get(e)||0)return r;if(Ie.length)r=Ie.pop();else{try{_e.grow(1);}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e;}r=_e.length-1;}try{n=r,_e.set(n,e),Te[n]=_e.get(n);}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){n=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]};for(var a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new n(o,e);}else{for(n=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},n.push(96),128>(a=t.length)?n.push(a):n.push(a%128|128,a>>7),a=0;a<t.length;++a)n.push(o[t[a]]);"v"==i?n.push(0):n.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=n.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,n),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f;}n=r,_e.set(n,t),Te[n]=_e.get(n);}return Se.set(e,r),r;},Ae={n:function n(e,t,r){return function(e){return xe(function(t){e().then(t);});}(/*#__PURE__*/_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee152(){return _regeneratorRuntime2().wrap(function _callee152$(_context156){while(1)switch(_context156.prev=_context156.next){case 0:_context156.next=2;return i.Xa(e,t,r);case 2:case"end":return _context156.stop();}},_callee152);})));},a:function a(e,t,r){throw new H(e>>>=0).Ra(t>>>0,r>>>0),e;},g:function g(){return 0;},M:function M(){},C:function C(){},E:function E(){},v:function v(){return 0;},K:function K(){},F:function F(){},J:function J(){},m:function m(){},D:function D(){},A:function A(){},L:function L(){},B:function B(){},N:function N(){return 1;},q:function q(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),S[r>>>2>>>0]=e.getUTCSeconds(),S[r+4>>>2>>>0]=e.getUTCMinutes(),S[r+8>>>2>>>0]=e.getUTCHours(),S[r+12>>>2>>>0]=e.getUTCDate(),S[r+16>>>2>>>0]=e.getUTCMonth(),S[r+20>>>2>>>0]=e.getUTCFullYear()-1900,S[r+24>>>2>>>0]=e.getUTCDay(),S[r+28>>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0;},r:function r(e,t,_r285){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,_r285>>>=0,e=new Date(1e3*e),S[_r285>>>2>>>0]=e.getSeconds(),S[_r285+4>>>2>>>0]=e.getMinutes(),S[_r285+8>>>2>>>0]=e.getHours(),S[_r285+12>>>2>>>0]=e.getDate(),S[_r285+16>>>2>>>0]=e.getMonth(),S[_r285+20>>>2>>>0]=e.getFullYear()-1900,S[_r285+24>>>2>>>0]=e.getDay(),S[_r285+28>>>2>>>0]=(J(e.getFullYear())?Q:ee)[e.getMonth()]+e.getDate()-1|0,S[_r285+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();S[_r285+32>>>2>>>0]=0|(t!=n&&e.getTimezoneOffset()==Math.min(n,t));},s:function s(e){e>>>=0;var t=new Date(S[e+20>>>2>>>0]+1900,S[e+16>>>2>>>0],S[e+12>>>2>>>0],S[e+8>>>2>>>0],S[e+4>>>2>>>0],S[e>>>2>>>0],0),r=S[e+32>>>2>>>0],n=t.getTimezoneOffset(),i=new Date(t.getFullYear(),6,1).getTimezoneOffset(),o=new Date(t.getFullYear(),0,1).getTimezoneOffset(),a=Math.min(o,i);return 0>r?S[e+32>>>2>>>0]=+(i!=o&&a==n):0<r!=(a==n)&&(i=Math.max(o,i),t.setTime(t.getTime()+6e4*((0<r?a:i)-n))),S[e+24>>>2>>>0]=t.getDay(),S[e+28>>>2>>>0]=(J(t.getFullYear())?Q:ee)[t.getMonth()]+t.getDate()-1|0,S[e>>>2>>>0]=t.getSeconds(),S[e+4>>>2>>>0]=t.getMinutes(),S[e+8>>>2>>>0]=t.getHours(),S[e+12>>>2>>>0]=t.getDate(),S[e+16>>>2>>>0]=t.getMonth(),S[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(S[_Pe()>>>2>>>0]=61,e=-1):e/=1e3,_Be((j=e,1<=+Math.abs(j)?0<j?+Math.floor(j/4294967296)>>>0:~~+Math.ceil((j-+(~~j>>>0))/4294967296)>>>0:0)),e>>>0;},o:function o(){return-52;},p:function p(){},y:function y(e,t,r){function n(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT";}r>>>=0;var i=new Date().getFullYear(),o=new Date(i,0,1),a=new Date(i,6,1);i=o.getTimezoneOffset();var s=a.getTimezoneOffset();T[e>>>0>>>2>>>0]=60*Math.max(i,s),S[t>>>0>>>2>>>0]=+(i!=s),e=n(o),t=n(a),e=te(e),t=te(t),s<i?(T[r>>>2>>>0]=e,T[r+4>>>2>>>0]=t):(T[r>>>2>>>0]=t,T[r+4>>>2>>>0]=e);},e:function e(){D("");},b:function b(e,t,r){return e>>>=0,t=ne(t>>>0,r>>>0),z[e].apply(null,t);},j:function j(e,t,r){return e>>>=0,t=ne(t>>>0,r>>>0),z[e].apply(null,t);},h:function h(){return Date.now();},z:function z(){return 4294901760;},c:function c(){return performance.now();},I:function I(e,t,r){return t>>>=0,_3.copyWithin(e>>>0>>>0,t>>>0,t+(r>>>0)>>>0);},w:function w(e){e>>>=0;var t=_3.length;if(4294901760<e)return!1;for(var r=1;4>=r;r*=2){var n=t*(1+.2/r);n=Math.min(n,e+100663296);var i=Math;n=Math.max(e,n);e:{i=(i.min.call(i,4294901760,n+(65536-n%65536)%65536)-b.buffer.byteLength+65535)/65536;try{b.grow(i),C();var o=1;break e;}catch(_unused18){}o=void 0;}if(o)return!0;}return!1;},G:function G(e,t){e>>>=0,t>>>=0;var r=0;return oe().forEach(function(n,i){var o=t+r;for(i=T[e+4*i>>>2>>>0]=o,o=0;o<n.length;++o)x[i++>>>0>>>0]=n.charCodeAt(o);x[i>>>0>>>0]=0,r+=n.length+1;}),0;},H:function H(e,t){e>>>=0,t>>>=0;var r=oe();T[e>>>2>>>0]=r.length;var n=0;return r.forEach(function(e){return n+=e.length+1;}),T[t>>>2>>>0]=n,0;},f:function f(){return 52;},l:function l(){return 52;},t:function t(){return 70;},k:function k(e,t,r,n){t>>>=0,r>>>=0,n>>>=0;for(var i=0,o=0;o<r;o++){var a=T[t>>>2>>>0],s=T[t+4>>>2>>>0];t+=8;for(var u=0;u<s;u++){var l=_3[a+u>>>0],c=ae[e];0===l||10===l?((1===e?g:w)(K(c,0)),c.length=0):c.push(l);}i+=s;}return T[n>>>2>>>0]=i,0;},u:function u(e,t){return e>>>=0,_se(_3.subarray(e>>>0,e+(t>>>0)>>>0)),0;},x:ce,d:function d(e,t,r,n){return ce(e>>>0,t>>>0,r>>>0,n>>>0);},i:function i(e,t,r,n){var i=_e.length;e=new Uint8Array(_3.slice(e+t,e+r));try{var o,a=new WebAssembly.Module(e),s=new WebAssembly.Instance(a,{env:{memory:b}});for(o in s.exports)Ee(s.exports[o]);return i<_e.length?i:n;}catch(e){return console.log(e),n;}}},Ce=function(){function e(e){return Ce=e.exports,Ce=function(){var e=Ce,t={};var _loop13=function _loop13(){var _Object$entries2$_i=_slicedToArray2(_Object$entries2[_i144],2),r=_Object$entries2$_i[0],n=_Object$entries2$_i[1];t[r]="function"==typeof n?function(){ye.push(r);try{return n.apply(null,arguments);}finally{A||(ye.pop(),de&&1===fe&&0===ye.length&&(fe=0,he(_Fe),(typeof Fibers==="undefined"?"undefined":_typeof2(Fibers))<"u"&&Fibers.ib()));}}:n;};for(var _i144=0,_Object$entries2=Object.entries(e);_i144<_Object$entries2.length;_i144++){_loop13();}return t;}(),Ce=function(){var e=Ce;e=Object.assign({},e);var t=function t(e){return function(){return e()>>>0;};},r=function r(e){return function(t){return e(t)>>>0;};};return e.ta=t(e.ta),e.ua=r(e.ua),e.ya=t(e.ya),e.Aa=r(e.Aa),e;}(),b=Ce.O,C(),_e=Ce.wa,P.unshift(Ce.P),0==--R&&(null!==B&&(clearInterval(B),B=null),$&&(e=$,$=null,e())),Ce;}var t={a:Ae};if(R++,i.instantiateWasm)try{return i.instantiateWasm(t,e);}catch(e){w("Module.instantiateWasm callback failed with error: ".concat(e)),n(e);}return function(e,t){var r=M;return"function"!=typeof WebAssembly.instantiateStreaming||L(r)||F(r)||d||"function"!=typeof fetch?G(r,e,t):fetch(r,{credentials:"same-origin"}).then(function(n){return WebAssembly.instantiateStreaming(n,e).then(t,function(n){return w("wasm streaming compile failed: ".concat(n)),w("falling back to ArrayBuffer instantiation"),G(r,e,t);});});}(t,function(t){e(t.instance);})["catch"](n),{};}();i._OrtInit=function(e,t){return(i._OrtInit=Ce.Q)(e,t);},i._OrtGetLastError=function(e,t){return(i._OrtGetLastError=Ce.R)(e,t);},i._OrtCreateSessionOptions=function(e,t,r,n,o,a,s,u,l,c){return(i._OrtCreateSessionOptions=Ce.S)(e,t,r,n,o,a,s,u,l,c);},i._OrtAppendExecutionProvider=function(e,t){return(i._OrtAppendExecutionProvider=Ce.T)(e,t);},i._OrtAddFreeDimensionOverride=function(e,t,r){return(i._OrtAddFreeDimensionOverride=Ce.U)(e,t,r);},i._OrtAddSessionConfigEntry=function(e,t,r){return(i._OrtAddSessionConfigEntry=Ce.V)(e,t,r);},i._OrtReleaseSessionOptions=function(e){return(i._OrtReleaseSessionOptions=Ce.W)(e);},i._OrtCreateSession=function(e,t,r){return(i._OrtCreateSession=Ce.X)(e,t,r);},i._OrtReleaseSession=function(e){return(i._OrtReleaseSession=Ce.Y)(e);},i._OrtGetInputOutputCount=function(e,t,r){return(i._OrtGetInputOutputCount=Ce.Z)(e,t,r);},i._OrtGetInputName=function(e,t){return(i._OrtGetInputName=Ce._)(e,t);},i._OrtGetOutputName=function(e,t){return(i._OrtGetOutputName=Ce.$)(e,t);},i._OrtFree=function(e){return(i._OrtFree=Ce.aa)(e);},i._OrtCreateTensor=function(e,t,r,n,o,a){return(i._OrtCreateTensor=Ce.ba)(e,t,r,n,o,a);},i._OrtGetTensorData=function(e,t,r,n,o){return(i._OrtGetTensorData=Ce.ca)(e,t,r,n,o);},i._OrtReleaseTensor=function(e){return(i._OrtReleaseTensor=Ce.da)(e);},i._OrtCreateRunOptions=function(e,t,r,n){return(i._OrtCreateRunOptions=Ce.ea)(e,t,r,n);},i._OrtAddRunConfigEntry=function(e,t,r){return(i._OrtAddRunConfigEntry=Ce.fa)(e,t,r);},i._OrtReleaseRunOptions=function(e){return(i._OrtReleaseRunOptions=Ce.ga)(e);},i._OrtCreateBinding=function(e){return(i._OrtCreateBinding=Ce.ha)(e);},i._OrtBindInput=function(e,t,r){return(i._OrtBindInput=Ce.ia)(e,t,r);},i._OrtBindOutput=function(e,t,r,n){return(i._OrtBindOutput=Ce.ja)(e,t,r,n);},i._OrtClearBoundOutputs=function(e){return(i._OrtClearBoundOutputs=Ce.ka)(e);},i._OrtReleaseBinding=function(e){return(i._OrtReleaseBinding=Ce.la)(e);},i._OrtRunWithBinding=function(e,t,r,n,o){return(i._OrtRunWithBinding=Ce.ma)(e,t,r,n,o);},i._OrtRun=function(e,t,r,n,o,a,s,u){return(i._OrtRun=Ce.na)(e,t,r,n,o,a,s,u);},i._OrtEndProfiling=function(e){return(i._OrtEndProfiling=Ce.oa)(e);},i._OrtConfigure=function(e,t){return(i._OrtConfigure=Ce.pa)(e,t);},i._OrtAuth=function(e,t){return(i._OrtAuth=Ce.qa)(e,t);},i._JsepOutput=function(e,t,r){return(i._JsepOutput=Ce.ra)(e,t,r);},i._JsepGetNodeName=function(e){return(i._JsepGetNodeName=Ce.sa)(e);};var Oe,_Pe=function Pe(){return(_Pe=Ce.ta)();},ke=i._malloc=function(e){return(ke=i._malloc=Ce.ua)(e);},Re=i._free=function(e){return(Re=i._free=Ce.va)(e);},_Be=function Be(e){return(_Be=Ce.xa)(e);},_$e=function $e(){return(_$e=Ce.ya)();},_De=function De(e){return(_De=Ce.za)(e);},_Me=function Me(e){return(_Me=Ce.Aa)(e);},_Le=function Le(e){return(_Le=Ce.Ca)(e);},_Fe=function Fe(){return(_Fe=Ce.Da)();},_Ne=function Ne(e){return(_Ne=Ce.Ea)(e);},_Ue=function Ue(){return(_Ue=Ce.Fa)();};function Ge(){if(!(0<R)){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;){var e=i.preRun.shift();O.unshift(e);}for(;0<O.length;)O.shift()(i);if(!(0<R||Oe||(Oe=!0,i.calledRun=!0,A))){for(;0<P.length;)P.shift()(i);for(r(i);0<k.length;)k.shift()(i);}}}return i.___start_em_js=910124,i.___stop_em_js=910897,i.stackAlloc=_Me,i.stackSave=_$e,i.stackRestore=_De,i.addFunction=Ee,i.UTF8ToString=X,i.stringToUTF8=function(e,t,r){return q(e,_3,t,r);},i.lengthBytesUTF8=Z,$=function e(){Oe||Ge(),Oe||($=e);},Ge(),t.ready;};}();"object"==_typeof2(e)&&"object"==_typeof2(t)?t.exports=r:"function"==typeof define&&define.amd&&define([],function(){return r;});}),Wi=ur(function(){}),Gi=ur(function(){}),Hi={};Ft(Hi,{cpus:function cpus(){return gd;}});var gd,Li=q(function(){gd=void 0;}),ji=ur(function(e,t){var r=function(){var e=(typeof document==="undefined"?"undefined":_typeof2(document))<"u"&&document.currentScript?document.currentScript.src:void 0;return(typeof __filename==="undefined"?"undefined":_typeof2(__filename))<"u"&&(e=e||__filename),function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};function r(){return O.buffer!=R.buffer&&N(),R;}function n(){return O.buffer!=R.buffer&&N(),B;}function i(){return O.buffer!=R.buffer&&N(),$;}function o(){return O.buffer!=R.buffer&&N(),D;}function a(){return O.buffer!=R.buffer&&N(),M;}function s(){return O.buffer!=R.buffer&&N(),L;}var u,l,c=t;c.ready=new Promise(function(e,t){u=e,l=t;}),c.mountExternalData=function(e,t){(c.ib||(c.ib=new Map())).set(e,t);},c.unmountExternalData=function(){delete c.ib;},c.jsepInit=function(e,t,r,n,i,o,a,s){c.Rb=e,c.Bb=t,c.Db=r,c.pb=n,c.Cb=i,c.Ua=o,c.Eb=a,c.Fb=s,t=function t(e,_t360,r){return function(){var _t358,_t359;for(var _len12=arguments.length,n=new Array(_len12),_key12=0;_key12<_len12;_key12++){n[_key12]=arguments[_key12];}var i=ht,o=(_t358=_t360)===null||_t358===void 0?void 0:_t358();n=e.apply(void 0,_toConsumableArray2(n));var a=(_t359=_t360)===null||_t359===void 0?void 0:_t359();return o!==a&&(e=a,r(o),_t360=r=null),ht!=i?new Promise(function(e,t){gt={resolve:e,reject:t};}):n;};},r=function r(t){return/*#__PURE__*/_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee153(){var _n197,_i145,_o106,_e849,_args156=arguments;return _regeneratorRuntime2().wrap(function _callee153$(_context157){while(1)switch(_context157.prev=_context157.next){case 0:_context157.prev=0;if(!c.hb){_context157.next=3;break;}throw Error("Session already started");case 3:_n197=c.hb={Hb:_args156.length<=0?undefined:_args156[0],errors:[]};_context157.next=6;return t.apply(void 0,_args156);case 6:_i145=_context157.sent;if(!(c.hb!==_n197)){_context157.next=9;break;}throw Error("Session mismatch");case 9:e.flush();_o106=_n197.errors;if(!(0<_o106.length)){_context157.next=17;break;}_context157.next=14;return Promise.all(_o106);case 14:_e849=_context157.sent;if(!(_e849=_e849.filter(function(e){return e;}),0<_e849.length)){_context157.next=17;break;}throw Error(_e849.join("\n"));case 17:return _context157.abrupt("return",_i145);case 18:_context157.prev=18;c.hb=null;return _context157.finish(18);case 21:case"end":return _context157.stop();}},_callee153,null,[[0,,18,21]]);}));},c._OrtRun=r(t(c._OrtRun,function(){return c._OrtRun;},function(e){return c._OrtRun=e;})),c._OrtRunWithBinding=r(t(c._OrtRunWithBinding,function(){return c._OrtRunWithBinding;},function(e){return c._OrtRunWithBinding=e;})),c._OrtBindInput=t(c._OrtBindInput,function(){return c._OrtBindInput;},function(e){return c._OrtBindInput=e;}),c.jsepRegisterBuffer=function(t,r,n,i){return e.registerBuffer(t,r,n,i);},c.jsepUnregisterBuffers=function(t){e.unregisterBuffers(t);},c.jsepGetBuffer=function(t){return e.getBuffer(t);},c.jsepCreateDownloader=function(t,r,n){return e.createDownloader(t,r,n);};};var h,f,d,p=Object.assign({},c),y="./this.program",m=function m(e,t){throw t;},g="object"==(typeof window==="undefined"?"undefined":_typeof2(window)),w="function"==typeof importScripts,b="object"==_typeof2(process)&&"object"==_typeof2(process.versions)&&"string"==typeof process.versions.node,v=c.ENVIRONMENT_IS_PTHREAD||!1,x="";function _(e){return c.locateFile?c.locateFile(e,x):x+e;}if(b){var S=(na(),Et(ra)),T=(ia(),Et(aa));var _e850;x=w?T.dirname(x)+"/":__dirname+"/",h=function h(e,t){return e=q(e)?new URL(e):T.normalize(e),S.readFileSync(e,t?void 0:"utf8");},d=function d(e){return(e=h(e,!0)).buffer||(e=new Uint8Array(e)),e;},f=function f(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!0;e=q(e)?new URL(e):T.normalize(e),S.readFile(e,n?void 0:"utf8",function(e,i){e?r(e):t(n?i.buffer:i);});},!c.thisProgram&&1<process.argv.length&&(y=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),m=function m(e,t){throw process.exitCode=e,t;},c.inspect=function(){return"[Emscripten Module object]";};try{_e850=Wi();}catch(e){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),e;}global.Worker=_e850.Worker;}else(g||w)&&(w?x=self.location.href:(typeof document==="undefined"?"undefined":_typeof2(document))<"u"&&document.currentScript&&(x=document.currentScript.src),_typeof2(e)<"u"&&e&&(x=e),x=0!==x.indexOf("blob:")?x.substr(0,x.replace(/[?#].*/,"").lastIndexOf("/")+1):"",b||(h=function h(e){var t=new XMLHttpRequest();return t.open("GET",e,!1),t.send(null),t.responseText;},w&&(d=function d(e){var t=new XMLHttpRequest();return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response);}),f=function f(e,t,r){var n=new XMLHttpRequest();n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):r();},n.onerror=r,n.send(null);}));b&&(typeof performance==="undefined"?"undefined":_typeof2(performance))>"u"&&(global.performance=Gi().performance);var I=console.log.bind(console),E=console.error.bind(console);b&&(I=function I(){for(var _len13=arguments.length,e=new Array(_len13),_key13=0;_key13<_len13;_key13++){e[_key13]=arguments[_key13];}return S.writeSync(1,e.join(" ")+"\n");},E=function E(){for(var _len14=arguments.length,e=new Array(_len14),_key14=0;_key14<_len14;_key14++){e[_key14]=arguments[_key14];}return S.writeSync(2,e.join(" ")+"\n");});var A=I,C=E;Object.assign(c,p),p=null,"object"!=(typeof WebAssembly==="undefined"?"undefined":_typeof2(WebAssembly))&&K("no native wasm support detected");var O,P,k,R,B,$,D,M,L,F=!1;function N(){var e=O.buffer;c.HEAP8=R=new Int8Array(e),c.HEAP16=new Int16Array(e),c.HEAPU8=B=new Uint8Array(e),c.HEAPU16=new Uint16Array(e),c.HEAP32=$=new Int32Array(e),c.HEAPU32=D=new Uint32Array(e),c.HEAPF32=M=new Float32Array(e),c.HEAPF64=L=new Float64Array(e);}var U=16777216;if(v)O=c.wasmMemory;else if(c.wasmMemory)O=c.wasmMemory;else if(!((O=new WebAssembly.Memory({initial:U/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw C("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),b&&C("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");N(),U=O.buffer.byteLength;var G=[],j=[],z=[],V=0,H=null,W=null;function Y(){if(0==--V&&(null!==H&&(clearInterval(H),H=null),W)){var e=W;W=null,e();}}function K(e){throw C(e="Aborted("+e+")"),F=!0,k=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),l(e),e;}var X,Z=function Z(e){return e.startsWith("data:application/octet-stream;base64,");},q=function q(e){return e.startsWith("file://");};function J(e){if(d)return d(e);throw"both async and sync fetching of the wasm failed";}function Q(e,t,r){return function(e){if(g||w){if("function"==typeof fetch&&!q(e))return fetch(e,{credentials:"same-origin"}).then(function(t){if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer();})["catch"](function(){return J(e);});if(f)return new Promise(function(t,r){f(e,function(e){return t(new Uint8Array(e));},r);});}return Promise.resolve().then(function(){return J(e);});}(e).then(function(e){return WebAssembly.instantiate(e,t);}).then(function(e){return e;}).then(r,function(e){C("failed to asynchronously prepare wasm: ".concat(e)),K(e);});}Z(X="ort-wasm-simd-threaded.wasm")||(X=_(X));var ee,te={902596:function _(e,t,r,i){if(_typeof2(c)>"u"||!c.ib)return 1;if((e=ue(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=c.ib.get(e)))return 2;if(i>>>=0,(t>>>=0)+(r>>>=0)>e.byteLength)return 3;try{return n().set(e.subarray(t,t+r),i>>>0),0;}catch(_unused19){return 4;}},903097:function _(e){return c.Bb(e);},903130:function _(e){return c.Db(e);},903162:function _(e,t,r){c.pb(e,t,r,!0);},903201:function _(e,t,r){c.pb(e,t,r);},903234:function _(e){c.Ua("Abs",e,void 0);},903285:function _(e){c.Ua("Neg",e,void 0);},903336:function _(e){c.Ua("Floor",e,void 0);},903389:function _(e){c.Ua("Ceil",e,void 0);},903441:function _(e){c.Ua("Reciprocal",e,void 0);},903499:function _(e){c.Ua("Sqrt",e,void 0);},903551:function _(e){c.Ua("Exp",e,void 0);},903602:function _(e){c.Ua("Erf",e,void 0);},903653:function _(e){c.Ua("Sigmoid",e,void 0);},903708:function _(e){c.Ua("Log",e,void 0);},903759:function _(e){c.Ua("Sin",e,void 0);},903810:function _(e){c.Ua("Cos",e,void 0);},903861:function _(e){c.Ua("Tan",e,void 0);},903912:function _(e){c.Ua("Asin",e,void 0);},903964:function _(e){c.Ua("Acos",e,void 0);},904016:function _(e){c.Ua("Atan",e,void 0);},904068:function _(e){c.Ua("Sinh",e,void 0);},904120:function _(e){c.Ua("Cosh",e,void 0);},904172:function _(e){c.Ua("Asinh",e,void 0);},904225:function _(e){c.Ua("Acosh",e,void 0);},904278:function _(e){c.Ua("Atanh",e,void 0);},904331:function _(e){c.Ua("Tanh",e,void 0);},904383:function _(e){c.Ua("Not",e,void 0);},904434:function _(e,t,r){c.Ua("Clip",e,{min:t,max:r});},904503:function _(e){c.Ua("Clip",e,void 0);},904555:function _(e,t){c.Ua("Elu",e,{alpha:t});},904613:function _(e){c.Ua("Relu",e,void 0);},904665:function _(e,t){c.Ua("LeakyRelu",e,{alpha:t});},904729:function _(e,t){c.Ua("ThresholdedRelu",e,{alpha:t});},904799:function _(e,t){c.Ua("Cast",e,{to:t});},904857:function _(e){c.Ua("Add",e,void 0);},904908:function _(e){c.Ua("Sub",e,void 0);},904959:function _(e){c.Ua("Mul",e,void 0);},905010:function _(e){c.Ua("Div",e,void 0);},905061:function _(e){c.Ua("Pow",e,void 0);},905112:function _(e){c.Ua("Equal",e,void 0);},905165:function _(e){c.Ua("Greater",e,void 0);},905220:function _(e){c.Ua("GreaterOrEqual",e,void 0);},905282:function _(e){c.Ua("Less",e,void 0);},905334:function _(e){c.Ua("LessOrEqual",e,void 0);},905393:function _(e,t,r,n,o){c.Ua("ReduceMean",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]});},905552:function _(e,t,r,n,o){c.Ua("ReduceMax",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]});},905710:function _(e,t,r,n,o){c.Ua("ReduceMin",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]});},905868:function _(e,t,r,n,o){c.Ua("ReduceProd",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]});},906027:function _(e,t,r,n,o){c.Ua("ReduceSum",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]});},906185:function _(e,t,r,n,o){c.Ua("ReduceL1",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]});},906342:function _(e,t,r,n,o){c.Ua("ReduceL2",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]});},906499:function _(e,t,r,n,o){c.Ua("ReduceLogSum",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]});},906660:function _(e,t,r,n,o){c.Ua("ReduceSumSquare",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]});},906824:function _(e,t,r,n,o){c.Ua("ReduceLogSumExp",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]});},906988:function _(e){c.Ua("Where",e,void 0);},907041:function _(e,t,r){c.Ua("Transpose",e,{perm:t?Array.from(i().subarray(t>>>0,r>>>0)):[]});},907149:function _(e,t,n,o,a,s,u,l,h,f,d,p,y,m,g){c.Ua("ConvTranspose",e,{format:h?"NHWC":"NCHW",autoPad:t,dilations:[n],group:o,kernel_shape:[a],pads:[s,u],strides:[l],wIsConst:function wIsConst(){return!!r()[f>>>0];},outputPadding:d?Array.from(i().subarray(d>>>0,p>>>0)):[],outputShape:y?Array.from(i().subarray(y>>>0,m>>>0)):[],activation:ue(g)});},907551:function _(e,t,n,o,a,s,u,l,h,f,d,p,y,m){c.Ua("ConvTranspose",e,{format:l?"NHWC":"NCHW",autoPad:t,dilations:Array.from(i().subarray(n>>>0,2+(n>>>0)>>>0)),group:o,kernelShape:Array.from(i().subarray(a>>>0,2+(a>>>0)>>>0)),pads:Array.from(i().subarray(s>>>0,4+(s>>>0)>>>0)),strides:Array.from(i().subarray(u>>>0,2+(u>>>0)>>>0)),wIsConst:function wIsConst(){return!!r()[h>>>0];},outputPadding:f?Array.from(i().subarray(f>>>0,d>>>0)):[],outputShape:p?Array.from(i().subarray(p>>>0,y>>>0)):[],activation:ue(m)});},908116:function _(e,t,n,o,a,s,u,l,h,f,d,p,y,m,g){c.Ua("ConvTranspose",e,{format:h?"NHWC":"NCHW",autoPad:t,dilations:[n],group:o,kernel_shape:[a],pads:[s,u],strides:[l],wIsConst:function wIsConst(){return!!r()[f>>>0];},outputPadding:d?Array.from(i().subarray(d>>>0,p>>>0)):[],outputShape:y?Array.from(i().subarray(y>>>0,m>>>0)):[],activation:ue(g)});},908518:function _(e,t,n,o,a,s,u,l,h,f,d,p,y,m){c.Ua("ConvTranspose",e,{format:l?"NHWC":"NCHW",autoPad:t,dilations:Array.from(i().subarray(n>>>0,2+(n>>>0)>>>0)),group:o,kernelShape:Array.from(i().subarray(a>>>0,2+(a>>>0)>>>0)),pads:Array.from(i().subarray(s>>>0,4+(s>>>0)>>>0)),strides:Array.from(i().subarray(u>>>0,2+(u>>>0)>>>0)),wIsConst:function wIsConst(){return!!r()[h>>>0];},outputPadding:f?Array.from(i().subarray(f>>>0,d>>>0)):[],outputShape:p?Array.from(i().subarray(p>>>0,y>>>0)):[],activation:ue(m)});},909083:function _(e,t){c.Ua("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"});},909174:function _(e,t,r,n,i,o,a,s,u,l,h,f,d,p,y,m){c.Ua("AveragePool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[l,h,f,d],strides:[p,y]});},909458:function _(e,t){c.Ua("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"});},909549:function _(e,t,r,n,i,o,a,s,u,l,h,f,d,p,y,m){c.Ua("AveragePool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[l,h,f,d],strides:[p,y]});},909833:function _(e,t){c.Ua("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"});},909920:function _(e,t,r,n,i,o,a,s,u,l,h,f,d,p,y,m){c.Ua("MaxPool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[l,h,f,d],strides:[p,y]});},910200:function _(e,t){c.Ua("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"});},910287:function _(e,t,r,n,i,o,a,s,u,l,h,f,d,p,y,m){c.Ua("MaxPool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[l,h,f,d],strides:[p,y]});},910567:function _(e,t,r,n,i){c.Ua("Gemm",e,{alpha:t,beta:r,transA:n,transB:i});},910671:function _(e){c.Ua("MatMul",e,void 0);},910725:function _(e,t,r,n){c.Ua("ArgMax",e,{keepDims:!!t,selectLastIndex:!!r,axis:n});},910833:function _(e,t,r,n){c.Ua("ArgMin",e,{keepDims:!!t,selectLastIndex:!!r,axis:n});},910941:function _(e,t){c.Ua("Softmax",e,{axis:t});},911004:function _(e,t){c.Ua("Concat",e,{axis:t});},911064:function _(e,t,r,n,o){c.Ua("Split",e,{axis:t,numOutputs:r,splitSizes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]});},911204:function _(e){c.Ua("Expand",e,void 0);},911258:function _(e,t){c.Ua("Gather",e,{axis:Number(t)});},911329:function _(e,t){c.Ua("GatherElements",e,{axis:Number(t)});},911408:function _(e,t,r,n,o,a,s,u,l,h,f){c.Ua("Resize",e,{antialias:t,axes:r?Array.from(i().subarray(r>>>0,n>>>0)):[],coordinateTransformMode:ue(o),cubicCoeffA:a,excludeOutside:s,extrapolationValue:u,keepAspectRatioPolicy:ue(l),mode:ue(h),nearestMode:ue(f)});},911754:function _(e,t,r,n,o,a,s){c.Ua("Slice",e,{starts:t?Array.from(i().subarray(t>>>0,r>>>0)):[],ends:n?Array.from(i().subarray(n>>>0,o>>>0)):[],axes:a?Array.from(i().subarray(a>>>0,s>>>0)):[]});},911970:function _(e){c.Ua("Tile",e,void 0);},912022:function _(e,t,r){c.Ua("LayerNormalization",e,{axis:Number(t),epsilon:Number(r)});},912129:function _(e,t,r){c.Ua("InstanceNormalization",e,{epsilon:t,format:r?"NHWC":"NCHW"});},912243:function _(e,t,r){c.Ua("InstanceNormalization",e,{epsilon:t,format:r?"NHWC":"NCHW"});},912357:function _(e){c.Ua("Range",e,void 0);},912410:function _(e,t){c.Ua("Einsum",e,{equation:ue(t)});},912491:function _(e,t,r,n,o){c.Ua("Pad",e,{mode:t,value:r,pads:n?Array.from(i().subarray(n>>>0,o>>>0)):[]});},912618:function _(e,t,r,n,i,o){c.Ua("BatchNormalization",e,{epsilon:t,momentum:r,spatial:!!i,trainingMode:!!n,format:o?"NHWC":"NCHW"});},912787:function _(e,t,r,n,i,o){c.Ua("BatchNormalization",e,{epsilon:t,momentum:r,spatial:!!i,trainingMode:!!n,format:o?"NHWC":"NCHW"});},912956:function _(e,t,r){c.Ua("CumSum",e,{exclusive:Number(t),reverse:Number(r)});},913053:function _(e,t,r,n,o,a,s,u,l){c.Ua("Attention",e,{numHeads:t,isUnidirectional:r,maskFilterValue:n,scale:o,doRotary:a,qkvHiddenSizes:s?Array.from(i().subarray(Number(u)>>>0,Number(u)+s>>>0)):[],pastPresentShareBuffer:!!l});},913325:function _(e){c.Ua("Gelu",e,void 0);},913377:function _(e,t,r,n,i,o){c.Ua("MultiHeadAttention",e,{numHeads:t,isUnidirectional:r,maskFilterValue:n,scale:i,doRotary:o});},913536:function _(e){c.Ua("BiasAdd",e,void 0);},913591:function _(e){c.Ua("BiasSplitGelu",e,void 0);},913652:function _(e,t){c.Ua("SkipLayerNormalization",e,{epsilon:t});},913733:function _(e,t,n,o,s,u,l,h,f,d,p,y,m){c.Ua("Conv",e,{format:f?"NHWC":"NCHW",auto_pad:t,dilations:[n],group:o,kernel_shape:[s],pads:u?Array.from(i().subarray(u>>>0,l>>>0)):[],strides:[h],w_is_const:function w_is_const(){return!!r()[d>>>0];},activation:ue(p),activation_params:y?Array.from(a().subarray(y>>>0,m>>>0)):[]});},914103:function _(e,t,n,o,s,u,l,h,f,d,p,y,m,g,w,b){c.Ua("Conv",e,{format:y?"NHWC":"NCHW",auto_pad:t,dilations:[n,o],group:s,kernel_shape:[u,l],pads:h?Array.from(i().subarray(h>>>0,f>>>0)):[],strides:[d,p],w_is_const:function w_is_const(){return!!r()[m>>>0];},activation:ue(g),activation_params:w?Array.from(a().subarray(w>>>0,b>>>0)):[]});},914494:function _(e){c.Eb(e);},914528:function _(e,t){return c.Fb(e,t,c.hb.Hb,c.hb.errors);}};function re(e){this.name="ExitStatus",this.message="Program terminated with exit(".concat(e,")"),this.status=e;}var ne=function ne(e){e.terminate(),e.onmessage=function(){};},ie=function ie(e){0==ye.cb.length&&(pe(),ye.qb(ye.cb[0]));var t=ye.cb.pop();if(!t)return 6;ye.eb.push(t),ye.$a[e.bb]=t,t.bb=e.bb;var r={cmd:"run",start_routine:e.Ib,arg:e.xb,pthread_ptr:e.bb};return b&&t.unref(),t.postMessage(r,e.Ob),0;},oe=0,ae=(typeof TextDecoder==="undefined"?"undefined":_typeof2(TextDecoder))<"u"?new TextDecoder("utf8"):void 0,se=function se(e,t,r){var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&ae)return ae.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,r):e.subarray(t,r));for(n="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))n+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i));}}else n+=String.fromCharCode(i);}return n;},ue=function ue(e,t){return(e>>>=0)?se(n(),e,t):"";};function le(e,t){var r=arguments.length-2,n=arguments;return function(e){var t=_Gt();return e=e(),_jt(t),e;}(function(){for(var i=_zt(8*r),o=i>>>3,a=0;a<r;a++){var u=n[2+a];s()[o+a>>>0]=u;}return _Dt(e,r,i,t);});}function ce(e){var _c$onExit;if(v)return le(0,1,e);k=e,0<oe||(ye.Jb(),(_c$onExit=c.onExit)!==null&&_c$onExit!==void 0&&_c$onExit.call(c,e),F=!0),m(e,new re(e));}var he=function he(e){if(k=e,v)throw ge(e),"unwind";ce(e);},fe=function fe(e){e instanceof re||"unwind"==e||m(1,e);};function de(){for(var e=c.numThreads;e--;)pe();G.unshift(function(){V++,function(e){v?e():Promise.all(ye.cb.map(ye.qb)).then(e);}(function(){return Y();});});}function pe(){var e=_("ort-wasm-simd-threaded.worker.js");e=new Worker(e),ye.cb.push(e);}var ye={cb:[],eb:[],ub:[],$a:{},mb:function mb(){v?(ye.receiveObjectTransfer=ye.Gb,ye.threadInitTLS=ye.tb,ye.setExitStatus=ye.sb):de();},sb:function sb(e){return k=e;},Sb:["$terminateWorker"],Jb:function Jb(){var _iterator62=_createForOfIteratorHelper2(ye.eb),_step62;try{for(_iterator62.s();!(_step62=_iterator62.n()).done;){var e=_step62.value;ne(e);}}catch(err){_iterator62.e(err);}finally{_iterator62.f();}var _iterator63=_createForOfIteratorHelper2(ye.cb),_step63;try{for(_iterator63.s();!(_step63=_iterator63.n()).done;){e=_step63.value;ne(e);}}catch(err){_iterator63.e(err);}finally{_iterator63.f();}ye.cb=[],ye.eb=[],ye.$a=[];},rb:function rb(e){var t=e.bb;delete ye.$a[t],ye.cb.push(e),ye.eb.splice(ye.eb.indexOf(e),1),e.bb=0,_Mt(t);},Gb:function Gb(){},tb:function tb(){ye.ub.forEach(function(e){return e();});},qb:function qb(t){return new Promise(function(r){t.onmessage=function(e){var n=(e=e.data).cmd;if(e.targetThread&&e.targetThread!=Pt()){var i=ye.$a[e.targetThread];i?i.postMessage(e,e.transferList):C("Internal error! Worker sent a message \"".concat(n,"\" to target pthread ").concat(e.targetThread,", but that thread no longer exists!"));}else"checkMailbox"===n?Ne():"spawnThread"===n?ie(e):"cleanupThread"===n?ye.rb(ye.$a[e.thread]):"killThread"===n?(e=e.thread,n=ye.$a[e],delete ye.$a[e],ne(n),_Mt(e),ye.eb.splice(ye.eb.indexOf(n),1),n.bb=0):"cancelThread"===n?ye.$a[e.thread].postMessage({cmd:"cancel"}):"loaded"===n?(t.loaded=!0,b&&!t.bb&&t.unref(),r(t)):"alert"===n?alert("Thread ".concat(e.threadId,": ").concat(e.text)):"setimmediate"===e.target?t.postMessage(e):"callHandler"===n?c[e.handler].apply(c,_toConsumableArray2(e.args)):n&&C("worker sent an unknown command ".concat(n));},t.onerror=function(e){throw C("worker sent an error! ".concat(e.filename,":").concat(e.lineno,": ").concat(e.message)),e;},b&&(t.on("message",function(e){return t.onmessage({data:e});}),t.on("error",function(e){return t.onerror(e);}));var n,i=[];for(var _i146=0,_arr2=["onExit"];_i146<_arr2.length;_i146++){n=_arr2[_i146];c.hasOwnProperty(n)&&i.push(n);}t.postMessage({cmd:"load",handlers:i,urlOrBlob:c.mainScriptUrlOrBlob||e,wasmMemory:O,wasmModule:P});});}};c.PThread=ye;var me=function me(e){for(;0<e.length;)e.shift()(c);};function ge(e){if(v)return le(1,0,e);he(e);}function we(e){this.lb=e-24,this.yb=function(e){o()[this.lb+4>>>2>>>0]=e;},this.wb=function(e){o()[this.lb+8>>>2>>>0]=e;},this.mb=function(e,t){this.vb(),this.yb(e),this.wb(t);},this.vb=function(){o()[this.lb+16>>>2>>>0]=0;};}c.establishStackSpace=function(){var e=Pt(),t=o()[e+52>>>2>>>0];e=o()[e+56>>>2>>>0],_Ut(t,t-e),_jt(t);},c.invokeEntryPoint=function(e,t){e=Vt.apply(null,[e,t]),0<oe?ye.sb(e):Lt(e);};function be(e,t,r,n){return v?le(2,1,e,t,r,n):ve(e,t,r,n);}function ve(e,t,r,n){if(e>>>=0,t>>>=0,r>>>=0,n>>>=0,(typeof SharedArrayBuffer==="undefined"?"undefined":_typeof2(SharedArrayBuffer))>"u")return C("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var i=[];return v&&0===i.length?be(e,t,r,n):(e={Ib:r,bb:e,xb:n,Ob:i},v?(e.Qb="spawnThread",postMessage(e,i),0):ie(e));}function xe(e,t,r){return v?le(3,1,e,t,r):0;}function _e(e,t){if(v)return le(4,1,e,t);}var Se=function Se(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3;}return t;},Te=function Te(e,t,r,n){if(!(0<n))return 0;var i=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o);if(127>=a){if(r>=n)break;t[r++>>>0]=a;}else{if(2047>=a){if(r+1>=n)break;t[r++>>>0]=192|a>>6;}else{if(65535>=a){if(r+2>=n)break;t[r++>>>0]=224|a>>12;}else{if(r+3>=n)break;t[r++>>>0]=240|a>>18,t[r++>>>0]=128|a>>12&63;}t[r++>>>0]=128|a>>6&63;}t[r++>>>0]=128|63&a;}}return t[r>>>0]=0,r-i;},Ie=function Ie(e,t,r){return Te(e,n(),t,r);};function Ee(e,t){if(v)return le(5,1,e,t);}function Ae(e,t,r){if(v)return le(6,1,e,t,r);}function Ce(e,t,r){return v?le(7,1,e,t,r):0;}function Oe(e,t){if(v)return le(8,1,e,t);}function Pe(e,t,r){if(v)return le(9,1,e,t,r);}function ke(e,t,r,n){if(v)return le(10,1,e,t,r,n);}function Re(e,t,r,n){if(v)return le(11,1,e,t,r,n);}function Be(e,t,r,n){if(v)return le(12,1,e,t,r,n);}function $e(e){if(v)return le(13,1,e);}function De(e,t){if(v)return le(14,1,e,t);}function Me(e,t,r){if(v)return le(15,1,e,t,r);}var Le=function Le(){if(!(0<oe))try{v?Lt(k):he(k);}catch(e){fe(e);}};function Fe(e){e>>>=0,"function"==typeof Atomics.Pb&&(Atomics.Pb(i(),e>>>2,e).value.then(Ne),e+=128,Atomics.store(i(),e>>>2,1));}c.__emscripten_thread_mailbox_await=Fe;var Ne=function Ne(){var e=Pt();if(e&&(Fe(e),!F))try{_Ft(),Le();}catch(e){fe(e);}};c.checkMailbox=Ne;var Ue=[],Ge=function Ge(e){return e%4==0&&(e%100!=0||e%400==0);},je=[0,31,60,91,121,152,182,213,244,274,305,335],ze=[0,31,59,90,120,151,181,212,243,273,304,334];function Ve(e,t,r,n,i,o,a,s){return v?le(16,1,e,t,r,n,i,o,a,s):-52;}function He(e,t,r,n,i,o,a){if(v)return le(17,1,e,t,r,n,i,o,a);}var We,Ye=function Ye(e){var t=Se(e)+1,r=kt(t);return r&&Ie(e,r,t),r;},Ke=[],Xe=function Xe(e,t){Ke.length=0;for(var r;r=n()[e++>>>0];){var a=105!=r;t+=(a&=112!=r)&&t%8?4:0,Ke.push(112==r?o()[t>>>2>>>0]:105==r?i()[t>>>2>>>0]:s()[t>>>3>>>0]),t+=a?8:4;}return Ke;},Ze={},qe=function qe(){if(!We){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==(typeof navigator==="undefined"?"undefined":_typeof2(navigator))&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:y||"./this.program"};for(e in Ze)void 0===Ze[e]?delete t[e]:t[e]=Ze[e];var r=[];for(e in t)r.push("".concat(e,"=").concat(t[e]));We=r;}return We;};function Je(e,t){if(v)return le(18,1,e,t);e>>>=0,t>>>=0;var n=0;return qe().forEach(function(i,a){var s=t+n;for(a=o()[e+4*a>>>2>>>0]=s,s=0;s<i.length;++s)r()[a++>>>0>>>0]=i.charCodeAt(s);r()[a>>>0>>>0]=0,n+=i.length+1;}),0;}function Qe(e,t){if(v)return le(19,1,e,t);e>>>=0,t>>>=0;var r=qe();o()[e>>>2>>>0]=r.length;var n=0;return r.forEach(function(e){return n+=e.length+1;}),o()[t>>>2>>>0]=n,0;}function et(e){return v?le(20,1,e):52;}function tt(e,t,r,n){return v?le(21,1,e,t,r,n):52;}function rt(e,t,r,n,i){return v?le(22,1,e,t,r,n,i):70;}var nt=[null,[],[]];function it(e,t,r,i){if(v)return le(23,1,e,t,r,i);t>>>=0,r>>>=0,i>>>=0;for(var a=0,s=0;s<r;s++){var u=o()[t>>>2>>>0],l=o()[t+4>>>2>>>0];t+=8;for(var c=0;c<l;c++){var h=n()[u+c>>>0],f=nt[e];0===h||10===h?((1===e?A:C)(se(f,0)),f.length=0):f.push(h);}a+=l;}return o()[i>>>2>>>0]=a,0;}var _ot=function ot(e){return(_ot=function(){if("object"==(typeof crypto==="undefined"?"undefined":_typeof2(crypto))&&"function"==typeof crypto.getRandomValues)return function(e){return e.set(crypto.getRandomValues(new Uint8Array(e.byteLength))),e;};if(b)try{var e=(sa(),Et(oa));if(e.randomFillSync)return function(t){return e.randomFillSync(t);};var t=e.randomBytes;return function(e){return e.set(t(e.byteLength)),e;};}catch(_unused20){}K("initRandomDevice");}())(e);},at=[31,29,31,30,31,30,31,31,30,31,30,31],st=[31,28,31,30,31,30,31,31,30,31,30,31];function ut(e,t,n,a){function s(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e;}function u(e,t){return s(e,t,"0");}function l(e,t){function r(e){return 0>e?-1:0<e?1:0;}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n;}function c(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30);}}function h(e){var t=e.fb;for(e=new Date(new Date(e.gb+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(Ge(e.getFullYear())?at:st)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break;}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1));}return r=new Date(e.getFullYear()+1,0,4),t=c(new Date(e.getFullYear(),0,4)),r=c(r),0>=l(t,e)?0>=l(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1;}e>>>=0,t>>>=0,n>>>=0,a>>>=0;var f=o()[a+40>>>2>>>0];for(var d in a={Mb:i()[a>>>2>>>0],Lb:i()[a+4>>>2>>>0],jb:i()[a+8>>>2>>>0],ob:i()[a+12>>>2>>>0],kb:i()[a+16>>>2>>>0],gb:i()[a+20>>>2>>>0],ab:i()[a+24>>>2>>>0],fb:i()[a+28>>>2>>>0],Tb:i()[a+32>>>2>>>0],Kb:i()[a+36>>>2>>>0],Nb:f?ue(f):""},n=ue(n),f={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(d,"g"),f[d]);var p="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),y="January February March April May June July August September October November December".split(" ");for(d in f={"%a":function a(e){return p[e.ab].substring(0,3);},"%A":function A(e){return p[e.ab];},"%b":function b(e){return y[e.kb].substring(0,3);},"%B":function B(e){return y[e.kb];},"%C":function C(e){return u((e.gb+1900)/100|0,2);},"%d":function d(e){return u(e.ob,2);},"%e":function e(_e851){return s(_e851.ob,2," ");},"%g":function g(e){return h(e).toString().substring(2);},"%G":function G(e){return h(e);},"%H":function H(e){return u(e.jb,2);},"%I":function I(e){return 0==(e=e.jb)?e=12:12<e&&(e-=12),u(e,2);},"%j":function j(e){for(var t=0,r=0;r<=e.kb-1;t+=(Ge(e.gb+1900)?at:st)[r++]);return u(e.ob+t,3);},"%m":function m(e){return u(e.kb+1,2);},"%M":function M(e){return u(e.Lb,2);},"%n":function n(){return"\n";},"%p":function p(e){return 0<=e.jb&&12>e.jb?"AM":"PM";},"%S":function S(e){return u(e.Mb,2);},"%t":function t(){return"\t";},"%u":function u(e){return e.ab||7;},"%U":function U(e){return u(Math.floor((e.fb+7-e.ab)/7),2);},"%V":function V(e){var t=Math.floor((e.fb+7-(e.ab+6)%7)/7);if(2>=(e.ab+371-e.fb-2)%7&&t++,t)53==t&&(4==(r=(e.ab+371-e.fb)%7)||3==r&&Ge(e.gb)||(t=1));else{t=52;var r=(e.ab+7-e.fb-1)%7;(4==r||5==r&&Ge(e.gb%400-1))&&t++;}return u(t,2);},"%w":function w(e){return e.ab;},"%W":function W(e){return u(Math.floor((e.fb+7-(e.ab+6)%7)/7),2);},"%y":function y(e){return(e.gb+1900).toString().substring(2);},"%Y":function Y(e){return e.gb+1900;},"%z":function z(e){return(0<=(e=e.Kb)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4);},"%Z":function Z(e){return e.Nb;},"%%":function _(){return"%";}},n=n.replace(/%%/g,"\0\0"),f)n.includes(d)&&(n=n.replace(new RegExp(d,"g"),f[d](a)));return d=function(e){var t=Array(Se(e)+1);return Te(e,t,0,t.length),t;}(n=n.replace(/\0\0/g,"%")),d.length>t?0:(function(e,t){r().set(e,t>>>0);}(d,e),d.length-1);}var lt=function lt(e){try{e();}catch(e){K(e);}};var ct=0,ht=null,ft=0,dt=[],pt={},yt={},mt=0,gt=null,wt=[];function bt(e){if(!F){if(0===ct){var t=!1,r=!1;e(function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(!F&&(ft=e,t=!0,r)){ct=2,lt(function(){return _Yt(ht);}),(typeof Browser==="undefined"?"undefined":_typeof2(Browser))<"u"&&Browser.nb.Ab&&Browser.nb.resume(),e=!1;try{var n=function(){var e=i()[ht+8>>>2>>>0];return e=Ct[yt[e]],--oe,e();}();}catch(t){n=t,e=!0;}var o=!1;if(!ht){var a=gt;a&&(gt=null,(e?a.reject:a.resolve)(n),o=!0);}if(e&&!o)throw n;}}),r=!0,t||(ct=1,ht=function(){var e=kt(65548),t=e+12;o()[e>>>2>>>0]=t,o()[e+4>>>2>>>0]=t+65536,t=dt[0];var r=pt[t];return void 0===r&&(r=mt++,pt[t]=r,yt[r]=t),t=r,i()[e+8>>>2>>>0]=t,e;}(),(typeof Browser==="undefined"?"undefined":_typeof2(Browser))<"u"&&Browser.nb.Ab&&Browser.nb.pause(),lt(function(){return _Ht(ht);}));}else 2===ct?(ct=0,lt(_Kt),Rt(ht),ht=null,wt.forEach(function(e){if(!F)try{e(),Le();}catch(e){fe(e);}})):K("invalid state: ".concat(ct));return ft;}}var vt,xt,_t=[],St=[],Tt=function Tt(e,t){if(!xt){xt=new WeakMap();var r=vt.length;if(xt)for(var n=0;n<0+r;n++){var i=n,o=_t[i];o||(i>=_t.length&&(_t.length=i+1),_t[i]=o=vt.get(i)),(i=o)&&xt.set(i,n);}}if(r=xt.get(e)||0)return r;if(St.length)r=St.pop();else{try{vt.grow(1);}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e;}r=vt.length-1;}try{n=r,vt.set(n,e),_t[n]=vt.get(n);}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){n=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]};for(var a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new n(o,e);}else{for(n=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},n.push(96),128>(a=t.length)?n.push(a):n.push(a%128|128,a>>7),a=0;a<t.length;++a)n.push(o[t[a]]);"v"==i?n.push(0):n.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=n.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,n),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f;}n=r,vt.set(n,t),_t[n]=vt.get(n);}return xt.set(e,r),r;};ye.mb();var It=[ce,ge,be,xe,_e,Ee,Ae,Ce,Oe,Pe,ke,Re,Be,$e,De,Me,Ve,He,Je,Qe,et,tt,rt,it],At={r:function r(e,t,_r286){return function(e){return bt(function(t){e().then(t);});}(/*#__PURE__*/_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee154(){return _regeneratorRuntime2().wrap(function _callee154$(_context158){while(1)switch(_context158.prev=_context158.next){case 0:_context158.next=2;return c.Cb(e,t,_r286);case 2:case"end":return _context158.stop();}},_callee154);})));},b:function b(e,t,r){throw new we(e>>>=0).mb(t>>>0,r>>>0),e;},P:function P(e){Bt(e>>>0,!w,1,!g,131072,!1),ye.tb();},n:function n(e){e>>>=0,v?postMessage({cmd:"cleanupThread",thread:e}):ye.rb(ye.$a[e]);},L:ve,i:xe,V:_e,H:Ee,J:Ae,z:Ce,T:Oe,N:Pe,S:ke,p:Re,I:Be,F:$e,U:De,G:Me,Y:function Y(){return 1;},D:function D(e,t){(e>>>=0)==t>>>0?setTimeout(function(){return Ne();}):v?postMessage({targetThread:e,cmd:"checkMailbox"}):(e=ye.$a[e])&&e.postMessage({cmd:"checkMailbox"});},M:function M(e,t,r,n){t>>>=0,Ue.length=r,n=n>>>0>>>3;for(var i=0;i<r;i++)Ue[i]=s()[n+i>>>0];return e=0>e?te[-e-1]:It[e],ye.zb=t,t=e.apply(null,Ue),ye.zb=0,t;},O:Fe,X:function X(e){b&&ye.$a[e>>>0].ref();},u:function u(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),i()[r>>>2>>>0]=e.getUTCSeconds(),i()[r+4>>>2>>>0]=e.getUTCMinutes(),i()[r+8>>>2>>>0]=e.getUTCHours(),i()[r+12>>>2>>>0]=e.getUTCDate(),i()[r+16>>>2>>>0]=e.getUTCMonth(),i()[r+20>>>2>>>0]=e.getUTCFullYear()-1900,i()[r+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,i()[r+28>>>2>>>0]=e;},v:function v(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),i()[r>>>2>>>0]=e.getSeconds(),i()[r+4>>>2>>>0]=e.getMinutes(),i()[r+8>>>2>>>0]=e.getHours(),i()[r+12>>>2>>>0]=e.getDate(),i()[r+16>>>2>>>0]=e.getMonth(),i()[r+20>>>2>>>0]=e.getFullYear()-1900,i()[r+24>>>2>>>0]=e.getDay(),t=(Ge(e.getFullYear())?je:ze)[e.getMonth()]+e.getDate()-1|0,i()[r+28>>>2>>>0]=t,i()[r+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=0|(t!=n&&e.getTimezoneOffset()==Math.min(n,t)),i()[r+32>>>2>>>0]=e;},w:function w(e){e>>>=0;var t=new Date(i()[e+20>>>2>>>0]+1900,i()[e+16>>>2>>>0],i()[e+12>>>2>>>0],i()[e+8>>>2>>>0],i()[e+4>>>2>>>0],i()[e>>>2>>>0],0),r=i()[e+32>>>2>>>0],n=t.getTimezoneOffset(),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),a=new Date(t.getFullYear(),0,1).getTimezoneOffset(),s=Math.min(a,o);return 0>r?i()[e+32>>>2>>>0]=+(o!=a&&s==n):0<r!=(s==n)&&(o=Math.max(a,o),t.setTime(t.getTime()+6e4*((0<r?s:o)-n))),i()[e+24>>>2>>>0]=t.getDay(),r=(Ge(t.getFullYear())?je:ze)[t.getMonth()]+t.getDate()-1|0,i()[e+28>>>2>>>0]=r,i()[e>>>2>>>0]=t.getSeconds(),i()[e+4>>>2>>>0]=t.getMinutes(),i()[e+8>>>2>>>0]=t.getHours(),i()[e+12>>>2>>>0]=t.getDate(),i()[e+16>>>2>>>0]=t.getMonth(),i()[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(i()[_Ot()>>>2>>>0]=61,e=-1):e/=1e3,_Nt6((ee=e,1<=+Math.abs(ee)?0<ee?+Math.floor(ee/4294967296)>>>0:~~+Math.ceil((ee-+(~~ee>>>0))/4294967296)>>>0:0)),e>>>0;},s:Ve,t:He,C:function C(e,t,r){function n(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT";}e>>>=0,t>>>=0,r>>>=0;var a=new Date().getFullYear(),s=new Date(a,0,1),u=new Date(a,6,1);a=s.getTimezoneOffset();var l=u.getTimezoneOffset(),c=Math.max(a,l);o()[e>>>2>>>0]=60*c,i()[t>>>2>>>0]=+(a!=l),e=n(s),t=n(u),e=Ye(e),t=Ye(t),l<a?(o()[r>>>2>>>0]=e,o()[r+4>>>2>>>0]=t):(o()[r>>>2>>>0]=t,o()[r+4>>>2>>>0]=e);},d:function d(){K("");},c:function c(e,t,r){return e>>>=0,t=Xe(t>>>0,r>>>0),te[e].apply(null,t);},k:function k(e,t,r){return e>>>=0,t=Xe(t>>>0,r>>>0),te[e].apply(null,t);},o:function o(){},q:function q(){return Date.now();},W:function W(){throw oe+=1,"unwind";},E:function E(){return 4294901760;},f:function f(){return performance.timeOrigin+performance.now();},g:function g(){return b?(Li(),Et(Hi)).cpus().length:navigator.hardwareConcurrency;},A:function A(e){e>>>=0;var t=n().length;if(e<=t||4294901760<e)return!1;for(var r=1;4>=r;r*=2){var i=t*(1+.2/r);i=Math.min(i,e+100663296);var o=Math;i=Math.max(e,i);e:{o=(o.min.call(o,4294901760,i+(65536-i%65536)%65536)-O.buffer.byteLength+65535)/65536;try{O.grow(o),N();var a=1;break e;}catch(_unused21){}a=void 0;}if(a)return!0;}return!1;},Q:Je,R:Qe,K:he,h:et,m:tt,x:rt,l:it,y:function y(e,t){return e>>>=0,t>>>=0,_ot(n().subarray(e>>>0,e+t>>>0)),0;},a:O||c.wasmMemory,B:ut,e:function e(_e852,t,r,n){return ut(_e852>>>0,t>>>0,r>>>0,n>>>0);},j:function j(e,t,r,i){var o=vt.length;e=new Uint8Array(n().slice(e+t,e+r));try{var a,s=new WebAssembly.Module(e),u=new WebAssembly.Instance(s,{env:{memory:O}});for(a in u.exports)Tt(u.exports[a]);return o<vt.length?o:i;}catch(e){return console.log(e),i;}}},Ct=function(){function e(e,t){return Ct=e.exports,Ct=function(){var e=Ct,t={};var _loop14=function _loop14(){var _Object$entries3$_i=_slicedToArray2(_Object$entries3[_i147],2),r=_Object$entries3$_i[0],n=_Object$entries3$_i[1];t[r]="function"==typeof n?function(){dt.push(r);try{return n.apply(null,arguments);}finally{F||(dt.pop(),ht&&1===ct&&0===dt.length&&(ct=0,oe+=1,lt(_Wt),(typeof Fibers==="undefined"?"undefined":_typeof2(Fibers))<"u"&&Fibers.Ub()));}}:n;};for(var _i147=0,_Object$entries3=Object.entries(e);_i147<_Object$entries3.length;_i147++){_loop14();}return t;}(),Ct=function(){var e=Ct;e=Object.assign({},e);var t=function t(e){return function(){return e()>>>0;};},r=function r(e){return function(t){return e(t)>>>0;};};return e.Da=t(e.Da),e.Ea=t(e.Ea),e.Fa=r(e.Fa),e.emscripten_main_runtime_thread_id=t(e.emscripten_main_runtime_thread_id),e.Ra=t(e.Ra),e.Ta=r(e.Ta),e;}(),ye.ub.push(Ct.Ha),vt=Ct.Ia,j.unshift(Ct.Z),P=t,Y(),Ct;}var t={a:At};if(V++,c.instantiateWasm)try{return c.instantiateWasm(t,e);}catch(e){C("Module.instantiateWasm callback failed with error: ".concat(e)),l(e);}return function(e,t){var r=X;return"function"!=typeof WebAssembly.instantiateStreaming||Z(r)||q(r)||b||"function"!=typeof fetch?Q(r,e,t):fetch(r,{credentials:"same-origin"}).then(function(n){return WebAssembly.instantiateStreaming(n,e).then(t,function(n){return C("wasm streaming compile failed: ".concat(n)),C("falling back to ArrayBuffer instantiation"),Q(r,e,t);});});}(t,function(t){e(t.instance,t.module);})["catch"](l),{};}();c._OrtInit=function(e,t){return(c._OrtInit=Ct._)(e,t);},c._OrtGetLastError=function(e,t){return(c._OrtGetLastError=Ct.$)(e,t);},c._OrtCreateSessionOptions=function(e,t,r,n,i,o,a,s,u,l){return(c._OrtCreateSessionOptions=Ct.aa)(e,t,r,n,i,o,a,s,u,l);},c._OrtAppendExecutionProvider=function(e,t){return(c._OrtAppendExecutionProvider=Ct.ba)(e,t);},c._OrtAddFreeDimensionOverride=function(e,t,r){return(c._OrtAddFreeDimensionOverride=Ct.ca)(e,t,r);},c._OrtAddSessionConfigEntry=function(e,t,r){return(c._OrtAddSessionConfigEntry=Ct.da)(e,t,r);},c._OrtReleaseSessionOptions=function(e){return(c._OrtReleaseSessionOptions=Ct.ea)(e);},c._OrtCreateSession=function(e,t,r){return(c._OrtCreateSession=Ct.fa)(e,t,r);},c._OrtReleaseSession=function(e){return(c._OrtReleaseSession=Ct.ga)(e);},c._OrtGetInputOutputCount=function(e,t,r){return(c._OrtGetInputOutputCount=Ct.ha)(e,t,r);},c._OrtGetInputName=function(e,t){return(c._OrtGetInputName=Ct.ia)(e,t);},c._OrtGetOutputName=function(e,t){return(c._OrtGetOutputName=Ct.ja)(e,t);},c._OrtFree=function(e){return(c._OrtFree=Ct.ka)(e);},c._OrtCreateTensor=function(e,t,r,n,i,o){return(c._OrtCreateTensor=Ct.la)(e,t,r,n,i,o);},c._OrtGetTensorData=function(e,t,r,n,i){return(c._OrtGetTensorData=Ct.ma)(e,t,r,n,i);},c._OrtReleaseTensor=function(e){return(c._OrtReleaseTensor=Ct.na)(e);},c._OrtCreateRunOptions=function(e,t,r,n){return(c._OrtCreateRunOptions=Ct.oa)(e,t,r,n);},c._OrtAddRunConfigEntry=function(e,t,r){return(c._OrtAddRunConfigEntry=Ct.pa)(e,t,r);},c._OrtReleaseRunOptions=function(e){return(c._OrtReleaseRunOptions=Ct.qa)(e);},c._OrtCreateBinding=function(e){return(c._OrtCreateBinding=Ct.ra)(e);},c._OrtBindInput=function(e,t,r){return(c._OrtBindInput=Ct.sa)(e,t,r);},c._OrtBindOutput=function(e,t,r,n){return(c._OrtBindOutput=Ct.ta)(e,t,r,n);},c._OrtClearBoundOutputs=function(e){return(c._OrtClearBoundOutputs=Ct.ua)(e);},c._OrtReleaseBinding=function(e){return(c._OrtReleaseBinding=Ct.va)(e);},c._OrtRunWithBinding=function(e,t,r,n,i){return(c._OrtRunWithBinding=Ct.wa)(e,t,r,n,i);},c._OrtRun=function(e,t,r,n,i,o,a,s){return(c._OrtRun=Ct.xa)(e,t,r,n,i,o,a,s);},c._OrtEndProfiling=function(e){return(c._OrtEndProfiling=Ct.ya)(e);},c._OrtConfigure=function(e,t){return(c._OrtConfigure=Ct.za)(e,t);},c._OrtAuth=function(e,t){return(c._OrtAuth=Ct.Aa)(e,t);},c._JsepOutput=function(e,t,r){return(c._JsepOutput=Ct.Ba)(e,t,r);},c._JsepGetNodeName=function(e){return(c._JsepGetNodeName=Ct.Ca)(e);};var _Ot=function Ot(){return(_Ot=Ct.Da)();},Pt=c._pthread_self=function(){return(Pt=c._pthread_self=Ct.Ea)();},kt=c._malloc=function(e){return(kt=c._malloc=Ct.Fa)(e);},Rt=c._free=function(e){return(Rt=c._free=Ct.Ga)(e);};c.__emscripten_tls_init=function(){return(c.__emscripten_tls_init=Ct.Ha)();};var Bt=c.__emscripten_thread_init=function(e,t,r,n,i,o){return(Bt=c.__emscripten_thread_init=Ct.Ja)(e,t,r,n,i,o);};c.__emscripten_thread_crashed=function(){return(c.__emscripten_thread_crashed=Ct.Ka)();};var $t,_Dt=function Dt(e,t,r,n){return(_Dt=Ct.La)(e,t,r,n);},_Mt=function Mt(e){return(_Mt=Ct.Ma)(e);},Lt=c.__emscripten_thread_exit=function(e){return(Lt=c.__emscripten_thread_exit=Ct.Na)(e);},_Ft=function Ft(){return(_Ft=Ct.Oa)();},_Nt6=function Nt(e){return(_Nt6=Ct.Pa)(e);},_Ut=function Ut(e,t){return(_Ut=Ct.Qa)(e,t);},_Gt=function Gt(){return(_Gt=Ct.Ra)();},_jt=function jt(e){return(_jt=Ct.Sa)(e);},_zt=function zt(e){return(_zt=Ct.Ta)(e);},Vt=c.dynCall_ii=function(e,t){return(Vt=c.dynCall_ii=Ct.Va)(e,t);},_Ht=function Ht(e){return(_Ht=Ct.Wa)(e);},_Wt=function Wt(){return(_Wt=Ct.Xa)();},_Yt=function Yt(e){return(_Yt=Ct.Ya)(e);},_Kt=function Kt(){return(_Kt=Ct.Za)();};function Xt(){if(!(0<V))if(v)u(c),v||me(j),startWorker(c);else{if(c.preRun)for("function"==typeof c.preRun&&(c.preRun=[c.preRun]);c.preRun.length;)G.unshift(c.preRun.shift());me(G),0<V||$t||($t=!0,c.calledRun=!0,F||(v||me(j),u(c),v||me(z)));}}return c.___start_em_js=914640,c.___stop_em_js=915413,c.wasmMemory=O,c.stackAlloc=_zt,c.stackSave=_Gt,c.stackRestore=_jt,c.keepRuntimeAlive=function(){return 0<oe;},c.addFunction=Tt,c.UTF8ToString=ue,c.stringToUTF8=Ie,c.lengthBytesUTF8=Se,c.ExitStatus=re,c.PThread=ye,W=function e(){$t||Xt(),$t||(W=e);},Xt(),t.ready;};}();"object"==_typeof2(e)&&"object"==_typeof2(t)?t.exports=r:"function"==typeof define&&define.amd&&define([],function(){return r;});}),Ki=ur(function(e,t){t.exports='"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\n';}),Zi,bd,da,ca,pn,Yi,wd,vd,$d,Xi,Me,dr=q(function(){Zi=Vi(),bd=ji(),ca=!1,pn=!1,Yi=!1,wd=function wd(e){if(1===e)return!1;if((typeof SharedArrayBuffer==="undefined"?"undefined":_typeof2(SharedArrayBuffer))>"u")return(typeof self==="undefined"?"undefined":_typeof2(self))<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;_typeof2(process)<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return(typeof MessageChannel==="undefined"?"undefined":_typeof2(MessageChannel))<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]));}catch(_unused22){return!1;}},vd=function vd(){try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]));}catch(_unused23){return!1;}},$d=function $d(e,t){return e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm";},Xi=/*#__PURE__*/function(){var _ref76=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee155(e){var t,r,n,i,o,a,s,u,l,c,h;return _regeneratorRuntime2().wrap(function _callee155$(_context159){while(1)switch(_context159.prev=_context159.next){case 0:if(!ca){_context159.next=2;break;}return _context159.abrupt("return",Promise.resolve());case 2:if(!pn){_context159.next=4;break;}throw new Error("multiple calls to 'initializeWebAssembly()' detected.");case 4:if(!Yi){_context159.next=6;break;}throw new Error("previous call to 'initializeWebAssembly()' failed.");case 6:pn=!0;t=e.initTimeout,r=e.numThreads,n=e.simd,i=wd(r),o=n&&vd(),a=e.wasmPaths,s="string"==typeof a?a:void 0,u=$d(o,i),l="object"==_typeof2(a)?a[u]:void 0,c=!1,h=[];t>0&&h.push(new Promise(function(e){setTimeout(function(){c=!0,e();},t);}));h.push(new Promise(function(e,t){var n=i?bd:Zi,o={locateFile:function locateFile(e,t){if(i&&e.endsWith(".worker.js")&&(typeof Blob==="undefined"?"undefined":_typeof2(Blob))<"u")return URL.createObjectURL(new Blob([Ki()],{type:"text/javascript"}));if(e.endsWith(".wasm")){if(l)return l;var _e853=s!==null&&s!==void 0?s:t;return"ort-wasm-simd.wasm"===u?_e853+"ort-wasm-simd.jsep.wasm":"ort-wasm-simd-threaded.wasm"===u?_e853+"ort-wasm-simd-threaded.jsep.wasm":_e853+u;}return t+e;}};if(i)if(o.numThreads=r,(typeof Blob==="undefined"?"undefined":_typeof2(Blob))>"u")o.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{var _e854="var ortWasmThreaded=".concat(n.toString(),";");o.mainScriptUrlOrBlob=new Blob([_e854],{type:"text/javascript"});}n(o).then(function(t){pn=!1,ca=!0,da=t,e();},function(e){pn=!1,Yi=!0,t(e);});}));_context159.next=12;return Promise.race(h);case 12:if(!c){_context159.next=14;break;}throw new Error("WebAssembly backend initializing failed due to timeout: ".concat(t,"ms"));case 14:case"end":return _context159.stop();}},_callee155);}));return function Xi(_x178){return _ref76.apply(this,arguments);};}(),Me=function Me(){if(ca&&da)return da;throw new Error("WebAssembly is not initialized yet.");};}),Ge,_kr,Re,mn=q(function(){dr(),Ge=function Ge(e,t){var r=Me(),n=r.lengthBytesUTF8(e)+1,i=r._malloc(n);return r.stringToUTF8(e,i,n),t.push(i),i;},_kr=function kr(e,t,r,n){if("object"==_typeof2(e)&&null!==e){if(r.has(e))throw new Error("Circular reference in options");r.add(e);}Object.entries(e).forEach(function(_ref77){var _ref78=_slicedToArray2(_ref77,2),e=_ref78[0],i=_ref78[1];var o=t?t+e:e;if("object"==_typeof2(i))_kr(i,o+".",r,n);else if("string"==typeof i||"number"==typeof i)n(o,i.toString());else{if("boolean"!=typeof i)throw new Error("Can't handle extra config type: "+_typeof2(i));n(o,i?"1":"0");}});},Re=function Re(e){var t=Me(),r=t.stackSave();try{var _r287=t.stackAlloc(8);t._OrtGetLastError(_r287,_r287+4);var n=t.HEAP32[_r287/4],i=t.HEAPU32[_r287/4+1],_o107=i?t.UTF8ToString(i):"";throw new Error("".concat(e," ERROR_CODE: ").concat(n,", ERROR_MESSAGE: ").concat(_o107));}finally{t.stackRestore(r);}};}),Ji,Qi=q(function(){dr(),mn(),Ji=function Ji(e){var t=Me(),r=0,n=[],i=e||{};try{if(void 0===(e===null||e===void 0?void 0:e.logSeverityLevel))i.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error("log serverity level is not valid: ".concat(e.logSeverityLevel));if(void 0===(e===null||e===void 0?void 0:e.logVerbosityLevel))i.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw new Error("log verbosity level is not valid: ".concat(e.logVerbosityLevel));void 0===(e===null||e===void 0?void 0:e.terminate)&&(i.terminate=!1);var _o108=0;return void 0!==(e===null||e===void 0?void 0:e.tag)&&(_o108=Ge(e.tag,n)),r=t._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,_o108),0===r&&Re("Can't create run options."),void 0!==(e===null||e===void 0?void 0:e.extra)&&_kr(e.extra,"",new WeakSet(),function(e,i){var o=Ge(e,n),a=Ge(i,n);0!==t._OrtAddRunConfigEntry(r,o,a)&&Re("Can't set a run config entry: ".concat(e," - ").concat(i,"."));}),[r,n];}catch(e){throw 0!==r&&t._OrtReleaseRunOptions(r),n.forEach(function(e){return t._free(e);}),e;}};}),_d,xd,Sd,Id,eo,to=q(function(){dr(),mn(),_d=function _d(e){switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error("unsupported graph optimization level: ".concat(e));}},xd=function xd(e){switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error("unsupported execution mode: ".concat(e));}},Sd=function Sd(e){e.extra||(e.extra={}),e.extra.session||(e.extra.session={});var t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(function(e){return"webgpu"===("string"==typeof e?e:e.name);})&&(e.enableMemPattern=!1);},Id=function Id(e,t,r){var _iterator64=_createForOfIteratorHelper2(t),_step64;try{for(_iterator64.s();!(_step64=_iterator64.n()).done;){var n=_step64.value;var _t361="string"==typeof n?n:n.name;switch(_t361){case"webnn":if(_t361="WEBNN","string"!=typeof n){var _t362=n;if(_t362!==null&&_t362!==void 0&&_t362.deviceType){var _n198=Ge("deviceType",r),_i148=Ge(_t362.deviceType,r);0!==Me()._OrtAddSessionConfigEntry(e,_n198,_i148)&&Re("Can't set a session config entry: 'deviceType' - ".concat(_t362.deviceType,"."));}if(_t362!==null&&_t362!==void 0&&_t362.numThreads){var _n199=_t362.numThreads;("number"!=typeof _n199||!Number.isInteger(_n199)||_n199<0)&&(_n199=0);var _i149=Ge("numThreads",r),_o109=Ge(_n199.toString(),r);0!==Me()._OrtAddSessionConfigEntry(e,_i149,_o109)&&Re("Can't set a session config entry: 'numThreads' - ".concat(_t362.numThreads,"."));}if(_t362!==null&&_t362!==void 0&&_t362.powerPreference){var _n200=Ge("powerPreference",r),_i150=Ge(_t362.powerPreference,r);0!==Me()._OrtAddSessionConfigEntry(e,_n200,_i150)&&Re("Can't set a session config entry: 'powerPreference' - ".concat(_t362.powerPreference,"."));}}break;case"webgpu":if(_t361="JS","string"!=typeof n){var _t363=n;if(_t363!==null&&_t363!==void 0&&_t363.preferredLayout){if("NCHW"!==_t363.preferredLayout&&"NHWC"!==_t363.preferredLayout)throw new Error("preferredLayout must be either 'NCHW' or 'NHWC': ".concat(_t363.preferredLayout));var _n201=Ge("preferredLayout",r),_i151=Ge(_t363.preferredLayout,r);0!==Me()._OrtAddSessionConfigEntry(e,_n201,_i151)&&Re("Can't set a session config entry: 'preferredLayout' - ".concat(_t363.preferredLayout,"."));}}break;case"wasm":case"cpu":continue;default:throw new Error("not supported execution provider: ".concat(_t361));}var i=Ge(_t361,r);0!==Me()._OrtAppendExecutionProvider(e,i)&&Re("Can't append execution provider: ".concat(_t361,"."));}}catch(err){_iterator64.e(err);}finally{_iterator64.f();}},eo=function eo(e){var t=Me(),r=0,n=[],i=e||{};Sd(i);try{var _i$graphOptimizationL2,_i$executionMode2,_i$logSeverityLevel2,_i$logVerbosityLevel2;var _e855=_d((_i$graphOptimizationL2=i.graphOptimizationLevel)!==null&&_i$graphOptimizationL2!==void 0?_i$graphOptimizationL2:"all"),_o110=xd((_i$executionMode2=i.executionMode)!==null&&_i$executionMode2!==void 0?_i$executionMode2:"sequential"),_a86="string"==typeof i.logId?Ge(i.logId,n):0,_s62=(_i$logSeverityLevel2=i.logSeverityLevel)!==null&&_i$logSeverityLevel2!==void 0?_i$logSeverityLevel2:2;if(!Number.isInteger(_s62)||_s62<0||_s62>4)throw new Error("log serverity level is not valid: ".concat(_s62));var _u48=(_i$logVerbosityLevel2=i.logVerbosityLevel)!==null&&_i$logVerbosityLevel2!==void 0?_i$logVerbosityLevel2:0;if(!Number.isInteger(_u48)||_u48<0||_u48>4)throw new Error("log verbosity level is not valid: ".concat(_u48));var _l35="string"==typeof i.optimizedModelFilePath?Ge(i.optimizedModelFilePath,n):0;if(r=t._OrtCreateSessionOptions(_e855,!!i.enableCpuMemArena,!!i.enableMemPattern,_o110,!!i.enableProfiling,0,_a86,_s62,_u48,_l35),0===r&&Re("Can't create session options."),i.executionProviders&&Id(r,i.executionProviders,n),i.freeDimensionOverrides)for(var _i152=0,_Object$entries4=Object.entries(i.freeDimensionOverrides);_i152<_Object$entries4.length;_i152++){var _Object$entries4$_i=_slicedToArray2(_Object$entries4[_i152],2),_e856=_Object$entries4$_i[0],_o111=_Object$entries4$_i[1];if("string"!=typeof _e856)throw new Error("free dimension override name must be a string: ".concat(_e856));if("number"!=typeof _o111||!Number.isInteger(_o111)||_o111<0)throw new Error("free dimension override value must be a non-negative integer: ".concat(_o111));var _i153=Ge(_e856,n);0!==t._OrtAddFreeDimensionOverride(r,_i153,_o111)&&Re("Can't set a free dimension override: ".concat(_e856," - ").concat(_o111,"."));}return void 0!==i.extra&&_kr(i.extra,"",new WeakSet(),function(e,i){var o=Ge(e,n),a=Ge(i,n);0!==t._OrtAddSessionConfigEntry(r,o,a)&&Re("Can't set a session config entry: ".concat(e," - ").concat(i,"."));}),[r,n];}catch(e){throw 0!==r&&t._OrtReleaseSessionOptions(r),n.forEach(function(e){return t._free(e);}),e;}};}),pa,nt,Br,fn,Pr,hn,ma,Ne=q(function(){pa=function pa(e){switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error("unsupported data type: ".concat(e));}},nt=function nt(e){switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error("unsupported data type: ".concat(e));}},Br=function Br(e){return[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e];},fn=function fn(e){switch(e){case"float16":case"uint16":return Uint16Array;case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error("unsupported type: ".concat(e));}},Pr=function Pr(e){switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error("unsupported logging level: ".concat(e));}},hn=function hn(e){return"float32"===e||"int32"===e||"int64"===e||"bool"===e||"float16"===e||"uint32"===e;},ma=function ma(e){switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error("unsupported data location: ".concat(e));}};}),Rr,fa=q(function(){Rr=/*#__PURE__*/function(){var _ref79=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee156(e){var _t364,r,n,_r288,i,_e857,_o112,_yield$i$read,_e858,_t365,_n202,_t366,_r289,_iteratorAbruptCompletion2,_didIteratorError2,_iteratorError2,_iterator2,_step2,_e859;return _regeneratorRuntime2().wrap(function _callee156$(_context160){while(1)switch(_context160.prev=_context160.next){case 0:if(!("string"!=typeof e)){_context160.next=11;break;}if(!(e instanceof Blob)){_context160.next=9;break;}_context160.t1=Uint8Array;_context160.next=5;return e.arrayBuffer();case 5:_context160.t2=_context160.sent;_context160.t0=new _context160.t1(_context160.t2);_context160.next=10;break;case 9:_context160.t0=e instanceof Uint8Array?e:new Uint8Array(e);case 10:return _context160.abrupt("return",_context160.t0);case 11:if(_typeof2(process)<"u"&&process.versions&&process.versions.node){_context160.next=50;break;}_context160.next=14;return fetch(e);case 14:_t364=_context160.sent;if(_t364.ok){_context160.next=17;break;}throw new Error("failed to load external data file: ".concat(e));case 17:r=_t364.headers.get("Content-Length"),n=r?parseInt(r,10):0;if(!(n<1073741824)){_context160.next=24;break;}_context160.t3=Uint8Array;_context160.next=22;return _t364.arrayBuffer();case 22:_context160.t4=_context160.sent;return _context160.abrupt("return",new _context160.t3(_context160.t4));case 24:if(_t364.body){_context160.next=26;break;}throw new Error("failed to load external data file: ".concat(e,", no response body."));case 26:i=_t364.body.getReader();_context160.prev=27;_r288=new ArrayBuffer(n);_context160.next=37;break;case 31:_context160.prev=31;_context160.t5=_context160["catch"](27);if(_context160.t5 instanceof RangeError){_context160.next=35;break;}throw _context160.t5;case 35:_e857=Math.ceil(n/65536);_r288=new WebAssembly.Memory({initial:_e857,maximum:_e857}).buffer;case 37:_o112=0;case 38:_context160.next=40;return i.read();case 40:_yield$i$read=_context160.sent;_e858=_yield$i$read.done;_t365=_yield$i$read.value;if(!_e858){_context160.next=45;break;}return _context160.abrupt("break",49);case 45:_n202=_t365.byteLength;new Uint8Array(_r288,_o112,_n202).set(_t365),_o112+=_n202;case 47:_context160.next=38;break;case 49:return _context160.abrupt("return",new Uint8Array(_r288,0,n));case 50:_context160.prev=50;_context160.t6=Uint8Array;_context160.next=54;return(void 0)(e);case 54:_context160.t7=_context160.sent;return _context160.abrupt("return",new _context160.t6(_context160.t7));case 58:_context160.prev=58;_context160.t8=_context160["catch"](50);if(!("ERR_FS_FILE_TOO_LARGE"===_context160.t8.code)){_context160.next=91;break;}_t366=(void 0)(e),_r289=[];_iteratorAbruptCompletion2=false;_didIteratorError2=false;_context160.prev=64;_iterator2=_asyncIterator(_t366);case 66:_context160.next=68;return _iterator2.next();case 68:if(!(_iteratorAbruptCompletion2=!(_step2=_context160.sent).done)){_context160.next=74;break;}_e859=_step2.value;_r289.push(_e859);case 71:_iteratorAbruptCompletion2=false;_context160.next=66;break;case 74:_context160.next=80;break;case 76:_context160.prev=76;_context160.t9=_context160["catch"](64);_didIteratorError2=true;_iteratorError2=_context160.t9;case 80:_context160.prev=80;_context160.prev=81;if(!(_iteratorAbruptCompletion2&&_iterator2["return"]!=null)){_context160.next=85;break;}_context160.next=85;return _iterator2["return"]();case 85:_context160.prev=85;if(!_didIteratorError2){_context160.next=88;break;}throw _iteratorError2;case 88:return _context160.finish(85);case 89:return _context160.finish(80);case 90:return _context160.abrupt("return",new Uint8Array(ort_webgpu_min_Buffer.concat(_r289)));case 91:throw _context160.t8;case 92:case"end":return _context160.stop();}},_callee156,null,[[27,31],[50,58],[64,76,80,90],[81,,85,89]]);}));return function Rr(_x179){return _ref79.apply(this,arguments);};}();}),Cd,Ad,ro,no,ao,Td,Ue,Dt=q(function(){Ne(),Cd=["V","I","W","E","F"],Ad=function Ad(e,t){console.log("[".concat(Cd[e],",").concat(new Date().toISOString(),"]").concat(t));},ao=function ao(e,t){ro=e,no=t;},Td=function Td(e,t){var r=Pr(e);r>=Pr(ro)&&Ad(r,"function"==typeof t?t():t);},Ue=function Ue(){no&&Td.apply(void 0,arguments);};}),io,oo=q(function(){Ne(),io=function io(e,t){return new(fn(t))(e);};}),gn=q(function(){}),yn,Ed,so,Od,ha,ya,ga,lo,co=q(function(){Dt(),gn(),yn=function yn(e){return 16*Math.ceil(e/16);},Ed=1,so=function so(){return Ed++;},Od=1,ha=function ha(){return Od++;},ya=/*#__PURE__*/function(){var _ref80=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee157(e,t,r,n){var i,o,_a87,_s63,_e860;return _regeneratorRuntime2().wrap(function _callee157$(_context161){while(1)switch(_context161.prev=_context161.next){case 0:i=yn(r),o=e.device.createBuffer({size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});_context161.prev=1;_a87=e.getCommandEncoder();e.endComputePass();_a87.copyBufferToBuffer(t,0,o,0,i);e.flush();_context161.next=8;return o.mapAsync(GPUMapMode.READ);case 8:_s63=o.getMappedRange();if(!n){_context161.next=12;break;}_e860=n();return _context161.abrupt("return",(_e860.set(new Uint8Array(_s63,0,r)),_e860));case 12:return _context161.abrupt("return",new Uint8Array(_s63.slice(0,r)));case 13:_context161.prev=13;o.destroy();return _context161.finish(13);case 16:case"end":return _context161.stop();}},_callee157,null,[[1,,13,16]]);}));return function ya(_x180,_x181,_x182,_x183){return _ref80.apply(this,arguments);};}(),ga=/*#__PURE__*/function(){function ga(e){_classCallCheck2(this,ga);this.backend=e,this.storageCache=new Map(),this.freeBuffers=new Map(),this.freeUniformBuffers=new Map(),this.buffersForUploadingPending=[],this.buffersPending=[],this.externalBuffers=new Map();}return _createClass2(ga,[{key:"upload",value:function upload(e,t){var r=t.buffer,n=t.byteOffset,i=t.byteLength,o=yn(i),a=this.storageCache.get(e);if(!a)throw new Error("gpu data for uploading does not exist");if(a.originalSize!==i)throw new Error("inconsistent data size. gpu data size=".concat(a.originalSize,", data size=").concat(i));var s=this.backend.device.createBuffer({mappedAtCreation:!0,size:o,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),u=s.getMappedRange();new Uint8Array(u).set(new Uint8Array(r,n,i)),s.unmap();var l=this.backend.getCommandEncoder();this.backend.endComputePass(),l.copyBufferToBuffer(s,0,a.gpuData.buffer,0,o),Ue("verbose",function(){return"[WebGPU] GpuDataManager.upload(id=".concat(e,")");}),this.buffersForUploadingPending.push(s);}},{key:"memcpy",value:function memcpy(e,t){var r=this.storageCache.get(e);if(!r)throw new Error("source gpu data for memcpy does not exist");var n=this.storageCache.get(t);if(!n)throw new Error("destination gpu data for memcpy does not exist");if(r.originalSize!==n.originalSize)throw new Error("inconsistent source and destination gpu data size");var i=yn(r.originalSize),o=this.backend.getCommandEncoder();this.backend.endComputePass(),o.copyBufferToBuffer(r.gpuData.buffer,0,n.gpuData.buffer,0,i);}},{key:"registerExternalBuffer",value:function registerExternalBuffer(e,t,r){var n;if(r){if(n=this.externalBuffers.get(r),void 0===n)throw new Error("previous buffer is not registered");if(e===r)return Ue("verbose",function(){return"[WebGPU] GpuDataManager.registerExternalBuffer(size=".concat(t,") => id=").concat(n,", buffer is the same, skip.");}),n;this.externalBuffers["delete"](r);}else n=so();return this.storageCache.set(n,{gpuData:{id:n,type:0,buffer:e,permamentID:ha()},originalSize:t}),this.externalBuffers.set(e,n),Ue("verbose",function(){return"[WebGPU] GpuDataManager.registerExternalBuffer(size=".concat(t,") => id=").concat(n,", registered.");}),n;}},{key:"unregisterExternalBuffer",value:function unregisterExternalBuffer(e){var t=this.externalBuffers.get(e);void 0!==t&&(this.storageCache["delete"](t),this.externalBuffers["delete"](e),Ue("verbose",function(){return"[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=".concat(t);}));}},{key:"create",value:function create(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;var r,n=yn(e),i=(t&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,o=(t&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(i||o){var _e861=i?this.freeBuffers:this.freeUniformBuffers,_o113=_e861.get(n);_o113||(_o113=[],_e861.set(n,_o113)),r=_o113.length>0?_o113.pop():{buffer:this.backend.device.createBuffer({size:n,usage:t}),permamentID:ha()};}else r={buffer:this.backend.device.createBuffer({size:n,usage:t}),permamentID:ha()};var a={id:so(),type:0,buffer:r.buffer,permamentID:r.permamentID};return this.storageCache.set(a.id,{gpuData:a,originalSize:e}),Ue("verbose",function(){return"[WebGPU] GpuDataManager.create(size=".concat(e,") => id=").concat(a.id);}),a;}},{key:"get",value:function get(e){var _this$storageCache$ge;return(_this$storageCache$ge=this.storageCache.get(e))===null||_this$storageCache$ge===void 0?void 0:_this$storageCache$ge.gpuData;}},{key:"release",value:function release(e){var t=this.storageCache.get(e);if(!t)throw new Error("releasing data does not exist");return Ue("verbose",function(){return"[WebGPU] GpuDataManager.release(id=".concat(e,"), gpuDataId=").concat(t.gpuData.id);}),this.storageCache["delete"](e),this.buffersPending.push({buffer:t.gpuData.buffer,permamentID:t.gpuData.permamentID}),t.originalSize;}},{key:"download",value:function(){var _download=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee158(e,t){var r;return _regeneratorRuntime2().wrap(function _callee158$(_context162){while(1)switch(_context162.prev=_context162.next){case 0:r=this.storageCache.get(e);if(r){_context162.next=3;break;}throw new Error("data does not exist");case 3:_context162.next=5;return ya(this.backend,r.gpuData.buffer,r.originalSize,t);case 5:case"end":return _context162.stop();}},_callee158,this);}));function download(_x184,_x185){return _download.apply(this,arguments);}return download;}()},{key:"refreshPendingBuffers",value:function refreshPendingBuffers(){var _iterator65=_createForOfIteratorHelper2(this.buffersForUploadingPending),_step65;try{for(_iterator65.s();!(_step65=_iterator65.n()).done;){var _e862=_step65.value;_e862.destroy();}}catch(err){_iterator65.e(err);}finally{_iterator65.f();}this.buffersForUploadingPending=[];var _iterator66=_createForOfIteratorHelper2(this.buffersPending),_step66;try{for(_iterator66.s();!(_step66=_iterator66.n()).done;){var _e863=_step66.value;(_e863.buffer.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE?this.freeBuffers.get(_e863.buffer.size).push(_e863):(_e863.buffer.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM?this.freeUniformBuffers.get(_e863.buffer.size).push(_e863):_e863.buffer.destroy();}}catch(err){_iterator66.e(err);}finally{_iterator66.f();}this.buffersPending=[];}},{key:"dispose",value:function dispose(){this.freeBuffers.forEach(function(e){e.forEach(function(e){e.buffer.destroy();});}),this.freeUniformBuffers.forEach(function(e){e.forEach(function(e){e.buffer.destroy();});}),this.storageCache.forEach(function(e){e.gpuData.buffer.destroy();}),this.storageCache=new Map(),this.freeBuffers=new Map(),this.freeUniformBuffers=new Map();}}]);}(),lo=function lo(){for(var _len15=arguments.length,e=new Array(_len15),_key15=0;_key15<_len15;_key15++){e[_key15]=arguments[_key15];}return _construct(ga,e);};}),ba,ge,qe=q(function(){ba=/*#__PURE__*/function(){function ba(e){_classCallCheck2(this,ba);Object.assign(this,e);}return _createClass2(ba,[{key:"cacheKey",get:function get(){var _this147=this;return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(function(e){return"".concat(_this147[e]);}).join(";")),this.key;}}]);}(),ge=function ge(e){return new ba(e);};}),wa,gt,ort_webgpu_min_N,Kt,bn,wn,vn,$e=q(function(){wa=/*#__PURE__*/function(){function wa(){_classCallCheck2(this,wa);}return _createClass2(wa,null,[{key:"calcMatMulShape",value:function calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]];}}]);}(),gt=/*#__PURE__*/function(){function gt(){_classCallCheck2(this,gt);}return _createClass2(gt,null,[{key:"calcShape",value:function calcShape(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;var n=e.length,i=t.length;if(0===n)return t;if(0===i)return e;var o=Math.max(e.length,t.length),a=new Array(o);if(r){if(n<2||i<2)return;var _r290=wa.calcMatMulShape([e[n-2],e[n-1]],[t[i-2],t[i-1]]);if(void 0===_r290)return;var _r291=_slicedToArray2(_r290,2);a[o-2]=_r291[0];a[o-1]=_r291[1];}for(var _s64=r?3:1;_s64<=o;_s64++){var _r292=n-_s64<0?1:e[n-_s64],_u49=i-_s64<0?1:t[i-_s64];if(_r292!==_u49&&_r292>1&&_u49>1)return;a[o-_s64]=Math.max(_r292,_u49);}return a;}},{key:"isValidBroadcast",value:function isValidBroadcast(e,t){var r=e.length,n=t.length;if(r>n)return!1;for(var i=1;i<=r;i++)if(1!==e[r-i]&&e[r-i]!==t[n-i])return!1;return!0;}}]);}(),ort_webgpu_min_N=/*#__PURE__*/function(){function e(){_classCallCheck2(this,e);}return _createClass2(e,null,[{key:"size",value:function size(t){return e.getSizeFromDimensionRange(t,0,t.length);}},{key:"sizeFromDimension",value:function sizeFromDimension(t,r){if(r<0||r>t.length)throw new Error("invalid dimension of ".concat(r," for sizeFromDimension as Tensor has ").concat(t.length," dimensions."));return e.getSizeFromDimensionRange(t,r,t.length);}},{key:"sizeToDimension",value:function sizeToDimension(t,r){if(r<0||r>t.length)throw new Error("invalid dimension of ".concat(r," for sizeToDimension as Tensor has ").concat(t.length," dimensions."));return e.getSizeFromDimensionRange(t,0,r);}},{key:"getSizeFromDimensionRange",value:function getSizeFromDimensionRange(_e864,t,r){var n=1;for(var i=t;i<r;i++){if(_e864[i]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");n*=_e864[i];}return n;}},{key:"computeStrides",value:function computeStrides(_e865){var t=_e865.length;if(0===t)return[];if(1===t)return[1];var r=new Array(t);r[t-1]=1,r[t-2]=_e865[t-1];for(var n=t-3;n>=0;--n)r[n]=r[n+1]*_e865[n+1];return r;}},{key:"normalizeAxis",value:function normalizeAxis(_e866,t){if(_e866<-t&&_e866>=t)throw new Error("unsupported axis for this operation.");return _e866<0?_e866+t:_e866;}},{key:"normalizeAxes",value:function normalizeAxes(_e867,t){var _this148=this;return _e867.map(function(r){return _this148.normalizeAxis(r,t!==null&&t!==void 0?t:_e867.length);});}},{key:"sortBasedOnPerm",value:function sortBasedOnPerm(_e868,t){return t?t.map(function(t){return _e868[t];}):_e868.slice().reverse();}},{key:"padShape",value:function padShape(_e869,t){var r=_e869.length;return _e869.map(function(_e870,n){return _e870+t[n]+t[n+r];});}},{key:"areEqual",value:function areEqual(_e871,t){return _e871.length===t.length&&_e871.every(function(_e872,r){return _e872===t[r];});}}]);}(),Kt=/*#__PURE__*/function(){function e(){_classCallCheck2(this,e);}return _createClass2(e,null,[{key:"adjustPoolAttributes",value:function adjustPoolAttributes(_e873,t,r,n,i,o){if(!_e873&&r.length!==t.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(_e873)for(var _e881=0;_e881<t.length-2;_e881++)_e881>=r.length?r.push(t[_e881+2]):r[_e881]=t[_e881+2];for(var _e882=0;_e882<r.length;_e882++)if(_e882<n.length){if(n[_e882]<0)throw new Error("strides should be greater than or equal to 1");}else n.push(1);for(var _e883=0;_e883<r.length;_e883++)if(_e883<i.length){if(i[_e883]<0)throw new Error("dilations should be greater than or equal to 1");}else i.push(1);for(var _e884=0;_e884<2*r.length;_e884++)if(_e884<o.length){if(o[_e884]<0)throw new Error("pad should be greater than or equal to 1");}else o.push(0);for(var _e885=0;_e885<r.length;_e885++){if(r[_e885]<=0)throw new Error("kernel shapes need to be greater than 0");if(o[_e885]>=r[_e885]||o[_e885+r.length]>=r[_e885])throw new Error("pads should be smaller than kernel");}}},{key:"adjustPadsBasedOnAutoPad",value:function adjustPadsBasedOnAutoPad(t,r,n,i,o,a,s){if(s){if(o.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(r.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(var _u50=0;_u50<t.length-2;_u50++)e.adjustPadAndReturnShape(t[_u50+(a?1:2)],r[_u50],n[_u50],i[_u50],o,_u50,_u50+t.length-2,s);}}},{key:"computePoolOutputShape",value:function computePoolOutputShape(t,r,n,i,o,a,s){if(r.length<=0)throw new Error("input shape must be of size greater than 0");var u=[r[0],r[1]];return e.computeShapeHelper(t,r,u,n,i,o,a,s),u;}},{key:"computeConvOutputShape",value:function computeConvOutputShape(t,r,n,i,o,a,s){if(t.length<=0||r.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");var u=[t[0],r[0]];return e.computeShapeHelper(!1,t,u,n,i,o,a,s),u;}},{key:"computeShapeHelper",value:function computeShapeHelper(t,r,n,i,o,a,s,u){if(t)for(var _e886=0;_e886<r.length-2;_e886++)n.push(1);else for(var _t367=0;_t367<r.length-2;_t367++)n.push(e.adjustPadAndReturnShape(r[_t367+2],i[_t367],o[_t367],a[_t367],s,_t367,_t367+r.length-2,u));}},{key:"adjustPadAndReturnShape",value:function adjustPadAndReturnShape(_e880,t,r,n,i,o,a,s){var u=r*(n-1)+1;if(!s||"NOTSET"===s)return Math.floor((_e880+i[o]+i[a]-u)/t+1);switch(s){case"VALID":return i[o]=0,i[a]=0,Math.floor((_e880-u)/t+1);case"SAME_LOWER":case"SAME_UPPER":if(1!==r)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{var _r293=((_e880+t-1)/t-1)*t+n-_e880;return i[o]=Math.floor("SAME_LOWER"===s?(_r293+1)/2:_r293/2),i[a]=_r293-i[o],Math.floor((_e880+_r293-n)/t+1);}default:throw new Error("Unsupported AutoPad type");}}}]);}(),bn=/*#__PURE__*/function(){function bn(){_classCallCheck2(this,bn);}return _createClass2(bn,null,[{key:"getShapeOfGemmResult",value:function getShapeOfGemmResult(e,t,r,n,i){if(2!==e.length||2!==r.length)throw new Error("shape need to be of size 2");var o,a,s;t?(o=e[1],a=e[0]):(o=e[0],a=e[1]);var u=-1;if(n?(s=r[0],u=1):(s=r[1],u=0),r[u]!==a)throw new Error("dimension mismatch");if(o<=0||s<=0||a<=0)throw new Error("invalid shape specified");if(i&&!gt.isValidBroadcast(i,[o,s]))throw new Error("gemm: invalid bias shape for broadcast");return[o,s,a];}}]);}(),wn=-34028234663852886e22,vn=34028234663852886e22;}),kd,$a,Le,yt,F,Fe,Je,mt,at,de,_a,U,ort_webgpu_min_j,$n,va,po,cr,De,we=q(function(){Ne(),$e(),kd=64,$a=function $a(e,t){if(3===t)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(e){case 10:return t>1?"vec".concat(t,"<f16>"):"f16";case 1:return t>1?"vec".concat(t,"<f32>"):"f32";case 6:return t>1?"vec".concat(t,"<i32>"):"i32";case 12:return t>1?"vec".concat(t,"<u32>"):"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(4!==t)throw new Error("bool must be vec4");return["u32","vec4<bool>"];default:throw new Error("Unknown data type: ".concat(e));}},Le=function Le(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var r=$a(e,t);return"string"==typeof r?r:r[0];},yt=function yt(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var r=$a(e,t);return"string"==typeof r?r:r[1];},F=function F(e){return 0===e.length?[]:[{type:"uint32",data:e},{type:"uint32",data:ort_webgpu_min_N.computeStrides(e)}];},Fe=function Fe(e){return e%4==0?4:e%2==0?2:1;},Je=function Je(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"f32";var t=arguments.length>1?arguments[1]:undefined;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"0";return t&&1!==t?"vec".concat(t,"<").concat(e,">(").concat(r,")"):"".concat(e,"(").concat(r,")");},mt=function mt(e,t,r){return"f32"===e?r:1===t?"f32(".concat(r,")"):"vec".concat(t,"f(").concat(r,")");},at=function at(e,t){return 4===t?"(".concat(e,".x + ").concat(e,".y + ").concat(e,".z + ").concat(e,".w)"):2===t?"(".concat(e,".x + ").concat(e,".y)"):3===t?"(".concat(e,".x + ").concat(e,".y + ").concat(e,".z)"):e;},de=function de(e,t,r){return e.startsWith("uniforms.")&&r>4?"string"==typeof t?"".concat(e,"[(").concat(t,") / 4][(").concat(t,") % 4]"):"".concat(e,"[").concat(Math.floor(t/4),"][").concat(t%4,"]"):r>1?"".concat(e,"[").concat(t,"]"):e;},_a=function _a(e,t,r,n,i){var o="number"==typeof r,a=o?r:r.length,s=_toConsumableArray2(new Array(a).keys()),u=a<2?"u32":a<=4?"vec".concat(a,"<u32>"):"array<u32, ".concat(a,">"),l=$a(t,i),c="string"==typeof l?l:l[1],h="string"==typeof l?l:l[0],f={indices:u,value:c,storage:h,tensor:t},d=function d(e){return"string"==typeof e?e:"".concat(e,"u");},p={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},y=o?"uniforms.":"",m="".concat(y).concat(e,"_shape"),g="".concat(y).concat(e,"_strides"),w="";for(var _e887=0;_e887<a-1;_e887++)w+="\n    let dim".concat(_e887," = current / ").concat(de(g,_e887,a),";\n    let rest").concat(_e887," = current % ").concat(de(g,_e887,a),";\n    indices[").concat(_e887,"] = dim").concat(_e887,";\n    current = rest").concat(_e887,";\n    ");w+="indices[".concat(a-1,"] = current;");var b=a<2?"":"\n  fn o2i_".concat(e,"(offset: u32) -> ").concat(f.indices," {\n    var indices: ").concat(f.indices,";\n    var current = offset;\n    ").concat(w,"\n    return indices;\n  }"),v=[];if(a>=2)for(var _e888=a-1;_e888>=0;_e888--)v.push("".concat(de(g,_e888,a)," * (indices[").concat(_e888,"])"));var x=a<2?"":"\n  fn i2o_".concat(e,"(indices: ").concat(f.indices,") -> u32 {\n    return ").concat(v.join("+"),";\n  }"),_=function _(){for(var _len16=arguments.length,e=new Array(_len16),_key16=0;_key16<_len16;_key16++){e[_key16]=arguments[_key16];}return 0===a?"0u":"".concat(f.indices,"(").concat(e.map(d).join(","),")");},S=function S(e,t){return a<2?"".concat(e):"".concat(de(e,t,a));},T={},I=function I(t,r){return function(){if(f.storage===f.value)return"".concat(e,"[").concat(t,"]=").concat(r,";");if("vec2<u32>"===f.storage&&"i32"===f.value)return"".concat(e,"[").concat(t,"]=vec2<u32>(u32(").concat(r,"), select(0u, 0xFFFFFFFFu, ").concat(r," < 0));");if("vec2<u32>"===f.storage&&"u32"===f.value)return"".concat(e,"[").concat(t,"]=vec2<u32>(u32(").concat(r,"), 0u);");if("u32"===f.storage&&"vec4<bool>"===f.value)return"".concat(e,"[").concat(t,"]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(").concat(r,"));");throw new Error("not supported combination of storage type ".concat(f.storage," and value type ").concat(f.value," yet"));}();},E=function E(t){return function(){if(f.storage===f.value)return"".concat(e,"[").concat(t,"]");if("vec2<u32>"===f.storage&&"i32"===f.value)return"i32(".concat(e,"[").concat(t,"].x)");if("vec2<u32>"===f.storage&&"u32"===f.value)return"u32(".concat(e,"[").concat(t,"].x)");if("u32"===f.storage&&"vec4<bool>"===f.value)return"vec4<bool>(bool(".concat(e,"[").concat(t,"] & 0xFFu), bool(").concat(e,"[").concat(t,"] & 0xFF00u), bool(").concat(e,"[").concat(t,"] & 0xFF0000u), bool(").concat(e,"[").concat(t,"] & 0xFF000000u))");throw new Error("not supported combination of storage type ".concat(f.storage," and value type ").concat(f.value," yet"));}();},A=a<2?"":"\n  fn get_".concat(e,"ByIndices(indices: ").concat(f.indices,") -> ").concat(c," {\n    return ").concat(E("i2o_".concat(e,"(indices)")),";\n  }"),C=a<2?"":function(){var t=s.map(function(e){return"d".concat(e,": u32");}).join(", "),r=s.map(function(e){return"d".concat(e);}).join(", ");return"\n  fn get_".concat(e,"(").concat(t,") -> ").concat(c," {\n    return get_").concat(e,"ByIndices(").concat(_(r),");\n  }");}(),O=a<2?"":"\n  fn set_".concat(e,"ByIndices(indices: ").concat(f.indices,", value: ").concat(c,") {\n    ").concat(I("i2o_".concat(e,"(indices)"),"value"),"\n  }"),P=a<2?"":function(){var t=s.map(function(e){return"d".concat(e,": u32");}).join(", "),r=s.map(function(e){return"d".concat(e);}).join(", ");return"\n  fn set_".concat(e,"(").concat(t,", value: ").concat(c,") {\n    set_").concat(e,"ByIndices(").concat(_(r),", value);\n  }");}();return{impl:function impl(){var e=[],t=!1;return p.offsetToIndices&&(e.push(b),t=!0),p.indicesToOffset&&(e.push(x),t=!0),p.broadcastedIndicesToOffset&&(Object.values(T).forEach(function(t){return e.push(t);}),t=!0),p.set&&(e.push(P),t=!0),p.setByIndices&&(e.push(O),t=!0),p.get&&(e.push(C),t=!0),p.getByIndices&&(e.push(A),t=!0),!o&&t&&e.unshift("const ".concat(m," = ").concat(f.indices,"(").concat(r.join(","),");"),"const ".concat(g," = ").concat(f.indices,"(").concat(ort_webgpu_min_N.computeStrides(r).join(","),");")),e.join("\n");},type:f,offsetToIndices:function offsetToIndices(t){return p.offsetToIndices=!0,a<2?t:"o2i_".concat(e,"(").concat(t,")");},indicesToOffset:function indicesToOffset(t){return p.indicesToOffset=!0,a<2?t:"i2o_".concat(e,"(").concat(t,")");},broadcastedIndicesToOffset:function broadcastedIndicesToOffset(t,r){p.broadcastedIndicesToOffset=!0;var n="".concat(r.name,"broadcastedIndicesTo").concat(e,"Offset");if(n in T)return"".concat(n,"(").concat(t,")");var i=[];for(var _e889=a-1;_e889>=0;_e889--){var _t368=r.indicesGet("outputIndices",_e889+r.rank-a);i.push("".concat(S(g,_e889)," * (").concat(_t368," % ").concat(S(m,_e889),")"));}return T[n]="fn ".concat(n,"(outputIndices: ").concat(r.type.indices,") -> u32 {\n             return ").concat(i.length>0?i.join("+"):"0u",";\n           }"),"".concat(n,"(").concat(t,")");},indices:_,indicesGet:S,indicesSet:function indicesSet(e,t,r){return a<2?"".concat(e,"=").concat(r,";"):"".concat(de(e,t,a),"=").concat(r,";");},set:function set(){for(var _len17=arguments.length,t=new Array(_len17),_key17=0;_key17<_len17;_key17++){t[_key17]=arguments[_key17];}if(t.length!==a+1)throw new Error("indices length must be ".concat(a));var r=t[a];if("string"!=typeof r)throw new Error("value must be string");var n=t.slice(0,a).map(d).join(",");return 0===a?I("0u",r):1===a?I(n[0],r):(p.set=!0,p.setByIndices=!0,p.indicesToOffset=!0,"set_".concat(e,"(").concat(n,", ").concat(r,")"));},setByOffset:I,setByIndices:function setByIndices(t,r){return a<2?I(t,r):(p.setByIndices=!0,p.indicesToOffset=!0,"set_".concat(e,"ByIndices(").concat(t,", ").concat(r,");"));},get:function get(){for(var _len18=arguments.length,t=new Array(_len18),_key18=0;_key18<_len18;_key18++){t[_key18]=arguments[_key18];}if(t.length!==a)throw new Error("indices length must be ".concat(a));var r=t.map(d).join(",");return 0===a?E("0u"):1===a?E(r[0]):(p.get=!0,p.getByIndices=!0,p.indicesToOffset=!0,"get_".concat(e,"(").concat(r,")"));},getByOffset:E,getByIndices:function getByIndices(t){return a<2?E(t):(p.getByIndices=!0,p.indicesToOffset=!0,"get_".concat(e,"ByIndices(").concat(t,")"));},usage:n,name:e,strides:g,shape:m,rank:a};},U=function U(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1;return _a(e,t,r,"input",n);},ort_webgpu_min_j=function ort_webgpu_min_j(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1;return _a(e,t,r,"output",n);},$n=function $n(e,t,r){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1;return _a(e,t,r,"internal",n);},va=/*#__PURE__*/function(){function va(e){_classCallCheck2(this,va);this.normalizedDispatchGroup=e,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0;}return _createClass2(va,[{key:"guardAgainstOutOfBoundsWorkgroupSizes",value:function guardAgainstOutOfBoundsWorkgroupSizes(e){return"if (global_idx >= ".concat("number"==typeof e?"".concat(e,"u"):e,") { return; }");}},{key:"mainStart",value:function mainStart(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:kd;var t="number"==typeof e?e:e[0],r="number"==typeof e?1:e[1],n="number"==typeof e?1:e[2],i=1===this.normalizedDispatchGroup[1]&&1===this.normalizedDispatchGroup[2];return"@compute @workgroup_size(".concat(t,", ").concat(r,", ").concat(n,")\n  fn main(").concat(i?"@builtin(global_invocation_id) global_id : vec3<u32>,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(local_invocation_id) local_id : vec3<u32>":"@builtin(local_invocation_id) local_id : vec3<u32>,\n    @builtin(local_invocation_index) local_idx : u32,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(num_workgroups) num_workgroups : vec3<u32>",") {\n    ").concat(i?"let global_idx = global_id.x; let local_idx = local_id.x;":"let global_idx = (workgroup_id.z * num_workgroups[0] * num_workgroups[1] +\n          workgroup_id.y * num_workgroups[0] + workgroup_id.x) * ".concat(t*r*n,"u + local_idx;"),"\n  ");}},{key:"appendVariableUniforms",value:function appendVariableUniforms(e){0!==e.rank&&(e.shape.startsWith("uniforms.")&&this.uniforms.push({name:e.shape.replace("uniforms.",""),type:"u32",length:e.rank}),e.strides.startsWith("uniforms.")&&this.uniforms.push({name:e.strides.replace("uniforms.",""),type:"u32",length:e.rank}));}},{key:"declareVariable",value:function declareVariable(e,t){if("internal"===e.usage)throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(e),this.appendVariableUniforms(e);var r="input"===e.usage?"read":"read_write",n=e.type.storage;return"@group(0) @binding(".concat(t,") var<storage, ").concat(r,"> ").concat(e.name,": array<").concat(n,">;");}},{key:"declareVariables",value:function declareVariables(){var _this149=this;for(var _len19=arguments.length,e=new Array(_len19),_key19=0;_key19<_len19;_key19++){e[_key19]=arguments[_key19];}return e.map(function(e){return _this149.declareVariable(e,_this149.variableIndex++);}).join("\n");}},{key:"registerInternalVariable",value:function registerInternalVariable(e){if("internal"!==e.usage)throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(e),this.appendVariableUniforms(e);}},{key:"registerInternalVariables",value:function registerInternalVariables(){var _this150=this;for(var _len20=arguments.length,e=new Array(_len20),_key20=0;_key20<_len20;_key20++){e[_key20]=arguments[_key20];}return e.forEach(function(e){return _this150.registerInternalVariable(e);}),this;}},{key:"registerUniform",value:function registerUniform(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;return this.uniforms.push({name:e,type:t,length:r}),this;}},{key:"registerUniforms",value:function registerUniforms(e){return this.uniforms=this.uniforms.concat(e),this;}},{key:"uniformDeclaration",value:function uniformDeclaration(){if(0===this.uniforms.length)return"";var e=[];var _iterator67=_createForOfIteratorHelper2(this.uniforms),_step67;try{for(_iterator67.s();!(_step67=_iterator67.n()).done;){var _step67$value=_step67.value,_t369=_step67$value.name,r=_step67$value.type,n=_step67$value.length;if(n&&n>4)e.push("".concat(_t369,":array<vec4<").concat(r,">, ").concat(Math.ceil(n/4),">"));else{var i=null==n||1===n?r:"vec".concat(n,"<").concat(r,">");e.push("".concat(_t369,":").concat(i));}}}catch(err){_iterator67.e(err);}finally{_iterator67.f();}return"\n      struct Uniforms { ".concat(e.join(", ")," };\n      @group(0) @binding(").concat(this.variableIndex,") var<uniform> uniforms: Uniforms;");}},{key:"additionalImplementations",get:function get(){return this.uniformDeclaration()+this.variables.map(function(e){return e.impl();}).join("\n")+this.internalVariables.map(function(e){return e.impl();}).join("\n");}}]);}(),po=function po(e){return new va(e);},cr=function cr(e,t){var r=e.length,n=[];for(var i=0;i<r;i++){var _o114=r-1-i,_a88=e[_o114]||1;(t[t.length-1-i]||1)>1&&1===_a88&&n.unshift(_o114);}return n;},De=function De(e){return!0;};}),Bd,mo,Pd,Rd,ft,fo,ho,pr=q(function(){$e(),qe(),we(),Bd=function Bd(e){if(!e||1!==e.length)throw new Error("Transpose requires 1 input.");},mo=function mo(e,t){return t&&t.length!==e?_toConsumableArray2(new Array(e).keys()).reverse():t;},Pd=function Pd(e,t){return ort_webgpu_min_N.sortBasedOnPerm(e,mo(e.length,t));},Rd=function Rd(e,t,r,n){var i=[];i.push("fn perm(i: ".concat(n.type.indices,") -> ").concat(r.type.indices," {\n    var a: ").concat(r.type.indices,";"));for(var _n203=0;_n203<t;++_n203)i.push(r.indicesSet("a",e[_n203],"i[".concat(_n203,"]")));return i.push("return a;}"),i.join("\n");},ft=function ft(e,t){var r=e.dataType,n=e.dims.length,i=mo(n,t),o=De(n),a=Pd(e.dims,i),s=o?a.length:a,u=o?n:e.dims,l=ort_webgpu_min_j("output",r,s),c=U("a",r,u);return{name:"Transpose",shaderCache:{hint:"".concat(t),inputDependencies:o?["rank"]:["dims"]},getRunData:function getRunData(e){var t=ort_webgpu_min_N.size(a);return{outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(t/64)},programUniforms:o?[{type:"uint32",data:t}].concat(_toConsumableArray2(F(e[0].dims)),_toConsumableArray2(F(a))):[{type:"uint32",data:t}]};},getShaderSource:function getShaderSource(e){return"\n  ".concat(e.registerUniform("output_size","u32").declareVariables(c,l),"\n\n  ").concat(Rd(i,n,c,l),"\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n\n    let indices = ").concat(l.offsetToIndices("global_idx"),";\n    let aIndices = perm(indices);\n\n    ").concat(l.setByOffset("global_idx",c.getByIndices("aIndices")),"\n  }");}};},fo=function fo(e,t){Bd(e.inputs),e.compute(ft(e.inputs[0],t.perm));},ho=function ho(e){return ge({perm:e.perm});};}),Dd,Md,Ud,zd,Nd,Vd,Wd,Gd,Hd,Ld,bt,go,yo,bo,wo,vo,$o,_o,xo,So,Io,Co=q(function(){$e(),we(),_n(),pr(),Dd={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},Md={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},Ud={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},zd={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},Nd=function Nd(e,t){var r=[];for(var n=t-e;n<t;++n)r.push(n);return r;},Vd=function Vd(e,t){var r=[],n=e.length;for(var _i154=0;_i154<n;_i154++)-1===t.indexOf(_i154)&&r.push(e[_i154]);var i=t.map(function(t){return e[t];});return[r,i];},Wd=function Wd(e,t){var r=e.length+t.length,n=[],i=0;for(var _o115=0;_o115<r;_o115++)-1===t.indexOf(_o115)?n.push(e[i++]):n.push(1);return n;},Gd=function Gd(e,t){for(var r=0;r<e.length;++r)if(e[e.length-r-1]!==t-1-r)return!1;return!0;},Hd=function Hd(e,t){var r=[];if(!Gd(e,t)){for(var n=0;n<t;++n)-1===e.indexOf(n)&&r.push(n);e.forEach(function(e){return r.push(e);});}return r;},Ld=function Ld(e,t,r,n,i,o,a){var s=r[0].dims,u=ort_webgpu_min_N.size(o),l=ort_webgpu_min_N.size(a),c=U("_A",r[0].dataType,s),h=ort_webgpu_min_j("output",i,o),f="\n          var<workgroup> aBestValues : array<".concat(h.type.storage,", 32>;\n       ");return{name:e,shaderCache:t,getShaderSource:function getShaderSource(e){return"\n        ".concat(e.registerUniform("reduceSize","u32").declareVariables(c,h),"\n        ").concat(f,"\n        fn DIV_CEIL(a : u32, b : u32) -> u32 {\n          return ((a - 1u) / b + 1u);\n         }\n         ").concat(e.mainStart(32),"\n\n          let outputIndex = global_idx / 32;\n          let offset = outputIndex * uniforms.reduceSize;\n\n          var bestValue = ").concat(h.type.storage,"(").concat(Ud[n],");\n          let Length = uniforms.reduceSize;\n          for (var k = local_idx; k < Length; k = k + 32) {\n           let candidate = ").concat(h.type.storage,"(").concat(c.getByOffset("offset + k"),");\n           bestValue = ").concat(Dd[n],";\n          }\n          aBestValues[local_idx] = bestValue;\n          workgroupBarrier();\n\n         var reduceSize = min(Length, 32u);\n         for (var currentSize = reduceSize / 2u; reduceSize > 1u;\n             currentSize = reduceSize / 2u) {\n           let interval = DIV_CEIL(reduceSize, 2u);\n           if (local_idx < currentSize) {\n            let candidate = aBestValues[local_idx + interval];\n            bestValue = ").concat(Md[n],";\n            aBestValues[local_idx] = bestValue;\n           }\n           reduceSize = interval;\n           workgroupBarrier();\n         }\n\n         if (local_idx == 0u) {\n          ").concat(h.setByOffset("outputIndex",""+("mean"===n?"bestValue / ".concat(h.type.storage,"(uniforms.reduceSize)"):"".concat(zd[n]))),";\n         }\n        }");},getRunData:function getRunData(){return{outputs:[{dims:o,dataType:i}],dispatchGroup:{x:u},programUniforms:[{type:"uint32",data:l}]};}};},bt=function bt(e,t,r,n){var i=1===e.inputs.length?r:xa(e.inputs,r),o=i.axes;0===o.length&&!i.noopWithEmptyAxes&&(o=e.inputs[0].dims.map(function(e,t){return t;}));var a=ort_webgpu_min_N.normalizeAxes(o,e.inputs[0].dims.length),s=a,u=e.inputs[0],l=Hd(s,e.inputs[0].dims.length);l.length>0&&(u=e.compute(ft(e.inputs[0],l),{inputs:[0],outputs:[-1]})[0],s=Nd(s.length,u.dims.length));var _Vd=Vd(u.dims,s),_Vd2=_slicedToArray2(_Vd,2),c=_Vd2[0],h=_Vd2[1],f=c;i.keepDims&&(f=Wd(c,a)),e.compute(Ld(t,{hint:i.cacheKey,inputDependencies:["type"]},[u],n,e.inputs[0].dataType,f,h),{inputs:[u]});},go=function go(e,t){bt(e,"ReduceMeanShared",t,"mean");},yo=function yo(e,t){bt(e,"ReduceL1Shared",t,"l1");},bo=function bo(e,t){bt(e,"ReduceL2Shared",t,"l2");},wo=function wo(e,t){bt(e,"ReduceLogSumExpShared",t,"logSumExp");},vo=function vo(e,t){bt(e,"ReduceMaxShared",t,"max");},$o=function $o(e,t){bt(e,"ReduceMinShared",t,"min");},_o=function _o(e,t){bt(e,"ReduceProdShared",t,"prod");},xo=function xo(e,t){bt(e,"ReduceSumShared",t,"sum");},So=function So(e,t){bt(e,"ReduceSumSquareShared",t,"sumSquare");},Io=function Io(e,t){bt(e,"ReduceLogSumShared",t,"logSum");};}),wt,Fd,xn,xa,vt,qd,jd,Kd,Yd,Zd,Xd,Jd,Qd,ec,tc,$t,Ao,To,Eo,Oo,ko,Bo,Po,Ro,Do,Mo,_n=q(function(){$e(),qe(),we(),Co(),wt=function wt(e){if(!e||0===e.length||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(2===e.length&&1!==e[1].dims.length)throw new Error("Invalid axes input dims.");},Fd=function Fd(e){return["","","var value = ".concat(e.getByIndices("input_indices"),";"),""];},xn=function xn(e,t,r,n,i,o){var a=arguments.length>6&&arguments[6]!==undefined?arguments[6]:!1;var s=arguments.length>7&&arguments[7]!==undefined?arguments[7]:!1;var u=[],l=r[0].dims,c=l.length,h=ort_webgpu_min_N.normalizeAxes(i,c),f=!s&&0===h.length;l.forEach(function(e,t){f||h.indexOf(t)>=0?a&&u.push(1):u.push(e);});var d=u.length,p=ort_webgpu_min_N.size(u);return{name:e,shaderCache:t,getShaderSource:function getShaderSource(e){var t=[],i=U("_A",r[0].dataType,c),s=ort_webgpu_min_j("output",o,d),u=n(i,s,h),p=u[2];for(var _e890=0,_r294=0;_e890<c;_e890++)f||h.indexOf(_e890)>=0?(a&&_r294++,p="for(var j".concat(_e890,": u32 = 0; j").concat(_e890," < ").concat(l[_e890],"; j").concat(_e890,"++) {\n                  ").concat(u[2].includes("last_index")?"let last_index = j".concat(_e890,";"):"","\n                  ").concat(i.indicesSet("input_indices",_e890,"j".concat(_e890)),"\n                  ").concat(p,"\n                }")):(t.push("".concat(i.indicesSet("input_indices",_e890,s.indicesGet("output_indices",_r294)),";")),_r294++);return"\n\n        ".concat(e.registerUniform("output_size","u32").declareVariables(i,s),"\n\n        ").concat(e.mainStart(),"\n          ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n          var input_indices: ").concat(i.type.indices,";\n          let output_indices = ").concat(s.offsetToIndices("global_idx"),";\n\n          ").concat(t.join("\n"),"\n          ").concat(u[0],"       // init ops for reduce max/min\n          ").concat(u[1],"\n          ").concat(p,"\n          ").concat(u[3],"\n          ").concat(4===u.length?s.setByOffset("global_idx","value"):u.slice(4).join("\n"),"\n        }");},getRunData:function getRunData(){return{outputs:[{dims:u,dataType:o}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:[{type:"uint32",data:p}].concat(_toConsumableArray2(F(l)),_toConsumableArray2(F(u)))};}};},xa=function xa(e,t){var r=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(function(e){return r.push(Number(e));}),ge({axes:r,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes});},vt=function vt(e,t,r,n){var i=e.inputs,o=1===i.length?r:xa(i,r);e.compute(xn(t,{hint:o.cacheKey,inputDependencies:["rank"]},[i[0]],o.noopWithEmptyAxes&&0===o.axes.length?Fd:n,o.axes,i[0].dataType,o.keepDims,o.noopWithEmptyAxes),{inputs:[0]});},qd=function qd(e,t){wt(e.inputs),vt(e,"ReduceLogSum",t,function(e,t){return["var value = ".concat(t.type.storage,"(0);"),"","value += ".concat(e.getByIndices("input_indices"),";"),"value = log(value);"];});},jd=function jd(e,t){wt(e.inputs),vt(e,"ReduceL1",t,function(e,t){return["var value = ".concat(t.type.storage,"(0);"),"","value += abs(".concat(e.getByIndices("input_indices"),");"),""];});},Kd=function Kd(e,t){wt(e.inputs),vt(e,"ReduceL2",t,function(e,t){return["var t = ".concat(t.type.value,"(0); var value = ").concat(t.type.value,"(0);"),"","t = ".concat(e.getByIndices("input_indices"),"; value += (t * t);"),"value = sqrt(value);"];});},Yd=function Yd(e,t){wt(e.inputs),vt(e,"ReduceLogSumExp",t,function(e,t){return["var value = ".concat(t.type.storage,"(0);"),"","value += exp(".concat(e.getByIndices("input_indices"),");"),"value = log(value);"];});},Zd=function Zd(e,t){wt(e.inputs),vt(e,"ReduceMax",t,function(e,t,r){var n=[];for(var _t370=0;_t370<e.rank;_t370++)(r.indexOf(_t370)>=0||0===r.length)&&n.push(e.indicesSet("input_indices",_t370,0));return["".concat(n.join("\n")),"var value = ".concat(e.getByIndices("input_indices"),";"),"value = max(value, ".concat(e.getByIndices("input_indices"),");"),""];});},Xd=function Xd(e,t){wt(e.inputs),vt(e,"ReduceMean",t,function(t,r,n){var i=1;for(var _r295=0;_r295<t.rank;_r295++)(n.indexOf(_r295)>=0||0===n.length)&&(i*=e.inputs[0].dims[_r295]);return["var sum = f32(0);","","sum += f32(".concat(t.getByIndices("input_indices"),");"),"let value = ".concat(r.type.value,"(sum / ").concat(i,");")];});},Jd=function Jd(e,t){wt(e.inputs),vt(e,"ReduceMin",t,function(e,t,r){var n=[];for(var _t371=0;_t371<e.rank;_t371++)(r.indexOf(_t371)>=0||0===r.length)&&n.push("input_indices[".concat(_t371,"] = 0;"));return["".concat(n.join("\n")),"var value = ".concat(e.getByIndices("input_indices"),";"),"value = min(value, ".concat(e.getByIndices("input_indices"),");"),""];});},Qd=function Qd(e,t){wt(e.inputs),vt(e,"ReduceProd",t,function(e,t){return["var value = ".concat(t.type.storage,"(1);"),"","value *= ".concat(e.getByIndices("input_indices"),";"),""];});},ec=function ec(e,t){wt(e.inputs),vt(e,"ReduceSum",t,function(e,t){return["var value = ".concat(t.type.storage,"(0);"),"","value += ".concat(e.getByIndices("input_indices"),";"),""];});},tc=function tc(e,t){wt(e.inputs),vt(e,"ReduceSumSquare",t,function(e,t){return["var t = ".concat(t.type.value,"(0); var value = ").concat(t.type.value,"(0);"),"","t = ".concat(e.getByIndices("input_indices"),"; value += t * t;"),""];});},$t=function $t(e,t,r){if(0===t.length)return r;var n=1,i=1;for(var _r296=0;_r296<t.length;_r296++)-1===t.indexOf(_r296)?n*=e[_r296]:i*=e[_r296];return i<32&&n>1024;},Ao=function Ao(e,t){$t(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Xd(e,t):go(e,t);},To=function To(e,t){$t(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?jd(e,t):yo(e,t);},Eo=function Eo(e,t){$t(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Kd(e,t):bo(e,t);},Oo=function Oo(e,t){$t(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Yd(e,t):wo(e,t);},ko=function ko(e,t){$t(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Zd(e,t):vo(e,t);},Bo=function Bo(e,t){$t(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Jd(e,t):$o(e,t);},Po=function Po(e,t){$t(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Qd(e,t):_o(e,t);},Ro=function Ro(e,t){$t(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?ec(e,t):xo(e,t);},Do=function Do(e,t){$t(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?tc(e,t):So(e,t);},Mo=function Mo(e,t){$t(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?qd(e,t):Io(e,t);};}),Uo,zo,No,Sa,Vo=q(function(){Ne(),qe(),_n(),Uo=function Uo(e){if(!e||0===e.length||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(1!==e[0].dataType)throw new Error("Invalid input type.");},zo=function zo(e,t){Uo(e.inputs);e.compute(xn("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],function(e,r,n){var i=[];for(var _t372=0;_t372<e.rank;_t372++)(n.indexOf(_t372)>=0||0===n.length)&&i.push("input_indices[".concat(_t372,"] = 0;"));return["".concat(i.join("\n")),"var value = ".concat(e.getByIndices("input_indices"),";\nvar best_index : i32 = 0;"),"if (".concat(e.getByIndices("input_indices")," ").concat(t.selectLastIndex>0?"<=":"<"," value) {\n         value = ").concat(e.getByIndices("input_indices"),";\n         best_index = i32(last_index);\n       }"),"",r.setByOffset("global_idx","best_index")];},[t.axis],7,t.keepDims),{inputs:[0]});},No=function No(e,t){Uo(e.inputs);e.compute(xn("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],function(e,r,n){var i=[];for(var _t373=0;_t373<e.rank;_t373++)(n.indexOf(_t373)>=0||0===n.length)&&i.push("input_indices[".concat(_t373,"] = 0;"));return["".concat(i.join("\n")),"var value = ".concat(e.getByIndices("input_indices"),";\nvar best_index : i32 = 0;"),"if (".concat(e.getByIndices("input_indices")," ").concat(t.selectLastIndex>0?">=":">"," value) {\n         value = ").concat(e.getByIndices("input_indices"),";\n         best_index = i32(last_index);\n       }"),"",r.setByOffset("global_idx","best_index")];},[t.axis],7,t.keepDims),{inputs:[0]});},Sa=function Sa(e){return ge(e);};}),rc,nc,ac,ic,Sn,oc,Wo,Ia=q(function(){Ne(),gn(),we(),rc=function rc(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5];if(a&&s)throw new Error("Attention cannot have both past and relative_position_bias");if(3!==r.dims.length)throw new Error('Input "input" must have 3 dimensions');var u=r.dims[0],l=r.dims[1],c=r.dims[2];if(1!==i.dims.length)throw new Error('Input "bias" is expected to have 1 dimensions');if(2!==n.dims.length)throw new Error('Input "weights" is expected to have 2 dimensions');if(n.dims[0]!==c)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(i.dims[0]!==n.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');var h=i.dims[0]/3,f=h,d=f;if(t.qkvHiddenSizes.length>0){if(3!==t.qkvHiddenSizes.length)throw new Error("qkv_hidden_sizes attribute should have 3 elements");var _iterator68=_createForOfIteratorHelper2(t.qkvHiddenSizes),_step68;try{for(_iterator68.s();!(_step68=_iterator68.n()).done;){var _e891=_step68.value;if(_e891%t.numHeads!=0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");}}catch(err){_iterator68.e(err);}finally{_iterator68.f();}h=t.qkvHiddenSizes[0],f=t.qkvHiddenSizes[1],d=t.qkvHiddenSizes[2];}var p=l;if(h!==f)throw new Error("qkv_hidden_sizes first element should be same as the second");if(i.dims[0]!==h+f+d)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');var y=0;if(a){if(f!==d)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(5!==a.dims.length)throw new Error('Input "past" must have 5 dimensions');if(2!==a.dims[0])throw new Error('Input "past" first dimension must be 2');if(a.dims[1]!==u)throw new Error('Input "past" second dimension must be batch_size');if(a.dims[2]!==t.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(a.dims[4]!==f/t.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');t.pastPresentShareBuffer||(y=a.dims[3]);}var m=p+y;if(o)throw new Error("Mask not supported");if(a)throw new Error("past is not supported");if(s)throw new Error("relativePositionBias is not supported");return{batchSize:u,sequenceLength:l,pastSequenceLength:y,kvSequenceLength:p,totalSequenceLength:m,maxSequenceLength:-1,inputHiddenSize:c,hiddenSize:h,vHiddenSize:d,headSize:Math.floor(h/t.numHeads),vHeadSize:Math.floor(d/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:0,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1};},nc=function nc(e,t,r,n){var i=Fe(n),o=64,a=n/i;a<o?o=1:a/8<64&&(o=Math.ceil(a/8));var s=Math.ceil(n/i/o),u=[{type:nt(t.dataType),data:1/n},{type:"uint32",data:a},{type:"uint32",data:s}],l=Le(t.dataType,i);e.compute({name:"AttentionProbsSoftmax",shaderCache:{hint:"".concat(o,";").concat(l,";").concat(i)},getShaderSource:function getShaderSource(e){var r=ort_webgpu_min_j("x",t.dataType,t.dims,i),n="thread_max_vector";2===i?n="max(thread_max_vector.x, thread_max_vector.y)":4===i&&(n="max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))");var a=yt(t.dataType),s=[{name:"d_inv",type:a},{name:"d_comp",type:"u32"},{name:"elements_per_wg",type:"u32"}];return"\n  var<workgroup> wgMax: array<f32, ".concat(o,">;\n  var<workgroup> wgSum: array<f32, ").concat(o,">;\n  ").concat(e.registerUniforms(s).declareVariables(r),"\n  ").concat(e.mainStart([o,1,1]),"\n    let localOffset = local_idx * uniforms.elements_per_wg;\n    let offset: u32 = workgroup_id.x * uniforms.d_comp + localOffset;\n\n    var thread_max_vector = ").concat(Je("f32",i,"-3.402823e+38f"),";\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      thread_max_vector = max(").concat(mt(a,i,"x[offset + i]"),", thread_max_vector);\n    }\n    wgMax[local_idx] = ").concat(n,";\n    workgroupBarrier();\n\n    var maxValue = -3.402823e+38f;\n    for (var i = 0u; i < ").concat(o,"; i++) {\n      maxValue = max(wgMax[i], maxValue);\n    }\n\n    var sumVector = ").concat(Je("f32",i,"0"),";\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      sumVector += exp(").concat(mt(a,i,"x[offset + i]")," - maxValue);\n    }\n    wgSum[local_idx] = ").concat(at("sumVector",i),";\n    workgroupBarrier();\n\n    var sum: f32 = 0;\n    for (var i = 0u; i < ").concat(o,"; i++) {\n      sum += wgSum[i];\n    }\n\n    if (sum == 0) {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        x[offset + i] = ").concat(Je("f32",i,"uniforms.d_inv"),";\n      }\n    } else {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        let f32input = ").concat(mt(a,i,"x[offset + i]"),";\n        x[offset + i] = ").concat(r.type.value,"(exp(f32input - maxValue) / sum);\n      }\n    }\n  }");},getRunData:function getRunData(){return{outputs:[],dispatchGroup:{x:r},programUniforms:u};}},{inputs:[t],outputs:[]});},ac=function ac(e,t,r,n,i,o){var a=[i.batchSize,i.numHeads,i.sequenceLength,i.kvSequenceLength+i.pastSequenceLength],s=0===o.scale?1/Math.sqrt(i.headSize):o.scale,u=Fe(i.headSize),l=i.headSize/u,c=12,h={x:Math.ceil(i.totalSequenceLength/c),y:Math.ceil(i.sequenceLength/c),z:i.batchSize*i.numHeads},f=nt(t.dataType),d=[{type:"uint32",data:i.sequenceLength},{type:"uint32",data:l},{type:"uint32",data:i.totalSequenceLength},{type:"uint32",data:i.kvSequenceLength},{type:f,data:s}],p=[t,r],y=e.compute({name:"AttentionProbs",shaderCache:{hint:"".concat(u),inputDependencies:["type","type"]},getRunData:function getRunData(){return{outputs:[{dims:a,dataType:t.dataType,gpuDataType:0}],dispatchGroup:h,programUniforms:d};},getShaderSource:function getShaderSource(e){var n=U("q",t.dataType,t.dims,u),i=U("key",r.dataType,r.dims,u),o=ort_webgpu_min_j("output",t.dataType,a),s=Le(t.dataType),l=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"alpha",type:s}];return"\n  const beta: ".concat(s," = 1.0;\n  const TILE_SIZE = 12u;\n\n  var<workgroup> tileQ: array<").concat(n.type.storage,", 144>;\n  var<workgroup> tileK: array<").concat(n.type.storage,", 144>;\n  ").concat(e.registerUniforms(l).declareVariables(n,i,o),"\n  ").concat(e.mainStart([c,c,1]),"\n    // x holds the N and y holds the M\n    let headIdx = workgroup_id.z;\n    let m = workgroup_id.y * TILE_SIZE;\n    let n = workgroup_id.x * TILE_SIZE;\n    let lm = m + local_id.y;\n    let ln = n + local_id.x;\n\n    let qOffset = uniforms.M * uniforms.K * headIdx + m * uniforms.K;\n    let kOffset = uniforms.kv_sequence_length * uniforms.K * headIdx + n * uniforms.K;\n\n    var value = ").concat(Je(s,u),";\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m + local_id.y < uniforms.M && w + local_id.x < uniforms.K) {\n        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {\n        tileK[TILE_SIZE * local_id.y + local_id.x] = key[kOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      workgroupBarrier();\n\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = headIdx * uniforms.M * uniforms.N;\n    if (lm < uniforms.M && ln < uniforms.N) {\n      let outputIdx = headOffset + lm * uniforms.N + ln;\n      output[outputIdx] = ").concat(at("value",u)," * uniforms.alpha;\n    }\n  }");}},{inputs:p,outputs:[-1]})[0];return nc(e,y,i.batchSize*i.numHeads*i.sequenceLength,i.totalSequenceLength),y;},ic=function ic(e,t,r,n){var i=[n.batchSize,n.sequenceLength,n.vHiddenSize],o=12,a={x:Math.ceil(n.vHeadSize/o),y:Math.ceil(n.sequenceLength/o),z:n.batchSize*n.numHeads},s=[{type:"uint32",data:n.sequenceLength},{type:"uint32",data:n.totalSequenceLength},{type:"uint32",data:n.vHeadSize},{type:"uint32",data:n.numHeads},{type:"uint32",data:n.vHiddenSize}];return e.compute({name:"AttentionScore",shaderCache:{inputDependencies:["type","type"]},getRunData:function getRunData(){return{outputs:[{dims:i,dataType:t.dataType,gpuDataType:0}],dispatchGroup:a,programUniforms:s};},getShaderSource:function getShaderSource(e){var n=U("probs",t.dataType,t.dims),a=U("v",r.dataType,r.dims),s=ort_webgpu_min_j("output",t.dataType,i);return"\n  const TILE_SIZE = 12u;\n  var<workgroup> tileQ: array<".concat(n.type.value,", 144>;\n  var<workgroup> tileK: array<").concat(n.type.value,", 144>;\n  ").concat(e.registerUniforms([{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"v_hidden_size",type:"u32"}]).declareVariables(n,a,s),"\n  ").concat(e.mainStart([o,o,1]),"\n   let headIdx = workgroup_id.z;\n   let m = workgroup_id.y * TILE_SIZE + local_id.y;\n   let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n   let offsetA = headIdx * (uniforms.M * uniforms.K) + m * uniforms.K;\n   let offsetB = headIdx * (uniforms.N * uniforms.K) + n;\n\n   var value = ").concat(n.type.storage,"(0);\n   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n     if (m < uniforms.M && w + local_id.x < uniforms.K) {\n       tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];\n     }\n     if (n < uniforms.N && w + local_id.y < uniforms.K) {\n       tileK[TILE_SIZE * local_id.y + local_id.x] = v[offsetB + (w + local_id.y) * uniforms.N];\n     }\n     workgroupBarrier();\n     for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n       value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * k + local_id.x];\n     }\n     workgroupBarrier();\n   }\n\n   // we need to transpose output from BNSH_v to BSND_v\n   let batchIdx = workgroup_id.z / uniforms.num_heads;\n   let currentBatchHeadNumber = workgroup_id.z % uniforms.num_heads;\n   let headOffset = (batchIdx * uniforms.M * uniforms.num_heads + currentBatchHeadNumber) * uniforms.N;\n   if (m < uniforms.M && n < uniforms.N) {\n     let outputIdx = batchIdx * uniforms.M *uniforms.v_hidden_size + m * uniforms.v_hidden_size\n       + currentBatchHeadNumber * uniforms.N + n;\n     output[outputIdx] = value;\n   }\n  }");}},{inputs:[t,r],outputs:[0]})[0];},Sn=function Sn(e,t,r,n,i,o,a,s,u,l,c){var h=ac(e,t,r,u,l,c);ic(e,h,n,l);},oc=function oc(e,t){var r=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],n=t.sequenceLength,i=t.inputHiddenSize,o=t.headSize,a=12,s={x:Math.ceil(t.headSize/a),y:Math.ceil(t.sequenceLength/a),z:t.batchSize*t.numHeads},u=[e.inputs[0],e.inputs[1],e.inputs[2]],l=[{type:"uint32",data:n},{type:"uint32",data:i},{type:"uint32",data:o},{type:"uint32",data:t.numHeads},{type:"uint32",data:t.headSize},{type:"uint32",data:t.hiddenSize},{type:"uint32",data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}];return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:function getRunData(){return{outputs:[{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:s,programUniforms:l};},getShaderSource:function getShaderSource(e){var t=ort_webgpu_min_j("output_q",u[0].dataType,r),n=ort_webgpu_min_j("output_k",u[0].dataType,r),i=ort_webgpu_min_j("output_v",u[0].dataType,r),o=U("input",u[0].dataType,u[0].dims),s=U("weight",u[1].dataType,u[1].dims),l=U("bias",u[2].dataType,u[2].dims),c=o.type.storage;return"\n  const TILE_SIZE = 12u;\n  var<workgroup> tileInput: array<".concat(c,", 144>;\n  var<workgroup> tileWeightQ: array<").concat(c,", 144>;\n  var<workgroup> tileWeightK: array<").concat(c,", 144>;\n  var<workgroup> tileWeightV: array<").concat(c,", 144>;\n  ").concat(e.registerUniforms([{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}]).declareVariables(o,s,l,t,n,i),"\n  ").concat(e.mainStart([a,a,1]),"\n    let batchIndex = workgroup_id.z / uniforms.num_heads;\n    let headNumber = workgroup_id.z % uniforms.num_heads;\n    let m = workgroup_id.y * TILE_SIZE + local_id.y;\n    let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;\n    let biasOffsetQ = headNumber * uniforms.head_size;\n    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;\n    let biasOffsetV = uniforms.hidden_size + biasOffsetK;\n\n    var valueQ = ").concat(c,"(0);\n    var valueK = ").concat(c,"(0);\n    var valueV = ").concat(c,"(0);\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m < uniforms.M && w + local_id.x < uniforms.K) {\n        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];\n      }\n      if (n < uniforms.N && w + local_id.y < uniforms.K) {\n        let offset = n + (w + local_id.y) * uniforms.ldb;\n        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];\n        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];\n        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];\n      }\n      workgroupBarrier();\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        let inputTileOffset = TILE_SIZE * local_id.y + k;\n        let weightTileOffset = TILE_SIZE * k + local_id.x;\n        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];\n        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];\n        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = (m * uniforms.N + n) % uniforms.head_size;\n    valueQ += bias[headOffset + biasOffsetQ];\n    valueK += bias[headOffset + biasOffsetK];\n    valueV += bias[headOffset + biasOffsetV];\n\n    let offset = workgroup_id.z * uniforms.M * uniforms.N;\n    if (m < uniforms.M && n < uniforms.N) {\n      let outputIdx = offset + m * uniforms.N + n;\n      output_q[outputIdx] = valueQ;\n      output_k[outputIdx] = valueK;\n      output_v[outputIdx] = valueV;\n    }\n  }");}},{inputs:u,outputs:[-1,-1,-1]});},Wo=function Wo(e,t){var r=rc(e.inputs,t),_oc5=oc(e,r),_oc6=_slicedToArray2(_oc5,3),n=_oc6[0],i=_oc6[1],o=_oc6[2];return Sn(e,n,i,o,e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t);};}),sc,uc,lc,Go,Ho=q(function(){dt(),$e(),qe(),we(),sc=function sc(e,t){if(!e||5!==e.length)throw new Error("BatchNormalization requires 5 inputs");var r=function r(e,t,_r297){var n=t.length;if(n!==e.length)throw new Error("".concat(_r297,": num dimensions != ").concat(n));t.forEach(function(t,n){if(t!==e[n])throw new Error("".concat(_r297,": dim[").concat(n,"] do not match"));});};if(e[0].dims.length>1){var n="NHWC"===t.format?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);r(e[1].dims,n,"Invalid input scale"),r(e[2].dims,n,"Invalid input B"),r(e[3].dims,n,"Invalid input mean"),r(e[4].dims,n,"Invalid input var");}else r(e[1].dims,[1],"Invalid input scale"),r(e[2].dims,[1],"Invalid input B"),r(e[3].dims,[1],"Invalid input mean"),r(e[4].dims,[1],"Invalid input var");},uc=function uc(e,t){var r=t.epsilon,n=t.spatial,i=t.format,o=e[0].dims,a=n?Fe(o[o.length-1]):1,s="NHWC"===i&&o.length>1?a:1,u=ort_webgpu_min_N.size(o)/a,l=De(o.length)&&n,c=l?o.length:o,h=U("x",e[0].dataType,e[0].dims,a),f=U("scale",e[1].dataType,e[1].dims,s),d=U("bias",e[2].dataType,e[2].dims,s),p=U("inputMean",e[3].dataType,e[3].dims,s),y=U("inputVar",e[4].dataType,e[4].dims,s),m=ort_webgpu_min_j("y",e[0].dataType,c,a);return{name:"BatchNormalization",shaderCache:{hint:"".concat(t.epsilon,"_").concat(t.format,"_").concat(n,"_").concat(a),inputDependencies:l?["rank","type","type","type","type"]:void 0},getShaderSource:function getShaderSource(e){return"\n  const epsilon = ".concat(r,";\n  ").concat(e.registerUniform("outputSize","u32").declareVariables(h,f,d,p,y,m),"\n  ").concat(e.mainStart(),"\n  ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n    var outputIndices = ").concat(m.offsetToIndices("global_idx * ".concat(a)),";\n    ").concat(function(){var e="";if(n)e="let cOffset = ".concat(1===o.length?"0u":"NHWC"===i?"outputIndices[".concat(o.length-1,"] / ").concat(a):"outputIndices[1]",";");else if("NCHW"===i)e="\n            ".concat(m.indicesSet("outputIndices","0","0"),"\n            let cOffset = ").concat(m.indicesToOffset("outputIndices"),";");else{e="var cIndices = ".concat(f.type.indices,"(0);\n                       cIndices[0] = outputIndices[").concat(o.length-1,"];");for(var _t374=1;_t374<f.rank;_t374++)e+="cIndices[".concat(_t374,"] = outputIndices[").concat(_t374,"];");e+="let cOffset = ".concat(f.indicesToOffset("cIndices"),";");}return e;}(),"\n    let scale = ").concat(f.getByOffset("cOffset"),";\n    let bias = ").concat(d.getByOffset("cOffset"),";\n    let inputMean = ").concat(p.getByOffset("cOffset"),";\n    let inputVar = ").concat(y.getByOffset("cOffset"),";\n    let x = ").concat(h.getByOffset("global_idx"),";\n    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;\n    ").concat(m.setByOffset("global_idx","value"),"\n  }");},getRunData:function getRunData(){return{outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:l?[{type:"uint32",data:u}].concat(_toConsumableArray2(F(o))):[{type:"uint32",data:u}]};}};},lc=function lc(e){return ge(e);},Go=function Go(e,t){var r=e.inputs,n=e.outputCount,i=lc(_objectSpread(_objectSpread({},t),{},{outputCount:n}));if(Se.webgpu.validateInputContent&&sc(r,i),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(uc(r,i));};}),dc,cc,Lo,Fo=q(function(){$e(),we(),dc=function dc(e){if(3!==e[0].dims.length)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(1!==e[1].dims.length)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same");},cc=function cc(e){var t=e[0].dims,r=e[0].dims[2],n=ort_webgpu_min_N.size(t)/4,i=e[0].dataType,o=U("input",i,t,4),a=U("bias",i,[r],4),s=U("residual",i,t,4),u=ort_webgpu_min_j("output",i,t,4);return{name:"BiasAdd",getRunData:function getRunData(){return{outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(n/64)}};},getShaderSource:function getShaderSource(e){return"\n  const channels = ".concat(r,"u / 4;\n  ").concat(e.declareVariables(o,a,s,u),"\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes(n),"\n    let value = ").concat(o.getByOffset("global_idx"),"\n      + ").concat(a.getByOffset("global_idx % channels")," + ").concat(s.getByOffset("global_idx"),";\n    ").concat(u.setByOffset("global_idx","value"),"\n  }");}};},Lo=function Lo(e){dc(e.inputs),e.compute(cc(e.inputs));};}),pc,Ee,qo,jo,Ko,Yo,Zo,Xo,Jo,Qo,es,mc,ts,rs,ns,as,In,is,Cn,os,ss,us,ls,ds,cs,ps,ms,fs,hs,gs,ys,bs,ws,vs,$s,_s,Ca=q(function(){Ne(),$e(),qe(),we(),pc=function pc(e,t,r,n,i,o){var a=Math.ceil(t/4),s="";s="string"==typeof i?"".concat(i,"(a)"):i("a");var u=U("inputData",r,[a],4),l=ort_webgpu_min_j("outputData",n,[a],4);return"\n      ".concat(e.registerUniform("vec_size","u32").declareVariables(u,l),"\n\n  ").concat(o!==null&&o!==void 0?o:"","\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size"),"\n\n    let a = ").concat(u.getByOffset("global_idx"),";\n    ").concat(l.setByOffset("global_idx",s),"\n  }");},Ee=function Ee(e,t,r,n,i){var o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:e.dataType;return{name:t,shaderCache:{hint:i,inputDependencies:["type"]},getShaderSource:function getShaderSource(t){return pc(t,ort_webgpu_min_N.size(e.dims),e.dataType,o,r,n);},getRunData:function getRunData(t){return{outputs:[{dims:e.dims,dataType:o}],dispatchGroup:{x:Math.ceil(ort_webgpu_min_N.size(t[0].dims)/64/4)},programUniforms:[{type:"uint32",data:Math.ceil(ort_webgpu_min_N.size(e.dims)/4)}]};}};},qo=function qo(e){e.compute(Ee(e.inputs[0],"Abs","abs"));},jo=function jo(e){e.compute(Ee(e.inputs[0],"Acos","acos"));},Ko=function Ko(e){e.compute(Ee(e.inputs[0],"Acosh","acosh"));},Yo=function Yo(e){e.compute(Ee(e.inputs[0],"Asin","asin"));},Zo=function Zo(e){e.compute(Ee(e.inputs[0],"Asinh","asinh"));},Xo=function Xo(e){e.compute(Ee(e.inputs[0],"Atan","atan"));},Jo=function Jo(e){e.compute(Ee(e.inputs[0],"Atanh","atanh"));},Qo=function Qo(e){return ge(e);},es=function es(e,t){var r;switch(t.to){case 10:r="vec4<f16>";break;case 1:r="vec4<f32>";break;case 12:r="vec4<u32>";break;case 6:r="vec4<i32>";break;case 9:r="vec4<bool>";break;default:throw new RangeError("not supported type (specified in attribute 'to' from 'Cast' operator): ".concat(t.to));}e.compute(Ee(e.inputs[0],"Cast",r,void 0,t.cacheKey,t.to));},mc=function mc(e){var t=e.length>=2&&0!==e[1].data?e[1].getFloat32Array()[0]:wn,r=e.length>=3&&0!==e[2].data?e[2].getFloat32Array()[0]:vn;return ge({min:t,max:r});},ts=function ts(e,t){var r=1===e.inputs.length?t:mc(e.inputs),n=yt(e.inputs[0].dataType);e.compute(Ee(e.inputs[0],"Clip",function(e){return"clamp(".concat(e,", clip_min_, clip_max_)");},"\n    const clip_min_: vec4<".concat(n,"> = vec4(").concat(n,"(").concat(r.min,"));\n    const clip_max_: vec4<").concat(n,"> = vec4(").concat(n,"(").concat(r.max,"));\n"),r.cacheKey),{inputs:[0]});},rs=function rs(e){e.compute(Ee(e.inputs[0],"Ceil","ceil"));},ns=function ns(e){e.compute(Ee(e.inputs[0],"Cos","cos"));},as=function as(e){e.compute(Ee(e.inputs[0],"Cosh","cosh"));},In=function In(e){return ge(e);},is=function is(e,t){var r=yt(e.inputs[0].dataType);e.compute(Ee(e.inputs[0],"Elu",function(e){return"elu_vf32(".concat(e,")");},"\n  const elu_alpha_ = ".concat(r,"(").concat(t.alpha,");\n\n  fn elu_f32(a: ").concat(r,") -> ").concat(r," {\n  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);\n  }\n\n  fn elu_vf32(v: vec4<").concat(r,">) -> vec4<").concat(r,"> {\n  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));\n  }"),t.cacheKey));},Cn=function Cn(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"f32";return"\nconst r0: ".concat(t," = 0.3275911;\nconst r1: ").concat(t," = 0.254829592;\nconst r2: ").concat(t," = -0.284496736;\nconst r3: ").concat(t," = 1.421413741;\nconst r4: ").concat(t," = -1.453152027;\nconst r5: ").concat(t," = 1.061405429;\n\nfn erf_vf32(v: ").concat(e,") -> ").concat(e," {\n  let absv = abs(v);\n  let x = 1.0 / (1.0 + r0 * absv);\n  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));\n}");},os=function os(e){var t=yt(e.inputs[0].dataType);e.compute(Ee(e.inputs[0],"Erf",function(e){return"erf_vf32(".concat(e,")");},Cn("vec4<".concat(t,">"),t)));},ss=function ss(e){e.compute(Ee(e.inputs[0],"Exp","exp"));},us=function us(e){e.compute(Ee(e.inputs[0],"Floor","floor"));},ls=function ls(e){var t=yt(e.inputs[0].dataType);e.compute(Ee(e.inputs[0],"Gelu",function(e){return"0.5 * ".concat(e," * (1.0 + erf_vf32(").concat(e," * 0.7071067811865475))");},Cn("vec4<".concat(t,">"),t)));},ds=function ds(e,t){var r=yt(e.inputs[0].dataType);e.compute(Ee(e.inputs[0],"LeakyRelu",function(e){return"select(leaky_relu_alpha_ * ".concat(e,", ").concat(e,", ").concat(e," >= vec4<").concat(r,">(0.0))");},"const leaky_relu_alpha_ = ".concat(r,"(").concat(t.alpha,");"),t.cacheKey));},cs=function cs(e){e.compute(Ee(e.inputs[0],"Not",function(e){return"!".concat(e);}));},ps=function ps(e){e.compute(Ee(e.inputs[0],"Neg",function(e){return"-".concat(e);}));},ms=function ms(e){e.compute(Ee(e.inputs[0],"Reciprocal",function(e){return"1.0/".concat(e);}));},fs=function fs(e){var t=yt(e.inputs[0].dataType);e.compute(Ee(e.inputs[0],"Relu",function(e){return"select(vec4<".concat(t,">(0.0), ").concat(e,", ").concat(e," > vec4<").concat(t,">(0.0))");}));},hs=function hs(e){e.compute(Ee(e.inputs[0],"Sigmoid",function(e){return"(1.0 / (1.0 + exp(-".concat(e,")))");}));},gs=function gs(e){e.compute(Ee(e.inputs[0],"Sin","sin"));},ys=function ys(e){e.compute(Ee(e.inputs[0],"Sinh","sinh"));},bs=function bs(e){e.compute(Ee(e.inputs[0],"Sqrt","sqrt"));},ws=function ws(e){e.compute(Ee(e.inputs[0],"Tan","tan"));},vs=function vs(e){e.compute(Ee(e.inputs[0],"Tanh","tanh"));},$s=function $s(e,t){var r=yt(e.inputs[0].dataType);return e.compute(Ee(e.inputs[0],"ThresholdedRelu",function(e){return"select(vec4<".concat(r,">(0.0), ").concat(e,", ").concat(e," > thresholded_relu_alpha_)");},"const thresholded_relu_alpha_ = vec4<".concat(r,">(").concat(t.alpha,");"),t.cacheKey)),0;},_s=function _s(e){e.compute(Ee(e.inputs[0],"Log","log"));};}),hc,gc,xs,Ss=q(function(){$e(),we(),Ca(),hc=function hc(e){if(3!==e[0].dims.length)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(1!==e[1].dims.length)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same");},gc=function gc(e){var t=e[0].dims.slice();t[2]=t[2]/2;var r=U("input",e[0].dataType,e[0].dims,4),n=U("bias",e[0].dataType,[e[0].dims[2]],4),i=ort_webgpu_min_j("output",e[0].dataType,t,4),o=ort_webgpu_min_N.size(t)/4,a=Le(e[0].dataType);return{name:"BiasSplitGelu",getRunData:function getRunData(){return{outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)}};},getShaderSource:function getShaderSource(t){return"\n  const M_SQRT2 = sqrt(2.0);\n  const halfChannels = ".concat(e[0].dims[2]/4/2,"u;\n\n  ").concat(t.declareVariables(r,n,i),"\n\n  ").concat(Cn("vec4<".concat(a,">"),a),"\n\n  ").concat(t.mainStart(),"\n    ").concat(t.guardAgainstOutOfBoundsWorkgroupSizes(o),"\n    let biasIdx = global_idx % halfChannels;\n    let batchIndex = global_idx / halfChannels;\n    let inputOffset = biasIdx + batchIndex * halfChannels * 2;\n    let valueLeft = input[inputOffset] + bias[biasIdx];\n    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];\n    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);\n\n    ").concat(i.setByOffset("global_idx","valueLeft * geluRight"),"\n  }");}};},xs=function xs(e){hc(e.inputs),e.compute(gc(e.inputs));};}),yc,bc,_t,Is,Cs,As,Ts,Es,Os,ks,Bs,Ps,Rs,Ds=q(function(){Ne(),$e(),we(),yc=function yc(e,t,r,n,i,o,a,s,u,l,c,h,f){var d,p;"string"==typeof s?d=p=function p(e,t){return"".concat(s,"((").concat(e,"),(").concat(t,"))");}:"function"==typeof s?d=p=s:(d=s.scalar,p=s.vector);var y,m=h?t.length:t,g=h?r.length:r,w=h?n.length:n,b=ort_webgpu_min_j("outputData",c,w,4),v=U("aData",u,m,4),x=U("bData",l,g,4);if(i){if(o){var _e892=1===ort_webgpu_min_N.size(t),_n204=1===ort_webgpu_min_N.size(r),_i155=t.length>0&&t[t.length-1]%4==0,_o116=r.length>0&&r[r.length-1]%4==0;y=_e892||_n204?b.setByOffset("global_idx",p(_e892?"".concat(v.type.value,"(").concat(v.getByOffset("0"),".x)"):v.getByOffset("global_idx"),_n204?"".concat(x.type.value,"(").concat(x.getByOffset("0"),".x)"):x.getByOffset("global_idx"))):"\n            let outputIndices = ".concat(b.offsetToIndices("global_idx * 4u"),";\n            let offsetA = ").concat(v.broadcastedIndicesToOffset("outputIndices",b),";\n            let offsetB = ").concat(x.broadcastedIndicesToOffset("outputIndices",b),";\n            ").concat(b.setByOffset("global_idx",p(a||_i155?v.getByOffset("offsetA / 4u"):"".concat(v.type.value,"(").concat(v.getByOffset("offsetA / 4u"),"[offsetA % 4u])"),a||_o116?x.getByOffset("offsetB / 4u"):"".concat(x.type.value,"(").concat(x.getByOffset("offsetB / 4u"),"[offsetB % 4u])"))),"\n          ");}else y=b.setByOffset("global_idx",p(v.getByOffset("global_idx"),x.getByOffset("global_idx")));}else{if(!o)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");var _e893=function _e893(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";var n="aData[indexA".concat(t,"][componentA").concat(t,"]"),i="bData[indexB".concat(t,"][componentB").concat(t,"]");return"\n            let outputIndices".concat(t," = ").concat(b.offsetToIndices("global_idx * 4u + ".concat(t,"u")),";\n            let offsetA").concat(t," = ").concat(v.broadcastedIndicesToOffset("outputIndices".concat(t),b),";\n            let offsetB").concat(t," = ").concat(x.broadcastedIndicesToOffset("outputIndices".concat(t),b),";\n            let indexA").concat(t," = offsetA").concat(t," / 4u;\n            let indexB").concat(t," = offsetB").concat(t," / 4u;\n            let componentA").concat(t," = offsetA").concat(t," % 4u;\n            let componentB").concat(t," = offsetB").concat(t," % 4u;\n            ").concat(e,"[").concat(t,"] = ").concat(r,"(").concat(d(n,i),");\n          ");};y=9===c?"\n            var data = vec4<u32>(0);\n            ".concat(_e893("data",0,"u32"),"\n            ").concat(_e893("data",1,"u32"),"\n            ").concat(_e893("data",2,"u32"),"\n            ").concat(_e893("data",3,"u32"),"\n            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));"):"\n            ".concat(_e893("outputData[global_idx]",0),"\n            ").concat(_e893("outputData[global_idx]",1),"\n            ").concat(_e893("outputData[global_idx]",2),"\n            ").concat(_e893("outputData[global_idx]",3),"\n          ");}return"\n        ".concat(e.registerUniform("vec_size","u32").declareVariables(v,x,b),"\n\n        ").concat(f!==null&&f!==void 0?f:"","\n\n        ").concat(e.mainStart(),"\n        ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size"),"\n        ").concat(y,"\n      }");},bc=function bc(e,t,r,n,i,o){var a=arguments.length>6&&arguments[6]!==undefined?arguments[6]:r.dataType;var s=!ort_webgpu_min_N.areEqual(r.dims,n.dims),u=r.dims,l=ort_webgpu_min_N.size(r.dims),c=!1,h=!1,f=[s];if(s){var _e894=gt.calcShape(r.dims,n.dims,!1);if(!_e894)throw new Error("Can't perform binary op on the given tensors");u=_e894,l=ort_webgpu_min_N.size(u);var _t375=1===ort_webgpu_min_N.size(r.dims),_i156=1===ort_webgpu_min_N.size(n.dims),_o117=r.dims.length>0&&r.dims[r.dims.length-1]%4==0,_a89=n.dims.length>0&&n.dims[n.dims.length-1]%4==0;f.push(_t375),f.push(_i156),f.push(_o117),f.push(_a89);var _s65=1;for(var _e895=1;_e895<u.length;_e895++){var _r$dims,_n$dims;var _t376=(_r$dims=r.dims[r.dims.length-_e895])!==null&&_r$dims!==void 0?_r$dims:1;if(_t376!==((_n$dims=n.dims[n.dims.length-_e895])!==null&&_n$dims!==void 0?_n$dims:1))break;_s65*=_t376;}_s65%4==0?(h=!0,c=!0):(_t375||_i156||_o117||_a89)&&(c=!0);}else c=!0;f.push(c);var d=De(r.dims.length)&&De(n.dims.length)&&De(u.length);return{name:e,shaderCache:{hint:t+f.map(function(e){return e.toString();}).join("_"),inputDependencies:d?["rank","rank"]:["dims","dims"]},getShaderSource:function getShaderSource(e){return yc(e,r.dims,n.dims,u,c,s,h,i,r.dataType,n.dataType,a,d,o);},getRunData:function getRunData(){return{outputs:[{dims:u,dataType:a}],dispatchGroup:{x:Math.ceil(l/64/4)},programUniforms:d?[{type:"uint32",data:Math.ceil(ort_webgpu_min_N.size(u)/4)}].concat(_toConsumableArray2(F(r.dims)),_toConsumableArray2(F(n.dims)),_toConsumableArray2(F(u))):[{type:"uint32",data:Math.ceil(ort_webgpu_min_N.size(u)/4)}]};}};},_t=function _t(e,t,r,n,i,o){e.compute(bc(t,i!==null&&i!==void 0?i:"",e.inputs[0],e.inputs[1],r,n,o));},Is=function Is(e){_t(e,"Add",function(e,t){return"".concat(e,"+").concat(t);});},Cs=function Cs(e){_t(e,"Div",function(e,t){return"".concat(e,"/").concat(t);});},As=function As(e){_t(e,"Equal",{scalar:function scalar(e,t){return"u32(".concat(e,"==").concat(t,")");},vector:function vector(e,t){return"vec4<u32>(".concat(e,"==").concat(t,")");}},void 0,void 0,9);},Ts=function Ts(e){_t(e,"Mul",function(e,t){return"".concat(e,"*").concat(t);});},Es=function Es(e){var t=U("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;_t(e,"Pow",{scalar:function scalar(e,t){return"pow_custom(".concat(e,",").concat(t,")");},vector:function vector(e,t){return"pow_vector_custom(".concat(e,",").concat(t,")");}},"\n    fn pow_custom(a : ".concat(t,", b : ").concat(t,") -> ").concat(t," {\n      if (b == ").concat(t,"(0.0)) {\n        return ").concat(t,"(1.0);\n      } else if (a < ").concat(t,"(0.0) && f32(b) != floor(f32(b))) {\n        return ").concat(t,"(pow(f32(a), f32(b))); // NaN\n      }\n      return select(sign(a), ").concat(t,"(1.0), round(f32(abs(b) % ").concat(t,"(2.0))) != 1.0) * ").concat(t,"(").concat("i32"===t?"round":"","(pow(f32(abs(a)), f32(b))));\n    }\n    fn pow_vector_custom(a : vec4<").concat(t,">, b : vec4<").concat(t,">) -> vec4<").concat(t,"> {\n      // TODO: implement vectorized pow\n      return vec4<").concat(t,">(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));\n    }\n      "));},Os=function Os(e){_t(e,"Sub",function(e,t){return"".concat(e,"-").concat(t);});},ks=function ks(e){_t(e,"Greater",{scalar:function scalar(e,t){return"u32(".concat(e,">").concat(t,")");},vector:function vector(e,t){return"vec4<u32>(".concat(e,">").concat(t,")");}},void 0,void 0,9);},Bs=function Bs(e){_t(e,"Less",{scalar:function scalar(e,t){return"u32(".concat(e,"<").concat(t,")");},vector:function vector(e,t){return"vec4<u32>(".concat(e,"<").concat(t,")");}},void 0,void 0,9);},Ps=function Ps(e){_t(e,"GreaterOrEqual",{scalar:function scalar(e,t){return"u32(".concat(e,">=").concat(t,")");},vector:function vector(e,t){return"vec4<u32>(".concat(e,">=").concat(t,")");}},void 0,void 0,9);},Rs=function Rs(e){_t(e,"LessOrEqual",{scalar:function scalar(e,t){return"u32(".concat(e,"<=").concat(t,")");},vector:function vector(e,t){return"vec4<u32>(".concat(e,"<=").concat(t,")");}},void 0,void 0,9);};}),vc,$c,_c,xc,Ms,Us,zs=q(function(){$e(),qe(),we(),vc=function vc(e){if(!e||e.length<1)throw new Error("too few inputs");var t=e[0].dataType,r=e[0].dims.length;var _iterator69=_createForOfIteratorHelper2(e),_step69;try{for(_iterator69.s();!(_step69=_iterator69.n()).done;){var n=_step69.value;if(n.dataType!==t)throw new Error("input tensors should be one type");if(n.dims.length!==r)throw new Error("input tensors should have the same shape");}}catch(err){_iterator69.e(err);}finally{_iterator69.f();}},$c=function $c(e,t){return"\n  fn calculateInputIndex(index: u32) -> u32 {\n    let sizeInConcatAxis = array<u32, ".concat(e,"u>(").concat(t,");\n    for (var i: u32 = 0u; i < ").concat(e,"; i += 1u ) {\n      if (index < sizeInConcatAxis[i]) {\n        return i;\n      }\n    }\n    return ").concat(e,"u;\n  }");},_c=function _c(e,t){var r=e.length,n=[];for(var i=0;i<r;++i){var _o118=t.setByOffset("global_idx",e[i].getByIndices("indices"));1===r?n.push(_o118):0===i?n.push("if (inputIndex == ".concat(i,"u) { ").concat(_o118," }")):i===r-1?n.push("else { ".concat(_o118," }")):n.push("else if (inputIndex == ".concat(i,") { ").concat(_o118," }"));}return n.join("\n");},xc=function xc(e,t){var r=e[0].dims.slice();if(t>=r.length||t<-1*r.length)throw new Error("axis specified for concat doesn't match input dimensionality");var n=t<0?r.length+t:t,i=r.slice(0);for(var _t377=1;_t377<e.length;_t377++){var _o119=e[_t377].dims.slice();for(var _e896=0;_e896<r.length;_e896++)if(_e896===n)i[n]+=_o119[_e896];else if(r[_e896]!==_o119[_e896])throw new Error("non concat dimensions must match");}var o=ort_webgpu_min_N.size(i),a=new Array(e.length),s=new Array(e.length),u=e[0].dataType,l=0,c=[],h=[],f=[],d=[{type:"uint32",data:o}];for(var _t378=0;_t378<e.length;++_t378)l+=e[_t378].dims[n],a[_t378]=l,f.push(De(e[_t378].dims.length)),h.push(f[_t378]?e[_t378].dims.length:e[_t378].dims),s[_t378]=U("input".concat(_t378),u,h[_t378]),c.push(f[_t378]?"rank":"dims"),d.push({type:"uint32",data:a[_t378]});for(var _t379=0;_t379<e.length;++_t379)f[_t379]&&d.push.apply(d,_toConsumableArray2(F(e[_t379].dims)));var p=De(i.length);p&&d.push.apply(d,_toConsumableArray2(F(i)));var y=p?i.length:i,m=ort_webgpu_min_j("output",u,y),g=m.indicesGet("indices",n),w=Array.from(Array(a.length).keys()).map(function(e){return"uniforms.sizeInConcatAxis".concat(e);}).join(",");return{name:"Concat",shaderCache:{hint:"".concat(t),inputDependencies:c},getRunData:function getRunData(){return{outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:d};},getShaderSource:function getShaderSource(t){return"\n\n  ".concat(function(){t.registerUniform("outputSize","u32");for(var _r298=0;_r298<e.length;_r298++)t.registerUniform("sizeInConcatAxis".concat(_r298),"u32");return t.declareVariables.apply(t,s.concat([m]));}(),"\n\n  ").concat($c(a.length,w),"\n\n  ").concat(t.mainStart(),"\n    ").concat(t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n\n    var indices = ").concat(m.offsetToIndices("global_idx"),";\n\n    let inputIndex = calculateInputIndex(").concat(g,");\n    if (inputIndex != 0u) {\n      let sizeInConcatAxis = array<u32, ").concat(a.length,"u>(").concat(w,");\n      ").concat(g," -= sizeInConcatAxis[inputIndex - 1u];\n    }\n\n    ").concat(_c(s,m),"\n  }");}};},Ms=function Ms(e,t){vc(e.inputs),e.compute(xc(e.inputs,t.axis));},Us=function Us(e){return ge({axis:e.axis});};}),xt,An,Mt=q(function(){$e(),xt=function xt(e,t){switch(e.activation){case"Relu":return{activationFunction:"",applyActivation:"value = max(value, ".concat(t,"(0.0));")};case"Sigmoid":return{activationFunction:"",applyActivation:"value = (".concat(t,"(1.0) / (").concat(t,"(1.0) + exp(-value)));")};case"Clip":return{activationFunction:"const clip_min_=".concat(t,"(").concat(e.clipMin,");const clip_max_=").concat(t,"(").concat(e.clipMax,");"),applyActivation:"value = clamp(value, clip_min_, clip_max_);"};default:return{activationFunction:"",applyActivation:""};}},An=function An(e){var t=(e===null||e===void 0?void 0:e.activation)||"";if("Clip"===t){var _ref81=(e===null||e===void 0?void 0:e.activation_params)||[wn,vn],_ref82=_slicedToArray2(_ref81,2),r=_ref82[0],n=_ref82[1];return{activation:t,clipMax:n,clipMin:r,activationCacheKey:"".concat(t,":").concat(r,",").concat(n)};}return{activation:t,activationCacheKey:t};};}),Ke,Tn,En=q(function(){Ke=function Ke(e,t){switch(e){case 1:return t;case 2:return"vec2<".concat(t,">");case 3:return"vec3<".concat(t,">");case 4:return"vec4<".concat(t,">");default:throw new Error("".concat(e,"-component is not supported."));}},Tn=function Tn(e){return"\n      ".concat(e?"value = value + getBiasByOutputCoords(coords);":"","\n      ");};}),On,Aa=q(function(){On=function On(e){return"\nfn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));\n}\nfn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n    i32(".concat(e,".x), i32(").concat(e,".y), i32(").concat(e,".z), 1));\n}\n");};}),Sc,Ic,Dr,Ns,Cc,Mr,Ac,kn,Ur=q(function(){$e(),we(),Mt(),En(),Sc=function Sc(e,t){return e?"\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          kStart + inputRow,\n          globalRowStart / innerElementSize + inputCol".concat(t?", batchIndices":"",");\n        "):"\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          globalRow + innerRow,\n          kStart / innerElementSize + inputCol".concat(t?", batchIndices":"",");\n        ");},Ic=function Ic(e,t){return e?"\n        let ACached0 = mm_Asub[k * innerElementSize][localRow];\n        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];\n        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];\n        ".concat(3===t?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];","\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          acc[i] = BCached0 * ACached0[i] + acc[i];\n          acc[i] = BCached1 * ACached1[i] + acc[i];\n          acc[i] = BCached2 * ACached2[i] + acc[i];\n          ").concat(3===t?"":"acc[i] = BCached3 * ACached3[i] + acc[i];","\n        }"):"\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          let ACached = mm_Asub[tileRow + i][k];\n          acc[i] = BCached0 * ACached.x + acc[i];\n          acc[i] = BCached1 * ACached.y + acc[i];\n          acc[i] = BCached2 * ACached.z + acc[i];\n          ".concat(3===t?"":"acc[i] = BCached3 * ACached.w + acc[i];","\n        }");},Dr=function Dr(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"f32";var n=arguments.length>3?arguments[3]:undefined;var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!1;var o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:32;var a=arguments.length>6&&arguments[6]!==undefined?arguments[6]:!1;var s=arguments.length>7&&arguments[7]!==undefined?arguments[7]:32;var u=t[1]*e[1],l=t[0]*e[0],c=i?u:o,h=i?o:u,f=c/t[0],d=o/t[1];if((!i||4!==f||4!==e[1])&&(i||3!==f&&4!==f)||c%t[0]!=0||o%t[1]!=0||4!==e[0])throw new Error("If transposeA ".concat(i," is true, innerElementSize ").concat(f," and workPerThread[1] ").concat(e[1]," must be 4.\n      Otherwise, innerElementSize ").concat(f," must be 3 or 4.\n  tileAWidth ").concat(c," must be divisible by workgroupSize[0]").concat(t[0],". tileInner ").concat(o," must be divisible by workgroupSize[1] ").concat(t[1],". colPerThread ").concat(e[0]," must be 4."));return"\nvar<workgroup> mm_Asub: array<array<vec".concat(f,"<").concat(r,">, ").concat(c/f,">, ").concat(h,">;\nvar<workgroup> mm_Bsub: array<array<vec4<").concat(r,">, ").concat(l/e[0],">, ").concat(o,">;\n\nconst rowPerThread = ").concat(e[1],";\nconst colPerThread = ").concat(e[0],";\nconst innerElementSize = ").concat(f,";\nconst tileInner = ").concat(o,";\n\n@compute @workgroup_size(").concat(t[0],", ").concat(t[1],", ").concat(t[2],")\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n  let localRow = i32(localId.y);\n  let tileRow = localRow * rowPerThread;\n  let tileCol = i32(localId.x);\n\n  let globalRow =i32(globalId.y) * rowPerThread;\n  let globalCol = i32(globalId.x);\n  let batch = ").concat(a?"0":"i32(globalId.z)",";\n  ").concat(n?"let batchIndices = ".concat(n.offsetToIndices("u32(batch)"),";"):"","\n  let globalRowStart = i32(workgroupId.y) * ").concat(u,";\n\n  let numTiles = ").concat(a?"".concat(Math.ceil(s/o)):"(uniforms.dimInner - 1) / tileInner + 1",";\n  var kStart = ").concat(a?"i32(globalId.z) * ".concat(s):"0",";\n\n  var acc: array<vec4<").concat(r,">, rowPerThread>;\n\n  // Loop over shared dimension.\n  let tileRowB = localRow * ").concat(d,";\n  for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let inputRow = tileRow + innerRow;\n          let inputCol = tileCol;\n          ").concat(Sc(i,n),"\n      }\n\n      // Load one tile of B into local memory.\n      for (var innerRow = 0; innerRow < ").concat(d,"; innerRow = innerRow + 1) {\n          let inputRow = tileRowB + innerRow;\n          let inputCol = tileCol;\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol").concat(n?", batchIndices":"",");\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {\n          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];\n          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];\n          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];\n          ").concat(3===f?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];","\n\n          ").concat(Ic(i,f),"\n      }\n\n      workgroupBarrier();\n  }\n\n  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);\n  }\n}");},Ns=function Ns(e,t){return e?"\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              kStart + inputRow,\n              globalRowStart + inputCol".concat(t?", batchIndices":"",");\n            "):"\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              globalRowStart + inputRow,\n              kStart + inputCol".concat(t?", batchIndices":"",");\n            ");},Cc=function Cc(e){return e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];";},Mr=function Mr(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"f32";var n=arguments.length>3?arguments[3]:undefined;var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!1;var o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:32;var a=arguments.length>6&&arguments[6]!==undefined?arguments[6]:!1;var s=arguments.length>7&&arguments[7]!==undefined?arguments[7]:32;var u=arguments.length>8&&arguments[8]!==undefined?arguments[8]:!1;var l=e[1]*t[1],c=e[0]*t[0],h=i?l:o,f=i?o:l;if(f%t[1]!=0||h%t[0]!=0||o%t[1]!=0)throw new Error("tileAHight ".concat(f," must be divisible by workgroupSize[1]").concat(t[1],", tileAWidth ").concat(h," must be divisible by workgroupSize[0]").concat(t[0],", tileInner ").concat(o," must be divisible by workgroupSize[1]").concat(t[1]));var d=f/t[1],p=h/t[0],y=o/t[1],m=u?"\n    let localRow = i32(localId.y);\n    let localCol = i32(localId.x);\n    let globalRowStart = i32(workgroupId.y) * ".concat(l,";\n    let globalColStart = i32(workgroupId.x) * ").concat(c,";\n\n    // Loop over shared dimension.\n    for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var inputRow = localRow; inputRow < ").concat(f,"; inputRow = inputRow + ").concat(t[1],") {\n        for (var inputCol = localCol; inputCol < ").concat(h,"; inputCol = inputCol + ").concat(t[0],") {\n          ").concat(Ns(i,n),"\n        }\n      }\n      // Load one tile of B into local memory.\n      for (var inputRow = localRow; inputRow < ").concat(o,"; inputRow = inputRow + ").concat(t[1],") {\n            for (var inputCol = localCol; inputCol < ").concat(c,"; inputCol = inputCol + ").concat(t[0],") {\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n            kStart + inputRow,\n            globalColStart + inputCol").concat(n?", batchIndices":"",");\n        }\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      var BCached : array<").concat(r,", colPerThread>;\n      for (var k = 0; k < tileInner; k = k + 1) {\n        for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n          BCached[inner] = mm_Bsub[k][localCol + inner * ").concat(t[0],"];\n        }\n        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let ACached = ").concat(i?"mm_Asub[k][localRow + innerRow * ".concat(t[1],"];"):"mm_Asub[localRow + innerRow * ".concat(t[1],"][k];"),"\n          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n            acc[innerRow][innerCol] = acc[innerRow][innerCol] +\n                ACached * BCached[innerCol];\n          }\n        }\n      }\n      workgroupBarrier();\n    }\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      let gRow = globalRowStart + localRow + innerRow * ").concat(t[1],";\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        let gCol = globalColStart + localCol + innerCol * ").concat(t[0],";\n        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);\n      }\n    }\n    "):"\nlet tileRow = i32(localId.y) * rowPerThread;\nlet tileCol = i32(localId.x) * colPerThread;\n\nlet globalRow = i32(globalId.y) * rowPerThread;\nlet globalCol = i32(globalId.x) * colPerThread;\nlet globalRowStart = i32(workgroupId.y) * ".concat(l,";\n\nlet tileRowA = i32(localId.y) * ").concat(d,";\nlet tileColA = i32(localId.x) * ").concat(p,";\nlet tileRowB = i32(localId.y) * ").concat(y,";\n// Loop over shared dimension.\nfor (var t = 0; t < numTiles; t = t + 1) {\n  // Load one tile of A into local memory.\n  for (var innerRow = 0; innerRow < ").concat(d,"; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < ").concat(p,"; innerCol = innerCol + 1) {\n      let inputRow = tileRowA + innerRow;\n      let inputCol = tileColA + innerCol;\n      ").concat(Ns(i,n),"\n    }\n  }\n\n  // Load one tile of B into local memory.\n  for (var innerRow = 0; innerRow < ").concat(y,"; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n      let inputRow = tileRowB + innerRow;\n      let inputCol = tileCol + innerCol;\n      mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n        kStart + inputRow,\n        globalCol + innerCol").concat(n?", batchIndices":"",");\n    }\n  }\n  kStart = kStart + tileInner;\n  workgroupBarrier();\n\n  // Compute acc values for a single thread.\n  var BCached : array<").concat(r,", colPerThread>;\n  for (var k = 0; k < tileInner; k = k + 1) {\n    for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n      BCached[inner] = mm_Bsub[k][tileCol + inner];\n    }\n\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      ").concat(Cc(i),"\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];\n      }\n    }\n  }\n\n  workgroupBarrier();\n}\n\nfor (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n    mm_write(batch, globalRow + innerRow, globalCol + innerCol,\n        acc[innerRow][innerCol]);\n  }\n}\n");return"\n  var<workgroup> mm_Asub : array<array<".concat(r,", ").concat(h,">, ").concat(f,">;\n  var<workgroup> mm_Bsub : array<array<").concat(r,", ").concat(c,">, ").concat(o,">;\n  const rowPerThread = ").concat(e[1],";\n  const colPerThread = ").concat(e[0],";\n  const tileInner = ").concat(o,";\n\n@compute @workgroup_size(").concat(t[0],", ").concat(t[1],", ").concat(t[2],")\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n    let batch = ").concat(a?"0":"i32(globalId.z)",";\n    ").concat(n?"let batchIndices = ".concat(n.offsetToIndices("u32(batch)"),";"):"","\n    let numTiles = ").concat(a?"".concat(Math.ceil(s/o)):"(uniforms.dimInner - 1) / tileInner + 1",";\n    var kStart = ").concat(a?"i32(globalId.z) * ".concat(s):"0",";\n\n    var acc : array<array<").concat(r,", colPerThread>, rowPerThread>;\n\n    // Without this initialization strange values show up in acc.\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = 0.0;\n      }\n    }\n    ").concat(m,"\n  }\n");},Ac=function Ac(e,t,r,n,i){var o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:!1;var _i157=_slicedToArray2(i,3),a=_i157[0],s=_i157[1],u=_i157[2],_n205=_slicedToArray2(n,4),l=_n205[0],c=_n205[1],h=_n205[2],f=_n205[3],d=cr(a,u),p=cr(s,u),y=Le(n[0].type.tensor);return"\n    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ".concat(l.type.indices,") -> ").concat(Ke(e,y)," {\n      var value = ").concat(Ke(e,y),"(0.0);\n      let col = colIn * ").concat(e,";\n      if(row < uniforms.dimAOuter && col < uniforms.dimInner)\n      {\n        ").concat(function(){var e=c.rank,t=l.rank,r="var aIndices: ".concat(c.type.indices,";");for(var _n206=e-2-1,_i158=t-1;_n206>=0;_n206--,_i158--)r+="\naIndices[".concat(_n206,"] = ").concat(t>1?"batchIndices[".concat(_i158,"]"):"batchIndices",";");return d.forEach(function(e){r+="\naIndices[".concat(e,"] = 0;");}),r+="\naIndices[".concat(e-2,"] = u32(row);\n                   aIndices[").concat(e-1,"] = u32(colIn);"),r;}(),"\n        value = ").concat(c.getByIndices("aIndices"),";\n      }\n      return value;\n    }\n\n    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ").concat(l.type.indices,") -> ").concat(Ke(e,y)," {\n      var value = ").concat(Ke(e,y),"(0.0);\n      let col = colIn * ").concat(e,";\n      if(row < uniforms.dimInner && col < uniforms.dimBOuter)\n      {\n        ").concat(function(){var e=h.rank,t=l.rank,r="var bIndices: ".concat(h.type.indices,";");for(var _n207=e-2-1,_i159=t-1;_n207>=0;_n207--,_i159--)r+="\nbIndices[".concat(_n207,"] = ").concat(t>1?"batchIndices[".concat(_i159,"]"):"batchIndices",";");return p.forEach(function(e){r+="\nbIndices[".concat(e,"] = 0;");}),r+="\nbIndices[".concat(e-2,"] = u32(row);\n                   bIndices[").concat(e-1,"] = u32(colIn);"),r;}(),"\n        value = ").concat(h.getByIndices("bIndices"),";\n      }\n      return value;\n    }\n\n    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ").concat(Ke(e,y),") {\n      let col = colIn * ").concat(e,";\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n        var value = valueIn;\n        let coords = vec3<i32>(batch, row, colIn);\n        ").concat(t?"value = value + ".concat(o?"bias[colIn]":"".concat(Ke(e,y),"(bias[row])"),";"):"","\n        ").concat(r,"\n        ").concat(f.setByIndices("vec3<u32>(coords)","value"),"\n      }\n    }\n    ");},kn=function kn(e,t,r,n){var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!1;var o=e[0].dims,a=e[1].dims,s=o.slice(0,-2),u=a.slice(0,-2),l=n?n.slice(0,-2):r.slice(0,-2),c=De(l.length),h=c?l.length:l,f=$n("batchDims",e[0].dataType,h,1),d=ort_webgpu_min_N.size(l),p=o[o.length-2],y=o[o.length-1],m=a[a.length-1],g=y%4==0&&m%4==0,w=p<=8?[4,1,1]:[4,4,1],b=[8,8,1],v=[Math.ceil(m/b[0]/w[0]),Math.ceil(p/b[1]/w[1]),Math.ceil(d/b[2]/w[2])],x=Le(e[0].dataType),_=g?4:1,S=[].concat(_toConsumableArray2(s),[p,y/_]),T=De(S.length),I=T?S.length:S,E=[].concat(_toConsumableArray2(u),[y,m/_]),A=De(E.length),C=A?E.length:E,O=[d,p,m/_],P=U("a",e[0].dataType,I,_),k=U("b",e[1].dataType,C,_),R=ort_webgpu_min_j("result",e[0].dataType,O.length,_),B=[P,k],$=[{type:"int32",data:p},{type:"int32",data:m},{type:"int32",data:y}];c&&$.push.apply($,_toConsumableArray2(F(l))),T&&$.push.apply($,_toConsumableArray2(F(S))),A&&$.push.apply($,_toConsumableArray2(F(E)));var D=[];D.push(T?"rank":"dims"),D.push(A?"rank":"dims");var M=e.length>2,_xt2=xt(t,R.type.value),L=_xt2.activationFunction,N=_xt2.applyActivation,G=Ac(_,M,N,[f,P,k,R],[s,u,l],i);if(M){var _t380=i?_:1;B.push(U("bias",e[2].dataType,e[2].dims.length,_t380)),$.push.apply($,_toConsumableArray2(F(e[2].dims))),D.push("rank");}$.push.apply($,_toConsumableArray2(F(O)));return{name:"MatMul",shaderCache:{hint:t.activationCacheKey+"".concat(w).concat(g).concat(i),inputDependencies:D},getRunData:function getRunData(){return{outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:v[0],y:v[1],z:v[2]},programUniforms:$};},getShaderSource:function getShaderSource(e){var _e$registerUniform$re;return"\n  ".concat((_e$registerUniform$re=e.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").registerInternalVariables(f)).declareVariables.apply(_e$registerUniform$re,B.concat([R])),"\n  ").concat(L,"\n  ").concat(G,"\n  ").concat(g?Dr(w,b,x,f):Mr(w,b,x,f),"\n                   ");}};};}),Tc,Vs,Ws=q(function(){Dt(),we(),Mt(),En(),Aa(),Ur(),Tc=function Tc(e,t,r,n){var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!1;var o=arguments.length>5?arguments[5]:undefined;var a=arguments.length>6&&arguments[6]!==undefined?arguments[6]:4;var s=arguments.length>7&&arguments[7]!==undefined?arguments[7]:4;var u=arguments.length>8&&arguments[8]!==undefined?arguments[8]:4;var l=arguments.length>9&&arguments[9]!==undefined?arguments[9]:"f32";var c=e?"\n    let coord = vec4<i32>(batch, xRow, xCol, xCh);\n    ":"\n    let coord = vec4<i32>(batch, xCh, xRow, xCol);\n    ",h=e?"\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    ":"\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    ",f=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",d=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",p=e?"row":"col",y=e?"col":"row",m="\n    let inChannels = i32(uniforms.w_shape[2]);\n    let outWidth = ".concat(e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])",";\n    let outRow = ").concat(p," / outWidth;\n    let outCol = ").concat(p," % outWidth;\n\n    let WRow = ").concat(y," / (filterDims[1] * inChannels);\n    let WCol = ").concat(y," / inChannels % filterDims[1];\n    let xRow = outRow * stride[0] + dilation[0] * WRow - pad[0];\n    let xCol = outCol * stride[1] + dilation[1] * WCol - pad[1];\n    let xCh = ").concat(y," % inChannels;\n    var resData = ").concat(Ke(a,l),"(0.0);\n    // The bounds checking is always needed since we use it to pad zero for\n    // the 'same' padding type.\n    if (xRow >= 0 && xRow < ").concat(f," && xCol >= 0 && xCol < ").concat(d,") {\n      ").concat(c,"\n      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));\n      ").concat(function(e){switch(e){case 1:return"resData = x[xIndex];";case 3:return"resData = vec3<".concat(l,">(x[xIndex], x[xIndex + 1], x[xIndex + 2]);");case 4:return"resData = x[xIndex / 4];";default:throw new Error("innerElementSize ".concat(e," is not supported."));}}(a),"\n    }\n    return resData;"),g=e?t&&n?"\n    let col = colIn * ".concat(a,";\n    ").concat(m):"\n    let col = colIn * ".concat(a,";\n    if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n      ").concat(m,"\n    }\n    return ").concat(Ke(a,l),"(0.0);"):n&&r?"\n    let col = colIn * ".concat(a,";\n    ").concat(m):"\n    let col = colIn * ".concat(a,";\n    if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n      ").concat(m,"\n    }\n    return ").concat(Ke(a,l),"(0.0);"),w="".concat(function(e){switch(e){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error("innerElementSize ".concat(e," is not supported."));}}(s)),b=Ke(u,l),v=Ke(e?a:s,l),x=Ke(e?s:a,l),_xt3=xt(o,b),_=_xt3.activationFunction,S=_xt3.applyActivation;return"\n    ".concat(_,"\n    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ").concat(v," {\n      ").concat(e?g:w,"\n    }\n\n    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ").concat(x," {\n      ").concat(e?w:g,"\n    }\n\n    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ").concat(b,") {\n      let col = colIn * ").concat(u,";\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)\n      {\n      var value = valueIn;\n      let outWidth = ").concat(e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])",";\n      ").concat(h,"\n      ").concat(Tn(i),"\n      ").concat(S,"\n      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n      }\n    }");},Vs=function Vs(e,t,r,n,i,o,a,s){var u="NHWC"===t.format,l=u?e[0].dims[3]:e[0].dims[1],c=r[0],h=u?r[2]:r[3],f=u?r[1]:r[2],d=u?r[3]:r[1],p=u&&(l%4==0||l%3==0)&&d%4==0,y=u?d:h*f,m=u?h*f:d,g=[8,8,1],w=n<=8?[4,1,1]:[4,4,1],b=[Math.ceil(y/g[0]/w[0]),Math.ceil(m/g[1]/w[1]),Math.ceil(c/g[2]/w[2])];Ue("verbose",function(){return"[conv2d_mm_webgpu] dispatch = ".concat(b);});var v=p?u&&l%4!=0?3:4:1,x=g[1]*w[1],_=g[0]*w[0],S=Math.max(g[0]*v,g[1]),T=n%x==0,I=i%_==0,E=o%S==0,A=p?[v,4,4]:[1,1,1],C=Le(e[0].dataType),O=p?4:1,P=[{type:"int32",data:n},{type:"int32",data:i},{type:"int32",data:o}],k=[U("x",e[0].dataType,e[0].dims.length,3===v?1:v),U("w",e[1].dataType,e[1].dims.length,O)];P.push.apply(P,_toConsumableArray2(F(e[0].dims))),P.push.apply(P,_toConsumableArray2(F(e[1].dims)));var R="\n      fn setOutputAtIndex(flatIndex : i32, value : ".concat(p?"vec4<".concat(C,">"):C,") {\n        result[flatIndex] = ").concat(p?"vec4<".concat(C,">"):C,"(value);\n      }\n      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ").concat(p?"vec4<".concat(C,">"):C,") {\n        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));\n        setOutputAtIndex(flatIndex ").concat(p?"/ 4":"",", value);\n      }");if(a){var _t381=U("bias",e[2].dataType,e[2].dims.length,O);k.push(_t381),P.push.apply(P,_toConsumableArray2(F(e[2].dims))),R+="\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ".concat(p?"vec4<".concat(C,">"):C," {\n          return bias[coords.").concat(u?"w":"y").concat(p?"/ 4":"","];\n        }");}var B=ort_webgpu_min_j("result",e[0].dataType,r.length,O);return P.push.apply(P,_toConsumableArray2(F(r))),{name:"Conv2DMatMul",shaderCache:{hint:t.cacheKey},getRunData:function getRunData(){return{outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:b[0],y:b[1],z:b[2]},programUniforms:P};},getShaderSource:function getShaderSource(e){var _e$registerUniform$re2;return"\n        ".concat(On("uniforms.result_strides"),"\n        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,\n        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,\n        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };\n        ").concat((_e$registerUniform$re2=e.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32")).declareVariables.apply(_e$registerUniform$re2,k.concat([B])),"\n        const filterDims : vec2<i32> = vec2<i32>(").concat(t.kernelShape[0],", ").concat(t.kernelShape[1],");\n        const pad : vec2<i32> = vec2<i32>(").concat(t.pads[0],", ").concat(t.pads[1],");\n        const stride : vec2<i32> = vec2<i32>(").concat(t.strides[0],", ").concat(t.strides[1],");\n        const dilation : vec2<i32> = vec2<i32>(").concat(t.dilations[0],", ").concat(t.dilations[1],");\n        ").concat(R,"\n        ").concat(Tc(u,T,I,E,a,t,A[0],A[1],A[2],C),"\n            ").concat(p?Dr(w,g,C,void 0,!u,S):Mr(w,g,C,void 0,!u,S,!1,void 0,s));}};};}),Ta,Gs=q(function(){$e(),we(),Oa(),Mt(),Ta=function Ta(e,t,r){var n=e.length>2,i=n?"value += b[output_channel];":"",o=e[0].dims,a=e[1].dims,s=a[0]/t.group,u="NHWC"===t.format,l=Ea(o,a,t.dilations,t.pads,t.strides,u),c=ort_webgpu_min_N.size(l),h=ort_webgpu_min_j("output",e[0].dataType,l),_xt4=xt(t,h.type.value),f=_xt4.activationFunction,d=_xt4.applyActivation,p=U("x",e[0].dataType,o),y=U("w",e[1].dataType,a),m=[p,y];n&&m.push(U("b",e[2].dataType,e[2].dims));return{name:"GroupedConv",shaderCache:{hint:t.cacheKey},getRunData:function getRunData(){return{outputs:[{dims:r?r(l):l,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)}};},getShaderSource:function getShaderSource(e){return"\n  const strides: vec2<u32> = vec2(".concat(t.strides[0],"u, ").concat(t.strides[1],"u);\n  const pads: vec2<u32> = vec2(").concat(t.pads[0],"u, ").concat(t.pads[1],"u);\n\n  ").concat(e.declareVariables.apply(e,m.concat([h])),"\n\n  ").concat(f,"\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes(c),"\n\n    let outputIndices = ").concat(h.offsetToIndices("global_idx"),";\n    let batch: u32 = outputIndices[0];\n    let output_channel: u32 = outputIndices[").concat(u?3:1,"];\n    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[").concat(u?1:2,"], outputIndices[").concat(u?2:3,"]) * strides - pads;\n    let group_id: u32 = output_channel / ").concat(s,"u;\n\n    var value: ").concat(h.type.value," = ").concat(h.type.value,"(0);\n    for (var wInChannel: u32 = 0u; wInChannel < ").concat(a[1],"u; wInChannel++) {\n      let input_channel = group_id * ").concat(a[1],"u + wInChannel;\n      for (var wHeight: u32 = 0u; wHeight < ").concat(a[2],"u; wHeight++) {\n        let xHeight = xRCCorner.x + wHeight * ").concat(t.dilations[0],"u;\n\n        if (xHeight < 0u || xHeight >= ").concat(o[u?1:2],"u) {\n          continue;\n        }\n\n        for (var wWidth: u32 = 0u; wWidth < ").concat(a[3],"u; wWidth++) {\n          let xWidth = xRCCorner.y + wWidth * ").concat(t.dilations[1],"u;\n          if (xWidth < 0u || xWidth >= ").concat(o[u?2:3],"u) {\n            continue;\n          }\n\n          let xVal = ").concat(u?p.get("batch","xHeight","xWidth","input_channel"):p.get("batch","input_channel","xHeight","xWidth"),";\n          let wVal = ").concat(y.get("output_channel","wInChannel","wHeight","wWidth"),";\n          value += xVal*wVal;\n        }\n      }\n    }\n    ").concat(i,"\n    ").concat(d,"\n    ").concat(h.setByOffset("global_idx","value"),"\n  }");}};};}),ka,Ec,Hs,Ba=q(function(){$e(),Ur(),we(),Mt(),ka=function ka(e,t,r,n){var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!1;var o=e[0].dims,a=e[1].dims,s=o[o.length-2],u=a[a.length-1],l=o[o.length-1],c=Fe(u),h=Fe(l),f=Fe(s),d=ort_webgpu_min_N.size(r)/c/f,p=e.length>2,y=n?n.slice(0,-2):r.slice(0,-2),m=[ort_webgpu_min_N.size(y),s,u],g=[{type:"uint32",data:d},{type:"uint32",data:s},{type:"uint32",data:u},{type:"uint32",data:l}].concat(_toConsumableArray2(F(y)),_toConsumableArray2(F(o)),_toConsumableArray2(F(a)));p&&g.push.apply(g,_toConsumableArray2(F(e[2].dims))),g.push.apply(g,_toConsumableArray2(F(m)));return{name:"MatMulNaive",shaderCache:{hint:"".concat(t.activationCacheKey,"_").concat(c,"_").concat(h,"_").concat(f,"_").concat(i),inputDependencies:p?["rank","rank","rank"]:["rank","rank"]},getRunData:function getRunData(){return{outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:g};},getShaderSource:function getShaderSource(n){var _n$registerUniform$re;var s=$n("batch_dims",e[0].dataType,y.length),u=U("a",e[0].dataType,o.length,h),l=U("b",e[1].dataType,a.length,c),d=ort_webgpu_min_j("output",e[0].dataType,m.length,c),_xt5=xt(t,d.type.value),g=_xt5.activationFunction,w=_xt5.applyActivation,b=[u,l],v="";if(p){var _t382=i?c:1;b.push(U("bias",e[2].dataType,e[2].dims.length,_t382)),v=""+(i?"value += bias[col / ".concat(_t382,"];"):"value += ".concat(d.type.value,"(bias[row + i]);"));}var x=o.slice(0,-2),_=a.slice(0,-2),S=cr(x,y),T=cr(_,y),I=function I(e,t){var r=e.rank,n=e.name;if(2===r)return"var ".concat(n,"_indices = ").concat(e.type.indices,"(0u, 0u);");var i=s.rank,o="var ".concat(n,"_indices: ").concat(e.type.indices,";");for(var _e897=r-2-1,_t383=i-1;_e897>=0;_e897--,_t383--)o+="\n".concat(n,"_indices[").concat(_e897,"] = ").concat(i>1?"batch_indices[".concat(_t383,"]"):"batch_indices",";");return t.forEach(function(e){o+="\n".concat(n,"_indices[").concat(e,"] = 0;");}),o+="".concat(n,"_indices[").concat(r-2,"] = 0u;\n                     ").concat(n,"_indices[").concat(r-1,"] = 0u;"),o;};return"\n  ".concat((_n$registerUniform$re=n.registerUniform("outputSize","u32").registerUniform("M","u32").registerUniform("N","u32").registerUniform("K","u32").registerInternalVariables(s)).declareVariables.apply(_n$registerUniform$re,b.concat([d])),"\n  ").concat(g,"\n  ").concat(n.mainStart(),"\n    ").concat(n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n    let col = (global_idx % (uniforms.N / ").concat(c,")) * ").concat(c,";\n    var index1 = global_idx / (uniforms.N / ").concat(c,");\n    let stride1 = uniforms.M / ").concat(f,";\n    let row = (index1 % stride1) * ").concat(f,";\n    let batch = index1 / stride1;\n\n    ").concat(2===r.length?"":"let batch_indices = ".concat(s.offsetToIndices("batch"),";"),"\n    ").concat(I(u,S),"\n    let a_offset = ").concat(u.indicesToOffset("a_indices"),";\n    ").concat(I(l,T),"\n    let b_offset = ").concat(l.indicesToOffset("b_indices"),";\n    var values: array<").concat(d.type.value,", ").concat(f,">;\n    for (var k: u32 = 0u; k < uniforms.K; k = k + ").concat(h,") {\n      ").concat(function(){var e="var a_data: ".concat(u.type.value,";");for(var _t384=0;_t384<h;_t384++)e+="\n              let b_data".concat(_t384," = b[(b_offset + (k + ").concat(_t384,") * uniforms.N + col) / ").concat(c,"];");for(var _t385=0;_t385<f;_t385++){e+="a_data = a[(a_offset + (row + ".concat(_t385,") * uniforms.K + k) / ").concat(h,"];");for(var _r299=0;_r299<h;_r299++)e+="\n            values[".concat(_t385,"] = fma(").concat(l.type.value,"(a_data").concat(1===h?"":"[".concat(_r299,"]"),"), b_data").concat(_r299,", values[").concat(_t385,"]);\n");}return e;}(),"\n    }\n    for (var i = 0u; i < ").concat(f,"u; i++) {\n      var value = values[i];\n      ").concat(v,"\n      ").concat(w,"\n      let cur_indices = ").concat(d.type.indices,"(batch, row + i, col);\n      let offset = ").concat(d.indicesToOffset("cur_indices"),";\n      ").concat(d.setByOffset("offset / ".concat(c),"value"),";\n    }\n  }\n  ");}};},Ec=function Ec(e){if(!e||2!==e.length)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.");},Hs=function Hs(e){Ec(e.inputs);var t=gt.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can't use matmul on the given tensors");var r=t[t.length-1],n=e.inputs[0].dims[e.inputs[0].dims.length-1];r<8&&n<8?e.compute(ka(e.inputs,{activation:"",activationCacheKey:""},t)):e.compute(kn(e.inputs,{activation:"",activationCacheKey:""},t));};}),Ea,Ls,Oc,Fs,Pa,kc,Bc,Ra,Oa=q(function(){$e(),qe(),Ws(),Ur(),Gs(),Mt(),Ba(),pr(),Ea=function Ea(e,t,r,n,i,o){var a=e[0],s=e.slice(o?1:2,o?3:4),u=s.length,l=t[0],c=t.slice(2).map(function(e,t){return e+(e-1)*(r[t]-1);}),h=s.map(function(e,t){return e+n[t]+n[t+u];}).map(function(e,t){return Math.floor((e-c[t]+i[t])/i[t]);});return h.splice(0,0,a),h.splice(o?3:1,0,l),h;},Ls=[2,3,1,0],Oc=function Oc(e,t){if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length&&3!==e[0].dims.length)throw new Error("currently only support conv 1D and 2D");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");if(e[0].dims["NHWC"===t.format?e[0].dims.length-1:1]!==e[1].dims[1]*t.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(3===e.length&&(1!==e[2].dims.length||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");var r=e[0].dims.length-2;if(t.dilations.length!==r)throw new Error("dilations should be ".concat(r,"D"));if(t.strides.length!==r)throw new Error("strides should be ".concat(r,"D"));if(t.pads.length!==2*r)throw new Error("pads should be ".concat(2*r,"D"));if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");},Fs=function Fs(e,t){var r=e.kernelShape.slice();for(var _e898=2;_e898<t[1].dims.length;++_e898)0===r[_e898-2]&&(r[_e898-2]=t[1].dims[_e898]);var n=e.pads.slice();Kt.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,n,"NHWC"===e.format,e.autoPad);var i=Object.assign({},e);return Object.assign(i,{kernelShape:r,pads:n,cacheKey:e.cacheKey}),i;},Pa=function Pa(e){var t=An(e),r=e.format,n=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],i=e.dilations,o=e.group,a=e.kernel_shape,s=e.pads,u=e.strides,l=e.w_is_const();return ge(_objectSpread({autoPad:n,format:r,dilations:i,group:o,kernelShape:a,pads:s,strides:u,wIsConst:l},t));},kc=function kc(e,t,r){var _e$kernelCustomData$w2;var n=Fs(r,t),i="NHWC"===r.format;if(1!==r.group)return void e.compute(Ta(t,n));var o=3===t.length,a=t[0].dims[i?1:2],s=t[0].dims[i?2:3],u=t[0].dims[i?3:1],l=t[1].dims[2],c=t[1].dims[3],h=Ea(t[0].dims,t[1].dims,r.dilations,n.pads,r.strides,i),f=h[i?1:2],d=h[i?2:3],p=h[i?3:1],y=i&&l===a&&c===s&&0===r.pads[0]&&0===r.pads[1];if(y||1===l&&1===c&&1===r.dilations[0]&&1===r.dilations[1]&&1===r.strides[0]&&1===r.strides[1]&&0===r.pads[0]&&0===r.pads[1]){var _l36,_c34,_m10,_g6=h[0],_w4=[];if(i){var _e$kernelCustomData$w;var _n208=(_e$kernelCustomData$w=e.kernelCustomData.wT)!==null&&_e$kernelCustomData$w!==void 0?_e$kernelCustomData$w:e.compute(ft(t[1],Ls),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];if(r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=_n208),y){var _e899=a*s*u;_l36=t[0].reshape([1,_g6,_e899]),_c34=_n208.reshape([1,_e899,p]),_m10=[1,_g6,p];}else _l36=t[0].reshape([_g6,a*s,u]),_c34=_n208.reshape([1,u,p]),_m10=[_g6,f*d,p];_w4.push(_l36),_w4.push(_c34);}else _l36=t[0].reshape([_g6,u,a*s]),_c34=t[1].reshape([1,p,u]),_m10=[_g6,p,f*d],_w4.push(_c34),_w4.push(_l36);o&&_w4.push(t[2]);var _b7=_m10[2],_v5=_w4[0].dims[_w4[0].dims.length-1];return void(_b7<8&&_v5<8?e.compute(ka(_w4,n,h,_m10,i),{inputs:_w4}):e.compute(kn(_w4,n,h,_m10,i),{inputs:_w4}));}var m=(_e$kernelCustomData$w2=e.kernelCustomData.wT)!==null&&_e$kernelCustomData$w2!==void 0?_e$kernelCustomData$w2:e.compute(ft(t[1],Ls),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=m);var g=[t[0],m];o&&g.push(t[2]);var w=i?f*d:p,b=i?p:f*d,v=l*c*u;e.compute(Vs(g,n,h,w,b,v,o,!0),{inputs:g});},Bc=function Bc(e,t){var r="NHWC"===t.format,n=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];3===e.inputs.length&&n.push(e.inputs[2]);var i=[0,t.pads[0],0,t.pads[1]],o=[1].concat(t.strides),a=[1].concat(t.dilations),s=[1].concat(t.kernelShape),u=Fs(_objectSpread(_objectSpread({},t),{},{pads:i,strides:o,dilations:a,kernelShape:s}),n);e.compute(Ta(n,u,function(e){return r?[e[0],e[2],e[3]]:[];}));},Ra=function Ra(e,t){Oc(e.inputs,t),3===e.inputs[0].dims.length?Bc(e,t):kc(e,e.inputs,t);};}),Pc,qs,js=q(function(){Dt(),we(),Mt(),En(),Aa(),Ur(),Pc=function Pc(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var r=arguments.length>2?arguments[2]:undefined;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:4;var i=Ke(n,"f32"),o=e?"\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    ":"\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    ",a=e?"row":"col",s=e?"col":"row",u="\n      let inChannels = ".concat(e?"outBackprop[3]":"outBackprop[1]",";\n      let outWidth = ").concat(e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])",";\n      let outRow = ").concat(a," / outWidth;\n      let outCol = ").concat(a," % outWidth;\n\n      let WRow = ").concat(s," / (filterDims[1] * inChannels);\n      let WCol = ").concat(s," / inChannels % filterDims[1];\n      let xR = f32(outRow - pads[0] + dilation[0] * WRow) / f32(strides[0]);\n      let xC = f32(outCol - pads[1] + dilation[1] * WCol) / f32(strides[1]);\n      if (xR < 0.0 || xR >= f32(").concat(e?"outBackprop[1]":"outBackprop[2]",") || fract(xR) > 0.0) {\n        return ").concat(i,"(0.0);\n      }\n      if (xC < 0.0 || xC >= f32(").concat(e?"outBackprop[2]":"outBackprop[3]",") || fract(xC) > 0.0) {\n        return ").concat(i,"(0.0);\n      }\n      let iXR = i32(xR);\n      let iXC = i32(xC);\n      let xCh = ").concat(s," % inChannels;\n      ").concat(e?"\n      let coord = vec4<i32>(batch, iXR, iXC, xCh);\n      ":"\n      let coord = vec4<i32>(batch, xCh, iXR, iXC);\n      ","\n      return x[getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape))/").concat(n,"];"),l=e?"\n      let col = colIn * ".concat(n,";\n      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n        ").concat(u,"\n      }\n      return ").concat(i,"(0.0);"):"\n      let col = colIn * ".concat(n,";\n      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n        ").concat(u,"\n      }\n      return ").concat(i,"(0.0);"),c="\n      let col = colIn * ".concat(n,";\n      let inChannels = ").concat(e?"outBackprop[3]":"outBackprop[1]",";\n      let coordX = filterDims.x - 1 - row / (filterDims[1] * inChannels);\n      let coordY = filterDims.y - 1 - (row / inChannels) % filterDims[1];\n      if (").concat(e?"row < uniforms.dimInner && col < uniforms.dimBOuter":"row < uniforms.dimInner && col < uniforms.dimAOuter","  && coordX >= 0 && coordY >= 0) {\n        let rowInner = row % inChannels;\n        let coord = vec4<i32>(coordX, coordY, col, rowInner);\n        ").concat(function(e){switch(e){case 1:return"return w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];";case 4:return"\n            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);\n            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);\n            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);\n            let v0 = w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];\n            let v1 = w[getIndexFromCoords4D(coord1, vec4<i32>(uniforms.w_shape))];\n            let v2 = w[getIndexFromCoords4D(coord2, vec4<i32>(uniforms.w_shape))];\n            let v3 = w[getIndexFromCoords4D(coord3, vec4<i32>(uniforms.w_shape))];\n            return vec4<f32>(v0, v1, v2, v3);\n            ";default:throw new Error("innerElementSize ".concat(e," is not supported."));}}(n),"\n      }\n      return ").concat(i,"(0.0);\n      "),_xt6=xt(r,i),h=_xt6.activationFunction,f=_xt6.applyActivation;return"\n      ".concat(h,"\n  fn mm_readA(batch: i32, row : i32, colIn : i32) -> ").concat(i," {\n    ").concat(e?l:c,"\n  }\n\n  fn mm_readB(batch: i32, row : i32, colIn : i32) -> ").concat(i," {\n    ").concat(e?c:l,"\n  }\n\n  fn mm_write(batch: i32, row : i32, colIn : i32, valueInput : ").concat(i,") {\n    let col = colIn * ").concat(n,";\n    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n      var value = valueInput;\n      let outWidth = ").concat(e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])",";\n      ").concat(o,"\n      ").concat(Tn(t),"\n      ").concat(f,"\n      result[getIndexFromCoords4D(coords, vec4<i32>(uniforms.result_shape))/").concat(n,"] = value;\n    }\n  }");},qs=function qs(e,t,r,n,i,o,a,s){var u="NHWC"===t.format,l=u?e[0].dims[3]:e[0].dims[1],c=r[0],h=u?r[2]:r[3],f=u?r[1]:r[2],d=u?r[3]:r[1],p=u?l%4==0&&d%4==0:h%4==0&&d%4==0,y=u?d:h*f,m=u?h*f:d,g=p?[8,8,1]:[y<=4||m<=4?4:16,y>4&&m<=4?4:16,1],w=p?[4,4,1]:[y<=4?1:4,y>4&&m<=4?1:4,1],b=[Math.ceil(y/g[0]/w[0]),Math.ceil(m/g[1]/w[1]),Math.ceil(c/g[2]/w[2])];Ue("verbose",function(){return"[conv_backprop_mm_webgpu] dispatch = ".concat(b);});var v=p?4:1,x=Math.max(g[0]*v,g[1]),_=p?4:1,S=[{type:"int32",data:n},{type:"int32",data:i},{type:"int32",data:o}],T=U("x",e[0].dataType,e[0].dims.length,_),I=U("w",e[1].dataType,e[1].dims.length,1),E=ort_webgpu_min_j("result",e[0].dataType,r.length,_),A=[T,I];S.push.apply(S,_toConsumableArray2(F(e[0].dims))),S.push.apply(S,_toConsumableArray2(F(e[1].dims)));var C="";if(a){var _t386=U("bias",e[2].dataType,e[2].dims.length,_);A.push(_t386),S.push.apply(S,_toConsumableArray2(F(e[2].dims))),C+="\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ".concat(p?"vec4<f32>":"f32"," {\n          return bias[coords.").concat(u?"w":"y").concat(p?"/ 4":"","];\n        }");}return S.push.apply(S,_toConsumableArray2(F(r))),{name:"Conv2DTransposeMatMul",shaderCache:{hint:t.cacheKey},getRunData:function getRunData(){return{outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:b[0],y:b[1],z:b[2]},programUniforms:S};},getShaderSource:function getShaderSource(r){var _r$registerUniform$re;return"\n        ".concat(On("uniforms.result_strides"),"\n        ").concat((_r$registerUniform$re=r.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32")).declareVariables.apply(_r$registerUniform$re,A.concat([E])),";\n        const outBackprop : vec4<i32> = vec4<i32>(").concat(e[0].dims.join(","),");\n        const filterDims : vec2<i32> = vec2<i32>(").concat(t.kernelShape[u?1:2],", ").concat(t.kernelShape[u?2:3],");\n        const effectiveFilterDims : vec2<i32> = filterDims + vec2<i32>(\n              ").concat(t.dilations[0]<=1?0:(t.kernelShape[u?1:2]-1)*(t.dilations[0]-1),",\n              ").concat(t.dilations[1]<=1?0:(t.kernelShape[u?2:3]-1)*(t.dilations[1]-1),");\n        const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (").concat(t.pads[0]+t.pads[2],")/2,\n                                         i32(effectiveFilterDims[1]) - 1 - (").concat(t.pads[1]+t.pads[3],")/2);\n        const strides : vec2<i32> = vec2<i32>(").concat(t.strides[0],", ").concat(t.strides[1],");\n        const dilation : vec2<i32> = vec2<i32>(").concat(t.dilations[0],", ").concat(t.dilations[1],");\n        const dimAOuter : i32 = ").concat(n,";\n        const dimBOuter : i32 = ").concat(i,";\n        const dimInner : i32 = ").concat(o,";\n        ").concat(C,"\n        ").concat(Pc(u,a,t,v),"\n        ").concat(p?Dr(w,g,"f32",void 0,!u,x):Mr(w,g,"f32",void 0,!u,x,!1,void 0,s));}};};}),Rc,Da,Ks=q(function(){Dt(),$e(),we(),Rc=function Rc(e,t,r,n,i,o){var a=arguments.length>6&&arguments[6]!==undefined?arguments[6]:!1;var s=arguments.length>7?arguments[7]:undefined;var u="NHWC"===r.format,l=u?1:2,c=u?2:3,h=u?3:1,f=ort_webgpu_min_N.size(n),d=a?2:1,p=r.group,y=t[1].dims,m=y[0]/p,g=y[1],w="\n  fn setOutputAtIndex(flatIndex : u32, value : ".concat(a?"vec4<".concat(s,">"):s,") {\n    result[flatIndex] = ").concat(a?"vec4<".concat(s,">"):s,"(value);\n  }");i&&(w+="\n    fn getBiasByOutputCoords(coords : vec4<u32>) -> ".concat(a?"vec4<".concat(s,">"):s," {\n      return bias[coords.").concat(u?"w":"y").concat(a?"/ 4":"","];\n    }"));var b=a?4:1,v=U("W",t[1].dataType,t[1].dims,b),x=U("Dy",t[0].dataType,t[0].dims,b),_=[x,v];i&&_.push(U("bias",t[2].dataType,[n[h]],b));var S=ort_webgpu_min_j("result",t[0].dataType,n,b),T="{\n        let batch: u32 = ".concat(o?"global_id.z":"workgroup_id.z"," / outShape[1];\n        let r = ").concat(o?"global_id.z":"workgroup_id.z"," % outShape[1];\n        let c = ").concat(o?"global_id.y":"workgroup_id.y"," * ").concat(d,";\n        let d1: u32 = ").concat(o?"global_id.x":"workgroup_id.x"," * 4;\n\n        let dyCorner = vec2<i32>(i32(r), i32(c)) - vec2<i32>(pads);\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd: array<vec4<").concat(s,">, ").concat(d,">;\n        for (var i = 0; i < ").concat(d,"; i++) {\n          dotProd[i] = vec4<").concat(s,">(0.0);\n        }\n        for (var wR: u32 = 0; wR < filterDims[0]; wR = wR + 1) {\n          var dyR = (").concat(s,"(dyCorner.x) + ").concat(s,"(wR)) / ").concat(s,"(strides.x);\n          let wRPerm = filterDims[0] - 1 - wR;\n          if (dyR < 0.0 || dyR >= ").concat(s,"(outBackprop[1]) ||\n              fract(dyR) > 0.0 || wRPerm < 0) {\n            continue;\n          }\n          let idyR: u32 = u32(dyR);\n\n          for (var wC: u32 = 0; wC < filterDims[1]; wC = wC + 1) {\n            let dyC = (").concat(s,"(dyCorner.y) + ").concat(s,"(wC)) / ").concat(s,"(strides.y);\n            let dyC2 = (").concat(s,"(dyCorner.y) + 1.0 + ").concat(s,"(wC)) / ").concat(s,"(strides.y);\n            let wCPerm = filterDims[1] - 1 - wC;\n            if (wCPerm < 0) {\n              continue;\n            }\n            var bDyCVal = true;\n            var bDyCVal2 = true;\n            if (dyC < 0.0 || dyC >= ").concat(s,"(outBackprop[2]) ||\n                fract(dyC) > 0.0) {\n              bDyCVal = false;\n            }\n            if (dyC2 < 0.0 || dyC2 >= ").concat(s,"(outBackprop[2]) ||\n                fract(dyC2) > 0.0) {\n              bDyCVal2 = false;\n            }\n\n            let idyC: u32 = u32(dyC);\n            let idyC2: u32 = u32(dyC2);\n            if (bDyCVal && bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2 :u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ").concat(v.get("u32(wRPerm)","u32(wCPerm)","d1","d2"),";\n                let wValue1 = ").concat(v.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2"),";\n                let wValue2 = ").concat(v.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2"),";\n                let wValue3 = ").concat(v.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2"),";\n\n                var xValue = ").concat(x.get("batch","idyR","idyC","d2"),";\n                let tmpval = vec4<").concat(s,">(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n\n                xValue =  ").concat(x.get("batch","idyR","idyC2","d2"),";\n\n                dotProd[1] = dotProd[1] + vec4<").concat(s,">(dot(xValue, wValue0),\n                                                    dot(xValue, wValue1),\n                                                    dot(xValue, wValue2),\n                                                    dot(xValue, wValue3));\n              }\n            } else if (bDyCVal) {\n              let d2Length = outBackprop[").concat(h,"];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ").concat(v.get("u32(wRPerm)","u32(wCPerm)","d1","d2"),";\n                let wValue1 = ").concat(v.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2"),";\n                let wValue2 = ").concat(v.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2"),";\n                let wValue3 = ").concat(v.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2"),";\n\n                var xValue = ").concat(x.get("batch","idyR","idyC","d2"),";\n                let tmpval = vec4<").concat(s,">(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n              }\n            } else if (bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ").concat(v.get("u32(wRPerm)","u32(wCPerm)","d1","d2"),";\n                let wValue1 = ").concat(v.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2"),";\n                let wValue2 = ").concat(v.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2"),";\n                let wValue3 = ").concat(v.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2"),";\n\n                var xValue = ").concat(x.get("batch","idyR","idyC2","d2"),";\n                let tmpval = vec4<").concat(s,">(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[1] = dotProd[1] + tmpval;\n              }\n            }\n          }\n        }\n\n        for (var i: u32 = 0; i < ").concat(d,"; i = i + 1) {\n          let value = dotProd[i] + ").concat(i?"bias[c+i]":"vec4<".concat(s,">(0.0)"),";\n          ").concat(S.set("batch","r","c + i","d1","value"),";\n        }\n      }"),I="\n          let outputIndices = ".concat(S.offsetToIndices("global_idx"),";\n          let batch = ").concat(S.indicesGet("outputIndices",0),";\n          let d1 = ").concat(S.indicesGet("outputIndices",h),";\n          let r = ").concat(S.indicesGet("outputIndices",l),";\n          let c = ").concat(S.indicesGet("outputIndices",c),";\n          let dyCorner = vec2<i32>(i32(r), i32(c)) - pads;\n          let dyRCorner = dyCorner.x;\n          let dyCCorner = dyCorner.y;\n          let groupId = d1 / ").concat(g,";\n          let wOutChannel = d1 - groupId * ").concat(g,";\n          // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n          // ? = to be determined. : = across all values in that axis.\n          var dotProd = ").concat(s,"(0.0);\n          for (var wR: u32 = 0; wR < effectiveFilterDims.x; wR = wR + 1) {\n            if (wR % dilations.x != 0) {\n              continue;\n            }\n            let dyR = (").concat(s,"(dyRCorner) + ").concat(s,"(wR)) / ").concat(s,"(strides[0]);\n            let wRPerm = filterDims.x - 1 - wR / dilations.x;\n            if (dyR < 0.0 || dyR >= ").concat(s,"(outBackprop[").concat(l,"]) || fract(dyR) > 0.0 ||\n                wRPerm < 0) {\n              continue;\n            }\n            let idyR: u32 = u32(dyR);\n\n            for (var wC: u32 = 0; wC < effectiveFilterDims.y; wC = wC + 1) {\n              if (wC % dilations.y != 0) {\n                continue;\n              }\n              let dyC = (").concat(s,"(dyCCorner) + ").concat(s,"(wC)) / ").concat(s,"(strides.y);\n              let wCPerm = filterDims.y - 1 - wC / dilations.y;\n              if (dyC < 0.0 || dyC >= ").concat(s,"(outBackprop[").concat(c,"]) ||\n                  fract(dyC) > 0.0 || wCPerm < 0) {\n                continue;\n              }\n              let idyC: u32 = u32(dyC);\n              var inputChannel = groupId * ").concat(m,";\n              for (var d2: u32 = 0; d2 < ").concat(m,"; d2 = d2 + 1) {\n                let xValue = ").concat(u?x.get("batch","idyR","idyC","inputChannel"):x.get("batch","inputChannel","idyR","idyC"),";\n                let wValue = ").concat(v.get("inputChannel","wOutChannel","u32(wRPerm)","u32(wCPerm)"),";\n                dotProd = dotProd + xValue * wValue;\n                inputChannel = inputChannel + 1;\n              }\n            }\n          }\n          let value = dotProd + ").concat(i?"bias[d1]":"".concat(s,"(0.0)"),";\n          ").concat(S.setByOffset("global_idx","value"),";\n        ");return"\n  ".concat(e.declareVariables.apply(e,_.concat([S])),"\n  ").concat(w,"\n  const outShape : vec4<u32> = vec4<u32>(").concat(n.join(","),");\n  const outBackprop : vec4<u32> = vec4<u32>(").concat(t[0].dims.join(","),");\n  const strides : vec2<u32> = vec2<u32>(").concat(r.strides[0],", ").concat(r.strides[1],");\n  const filterDims : vec2<u32> = vec2<u32>(").concat(r.kernelShape[u?1:2],", ").concat(r.kernelShape[u?2:3],");\n  const dilations : vec2<u32> = vec2<u32>(").concat(r.dilations[0],", ").concat(r.dilations[1],");\n  const effectiveFilterDims : vec2<u32> = filterDims + vec2<u32>(\n          ").concat(r.dilations[0]<=1?0:(r.kernelShape[u?1:2]-1)*(r.dilations[0]-1),",\n          ").concat(r.dilations[1]<=1?0:(r.kernelShape[u?2:3]-1)*(r.dilations[1]-1),");\n  const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (").concat(r.pads[0]+r.pads[2],")/2,\n                                     i32(effectiveFilterDims[1]) - 1 - (").concat(r.pads[1]+r.pads[3],")/2);\n    ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes(f),";\n  ").concat(a?T:I,"}");},Da=function Da(e,t,r){var n=e.length>2,i=t.outputShape,o=ort_webgpu_min_N.size(i),a=[Math.ceil(o/64),1,1];Ue("verbose",function(){return"[conv2d_backprop_webgpu] dispatch = ".concat(a);});var s=Le(e[0].dataType);return{name:"ConvTranspose2D",shaderCache:{hint:t.cacheKey},getRunData:function getRunData(){return{dispatchGroup:{x:a[0],y:a[1],z:a[2]},outputs:[{dims:r?r(i):i,dataType:e[0].dataType}]};},getShaderSource:function getShaderSource(r){return Rc(r,e,t,i,n,1===a[1]&&1===a[2],!1,s);}};};}),Dc,Mc,Uc,Ys,Zs,zc,Nc,Vc,Wc,Xs,Js=q(function(){qe(),js(),Ks(),Mt(),pr(),Dc=function Dc(e,t,r,n,i,o){return(e-1)*t+r+(n-1)*i+1-o;},Mc=function Mc(e,t,r,n,i){var o=Math.floor(e/2);"SAME_UPPER"===t?(r[n]=o,r[i]=e-o):"SAME_LOWER"===t&&(r[n]=e-o,r[i]=o);},Uc=function Uc(e,t,r,n,i,o,a,s,u,l){var c=e.length-2,h=0===l.length;if(0===u.length)for(var _e900=0;_e900<c;++_e900)u.push(0);var f=e[0],d=t[s?3:1]*i;for(var _i160=0,_f21=e.length-c-(s?1:0);_i160<c;++_i160,++_f21){var _s66=e[_f21],_d20=h?_s66*a[_i160]:l[_i160],_p18=Dc(_s66,a[_i160],o[_i160],t[_f21],r[_i160],_d20);Mc(_p18,n,o,_i160,_i160+c),h&&l.push(a[_i160]*(_s66-1)+u[_i160]+(t[_f21]-1)*r[_i160]+1-o[_i160]-o[_i160+c]);}l.splice(0,0,f),l.splice(s?3:1,0,d);},Ys=function Ys(e,t){var r=e.kernelShape.slice();if(0===e.kernelShape.length||0===e.kernelShape.reduce(function(e,t){return e*t;},1)){r.length=0;for(var _e901=2;_e901<t[1].dims.length;++_e901)r.push(t[1].dims[_e901]);}var n="NHWC"===e.format;r.splice(0,0,t[1].dims[0]),r.splice(n?3:1,0,t[1].dims[1]);var i=e.pads.slice(),o=e.outputShape.slice(),a=e.outputPadding.slice(),s=t[0].dims,u=e.dilations.slice();if(0===u.reduce(function(e,t){return e+t;},0)){var _e902=t[0].dims.length-2;u=new Array(_e902).fill(1);}var l=e.strides.slice();if(0===l.reduce(function(e,t){return e+t;},0)){var _e903=t[0].dims.length-2;l=new Array(_e903).fill(1);}Uc(s,r,u,e.autoPad,e.group,i,l,n,a,o);var c=Object.assign({},e),h=e.cacheKey+[r.join("n,"),i.join(","),l.join(","),a.join(","),o.join(","),u.join(",")].join("_");return Object.assign(c,{kernelShape:r,pads:i,outputPadding:a,outputShape:o,dilations:u,strides:l,cacheKey:h}),c;},Zs=function Zs(e){var t=An(e),r=e.format,n=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][_typeof2(e.autoPad)>"u"?0:e.autoPad],i=e.dilations,o=e.group,a=e.kernelShape,s=e.pads,u=e.strides,l=e.wIsConst(),c=e.outputPadding,h=e.outputShape;return ge(_objectSpread({autoPad:n,format:r,dilations:i,group:o,kernelShape:a,outputPadding:c,outputShape:h,pads:s,strides:u,wIsConst:l},t));},zc=function zc(e,t){if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length&&3!==e[0].dims.length)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");if(e[0].dims["NHWC"===t.format?e[0].dims.length-1:1]!==e[1].dims[0])throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");var r=e[1].dims[1]*t.group;if(3===e.length&&(1!==e[2].dims.length||e[2].dims[0]!==r))throw new Error("invalid bias");var n=e[0].dims.length-2;if(t.dilations.reduce(function(e,t){return e+t;},0)>0&&t.dilations.length!==n)throw new Error("dilations should be ".concat(n,"D"));if(t.strides.reduce(function(e,t){return e+t;},0)>0&&t.strides.length!==n)throw new Error("strides should be ".concat(n,"D"));if(t.pads.reduce(function(e,t){return e+t;},0)>0&&t.pads.length!==2*n)throw new Error("pads should be ".concat(2*n,"D"));if(t.outputPadding.length!==n&&0!==t.outputPadding.length)throw new Error("output_padding should be ".concat(n,"D"));if(t.kernelShape.reduce(function(e,t){return e+t;},0)>0&&0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(0!==t.outputShape.length&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape");},Nc=[2,3,1,0],Vc=function Vc(e,t,r){var _e$kernelCustomData$w3;var n=Ys(r,t),i="NHWC"===r.format,o=n.outputShape,a=o[i?3:1],s=t[0].dims[i?3:1];if(1!==n.group||1===a&&1===s)return void e.compute(Da(t,n));var u=o[i?1:2],l=o[i?2:3],c=i?u*l:a,h=i?a:u*l,f=t[1].dims[2]*t[1].dims[3]*s,d=(_e$kernelCustomData$w3=e.kernelCustomData.wT)!==null&&_e$kernelCustomData$w3!==void 0?_e$kernelCustomData$w3:e.compute(ft(t[1],Nc),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=d);var p=[t[0],d],y=3===t.length;y&&(i||1!==t[2].dims.length?p.push(t[2]):p.push(t[2].reshape([t[2].dims[0],1,1]))),e.compute(qs(p,n,o,c,h,f,y,!0),{inputs:p});},Wc=function Wc(e,t){var r="NHWC"===t.format,n=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];3===n.length&&n.push(e.inputs[2]);var i=t.kernelShape;(0===i.length||0===i[0])&&(i=[e.inputs[1].dims[2]]);var o=t.dilations;(0===o.length||0===o[0])&&(o=[1]);var a=t.strides;(0===a.length||0===a[0])&&(a=[1]);var s=t.pads;0===s.length&&(s=[0,0]),s=[0,s[0],0,s[1]],a=[1].concat(a),o=[1].concat(o),i=[1].concat(i);var u=Ys(_objectSpread(_objectSpread({},t),{},{pads:s,strides:a,dilations:o,kernelShape:i}),n);e.compute(Da(n,u,function(e){return r?[e[0],e[2],e[3]]:[e[0],e[1],e[3]];}));},Xs=function Xs(e,t){zc(e.inputs,t),3===e.inputs[0].dims.length?Wc(e,t):Vc(e,e.inputs,t);};}),Gc,Qs,eu,tu=q(function(){Ne(),$e(),qe(),we(),Gc=function Gc(e,t,r,n){var i=ort_webgpu_min_N.size(t),o=t.length,a=U("input",e,o),s=ort_webgpu_min_j("output",e,o),u=6===r.dataType?r.getInt32Array()[0]:Number(r.getBigInt64Array()[0]),l=ort_webgpu_min_N.normalizeAxis(u,o);return{name:"CumSum",shaderCache:{hint:n.cacheKey,inputDependencies:["rank"]},getRunData:function getRunData(){return{outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:"uint32",data:i},{type:"int32",data:l}].concat(_toConsumableArray2(F(t)),_toConsumableArray2(F(t)))};},getShaderSource:function getShaderSource(e){var t=" i32(".concat(a.indicesGet("inputIndices","uniforms.axis"),") "),r=de("uniforms.input_shape","uniforms.axis",o),i=n.reverse?t+(n.exclusive?" + 1":""):"0",u=n.reverse?r:t+(n.exclusive?"":" + 1");return"\n                ".concat(e.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(a,s),"\n                ").concat(e.mainStart(),"\n                  ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n                  var inputIndices = ").concat(s.offsetToIndices("global_idx"),";\n                  var sum = ").concat(s.type.value,"(0);\n                  let first : i32 = ").concat(i,";\n                  let last : i32 = ").concat(u,";\n                  for (var i : i32 = first; i < last; i++) {\n                    ").concat(a.indicesSet("inputIndices","uniforms.axis","u32(i)"),";\n                    sum = sum + ").concat(a.getByIndices("inputIndices"),";\n                  }\n                  ").concat(s.setByOffset("global_idx","sum"),";\n                }");}};},Qs=function Qs(e,t){var r=e.inputs[0].dims,n=e.inputs[0].dataType,i=e.inputs[1];e.compute(Gc(n,r,i,t),{inputs:[0]});},eu=function eu(e){var t=1===e.exclusive,r=1===e.reverse;return ge({exclusive:t,reverse:r});};}),Ma,Bn,ru,Hc,Lc,Ua,za,nu,Fc,au,iu,ou=q(function(){$e(),qe(),we(),ru="^"+(Bn="("+(Ma="[a-zA-Z]|\\.\\.\\.")+")+")+"$",Lc="^"+(Hc="("+Bn+",)*"+Bn)+"$",Ua=/*#__PURE__*/function(){function Ua(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:-1;_classCallCheck2(this,Ua);this.symbolToIndices=new Map(),this.inputIndex=e;}return _createClass2(Ua,[{key:"addSymbol",value:function addSymbol(e,t){var r=this.symbolToIndices.get(e);void 0===r?r=[t]:r.push(t),this.symbolToIndices.set(e,r);}}]);}(),za=/*#__PURE__*/function(){function za(e,t){var _this151=this,_n$match;_classCallCheck2(this,za);this.equation=t,this.hasEllipsis=!1,this.symbolToInfo=new Map(),this.lhs=new Array(),this.outputDims=[];var _ref83=t.includes("->")?t.split("->",2):[t,""],_ref84=_slicedToArray2(_ref83,2),r=_ref84[0],n=_ref84[1];if(!r.match(RegExp(Lc)))throw new Error("Invalid LHS term");if(r.split(",").forEach(function(t,r){var n=e[r].dims.slice();if(!t.match(RegExp(ru)))throw new Error("Invalid LHS term");var i=_this151.processTerm(t,!0,n,r);_this151.lhs.push(i);}),""===n)n+=_toConsumableArray2(this.symbolToInfo.entries()).filter(function(_ref85){var _ref86=_slicedToArray2(_ref85,2),e=_ref86[0],t=_ref86[1];return 1===t.count||"..."===e;}).map(function(_ref87){var _ref88=_slicedToArray2(_ref87,1),e=_ref88[0];return e;}).join("");else if(!n.match(RegExp(Bn)))throw new Error("Invalid RHS");(_n$match=n.match(RegExp(Ma,"g")))!==null&&_n$match!==void 0&&_n$match.forEach(function(e){if("..."===e)_this151.outputDims=_this151.outputDims.concat(_this151.ellipsisDims);else{var _t387=_this151.symbolToInfo.get(e);if(void 0===_t387)throw new Error("Invalid RHS symbol");_this151.outputDims.push(_t387.dimValue);}}),this.rhs=this.processTerm(n,!1,this.outputDims);}return _createClass2(za,[{key:"addSymbol",value:function addSymbol(e,t,r){var n=this.symbolToInfo.get(e);if(void 0!==n){if(n.dimValue!==t&&1!==n.count)throw new Error("Dimension mismatch");n.count++,n.inputIndices.push(r);}else n={count:1,dimValue:t,inputIndices:[r]};this.symbolToInfo.set(e,n);}},{key:"processTerm",value:function processTerm(e,t,r){var _this152=this;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:-1;var i=r.length,o=!1,a=[],s=0;if(!e.match(RegExp(ru))&&!t&&""!==e)throw new Error("Invalid LHS term");var u=e.match(RegExp(Ma,"g")),l=new Ua(n);return u!==null&&u!==void 0&&u.forEach(function(e,c){if("..."===e){if(o)throw new Error("Only one ellipsis is allowed per input term");o=!0;var _e904=i-u.length+1;if(_e904<0)throw new Error("Ellipsis out of bounds");if(a=r.slice(s,s+_e904),_this152.hasEllipsis){if(_this152.ellipsisDims.length!==a.length||_this152.ellipsisDims.toString()!==a.toString())throw new Error("Ellipsis dimensions mismatch");}else{if(!t)throw new Error("Ellipsis must be specified in the LHS");_this152.hasEllipsis=!0,_this152.ellipsisDims=a;}for(var _e905=0;_e905<a.length;_e905++){var _t388=String.fromCharCode("0".charCodeAt(0)+_e905);l.addSymbol(_t388,c+_e905),_this152.addSymbol(_t388,r[s++],n);}}else l.addSymbol(e,c+(_this152.hasEllipsis?_this152.ellipsisDims.length-1:0)),_this152.addSymbol(e,r[s++],n);}),l;}}]);}(),nu=function nu(e){return e+"_max";},Fc=function Fc(e,t,r,n,i){var o=t.map(function(t,r){return e[r]?t.length:t;}).map(function(e,t){return U("input".concat(t),r,e);}),a=ort_webgpu_min_N.size(i),s=De(i.length),u=s?i.length:i,l=ort_webgpu_min_j("output",r,u),c=_toConsumableArray2(n.symbolToInfo.keys()).filter(function(e){return!n.rhs.symbolToIndices.has(e);});return{name:"Einsum",shaderCache:{hint:n.equation,inputDependencies:e.map(function(e){return e?"rank":"dims";})},getRunData:function getRunData(){var o=c.filter(function(e){return n.symbolToInfo.has(e);}).map(function(e){var _n$symbolToInfo$get;return{type:"uint32",data:((_n$symbolToInfo$get=n.symbolToInfo.get(e))===null||_n$symbolToInfo$get===void 0?void 0:_n$symbolToInfo$get.dimValue)||0};});o.push({type:"uint32",data:a});var u=t.filter(function(t,r){return e[r];}).map(function(e,t){return _toConsumableArray2(F(e));}).reduce(function(e,t){return e.concat(t);},o);return s&&u.push.apply(u,_toConsumableArray2(F(i))),{outputs:[{dims:i,dataType:r}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:u};},getShaderSource:function getShaderSource(e){var _e$registerUniforms$r;var t=[],r=[],i=[],a=[],s=[],u=n.symbolToInfo.size===n.rhs.symbolToIndices.size;n.symbolToInfo.forEach(function(e,u){if(n.rhs.symbolToIndices.has(u)){var _n$rhs$symbolToIndice;var _r300=(_n$rhs$symbolToIndice=n.rhs.symbolToIndices.get(u))===null||_n$rhs$symbolToIndice===void 0?void 0:_n$rhs$symbolToIndice[0];void 0!==_r300&&n.lhs.forEach(function(n,i){if(e.inputIndices.includes(i)){var _e906=n.symbolToIndices.get(u);if(void 0===_e906)throw new Error("Invalid symbol error");_e906.forEach(function(e){t.push("".concat(o[i].indicesSet("input".concat(i,"Indices"),e,l.indicesGet("outputIndices",_r300))));});}});}else n.lhs.forEach(function(t,n){if(e.inputIndices.includes(n)){var _e907=t.symbolToIndices.get(u);if(void 0===_e907)throw new Error("Invalid symbol error");_e907.forEach(function(e){r.push("".concat(o[n].indicesSet("input".concat(n,"Indices"),e,"".concat(u))));}),s.push("prod *= ".concat(o[n].getByIndices("input".concat(n,"Indices")),";"));}}),i.push("for(var ".concat(u,": u32 = 0; ").concat(u," < uniforms.").concat(nu(u),"; ").concat(u,"++) {")),a.push("}");});var h=u?[].concat(t,["let sum = ".concat(o.map(function(e,t){return e.getByIndices("input".concat(t,"Indices"));}).join(" * "),";")]):[].concat(t,["var sum = 0.0;"],i,r,["var prod = 1.0;"],s,["sum += prod;"],a);return"\n            ".concat((_e$registerUniforms$r=e.registerUniforms(c.map(function(e){return{name:"".concat(nu(e)),type:"u32"};})).registerUniform("outputSize","u32")).declareVariables.apply(_e$registerUniforms$r,_toConsumableArray2(o).concat([l])),"\n\n            ").concat(e.mainStart(),"\n            ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n            var outputIndices = ").concat(l.offsetToIndices("global_idx"),";\n            ").concat(o.map(function(e,t){return"var input".concat(t,"Indices: ").concat(o[t].type.indices,";");}).join("\n"),"\n            ").concat(h.join("\n"),";\n            ").concat(l.setByOffset("global_idx","sum"),";\n          }");}};},au=function au(e,t){var r=new za(e.inputs,t.equation),n=e.inputs.map(function(e,t){return De(e.dims.length);}),i=r.outputDims,o=e.inputs.map(function(e,t){return e.dims;});e.compute(Fc(n,o,e.inputs[0].dataType,r,i));},iu=function iu(e){var t=e.equation.replace(/\s+/g,"");return ge({equation:t});};}),qc,su,jc,Kc,uu,lu=q(function(){Ne(),$e(),we(),qc=function qc(e){if(!e||2!==e.length)throw new Error("Expand requires 2 input.");var t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),n=r.length<t.length?0:r.length-t.length,i=t.length<r.length?0:t.length-r.length;for(;n<r.length&&i<t.length;++n,++i)if(r[n]!==t[i]&&1!==r[n]&&1!==t[i])throw new Error("Expand requires shape to be broadcastable to input");},su=function su(e,t){var r=e.length-t.length,n=[];for(var _t389=0;_t389<r;++_t389)n.push(e[_t389]);for(var i=0;i<t.length;++i)n.push(1===t[i]?e[i+r]:t[i]);return n;},jc=function jc(e,t){return e.length>t.length?su(e,t):su(t,e);},Kc=function Kc(e){var t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),n=jc(t,r),i=e[0].dataType,o=9===i?4:1,a=Math.ceil(ort_webgpu_min_N.size(n)/o),s=De(t.length),u=De(n.length),l=[{type:"uint32",data:a}];return s&&l.push.apply(l,_toConsumableArray2(F(t))),u&&l.push.apply(l,_toConsumableArray2(F(n))),{name:"Expand",shaderCache:{hint:"".concat(n.length),inputDependencies:[s?"rank":"dims"]},getShaderSource:function getShaderSource(e){var r,a=s?t.length:t,l=u?n.length:n,c=U("input",i,a,o),h=ort_webgpu_min_j("output",i,l,o);if(9===i){var _e908=function _e908(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";return"\n          let outputIndices".concat(t," = ").concat(h.offsetToIndices("outputOffset + ".concat(t,"u")),";\n          let offset").concat(t," = ").concat(c.broadcastedIndicesToOffset("outputIndices".concat(t),h),";\n          let index").concat(t," = offset").concat(t," / 4u;\n          let component").concat(t," = offset").concat(t," % 4u;\n          ").concat(e,"[").concat(t,"] = ").concat(r,"(").concat(c.getByOffset("index".concat(t)),"[component").concat(t,"]);\n        ");};r="\n        let outputOffset = global_idx * ".concat(o,";\n        var data = vec4<u32>(0);\n        ").concat(_e908("data",0,"u32"),"\n        ").concat(_e908("data",1,"u32"),"\n        ").concat(_e908("data",2,"u32"),"\n        ").concat(_e908("data",3,"u32"),"\n        ").concat(h.setByOffset("global_idx","data"),"\n      }");}else r="\n        let outputIndices = ".concat(h.offsetToIndices("global_idx"),";\n        let inputOffset = ").concat(c.broadcastedIndicesToOffset("outputIndices",h),";\n        ").concat(h.setByOffset("global_idx",c.getByOffset("inputOffset")),"\n      }");return"\n    ".concat(e.registerUniform("vec_size","u32").declareVariables(c,h),"\n    ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size"),"\n    ").concat(r);},getRunData:function getRunData(){return{outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:l};}};},uu=function uu(e){qc(e.inputs),e.compute(Kc(e.inputs),{inputs:[0]});};}),Yc,Zc,du,cu,pu=q(function(){Ne(),$e(),qe(),we(),Yc=function Yc(e){if(!e||2!==e.length)throw new Error("Gather requires 2 inputs.");},Zc=function Zc(e,t){var r=e[0].dims,n=e[1].dims,i=r.length,o=ort_webgpu_min_N.normalizeAxis(t.axis,i),a=r.slice(0);a.splice.apply(a,[o,1].concat(_toConsumableArray2(n)));var s=r[o],u=9===e[0].dataType?4:1,l=Math.ceil(ort_webgpu_min_N.size(a)/u),c=De(e[0].dims.length),h=c?e[0].dims.length:e[0].dims,f=De(e[1].dims.length),d=f?e[1].dims.length:e[1].dims,p=De(a.length),y=p?a.length:a,m=[{type:"uint32",data:l},{type:"int32",data:s},{type:"uint32",data:o}];c&&m.push.apply(m,_toConsumableArray2(F(e[0].dims))),f&&m.push.apply(m,_toConsumableArray2(F(e[1].dims))),p&&m.push.apply(m,_toConsumableArray2(F(a)));var g=[];g.push(c?"rank":"dims"),g.push(f?"rank":"dims");return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:g},getRunData:function getRunData(){return{outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:m};},getShaderSource:function getShaderSource(t){var r,s=U("data",e[0].dataType,h,u),l=U("inputIndices",e[1].dataType,d),c=ort_webgpu_min_j("output",e[0].dataType,y,u),f=function f(e){var t=n.length,r="var indicesIndices".concat(e,"  = ").concat(l.type.indices,"(0);");for(var _n209=0;_n209<t;_n209++)r+="".concat(t>1?"indicesIndices".concat(e,"[").concat(_n209,"]"):"indicesIndices".concat(e)," = ").concat(a.length>1?"outputIndices".concat(e,"[uniforms.axis + ").concat(_n209,"]"):"outputIndices".concat(e),";");r+="\n          var idx".concat(e," = ").concat(l.getByIndices("indicesIndices".concat(e)),";\n          if (idx").concat(e," < 0) {\n            idx").concat(e," = idx").concat(e," + uniforms.axisDimLimit;\n          }\n          var dataIndices").concat(e," = ").concat(s.type.indices,"(0);\n        ");for(var _n210=0,_s67=0;_n210<i;_n210++)_n210===o?(r+="".concat(i>1?"dataIndices".concat(e,"[").concat(_n210,"]"):"dataIndices".concat(e)," = u32(idx").concat(e,");"),_s67+=t):(r+="".concat(i>1?"dataIndices".concat(e,"[").concat(_n210,"]"):"dataIndices".concat(e)," = ").concat(a.length>1?"outputIndices".concat(e,"[").concat(_s67,"]"):"outputIndices".concat(e),";"),_s67++);return r;};if(9===e[0].dataType){var _e909=function _e909(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";return"\n          let outputIndices".concat(t," = ").concat(c.offsetToIndices("outputOffset + ".concat(t,"u")),";\n          ").concat(f(t),";\n          let offset").concat(t," = ").concat(s.indicesToOffset("dataIndices".concat(t)),";\n          let index").concat(t," = offset").concat(t," / 4u;\n          let component").concat(t," = offset").concat(t," % 4u;\n          ").concat(e,"[").concat(t,"] = ").concat(r,"(").concat(s.getByOffset("index".concat(t)),"[component").concat(t,"]);\n        ");};r="\n        let outputOffset = global_idx * ".concat(u,";\n        var value = vec4<u32>(0);\n        ").concat(_e909("value",0,"u32"),"\n        ").concat(_e909("value",1,"u32"),"\n        ").concat(_e909("value",2,"u32"),"\n        ").concat(_e909("value",3,"u32"),"\n        ").concat(c.setByOffset("global_idx","value"),"\n      ");}else r="\n      let outputIndices = ".concat(c.offsetToIndices("global_idx"),";\n      ").concat(f(""),";\n      let value = ").concat(s.getByIndices("dataIndices"),";\n      ").concat(c.setByOffset("global_idx","value"),";\n      ");return"\n      ".concat(t.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(s,l,c),"\n      ").concat(t.mainStart(),"\n        ").concat(t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n        ").concat(r,"\n      }");}};},du=function du(e){return ge({axis:e.axis});},cu=function cu(e,t){var r=e.inputs;Yc(r),e.compute(Zc(e.inputs,t));};}),Xc,Jc,mu,fu,hu=q(function(){$e(),qe(),we(),Xc=function Xc(e){if(!e||2!==e.length)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error("GatherElements requires that the data input and\n                     indices input tensors be of same rank.");},Jc=function Jc(e,t){var r=e[0].dims,n=e[0].dataType,i=r.length,o=e[1].dims,a=e[1].dataType,s=ort_webgpu_min_N.normalizeAxis(t.axis,i),u=r[s],l=o.slice(0),c=ort_webgpu_min_N.size(l),h=U("input",n,i),f=U("indicesInput",a,o.length),d=ort_webgpu_min_j("output",n,l.length),p=[{type:"uint32",data:c},{type:"int32",data:u},{type:"uint32",data:s}];return p.push.apply(p,_toConsumableArray2(F(r))),p.push.apply(p,_toConsumableArray2(F(o))),p.push.apply(p,_toConsumableArray2(F(l))),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:function getRunData(){return{outputs:[{dims:l,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:p};},getShaderSource:function getShaderSource(e){return"\n      ".concat(e.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(h,f,d),"\n      ").concat(e.mainStart(),"\n      ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n\n      let outputIndices = ").concat(d.offsetToIndices("global_idx"),";\n\n      var idx = ").concat(f.getByOffset("global_idx"),";\n      if (idx < 0) {\n        idx = idx + uniforms.axisDimLimit;\n      }\n      var inputIndices = ").concat(h.type.indices,"(outputIndices);\n      ").concat(h.indicesSet("inputIndices","uniforms.axis","u32(idx)"),";\n      let value = ").concat(h.getByIndices("inputIndices"),";\n\n      ").concat(d.setByOffset("global_idx","value"),";\n  }");}};},mu=function mu(e){return ge({axis:e.axis});},fu=function fu(e,t){var r=e.inputs;Xc(r),e.compute(Jc(e.inputs,t));};}),Qc,ep,gu,yu,bu=q(function(){$e(),we(),Qc=function Qc(e){if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(3===e.length&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||3===e.length&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched");},ep=function ep(e,t){var r=e[0].dims.slice(),n=e[1].dims.slice(),_bn$getShapeOfGemmRes=bn.getShapeOfGemmResult(r,t.transA,n,t.transB,3===e.length?e[2].dims:void 0),_bn$getShapeOfGemmRes2=_slicedToArray2(_bn$getShapeOfGemmRes,3),i=_bn$getShapeOfGemmRes2[0],o=_bn$getShapeOfGemmRes2[1],a=_bn$getShapeOfGemmRes2[2],s=[i,o];if(!s)throw new Error("Can't use gemm on the given tensors");var u=ort_webgpu_min_N.size(s),l=[{type:"uint32",data:u},{type:"uint32",data:i},{type:"uint32",data:o},{type:"uint32",data:a},{type:"float32",data:t.alpha},{type:"float32",data:t.beta}],c=["type","type"];3===e.length&&(l.push.apply(l,_toConsumableArray2(F(e[2].dims))),c.push("rank")),l.push.apply(l,_toConsumableArray2(F(s)));return{name:"Gemm",shaderCache:{hint:"".concat(t.cacheKey),inputDependencies:c},getRunData:function getRunData(){return{outputs:[{dims:s,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:l};},getShaderSource:function getShaderSource(r){var _r$registerUniforms;var n="";t.transA&&t.transB?n="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?n="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?n="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!t.transA&&!t.transB&&(n="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");var i=1===t.alpha?"":"value *= uniforms.alpha;",o=U("a",e[0].dataType,e[0].dims),a=U("b",e[1].dataType,e[1].dims),u=o.type.value,l=null,c=[o,a];3===e.length&&(l=U("c",e[2].dataType,e[2].dims.length),c.push(l));var h=ort_webgpu_min_j("output",e[0].dataType,s.length);c.push(h);return"\n  ".concat((_r$registerUniforms=r.registerUniforms([{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}])).declareVariables.apply(_r$registerUniforms,c),"\n\n  ").concat(r.mainStart(),"\n    ").concat(r.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n\n    let m = global_idx / uniforms.N;\n    let n = global_idx % uniforms.N;\n\n    var value = ").concat(u,"(0);\n    for (var k: u32 = 0u; k < uniforms.K; k++) {\n      ").concat(n,"\n    }\n\n    ").concat(i,"\n    ").concat(null!=l?"let cOffset = ".concat(l.broadcastedIndicesToOffset("vec2(m, n)",h),"; value += ").concat(u,"(uniforms.beta) * ").concat(l.getByOffset("cOffset"),";"):"","\n    output[global_idx] = value;\n  }");}};},gu=function gu(e){return{transA:e.transA,transB:e.transB,alpha:e.alpha,beta:e.beta,cacheKey:"".concat(e.transA,";").concat(e.transB,";").concat(1===e.alpha)};},yu=function yu(e,t){Qc(e.inputs),e.compute(ep(e.inputs,t));};}),tp,rp,np,wu,vu=q(function(){Ne(),$e(),we(),tp=function tp(e,t){var r=e[0].dims,n=r,i=ort_webgpu_min_N.sizeToDimension(r,2),o=ort_webgpu_min_N.sizeFromDimension(r,2),a=Fe(o),s=o/a,u=[r[0],r[1],s],l=[{type:"uint32",data:o},{type:"uint32",data:s}];l.push.apply(l,_toConsumableArray2(F(u)).concat(_toConsumableArray2(F(u))));return{name:"InstanceNormalization",shaderCache:{hint:"".concat(t.epsilon,";").concat(a),inputDependencies:["rank","type","type"]},getRunData:function getRunData(){return{outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:i},programUniforms:l};},getShaderSource:function getShaderSource(r){var _r$registerUniforms2;var n=U("x",e[0].dataType,u.length,a),i=U("scale",e[1].dataType,e[1].dims),o=U("bias",e[2].dataType,e[2].dims),s=ort_webgpu_min_j("output",e[0].dataType,u.length,a),l=[n,i,o,s],c=n.type.value,h=1===a?"f32":"vec".concat(a,"<f32>");return"\n  var<workgroup> meanShared : f32;\n  var<workgroup> squaredNormShared : f32;\n  var<workgroup> workgroupShared : array<".concat(h,", 64>;\n  const workgroupSize = 64u;\n  ").concat((_r$registerUniforms2=r.registerUniforms([{name:"normSize",type:"u32"},{name:"normPackedSize",type:"u32"}])).declareVariables.apply(_r$registerUniforms2,l),"\n  ").concat(r.mainStart(64),"\n    let norm = global_idx / workgroupSize;\n    let batch = norm / uniforms.x_shape[1];\n    let channel = norm % uniforms.x_shape[1];\n    let localIndex = local_id.x;\n\n    // initialize workgroup memory\n    var initial = ").concat(h,"(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      initial = initial + ").concat(h,"(").concat(n.get("batch","channel","h"),");\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the mean of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      meanShared = ").concat(at("workgroupShared[0]",a)," / f32(uniforms.normSize);\n    }\n    workgroupBarrier();\n\n    // reinitialize workgroup memory.\n    initial = ").concat(h,"(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let deviation =  ").concat(h,"(").concat(n.get("batch","channel","h"),") - ").concat(h,"(meanShared);\n      initial = initial + deviation * deviation;\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the sum of square of deviation of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      squaredNormShared = ").concat(at("workgroupShared[0]",a),";\n    }\n    workgroupBarrier();\n\n    let invStdDev = inverseSqrt(squaredNormShared / f32(uniforms.normSize) + f32(").concat(t.epsilon,"));\n    let channelScale = invStdDev * f32(").concat(i.getByOffset("channel"),");\n    let channelShift = f32(").concat(o.getByOffset("channel"),") - meanShared * channelScale;\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let value = ").concat(n.get("batch","channel","h")," * ").concat(c,"(").concat(h,"(channelScale)) + ").concat(c,"(").concat(h,"(channelShift));\n      ").concat(s.set("batch","channel","h","value"),";\n    }\n  }");}};},rp=function rp(e,t,r,n,i,o,a,s){var u=Fe(a),l=64,c=1===u?"vec2f":"mat2x".concat(u,"f"),h=1===u?"f32":"vec".concat(u,"f"),f=function f(e,t){return"".concat(c,"(").concat(e,", ").concat(t,")");},d=i*a/u,p=[{type:"uint32",data:Math.ceil(o/l)},{type:"uint32",data:o},{type:"uint32",data:Math.floor(a/u)},{type:"uint32",data:Math.floor(o*a/u)}],y=e.compute({name:"InstanceNormComputeMean",shaderCache:{hint:"".concat(u),inputDependencies:["type"]},getRunData:function getRunData(){return{outputs:[{dims:[i,a,l,2],dataType:1}],dispatchGroup:{x:i*a/u},programUniforms:p};},getShaderSource:function getShaderSource(e){var r=U("input",t.dataType,t.dims,u);return"\n  ".concat(e.declareVariables(r),"\n  @group(0) @binding(1) var<storage, read_write> output : array<").concat(c,">;\n  struct Uniforms {wg_size:u32, H:u32, C:u32, image_size:u32};\n  @group(0) @binding(2) var<uniform> uniforms: Uniforms;\n\n  ").concat(e.mainStart(l),"\n    let currentImageNumber = global_idx / 64 / uniforms.C;\n    let currentChannelNumber = (global_idx / 64) % uniforms.C;\n    let wgId = global_idx % 64;\n    let wgOffset = wgId * uniforms.wg_size;\n    if (wgOffset >= uniforms.H) {\n        return;\n    }\n    let wgMax = min(wgOffset + uniforms.wg_size, uniforms.H);\n\n    let offset = currentImageNumber * uniforms.image_size + currentChannelNumber;\n    var sum = ").concat(Je("f32",u),";\n    var squaredSum = ").concat(Je("f32",u),";\n    for (var i: u32 = wgOffset; i < wgMax; i++) {\n        let value = ").concat(h,"(input[offset + i * uniforms.C]);\n        sum += value;\n        squaredSum += value * value;\n    }\n    output[global_idx] = ").concat(f("sum","squaredSum"),";\n  }");}},{inputs:[t],outputs:[-1]})[0],m=[{type:"uint32",data:d},{type:"uint32",data:o},{type:"uint32",data:Math.floor(a/u)},{type:"uint32",data:Math.floor(l*a/u)}];return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:"".concat(u,";").concat(s),inputDependencies:["type","type","type"]},getRunData:function getRunData(){return{outputs:[{dims:[i,a,2],dataType:1}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:m};},getShaderSource:function getShaderSource(e){var t=U("scale",r.dataType,r.dims,u),i=U("bias",n.dataType,n.dims,u);return"\n  @group(0) @binding(0) var<storage, read> input : array<".concat(c,">;\n  @group(0) @binding(1) var<storage, read> scale : array<").concat(t.type.storage,">;\n  @group(0) @binding(2) var<storage, read> bias : array<").concat(i.type.storage,">;\n  @group(0) @binding(3) var<storage, read_write> output : array<").concat(c,">;\n  struct Uniforms {units_of_work : u32, H: u32, C : u32, image_size : u32};\n  @group(0) @binding(4) var<uniform> uniforms: Uniforms;\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.units_of_work"),"\n    let currentImageNumber = global_idx / uniforms.C;\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let offset = currentImageNumber * uniforms.image_size;\n    var sum = ").concat(Je("f32",u),";\n    var squaredSum = ").concat(Je("f32",u),";\n    for (var i: u32 = 0; i < 64; i++) {\n        let value = input[offset + i + currentChannelNumber * 64];\n        sum += value[0];\n        squaredSum += value[1];\n    }\n    sum = sum / f32(uniforms.H);\n    squaredSum = squaredSum / f32(uniforms.H);\n    let invStdDev = inverseSqrt(squaredSum - sum * sum + f32(").concat(s,"));\n    let channelScale = invStdDev * ").concat(h,"(scale[currentChannelNumber]);\n    let channelShift = ").concat(h,"(bias[currentChannelNumber]) - sum * channelScale;\n\n    output[global_idx] = ").concat(f("channelScale","channelShift"),";\n  }");}},{inputs:[y,r,n],outputs:[-1]})[0];},np=function np(e,t,r){var n=t[0].dims,i=n,o=n[0],a=n[n.length-1],s=ort_webgpu_min_N.sizeFromDimension(n,1)/a,u=Fe(a),l=ort_webgpu_min_N.size(i)/u,c=[{type:"uint32",data:s},{type:"uint32",data:Math.floor(a/u)}],h=rp(e,t[0],t[1],t[2],o,s,a,r.epsilon);e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:"".concat(u),inputDependencies:["type","type"]},getRunData:function getRunData(){return{outputs:[{dims:i,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:c};},getShaderSource:function getShaderSource(e){var r=Le(t[0].dataType),n=1===u?"vec2f":"mat2x".concat(u,"f"),o=1===u?r:"vec".concat(u,"<").concat(r,">"),a=U("input",t[0].dataType,t[0].dims,u),s=ort_webgpu_min_j("output",t[0].dataType,i,u);return"\n  @group(0) @binding(0) var<storage, read> input : array<".concat(a.type.storage,">;\n  @group(0) @binding(1) var<storage, read> scaleInput : array<").concat(n,">;\n  @group(0) @binding(2) var<storage, read_write> output : array<").concat(s.type.storage,">;\n  struct Uniforms {H: u32, C : u32};\n  @group(0) @binding(3) var<uniform> uniforms: Uniforms;\n\n  ").concat(e.mainStart(),"\n    let currentImageNumber = global_idx / (uniforms.C * uniforms.H);\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let scaleOffset = currentImageNumber * uniforms.C + currentChannelNumber;\n    let scale = scaleInput[scaleOffset];\n    output[global_idx] = fma(input[global_idx], ").concat(o,"(scale[0]), ").concat(o,"(scale[1]));\n  }");}},{inputs:[t[0],h]});},wu=function wu(e,t){"NHWC"===t.format?np(e,e.inputs,t):e.compute(tp(e.inputs,t));};}),ap,ip,$u,_u=q(function(){Ne(),$e(),we(),ap=function ap(e){if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.");},ip=function ip(e,t,r){var n=e[0].dims,i=e[1],o=e[2],a=n,s=ort_webgpu_min_N.normalizeAxis(t.axis,n.length),u=ort_webgpu_min_N.sizeToDimension(n,s),l=ort_webgpu_min_N.sizeFromDimension(n,s),c=ort_webgpu_min_N.size(i.dims),h=o?ort_webgpu_min_N.size(o.dims):0;if(c!==l||o&&h!==l)throw new Error("Size of X.shape()[axis:] == ".concat(l,".\n       Size of scale and bias (if provided) must match this.\n       Got scale size of ").concat(c," and bias size of ").concat(h));var f=[];for(var _e910=0;_e910<n.length;++_e910)_e910<s?f.push(n[_e910]):f.push(1);var d=Fe(l),p=["type","type"],y=[{type:"uint32",data:u},{type:"float32",data:l},{type:"uint32",data:Math.floor(l/d)},{type:"float32",data:t.epsilon}];o&&p.push("type");var m=r>1,g=r>2,w=[{dims:a,dataType:e[0].dataType}];return m&&w.push({dims:f,dataType:1}),g&&w.push({dims:f,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:"".concat(d,";").concat(r),inputDependencies:p},getRunData:function getRunData(){return{outputs:w,dispatchGroup:{x:Math.ceil(u/64)},programUniforms:y};},getShaderSource:function getShaderSource(t){var _t$registerUniforms;var r=Le(e[0].dataType),n=[U("x",e[0].dataType,e[0].dims,d),U("scale",i.dataType,i.dims,d)];o&&n.push(U("bias",o.dataType,o.dims,d)),n.push(ort_webgpu_min_j("output",e[0].dataType,a,d)),m&&n.push(ort_webgpu_min_j("mean_data_output",1,f)),g&&n.push(ort_webgpu_min_j("inv_std_output",1,f));return"\n  ".concat((_t$registerUniforms=t.registerUniforms([{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}])).declareVariables.apply(_t$registerUniforms,n),"\n  ").concat(t.mainStart(),"\n    ").concat(t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count"),"\n    let offset = global_idx * uniforms.norm_size_vectorized;\n    var meanVector = ").concat(Je("f32",d),";\n    var meanSquareVector = ").concat(Je("f32",d),";\n\n    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {\n      let value = ").concat(mt(r,d,"x[h + offset]"),";\n      meanVector += value;\n      meanSquareVector += value * value;\n    }\n    let mean = ").concat(at("meanVector",d)," / uniforms.norm_size;\n    let invStdDev =\n        inverseSqrt(").concat(at("meanSquareVector",d)," / uniforms.norm_size - mean * mean + uniforms.epsilon);\n\n    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {\n      let f32input = ").concat(mt(r,d,"x[j + offset]"),";\n      let f32scale = ").concat(mt(r,d,"scale[j]"),";\n      output[j + offset] = ").concat(n[0].type.value,"((f32input - mean) * invStdDev * f32scale\n        ").concat(o?"+ ".concat(mt(r,d,"bias[j]")):"","\n      );\n    }\n\n    ").concat(m?"mean_data_output[global_idx] = mean":"",";\n    ").concat(g?"inv_std_output[global_idx] = invStdDev":"",";\n  }");}};},$u=function $u(e,t){ap(e.inputs),e.compute(ip(e.inputs,t,e.outputCount));};}),op,Su,xu,sp,Na,Iu,Cu=q(function(){$e(),qe(),gn(),Ia(),we(),pr(),op=function op(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7];if(3!==r.dims.length&&5!==r.dims.length)throw new Error("Input query is expected to have 3 or 5 dimensions");var c,h=r.dims[0],f=r.dims[1],d=3===r.dims.length?r.dims[2]:t.numHeads*r.dims[4],p=f,y=0,m=0,g=Math.floor(d/t.numHeads);if(u&&l){if(4!==u.dims.length)throw new Error('Input "past_key" is expected to have 4 dimensions');if(4!==l.dims.length)throw new Error('Input "past_value" is expected to have 4 dimensions');y=u.dims[2],m=u.dims[2];}else if(u||l)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');if(n){if(3!==r.dims.length)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(n.dims.length<3||n.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(r.dims[0]!==n.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(3===n.dims.length){if(n.dims[2]!==r.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');c=2,p=n.dims[1];}else if(5===n.dims.length){if(n.dims[2]!==t.numHeads||2!==n.dims[3]||n.dims[4]!==g)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(i)throw new Error('Expect "value" be none when "key" has packed kv format.');c=5,p=n.dims[1];}else{if(n.dims[1]!==t.numHeads||n.dims[3]!==g)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');c=0,p=n.dims[2];}}else{if(3!==r.dims.length&&5!==r.dims.length)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(5===r.dims.length&&(r.dims[2]!==t.numHeads||3!==r.dims[3]))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');c=3;}if(o){if(1!==o.dims.length)throw new Error('Input "bias" is expected to have 1 dimension');if(i&&5===r.dims.length&&2===r.dims[3])throw new Error("bias is not allowed for packed kv.");}var w=0;if(a){w=8;var _e911=a.dims;throw 1===_e911.length?_e911[0]===h?w=1:_e911[0]===3*h+2&&(w=3):2===_e911.length&&_e911[0]===h&&_e911[1]===p&&(w=5),8===w?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, kv_sequence_length)'):new Error("Mask not supported");}var b=!1,v=d;if(i){if(3!==i.dims.length&&4!==i.dims.length)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(r.dims[0]!==i.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(3===i.dims.length){if(p!==i.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');v=i.dims[2];}else{if(p!==i.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');v=i.dims[1]*i.dims[3],b=!0;}}var x=y+p;if(a)throw new Error("Key padding mask is not supported");if(s)throw new Error("extraAddQk is not supported");if(u)throw new Error("pastKey is not supported");if(l)throw new Error("pastValue is not supported");return{batchSize:h,sequenceLength:f,pastSequenceLength:y,kvSequenceLength:p,totalSequenceLength:x,maxSequenceLength:m,inputHiddenSize:0,hiddenSize:d,vHiddenSize:v,headSize:g,vHeadSize:Math.floor(v/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:w,scale:t.scale,broadcastResPosBias:!1,passPastInKv:b,qkvFormat:c};},Su=function Su(e){return ge(_objectSpread({},e));},xu=ge({perm:[0,2,1,3]}),sp=function sp(e,t,r,n,i,o,a){var s=[n,i,o],u=ort_webgpu_min_N.size(s),l=[{type:"uint32",data:u},{type:"uint32",data:a},{type:"uint32",data:o}];return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:function getRunData(){return{outputs:[{dims:s,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:l};},getShaderSource:function getShaderSource(e){var n=ort_webgpu_min_j("qkv_with_bias",t.dataType,s),i=U("qkv",t.dataType,s),o=U("bias",r.dataType,s);return"\n  ".concat(e.registerUniforms([{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}]).declareVariables(i,o,n),"\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;\n\n    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];\n  }");}},{inputs:[t,r],outputs:[-1]})[0];},Na=function Na(e,t,r,n,i,o,a,s){var u=o;if(a){if(1===n)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return u=sp(e,o,a,t,n,r*i,s),u=u.reshape([t,n,r,i]),e.compute(ft(u,xu.perm),{inputs:[u],outputs:[-1]})[0];}return 3===o.dims.length&&(u=o.reshape([t,n,r,i])),e.compute(ft(u,xu.perm),{inputs:[u],outputs:[-1]})[0];},Iu=function Iu(e,t){var _e$inputs$;var r=op(e.inputs,t);if(5===e.inputs[0].dims.length)throw new Error("Packed QKV is not implemented");if(5===((_e$inputs$=e.inputs[1])===null||_e$inputs$===void 0?void 0:_e$inputs$.dims.length))throw new Error("Packed KV is not implemented");var n=e.inputs[1]&&e.inputs[2]&&4===e.inputs[1].dims.length&&4===e.inputs[2].dims.length,i=Na(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,e.inputs[0],e.inputs[3],0);if(n)return Sn(e,i,e.inputs[1],e.inputs[2],e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t);var o=Na(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.headSize,e.inputs[1],e.inputs[3],r.hiddenSize),a=Na(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.vHeadSize,e.inputs[2],e.inputs[3],2*r.hiddenSize);Sn(e,i,o,a,e.inputs[4],void 0,e.inputs[6],e.inputs[7],e.inputs[5],r,t);};}),up,lp,dp,cp,pp,mp,fp,hp,Au,Tu=q(function(){Ne(),$e(),we(),up=function up(e){if(!e||e.length<1)throw new Error("Too few inputs");if(1!==e[0].dataType)throw new Error("Input type must be float.");if(e.length>=2){var _t390=2*e[0].dims.length===e[1].dims[0];if(4===e.length&&(_t390=2*e[3].dims[0]===e[1].dims[0]),!_t390)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].");}},lp=function lp(e,t,r){var n="";for(var i=t-1;i>=0;--i)n+="\n            k = i32(".concat(e.indicesGet("indices",i),") - ").concat(de("uniforms.pads",i,r),";\n            if (k < 0) {\n              break;\n            }\n            if (k >= i32(").concat(de("uniforms.x_shape",i,t),")) {\n              break;\n            }\n            offset += k * i32(").concat(de("uniforms.x_strides",i,t),");\n        ");return"\n          value = ".concat(e.type.value,"(uniforms.constant_value);\n          for (var i = 0; i < 1; i++) {\n            var offset = 0;\n            var k = 0;\n            ").concat(n,"\n            value = x[offset];\n          }\n      ");},dp=function dp(e,t,r){var n="";for(var i=t-1;i>=0;--i)n+="\n                k = i32(".concat(e.indicesGet("indices",i),") - ").concat(de("uniforms.pads",i,r),";\n                if (k < 0) {\n                  k = -k;\n                }\n                {\n                  let _2n_1 = 2 * (i32(").concat(de("uniforms.x_shape",i,t),") - 1);\n                  k = k % _2n_1;\n                  if(k >= i32(").concat(de("uniforms.x_shape",i,t),")) {\n                    k = _2n_1 - k;\n                  }\n                }\n                offset += k * i32(").concat(de("uniforms.x_strides",i,t),");\n            ");return"\n              var offset = 0;\n              var k = 0;\n              ".concat(n,"\n              value = x[offset];\n          ");},cp=function cp(e,t,r){var n="";for(var i=t-1;i>=0;--i)n+="\n                k = i32(".concat(e.indicesGet("indices",i),") - ").concat(de("uniforms.pads",i,r),";\n                if (k < 0) {\n                  k = 0;\n                }\n                if (k >= i32(").concat(de("uniforms.x_shape",i,t),")) {\n                  k = i32(").concat(de("uniforms.x_shape",i,t),") - 1;\n                }\n                offset += k * i32(").concat(de("uniforms.x_strides",i,t),");\n            ");return"\n              var offset = 0;\n              var k = 0;\n              ".concat(n,"\n              value = x[offset];\n          ");},pp=function pp(e,t,r){var n="";for(var i=t-1;i>=0;--i)n+="\n                k = i32(".concat(e.indicesGet("indices",i),") - ").concat(de("uniforms.pads",i,r),";\n                if (k < 0)  {\n                  k += i32(").concat(de("uniforms.x_shape",i,t),"]);\n                }\n                if (k >= i32(").concat(de("uniforms.x_shape",i,t),")) {\n                  k -= i32(").concat(de("uniforms.x_shape",i,t),");\n                }\n                offset += k * i32(").concat(de("uniforms.x_strides",i,t),");\n            ");return"\n              var offset = 0;\n              var k = 0;\n              ".concat(n,"\n              value = x[offset];\n          ");},mp=function mp(e,t,r){switch(r.mode){case 0:return lp(e,t,r.pads.length);case 1:return dp(e,t,r.pads.length);case 2:return cp(e,t,r.pads.length);case 3:return pp(e,t,r.pads.length);default:throw new Error("Invalid mode");}},fp=function fp(e,t){var r=ort_webgpu_min_N.padShape(e[0].dims.slice(),t.pads),n=e[0].dims,i=[{type:"uint32",data:ort_webgpu_min_N.size(r)},{type:"uint32",data:t.pads}];if(0===t.mode){var _r301=nt(e[0].dataType);i.push({type:_r301,data:t.value});}i.push.apply(i,_toConsumableArray2(F(e[0].dims)).concat(_toConsumableArray2(F(r))));return{name:"Pad",shaderCache:{hint:"".concat(t.mode),inputDependencies:["rank"]},getRunData:function getRunData(){return{outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(ort_webgpu_min_N.size(r)/64)},programUniforms:i};},getShaderSource:function getShaderSource(i){var o=ort_webgpu_min_j("output",e[0].dataType,r.length),a=U("x",e[0].dataType,n.length),s=a.type.value,u=mp(o,n.length,t),l=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return 0===t.mode&&l.push({name:"constant_value",type:s}),"\n            ".concat(i.registerUniforms(l).declareVariables(a,o),"\n            ").concat(i.mainStart(),"\n            ").concat(i.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n\n            let indices = ").concat(o.offsetToIndices("global_idx"),";\n\n            var value = ").concat(s,"(0);\n            ").concat(u,"\n            output[global_idx] = value;\n        }");}};},hp=function hp(e,t){if(e.length>1){var r=e[1].getBigInt64Array(),n=e.length>=3&&e[2].data?e[2].getFloat32Array()[0]:0,i=e[0].dims.length,_o120=new Int32Array(2*i).fill(0);if(e.length>=4){var _t391=e[3].getBigInt64Array();for(var _e912=0;_e912<_t391.length;_e912++)_o120[Number(_t391[_e912])]=Number(r[_e912]),_o120[Number(_t391[_e912])+i]=Number(r[_e912+_t391.length]);}else r.forEach(function(e,t){return _o120[Number(t)]=Number(e);});var _a90=[];return _o120.forEach(function(e){return _a90.push(e);}),{mode:t.mode,value:n,pads:_a90};}return t;},Au=function Au(e,t){up(e.inputs);var r=hp(e.inputs,t);e.compute(fp(e.inputs,r),{inputs:[0]});};}),Pn,Eu,Ou,ku,Bu,gp,yp,Pu,Ru,Du,Mu,Uu,zu,Nu,Vu,Wu,Gu,Hu,Lu,Fu=q(function(){dt(),$e(),we(),Pn=function Pn(e){if(Se.webgpu.validateInputContent&&(!e||1!==e.length))throw new Error("Pool ops requires 1 input.");},Eu=function Eu(e,t,r){var n="NHWC"===t.format,i=e.dims.slice();n&&i.splice(1,0,i.pop());var o=Object.hasOwnProperty.call(t,"dilations"),a=t.kernelShape.slice(),s=t.strides.slice(),u=o?t.dilations.slice():[],l=t.pads.slice();Kt.adjustPoolAttributes(r,i,a,s,u,l);var c=Kt.computePoolOutputShape(r,i,s,u,a,l,t.autoPad),h=Object.assign({},t);o?Object.assign(h,{kernelShape:a,strides:s,pads:l,dilations:u,cacheKey:t.cacheKey}):Object.assign(h,{kernelShape:a,strides:s,pads:l,cacheKey:t.cacheKey});var f=c.slice();return f.push(f.splice(1,1)[0]),[h,n?f:c];},Ou=function Ou(e,t){var r="NHWC"===t.format,n=[{type:"uint32",data:ort_webgpu_min_N.size(e)},{type:"uint32",data:ort_webgpu_min_N.size(t.kernelShape)}],i=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){var _e913=t.kernelShape[t.kernelShape.length-1],_r302=t.strides[t.strides.length-1],_o121=t.pads[t.pads.length/2-1],_a91=t.pads[t.pads.length-1],_s68=!!(_o121+_a91);n.push({type:"uint32",data:_e913},{type:"uint32",data:_r302},{type:"uint32",data:_o121},{type:"uint32",data:_a91}),i.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});var _u51=!1;if(2===t.kernelShape.length){var _e914=t.kernelShape[t.kernelShape.length-2],_r303=t.strides[t.strides.length-2],_o122=t.pads[t.pads.length/2-2],_a92=t.pads[t.pads.length-2];_u51=!!(_o122+_a92),n.push({type:"uint32",data:_e914},{type:"uint32",data:_r303},{type:"uint32",data:_o122},{type:"uint32",data:_a92}),i.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"});}return[n,i,!0,_s68,_u51];}{if(r)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");var _e915=ort_webgpu_min_N.computeStrides(t.kernelShape);n.push({type:"uint32",data:_e915},{type:"uint32",data:t.pads},{type:"uint32",data:t.strides}),i.push({name:"kernelStrides",type:"u32",length:_e915.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length});var _o123=t.pads.reduce(function(e,t){return e+t;});return[n,i,!!_o123,!1,!1];}},ku=function ku(e,t,r,n,i,o,a,s,u,l,c,h){var f="NHWC"===i.format,d=t.type.value,p=ort_webgpu_min_j("output",t.type.tensor,n);if(i.kernelShape.length<=2){var _n211="",_l37="",_y12="",_m11=r-(f?2:1);if(_n211=c?"\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[".concat(_m11,"] = indices[").concat(_m11,"] * uniforms.sw - uniforms.pwStart + i;\n                  if (xIndices[").concat(_m11,"] < 0 || xIndices[").concat(_m11,"]\n                      >= uniforms.x_shape[").concat(_m11,"]) {\n                    pad++;\n                    continue;\n                  }\n                  let x_val = x[").concat(t.indicesToOffset("xIndices"),"];\n                  ").concat(o,"\n                }"):"\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[".concat(_m11,"] = indices[").concat(_m11,"] * uniforms.sw - uniforms.pwStart + i;\n                  let x_val = x[").concat(t.indicesToOffset("xIndices"),"];\n                  ").concat(o,"\n                }"),2===i.kernelShape.length){var _e916=r-(f?3:2);_l37=h?"\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[".concat(_e916,"] = indices[").concat(_e916,"] * uniforms.sh - uniforms.phStart + j;\n                  if (xIndices[").concat(_e916,"] < 0 || xIndices[").concat(_e916,"] >= uniforms.x_shape[").concat(_e916,"]) {\n                    pad += i32(uniforms.kw);\n                    continue;\n                  }\n              "):"\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[".concat(_e916,"] = indices[").concat(_e916,"] * uniforms.sh - uniforms.phStart + j;\n                "),_y12="\n              }\n            ";}return"\n            ".concat(e.registerUniforms(u).declareVariables(t,p),"\n\n            ").concat(e.mainStart(),"\n              ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n\n              let indices = ").concat(p.offsetToIndices("global_idx"),";\n              var xIndices = ").concat(p.offsetToIndices("global_idx"),";\n\n              var value = ").concat(d,"(").concat(s,");\n              var pad = 0;\n              ").concat(_l37,"\n              ").concat(_n211,"\n              ").concat(_y12,"\n              ").concat(a,"\n\n              output[global_idx] = value;\n            }");}{if(f)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");var _n212=i.kernelShape.length,_c35=i.pads.length,_h29="";return _h29=l?"\n                if (xIndices[j] >= uniforms.x_shape[j]) {\n                  pad++;\n                  isPad = true;\n                  break;\n                }\n              }\n              if (!isPad) {\n                let x_val = x[".concat(t.indicesToOffset("xIndices"),"];\n                ").concat(o,"\n              }"):"\n              }\n              let x_val = x[".concat(t.indicesToOffset("xIndices"),"];\n              ").concat(o,"\n            "),"\n            ".concat(e.registerUniforms(u).declareVariables(t,p),"\n\n            ").concat(e.mainStart(),"\n              ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n              let indices = ").concat(p.offsetToIndices("global_idx"),";\n              var xIndices = ").concat(p.offsetToIndices("global_idx"),";\n\n              var offsets: array<u32, ").concat(_n212,">;\n\n              var value = ").concat(d,"(").concat(s,");\n              var pad = 0;\n              var isPad = false;\n\n              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {\n                var offset = i;\n                for (var j = 0u; j < ").concat(_n212-1,"u; j++) {\n                  offsets[j] = offset / ").concat(de("uniforms.kernelStrides","j",_n212),";\n                  offset -= offsets[j] * ").concat(de("uniforms.kernelStrides","j",_n212),";\n                }\n                offsets[").concat(_n212-1,"] = offset;\n\n                isPad = false;\n                for (var j = ").concat(r-_n212,"u; j < ").concat(r,"u; j++) {\n                  xIndices[j] = indices[j] * ").concat(de("uniforms.strides","j - ".concat(r-_n212,"u"),_n212),"\n                    + offsets[j - ").concat(r-_n212,"u] - ").concat(de("uniforms.pads","j - 2u",_c35),";\n                  ").concat(_h29,"\n              }\n              ").concat(a,"\n\n              output[global_idx] = value;\n            }");}},Bu=function Bu(e){return"".concat(e.format,";").concat(e.ceilMode,";").concat(e.autoPad,";").concat(e.kernelShape.length);},gp=function gp(e){return"".concat(Bu(e),";").concat(e.countIncludePad);},yp=function yp(e){return"".concat(Bu(e),";").concat(e.storageOrder,";").concat(e.dilations);},Pu=function Pu(e){return{format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads};},Ru=function Ru(e,t,r,n){var _Eu=Eu(t,n,r),_Eu2=_slicedToArray2(_Eu,2),i=_Eu2[0],o=_Eu2[1],a=U("x",t.dataType,t.dims.length),s=a.type.value,u="";i.countIncludePad?u+="value /= ".concat(s,"(uniforms.kernelSize);"):u+="value /= ".concat(s,"(i32(uniforms.kernelSize) - pad);");var _Ou=Ou(o,i),_Ou2=_slicedToArray2(_Ou,5),l=_Ou2[0],c=_Ou2[1],h=_Ou2[2],f=_Ou2[3],d=_Ou2[4];l.push.apply(l,_toConsumableArray2(F(t.dims)).concat(_toConsumableArray2(F(o))));return{name:e,shaderCache:{hint:"".concat(n.cacheKey,";").concat(h,";").concat(f,";").concat(d),inputDependencies:["rank"]},getRunData:function getRunData(){return{outputs:[{dims:o,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(ort_webgpu_min_N.size(o)/64)},programUniforms:l};},getShaderSource:function getShaderSource(e){return ku(e,a,t.dims.length,o.length,i,"value += x_val;",u,0,c,h,f,d);}};},Du=function Du(e){var t=0!==e.count_include_pad,r=Pu(e);if(0!==r.ceilMode)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");var n=_objectSpread(_objectSpread({countIncludePad:t},r),{},{cacheKey:""});return _objectSpread(_objectSpread({},n),{},{cacheKey:gp(n)});},Mu=function Mu(e,t){Pn(e.inputs),e.compute(Ru("AveragePool",e.inputs[0],!1,t));},Uu={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},zu=function zu(e){var t=e.format;return _objectSpread(_objectSpread({format:t},Uu),{},{cacheKey:t});},Nu=function Nu(e,t){Pn(e.inputs),e.compute(Ru("GlobalAveragePool",e.inputs[0],!0,t));},Vu=function Vu(e,t,r,n){var _Eu3=Eu(t,n,r),_Eu4=_slicedToArray2(_Eu3,2),i=_Eu4[0],o=_Eu4[1],a=U("x",t.dataType,t.dims.length),_Ou3=Ou(o,i),_Ou4=_slicedToArray2(_Ou3,5),s=_Ou4[0],u=_Ou4[1],l=_Ou4[2],c=_Ou4[3],h=_Ou4[4];return s.push.apply(s,_toConsumableArray2(F(t.dims)).concat(_toConsumableArray2(F(o)))),{name:e,shaderCache:{hint:"".concat(n.cacheKey,";").concat(l,";").concat(c,";").concat(h),inputDependencies:["rank"]},getRunData:function getRunData(){return{outputs:[{dims:o,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(ort_webgpu_min_N.size(o)/64)},programUniforms:s};},getShaderSource:function getShaderSource(e){return ku(e,a,t.dims.length,o.length,i,"\n      value = max(x_val, value);\n    ","",-1e5,u,l,c,h);}};},Wu=function Wu(e,t){Pn(e.inputs),e.compute(Vu("MaxPool",e.inputs[0],!1,t));},Gu=function Gu(e){var t=e.storage_order,r=e.dilations,n=Pu(e);if(0!==t)throw new Error("column major storage order is not yet supported for MaxPool");if(0!==n.ceilMode)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");var i=_objectSpread(_objectSpread({storageOrder:t,dilations:r},n),{},{cacheKey:""});return _objectSpread(_objectSpread({},i),{},{cacheKey:yp(i)});},Hu=function Hu(e){var t=e.format;return _objectSpread(_objectSpread({format:t},Uu),{},{cacheKey:t});},Lu=function Lu(e,t){Pn(e.inputs),e.compute(Vu("GlobalMaxPool",e.inputs[0],!0,t));};}),wp,vp,qu,ju=q(function(){dt(),Ne(),we(),wp=function wp(e,t,r){if(e===t||e<t&&r<0||e>t&&r>0)throw new Error("Range these inputs' contents are invalid.");},vp=function vp(e,t,r,n){var i=Math.abs(Math.ceil((t-e)/r)),o=[i],a=i,s=nt(n),u=[{type:"uint32",data:a},{type:s,data:e},{type:s,data:r}].concat(_toConsumableArray2(F(o)));return{name:"Range",shaderCache:{hint:"".concat(n)},getShaderSource:function getShaderSource(e){var t=ort_webgpu_min_j("output",n,o.length),r=t.type.value,i=[{name:"outputSize",type:"u32"},{name:"start",type:r},{name:"delta",type:r}];return"\n        ".concat(e.registerUniforms(i).declareVariables(t),"\n        ").concat(e.mainStart(),"\n        ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n        output[global_idx] = uniforms.start + ").concat(r,"(global_idx) * uniforms.delta;\n      }");},getRunData:function getRunData(){return{outputs:[{dims:o,dataType:n}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:u};}};},qu=function qu(e){var t=0,r=0,n=0;6===e.inputs[0].dataType?(t=e.inputs[0].getInt32Array()[0],r=e.inputs[1].getInt32Array()[0],n=e.inputs[2].getInt32Array()[0]):1===e.inputs[0].dataType&&(t=e.inputs[0].getFloat32Array()[0],r=e.inputs[1].getFloat32Array()[0],n=e.inputs[2].getFloat32Array()[0]),Se.webgpu.validateInputContent&&wp(t,r,n),e.compute(vp(t,r,n,e.inputs[0].dataType),{inputs:[]});};}),$p,_p,xp,Sp,Ip,Cp,Ap,Tp,Ep,Op,kp,Ku,Bp,Pp,Rp,Dp,Mp,Yu,Zu,Xu=q(function(){$e(),qe(),we(),$p=function $p(e,t){if(e.every(function(e){return e>0||function(){throw new Error("Resize requires scales input values to be positive");};}),e.length>0)if("linear"===t.mode){if(!(2===e.length||3===e.length||4===e.length&&1===e[0]&&1===e[1]||4===e.length&&1===e[0]&&1===e[3]||5===e.length&&1===e[0]&&1===e[1]))throw new Error("For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and\n            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1");}else if("cubic"===t.mode&&!(2===e.length||4===e.length&&1===e[0]&&1===e[1]||4===e.length&&1===e[0]&&1===e[3]))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode");},_p=function _p(e,t,r){t.every(function(e){return e>=0&&e<r||function(){throw new Error("Resize requires axes input values to be positive and less than rank");};});var n=new Array(r).fill(1);return t.forEach(function(t,r){return n[t]=e[r];}),n;},xp=function xp(e,t,r,n,i,o){var _ref89=r>10?[1,2,3]:[-1,e.length>1?1:-1,-1],_ref90=_slicedToArray2(_ref89,3),a=_ref90[0],s=_ref90[1],u=_ref90[2],l=e[0].dims.length;if(a>0&&e.length>a&&e[a].dims.length>0)e[a].getFloat32Array().forEach(function(e){return o.push(e);});else if("tf_crop_and_resize"===t.coordinateTransformMode)throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(s>0&&e.length>s&&e[s].dims.length>0){if(e[s].getFloat32Array().forEach(function(e){return n.push(e);}),0!==n.length&&n.length!==l&&r>=18&&n.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");$p(n,t),t.axes.length>0&&_p(n,t.axes,l).forEach(function(e,t){return n[t]=e;});}if(u>0&&e.length>u&&(e[u].getBigInt64Array().forEach(function(e){return i.push(Number(e));}),i.length!==l||r>=18&&i.length===t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(n.length!==t.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(i.length!==t.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified');}if(_typeof2(n)<"u"&&_typeof2(i)<"u"&&n.length>0&&i.length>l)throw new Error("Resize requires only of scales or sizes to be specified");},Sp=function Sp(e,t){return"fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,\n     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ".concat(t," { ")+function(){switch(e){case"asymmetric":return"return ".concat(t,"(xResized) / ").concat(t,"(xScale);");case"pytorch_half_pixel":return"if (lengthResized > 1) {\n                    return (".concat(t,"(xResized) + 0.5) / ").concat(t,"(xScale) - 0.5;\n                  } else {\n                    return 0.0;\n                  }");case"tf_half_pixel_for_nn":return"return (".concat(t,"(xResized) + 0.5) / ").concat(t,"(xScale);");case"align_corners":return"if (lengthResized == 1) {\n                    return 0.0;\n                  } else {\n                    // The whole part and the fractional part are calculated separately due to inaccuracy of floating\n                    // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an\n                    // offset-by-one error later in floor().\n                    let whole = ".concat(t,"(xResized * (lengthOriginal - 1) / (lengthResized - 1));\n                    let fract =\n                        ").concat(t,"(xResized * (lengthOriginal - 1) % (lengthResized - 1)) / ").concat(t,"(lengthResized - 1);\n                    return whole + fract;\n                  }");case"tf_crop_and_resize":return"if (lengthResized > 1) {\n                    return ".concat(t,"(roiStart) * ").concat(t,"(lengthOriginal - 1) +\n                        (").concat(t,"(xResized) * ").concat(t,"(roiEnd - roiStart) * ").concat(t,"(lengthOriginal - 1)) /\n                        ").concat(t,"(lengthResized - 1);\n                  } else {\n                    return 0.5 * ").concat(t,"(roiStart + roiEnd) * ").concat(t,"(lengthOriginal - 1);\n                  }");case"half_pixel_symmetric":return"const outputWidth = ".concat(t,"xScale * ").concat(t,"(lengthResized);\n                  const adjustment = ").concat(t,"(lengthResized) / outputWidth;\n                  const center = ").concat(t,"(lengthOriginal) / 2;\n                  const offset = center * (1 - adjustment);\n                  return offset + ((").concat(t,"(xResized) + 0.5) / ").concat(t,"(xScale)) - 0.5;");case"half_pixel":return"return ((".concat(t,"(xResized) + 0.5) / ").concat(t,"(xScale)) - 0.5;");default:throw new Error("Coordinate transform mode ".concat(e," is not supported"));}}()+"}";},Ip=function Ip(e,t,r){return"fn getNearestPixelFromOriginal(xOriginal: ".concat(r,", isDownSample: bool) -> ").concat(r," {")+function(){switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error("Nearest mode ".concat(e," is not supported"));}}()+"}";},Cp=function Cp(e,t,r){var n=new Array(r).fill(0).concat(new Array(r).fill(1)),i=0===e.length?n:e.slice();return t.length>0?(t.forEach(function(e,o){n[e]=i[o],n[o+r]=i[t.length+o];}),n):i;},Ap=function Ap(e,t,r,n){var i=[];if(r.length>0){if(n.length>0){if(e.forEach(function(e){return i.push(e);}),Math.max.apply(Math,_toConsumableArray2(n))>e.length)throw new Error("axes is out of bound");n.forEach(function(e,t){return i[e]=r[t];});}else r.forEach(function(e){return i.push(e);});}else{if(0===t.length)throw new Error("Resize requires either scales or sizes.");i=e.map(function(e,r){return Math.round(e*t[r]);});}return i;},Tp=function Tp(e,t,r){var n=function(){switch(r.keepAspectRatioPolicy){case"not_larger":return r.axes.length>0?Math.min.apply(Math,_toConsumableArray2(r.axes.map(function(e){return t[e];})).concat([Number.MAX_VALUE])):Math.min.apply(Math,_toConsumableArray2(t).concat([Number.MAX_VALUE]));case"not_smaller":return r.axes.length>0?Math.max.apply(Math,_toConsumableArray2(r.axes.map(function(e){return t[e];})).concat([Number.MIN_VALUE])):Math.max.apply(Math,_toConsumableArray2(t).concat([Number.MIN_VALUE]));default:throw new Error("Keep aspect ratio policy ".concat(r.keepAspectRatioPolicy," is not supported"));}}();t.fill(1,0,t.length);var i=e.slice();return r.axes.length>0?(r.axes.forEach(function(e){return t[e]=n;}),r.axes.forEach(function(r){return i[r]=Math.round(e[r]*t[r]);})):(t.fill(n,0,t.length),i.forEach(function(e,r){return i[r]=Math.round(e*t[r]);})),i;},Ep=function Ep(e,t,r,n,i){return"\n    fn calculateOriginalIndicesFromOutputIndices(output_indices: ".concat(e.type.indices,") -> array<").concat(e.type.value,", ").concat(r.length,"> {\n      var original_indices: array<").concat(e.type.value,", ").concat(r.length,">;\n      for (var i:u32 = 0; i < ").concat(r.length,"; i++) {\n        var output_index = ").concat(e.indicesGet("output_indices","i"),";\n        var scale = ").concat(de("uniforms.scales","i",n),";\n        var roi_low = ").concat(de("uniforms.roi","i",i),";\n        var roi_hi = ").concat(de("uniforms.roi","i + ".concat(t.length),i),";\n        if (scale == 1.0) {\n          original_indices[i] = ").concat(e.type.value,"(output_index);\n        } else {\n          var input_shape_i = ").concat(de("uniforms.input_shape","i",t.length),";\n          var output_shape_i = ").concat(de("uniforms.output_shape","i",r.length),";\n          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                           input_shape_i, roi_low, roi_hi);\n        }\n      }\n      return original_indices;\n    }");},Op=function Op(e,t,r,n,i,o,a){return"\n    fn calculateInputIndicesFromOutputIndices(output_indices: ".concat(t.type.indices,") -> ").concat(e.type.indices," {\n      var input_indices: ").concat(e.type.indices,";\n      for (var i:u32 = 0; i < ").concat(n.length,"; i++) {\n        var output_index = ").concat(t.indicesGet("output_indices","i"),";\n        var input_index: u32;\n        var scale = ").concat(de("uniforms.scales","i",i),";\n        if (scale == 1.0) {\n          input_index = output_index;\n        } else {\n          var roi_low = ").concat(de("uniforms.roi","i",o),";\n          var roi_hi = ").concat(de("uniforms.roi","i + ".concat(r.length),o),";\n          var input_shape_i = ").concat(de("uniforms.input_shape","i",r.length),";\n          var output_shape_i = ").concat(de("uniforms.output_shape","i",n.length),";\n          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                        input_shape_i, roi_low, roi_hi);\n          if (!").concat(a," || (original_idx >= 0 && original_idx < ").concat(t.type.value,"(input_shape_i))) {\n            if (original_idx < 0) {\n              input_index = 0;\n            } else if (original_idx > ").concat(t.type.value,"(input_shape_i - 1)) {\n              input_index = input_shape_i - 1;\n            } else {\n              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));\n            }\n          } else {\n            input_index = u32(original_idx);\n          }\n        }\n        ").concat(e.indicesSet("input_indices","i"," input_index"),"\n      }\n      return input_indices;\n    }");},kp=function kp(e,t){return"\n    fn checkInputIndices(input_indices: ".concat(e.type.indices,") -> bool {\n      for (var i:u32 = 0; i < ").concat(t.length,"; i++) {\n        var input_index = ").concat(e.indicesGet("input_indices","i"),";\n        if (input_index < 0 || input_index >= ").concat(de("uniforms.input_shape","i",t.length),") {\n          return false;\n        }\n      }\n      return true;\n    }");},Ku=function Ku(e,t,r,n){return e.rank>n?"\n    ".concat(e.indicesSet("input_indices",t,"channel"),";\n    ").concat(e.indicesSet("input_indices",r,"batch"),";\n"):"";},Bp=function Bp(e,t,r,n,i){var _ref91=2===r.length?[-1,0,1,-1]:[0,2,3,1],_ref92=_slicedToArray2(_ref91,4),o=_ref92[0],a=_ref92[1],s=_ref92[2],u=_ref92[3],l=e.type.value;return"\n    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ".concat(l," {\n      var input_indices: ").concat(e.type.indices,";\n      ").concat(e.indicesSet("input_indices",a,"max(0, min(row, ".concat(r[a]," - 1))")),";\n      ").concat(e.indicesSet("input_indices",s,"max(0, min(col, ".concat(r[s]," - 1))")),";\n      ").concat(Ku(e,u,o,2),"\n      return ").concat(e.getByIndices("input_indices"),";\n    }\n\n    fn bilinearInterpolation(output_indices: ").concat(t.type.indices,") -> ").concat(l," {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var row:").concat(l," = originalIndices[").concat(a,"];\n      var col:").concat(l," = originalIndices[").concat(s,"];\n      ").concat(n?"if (row < 0 || row > (".concat(r[a]," - 1) || col < 0 || col > (").concat(r[s]," - 1)) {\n        return ").concat(i,";\n      }"):"",";\n      row = max(0, min(row, ").concat(r[a]," - 1));\n      col = max(0, min(col, ").concat(r[s]," - 1));\n      var row1: u32 = u32(row);\n      var col1: u32 = u32(col);\n      var row2: u32 = u32(row + 1);\n      var col2: u32 = u32(col + 1);\n      var channel: u32 = ").concat(r.length>2?"u32(originalIndices[".concat(u,"])"):"0",";\n      var batch: u32 =  ").concat(r.length>2?"u32(originalIndices[".concat(o,"])"):"0",";\n      var x11: ").concat(l," = getInputValue(batch, channel, row1, col1);\n      var x12: ").concat(l," = getInputValue(batch, channel, row1, col2);\n      var x21: ").concat(l," = getInputValue(batch, channel, row2, col1);\n      var x22: ").concat(l," = getInputValue(batch, channel, row2, col2);\n      var dx1: ").concat(l," = abs(row - ").concat(l,"(row1));\n      var dx2: ").concat(l," = abs(").concat(l,"(row2) - row);\n      var dy1: ").concat(l," = abs(col - ").concat(l,"(col1));\n      var dy2: ").concat(l," = abs(").concat(l,"(col2) - col);\n      if (row1 == row2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (col1 == col2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);\n    }");},Pp=function Pp(e,t,r,n,i,o,a,s,u,l){var c=2===r.length,_ref93=c?[0,1]:[2,3],_ref94=_slicedToArray2(_ref93,2),h=_ref94[0],f=_ref94[1],d=e.type.value,p=function p(a){var c=a===h?"row":"col";return"\n      fn ".concat(c,"CubicInterpolation(input_indices: ").concat(e.type.indices,", output_indices: ").concat(t.type.indices,") -> ").concat(d," {\n        var output_index = ").concat(t.indicesGet("output_indices",a),";\n        var originalIdx: ").concat(d," = getOriginalCoordinateFromResizedCoordinate(output_index, ").concat(i[a],",\n        ").concat(n[a],", ").concat(r[a],", ").concat(o[a],", ").concat(o[a]," + ").concat(r.length,");\n        var fractOriginalIdx: ").concat(d," = originalIdx - floor(originalIdx);\n        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);\n\n        if (").concat(s," && (originalIdx < 0 || originalIdx > (").concat(r[a]," - 1))) {\n          return ").concat(u,";\n        }\n        var data: array<").concat(d,", 4> = array<").concat(d,", 4>(0.0, 0.0, 0.0, 0.0);\n        for (var i: i32 = -1; i < 3; i++) {\n          var ").concat(c,": ").concat(d," = originalIdx + ").concat(d,"(i);\n          if (").concat(c," < 0 || ").concat(c," >= ").concat(r[a],") {\n            ").concat(l?"coefs[i + 1] = 0.0;\n                        continue;":s?"return ".concat(u,";"):"".concat(c," = max(0, min(").concat(c,", ").concat(r[a]," - 1));"),";\n          }\n        var input_indices_copy: ").concat(e.type.indices," = input_indices;\n          ").concat(e.indicesSet("input_indices_copy",a,"u32(".concat(c,")")),";\n          data[i + 1] = ").concat(a===h?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)",";\n        }\n        return cubicInterpolation1D(data, coefs);\n      }");};return"\n    ".concat(p(h),";\n    ").concat(p(f),";\n  fn getCubicInterpolationCoefs(s: ").concat(d,") -> array<").concat(d,", 4> {\n    var absS = abs(s);\n    var coeffs: array<").concat(d,", 4> = array<").concat(d,", 4>(0.0, 0.0, 0.0, 0.0);\n    var oneMinusAbsS: ").concat(d," = 1.0 - absS;\n    var twoMinusAbsS: ").concat(d," = 2.0 - absS;\n    var onePlusAbsS: ").concat(d," = 1.0 + absS;\n    coeffs[0] = ((").concat(a," * onePlusAbsS - 5 * ").concat(a,") * onePlusAbsS + 8 * ").concat(a,") * onePlusAbsS - 4 * ").concat(a,";\n    coeffs[1] = ((").concat(a," + 2) * absS - (").concat(a," + 3)) * absS * absS + 1;\n    coeffs[2] = ((").concat(a," + 2) * oneMinusAbsS - (").concat(a," + 3)) * oneMinusAbsS * oneMinusAbsS + 1;\n    coeffs[3] = ((").concat(a," * twoMinusAbsS - 5 * ").concat(a,") * twoMinusAbsS + 8 * ").concat(a,") * twoMinusAbsS - 4 * ").concat(a,";\n    return coeffs;\n  }\n\n  fn cubicInterpolation1D(x: array<").concat(d,", 4>, coefs: array<").concat(d,", 4>) -> ").concat(d," {\n    var coefsSum: ").concat(d," = coefs[0] + coefs[1] + coefs[2] + coefs[3];\n    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;\n  }\n\n  fn bicubicInterpolation(output_indices: ").concat(t.type.indices,") -> ").concat(d," {\n    var input_indices: ").concat(e.type.indices," = output_indices;\n    return colCubicInterpolation(input_indices, output_indices);\n  }\n    ");},Rp=function Rp(e,t,r,n,i){var _ref95=3===r.length?[-1,0,1,2,-1]:[0,2,3,4,1],_ref96=_slicedToArray2(_ref95,5),o=_ref96[0],a=_ref96[1],s=_ref96[2],u=_ref96[3],l=_ref96[4],c=e.type.value;return"\n    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ".concat(c," {\n      var input_indices: ").concat(e.type.indices,";\n      ").concat(e.indicesSet("input_indices",a,"max(0, min(depth, ".concat(r[a]," - 1))")),";\n      ").concat(e.indicesSet("input_indices",s,"max(0, min(height, ".concat(r[s]," - 1))")),";\n      ").concat(e.indicesSet("input_indices",u,"max(0, min(width, ".concat(r[u]," - 1))")),";\n      ").concat(Ku(e,l,o,3),"\n      return ").concat(e.getByIndices("input_indices"),";\n    }\n\n    fn trilinearInterpolation(output_indices: ").concat(t.type.indices,") -> ").concat(c," {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var depth:").concat(c," = originalIndices[").concat(a,"];\n      var height:").concat(c," = originalIndices[").concat(s,"];\n      var width:").concat(c," = originalIndices[").concat(u,"];\n      ").concat(n?"if (depth < 0 || depth > (".concat(r[a]," - 1) || height < 0 || height > (").concat(r[s]," - 1) || width < 0 || (width > ").concat(r[u]," - 1)) {\n      return ").concat(i,";\n        }"):"",";\n\n    depth = max(0, min(depth, ").concat(r[a]," - 1));\n      height = max(0, min(height, ").concat(r[s]," - 1));\n      width = max(0, min(width, ").concat(r[u]," - 1));\n      var depth1: u32 = u32(depth);\n      var height1: u32 = u32(height);\n      var width1: u32 = u32(width);\n      var depth2: u32 = u32(depth + 1);\n      var height2: u32 = u32(height + 1);\n      var width2: u32 = u32(width + 1);\n      var channel: u32 = ").concat(r.length>3?"u32(originalIndices[".concat(l,"])"):"0",";\n      var batch: u32 =  ").concat(r.length>3?"u32(originalIndices[".concat(o,"])"):"0",";\n\n      var x111: ").concat(c," = getInputValue(batch, channel, depth1, height1, width1);\n      var x112: ").concat(c," = getInputValue(batch, channel, depth1, height1, width2);\n      var x121: ").concat(c," = getInputValue(batch, channel, depth1, height2, width1);\n      var x122: ").concat(c," = getInputValue(batch, channel, depth1, height2, width2);\n      var x211: ").concat(c," = getInputValue(batch, channel, depth2, height1, width1);\n      var x212: ").concat(c," = getInputValue(batch, channel, depth2, height1, width2);\n      var x221: ").concat(c," = getInputValue(batch, channel, depth2, height2, width1);\n      var x222: ").concat(c," = getInputValue(batch, channel, depth2, height2, width2);\n      var dx1: ").concat(c," = abs(depth - ").concat(c,"(depth1));\n      var dx2: ").concat(c," = abs(").concat(c,"(depth2) - depth);\n      var dy1: ").concat(c," = abs(height - ").concat(c,"(height1));\n      var dy2: ").concat(c," = abs(").concat(c,"(height2) - height);\n      var dz1: ").concat(c," = abs(width - ").concat(c,"(width1));\n      var dz2: ").concat(c," = abs(").concat(c,"(width2) - width);\n      if (depth1 == depth2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (height1 == height2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      if (width1 == width2) {\n        dz1 = 0.5;\n        dz2 = 0.5;\n      }\n      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +\n              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);\n    }");},Dp=function Dp(e,t,r,n,i,o){var a=e.dims,s=Cp(o,t.axes,a.length),u=Ap(a,n,i,t.axes),l=n.slice();0===n.length&&(l=a.map(function(e,t){return 0===e?1:u[t]/e;}),"stretch"!==t.keepAspectRatioPolicy&&(u=Tp(a,l,t)));var c=ort_webgpu_min_j("output",e.dataType,u.length),h=U("input",e.dataType,a.length),f=ort_webgpu_min_N.size(u),d=a.length===u.length&&a.every(function(e,t){return e===u[t];}),p="tf_crop_and_resize"===t.coordinateTransformMode,y=t.extrapolationValue,m=h.type.value;return{name:"Resize",shaderCache:{hint:"".concat(t.cacheKey,"|").concat(r,"|").concat(l.length>0?l:"","|").concat(i.length>0?i:"","|").concat(s.length>0?s:"","|").concat(d,"|").concat(a),inputDependencies:["rank"]},getShaderSource:function getShaderSource(e){return"\n      ".concat(d?"":"\n      ".concat(Sp(t.coordinateTransformMode,m),";\n      ").concat(function(){switch(t.mode){case"nearest":return"\n              ".concat(kp(h,a),";\n              ").concat(Ip(t.nearestMode,r,m),";\n              ").concat(Op(h,c,a,u,l.length,s.length,p),";\n              ");case"linear":return"\n              ".concat(Ep(c,a,u,l.length,s.length),";\n              ").concat(function(){if(2===a.length||4===a.length)return"".concat(Bp(h,c,a,p,y));if(3===a.length||5===a.length)return"".concat(Rp(h,c,a,p,y));throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.");}(),";\n            ");case"cubic":return"\n            ".concat(function(){if(2===a.length||4===a.length)return"".concat(Pp(h,c,a,u,l,s,t.cubicCoeffA,p,t.extrapolationValue,t.excludeOutside));throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.");}(),";\n            ");default:throw Error("Invalid resize mode");}}(),";\n      "),"\n      ").concat(e.registerUniform("output_size","u32").registerUniform("scales","f32",l.length).registerUniform("roi","f32",s.length).declareVariables(h,c),"\n      ").concat(e.mainStart(),"\n        ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n        ").concat(d?"output[global_idx] = input[global_idx];":"\n        let output_indices = ".concat(c.offsetToIndices("global_idx"),";\n        var input_indices: ").concat(h.type.indices,";\n        ").concat(function(){switch(t.mode){case"nearest":return"input_indices = calculateInputIndicesFromOutputIndices(output_indices);\n                if (checkInputIndices(input_indices)) {\n                  output[global_idx] = ".concat(h.getByIndices("input_indices"),";\n                } else {\n                  output[global_idx] = ").concat(t.extrapolationValue,";\n                }");case"linear":return"output[global_idx] = ".concat(2===a.length||4===a.length?"bilinearInterpolation":"trilinearInterpolation","(output_indices);");case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error("Unsupported resize mode: ".concat(t.mode));}}(),";\n"),"\n      }");},getRunData:function getRunData(){return{outputs:[{dims:u,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(f/64)},programUniforms:[{type:"uint32",data:f},{type:"float32",data:l},{type:"float32",data:s}].concat(_toConsumableArray2(F(a)),_toConsumableArray2(F(u)))};}};},Mp=function Mp(e){var t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0];},Yu=function Yu(e,t){var r=[],n=[],i=[],o=Mp(e);if(0!==t.antialias)throw Error("Only default value (0) for Antialias attribute is supported");xp(e.inputs,t,o,r,n,i),e.compute(Dp(e.inputs[0],t,o,r,n,i),{inputs:[0]});},Zu=function Zu(e){var t=e.antialias,r=e.axes,n=e.coordinateTransformMode,i=e.cubicCoeffA,o=0!==e.excludeOutside,a=e.extrapolationValue,s=e.keepAspectRatioPolicy,u=e.mode,l=""===e.nearestMode?"simple":e.nearestMode;return ge({antialias:t,axes:r,coordinateTransformMode:n,cubicCoeffA:i,excludeOutside:o,extrapolationValue:a,keepAspectRatioPolicy:s,mode:u,nearestMode:l});};}),Up,zp,Ju,Qu,el=q(function(){Ne(),$e(),qe(),we(),Up=function Up(e){if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");var t=e[0],r=e[1],n=e[2];if(t.dataType!==r.dataType||t.dataType!==n.dataType)throw new Error("All inputs must have the same data type");if(3!==t.dims.length&&2!==t.dims.length)throw new Error("Input must be 2D or 3D");if(3!==r.dims.length&&2!==r.dims.length)throw new Error("Skip must be 2D or 3D");var i=t.dims[t.dims.length-1],o=t.dims[t.dims.length-2];if(r.dims[r.dims.length-1]!==i)throw new Error("Skip must have the same hidden size as input");if(r.dims[r.dims.length-2]!==o)throw new Error("Skip must have the same sequence length as input");if(1!==n.dims.length)throw new Error("Gamma must be 1D");if(n.dims[n.dims.length-1]!==i)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){var _t392=e[3];if(1!==_t392.dims.length)throw new Error("Beta must be 1D");if(_t392.dims[_t392.dims.length-1]!==i)throw new Error("Beta must have the same hidden size as input");}if(e.length>4){var _t393=e[4];if(1!==_t393.dims.length)throw new Error("Bias must be 1D");if(_t393.dims[_t393.dims.length-1]!==i)throw new Error("Bias must have the same hidden size as input");}},zp=function zp(e,t,r,n){var i=e[0].dims,o=i,a=ort_webgpu_min_N.size(i),s=i.slice(-1)[0],u=n?i.slice(0,-1).concat(1):[],l=e.length>3,c=e.length>4,h=n&&r>1,f=n&&r>2,d=r>3,p=Fe(s),y=[U("x",e[0].dataType,e[0].dims,p),U("skip",e[1].dataType,e[1].dims,p),U("gamma",e[2].dataType,e[2].dims,p)];l&&y.push(U("beta",e[3].dataType,e[3].dims,p)),c&&y.push(U("bias",e[4].dataType,e[4].dims,p)),y.push(ort_webgpu_min_j("output",e[0].dataType,o,p)),h&&y.push(ort_webgpu_min_j("meanOutput",1,u)),f&&y.push(ort_webgpu_min_j("invStdOutput",1,u)),d&&y.push(ort_webgpu_min_j("inputSkipBiasSum",e[0].dataType,o,p));var m=Le(e[0].dataType),g=[{dims:o,dataType:e[0].dataType}];return r>1&&g.push({dims:u,dataType:1}),r>2&&g.push({dims:u,dataType:1}),r>3&&g.push({dims:i,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:t.cacheKey},getShaderSource:function getShaderSource(e){return"\n      const hiddenSize: f32 = ".concat(s,";\n      const hiddenSizeVectorized: u32 = ").concat(s/p,";\n      const epsilon: f32 = ").concat(t.epsilon,";\n\n      ").concat(e.declareVariables.apply(e,y),"\n\n      ").concat(e.mainStart(),"\n        ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes(a/s),"\n        let offset = global_idx * hiddenSizeVectorized;\n        var sum = ").concat(Je("f32",p),";\n        var squareSum = ").concat(Je("f32",p),";\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          let skipValue = skip[offset + i];\n          let biasValue = ").concat(c?"bias[i]":"0.0",";\n          let inputValue = x[offset + i];\n          let value = inputValue + skipValue + biasValue;\n          ").concat(d?"inputSkipBiasSum[offset + i] = value;":"","\n          output[offset + i] = value;\n          let f32Value = ").concat(mt(m,p,"value"),";\n          sum += f32Value;\n          squareSum += f32Value * f32Value;\n        }\n        let mean = ").concat(at("sum",p)," / hiddenSize;\n        let invStdDev = inverseSqrt(").concat(at("squareSum",p)," / hiddenSize - mean * mean + epsilon);\n        ").concat(h?"meanOutput[global_idx] = mean;":"","\n        ").concat(f?"invStdOutput[global_idx] = invStdDev;":"","\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          output[offset + i] = (output[offset + i] - ").concat(m,"(mean)) * ").concat(m,"(invStdDev) * gamma[i]\n           + ").concat(l?"beta[i]":"0.0",";\n        }\n      }");},getRunData:function getRunData(){return{outputs:g,dispatchGroup:{x:Math.ceil(a/s/64)}};}};},Ju=function Ju(e,t){Up(e.inputs);var r=[0];e.outputCount>1&&r.push(-3),e.outputCount>2&&r.push(-3),e.outputCount>3&&r.push(3),e.compute(zp(e.inputs,t,e.outputCount,!1),{outputs:r});},Qu=function Qu(e){var t=e.epsilon;return ge({epsilon:t});};}),Np,Rn,Vp,tl,Wp,Gp,rl,nl,al=q(function(){Ne(),$e(),qe(),we(),Np=function Np(e,t){if(!e||e.length<1)throw new Error("too few inputs");if(0!==t.axes.length){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length");}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach(function(t,r){if(6!==e[r+1].dataType&&7!==e[r+1].dataType)throw new Error("Input ".concat(r," must be an array of int32 or int64"));});},Rn=function Rn(e,t){var r=[];if(e.length>t)if(7===e[t].dataType)e[t].getBigInt64Array().forEach(function(e){return r.push(Number(e));});else{if(6!==e[t].dataType)throw new Error("Input ".concat(t," must be an array of int32 or int64"));e[t].getInt32Array().forEach(function(e){return r.push(Number(e));});}return r;},Vp=function Vp(e,t){if(e.length>1){var _t394=Rn(e,1),r=Rn(e,2),n=Rn(e,3);return 0===n.length&&(n=_toConsumableArray2(Array(e[0].dims.length).keys())),ge({starts:_t394,ends:r,axes:n});}return t;},tl=function tl(e,t,r,n,i){var o=e;return e<0&&(o+=r[n[t]]),i[t]<0?Math.max(0,Math.min(o,r[n[t]]-1)):Math.max(0,Math.min(o,r[n[t]]));},Wp=function Wp(e,t,r){return"fn calculateInputIndices(output_indices: ".concat(t.type.indices,") -> ").concat(e.type.indices," {\n          var input_indices: ").concat(e.type.indices,";\n          var carry = 0u;\n          for (var i = ").concat(r.length,"; i >= 0; i--) {\n            let input_shape_i = ").concat(de("uniforms.input_shape","i",r.length),";\n            let steps_i = ").concat(de("uniforms.steps","i",r.length),";\n            let signs_i = ").concat(de("uniforms.signs","i",r.length),";\n            let starts_i = ").concat(de("uniforms.starts","i",r.length),";\n            var output_index = ").concat(t.indicesGet("output_indices","i"),";\n            var input_index = output_index * steps_i + starts_i + carry;\n            carry = input_index / input_shape_i;\n            input_index = input_index % input_shape_i;\n            if (signs_i < 0) {\n              input_index = input_shape_i - input_index - 1u + starts_i;\n            }\n            ").concat(e.indicesSet("input_indices","i","input_index"),";\n          }\n          return input_indices;\n      }");},Gp=function Gp(e,t){var r=e[0].dims,n=ort_webgpu_min_N.size(r),i=t.axes.length>0?ort_webgpu_min_N.normalizeAxes(t.axes,r.length):_toConsumableArray2(Array(r.length).keys()),o=Rn(e,4);o.forEach(function(e){return 0!==e||function(){throw new Error("step cannot be 0");};}),0===o.length&&(o=Array(i.length).fill(1));var a=t.starts.map(function(e,t){return tl(e,t,r,i,o);}),s=t.ends.map(function(e,t){return tl(e,t,r,i,o);});if(i.length!==a.length||i.length!==s.length)throw new Error("start, ends and axes should have the same number of elements");if(i.length!==r.length)for(var _e917=0;_e917<r.length;++_e917)i.includes(_e917)||(a.splice(_e917,0,0),s.splice(_e917,0,r[_e917]),o.splice(_e917,0,1));var u=o.map(function(e){return Math.sign(e);});o.forEach(function(e,t,r){if(e<0){var _n213=(s[t]-a[t])/e,_i161=a[t],_u52=_i161+_n213*o[t];a[t]=_u52,s[t]=_i161,r[t]=-e;}});var l=r.slice(0);i.forEach(function(e,t){l[e]=Math.ceil((s[e]-a[e])/o[e]);});var c={dims:l,dataType:e[0].dataType},h=ort_webgpu_min_j("output",e[0].dataType,l.length),f=U("input",e[0].dataType,e[0].dims.length),d=ort_webgpu_min_N.size(l),p=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:a.length},{name:"signs",type:"i32",length:u.length},{name:"steps",type:"u32",length:o.length}],y=[{type:"uint32",data:d},{type:"uint32",data:a},{type:"int32",data:u},{type:"uint32",data:o}].concat(_toConsumableArray2(F(e[0].dims)),_toConsumableArray2(F(l)));return{name:"Slice",shaderCache:{hint:"".concat(u.length,"_").concat(a.length,"_").concat(o.length),inputDependencies:["rank"]},getShaderSource:function getShaderSource(e){return"\n      ".concat(e.registerUniforms(p).declareVariables(f,h),"\n        ").concat(Wp(f,h,r),"\n        ").concat(e.mainStart(),"\n          ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n          let output_indices = ").concat(h.offsetToIndices("global_idx"),";\n          let input_indices = calculateInputIndices(output_indices);\n          ").concat(h.setByOffset("global_idx",f.getByIndices("input_indices")),"\n      }");},getRunData:function getRunData(){return{outputs:[c],dispatchGroup:{x:Math.ceil(n/64)},programUniforms:y};}};},rl=function rl(e,t){Np(e.inputs,t);var r=Vp(e.inputs,t);e.compute(Gp(e.inputs,r),{inputs:[0]});},nl=function nl(e){var t=e.starts,r=e.ends,n=e.axes;return ge({starts:t,ends:r,axes:n});};}),Hp,Lp,il,ol,sl=q(function(){$e(),qe(),we(),Hp=function Hp(e){if(!e||1!==e.length)throw new Error("Softmax op requires 1 input.");},Lp=function Lp(e,t){var r=e.dims,n=ort_webgpu_min_N.size(r),i=t.axis;if(i<0&&(i=r.length+i),i<r.length-1)throw new Error("softmax only supports last axis for now.");var o=r[i],a=n/o,s=Fe(o),u=o/s,l=U("x",e.dataType,e.dims,s),c=ort_webgpu_min_j("result",e.dataType,e.dims,s),h=l.type.value,f="f32"===Le(e.dataType)?"var threadMax = ".concat(h,"(-3.402823e+38f);"):"var threadMax = ".concat(h,"(-65504.0h);");return{name:"Softmax",shaderCache:{hint:"".concat(s),inputDependencies:["type"]},getRunData:function getRunData(){return{outputs:[{dims:r,dataType:e.dataType}],dispatchGroup:{x:a},programUniforms:[{type:"uint32",data:u}]};},getShaderSource:function getShaderSource(e){return"\n      var<workgroup> rowMaxShared : ".concat(h,";\n      var<workgroup> rowSumShared : ").concat(h,";\n      var<workgroup> threadShared : array<").concat(h,", 64>;\n\n      fn getValue(row: i32, col: i32, row_stride: i32) -> ").concat(h," {\n        let index = row * row_stride + col;\n        return x[index];\n      }\n\n      fn setValue(row: i32, col: i32, row_stride: i32, value: ").concat(h,") {\n        let index = row * row_stride + col;\n        result[index] = value;\n      }\n      ").concat(e.registerUniform("packedCols","i32").declareVariables(l,c),"\n      ").concat(e.mainStart(),"\n        let gindex = i32(global_idx);\n        let lindex = i32(local_idx);\n        const wg = 64;\n        let row = gindex / wg;\n        let cols = uniforms.packedCols;\n        let row_stride : i32 = uniforms.packedCols;\n\n        // find the rows max\n        ").concat(f,"\n        for (var col = lindex; col < cols; col += wg) {\n          let value = getValue(row, col, row_stride);\n          threadMax = max(threadMax, value);\n        }\n        if (lindex < cols) {\n          threadShared[lindex] = threadMax;\n        }\n        workgroupBarrier();\n\n        var reduceSize = min(cols, wg);\n        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {\n          reduceSize = currSize + (reduceSize & 1);\n          if (lindex < currSize) {\n            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowMaxShared = ").concat(h,"(").concat(function(e,t){return 4===t?"max(max(".concat(e,".x, ").concat(e,".y), max(").concat(e,".z, ").concat(e,".w))"):2===t?"max(".concat(e,".x, ").concat(e,".y)"):3===t?"max(max(".concat(e,".x, ").concat(e,".y), ").concat(e,".z)"):e;}("threadShared[0]",s),");\n        }\n        workgroupBarrier();\n\n        // find the rows sum\n        var threadSum = ").concat(h,"(0.0);\n        for (var col = lindex; col < cols; col += wg) {\n          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);\n          threadSum += subExp;\n        }\n        threadShared[lindex] = threadSum;\n        workgroupBarrier();\n\n        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {\n          if (lindex < currSize) {\n            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowSumShared = ").concat(h,"(").concat(at("threadShared[0]",s),");\n        }\n        workgroupBarrier();\n\n        // calculate final value for each element in the row\n        for (var col = lindex; col < cols; col += wg) {\n          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;\n          setValue(row, col, row_stride, value);\n        }\n      }");}};},il=function il(e,t){Hp(e.inputs),e.compute(Lp(e.inputs[0],t));},ol=function ol(e){return ge({axis:e.axis});};}),Fp,qp,jp,Kp,Yp,ul,ll,dl=q(function(){$e(),qe(),we(),Fp=function Fp(e){if(!e||e.length<1)throw new Error("too few inputs");},qp=function qp(e,t){var r=[],n=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(function(e){return r.push(Number(e));}),n=r.length),ge({numOutputs:n,axis:t.axis,splitSizes:r});},jp=function jp(e){return"\nfn calculateOutputIndex(index: u32) -> u32 {\n    for (var i: u32 = 0u; i < ".concat(e,"u; i += 1u ) {\n    if (index < ").concat(de("uniforms.size_in_split_axis","i",e),") {\n        return i;\n    }\n    }\n    return ").concat(e,"u;\n}");},Kp=function Kp(e){var t=e.length,r=[];for(var n=0;n<t;++n){var i=e[n].setByIndices("indices","input[global_idx]");1===t?r.push(i):0===n?r.push("if (output_number == ".concat(n,"u) { ").concat(i," }")):n===t-1?r.push("else { ".concat(i," }")):r.push("else if (output_number == ".concat(n,") { ").concat(i," }"));}return"\n      fn writeBufferData(output_number: u32, indices: ".concat(e[0].type.indices,", global_idx: u32) {\n        ").concat(r.join("\n"),"\n      }");},Yp=function Yp(e,t){var r=e[0].dims,n=ort_webgpu_min_N.size(r),i=e[0].dataType,o=ort_webgpu_min_N.normalizeAxis(t.axis,r.length),a=new Array(t.numOutputs),s=U("input",i,r),u=new Array(t.numOutputs),l=[],c=[],h=0,f=[{type:"uint32",data:n}];for(var _n214=0;_n214<t.numOutputs;_n214++){h+=t.splitSizes[_n214],u[_n214]=h;var _o124=r.slice();_o124[t.axis]=t.splitSizes[_n214],c.push(_o124),a[_n214]=ort_webgpu_min_j("output".concat(_n214),i,_o124),l.push({dims:c[_n214],dataType:e[0].dataType});}f.push({type:"uint32",data:u}),f.push.apply(f,_toConsumableArray2(F(r))),c.forEach(function(e){return f.push.apply(f,_toConsumableArray2(F(e)));});return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:function getShaderSource(e){var _e$registerUniform$re3;return"\n  ".concat((_e$registerUniform$re3=e.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",u.length)).declareVariables.apply(_e$registerUniform$re3,[s].concat(a)),"\n  ").concat(jp(u.length),"\n  ").concat(Kp(a),"\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size"),"\n\n    var indices = ").concat(s.offsetToIndices("global_idx"),";\n    var index = ").concat(s.indicesGet("indices",o),";\n    let output_number = calculateOutputIndex(index);\n    if (output_number != 0) {\n      index -= ").concat(de("uniforms.size_in_split_axis","output_number - 1u",u.length),";\n      ").concat(s.indicesSet("indices",o,"index"),";\n    }\n    writeBufferData(output_number, indices, global_idx);\n  }");},getRunData:function getRunData(){return{outputs:l,dispatchGroup:{x:Math.ceil(n/64)},programUniforms:f};}};},ul=function ul(e,t){Fp(e.inputs);var r=1===e.inputs.length?t:qp(e.inputs,t);e.compute(Yp(e.inputs,r),{inputs:[0]});},ll=function ll(e){var t=e.axis,r=e.splitSizes,n=e.numOutputs<0?r.length:e.numOutputs;if(n!==r.length)throw new Error("numOutputs and splitSizes lengh must be equal");return ge({axis:t,numOutputs:n,splitSizes:r});};}),cl,Zp,Xp,Jp,pl,ml=q(function(){Ne(),$e(),we(),cl=function cl(e){return Array.from(e.getBigInt64Array(),Number);},Zp=function Zp(e){if(!e||2!==e.length)throw new Error("Tile requires 2 inputs.");if(1!==e[0].dataType&&6!==e[0].dataType&&12!==e[0].dataType)throw new Error("Tile only support float, int32, and uint32 data types");if(7!==e[1].dataType)throw new Error("Tile `repeats` input should be of int64 data type");if(1!==e[1].dims.length)throw new Error("Tile `repeats` input should be 1-D");if(cl(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor");},Xp=function Xp(e,t){var r=[];for(var n=0;n<e.length;++n)r.push(e[n]*t[n]);return r;},Jp=function Jp(e){var t=e[0].dims,r=cl(e[1]),n=Xp(t,r),i=ort_webgpu_min_N.size(n),o=e[0].dataType,a=U("input",o,t.length),s=ort_webgpu_min_j("output",o,n.length);return{name:"Tile",shaderCache:{hint:"".concat(r),inputDependencies:["rank"]},getRunData:function getRunData(){return{outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:"uint32",data:i}].concat(_toConsumableArray2(F(e[0].dims)),_toConsumableArray2(F(n)))};},getShaderSource:function getShaderSource(e){return"\n      const inputShape = ".concat(a.indices.apply(a,_toConsumableArray2(t)),";\n      ").concat(e.registerUniform("output_size","u32").declareVariables(a,s),"\n      ").concat(e.mainStart(),"\n      ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n      let output_indices = ").concat(s.offsetToIndices("global_idx"),";\n      var input_indices: ").concat(a.type.indices,";\n      for (var i = 0; i < ").concat(t.length,"; i++) {\n        let input_dim_i = ").concat(a.indicesGet("uniforms.input_shape","i"),";\n        let input_dim_value = ").concat(s.indicesGet("output_indices","i"),"  % input_dim_i;\n\n        ").concat(a.indicesSet("input_indices","i","input_dim_value"),"\n      }\n      ").concat(s.setByOffset("global_idx",a.getByIndices("input_indices")),"\n    }");}};},pl=function pl(e){Zp(e.inputs),e.compute(Jp(e.inputs),{inputs:[0]});};}),Qp,em,fl,hl=q(function(){Ne(),$e(),we(),Qp=function Qp(e,t,r,n,i){var o,a=ort_webgpu_min_j("output_data",i,r.length,4),s=U("a_data",t[1].dataType,t[1].dims.length,4),u=U("b_data",t[2].dataType,t[2].dims.length,4),l=U("c_data",t[0].dataType,t[0].dims.length,4),c=function c(e,t,r){return"select(".concat(t,", ").concat(e,", ").concat(r,")");};if(n){var _e918=function _e918(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";var n="a_data[index_a".concat(t,"][component_a").concat(t,"]"),i="b_data[index_b".concat(t,"][component_b").concat(t,"]"),o="bool(c_data[index_c".concat(t,"] & ").concat(4278190080>>>8*(3-t),"u)");return"\n            let output_indices".concat(t," = ").concat(a.offsetToIndices("global_idx * 4u + ".concat(t,"u")),";\n            let offset_a").concat(t," = ").concat(s.broadcastedIndicesToOffset("output_indices".concat(t),a),";\n            let offset_b").concat(t," = ").concat(u.broadcastedIndicesToOffset("output_indices".concat(t),a),";\n            let offset_c").concat(t," = ").concat(l.broadcastedIndicesToOffset("output_indices".concat(t),a),";\n            let index_a").concat(t," = offset_a").concat(t," / 4u;\n            let index_b").concat(t," = offset_b").concat(t," / 4u;\n            let index_c").concat(t," = offset_c").concat(t," / 4u;\n            let component_a").concat(t," = offset_a").concat(t," % 4u;\n            let component_b").concat(t," = offset_b").concat(t," % 4u;\n            ").concat(e,"[").concat(t,"] = ").concat(r,"(").concat(c(n,i,o),");\n          ");};o=9===i?"\n            var data = vec4<u32>(0);\n            ".concat(_e918("data",0,"u32"),"\n            ").concat(_e918("data",1,"u32"),"\n            ").concat(_e918("data",2,"u32"),"\n            ").concat(_e918("data",3,"u32"),"\n            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));"):"\n            ".concat(_e918("output_data[global_idx]",0),"\n            ").concat(_e918("output_data[global_idx]",1),"\n            ").concat(_e918("output_data[global_idx]",2),"\n            ").concat(_e918("output_data[global_idx]",3),"\n          ");}else o=a.setByOffset("global_idx",c(s.getByOffset("global_idx"),u.getByOffset("global_idx"),l.getByOffset("global_idx")));return"\n        ".concat(e.registerUniform("vec_size","u32").declareVariables(l,s,u,a),"\n        ").concat(e.mainStart(),"\n        ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size"),"\n        ").concat(o,"\n      }");},em=function em(e){var t=e[1].dims,r=e[2].dims,n=e[0].dims,i=e[1].dataType,o=!(ort_webgpu_min_N.areEqual(t,r)&&ort_webgpu_min_N.areEqual(r,n)),a=t,s=ort_webgpu_min_N.size(t);if(o){var _e919=gt.calcShape(gt.calcShape(t,r,!1),n,!1);if(!_e919)throw new Error("Can't perform where op on the given tensors");a=_e919,s=ort_webgpu_min_N.size(a);}var u=Math.ceil(s/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:function getShaderSource(t){return Qp(t,e,a,o,i);},getRunData:function getRunData(){return{outputs:[{dims:a,dataType:i}],dispatchGroup:{x:Math.ceil(s/64/4)},programUniforms:[{type:"uint32",data:u}].concat(_toConsumableArray2(F(n)),_toConsumableArray2(F(t)),_toConsumableArray2(F(r)),_toConsumableArray2(F(a)))};}};},fl=function fl(e){e.compute(em(e.inputs));};}),gl,yl=q(function(){Vo(),Ia(),Ho(),Fo(),Ss(),Ds(),zs(),Oa(),Js(),tu(),ou(),lu(),pu(),hu(),bu(),vu(),_u(),Ba(),Cu(),Tu(),Fu(),ju(),_n(),Xu(),el(),al(),sl(),dl(),ml(),pr(),Ca(),hl(),gl=new Map([["Abs",[qo]],["Acos",[jo]],["Acosh",[Ko]],["Add",[Is]],["ArgMax",[No,Sa]],["ArgMin",[zo,Sa]],["Asin",[Yo]],["Asinh",[Zo]],["Atan",[Xo]],["Atanh",[Jo]],["Attention",[Wo]],["AveragePool",[Mu,Du]],["BatchNormalization",[Go]],["BiasAdd",[Lo]],["BiasSplitGelu",[xs]],["Cast",[es,Qo]],["Ceil",[rs]],["Clip",[ts]],["Concat",[Ms,Us]],["Conv",[Ra,Pa]],["ConvTranspose",[Xs,Zs]],["Cos",[ns]],["Cosh",[as]],["CumSum",[Qs,eu]],["Div",[Cs]],["Einsum",[au,iu]],["Elu",[is,In]],["Equal",[As]],["Erf",[os]],["Exp",[ss]],["Expand",[uu]],["Floor",[us]],["FusedConv",[Ra,Pa]],["Gather",[cu,du]],["GatherElements",[fu,mu]],["Gelu",[ls]],["Gemm",[yu,gu]],["GlobalAveragePool",[Nu,zu]],["GlobalMaxPool",[Lu,Hu]],["Greater",[ks]],["GreaterOrEqual",[Ps]],["InstanceNormalization",[wu]],["LayerNormalization",[$u]],["LeakyRelu",[ds,In]],["Less",[Bs]],["LessOrEqual",[Rs]],["Log",[_s]],["MatMul",[Hs]],["MaxPool",[Wu,Gu]],["Mul",[Ts]],["MultiHeadAttention",[Iu,Su]],["Neg",[ps]],["Not",[cs]],["Pad",[Au]],["Pow",[Es]],["Range",[qu]],["Reciprocal",[ms]],["ReduceMin",[Bo]],["ReduceMean",[Ao]],["ReduceMax",[ko]],["ReduceSum",[Ro]],["ReduceProd",[Po]],["ReduceL1",[To]],["ReduceL2",[Eo]],["ReduceLogSum",[Mo]],["ReduceLogSumExp",[Oo]],["ReduceSumSquare",[Do]],["Relu",[fs]],["Resize",[Yu,Zu]],["Sigmoid",[hs]],["Sin",[gs]],["Sinh",[ys]],["Slice",[rl,nl]],["SkipLayerNormalization",[Ju,Qu]],["Split",[ul,ll]],["Sqrt",[bs]],["Softmax",[il,ol]],["Sub",[Os]],["Tan",[ws]],["Tanh",[vs]],["ThresholdedRelu",[$s,In]],["Tile",[pl]],["Transpose",[fo,ho]],["Where",[fl]]]);}),Dn,bl=q(function(){dt(),Dt(),we(),Dn=/*#__PURE__*/function(){function Dn(e){_classCallCheck2(this,Dn);this.backend=e,this.repo=new Map(),this.attributesBound=!1;}return _createClass2(Dn,[{key:"getArtifact",value:function getArtifact(e){return this.repo.get(e);}},{key:"setArtifact",value:function setArtifact(e,t){this.repo.set(e,t);}},{key:"run",value:function run(e,t,r){st(e.programInfo.name);var n=this.backend.getComputePassEncoder();this.backend.writeTimestamp(2*this.backend.pendingDispatchNumber),n.setPipeline(e.computePipeline),n.setBindGroup(0,t),n.dispatchWorkgroups.apply(n,_toConsumableArray2(r)),this.backend.writeTimestamp(2*this.backend.pendingDispatchNumber+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||"at-passes"===this.backend.queryType)&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),ut(e.programInfo.name);}},{key:"dispose",value:function dispose(){}},{key:"build",value:function build(e,t){st(e.name);var r=this.backend.device,n=[];r.features.has("shader-f16")&&n.push("enable f16;");var i=po(t),o=e.getShaderSource(i),a="".concat(n.join("\n"),"\n").concat(i.additionalImplementations,"\n").concat(o),s=r.createShaderModule({code:a,label:e.name});Ue("verbose",function(){return"[WebGPU] ".concat(e.name," shader code: ").concat(a);});var u=r.createComputePipeline({compute:{module:s,entryPoint:"main"},layout:"auto",label:e.name});return ut(e.name),{programInfo:e,computePipeline:u};}},{key:"normalizeDispatchGroupSize",value:function normalizeDispatchGroupSize(e){var t="number"==typeof e?e:e.x,r="number"==typeof e?1:e.y||1,n="number"==typeof e?1:e.z||1,i=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(t<=i&&r<=i&&n<=i)return[t,r,n];var o=t*r*n,a=Math.ceil(Math.sqrt(o));if(a>i){if(a=Math.ceil(Math.cbrt(o)),a>i)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[a,a,a];}return[a,a,1];}}]);}();}),tm,rm,Mn,wl=q(function(){dt(),Ne(),Dt(),oo(),co(),yl(),bl(),tm=function tm(e,t){if(t.length!==e.length)throw new Error("inputDependencies length ".concat(t.length," is not equal to inputTensors length ").concat(e.length,"."));var r=[];for(var n=0;n<e.length;++n){var i=e[n].dataType;switch(t[n]){case"none":r.push("");break;case"type":r.push("".concat(i));break;case"rank":{var _t395=e[n].dims.length;r.push("".concat(i,";").concat(_t395));break;}case"dims":{var _t396=e[n].dims.join(",");r.push("".concat(i,";").concat(_t396));break;}default:throw new Error("unsupported input dependency: ".concat(t[n]));}}return r.join("|");},rm=function rm(e,t,r){var _e$shaderCache,_e$shaderCache$inputD,_e$shaderCache2;var n=e.name;return(_e$shaderCache=e.shaderCache)!==null&&_e$shaderCache!==void 0&&_e$shaderCache.hint&&(n+="["+e.shaderCache.hint+"]"),n+=":"+r+":".concat(tm(t,(_e$shaderCache$inputD=(_e$shaderCache2=e.shaderCache)===null||_e$shaderCache2===void 0?void 0:_e$shaderCache2.inputDependencies)!==null&&_e$shaderCache$inputD!==void 0?_e$shaderCache$inputD:new Array(t.length).fill("dims"))),n;},Mn=/*#__PURE__*/function(){function Mn(){_classCallCheck2(this,Mn);this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=32,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map(),this.sessionExternalDataMapping=new Map();}return _createClass2(Mn,[{key:"currentKernelCustomData",get:function get(){if(null===this.currentKernelId)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");var e=this.kernelCustomData.get(this.currentKernelId);return e||(e={},this.kernelCustomData.set(this.currentKernelId,e)),e;}},{key:"initialize",value:function(){var _initialize=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee159(e,t){var r,n;return _regeneratorRuntime2().wrap(function _callee159$(_context163){while(1)switch(_context163.prev=_context163.next){case 0:this.env=e;r=[],n={requiredLimits:{maxComputeWorkgroupStorageSize:t.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:t.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:t.limits.maxStorageBufferBindingSize,maxBufferSize:t.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:t.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:t.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:t.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:t.limits.maxComputeWorkgroupSizeZ},requiredFeatures:r};t.features.has("chromium-experimental-timestamp-query-inside-passes")?r.push("chromium-experimental-timestamp-query-inside-passes"):t.features.has("timestamp-query")&&r.push("timestamp-query");t.features.has("shader-f16")&&r.push("shader-f16");_context163.next=6;return t.requestDevice(n);case 6:this.device=_context163.sent;this.gpuDataManager=lo(this);this.programManager=new Dn(this);this.kernels=new Map();this.kernelPersistentData=new Map();this.kernelCustomData=new Map();this.kernelUniformCache=new Map();this.kernelGpuBindGroupCache=new Map();ao(e.logLevel,!!e.debug);this.device.onuncapturederror=function(e){e.error instanceof GPUValidationError&&console.error("An uncaught WebGPU validation error was raised: ".concat(e.error.message));};Object.defineProperty(this.env.webgpu,"device",{value:this.device});this.setQueryType();case 18:case"end":return _context163.stop();}},_callee159,this);}));function initialize(_x186,_x187){return _initialize.apply(this,arguments);}return initialize;}()},{key:"dispose",value:function dispose(){_typeof2(this.querySet)<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose();}},{key:"getCommandEncoder",value:function getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder(),this.setQueryType(),"none"!==this.queryType&&_typeof2(this.querySet)>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:2*this.maxDispatchNumber}),this.queryResolveBuffer=this.device.createBuffer({size:2*this.maxDispatchNumber*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE}))),this.commandEncoder;}},{key:"getComputePassEncoder",value:function getComputePassEncoder(){if(!this.computePassEncoder){var _e920={};"at-passes"===this.queryType&&(_e920.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:2*this.pendingDispatchNumber,endOfPassWriteIndex:2*this.pendingDispatchNumber+1}),this.computePassEncoder=this.getCommandEncoder().beginComputePass(_e920);}return this.computePassEncoder;}},{key:"endComputePass",value:function endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null);}},{key:"flush",value:function flush(){var _this153=this;if(!this.commandEncoder)return;var e;st(),this.endComputePass(),"none"!==this.queryType&&(this.commandEncoder.resolveQuerySet(this.querySet,0,2*this.pendingDispatchNumber,this.queryResolveBuffer,0),e=this.device.createBuffer({size:2*this.pendingDispatchNumber*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(e,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,2*this.pendingDispatchNumber*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,"none"!==this.queryType&&e.mapAsync(GPUMapMode.READ).then(function(){var t=new BigUint64Array(e.getMappedRange()),r=_this153.pendingQueries.get(e);var _loop15=function _loop15(){var _this153$env$webgpu$p;var n=r[_e921],i=n.kernelId,o=_this153.kernels.get(i),a=o.kernelType,s=o.kernelName,u=n.programName,l=n.inputTensorViews,c=n.outputTensorViews,h=t[2*_e921],f=t[2*_e921+1];_typeof2(_this153.queryTimeBase)>"u"&&(_this153.queryTimeBase=h);var d=Number(h-_this153.queryTimeBase),p=Number(f-_this153.queryTimeBase);if(!Number.isSafeInteger(d)||!Number.isSafeInteger(p))throw new RangeError("incorrect timestamp range");if((_this153$env$webgpu$p=_this153.env.webgpu.profiling)!==null&&_this153$env$webgpu$p!==void 0&&_this153$env$webgpu$p.ondata)_this153.env.webgpu.profiling.ondata({version:1,inputsMetadata:l.map(function(e){return{dims:e.dims,dataType:nt(e.dataType)};}),outputsMetadata:c.map(function(e){return{dims:e.dims,dataType:nt(e.dataType)};}),kernelId:i,kernelType:a,kernelName:s,programName:u,startTime:d,endTime:p});else{var _e922="";l.forEach(function(t,r){_e922+="input[".concat(r,"]: [").concat(t.dims,"] | ").concat(nt(t.dataType),", ");});var _t397="";c.forEach(function(e,r){_t397+="output[".concat(r,"]: [").concat(e.dims,"] | ").concat(nt(e.dataType),", ");}),console.log("[profiling] kernel \"".concat(i,"|").concat(a,"|").concat(s,"|").concat(u,"\" ").concat(_e922).concat(_t397,"execution time: ").concat(p-d," ns"));}ln("GPU","".concat(u,"::").concat(h,"::").concat(f));};for(var _e921=0;_e921<t.length/2;_e921++){_loop15();}e.unmap(),_this153.pendingQueries["delete"](e);}),ut();}},{key:"run",value:function run(e,t,r,n,i){st(e.name);var o=[];for(var _e923=0;_e923<t.length;++_e923){var _r304=this.gpuDataManager.get(t[_e923].data);if(!_r304)throw new Error("no GPU data for input: ".concat(t[_e923].data));o[_e923]=_r304;}var _e$getRunData=e.getRunData(t),a=_e$getRunData.outputs,s=_e$getRunData.dispatchGroup,u=_e$getRunData.programUniforms,l=0===r.length?a.map(function(e,t){return t;}):r;if(l.length!==a.length)throw new Error("Output size ".concat(l.length," must be equal to ").concat(a.length,"."));var c,h=[],f=[];for(var _e924=0;_e924<a.length;++_e924){if(!Number.isInteger(l[_e924])||l[_e924]<-3||l[_e924]>=a.length)throw new Error("Invalid output index: ".concat(l[_e924]));if(-3===l[_e924])continue;var _t398=-1===l[_e924],_r305=-2===l[_e924],_o125=_t398||_r305?i(a[_e924].dataType,a[_e924].dims):n(l[_e924],a[_e924].dataType,a[_e924].dims),_s69=this.gpuDataManager.get(_o125.data);if(!_s69)throw new Error("no GPU data for output: ".concat(_o125.data));if(_t398&&this.temporaryData.push(_s69),_r305){var _e925=this.kernelPersistentData.get(this.currentKernelId);_e925||(_e925=[],this.kernelPersistentData.set(this.currentKernelId,_e925)),_e925.push(_s69);}h.push(_o125),f.push(_s69);}if(u){var _e926=this.kernelUniformCache.get(this.currentKernelId);_e926&&(this.compareProgramUniforms(_e926.programUniforms,u)||(this.gpuDataManager.release(_e926.gpuData.id),_e926=void 0)),_e926||(_e926=this.createCachedUniform(u),this.kernelUniformCache.set(this.currentKernelId,_e926)),c=_e926.binding;}var d=this.programManager.normalizeDispatchGroupSize(s),p=1===d[1]&&1===d[2],y=rm(e,t,p),m=this.programManager.getArtifact(y);if(m||(m=this.programManager.build(e,d),this.programManager.setArtifact(y,m),Ue("info",function(){return"[artifact] key: ".concat(y,", programName: ").concat(e.name);})),Ue("info",function(){return"[ProgramManager] run \"".concat(e.name,"\" (key=").concat(y,") with ").concat(d[0],"x").concat(d[1],"x").concat(d[2]);}),"none"!==this.queryType){var _e927={kernelId:this.currentKernelId,programName:m.programInfo.name,inputTensorViews:t,outputTensorViews:h};this.pendingKernels.push(_e927);}var g,w=this.kernelGpuBindGroupCache.get(this.currentKernelId);w||(w=[],this.kernelGpuBindGroupCache.set(this.currentKernelId,w));var _iterator70=_createForOfIteratorHelper2(w),_step70;try{for(_iterator70.s();!(_step70=_iterator70.n()).done;){var _e928=_step70.value;if(this.checkCachedBindGroup(_e928,m,o,f,c)){g=_e928;break;}}}catch(err){_iterator70.e(err);}finally{_iterator70.f();}if(!g)for(g=this.createCachedBindGroup(m,o,f,c),w.push(g);w.length>20;)w.shift();return this.programManager.run(m,g.binding,d),ut(e.name),h;}},{key:"compareProgramUniforms",value:function compareProgramUniforms(e,t){return e.length===t.length&&e.every(function(e,r){return e.type===t[r].type;});}},{key:"createCachedUniform",value:function createCachedUniform(e){var t=0,r=[];e.forEach(function(e){var n="number"==typeof e.data?[e.data]:e.data;if(0===n.length)return;var i=n.length<=2?4*n.length:16;t=Math.ceil(t/i)*i,r.push(t),t+=n.length>4?16*Math.ceil(n.length/4):4*n.length;});t=16*Math.ceil(t/16);var n=new ArrayBuffer(t);e.forEach(function(e,t){var i=r[t],o="number"==typeof e.data?[e.data]:e.data;"int32"===e.type?new Int32Array(n,i,o.length).set(o):"uint32"===e.type?new Uint32Array(n,i,o.length).set(o):new Float32Array(n,i,o.length).set(o);});var i=this.gpuDataManager.create(t,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);return this.device.queue.writeBuffer(i.buffer,0,n,0,t),{programUniforms:e,binding:{offset:0,size:t,buffer:i.buffer},gpuData:i};}},{key:"checkCachedBindGroup",value:function checkCachedBindGroup(e,t,r,n,i){if(t!==e.artifact)return!1;var o=r.every(function(t,r){return t.permamentID===e.inputPermamentIDs[r];}),a=n.every(function(t,r){return t.permamentID===e.outputPermamentIDs[r];}),s=i===e.uniformBinding;return o&&a&&s;}},{key:"createCachedBindGroup",value:function createCachedBindGroup(e,t,r,n){var i=[];var _iterator71=_createForOfIteratorHelper2(t),_step71;try{for(_iterator71.s();!(_step71=_iterator71.n()).done;){var _e929=_step71.value;i.push({binding:i.length,resource:{buffer:_e929.buffer}});}}catch(err){_iterator71.e(err);}finally{_iterator71.f();}var _iterator72=_createForOfIteratorHelper2(r),_step72;try{for(_iterator72.s();!(_step72=_iterator72.n()).done;){var _e930=_step72.value;i.push({binding:i.length,resource:{buffer:_e930.buffer}});}}catch(err){_iterator72.e(err);}finally{_iterator72.f();}return n&&i.push({binding:i.length,resource:n}),{binding:this.device.createBindGroup({layout:e.computePipeline.getBindGroupLayout(0),entries:i,label:e.programInfo.name}),artifact:e,inputPermamentIDs:t.map(function(e){return e.permamentID;}),outputPermamentIDs:r.map(function(e){return e.permamentID;}),uniformBinding:n};}},{key:"upload",value:function upload(e,t){this.gpuDataManager.upload(e,t);}},{key:"memcpy",value:function memcpy(e,t){this.gpuDataManager.memcpy(e,t);}},{key:"download",value:function(){var _download2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee160(e,t){return _regeneratorRuntime2().wrap(function _callee160$(_context164){while(1)switch(_context164.prev=_context164.next){case 0:_context164.next=2;return this.gpuDataManager.download(e,t);case 2:case"end":return _context164.stop();}},_callee160,this);}));function download(_x188,_x189){return _download2.apply(this,arguments);}return download;}()},{key:"alloc",value:function alloc(e){return this.gpuDataManager.create(e).id;}},{key:"free",value:function free(e){return this.gpuDataManager.release(e);}},{key:"createKernel",value:function createKernel(e,t,r,n){var i=gl.get(e);if(!i)throw new Error("kernel not implemented: ".concat(e));var o={kernelType:e,kernelName:n,kernelEntry:i[0],attributes:[i[1],r]};this.kernels.set(t,o);}},{key:"releaseKernel",value:function releaseKernel(e){var t=this.kernelPersistentData.get(e);if(t){var _iterator73=_createForOfIteratorHelper2(t),_step73;try{for(_iterator73.s();!(_step73=_iterator73.n()).done;){var _e931=_step73.value;this.gpuDataManager.release(_e931.id);}}catch(err){_iterator73.e(err);}finally{_iterator73.f();}this.kernelPersistentData["delete"](e);}this.kernelCustomData["delete"](e),this.kernelGpuBindGroupCache["delete"](e);var r=this.kernelUniformCache.get(e);console.log("Release kernelId: ",e," has cached: ",r),r&&(this.gpuDataManager.release(r.gpuData.id),this.kernelUniformCache["delete"](e)),this.kernels["delete"](e);}},{key:"computeKernel",value:function computeKernel(e,t,r){var n=this.kernels.get(e);if(!n)throw new Error("kernel not created: ".concat(e));var i=n.kernelType,o=n.kernelName,a=n.kernelEntry,s=n.attributes;if(null!==this.currentKernelId)throw new Error("kernel \"[".concat(i,"] ").concat(o,"\" is not allowed to be called recursively"));this.currentKernelId=e,s[0]&&(s[1]=s[0](s[1]),s[0]=void 0),Ue("info",function(){return"[WebGPU] Start to run kernel \"[".concat(i,"] ").concat(o,"\"...");});var u=this.env.debug;this.temporaryData=[];try{return u&&this.device.pushErrorScope("validation"),a(t,s[1]),0;}catch(e){return r.push(Promise.resolve("[WebGPU] Kernel \"[".concat(i,"] ").concat(o,"\" failed. ").concat(e))),1;}finally{u&&r.push(this.device.popErrorScope().then(function(e){return e?"GPU validation error for kernel \"[".concat(i,"] ").concat(o,"\": ").concat(e.message):null;}));var _iterator74=_createForOfIteratorHelper2(this.temporaryData),_step74;try{for(_iterator74.s();!(_step74=_iterator74.n()).done;){var _e932=_step74.value;this.gpuDataManager.release(_e932.id);}}catch(err){_iterator74.e(err);}finally{_iterator74.f();}this.temporaryData=[],this.currentKernelId=null;}}},{key:"registerBuffer",value:function registerBuffer(e,t,r,n){var i=this.sessionExternalDataMapping.get(e);i||(i=new Map(),this.sessionExternalDataMapping.set(e,i));var o=i.get(t),a=this.gpuDataManager.registerExternalBuffer(r,n,o===null||o===void 0?void 0:o[1]);return i.set(t,[a,r]),a;}},{key:"unregisterBuffers",value:function unregisterBuffers(e){var _this154=this;var t=this.sessionExternalDataMapping.get(e);t&&(t.forEach(function(e){return _this154.gpuDataManager.unregisterExternalBuffer(e[1]);}),this.sessionExternalDataMapping["delete"](e));}},{key:"getBuffer",value:function getBuffer(e){var t=this.gpuDataManager.get(e);if(!t)throw new Error("no GPU data for buffer: ".concat(e));return t.buffer;}},{key:"createDownloader",value:function createDownloader(e,t,r){var _this155=this;return/*#__PURE__*/_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee161(){var n;return _regeneratorRuntime2().wrap(function _callee161$(_context165){while(1)switch(_context165.prev=_context165.next){case 0:_context165.next=2;return ya(_this155,e,t);case 2:n=_context165.sent;return _context165.abrupt("return",io(n.buffer,r));case 4:case"end":return _context165.stop();}},_callee161);}));}},{key:"writeTimestamp",value:function writeTimestamp(e){"inside-passes"===this.queryType&&this.computePassEncoder.writeTimestamp(this.querySet,e);}},{key:"setQueryType",value:function setQueryType(){var _this$env$webgpu$prof;this.queryType="none",("default"===((_this$env$webgpu$prof=this.env.webgpu.profiling)===null||_this$env$webgpu$prof===void 0?void 0:_this$env$webgpu$prof.mode)||this.env.wasm.trace)&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"));}}]);}();}),vl={};Ft(vl,{init:function init(){return nm;}});var zr,Va,nm,$l=q(function(){Ne(),wl(),Dt(),$e(),zr=/*#__PURE__*/function(){function e(_e933,t,r,n){_classCallCheck2(this,e);this.module=_e933,this.dataType=t,this.data=r,this.dims=n;}return _createClass2(e,[{key:"getFloat32Array",value:function getFloat32Array(){if(1!==this.dataType)throw new Error("Invalid data type");var _e934=ort_webgpu_min_N.size(this.dims);return 0===_e934?new Float32Array():new Float32Array(this.module.HEAP8.buffer,this.data,_e934);}},{key:"getBigInt64Array",value:function getBigInt64Array(){if(7!==this.dataType)throw new Error("Invalid data type");var _e935=ort_webgpu_min_N.size(this.dims);return 0===_e935?new BigInt64Array():new BigInt64Array(this.module.HEAP8.buffer,this.data,_e935);}},{key:"getInt32Array",value:function getInt32Array(){if(6!==this.dataType)throw new Error("Invalid data type");var _e936=ort_webgpu_min_N.size(this.dims);return 0===_e936?new Int32Array():new Int32Array(this.module.HEAP8.buffer,this.data,_e936);}},{key:"reshape",value:function reshape(t){if(ort_webgpu_min_N.size(t)!==ort_webgpu_min_N.size(this.dims))throw new Error("Invalid new shape");return new e(this.module,this.dataType,this.data,t);}}]);}(),Va=/*#__PURE__*/function(){function Va(e,t,r){_classCallCheck2(this,Va);this.module=e,this.backend=t,this.customDataOffset=0,this.customDataSize=0;var n=e.HEAPU32,i=r>>>2;this.opKernelContext=n[i++];var o=n[i++];this.outputCount=n[i++],this.customDataOffset=n[i++],this.customDataSize=n[i++];var a=[];for(var _t399=0;_t399<o;_t399++){var _t400=n[i++],_r306=n[i++],_o126=n[i++],_s70=[];for(var _e937=0;_e937<_o126;_e937++)_s70.push(n[i++]);a.push(new zr(e,_t400,_r306,_s70));}this.inputs=a;}return _createClass2(Va,[{key:"kernelCustomData",get:function get(){return this.backend.currentKernelCustomData;}},{key:"customDataBuffer",get:function get(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize);}},{key:"compute",value:function compute(e,t){var _t$inputs$map,_t$inputs,_this156=this,_t$outputs;var r=(_t$inputs$map=t===null||t===void 0||(_t$inputs=t.inputs)===null||_t$inputs===void 0?void 0:_t$inputs.map(function(e){return"number"==typeof e?_this156.inputs[e]:e;}))!==null&&_t$inputs$map!==void 0?_t$inputs$map:this.inputs,n=(_t$outputs=t===null||t===void 0?void 0:t.outputs)!==null&&_t$outputs!==void 0?_t$outputs:[];return this.backend.run(e,r,n,function(e,t,r){return new zr(_this156.module,t,_this156.output(e,r),r);},function(e,t){var r=Br(e);if(!r)throw new Error("Unsupported data type: ".concat(e));var n=r*ort_webgpu_min_N.size(t);return new zr(_this156.module,e,_this156.backend.gpuDataManager.create(n).id,t);});}},{key:"output",value:function output(e,t){var r=this.module.stackSave();try{var _r307=this.module.stackAlloc(4*(1+t.length)),n=_r307>>2;this.module.HEAPU32[n++]=t.length;for(var _e938=0;_e938<t.length;_e938++)this.module.HEAPU32[n++]=t[_e938];return this.module._JsepOutput(this.opKernelContext,e,_r307);}catch(r){throw new Error("Failed to generate kernel's output[".concat(e,"] with dims [").concat(t,"]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ").concat(r));}finally{this.module.stackRestore(r);}}}]);}(),nm=/*#__PURE__*/function(){var _ref98=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee163(e,t,r){var n,i;return _regeneratorRuntime2().wrap(function _callee163$(_context167){while(1)switch(_context167.prev=_context167.next){case 0:n=e.jsepInit;if(n){_context167.next=3;break;}throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");case 3:i=new Mn();_context167.next=6;return i.initialize(t,r);case 6:n(i,function(e){return i.alloc(e);},function(e){return i.free(e);},function(t,r,n){var o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1;if(o)Ue("verbose",function(){return"[WebGPU] jsepCopyGpuToGpu: src=".concat(t,", dst=").concat(r,", size=").concat(n);}),i.memcpy(t,r);else{Ue("verbose",function(){return"[WebGPU] jsepCopyCpuToGpu: dataOffset=".concat(t,", gpuDataId=").concat(r,", size=").concat(n);});var _o127=e.HEAPU8.subarray(t>>>0,(t>>>0)+n);i.upload(r,_o127);}},/*#__PURE__*/function(){var _ref99=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee162(t,r,n){return _regeneratorRuntime2().wrap(function _callee162$(_context166){while(1)switch(_context166.prev=_context166.next){case 0:Ue("verbose",function(){return"[WebGPU] jsepCopyGpuToCpu: gpuDataId=".concat(t,", dataOffset=").concat(r,", size=").concat(n);});_context166.next=3;return i.download(t,function(){return e.HEAPU8.subarray(r>>>0,(r>>>0)+n);});case 3:case"end":return _context166.stop();}},_callee162);}));return function(_x193,_x194,_x195){return _ref99.apply(this,arguments);};}(),function(t,r,n){return i.createKernel(t,r,n,e.UTF8ToString(e._JsepGetNodeName(r)));},function(e){return i.releaseKernel(e);},function(t,r,n,o){Ue("verbose",function(){return"[WebGPU] jsepRun: sessionHandle=".concat(n,", kernel=").concat(t,", contextDataOffset=").concat(r);});var a=new Va(e,i,r);return i.computeKernel(t,a,o);});case 7:case"end":return _context167.stop();}},_callee163);}));return function nm(_x190,_x191,_x192){return _ref98.apply(this,arguments);};}();}),am,xl,Sl,Nr,im,Wa,Il,Cl,om,_l,Al,Tl,El,Ol,Ga,kl=q(function(){Qi(),to(),Ne(),dr(),mn(),fa(),am=function am(e,t){0!==Me()._OrtInit(e,t)&&Re("Can't initialize onnxruntime.");},xl=/*#__PURE__*/function(){var _ref100=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee164(e){return _regeneratorRuntime2().wrap(function _callee164$(_context168){while(1)switch(_context168.prev=_context168.next){case 0:am(e.wasm.numThreads,Pr(e.logLevel));case 1:case"end":return _context168.stop();}},_callee164);}));return function xl(_x196){return _ref100.apply(this,arguments);};}(),Sl=/*#__PURE__*/function(){var _ref101=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee165(e,t){var _t401,r;return _regeneratorRuntime2().wrap(function _callee165$(_context169){while(1)switch(_context169.prev=_context169.next){case 0:if(!("webgpu"===t)){_context169.next=13;break;}if(!((typeof navigator==="undefined"?"undefined":_typeof2(navigator))>"u"||!navigator.gpu)){_context169.next=3;break;}throw new Error("WebGPU is not supported in current environment");case 3:_context169.next=5;return navigator.gpu.requestAdapter();case 5:_t401=_context169.sent;if(_t401){_context169.next=8;break;}throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.');case 8:if(e.wasm.simd){_context169.next=10;break;}throw new Error("Not supported for WebGPU=ON and SIMD=OFF. Please set `env.wasm.simd` to true when using `webgpu` EP");case 10:r=($l(),Et(vl)).init;_context169.next=13;return r(Me(),e,_t401);case 13:case"end":return _context169.stop();}},_callee165);}));return function Sl(_x197,_x198){return _ref101.apply(this,arguments);};}(),Nr=new Map(),im=function im(e){var t=Me(),r=t.stackSave();try{var _r308=t.stackAlloc(8);return 0!==t._OrtGetInputOutputCount(e,_r308,_r308+4)&&Re("Can't get session input/output count."),[t.HEAP32[_r308/4],t.HEAP32[_r308/4+1]];}finally{t.stackRestore(r);}},Wa=function Wa(e){var t=Me(),r=t._malloc(e.byteLength);if(0===r)throw new Error("Can't create a session. failed to allocate a buffer of size ".concat(e.byteLength,"."));return t.HEAPU8.set(e,r),[r,e.byteLength];},Il=/*#__PURE__*/function(){var _ref102=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee166(e,t){var _e939,_e940,_ref103,_Wa,_Wa2;var r,n,i,o,a,s,u,l,c,_eo,_eo2,_e941,_iterator75,_step75,_loop16,_im,_im2,_e942,_h30,_f22,_d21,_p19,_t402,_e943,_e944,_r309,_n215,_t$preferredOutputLoc,_t$preferredOutputLoc2,_e945,_y13,_i$unmountExternalDat2;return _regeneratorRuntime2().wrap(function _callee166$(_context171){while(1)switch(_context171.prev=_context171.next){case 0:i=Me();Array.isArray(e)?(_e939=e,_e940=_slicedToArray2(_e939,2),r=_e940[0],n=_e940[1],_e939):e.buffer===i.HEAPU8.buffer?(_ref103=[e.byteOffset,e.byteLength],r=_ref103[0],n=_ref103[1],_ref103):(_Wa=Wa(e),_Wa2=_slicedToArray2(_Wa,2),r=_Wa2[0],n=_Wa2[1],_Wa);o=0,a=0,s=0,u=[],l=[],c=[];_context171.prev=3;if(!(_eo=eo(t),_eo2=_slicedToArray2(_eo,2),a=_eo2[0],u=_eo2[1],t!==null&&t!==void 0&&t.externalData&&i.mountExternalData)){_context171.next=24;break;}_e941=[];_iterator75=_createForOfIteratorHelper2(t.externalData);_context171.prev=7;_loop16=/*#__PURE__*/_regeneratorRuntime2().mark(function _loop16(){var r,t;return _regeneratorRuntime2().wrap(function _loop16$(_context170){while(1)switch(_context170.prev=_context170.next){case 0:r=_step75.value;t="string"==typeof r?r:r.path;_e941.push(Rr("string"==typeof r?r:r.data).then(function(e){i.mountExternalData(t,e);}));case 3:case"end":return _context170.stop();}},_loop16);});_iterator75.s();case 10:if((_step75=_iterator75.n()).done){_context171.next=14;break;}return _context171.delegateYield(_loop16(),"t0",12);case 12:_context171.next=10;break;case 14:_context171.next=19;break;case 16:_context171.prev=16;_context171.t1=_context171["catch"](7);_iterator75.e(_context171.t1);case 19:_context171.prev=19;_iterator75.f();return _context171.finish(19);case 22:_context171.next=24;return Promise.all(_e941);case 24:o=i._OrtCreateSession(r,n,a),0===o&&Re("Can't create a session.");_im=im(o),_im2=_slicedToArray2(_im,2),_e942=_im2[0],_h30=_im2[1],_f22=[],_d21=[],_p19=[];for(_t402=0;_t402<_e942;_t402++){_e943=i._OrtGetInputName(o,_t402);0===_e943&&Re("Can't get an input name."),l.push(_e943),_f22.push(i.UTF8ToString(_e943));}_e944=0;case 28:if(!(_e944<_h30)){_context171.next=40;break;}_r309=i._OrtGetOutputName(o,_e944);0===_r309&&Re("Can't get an output name."),c.push(_r309);_n215=i.UTF8ToString(_r309);_d21.push(_n215);_e945="string"==typeof(t===null||t===void 0?void 0:t.preferredOutputLocation)?t.preferredOutputLocation:(_t$preferredOutputLoc=t===null||t===void 0||(_t$preferredOutputLoc2=t.preferredOutputLocation)===null||_t$preferredOutputLoc2===void 0?void 0:_t$preferredOutputLoc2[_n215])!==null&&_t$preferredOutputLoc!==void 0?_t$preferredOutputLoc:"cpu";if(!("cpu"!==_e945&&"cpu-pinned"!==_e945&&"gpu-buffer"!==_e945)){_context171.next=36;break;}throw new Error("Not supported preferred output location: ".concat(_e945,"."));case 36:_p19.push(_e945);case 37:_e944++;_context171.next=28;break;case 40:_y13=null;return _context171.abrupt("return",(_p19.some(function(e){return"gpu-buffer"===e;})&&(s=i._OrtCreateBinding(o),0===s&&Re("Can't create IO binding."),_y13={handle:s,outputPreferredLocations:_p19,outputPreferredLocationsEncoded:_p19.map(function(e){return ma(e);})}),Nr.set(o,[o,l,c,_y13]),[o,_f22,_d21]));case 44:_context171.prev=44;_context171.t2=_context171["catch"](3);throw l.forEach(function(e){return i._OrtFree(e);}),c.forEach(function(e){return i._OrtFree(e);}),0!==s&&i._OrtReleaseBinding(s),0!==o&&i._OrtReleaseSession(o),_context171.t2;case 47:_context171.prev=47;i._free(r),0!==a&&i._OrtReleaseSessionOptions(a),u.forEach(function(e){return i._free(e);}),(_i$unmountExternalDat2=i.unmountExternalData)===null||_i$unmountExternalDat2===void 0?void 0:_i$unmountExternalDat2.call(i);return _context171.finish(47);case 50:case"end":return _context171.stop();}},_callee166,null,[[3,44,47,50],[7,16,19,22]]);}));return function Il(_x199,_x200){return _ref102.apply(this,arguments);};}(),Cl=function Cl(e){var _t$jsepUnregisterBuff2;var t=Me(),r=Nr.get(e);if(!r)throw new Error("cannot release session. invalid session id: ".concat(e));var _r310=_slicedToArray2(r,4),n=_r310[0],i=_r310[1],o=_r310[2],a=_r310[3];a&&t._OrtReleaseBinding(a.handle),(_t$jsepUnregisterBuff2=t.jsepUnregisterBuffers)!==null&&_t$jsepUnregisterBuff2!==void 0&&_t$jsepUnregisterBuff2.call(t,e),i.forEach(function(e){return t._OrtFree(e);}),o.forEach(function(e){return t._OrtFree(e);}),t._OrtReleaseSession(n),Nr["delete"](e);},om=function om(e,t,r){if(null!==e&&e[0]===t){var _t403=e[2];if(_t403.length===r)return _t403;}return new(fn(t))(r);},_l=function _l(e,t,r,n,i){if(!e)return void t.push(0);var o,a,s=Me(),u=e[0],l=e[1],c=e[3];if("string"===u&&"gpu-buffer"===c)throw new Error("String tensor is not supported on GPU.");if("gpu-buffer"===c){var _t404=e[2].gpuBuffer,_r311=Br(pa(u));a=l.reduce(function(e,t){return e*t;},1)*_r311,o=s.jsepRegisterBuffer(n,i,_t404,a);}else{var _t405=e[2];if(Array.isArray(_t405)){a=4*_t405.length,o=s._malloc(a),r.push(o);var _e946=o/4;for(var _n216=0;_n216<_t405.length;_n216++){if("string"!=typeof _t405[_n216])throw new TypeError("tensor data at index ".concat(_n216," is not a string"));s.HEAPU32[_e946++]=Ge(_t405[_n216],r);}}else a=_t405.byteLength,o=s._malloc(a),r.push(o),s.HEAPU8.set(new Uint8Array(_t405.buffer,_t405.byteOffset,a),o);}var h=s.stackSave(),f=s.stackAlloc(4*l.length);try{var _e947=f/4;l.forEach(function(t){return s.HEAP32[_e947++]=t;});var _r312=s._OrtCreateTensor(pa(u),o,a,f,l.length,ma(c));0===_r312&&Re("Can't create tensor for input/output. session=".concat(n,", index=").concat(i,".")),t.push(_r312);}finally{s.stackRestore(h);}},Al=function Al(e){var t=new TextEncoder().encode(e),r=Me(),n=r._malloc(t.byteLength);r.HEAPU8.set(t,n);var i=r._OrtConfigure(n,t.byteLength);if(0===i)throw new Error("Can't get an configure key");var o=r.UTF8ToString(i);return r._OrtFree(i),o;},Tl=function Tl(e){var t=new TextEncoder().encode(e),r=Me(),n=r._malloc(t.byteLength);r.HEAPU8.set(t,n);var i=r._OrtAuth(n,t.byteLength);if(0===i)throw new Error("Can't get an auth result");var o=r.UTF8ToString(i);return r._OrtFree(i),o;},El=/*#__PURE__*/function(){var _ref104=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee167(e,t,r,n,i,o){var a,s,_s71,u,l,c,h,f,d,p,y,m,g,w,b,v,x,_,S,_Ji,_Ji2,_n217,_t406,_r313$,_r313,_s72,_b8,T,_I2,_E2,_e948,_e949,_r314,_o128,_s73,_n218,_i162,_t407,_i$_t,_u53,A,_loop17,_e950;return _regeneratorRuntime2().wrap(function _callee167$(_context173){while(1)switch(_context173.prev=_context173.next){case 0:a=Me(),s=Nr.get(e);if(s){_context173.next=3;break;}throw new Error("cannot run inference. invalid session id: ".concat(e));case 3:_s71=_slicedToArray2(s,4),u=_s71[0],l=_s71[1],c=_s71[2],h=_s71[3],f=t.length,d=n.length,p=0,y=[],m=[],g=[],w=[],b=a.stackSave(),v=a.stackAlloc(4*f),x=a.stackAlloc(4*f),_=a.stackAlloc(4*d),S=a.stackAlloc(4*d);_context173.prev=4;_Ji=Ji(o);_Ji2=_slicedToArray2(_Ji,2);p=_Ji2[0];y=_Ji2[1];for(_n217=0;_n217<f;_n217++)_l(r[_n217],m,w,e,t[_n217]);for(_t406=0;_t406<d;_t406++){_r313=i[_t406];_l("gpu-buffer"===((_r313$=_r313===null||_r313===void 0?void 0:_r313[3])!==null&&_r313$!==void 0?_r313$:"")?_r313:null,g,w,e,f+n[_t406]);}_b8=v/4,T=x/4,_I2=_/4,_E2=S/4;for(_e948=0;_e948<f;_e948++)a.HEAPU32[_b8++]=m[_e948],a.HEAPU32[T++]=l[t[_e948]];for(_e949=0;_e949<d;_e949++)a.HEAPU32[_I2++]=g[_e949],a.HEAPU32[_E2++]=c[n[_e949]];if(!h){_context173.next=31;break;}_r314=h.handle,_o128=h.outputPreferredLocations,_s73=h.outputPreferredLocationsEncoded;if(!(l.length!==f)){_context173.next=18;break;}throw new Error("input count from feeds (".concat(f,") is expected to be always equal to model's input count (").concat(l.length,")."));case 18:_n218=0;case 19:if(!(_n218<f)){_context173.next=30;break;}_i162=t[_n218];_context173.next=23;return a._OrtBindInput(_r314,l[_i162],m[_n218]);case 23:_context173.t0=_context173.sent;_context173.t1=0!==_context173.t0;if(!_context173.t1){_context173.next=27;break;}Re("Can't bind input[".concat(_n218,"] for session=").concat(e,"."));case 27:_n218++;_context173.next=19;break;case 30:for(_t407=0;_t407<d;_t407++){_u53=n[_t407];(_i$_t=i[_t407])!==null&&_i$_t!==void 0&&_i$_t[3]?0!==a._OrtBindOutput(_r314,c[_u53],g[_t407],0)&&Re("Can't bind pre-allocated output[".concat(_t407,"] for session=").concat(e,".")):0!==a._OrtBindOutput(_r314,c[_u53],0,_s73[_u53])&&Re("Can't bind output[".concat(_t407,"] to ").concat(_o128[_t407]," for session=").concat(e,"."));}case 31:if(!h){_context173.next=37;break;}_context173.next=34;return a._OrtRunWithBinding(u,h.handle,d,_,p);case 34:_context173.t2=_context173.sent;_context173.next=40;break;case 37:_context173.next=39;return a._OrtRun(u,x,v,f,S,d,_,p);case 39:_context173.t2=_context173.sent;case 40:_s72=_context173.t2;0!==_s72&&Re("failed to call OrtRun().");A=[];_loop17=/*#__PURE__*/_regeneratorRuntime2().mark(function _loop17(){var t,r,o,s,u,l,_o129,_c36,_f23,_d22,_p20,_e951,_y14,_m12,_e952,_t408,_r315,_n219,_i163,_e953,_n220,_t409;return _regeneratorRuntime2().wrap(function _loop17$(_context172){while(1)switch(_context172.prev=_context172.next){case 0:t=a.HEAPU32[_/4+_e950];if(!(t===g[_e950])){_context172.next=4;break;}A.push(i[_e950]);return _context172.abrupt("return",1);case 4:o=a.stackSave(),s=a.stackAlloc(16),u=!1,l=0;_context172.prev=5;0!==a._OrtGetTensorData(t,s,s+4,s+8,s+12)&&Re("Can't access output tensor data on index ".concat(_e950,"."));_o129=s/4,_c36=a.HEAPU32[_o129++];l=a.HEAPU32[_o129++];_f23=a.HEAPU32[_o129++],_d22=a.HEAPU32[_o129++],_p20=[];for(_e951=0;_e951<_d22;_e951++)_p20.push(a.HEAPU32[_f23/4+_e951]);a._OrtFree(_f23);_y14=_p20.reduce(function(e,t){return e*t;},1);r=nt(_c36);_m12=h===null||h===void 0?void 0:h.outputPreferredLocations[n[_e950]];if(!("string"===r)){_context172.next=23;break;}if(!("gpu-buffer"===_m12)){_context172.next=18;break;}throw new Error("String tensor is not supported on GPU.");case 18:_e952=[],_t408=l/4;for(_r315=0;_r315<_y14;_r315++){_n219=a.HEAPU32[_t408++],_i163=_r315===_y14-1?void 0:a.HEAPU32[_t408]-_n219;_e952.push(a.UTF8ToString(_n219,_i163));}A.push([r,_p20,_e952,"cpu"]);_context172.next=32;break;case 23:if(!("gpu-buffer"===_m12&&_y14>0)){_context172.next=30;break;}_e953=a.jsepGetBuffer(l),_n220=Br(_c36);if(!(void 0===_n220||!hn(r))){_context172.next=27;break;}throw new Error("Unsupported data type: ".concat(r));case 27:u=!0,A.push([r,_p20,{gpuBuffer:_e953,download:a.jsepCreateDownloader(_e953,_y14*_n220,r),dispose:function dispose(){a._OrtReleaseTensor(t);}},"gpu-buffer"]);_context172.next=32;break;case 30:_t409=om(i[_e950],r,_y14);new Uint8Array(_t409.buffer,_t409.byteOffset,_t409.byteLength).set(a.HEAPU8.subarray(l,l+_t409.byteLength)),A.push([r,_p20,_t409,"cpu"]);case 32:_context172.prev=32;a.stackRestore(o),"string"===r&&l&&a._free(l),u||a._OrtReleaseTensor(t);return _context172.finish(32);case 35:case"end":return _context172.stop();}},_loop17,null,[[5,,32,35]]);});_e950=0;case 45:if(!(_e950<d)){_context173.next=52;break;}return _context173.delegateYield(_loop17(),"t3",47);case 47:if(!_context173.t3){_context173.next=49;break;}return _context173.abrupt("continue",49);case 49:_e950++;_context173.next=45;break;case 52:return _context173.abrupt("return",(h&&a._OrtClearBoundOutputs(h.handle),A));case 53:_context173.prev=53;a.stackRestore(b),m.forEach(function(e){return a._OrtReleaseTensor(e);}),g.forEach(function(e){return a._OrtReleaseTensor(e);}),w.forEach(function(e){return a._free(e);}),0!==p&&a._OrtReleaseRunOptions(p),y.forEach(function(e){return a._free(e);});return _context173.finish(53);case 56:case"end":return _context173.stop();}},_callee167,null,[[4,,53,56]]);}));return function El(_x201,_x202,_x203,_x204,_x205,_x206){return _ref104.apply(this,arguments);};}(),Ol=function Ol(e){var t=Me(),r=Nr.get(e);if(!r)throw new Error("invalid session id");var n=r[0],i=t._OrtEndProfiling(n);0===i&&Re("Can't get an profile file name."),t._OrtFree(i);},Ga=function Ga(e){var t=[];var _iterator76=_createForOfIteratorHelper2(e),_step76;try{for(_iterator76.s();!(_step76=_iterator76.n()).done;){var r=_step76.value;var _e954=r[2];!Array.isArray(_e954)&&"buffer"in _e954&&t.push(_e954.buffer);}}catch(err){_iterator76.e(err);}finally{_iterator76.f();}return t;};}),Bl=ur(function(e,t){t.exports='/*!\n * ONNX Runtime Web v1.17.0\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n"use strict";(()=>{var Cn=Object.defineProperty;var rd=Object.getOwnPropertyDescriptor;var nd=Object.getOwnPropertyNames;var od=Object.prototype.hasOwnProperty;var q=(e,t)=>()=>(e&&(t=e(e=0)),t);var wr=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),vr=(e,t)=>{for(var r in t)Cn(e,r,{get:t[r],enumerable:!0})},ad=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of nd(t))!od.call(e,n)&&n!==r&&Cn(e,n,{get:()=>t[n],enumerable:!(o=rd(t,n))||o.enumerable});return e};var It=e=>ad(Cn({},"__esModule",{value:!0}),e);var In={};vr(In,{createReadStream:()=>Mo,readFile:()=>id,readFileSync:()=>sd});var id,sd,Mo,An=q(()=>{id=void 0,sd=void 0,Mo=void 0});var Tn={};vr(Tn,{join:()=>ud});var ud,En=q(()=>{ud=void 0});var On={};vr(On,{crypto:()=>dd});var dd,Pn=q(()=>{dd=void 0});var Vo=wr((zo,Bn)=>{"use strict";var Uo=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(e=e||__filename),function(t={}){var r=t,o,n;r.ready=new Promise((d,m)=>{o=d,n=m}),r.mountExternalData=(d,m)=>{(r.Ka||(r.Ka=new Map)).set(d,m)},r.unmountExternalData=()=>{delete r.Ka},r.jsepInit=(d,m,b,x,O,N,L,te)=>{r.gb=d,r.Wa=m,r.Ya=b,r.Qa=x,r.Xa=O,r.Ba=N,r.Za=L,r.$a=te,m=(ee,se,ue)=>(...ve)=>{let Ie=Je,B=se?.();ve=ee(...ve);let de=se?.();return B!==de&&(ee=de,ue(B),se=ue=null),Je!=Ie?kr():ve},b=ee=>async(...se)=>{try{if(r.Ja)throw Error("Session already started");let ue=r.Ja={ab:se[0],errors:[]},ve=await ee(...se);if(r.Ja!==ue)throw Error("Session mismatch");d.flush();let Ie=ue.errors;if(0<Ie.length){let B=await Promise.all(Ie);if(B=B.filter(de=>de),0<B.length)throw Error(B.join(`\n`))}return ve}finally{r.Ja=null}},r._OrtRun=b(m(r._OrtRun,()=>r._OrtRun,ee=>r._OrtRun=ee)),r._OrtRunWithBinding=b(m(r._OrtRunWithBinding,()=>r._OrtRunWithBinding,ee=>r._OrtRunWithBinding=ee)),r._OrtBindInput=m(r._OrtBindInput,()=>r._OrtBindInput,ee=>r._OrtBindInput=ee),r.jsepRegisterBuffer=(ee,se,ue,ve)=>d.registerBuffer(ee,se,ue,ve),r.jsepUnregisterBuffers=ee=>{d.unregisterBuffers(ee)},r.jsepGetBuffer=ee=>d.getBuffer(ee),r.jsepCreateDownloader=(ee,se,ue)=>d.createDownloader(ee,se,ue)};var s=Object.assign({},r),u="./this.program",l=(d,m)=>{throw m},a=typeof window=="object",p=typeof importScripts=="function",h=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",g="",w,v,y;if(h){var _=(An(),It(In)),A=(En(),It(Tn));g=p?A.dirname(g)+"/":__dirname+"/",w=(d,m)=>(d=Ne(d)?new URL(d):A.normalize(d),_.readFileSync(d,m?void 0:"utf8")),y=d=>(d=w(d,!0),d.buffer||(d=new Uint8Array(d)),d),v=(d,m,b,x=!0)=>{d=Ne(d)?new URL(d):A.normalize(d),_.readFile(d,x?void 0:"utf8",(O,N)=>{O?b(O):m(x?N.buffer:N)})},!r.thisProgram&&1<process.argv.length&&(u=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),l=(d,m)=>{throw process.exitCode=d,m},r.inspect=()=>"[Emscripten Module object]"}else(a||p)&&(p?g=self.location.href:typeof document<"u"&&document.currentScript&&(g=document.currentScript.src),e&&(g=e),g.indexOf("blob:")!==0?g=g.substr(0,g.replace(/[?#].*/,"").lastIndexOf("/")+1):g="",w=d=>{var m=new XMLHttpRequest;return m.open("GET",d,!1),m.send(null),m.responseText},p&&(y=d=>{var m=new XMLHttpRequest;return m.open("GET",d,!1),m.responseType="arraybuffer",m.send(null),new Uint8Array(m.response)}),v=(d,m,b)=>{var x=new XMLHttpRequest;x.open("GET",d,!0),x.responseType="arraybuffer",x.onload=()=>{x.status==200||x.status==0&&x.response?m(x.response):b()},x.onerror=b,x.send(null)});var S=console.log.bind(console),I=console.error.bind(console);Object.assign(r,s),s=null,typeof WebAssembly!="object"&&he("no native wasm support detected");var P,C=!1,V,D,G,T,W,pe,Z;function K(){var d=P.buffer;r.HEAP8=D=new Int8Array(d),r.HEAP16=new Int16Array(d),r.HEAPU8=G=new Uint8Array(d),r.HEAPU16=new Uint16Array(d),r.HEAP32=T=new Int32Array(d),r.HEAPU32=W=new Uint32Array(d),r.HEAPF32=pe=new Float32Array(d),r.HEAPF64=Z=new Float64Array(d)}var X=[],J=[],Ae=[],Oe=0,fe=null,Ce=null;function he(d){throw d="Aborted("+d+")",I(d),C=!0,V=1,d=new WebAssembly.RuntimeError(d+". Build with -sASSERTIONS for more info."),n(d),d}var ye=d=>d.startsWith("data:application/octet-stream;base64,"),Ne=d=>d.startsWith("file://"),Ue;if(Ue="ort-wasm-simd.wasm",!ye(Ue)){var Ge=Ue;Ue=r.locateFile?r.locateFile(Ge,g):g+Ge}function H(d){if(y)return y(d);throw"both async and sync fetching of the wasm failed"}function re(d){if(a||p){if(typeof fetch=="function"&&!Ne(d))return fetch(d,{credentials:"same-origin"}).then(m=>{if(!m.ok)throw"failed to load wasm binary file at \'"+d+"\'";return m.arrayBuffer()}).catch(()=>H(d));if(v)return new Promise((m,b)=>{v(d,x=>m(new Uint8Array(x)),b)})}return Promise.resolve().then(()=>H(d))}function be(d,m,b){return re(d).then(x=>WebAssembly.instantiate(x,m)).then(x=>x).then(b,x=>{I(`failed to asynchronously prepare wasm: ${x}`),he(x)})}function rt(d,m){var b=Ue;return typeof WebAssembly.instantiateStreaming!="function"||ye(b)||Ne(b)||h||typeof fetch!="function"?be(b,d,m):fetch(b,{credentials:"same-origin"}).then(x=>WebAssembly.instantiateStreaming(x,d).then(m,function(O){return I(`wasm streaming compile failed: ${O}`),I("falling back to ArrayBuffer instantiation"),be(b,d,m)}))}var ze,Be={898080:(d,m,b,x)=>{if(typeof r>"u"||!r.Ka)return 1;if(d=je(d>>>0),d.startsWith("./")&&(d=d.substring(2)),d=r.Ka.get(d),!d)return 2;if(m>>>=0,b>>>=0,m+b>d.byteLength)return 3;try{return G.set(d.subarray(m,m+b),x>>>0>>>0),0}catch{return 4}},898581:d=>r.Wa(d),898614:d=>r.Ya(d),898646:(d,m,b)=>{r.Qa(d,m,b,!0)},898685:(d,m,b)=>{r.Qa(d,m,b)},898718:d=>{r.Ba("Abs",d,void 0)},898769:d=>{r.Ba("Neg",d,void 0)},898820:d=>{r.Ba("Floor",d,void 0)},898873:d=>{r.Ba("Ceil",d,void 0)},898925:d=>{r.Ba("Reciprocal",d,void 0)},898983:d=>{r.Ba("Sqrt",d,void 0)},899035:d=>{r.Ba("Exp",d,void 0)},899086:d=>{r.Ba("Erf",d,void 0)},899137:d=>{r.Ba("Sigmoid",d,void 0)},899192:d=>{r.Ba("Log",d,void 0)},899243:d=>{r.Ba("Sin",d,void 0)},899294:d=>{r.Ba("Cos",d,void 0)},899345:d=>{r.Ba("Tan",d,void 0)},899396:d=>{r.Ba("Asin",d,void 0)},899448:d=>{r.Ba("Acos",d,void 0)},899500:d=>{r.Ba("Atan",d,void 0)},899552:d=>{r.Ba("Sinh",d,void 0)},899604:d=>{r.Ba("Cosh",d,void 0)},899656:d=>{r.Ba("Asinh",d,void 0)},899709:d=>{r.Ba("Acosh",d,void 0)},899762:d=>{r.Ba("Atanh",d,void 0)},899815:d=>{r.Ba("Tanh",d,void 0)},899867:d=>{r.Ba("Not",d,void 0)},899918:(d,m,b)=>{r.Ba("Clip",d,{min:m,max:b})},899987:d=>{r.Ba("Clip",d,void 0)},900039:(d,m)=>{r.Ba("Elu",d,{alpha:m})},900097:d=>{r.Ba("Relu",d,void 0)},900149:(d,m)=>{r.Ba("LeakyRelu",d,{alpha:m})},900213:(d,m)=>{r.Ba("ThresholdedRelu",d,{alpha:m})},900283:(d,m)=>{r.Ba("Cast",d,{to:m})},900341:d=>{r.Ba("Add",d,void 0)},900392:d=>{r.Ba("Sub",d,void 0)},900443:d=>{r.Ba("Mul",d,void 0)},900494:d=>{r.Ba("Div",d,void 0)},900545:d=>{r.Ba("Pow",d,void 0)},900596:d=>{r.Ba("Equal",d,void 0)},900649:d=>{r.Ba("Greater",d,void 0)},900704:d=>{r.Ba("GreaterOrEqual",d,void 0)},900766:d=>{r.Ba("Less",d,void 0)},900818:d=>{r.Ba("LessOrEqual",d,void 0)},900877:(d,m,b,x,O)=>{r.Ba("ReduceMean",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901036:(d,m,b,x,O)=>{r.Ba("ReduceMax",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901194:(d,m,b,x,O)=>{r.Ba("ReduceMin",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901352:(d,m,b,x,O)=>{r.Ba("ReduceProd",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901511:(d,m,b,x,O)=>{r.Ba("ReduceSum",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901669:(d,m,b,x,O)=>{r.Ba("ReduceL1",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901826:(d,m,b,x,O)=>{r.Ba("ReduceL2",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},901983:(d,m,b,x,O)=>{r.Ba("ReduceLogSum",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},902144:(d,m,b,x,O)=>{r.Ba("ReduceSumSquare",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},902308:(d,m,b,x,O)=>{r.Ba("ReduceLogSumExp",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},902472:d=>{r.Ba("Where",d,void 0)},902525:(d,m,b)=>{r.Ba("Transpose",d,{perm:m?Array.from(T.subarray(m>>>0,b>>>0)):[]})},902633:(d,m,b,x,O,N,L,te,ee,se,ue,ve,Ie,B,de)=>{r.Ba("ConvTranspose",d,{format:ee?"NHWC":"NCHW",autoPad:m,dilations:[b],group:x,kernel_shape:[O],pads:[N,L],strides:[te],wIsConst:()=>!!D[se>>>0],outputPadding:ue?Array.from(T.subarray(ue>>>0,ve>>>0)):[],outputShape:Ie?Array.from(T.subarray(Ie>>>0,B>>>0)):[],activation:je(de)})},903035:(d,m,b,x,O,N,L,te,ee,se,ue,ve,Ie,B)=>{r.Ba("ConvTranspose",d,{format:te?"NHWC":"NCHW",autoPad:m,dilations:Array.from(T.subarray(b>>>0,(b>>>0)+2>>>0)),group:x,kernelShape:Array.from(T.subarray(O>>>0,(O>>>0)+2>>>0)),pads:Array.from(T.subarray(N>>>0,(N>>>0)+4>>>0)),strides:Array.from(T.subarray(L>>>0,(L>>>0)+2>>>0)),wIsConst:()=>!!D[ee>>>0],outputPadding:se?Array.from(T.subarray(se>>>0,ue>>>0)):[],outputShape:ve?Array.from(T.subarray(ve>>>0,Ie>>>0)):[],activation:je(B)})},903600:(d,m,b,x,O,N,L,te,ee,se,ue,ve,Ie,B,de)=>{r.Ba("ConvTranspose",d,{format:ee?"NHWC":"NCHW",autoPad:m,dilations:[b],group:x,kernel_shape:[O],pads:[N,L],strides:[te],wIsConst:()=>!!D[se>>>0],outputPadding:ue?Array.from(T.subarray(ue>>>0,ve>>>0)):[],outputShape:Ie?Array.from(T.subarray(Ie>>>0,B>>>0)):[],activation:je(de)})},904002:(d,m,b,x,O,N,L,te,ee,se,ue,ve,Ie,B)=>{r.Ba("ConvTranspose",d,{format:te?"NHWC":"NCHW",autoPad:m,dilations:Array.from(T.subarray(b>>>0,(b>>>0)+2>>>0)),group:x,kernelShape:Array.from(T.subarray(O>>>0,(O>>>0)+2>>>0)),pads:Array.from(T.subarray(N>>>0,(N>>>0)+4>>>0)),strides:Array.from(T.subarray(L>>>0,(L>>>0)+2>>>0)),wIsConst:()=>!!D[ee>>>0],outputPadding:se?Array.from(T.subarray(se>>>0,ue>>>0)):[],outputShape:ve?Array.from(T.subarray(ve>>>0,Ie>>>0)):[],activation:je(B)})},904567:(d,m)=>{r.Ba("GlobalAveragePool",d,{format:m?"NHWC":"NCHW"})},904658:(d,m,b,x,O,N,L,te,ee,se,ue,ve,Ie,B,de,Se)=>{r.Ba("AveragePool",d,{format:Se?"NHWC":"NCHW",auto_pad:m,ceil_mode:b,count_include_pad:x,storage_order:O,dilations:[N,L],kernel_shape:[te,ee],pads:[se,ue,ve,Ie],strides:[B,de]})},904942:(d,m)=>{r.Ba("GlobalAveragePool",d,{format:m?"NHWC":"NCHW"})},905033:(d,m,b,x,O,N,L,te,ee,se,ue,ve,Ie,B,de,Se)=>{r.Ba("AveragePool",d,{format:Se?"NHWC":"NCHW",auto_pad:m,ceil_mode:b,count_include_pad:x,storage_order:O,dilations:[N,L],kernel_shape:[te,ee],pads:[se,ue,ve,Ie],strides:[B,de]})},905317:(d,m)=>{r.Ba("GlobalMaxPool",d,{format:m?"NHWC":"NCHW"})},905404:(d,m,b,x,O,N,L,te,ee,se,ue,ve,Ie,B,de,Se)=>{r.Ba("MaxPool",d,{format:Se?"NHWC":"NCHW",auto_pad:m,ceil_mode:b,count_include_pad:x,storage_order:O,dilations:[N,L],kernel_shape:[te,ee],pads:[se,ue,ve,Ie],strides:[B,de]})},905684:(d,m)=>{r.Ba("GlobalMaxPool",d,{format:m?"NHWC":"NCHW"})},905771:(d,m,b,x,O,N,L,te,ee,se,ue,ve,Ie,B,de,Se)=>{r.Ba("MaxPool",d,{format:Se?"NHWC":"NCHW",auto_pad:m,ceil_mode:b,count_include_pad:x,storage_order:O,dilations:[N,L],kernel_shape:[te,ee],pads:[se,ue,ve,Ie],strides:[B,de]})},906051:(d,m,b,x,O)=>{r.Ba("Gemm",d,{alpha:m,beta:b,transA:x,transB:O})},906155:d=>{r.Ba("MatMul",d,void 0)},906209:(d,m,b,x)=>{r.Ba("ArgMax",d,{keepDims:!!m,selectLastIndex:!!b,axis:x})},906317:(d,m,b,x)=>{r.Ba("ArgMin",d,{keepDims:!!m,selectLastIndex:!!b,axis:x})},906425:(d,m)=>{r.Ba("Softmax",d,{axis:m})},906488:(d,m)=>{r.Ba("Concat",d,{axis:m})},906548:(d,m,b,x,O)=>{r.Ba("Split",d,{axis:m,numOutputs:b,splitSizes:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},906688:d=>{r.Ba("Expand",d,void 0)},906742:(d,m)=>{r.Ba("Gather",d,{axis:Number(m)})},906813:(d,m)=>{r.Ba("GatherElements",d,{axis:Number(m)})},906892:(d,m,b,x,O,N,L,te,ee,se,ue)=>{r.Ba("Resize",d,{antialias:m,axes:b?Array.from(T.subarray(b>>>0,x>>>0)):[],coordinateTransformMode:je(O),cubicCoeffA:N,excludeOutside:L,extrapolationValue:te,keepAspectRatioPolicy:je(ee),mode:je(se),nearestMode:je(ue)})},907238:(d,m,b,x,O,N,L)=>{r.Ba("Slice",d,{starts:m?Array.from(T.subarray(m>>>0,b>>>0)):[],ends:x?Array.from(T.subarray(x>>>0,O>>>0)):[],axes:N?Array.from(T.subarray(N>>>0,L>>>0)):[]})},907454:d=>{r.Ba("Tile",d,void 0)},907506:(d,m,b)=>{r.Ba("LayerNormalization",d,{axis:Number(m),epsilon:Number(b)})},907613:(d,m,b)=>{r.Ba("InstanceNormalization",d,{epsilon:m,format:b?"NHWC":"NCHW"})},907727:(d,m,b)=>{r.Ba("InstanceNormalization",d,{epsilon:m,format:b?"NHWC":"NCHW"})},907841:d=>{r.Ba("Range",d,void 0)},907894:(d,m)=>{r.Ba("Einsum",d,{equation:je(m)})},907975:(d,m,b,x,O)=>{r.Ba("Pad",d,{mode:m,value:b,pads:x?Array.from(T.subarray(x>>>0,O>>>0)):[]})},908102:(d,m,b,x,O,N)=>{r.Ba("BatchNormalization",d,{epsilon:m,momentum:b,spatial:!!O,trainingMode:!!x,format:N?"NHWC":"NCHW"})},908271:(d,m,b,x,O,N)=>{r.Ba("BatchNormalization",d,{epsilon:m,momentum:b,spatial:!!O,trainingMode:!!x,format:N?"NHWC":"NCHW"})},908440:(d,m,b)=>{r.Ba("CumSum",d,{exclusive:Number(m),reverse:Number(b)})},908537:(d,m,b,x,O,N,L,te,ee)=>{r.Ba("Attention",d,{numHeads:m,isUnidirectional:b,maskFilterValue:x,scale:O,doRotary:N,qkvHiddenSizes:L?Array.from(T.subarray(Number(te)>>>0,Number(te)+L>>>0)):[],pastPresentShareBuffer:!!ee})},908809:d=>{r.Ba("Gelu",d,void 0)},908861:(d,m,b,x,O,N)=>{r.Ba("MultiHeadAttention",d,{numHeads:m,isUnidirectional:b,maskFilterValue:x,scale:O,doRotary:N})},909020:d=>{r.Ba("BiasAdd",d,void 0)},909075:d=>{r.Ba("BiasSplitGelu",d,void 0)},909136:(d,m)=>{r.Ba("SkipLayerNormalization",d,{epsilon:m})},909217:(d,m,b,x,O,N,L,te,ee,se,ue,ve,Ie)=>{r.Ba("Conv",d,{format:ee?"NHWC":"NCHW",auto_pad:m,dilations:[b],group:x,kernel_shape:[O],pads:N?Array.from(T.subarray(N>>>0,L>>>0)):[],strides:[te],w_is_const:()=>!!D[se>>>0],activation:je(ue),activation_params:ve?Array.from(pe.subarray(ve>>>0,Ie>>>0)):[]})},909587:(d,m,b,x,O,N,L,te,ee,se,ue,ve,Ie,B,de,Se)=>{r.Ba("Conv",d,{format:ve?"NHWC":"NCHW",auto_pad:m,dilations:[b,x],group:O,kernel_shape:[N,L],pads:te?Array.from(T.subarray(te>>>0,ee>>>0)):[],strides:[se,ue],w_is_const:()=>!!D[Ie>>>0],activation:je(B),activation_params:de?Array.from(pe.subarray(de>>>0,Se>>>0)):[]})},909978:d=>{r.Za(d)},910012:(d,m)=>r.$a(d,m,r.Ja.ab,r.Ja.errors)};function Ke(d){this.name="ExitStatus",this.message=`Program terminated with exit(${d})`,this.status=d}function St(d){this.Na=d-24,this.Ua=function(m){W[this.Na+4>>>2>>>0]=m},this.Ta=function(m){W[this.Na+8>>>2>>>0]=m},this.Ra=function(m,b){this.Sa(),this.Ua(m),this.Ta(b)},this.Sa=function(){W[this.Na+16>>>2>>>0]=0}}var nt=0,Vt=0,Et=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,xt=(d,m,b)=>{m>>>=0;var x=m+b;for(b=m;d[b]&&!(b>=x);)++b;if(16<b-m&&d.buffer&&Et)return Et.decode(d.subarray(m,b));for(x="";m<b;){var O=d[m++];if(O&128){var N=d[m++]&63;if((O&224)==192)x+=String.fromCharCode((O&31)<<6|N);else{var L=d[m++]&63;O=(O&240)==224?(O&15)<<12|N<<6|L:(O&7)<<18|N<<12|L<<6|d[m++]&63,65536>O?x+=String.fromCharCode(O):(O-=65536,x+=String.fromCharCode(55296|O>>10,56320|O&1023))}}else x+=String.fromCharCode(O)}return x},je=(d,m)=>(d>>>=0)?xt(G,d,m):"",rr=d=>{for(var m=0,b=0;b<d.length;++b){var x=d.charCodeAt(b);127>=x?m++:2047>=x?m+=2:55296<=x&&57343>=x?(m+=4,++b):m+=3}return m},Nt=(d,m,b,x)=>{if(b>>>=0,!(0<x))return 0;var O=b;x=b+x-1;for(var N=0;N<d.length;++N){var L=d.charCodeAt(N);if(55296<=L&&57343>=L){var te=d.charCodeAt(++N);L=65536+((L&1023)<<10)|te&1023}if(127>=L){if(b>=x)break;m[b++>>>0]=L}else{if(2047>=L){if(b+1>=x)break;m[b++>>>0]=192|L>>6}else{if(65535>=L){if(b+2>=x)break;m[b++>>>0]=224|L>>12}else{if(b+3>=x)break;m[b++>>>0]=240|L>>18,m[b++>>>0]=128|L>>12&63}m[b++>>>0]=128|L>>6&63}m[b++>>>0]=128|L&63}}return m[b>>>0]=0,b-O},_t=d=>d%4===0&&(d%100!==0||d%400===0),yt=[0,31,60,91,121,152,182,213,244,274,305,335],Wt=[0,31,59,90,120,151,181,212,243,273,304,334],Gt=d=>{var m=rr(d)+1,b=qt(m);return b&&Nt(d,G,b,m),b},Ot=[],nr=(d,m)=>{Ot.length=0;for(var b;b=G[d++>>>0];){var x=b!=105;x&=b!=112,m+=x&&m%8?4:0,Ot.push(b==112?W[m>>>2>>>0]:b==105?T[m>>>2>>>0]:Z[m>>>3>>>0]),m+=x?8:4}return Ot},ot={},or=()=>{if(!Ht){var d={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:u||"./this.program"},m;for(m in ot)ot[m]===void 0?delete d[m]:d[m]=ot[m];var b=[];for(m in d)b.push(`${m}=${d[m]}`);Ht=b}return Ht},Ht,Ye=[null,[],[]],yn=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return b=>crypto.getRandomValues(b);if(h)try{var d=(Pn(),It(On));if(d.randomFillSync)return b=>d.randomFillSync(b);var m=d.randomBytes;return b=>(b.set(m(b.byteLength)),b)}catch{}he("initRandomDevice")},Pe=d=>(Pe=yn())(d),ar=[31,29,31,30,31,30,31,31,30,31,30,31],Lt=[31,28,31,30,31,30,31,31,30,31,30,31];function ir(d){var m=Array(rr(d)+1);return Nt(d,m,0,m.length),m}function Er(d,m,b,x){function O(B,de,Se){for(B=typeof B=="number"?B.toString():B||"";B.length<de;)B=Se[0]+B;return B}function N(B,de){return O(B,de,"0")}function L(B,de){function Se(zr){return 0>zr?-1:0<zr?1:0}var $t;return($t=Se(B.getFullYear()-de.getFullYear()))===0&&($t=Se(B.getMonth()-de.getMonth()))===0&&($t=Se(B.getDate()-de.getDate())),$t}function te(B){switch(B.getDay()){case 0:return new Date(B.getFullYear()-1,11,29);case 1:return B;case 2:return new Date(B.getFullYear(),0,3);case 3:return new Date(B.getFullYear(),0,2);case 4:return new Date(B.getFullYear(),0,1);case 5:return new Date(B.getFullYear()-1,11,31);case 6:return new Date(B.getFullYear()-1,11,30)}}function ee(B){var de=B.Ha;for(B=new Date(new Date(B.Ia+1900,0,1).getTime());0<de;){var Se=B.getMonth(),$t=(_t(B.getFullYear())?ar:Lt)[Se];if(de>$t-B.getDate())de-=$t-B.getDate()+1,B.setDate(1),11>Se?B.setMonth(Se+1):(B.setMonth(0),B.setFullYear(B.getFullYear()+1));else{B.setDate(B.getDate()+de);break}}return Se=new Date(B.getFullYear()+1,0,4),de=te(new Date(B.getFullYear(),0,4)),Se=te(Se),0>=L(de,B)?0>=L(Se,B)?B.getFullYear()+1:B.getFullYear():B.getFullYear()-1}d>>>=0,m>>>=0,b>>>=0,x>>>=0;var se=W[x+40>>>2>>>0];x={eb:T[x>>>2>>>0],cb:T[x+4>>>2>>>0],La:T[x+8>>>2>>>0],Pa:T[x+12>>>2>>>0],Ma:T[x+16>>>2>>>0],Ia:T[x+20>>>2>>>0],Ga:T[x+24>>>2>>>0],Ha:T[x+28>>>2>>>0],hb:T[x+32>>>2>>>0],bb:T[x+36>>>2>>>0],fb:se?je(se):""},b=je(b),se={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var ue in se)b=b.replace(new RegExp(ue,"g"),se[ue]);var ve="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Ie="January February March April May June July August September October November December".split(" ");se={"%a":B=>ve[B.Ga].substring(0,3),"%A":B=>ve[B.Ga],"%b":B=>Ie[B.Ma].substring(0,3),"%B":B=>Ie[B.Ma],"%C":B=>N((B.Ia+1900)/100|0,2),"%d":B=>N(B.Pa,2),"%e":B=>O(B.Pa,2," "),"%g":B=>ee(B).toString().substring(2),"%G":B=>ee(B),"%H":B=>N(B.La,2),"%I":B=>(B=B.La,B==0?B=12:12<B&&(B-=12),N(B,2)),"%j":B=>{for(var de=0,Se=0;Se<=B.Ma-1;de+=(_t(B.Ia+1900)?ar:Lt)[Se++]);return N(B.Pa+de,3)},"%m":B=>N(B.Ma+1,2),"%M":B=>N(B.cb,2),"%n":()=>`\n`,"%p":B=>0<=B.La&&12>B.La?"AM":"PM","%S":B=>N(B.eb,2),"%t":()=>"\t","%u":B=>B.Ga||7,"%U":B=>N(Math.floor((B.Ha+7-B.Ga)/7),2),"%V":B=>{var de=Math.floor((B.Ha+7-(B.Ga+6)%7)/7);if(2>=(B.Ga+371-B.Ha-2)%7&&de++,de)de==53&&(Se=(B.Ga+371-B.Ha)%7,Se==4||Se==3&&_t(B.Ia)||(de=1));else{de=52;var Se=(B.Ga+7-B.Ha-1)%7;(Se==4||Se==5&&_t(B.Ia%400-1))&&de++}return N(de,2)},"%w":B=>B.Ga,"%W":B=>N(Math.floor((B.Ha+7-(B.Ga+6)%7)/7),2),"%y":B=>(B.Ia+1900).toString().substring(2),"%Y":B=>B.Ia+1900,"%z":B=>{B=B.bb;var de=0<=B;return B=Math.abs(B)/60,(de?"+":"-")+("0000"+(B/60*100+B%60)).slice(-4)},"%Z":B=>B.fb,"%%":()=>"%"},b=b.replace(/%%/g,"\\0\\0");for(ue in se)b.includes(ue)&&(b=b.replace(new RegExp(ue,"g"),se[ue](x)));return b=b.replace(/\\0\\0/g,"%"),ue=ir(b),ue.length>m?0:(D.set(ue,d>>>0),ue.length-1)}var Pt=d=>{try{d()}catch(m){he(m)}};function bn(){var d=oe,m={};for(let[b,x]of Object.entries(d))m[b]=typeof x=="function"?function(){Ft.push(b);try{return x.apply(null,arguments)}finally{C||(Ft.pop(),Je&&ne===1&&Ft.length===0&&(ne=0,Pt(vt),typeof Fibers<"u"&&Fibers.ib()))}}:x;return m}var ne=0,Je=null,sr=0,Ft=[],ur={},Or={},Pr=0,jt=null,Br=[];function kr(){return new Promise((d,m)=>{jt={resolve:d,reject:m}})}function dr(){var d=qt(65548),m=d+12;W[d>>>2>>>0]=m,W[d+4>>>2>>>0]=m+65536,m=Ft[0];var b=ur[m];return b===void 0&&(b=Pr++,ur[m]=b,Or[b]=m),T[d+8>>>2>>>0]=b,d}function Rr(d){if(!C){if(ne===0){var m=!1,b=!1;d((x=0)=>{if(!C&&(sr=x,m=!0,b)){ne=2,Pt(()=>gr(Je)),typeof Browser<"u"&&Browser.Oa.Va&&Browser.Oa.resume(),x=!1;try{var O=(0,oe[Or[T[Je+8>>>2>>>0]]])()}catch(te){O=te,x=!0}var N=!1;if(!Je){var L=jt;L&&(jt=null,(x?L.reject:L.resolve)(O),N=!0)}if(x&&!N)throw O}}),b=!0,m||(ne=1,Je=dr(),typeof Browser<"u"&&Browser.Oa.Va&&Browser.Oa.pause(),Pt(()=>Yt(Je)))}else ne===2?(ne=0,Pt(yr),mr(Je),Je=null,Br.forEach(x=>{if(!C)try{x();try{V=V=x=V,r.onExit?.(x),C=!0,l(x,new Ke(x))}catch(O){O instanceof Ke||O=="unwind"||l(1,O)}}catch(O){O instanceof Ke||O=="unwind"||l(1,O)}})):he(`invalid state: ${ne}`);return sr}}function Dr(d){return Rr(m=>{d().then(m)})}var bt=[],Xe,wt,lr=[],cr=(d,m)=>{if(!wt){wt=new WeakMap;var b=Xe.length;if(wt)for(var x=0;x<0+b;x++){var O=x,N=bt[O];N||(O>=bt.length&&(bt.length=O+1),bt[O]=N=Xe.get(O)),(O=N)&&wt.set(O,x)}}if(b=wt.get(d)||0)return b;if(lr.length)b=lr.pop();else{try{Xe.grow(1)}catch(te){throw te instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":te}b=Xe.length-1}try{x=b,Xe.set(x,d),bt[x]=Xe.get(x)}catch(te){if(!(te instanceof TypeError))throw te;if(typeof WebAssembly.Function=="function"){x=WebAssembly.Function,O={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},N={parameters:[],results:m[0]=="v"?[]:[O[m[0]]]};for(var L=1;L<m.length;++L)N.parameters.push(O[m[L]]);m=new x(N,d)}else{for(x=[1],O=m.slice(0,1),m=m.slice(1),N={i:127,p:127,j:126,f:125,d:124,e:111},x.push(96),L=m.length,128>L?x.push(L):x.push(L%128|128,L>>7),L=0;L<m.length;++L)x.push(N[m[L]]);O=="v"?x.push(0):x.push(1,N[O]),m=[0,97,115,109,1,0,0,0,1],O=x.length,128>O?m.push(O):m.push(O%128|128,O>>7),m.push.apply(m,x),m.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),m=new WebAssembly.Module(new Uint8Array(m)),m=new WebAssembly.Instance(m,{e:{f:d}}).exports.f}x=b,Xe.set(x,m),bt[x]=Xe.get(x)}return wt.set(d,b),b},Mr={n:function(d,m,b){return Dr(async()=>{await r.Xa(d,m,b)})},a:function(d,m,b){throw d>>>=0,new St(d).Ra(m>>>0,b>>>0),nt=d,Vt++,nt},g:function(){return 0},M:function(){},C:function(){},E:function(){},v:function(){return 0},K:function(){},F:function(){},J:function(){},m:function(){},D:function(){},A:function(){},L:function(){},B:function(){},N:()=>1,q:function(d,m,b){d=m+2097152>>>0<4194305-!!d?(d>>>0)+4294967296*m:NaN,b>>>=0,d=new Date(1e3*d),T[b>>>2>>>0]=d.getUTCSeconds(),T[b+4>>>2>>>0]=d.getUTCMinutes(),T[b+8>>>2>>>0]=d.getUTCHours(),T[b+12>>>2>>>0]=d.getUTCDate(),T[b+16>>>2>>>0]=d.getUTCMonth(),T[b+20>>>2>>>0]=d.getUTCFullYear()-1900,T[b+24>>>2>>>0]=d.getUTCDay(),T[b+28>>>2>>>0]=(d.getTime()-Date.UTC(d.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},r:function(d,m,b){d=m+2097152>>>0<4194305-!!d?(d>>>0)+4294967296*m:NaN,b>>>=0,d=new Date(1e3*d),T[b>>>2>>>0]=d.getSeconds(),T[b+4>>>2>>>0]=d.getMinutes(),T[b+8>>>2>>>0]=d.getHours(),T[b+12>>>2>>>0]=d.getDate(),T[b+16>>>2>>>0]=d.getMonth(),T[b+20>>>2>>>0]=d.getFullYear()-1900,T[b+24>>>2>>>0]=d.getDay(),T[b+28>>>2>>>0]=(_t(d.getFullYear())?yt:Wt)[d.getMonth()]+d.getDate()-1|0,T[b+36>>>2>>>0]=-(60*d.getTimezoneOffset()),m=new Date(d.getFullYear(),6,1).getTimezoneOffset();var x=new Date(d.getFullYear(),0,1).getTimezoneOffset();T[b+32>>>2>>>0]=(m!=x&&d.getTimezoneOffset()==Math.min(x,m))|0},s:function(d){d>>>=0;var m=new Date(T[d+20>>>2>>>0]+1900,T[d+16>>>2>>>0],T[d+12>>>2>>>0],T[d+8>>>2>>>0],T[d+4>>>2>>>0],T[d>>>2>>>0],0),b=T[d+32>>>2>>>0],x=m.getTimezoneOffset(),O=new Date(m.getFullYear(),6,1).getTimezoneOffset(),N=new Date(m.getFullYear(),0,1).getTimezoneOffset(),L=Math.min(N,O);return 0>b?T[d+32>>>2>>>0]=+(O!=N&&L==x):0<b!=(L==x)&&(O=Math.max(N,O),m.setTime(m.getTime()+6e4*((0<b?L:O)-x))),T[d+24>>>2>>>0]=m.getDay(),T[d+28>>>2>>>0]=(_t(m.getFullYear())?yt:Wt)[m.getMonth()]+m.getDate()-1|0,T[d>>>2>>>0]=m.getSeconds(),T[d+4>>>2>>>0]=m.getMinutes(),T[d+8>>>2>>>0]=m.getHours(),T[d+12>>>2>>>0]=m.getDate(),T[d+16>>>2>>>0]=m.getMonth(),T[d+20>>>2>>>0]=m.getYear(),d=m.getTime(),isNaN(d)?(T[pr()>>>2>>>0]=61,d=-1):d/=1e3,fr((ze=d,1<=+Math.abs(ze)?0<ze?+Math.floor(ze/4294967296)>>>0:~~+Math.ceil((ze-+(~~ze>>>0))/4294967296)>>>0:0)),d>>>0},o:function(){return-52},p:function(){},y:function(d,m,b){function x(ee){return(ee=ee.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?ee[1]:"GMT"}b>>>=0;var O=new Date().getFullYear(),N=new Date(O,0,1),L=new Date(O,6,1);O=N.getTimezoneOffset();var te=L.getTimezoneOffset();W[d>>>0>>>2>>>0]=60*Math.max(O,te),T[m>>>0>>>2>>>0]=+(O!=te),d=x(N),m=x(L),d=Gt(d),m=Gt(m),te<O?(W[b>>>2>>>0]=d,W[b+4>>>2>>>0]=m):(W[b>>>2>>>0]=m,W[b+4>>>2>>>0]=d)},e:()=>{he("")},b:function(d,m,b){return d>>>=0,m=nr(m>>>0,b>>>0),Be[d].apply(null,m)},j:function(d,m,b){return d>>>=0,m=nr(m>>>0,b>>>0),Be[d].apply(null,m)},h:()=>Date.now(),z:function(){return 4294901760},c:()=>performance.now(),I:function(d,m,b){return m>>>=0,G.copyWithin(d>>>0>>>0,m>>>0,m+(b>>>0)>>>0)},w:function(d){d>>>=0;var m=G.length;if(4294901760<d)return!1;for(var b=1;4>=b;b*=2){var x=m*(1+.2/b);x=Math.min(x,d+100663296);var O=Math;x=Math.max(d,x);e:{O=(O.min.call(O,4294901760,x+(65536-x%65536)%65536)-P.buffer.byteLength+65535)/65536;try{P.grow(O),K();var N=1;break e}catch{}N=void 0}if(N)return!0}return!1},G:function(d,m){d>>>=0,m>>>=0;var b=0;return or().forEach((x,O)=>{var N=m+b;for(O=W[d+4*O>>>2>>>0]=N,N=0;N<x.length;++N)D[O++>>>0>>>0]=x.charCodeAt(N);D[O>>>0>>>0]=0,b+=x.length+1}),0},H:function(d,m){d>>>=0,m>>>=0;var b=or();W[d>>>2>>>0]=b.length;var x=0;return b.forEach(O=>x+=O.length+1),W[m>>>2>>>0]=x,0},f:()=>52,l:function(){return 52},t:function(){return 70},k:function(d,m,b,x){m>>>=0,b>>>=0,x>>>=0;for(var O=0,N=0;N<b;N++){var L=W[m>>>2>>>0],te=W[m+4>>>2>>>0];m+=8;for(var ee=0;ee<te;ee++){var se=G[L+ee>>>0],ue=Ye[d];se===0||se===10?((d===1?S:I)(xt(ue,0)),ue.length=0):ue.push(se)}O+=te}return W[x>>>2>>>0]=O,0},u:function(d,m){return d>>>=0,Pe(G.subarray(d>>>0,d+(m>>>0)>>>0)),0},x:Er,d:function(d,m,b,x){return Er(d>>>0,m>>>0,b>>>0,x>>>0)},i:function(d,m,b,x){let O=Xe.length;d=new Uint8Array(G.slice(d+m,d+b));try{var N=new WebAssembly.Module(d),L=new WebAssembly.Instance(N,{env:{memory:P}}),te;for(te in L.exports)cr(L.exports[te]);return O<Xe.length?O:x}catch(ee){return console.log(ee),x}}},oe=function(){function d(b){return oe=b.exports,oe=bn(),oe=Ur(),P=oe.O,K(),Xe=oe.wa,J.unshift(oe.P),Oe--,Oe==0&&(fe!==null&&(clearInterval(fe),fe=null),Ce&&(b=Ce,Ce=null,b())),oe}var m={a:Mr};if(Oe++,r.instantiateWasm)try{return r.instantiateWasm(m,d)}catch(b){I(`Module.instantiateWasm callback failed with error: ${b}`),n(b)}return rt(m,function(b){d(b.instance)}).catch(n),{}}();r._OrtInit=(d,m)=>(r._OrtInit=oe.Q)(d,m),r._OrtGetLastError=(d,m)=>(r._OrtGetLastError=oe.R)(d,m),r._OrtCreateSessionOptions=(d,m,b,x,O,N,L,te,ee,se)=>(r._OrtCreateSessionOptions=oe.S)(d,m,b,x,O,N,L,te,ee,se),r._OrtAppendExecutionProvider=(d,m)=>(r._OrtAppendExecutionProvider=oe.T)(d,m),r._OrtAddFreeDimensionOverride=(d,m,b)=>(r._OrtAddFreeDimensionOverride=oe.U)(d,m,b),r._OrtAddSessionConfigEntry=(d,m,b)=>(r._OrtAddSessionConfigEntry=oe.V)(d,m,b),r._OrtReleaseSessionOptions=d=>(r._OrtReleaseSessionOptions=oe.W)(d),r._OrtCreateSession=(d,m,b)=>(r._OrtCreateSession=oe.X)(d,m,b),r._OrtReleaseSession=d=>(r._OrtReleaseSession=oe.Y)(d),r._OrtGetInputOutputCount=(d,m,b)=>(r._OrtGetInputOutputCount=oe.Z)(d,m,b),r._OrtGetInputName=(d,m)=>(r._OrtGetInputName=oe._)(d,m),r._OrtGetOutputName=(d,m)=>(r._OrtGetOutputName=oe.$)(d,m),r._OrtFree=d=>(r._OrtFree=oe.aa)(d),r._OrtCreateTensor=(d,m,b,x,O,N)=>(r._OrtCreateTensor=oe.ba)(d,m,b,x,O,N),r._OrtGetTensorData=(d,m,b,x,O)=>(r._OrtGetTensorData=oe.ca)(d,m,b,x,O),r._OrtReleaseTensor=d=>(r._OrtReleaseTensor=oe.da)(d),r._OrtCreateRunOptions=(d,m,b,x)=>(r._OrtCreateRunOptions=oe.ea)(d,m,b,x),r._OrtAddRunConfigEntry=(d,m,b)=>(r._OrtAddRunConfigEntry=oe.fa)(d,m,b),r._OrtReleaseRunOptions=d=>(r._OrtReleaseRunOptions=oe.ga)(d),r._OrtCreateBinding=d=>(r._OrtCreateBinding=oe.ha)(d),r._OrtBindInput=(d,m,b)=>(r._OrtBindInput=oe.ia)(d,m,b),r._OrtBindOutput=(d,m,b,x)=>(r._OrtBindOutput=oe.ja)(d,m,b,x),r._OrtClearBoundOutputs=d=>(r._OrtClearBoundOutputs=oe.ka)(d),r._OrtReleaseBinding=d=>(r._OrtReleaseBinding=oe.la)(d),r._OrtRunWithBinding=(d,m,b,x,O)=>(r._OrtRunWithBinding=oe.ma)(d,m,b,x,O),r._OrtRun=(d,m,b,x,O,N,L,te)=>(r._OrtRun=oe.na)(d,m,b,x,O,N,L,te),r._OrtEndProfiling=d=>(r._OrtEndProfiling=oe.oa)(d),r._OrtConfigure=(d,m)=>(r._OrtConfigure=oe.pa)(d,m),r._OrtAuth=(d,m)=>(r._OrtAuth=oe.qa)(d,m),r._JsepOutput=(d,m,b)=>(r._JsepOutput=oe.ra)(d,m,b),r._JsepGetNodeName=d=>(r._JsepGetNodeName=oe.sa)(d);var pr=()=>(pr=oe.ta)(),qt=r._malloc=d=>(qt=r._malloc=oe.ua)(d),mr=r._free=d=>(mr=r._free=oe.va)(d),fr=d=>(fr=oe.xa)(d),hr=()=>(hr=oe.ya)(),Kt=d=>(Kt=oe.za)(d),Bt=d=>(Bt=oe.Aa)(d),Yt=d=>(Yt=oe.Ca)(d),vt=()=>(vt=oe.Da)(),gr=d=>(gr=oe.Ea)(d),yr=()=>(yr=oe.Fa)();r.___start_em_js=910124,r.___stop_em_js=910897;function Ur(){var d=oe;d=Object.assign({},d);var m=x=>()=>x()>>>0,b=x=>O=>x(O)>>>0;return d.ta=m(d.ta),d.ua=b(d.ua),d.ya=m(d.ya),d.Aa=b(d.Aa),d}r.stackAlloc=Bt,r.stackSave=hr,r.stackRestore=Kt,r.addFunction=cr,r.UTF8ToString=je,r.stringToUTF8=(d,m,b)=>Nt(d,G,m,b),r.lengthBytesUTF8=rr;var kt;Ce=function d(){kt||br(),kt||(Ce=d)};function br(){if(!(0<Oe)){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;){var d=r.preRun.shift();X.unshift(d)}for(;0<X.length;)X.shift()(r);if(!(0<Oe||kt||(kt=!0,r.calledRun=!0,C))){for(;0<J.length;)J.shift()(r);for(o(r);0<Ae.length;)Ae.shift()(r)}}}return br(),t.ready}})();typeof zo=="object"&&typeof Bn=="object"?Bn.exports=Uo:typeof define=="function"&&define.amd&&define([],()=>Uo)});var No=wr(()=>{});var Wo=wr(()=>{});var Go={};vr(Go,{cpus:()=>ld});var ld,Ho=q(()=>{ld=void 0});var jo=wr((Fo,kn)=>{"use strict";var Lo=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(e=e||__filename),function(t={}){function r(){return X.buffer!=fe.buffer&&Ge(),fe}function o(){return X.buffer!=fe.buffer&&Ge(),Ce}function n(){return X.buffer!=fe.buffer&&Ge(),he}function s(){return X.buffer!=fe.buffer&&Ge(),ye}function u(){return X.buffer!=fe.buffer&&Ge(),Ne}function l(){return X.buffer!=fe.buffer&&Ge(),Ue}var a=t,p,h;a.ready=new Promise((i,c)=>{p=i,h=c}),a.mountExternalData=(i,c)=>{(a.ib||(a.ib=new Map)).set(i,c)},a.unmountExternalData=()=>{delete a.ib},a.jsepInit=(i,c,f,$,E,R,U,Q)=>{a.Rb=i,a.Bb=c,a.Db=f,a.pb=$,a.Cb=E,a.Ua=R,a.Eb=U,a.Fb=Q,c=(ae,ie,ce)=>(...xe)=>{let Ee=ut,k=ie?.();xe=ae(...xe);let me=ie?.();return k!==me&&(ae=me,ce(k),ie=ce=null),ut!=Ee?Ku():xe},f=ae=>async(...ie)=>{try{if(a.hb)throw Error("Session already started");let ce=a.hb={Hb:ie[0],errors:[]},xe=await ae(...ie);if(a.hb!==ce)throw Error("Session mismatch");i.flush();let Ee=ce.errors;if(0<Ee.length){let k=await Promise.all(Ee);if(k=k.filter(me=>me),0<k.length)throw Error(k.join(`\n`))}return xe}finally{a.hb=null}},a._OrtRun=f(c(a._OrtRun,()=>a._OrtRun,ae=>a._OrtRun=ae)),a._OrtRunWithBinding=f(c(a._OrtRunWithBinding,()=>a._OrtRunWithBinding,ae=>a._OrtRunWithBinding=ae)),a._OrtBindInput=c(a._OrtBindInput,()=>a._OrtBindInput,ae=>a._OrtBindInput=ae),a.jsepRegisterBuffer=(ae,ie,ce,xe)=>i.registerBuffer(ae,ie,ce,xe),a.jsepUnregisterBuffers=ae=>{i.unregisterBuffers(ae)},a.jsepGetBuffer=ae=>i.getBuffer(ae),a.jsepCreateDownloader=(ae,ie,ce)=>i.createDownloader(ae,ie,ce)};var g=Object.assign({},a),w="./this.program",v=(i,c)=>{throw c},y=typeof window=="object",_=typeof importScripts=="function",A=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",S=a.ENVIRONMENT_IS_PTHREAD||!1,I="";function P(i){return a.locateFile?a.locateFile(i,I):I+i}var C,V,D;if(A){var G=(An(),It(In)),T=(En(),It(Tn));I=_?T.dirname(I)+"/":__dirname+"/",C=(c,f)=>(c=Et(c)?new URL(c):T.normalize(c),G.readFileSync(c,f?void 0:"utf8")),D=c=>(c=C(c,!0),c.buffer||(c=new Uint8Array(c)),c),V=(c,f,$,E=!0)=>{c=Et(c)?new URL(c):T.normalize(c),G.readFile(c,E?void 0:"utf8",(R,U)=>{R?$(R):f(E?U.buffer:U)})},!a.thisProgram&&1<process.argv.length&&(w=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),v=(c,f)=>{throw process.exitCode=c,f},a.inspect=()=>"[Emscripten Module object]";let i;try{i=No()}catch(c){throw console.error(\'The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?\'),c}global.Worker=i.Worker}else(y||_)&&(_?I=self.location.href:typeof document<"u"&&document.currentScript&&(I=document.currentScript.src),typeof e<"u"&&e&&(I=e),I.indexOf("blob:")!==0?I=I.substr(0,I.replace(/[?#].*/,"").lastIndexOf("/")+1):I="",A||(C=i=>{var c=new XMLHttpRequest;return c.open("GET",i,!1),c.send(null),c.responseText},_&&(D=i=>{var c=new XMLHttpRequest;return c.open("GET",i,!1),c.responseType="arraybuffer",c.send(null),new Uint8Array(c.response)}),V=(i,c,f)=>{var $=new XMLHttpRequest;$.open("GET",i,!0),$.responseType="arraybuffer",$.onload=()=>{$.status==200||$.status==0&&$.response?c($.response):f()},$.onerror=f,$.send(null)}));A&&typeof performance>"u"&&(global.performance=Wo().performance);var W=console.log.bind(console),pe=console.error.bind(console);A&&(W=(...i)=>G.writeSync(1,i.join(" ")+`\n`),pe=(...i)=>G.writeSync(2,i.join(" ")+`\n`));var Z=W,K=pe;Object.assign(a,g),g=null,typeof WebAssembly!="object"&&nt("no native wasm support detected");var X,J,Ae=!1,Oe,fe,Ce,he,ye,Ne,Ue;function Ge(){var i=X.buffer;a.HEAP8=fe=new Int8Array(i),a.HEAP16=new Int16Array(i),a.HEAPU8=Ce=new Uint8Array(i),a.HEAPU16=new Uint16Array(i),a.HEAP32=he=new Int32Array(i),a.HEAPU32=ye=new Uint32Array(i),a.HEAPF32=Ne=new Float32Array(i),a.HEAPF64=Ue=new Float64Array(i)}var H=16777216;if(S)X=a.wasmMemory;else if(a.wasmMemory)X=a.wasmMemory;else if(X=new WebAssembly.Memory({initial:H/65536,maximum:65536,shared:!0}),!(X.buffer instanceof SharedArrayBuffer))throw K("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),A&&K("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");Ge(),H=X.buffer.byteLength;var re=[],be=[],rt=[],ze=0,Be=null,Ke=null;function St(){if(ze--,ze==0&&(Be!==null&&(clearInterval(Be),Be=null),Ke)){var i=Ke;Ke=null,i()}}function nt(i){throw i="Aborted("+i+")",K(i),Ae=!0,Oe=1,i=new WebAssembly.RuntimeError(i+". Build with -sASSERTIONS for more info."),h(i),i}var Vt=i=>i.startsWith("data:application/octet-stream;base64,"),Et=i=>i.startsWith("file://"),xt;xt="ort-wasm-simd-threaded.wasm",Vt(xt)||(xt=P(xt));function je(i){if(D)return D(i);throw"both async and sync fetching of the wasm failed"}function rr(i){if(y||_){if(typeof fetch=="function"&&!Et(i))return fetch(i,{credentials:"same-origin"}).then(c=>{if(!c.ok)throw"failed to load wasm binary file at \'"+i+"\'";return c.arrayBuffer()}).catch(()=>je(i));if(V)return new Promise((c,f)=>{V(i,$=>c(new Uint8Array($)),f)})}return Promise.resolve().then(()=>je(i))}function Nt(i,c,f){return rr(i).then($=>WebAssembly.instantiate($,c)).then($=>$).then(f,$=>{K(`failed to asynchronously prepare wasm: ${$}`),nt($)})}function _t(i,c){var f=xt;return typeof WebAssembly.instantiateStreaming!="function"||Vt(f)||Et(f)||A||typeof fetch!="function"?Nt(f,i,c):fetch(f,{credentials:"same-origin"}).then($=>WebAssembly.instantiateStreaming($,i).then(c,function(E){return K(`wasm streaming compile failed: ${E}`),K("falling back to ArrayBuffer instantiation"),Nt(f,i,c)}))}var yt,Wt={902596:(i,c,f,$)=>{if(typeof a>"u"||!a.ib)return 1;if(i=Ye(i>>>0),i.startsWith("./")&&(i=i.substring(2)),i=a.ib.get(i),!i)return 2;if(c>>>=0,f>>>=0,$>>>=0,c+f>i.byteLength)return 3;try{return o().set(i.subarray(c,c+f),$>>>0),0}catch{return 4}},903097:i=>a.Bb(i),903130:i=>a.Db(i),903162:(i,c,f)=>{a.pb(i,c,f,!0)},903201:(i,c,f)=>{a.pb(i,c,f)},903234:i=>{a.Ua("Abs",i,void 0)},903285:i=>{a.Ua("Neg",i,void 0)},903336:i=>{a.Ua("Floor",i,void 0)},903389:i=>{a.Ua("Ceil",i,void 0)},903441:i=>{a.Ua("Reciprocal",i,void 0)},903499:i=>{a.Ua("Sqrt",i,void 0)},903551:i=>{a.Ua("Exp",i,void 0)},903602:i=>{a.Ua("Erf",i,void 0)},903653:i=>{a.Ua("Sigmoid",i,void 0)},903708:i=>{a.Ua("Log",i,void 0)},903759:i=>{a.Ua("Sin",i,void 0)},903810:i=>{a.Ua("Cos",i,void 0)},903861:i=>{a.Ua("Tan",i,void 0)},903912:i=>{a.Ua("Asin",i,void 0)},903964:i=>{a.Ua("Acos",i,void 0)},904016:i=>{a.Ua("Atan",i,void 0)},904068:i=>{a.Ua("Sinh",i,void 0)},904120:i=>{a.Ua("Cosh",i,void 0)},904172:i=>{a.Ua("Asinh",i,void 0)},904225:i=>{a.Ua("Acosh",i,void 0)},904278:i=>{a.Ua("Atanh",i,void 0)},904331:i=>{a.Ua("Tanh",i,void 0)},904383:i=>{a.Ua("Not",i,void 0)},904434:(i,c,f)=>{a.Ua("Clip",i,{min:c,max:f})},904503:i=>{a.Ua("Clip",i,void 0)},904555:(i,c)=>{a.Ua("Elu",i,{alpha:c})},904613:i=>{a.Ua("Relu",i,void 0)},904665:(i,c)=>{a.Ua("LeakyRelu",i,{alpha:c})},904729:(i,c)=>{a.Ua("ThresholdedRelu",i,{alpha:c})},904799:(i,c)=>{a.Ua("Cast",i,{to:c})},904857:i=>{a.Ua("Add",i,void 0)},904908:i=>{a.Ua("Sub",i,void 0)},904959:i=>{a.Ua("Mul",i,void 0)},905010:i=>{a.Ua("Div",i,void 0)},905061:i=>{a.Ua("Pow",i,void 0)},905112:i=>{a.Ua("Equal",i,void 0)},905165:i=>{a.Ua("Greater",i,void 0)},905220:i=>{a.Ua("GreaterOrEqual",i,void 0)},905282:i=>{a.Ua("Less",i,void 0)},905334:i=>{a.Ua("LessOrEqual",i,void 0)},905393:(i,c,f,$,E)=>{a.Ua("ReduceMean",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},905552:(i,c,f,$,E)=>{a.Ua("ReduceMax",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},905710:(i,c,f,$,E)=>{a.Ua("ReduceMin",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},905868:(i,c,f,$,E)=>{a.Ua("ReduceProd",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906027:(i,c,f,$,E)=>{a.Ua("ReduceSum",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906185:(i,c,f,$,E)=>{a.Ua("ReduceL1",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906342:(i,c,f,$,E)=>{a.Ua("ReduceL2",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906499:(i,c,f,$,E)=>{a.Ua("ReduceLogSum",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906660:(i,c,f,$,E)=>{a.Ua("ReduceSumSquare",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906824:(i,c,f,$,E)=>{a.Ua("ReduceLogSumExp",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},906988:i=>{a.Ua("Where",i,void 0)},907041:(i,c,f)=>{a.Ua("Transpose",i,{perm:c?Array.from(n().subarray(c>>>0,f>>>0)):[]})},907149:(i,c,f,$,E,R,U,Q,ae,ie,ce,xe,Ee,k,me)=>{a.Ua("ConvTranspose",i,{format:ae?"NHWC":"NCHW",autoPad:c,dilations:[f],group:$,kernel_shape:[E],pads:[R,U],strides:[Q],wIsConst:()=>!!r()[ie>>>0],outputPadding:ce?Array.from(n().subarray(ce>>>0,xe>>>0)):[],outputShape:Ee?Array.from(n().subarray(Ee>>>0,k>>>0)):[],activation:Ye(me)})},907551:(i,c,f,$,E,R,U,Q,ae,ie,ce,xe,Ee,k)=>{a.Ua("ConvTranspose",i,{format:Q?"NHWC":"NCHW",autoPad:c,dilations:Array.from(n().subarray(f>>>0,(f>>>0)+2>>>0)),group:$,kernelShape:Array.from(n().subarray(E>>>0,(E>>>0)+2>>>0)),pads:Array.from(n().subarray(R>>>0,(R>>>0)+4>>>0)),strides:Array.from(n().subarray(U>>>0,(U>>>0)+2>>>0)),wIsConst:()=>!!r()[ae>>>0],outputPadding:ie?Array.from(n().subarray(ie>>>0,ce>>>0)):[],outputShape:xe?Array.from(n().subarray(xe>>>0,Ee>>>0)):[],activation:Ye(k)})},908116:(i,c,f,$,E,R,U,Q,ae,ie,ce,xe,Ee,k,me)=>{a.Ua("ConvTranspose",i,{format:ae?"NHWC":"NCHW",autoPad:c,dilations:[f],group:$,kernel_shape:[E],pads:[R,U],strides:[Q],wIsConst:()=>!!r()[ie>>>0],outputPadding:ce?Array.from(n().subarray(ce>>>0,xe>>>0)):[],outputShape:Ee?Array.from(n().subarray(Ee>>>0,k>>>0)):[],activation:Ye(me)})},908518:(i,c,f,$,E,R,U,Q,ae,ie,ce,xe,Ee,k)=>{a.Ua("ConvTranspose",i,{format:Q?"NHWC":"NCHW",autoPad:c,dilations:Array.from(n().subarray(f>>>0,(f>>>0)+2>>>0)),group:$,kernelShape:Array.from(n().subarray(E>>>0,(E>>>0)+2>>>0)),pads:Array.from(n().subarray(R>>>0,(R>>>0)+4>>>0)),strides:Array.from(n().subarray(U>>>0,(U>>>0)+2>>>0)),wIsConst:()=>!!r()[ae>>>0],outputPadding:ie?Array.from(n().subarray(ie>>>0,ce>>>0)):[],outputShape:xe?Array.from(n().subarray(xe>>>0,Ee>>>0)):[],activation:Ye(k)})},909083:(i,c)=>{a.Ua("GlobalAveragePool",i,{format:c?"NHWC":"NCHW"})},909174:(i,c,f,$,E,R,U,Q,ae,ie,ce,xe,Ee,k,me,_e)=>{a.Ua("AveragePool",i,{format:_e?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:E,dilations:[R,U],kernel_shape:[Q,ae],pads:[ie,ce,xe,Ee],strides:[k,me]})},909458:(i,c)=>{a.Ua("GlobalAveragePool",i,{format:c?"NHWC":"NCHW"})},909549:(i,c,f,$,E,R,U,Q,ae,ie,ce,xe,Ee,k,me,_e)=>{a.Ua("AveragePool",i,{format:_e?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:E,dilations:[R,U],kernel_shape:[Q,ae],pads:[ie,ce,xe,Ee],strides:[k,me]})},909833:(i,c)=>{a.Ua("GlobalMaxPool",i,{format:c?"NHWC":"NCHW"})},909920:(i,c,f,$,E,R,U,Q,ae,ie,ce,xe,Ee,k,me,_e)=>{a.Ua("MaxPool",i,{format:_e?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:E,dilations:[R,U],kernel_shape:[Q,ae],pads:[ie,ce,xe,Ee],strides:[k,me]})},910200:(i,c)=>{a.Ua("GlobalMaxPool",i,{format:c?"NHWC":"NCHW"})},910287:(i,c,f,$,E,R,U,Q,ae,ie,ce,xe,Ee,k,me,_e)=>{a.Ua("MaxPool",i,{format:_e?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:E,dilations:[R,U],kernel_shape:[Q,ae],pads:[ie,ce,xe,Ee],strides:[k,me]})},910567:(i,c,f,$,E)=>{a.Ua("Gemm",i,{alpha:c,beta:f,transA:$,transB:E})},910671:i=>{a.Ua("MatMul",i,void 0)},910725:(i,c,f,$)=>{a.Ua("ArgMax",i,{keepDims:!!c,selectLastIndex:!!f,axis:$})},910833:(i,c,f,$)=>{a.Ua("ArgMin",i,{keepDims:!!c,selectLastIndex:!!f,axis:$})},910941:(i,c)=>{a.Ua("Softmax",i,{axis:c})},911004:(i,c)=>{a.Ua("Concat",i,{axis:c})},911064:(i,c,f,$,E)=>{a.Ua("Split",i,{axis:c,numOutputs:f,splitSizes:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},911204:i=>{a.Ua("Expand",i,void 0)},911258:(i,c)=>{a.Ua("Gather",i,{axis:Number(c)})},911329:(i,c)=>{a.Ua("GatherElements",i,{axis:Number(c)})},911408:(i,c,f,$,E,R,U,Q,ae,ie,ce)=>{a.Ua("Resize",i,{antialias:c,axes:f?Array.from(n().subarray(f>>>0,$>>>0)):[],coordinateTransformMode:Ye(E),cubicCoeffA:R,excludeOutside:U,extrapolationValue:Q,keepAspectRatioPolicy:Ye(ae),mode:Ye(ie),nearestMode:Ye(ce)})},911754:(i,c,f,$,E,R,U)=>{a.Ua("Slice",i,{starts:c?Array.from(n().subarray(c>>>0,f>>>0)):[],ends:$?Array.from(n().subarray($>>>0,E>>>0)):[],axes:R?Array.from(n().subarray(R>>>0,U>>>0)):[]})},911970:i=>{a.Ua("Tile",i,void 0)},912022:(i,c,f)=>{a.Ua("LayerNormalization",i,{axis:Number(c),epsilon:Number(f)})},912129:(i,c,f)=>{a.Ua("InstanceNormalization",i,{epsilon:c,format:f?"NHWC":"NCHW"})},912243:(i,c,f)=>{a.Ua("InstanceNormalization",i,{epsilon:c,format:f?"NHWC":"NCHW"})},912357:i=>{a.Ua("Range",i,void 0)},912410:(i,c)=>{a.Ua("Einsum",i,{equation:Ye(c)})},912491:(i,c,f,$,E)=>{a.Ua("Pad",i,{mode:c,value:f,pads:$?Array.from(n().subarray($>>>0,E>>>0)):[]})},912618:(i,c,f,$,E,R)=>{a.Ua("BatchNormalization",i,{epsilon:c,momentum:f,spatial:!!E,trainingMode:!!$,format:R?"NHWC":"NCHW"})},912787:(i,c,f,$,E,R)=>{a.Ua("BatchNormalization",i,{epsilon:c,momentum:f,spatial:!!E,trainingMode:!!$,format:R?"NHWC":"NCHW"})},912956:(i,c,f)=>{a.Ua("CumSum",i,{exclusive:Number(c),reverse:Number(f)})},913053:(i,c,f,$,E,R,U,Q,ae)=>{a.Ua("Attention",i,{numHeads:c,isUnidirectional:f,maskFilterValue:$,scale:E,doRotary:R,qkvHiddenSizes:U?Array.from(n().subarray(Number(Q)>>>0,Number(Q)+U>>>0)):[],pastPresentShareBuffer:!!ae})},913325:i=>{a.Ua("Gelu",i,void 0)},913377:(i,c,f,$,E,R)=>{a.Ua("MultiHeadAttention",i,{numHeads:c,isUnidirectional:f,maskFilterValue:$,scale:E,doRotary:R})},913536:i=>{a.Ua("BiasAdd",i,void 0)},913591:i=>{a.Ua("BiasSplitGelu",i,void 0)},913652:(i,c)=>{a.Ua("SkipLayerNormalization",i,{epsilon:c})},913733:(i,c,f,$,E,R,U,Q,ae,ie,ce,xe,Ee)=>{a.Ua("Conv",i,{format:ae?"NHWC":"NCHW",auto_pad:c,dilations:[f],group:$,kernel_shape:[E],pads:R?Array.from(n().subarray(R>>>0,U>>>0)):[],strides:[Q],w_is_const:()=>!!r()[ie>>>0],activation:Ye(ce),activation_params:xe?Array.from(u().subarray(xe>>>0,Ee>>>0)):[]})},914103:(i,c,f,$,E,R,U,Q,ae,ie,ce,xe,Ee,k,me,_e)=>{a.Ua("Conv",i,{format:xe?"NHWC":"NCHW",auto_pad:c,dilations:[f,$],group:E,kernel_shape:[R,U],pads:Q?Array.from(n().subarray(Q>>>0,ae>>>0)):[],strides:[ie,ce],w_is_const:()=>!!r()[Ee>>>0],activation:Ye(k),activation_params:me?Array.from(u().subarray(me>>>0,_e>>>0)):[]})},914494:i=>{a.Eb(i)},914528:(i,c)=>a.Fb(i,c,a.hb.Hb,a.hb.errors)};function Gt(i){this.name="ExitStatus",this.message=`Program terminated with exit(${i})`,this.status=i}var Ot=i=>{i.terminate(),i.onmessage=()=>{}},nr=i=>{ne.cb.length==0&&(Pt(),ne.qb(ne.cb[0]));var c=ne.cb.pop();if(!c)return 6;ne.eb.push(c),ne.$a[i.bb]=c,c.bb=i.bb;var f={cmd:"run",start_routine:i.Ib,arg:i.xb,pthread_ptr:i.bb};return A&&c.unref(),c.postMessage(f,i.Ob),0},ot=0,or=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Ht=(i,c,f)=>{c>>>=0;var $=c+f;for(f=c;i[f]&&!(f>=$);)++f;if(16<f-c&&i.buffer&&or)return or.decode(i.buffer instanceof SharedArrayBuffer?i.slice(c,f):i.subarray(c,f));for($="";c<f;){var E=i[c++];if(E&128){var R=i[c++]&63;if((E&224)==192)$+=String.fromCharCode((E&31)<<6|R);else{var U=i[c++]&63;E=(E&240)==224?(E&15)<<12|R<<6|U:(E&7)<<18|R<<12|U<<6|i[c++]&63,65536>E?$+=String.fromCharCode(E):(E-=65536,$+=String.fromCharCode(55296|E>>10,56320|E&1023))}}else $+=String.fromCharCode(E)}return $},Ye=(i,c)=>(i>>>=0)?Ht(o(),i,c):"",yn=i=>{var c=xn();return i=i(),Gr(c),i};function Pe(i,c){var f=arguments.length-2,$=arguments;return yn(()=>{for(var E=_n(8*f),R=E>>>3,U=0;U<f;U++){var Q=$[2+U];l()[R+U>>>0]=Q}return Co(i,f,E,c)})}function ar(i){if(S)return Pe(0,1,i);Oe=i,0<ot||(ne.Jb(),a.onExit?.(i),Ae=!0),v(i,new Gt(i))}var Lt=i=>{if(Oe=i,S)throw sr(i),"unwind";ar(i)},ir=i=>{i instanceof Gt||i=="unwind"||v(1,i)};function Er(){for(var i=a.numThreads;i--;)Pt();re.unshift(()=>{ze++,bn(()=>St())})}function Pt(){var i=P("ort-wasm-simd-threaded.worker.js");i=new Worker(i),ne.cb.push(i)}function bn(i){S?i():Promise.all(ne.cb.map(ne.qb)).then(i)}var ne={cb:[],eb:[],ub:[],$a:{},mb(){S?(ne.receiveObjectTransfer=ne.Gb,ne.threadInitTLS=ne.tb,ne.setExitStatus=ne.sb):Er()},sb:i=>Oe=i,Sb:["$terminateWorker"],Jb:()=>{for(var i of ne.eb)Ot(i);for(i of ne.cb)Ot(i);ne.cb=[],ne.eb=[],ne.$a=[]},rb:i=>{var c=i.bb;delete ne.$a[c],ne.cb.push(i),ne.eb.splice(ne.eb.indexOf(i),1),i.bb=0,$n(c)},Gb(){},tb(){ne.ub.forEach(i=>i())},qb:i=>new Promise(c=>{i.onmessage=R=>{R=R.data;var U=R.cmd;if(R.targetThread&&R.targetThread!=Wr()){var Q=ne.$a[R.targetThread];Q?Q.postMessage(R,R.transferList):K(`Internal error! Worker sent a message "${U}" to target pthread ${R.targetThread}, but that thread no longer exists!`)}else U==="checkMailbox"?Bt():U==="spawnThread"?nr(R):U==="cleanupThread"?ne.rb(ne.$a[R.thread]):U==="killThread"?(R=R.thread,U=ne.$a[R],delete ne.$a[R],Ot(U),$n(R),ne.eb.splice(ne.eb.indexOf(U),1),U.bb=0):U==="cancelThread"?ne.$a[R.thread].postMessage({cmd:"cancel"}):U==="loaded"?(i.loaded=!0,A&&!i.bb&&i.unref(),c(i)):U==="alert"?alert(`Thread ${R.threadId}: ${R.text}`):R.target==="setimmediate"?i.postMessage(R):U==="callHandler"?a[R.handler](...R.args):U&&K(`worker sent an unknown command ${U}`)},i.onerror=R=>{throw K(`worker sent an error! ${R.filename}:${R.lineno}: ${R.message}`),R},A&&(i.on("message",R=>i.onmessage({data:R})),i.on("error",R=>i.onerror(R)));var f=[],$=["onExit"],E;for(E of $)a.hasOwnProperty(E)&&f.push(E);i.postMessage({cmd:"load",handlers:f,urlOrBlob:a.mainScriptUrlOrBlob||e,wasmMemory:X,wasmModule:J})})};a.PThread=ne;var Je=i=>{for(;0<i.length;)i.shift()(a)};a.establishStackSpace=()=>{var i=Wr(),c=s()[i+52>>>2>>>0];i=s()[i+56>>>2>>>0],To(c,c-i),Gr(c)};function sr(i){if(S)return Pe(1,0,i);Lt(i)}a.invokeEntryPoint=(i,c)=>{i=Eo.apply(null,[i,c]),0<ot?ne.sb(i):Sn(i)};function Ft(i){this.lb=i-24,this.yb=function(c){s()[this.lb+4>>>2>>>0]=c},this.wb=function(c){s()[this.lb+8>>>2>>>0]=c},this.mb=function(c,f){this.vb(),this.yb(c),this.wb(f)},this.vb=function(){s()[this.lb+16>>>2>>>0]=0}}var ur=0,Or=0;function Pr(i,c,f,$){return S?Pe(2,1,i,c,f,$):jt(i,c,f,$)}function jt(i,c,f,$){if(i>>>=0,c>>>=0,f>>>=0,$>>>=0,typeof SharedArrayBuffer>"u")return K("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var E=[];return S&&E.length===0?Pr(i,c,f,$):(i={Ib:f,bb:i,xb:$,Ob:E},S?(i.Qb="spawnThread",postMessage(i,E),0):nr(i))}function Br(i,c,f){return S?Pe(3,1,i,c,f):0}function kr(i,c){if(S)return Pe(4,1,i,c)}var dr=i=>{for(var c=0,f=0;f<i.length;++f){var $=i.charCodeAt(f);127>=$?c++:2047>=$?c+=2:55296<=$&&57343>=$?(c+=4,++f):c+=3}return c},Rr=(i,c,f,$)=>{if(f>>>=0,!(0<$))return 0;var E=f;$=f+$-1;for(var R=0;R<i.length;++R){var U=i.charCodeAt(R);if(55296<=U&&57343>=U){var Q=i.charCodeAt(++R);U=65536+((U&1023)<<10)|Q&1023}if(127>=U){if(f>=$)break;c[f++>>>0]=U}else{if(2047>=U){if(f+1>=$)break;c[f++>>>0]=192|U>>6}else{if(65535>=U){if(f+2>=$)break;c[f++>>>0]=224|U>>12}else{if(f+3>=$)break;c[f++>>>0]=240|U>>18,c[f++>>>0]=128|U>>12&63}c[f++>>>0]=128|U>>6&63}c[f++>>>0]=128|U&63}}return c[f>>>0]=0,f-E},Dr=(i,c,f)=>Rr(i,o(),c,f);function bt(i,c){if(S)return Pe(5,1,i,c)}function Xe(i,c,f){if(S)return Pe(6,1,i,c,f)}function wt(i,c,f){return S?Pe(7,1,i,c,f):0}function lr(i,c){if(S)return Pe(8,1,i,c)}function cr(i,c,f){if(S)return Pe(9,1,i,c,f)}function Mr(i,c,f,$){if(S)return Pe(10,1,i,c,f,$)}function oe(i,c,f,$){if(S)return Pe(11,1,i,c,f,$)}function pr(i,c,f,$){if(S)return Pe(12,1,i,c,f,$)}function qt(i){if(S)return Pe(13,1,i)}function mr(i,c){if(S)return Pe(14,1,i,c)}function fr(i,c,f){if(S)return Pe(15,1,i,c,f)}var hr=()=>{if(!(0<ot))try{S?Sn(Oe):Lt(Oe)}catch(i){ir(i)}};function Kt(i){i>>>=0,typeof Atomics.Pb=="function"&&(Atomics.Pb(n(),i>>>2,i).value.then(Bt),i+=128,Atomics.store(n(),i>>>2,1))}a.__emscripten_thread_mailbox_await=Kt;var Bt=()=>{var i=Wr();if(i&&(Kt(i),!Ae))try{Io(),hr()}catch(c){ir(c)}};a.checkMailbox=Bt;var Yt=[],vt=i=>i%4===0&&(i%100!==0||i%400===0),gr=[0,31,60,91,121,152,182,213,244,274,305,335],yr=[0,31,59,90,120,151,181,212,243,273,304,334];function Ur(i,c,f,$,E,R,U,Q){return S?Pe(16,1,i,c,f,$,E,R,U,Q):-52}function kt(i,c,f,$,E,R,U){if(S)return Pe(17,1,i,c,f,$,E,R,U)}var br=i=>{var c=dr(i)+1,f=vn(c);return f&&Dr(i,f,c),f},d=[],m=(i,c)=>{d.length=0;for(var f;f=o()[i++>>>0];){var $=f!=105;$&=f!=112,c+=$&&c%8?4:0,d.push(f==112?s()[c>>>2>>>0]:f==105?n()[c>>>2>>>0]:l()[c>>>3>>>0]),c+=$?8:4}return d},b={},x=()=>{if(!O){var i={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:w||"./this.program"},c;for(c in b)b[c]===void 0?delete i[c]:i[c]=b[c];var f=[];for(c in i)f.push(`${c}=${i[c]}`);O=f}return O},O;function N(i,c){if(S)return Pe(18,1,i,c);i>>>=0,c>>>=0;var f=0;return x().forEach(($,E)=>{var R=c+f;for(E=s()[i+4*E>>>2>>>0]=R,R=0;R<$.length;++R)r()[E++>>>0>>>0]=$.charCodeAt(R);r()[E>>>0>>>0]=0,f+=$.length+1}),0}function L(i,c){if(S)return Pe(19,1,i,c);i>>>=0,c>>>=0;var f=x();s()[i>>>2>>>0]=f.length;var $=0;return f.forEach(E=>$+=E.length+1),s()[c>>>2>>>0]=$,0}function te(i){return S?Pe(20,1,i):52}function ee(i,c,f,$){return S?Pe(21,1,i,c,f,$):52}function se(i,c,f,$,E){return S?Pe(22,1,i,c,f,$,E):70}var ue=[null,[],[]];function ve(i,c,f,$){if(S)return Pe(23,1,i,c,f,$);c>>>=0,f>>>=0,$>>>=0;for(var E=0,R=0;R<f;R++){var U=s()[c>>>2>>>0],Q=s()[c+4>>>2>>>0];c+=8;for(var ae=0;ae<Q;ae++){var ie=o()[U+ae>>>0],ce=ue[i];ie===0||ie===10?((i===1?Z:K)(Ht(ce,0)),ce.length=0):ce.push(ie)}E+=Q}return s()[$>>>2>>>0]=E,0}var Ie=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return f=>(f.set(crypto.getRandomValues(new Uint8Array(f.byteLength))),f);if(A)try{var i=(Pn(),It(On));if(i.randomFillSync)return f=>i.randomFillSync(f);var c=i.randomBytes;return f=>(f.set(c(f.byteLength)),f)}catch{}nt("initRandomDevice")},B=i=>(B=Ie())(i),de=[31,29,31,30,31,30,31,31,30,31,30,31],Se=[31,28,31,30,31,30,31,31,30,31,30,31];function $t(i){var c=Array(dr(i)+1);return Rr(i,c,0,c.length),c}var zr=(i,c)=>{r().set(i,c>>>0)};function go(i,c,f,$){function E(k,me,_e){for(k=typeof k=="number"?k.toString():k||"";k.length<me;)k=_e[0]+k;return k}function R(k,me){return E(k,me,"0")}function U(k,me){function _e(Do){return 0>Do?-1:0<Do?1:0}var Rt;return(Rt=_e(k.getFullYear()-me.getFullYear()))===0&&(Rt=_e(k.getMonth()-me.getMonth()))===0&&(Rt=_e(k.getDate()-me.getDate())),Rt}function Q(k){switch(k.getDay()){case 0:return new Date(k.getFullYear()-1,11,29);case 1:return k;case 2:return new Date(k.getFullYear(),0,3);case 3:return new Date(k.getFullYear(),0,2);case 4:return new Date(k.getFullYear(),0,1);case 5:return new Date(k.getFullYear()-1,11,31);case 6:return new Date(k.getFullYear()-1,11,30)}}function ae(k){var me=k.fb;for(k=new Date(new Date(k.gb+1900,0,1).getTime());0<me;){var _e=k.getMonth(),Rt=(vt(k.getFullYear())?de:Se)[_e];if(me>Rt-k.getDate())me-=Rt-k.getDate()+1,k.setDate(1),11>_e?k.setMonth(_e+1):(k.setMonth(0),k.setFullYear(k.getFullYear()+1));else{k.setDate(k.getDate()+me);break}}return _e=new Date(k.getFullYear()+1,0,4),me=Q(new Date(k.getFullYear(),0,4)),_e=Q(_e),0>=U(me,k)?0>=U(_e,k)?k.getFullYear()+1:k.getFullYear():k.getFullYear()-1}i>>>=0,c>>>=0,f>>>=0,$>>>=0;var ie=s()[$+40>>>2>>>0];$={Mb:n()[$>>>2>>>0],Lb:n()[$+4>>>2>>>0],jb:n()[$+8>>>2>>>0],ob:n()[$+12>>>2>>>0],kb:n()[$+16>>>2>>>0],gb:n()[$+20>>>2>>>0],ab:n()[$+24>>>2>>>0],fb:n()[$+28>>>2>>>0],Tb:n()[$+32>>>2>>>0],Kb:n()[$+36>>>2>>>0],Nb:ie?Ye(ie):""},f=Ye(f),ie={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var ce in ie)f=f.replace(new RegExp(ce,"g"),ie[ce]);var xe="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Ee="January February March April May June July August September October November December".split(" ");ie={"%a":k=>xe[k.ab].substring(0,3),"%A":k=>xe[k.ab],"%b":k=>Ee[k.kb].substring(0,3),"%B":k=>Ee[k.kb],"%C":k=>R((k.gb+1900)/100|0,2),"%d":k=>R(k.ob,2),"%e":k=>E(k.ob,2," "),"%g":k=>ae(k).toString().substring(2),"%G":k=>ae(k),"%H":k=>R(k.jb,2),"%I":k=>(k=k.jb,k==0?k=12:12<k&&(k-=12),R(k,2)),"%j":k=>{for(var me=0,_e=0;_e<=k.kb-1;me+=(vt(k.gb+1900)?de:Se)[_e++]);return R(k.ob+me,3)},"%m":k=>R(k.kb+1,2),"%M":k=>R(k.Lb,2),"%n":()=>`\n`,"%p":k=>0<=k.jb&&12>k.jb?"AM":"PM","%S":k=>R(k.Mb,2),"%t":()=>"\t","%u":k=>k.ab||7,"%U":k=>R(Math.floor((k.fb+7-k.ab)/7),2),"%V":k=>{var me=Math.floor((k.fb+7-(k.ab+6)%7)/7);if(2>=(k.ab+371-k.fb-2)%7&&me++,me)me==53&&(_e=(k.ab+371-k.fb)%7,_e==4||_e==3&&vt(k.gb)||(me=1));else{me=52;var _e=(k.ab+7-k.fb-1)%7;(_e==4||_e==5&&vt(k.gb%400-1))&&me++}return R(me,2)},"%w":k=>k.ab,"%W":k=>R(Math.floor((k.fb+7-(k.ab+6)%7)/7),2),"%y":k=>(k.gb+1900).toString().substring(2),"%Y":k=>k.gb+1900,"%z":k=>{k=k.Kb;var me=0<=k;return k=Math.abs(k)/60,(me?"+":"-")+("0000"+(k/60*100+k%60)).slice(-4)},"%Z":k=>k.Nb,"%%":()=>"%"},f=f.replace(/%%/g,"\\0\\0");for(ce in ie)f.includes(ce)&&(f=f.replace(new RegExp(ce,"g"),ie[ce]($)));return f=f.replace(/\\0\\0/g,"%"),ce=$t(f),ce.length>c?0:(zr(ce,i),ce.length-1)}var Vr=i=>{try{i()}catch(c){nt(c)}};function Fu(){var i=Y,c={};for(let[f,$]of Object.entries(i))c[f]=typeof $=="function"?function(){Nr.push(f);try{return $.apply(null,arguments)}finally{Ae||(Nr.pop(),ut&&Ct===1&&Nr.length===0&&(Ct=0,ot+=1,Vr(Po),typeof Fibers<"u"&&Fibers.Ub()))}}:$;return c}var Ct=0,ut=null,yo=0,Nr=[],bo={},wo={},ju=0,wn=null,qu=[];function Ku(){return new Promise((i,c)=>{wn={resolve:i,reject:c}})}function Yu(){var i=vn(65548),c=i+12;s()[i>>>2>>>0]=c,s()[i+4>>>2>>>0]=c+65536,c=Nr[0];var f=bo[c];return f===void 0&&(f=ju++,bo[c]=f,wo[f]=c),c=f,n()[i+8>>>2>>>0]=c,i}function Zu(){var i=n()[ut+8>>>2>>>0];return i=Y[wo[i]],--ot,i()}function Ju(i){if(!Ae){if(Ct===0){var c=!1,f=!1;i(($=0)=>{if(!Ae&&(yo=$,c=!0,f)){Ct=2,Vr(()=>Bo(ut)),typeof Browser<"u"&&Browser.nb.Ab&&Browser.nb.resume(),$=!1;try{var E=Zu()}catch(Q){E=Q,$=!0}var R=!1;if(!ut){var U=wn;U&&(wn=null,($?U.reject:U.resolve)(E),R=!0)}if($&&!R)throw E}}),f=!0,c||(Ct=1,ut=Yu(),typeof Browser<"u"&&Browser.nb.Ab&&Browser.nb.pause(),Vr(()=>Oo(ut)))}else Ct===2?(Ct=0,Vr(ko),xo(ut),ut=null,qu.forEach($=>{if(!Ae)try{$(),hr()}catch(E){ir(E)}})):nt(`invalid state: ${Ct}`);return yo}}function Qu(i){return Ju(c=>{i().then(c)})}var Zt=[],at,Jt,vo=[],$o=(i,c)=>{if(!Jt){Jt=new WeakMap;var f=at.length;if(Jt)for(var $=0;$<0+f;$++){var E=$,R=Zt[E];R||(E>=Zt.length&&(Zt.length=E+1),Zt[E]=R=at.get(E)),(E=R)&&Jt.set(E,$)}}if(f=Jt.get(i)||0)return f;if(vo.length)f=vo.pop();else{try{at.grow(1)}catch(Q){throw Q instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":Q}f=at.length-1}try{$=f,at.set($,i),Zt[$]=at.get($)}catch(Q){if(!(Q instanceof TypeError))throw Q;if(typeof WebAssembly.Function=="function"){$=WebAssembly.Function,E={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},R={parameters:[],results:c[0]=="v"?[]:[E[c[0]]]};for(var U=1;U<c.length;++U)R.parameters.push(E[c[U]]);c=new $(R,i)}else{for($=[1],E=c.slice(0,1),c=c.slice(1),R={i:127,p:127,j:126,f:125,d:124,e:111},$.push(96),U=c.length,128>U?$.push(U):$.push(U%128|128,U>>7),U=0;U<c.length;++U)$.push(R[c[U]]);E=="v"?$.push(0):$.push(1,R[E]),c=[0,97,115,109,1,0,0,0,1],E=$.length,128>E?c.push(E):c.push(E%128|128,E>>7),c.push.apply(c,$),c.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),c=new WebAssembly.Module(new Uint8Array(c)),c=new WebAssembly.Instance(c,{e:{f:i}}).exports.f}$=f,at.set($,c),Zt[$]=at.get($)}return Jt.set(i,f),f};ne.mb();var Xu=[ar,sr,Pr,Br,kr,bt,Xe,wt,lr,cr,Mr,oe,pr,qt,mr,fr,Ur,kt,N,L,te,ee,se,ve],ed={r:function(i,c,f){return Qu(async()=>{await a.Cb(i,c,f)})},b:function(i,c,f){throw i>>>=0,new Ft(i).mb(c>>>0,f>>>0),ur=i,Or++,ur},P:function(i){_o(i>>>0,!_,1,!y,131072,!1),ne.tb()},n:function(i){i>>>=0,S?postMessage({cmd:"cleanupThread",thread:i}):ne.rb(ne.$a[i])},L:jt,i:Br,V:kr,H:bt,J:Xe,z:wt,T:lr,N:cr,S:Mr,p:oe,I:pr,F:qt,U:mr,G:fr,Y:()=>1,D:function(i,c){i>>>=0,i==c>>>0?setTimeout(()=>Bt()):S?postMessage({targetThread:i,cmd:"checkMailbox"}):(i=ne.$a[i])&&i.postMessage({cmd:"checkMailbox"})},M:function(i,c,f,$){c>>>=0,Yt.length=f,$=$>>>0>>>3;for(var E=0;E<f;E++)Yt[E]=l()[$+E>>>0];return i=0>i?Wt[-i-1]:Xu[i],ne.zb=c,c=i.apply(null,Yt),ne.zb=0,c},O:Kt,X:function(i){A&&ne.$a[i>>>0].ref()},u:function(i,c,f){i=c+2097152>>>0<4194305-!!i?(i>>>0)+4294967296*c:NaN,f>>>=0,i=new Date(1e3*i),n()[f>>>2>>>0]=i.getUTCSeconds(),n()[f+4>>>2>>>0]=i.getUTCMinutes(),n()[f+8>>>2>>>0]=i.getUTCHours(),n()[f+12>>>2>>>0]=i.getUTCDate(),n()[f+16>>>2>>>0]=i.getUTCMonth(),n()[f+20>>>2>>>0]=i.getUTCFullYear()-1900,n()[f+24>>>2>>>0]=i.getUTCDay(),i=(i.getTime()-Date.UTC(i.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,n()[f+28>>>2>>>0]=i},v:function(i,c,f){i=c+2097152>>>0<4194305-!!i?(i>>>0)+4294967296*c:NaN,f>>>=0,i=new Date(1e3*i),n()[f>>>2>>>0]=i.getSeconds(),n()[f+4>>>2>>>0]=i.getMinutes(),n()[f+8>>>2>>>0]=i.getHours(),n()[f+12>>>2>>>0]=i.getDate(),n()[f+16>>>2>>>0]=i.getMonth(),n()[f+20>>>2>>>0]=i.getFullYear()-1900,n()[f+24>>>2>>>0]=i.getDay(),c=(vt(i.getFullYear())?gr:yr)[i.getMonth()]+i.getDate()-1|0,n()[f+28>>>2>>>0]=c,n()[f+36>>>2>>>0]=-(60*i.getTimezoneOffset()),c=new Date(i.getFullYear(),6,1).getTimezoneOffset();var $=new Date(i.getFullYear(),0,1).getTimezoneOffset();i=(c!=$&&i.getTimezoneOffset()==Math.min($,c))|0,n()[f+32>>>2>>>0]=i},w:function(i){i>>>=0;var c=new Date(n()[i+20>>>2>>>0]+1900,n()[i+16>>>2>>>0],n()[i+12>>>2>>>0],n()[i+8>>>2>>>0],n()[i+4>>>2>>>0],n()[i>>>2>>>0],0),f=n()[i+32>>>2>>>0],$=c.getTimezoneOffset(),E=new Date(c.getFullYear(),6,1).getTimezoneOffset(),R=new Date(c.getFullYear(),0,1).getTimezoneOffset(),U=Math.min(R,E);return 0>f?n()[i+32>>>2>>>0]=+(E!=R&&U==$):0<f!=(U==$)&&(E=Math.max(R,E),c.setTime(c.getTime()+6e4*((0<f?U:E)-$))),n()[i+24>>>2>>>0]=c.getDay(),f=(vt(c.getFullYear())?gr:yr)[c.getMonth()]+c.getDate()-1|0,n()[i+28>>>2>>>0]=f,n()[i>>>2>>>0]=c.getSeconds(),n()[i+4>>>2>>>0]=c.getMinutes(),n()[i+8>>>2>>>0]=c.getHours(),n()[i+12>>>2>>>0]=c.getDate(),n()[i+16>>>2>>>0]=c.getMonth(),n()[i+20>>>2>>>0]=c.getYear(),i=c.getTime(),isNaN(i)?(n()[So()>>>2>>>0]=61,i=-1):i/=1e3,Ao((yt=i,1<=+Math.abs(yt)?0<yt?+Math.floor(yt/4294967296)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)),i>>>0},s:Ur,t:kt,C:function(i,c,f){function $(ie){return(ie=ie.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?ie[1]:"GMT"}i>>>=0,c>>>=0,f>>>=0;var E=new Date().getFullYear(),R=new Date(E,0,1),U=new Date(E,6,1);E=R.getTimezoneOffset();var Q=U.getTimezoneOffset(),ae=Math.max(E,Q);s()[i>>>2>>>0]=60*ae,n()[c>>>2>>>0]=+(E!=Q),i=$(R),c=$(U),i=br(i),c=br(c),Q<E?(s()[f>>>2>>>0]=i,s()[f+4>>>2>>>0]=c):(s()[f>>>2>>>0]=c,s()[f+4>>>2>>>0]=i)},d:()=>{nt("")},c:function(i,c,f){return i>>>=0,c=m(c>>>0,f>>>0),Wt[i].apply(null,c)},k:function(i,c,f){return i>>>=0,c=m(c>>>0,f>>>0),Wt[i].apply(null,c)},o:()=>{},q:()=>Date.now(),W:()=>{throw ot+=1,"unwind"},E:function(){return 4294901760},f:()=>performance.timeOrigin+performance.now(),g:()=>A?(Ho(),It(Go)).cpus().length:navigator.hardwareConcurrency,A:function(i){i>>>=0;var c=o().length;if(i<=c||4294901760<i)return!1;for(var f=1;4>=f;f*=2){var $=c*(1+.2/f);$=Math.min($,i+100663296);var E=Math;$=Math.max(i,$);e:{E=(E.min.call(E,4294901760,$+(65536-$%65536)%65536)-X.buffer.byteLength+65535)/65536;try{X.grow(E),Ge();var R=1;break e}catch{}R=void 0}if(R)return!0}return!1},Q:N,R:L,K:Lt,h:te,m:ee,x:se,l:ve,y:function(i,c){return i>>>=0,c>>>=0,B(o().subarray(i>>>0,i+c>>>0)),0},a:X||a.wasmMemory,B:go,e:function(i,c,f,$){return go(i>>>0,c>>>0,f>>>0,$>>>0)},j:function(i,c,f,$){let E=at.length;i=new Uint8Array(o().slice(i+c,i+f));try{var R=new WebAssembly.Module(i),U=new WebAssembly.Instance(R,{env:{memory:X}}),Q;for(Q in U.exports)$o(U.exports[Q]);return E<at.length?E:$}catch(ae){return console.log(ae),$}}},Y=function(){function i(f,$){return Y=f.exports,Y=Fu(),Y=td(),ne.ub.push(Y.Ha),at=Y.Ia,be.unshift(Y.Z),J=$,St(),Y}var c={a:ed};if(ze++,a.instantiateWasm)try{return a.instantiateWasm(c,i)}catch(f){K(`Module.instantiateWasm callback failed with error: ${f}`),h(f)}return _t(c,function(f){i(f.instance,f.module)}).catch(h),{}}();a._OrtInit=(i,c)=>(a._OrtInit=Y._)(i,c),a._OrtGetLastError=(i,c)=>(a._OrtGetLastError=Y.$)(i,c),a._OrtCreateSessionOptions=(i,c,f,$,E,R,U,Q,ae,ie)=>(a._OrtCreateSessionOptions=Y.aa)(i,c,f,$,E,R,U,Q,ae,ie),a._OrtAppendExecutionProvider=(i,c)=>(a._OrtAppendExecutionProvider=Y.ba)(i,c),a._OrtAddFreeDimensionOverride=(i,c,f)=>(a._OrtAddFreeDimensionOverride=Y.ca)(i,c,f),a._OrtAddSessionConfigEntry=(i,c,f)=>(a._OrtAddSessionConfigEntry=Y.da)(i,c,f),a._OrtReleaseSessionOptions=i=>(a._OrtReleaseSessionOptions=Y.ea)(i),a._OrtCreateSession=(i,c,f)=>(a._OrtCreateSession=Y.fa)(i,c,f),a._OrtReleaseSession=i=>(a._OrtReleaseSession=Y.ga)(i),a._OrtGetInputOutputCount=(i,c,f)=>(a._OrtGetInputOutputCount=Y.ha)(i,c,f),a._OrtGetInputName=(i,c)=>(a._OrtGetInputName=Y.ia)(i,c),a._OrtGetOutputName=(i,c)=>(a._OrtGetOutputName=Y.ja)(i,c),a._OrtFree=i=>(a._OrtFree=Y.ka)(i),a._OrtCreateTensor=(i,c,f,$,E,R)=>(a._OrtCreateTensor=Y.la)(i,c,f,$,E,R),a._OrtGetTensorData=(i,c,f,$,E)=>(a._OrtGetTensorData=Y.ma)(i,c,f,$,E),a._OrtReleaseTensor=i=>(a._OrtReleaseTensor=Y.na)(i),a._OrtCreateRunOptions=(i,c,f,$)=>(a._OrtCreateRunOptions=Y.oa)(i,c,f,$),a._OrtAddRunConfigEntry=(i,c,f)=>(a._OrtAddRunConfigEntry=Y.pa)(i,c,f),a._OrtReleaseRunOptions=i=>(a._OrtReleaseRunOptions=Y.qa)(i),a._OrtCreateBinding=i=>(a._OrtCreateBinding=Y.ra)(i),a._OrtBindInput=(i,c,f)=>(a._OrtBindInput=Y.sa)(i,c,f),a._OrtBindOutput=(i,c,f,$)=>(a._OrtBindOutput=Y.ta)(i,c,f,$),a._OrtClearBoundOutputs=i=>(a._OrtClearBoundOutputs=Y.ua)(i),a._OrtReleaseBinding=i=>(a._OrtReleaseBinding=Y.va)(i),a._OrtRunWithBinding=(i,c,f,$,E)=>(a._OrtRunWithBinding=Y.wa)(i,c,f,$,E),a._OrtRun=(i,c,f,$,E,R,U,Q)=>(a._OrtRun=Y.xa)(i,c,f,$,E,R,U,Q),a._OrtEndProfiling=i=>(a._OrtEndProfiling=Y.ya)(i),a._OrtConfigure=(i,c)=>(a._OrtConfigure=Y.za)(i,c),a._OrtAuth=(i,c)=>(a._OrtAuth=Y.Aa)(i,c),a._JsepOutput=(i,c,f)=>(a._JsepOutput=Y.Ba)(i,c,f),a._JsepGetNodeName=i=>(a._JsepGetNodeName=Y.Ca)(i);var So=()=>(So=Y.Da)(),Wr=a._pthread_self=()=>(Wr=a._pthread_self=Y.Ea)(),vn=a._malloc=i=>(vn=a._malloc=Y.Fa)(i),xo=a._free=i=>(xo=a._free=Y.Ga)(i);a.__emscripten_tls_init=()=>(a.__emscripten_tls_init=Y.Ha)();var _o=a.__emscripten_thread_init=(i,c,f,$,E,R)=>(_o=a.__emscripten_thread_init=Y.Ja)(i,c,f,$,E,R);a.__emscripten_thread_crashed=()=>(a.__emscripten_thread_crashed=Y.Ka)();var Co=(i,c,f,$)=>(Co=Y.La)(i,c,f,$),$n=i=>($n=Y.Ma)(i),Sn=a.__emscripten_thread_exit=i=>(Sn=a.__emscripten_thread_exit=Y.Na)(i),Io=()=>(Io=Y.Oa)(),Ao=i=>(Ao=Y.Pa)(i),To=(i,c)=>(To=Y.Qa)(i,c),xn=()=>(xn=Y.Ra)(),Gr=i=>(Gr=Y.Sa)(i),_n=i=>(_n=Y.Ta)(i),Eo=a.dynCall_ii=(i,c)=>(Eo=a.dynCall_ii=Y.Va)(i,c),Oo=i=>(Oo=Y.Wa)(i),Po=()=>(Po=Y.Xa)(),Bo=i=>(Bo=Y.Ya)(i),ko=()=>(ko=Y.Za)();a.___start_em_js=914640,a.___stop_em_js=915413;function td(){var i=Y;i=Object.assign({},i);var c=$=>()=>$()>>>0,f=$=>E=>$(E)>>>0;return i.Da=c(i.Da),i.Ea=c(i.Ea),i.Fa=f(i.Fa),i.emscripten_main_runtime_thread_id=c(i.emscripten_main_runtime_thread_id),i.Ra=c(i.Ra),i.Ta=f(i.Ta),i}a.wasmMemory=X,a.stackAlloc=_n,a.stackSave=xn,a.stackRestore=Gr,a.keepRuntimeAlive=()=>0<ot,a.addFunction=$o,a.UTF8ToString=Ye,a.stringToUTF8=Dr,a.lengthBytesUTF8=dr,a.ExitStatus=Gt,a.PThread=ne;var Hr;Ke=function i(){Hr||Ro(),Hr||(Ke=i)};function Ro(){if(!(0<ze))if(S)p(a),S||Je(be),startWorker(a);else{if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)re.unshift(a.preRun.shift());Je(re),0<ze||Hr||(Hr=!0,a.calledRun=!0,Ae||(S||Je(be),p(a),S||Je(rt)))}}return Ro(),t.ready}})();typeof Fo=="object"&&typeof kn=="object"?kn.exports=Lo:typeof define=="function"&&define.amd&&define([],()=>Lo)});var qo=wr((up,cd)=>{cd.exports=\'"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\\n\'});var Mn,et,Sr,Fr,xr,Xo,Un,Ve=q(()=>{"use strict";Mn=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},et=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},Sr=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],Fr=e=>{switch(e){case"float16":return Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},xr=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},Xo=e=>e==="float32"||e==="int32"||e==="int64"||e==="bool"||e==="float16"||e==="uint32",Un=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${e}`)}}});var jr=q(()=>{"use strict"});var ta=q(()=>{"use strict";jr()});var ra,na=q(()=>{"use strict";ra="1.17.0"});var oa,Dt,zn=q(()=>{"use strict";na();oa="warning",Dt={wasm:{},webgl:{},webgpu:{},versions:{common:ra},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);oa=e}},get logLevel(){return oa}};Object.defineProperty(Dt,"logLevel",{enumerable:!0})});var Qt,aa=q(()=>{"use strict";zn();Qt=Dt});var ia=q(()=>{"use strict"});var sa=q(()=>{"use strict";qr()});var da=q(()=>{"use strict"});var la=q(()=>{"use strict";qr()});var qr=q(()=>{"use strict";ia();sa();da();la()});var Kr=q(()=>{"use strict";qr()});var Vn,ca,Mt,Ut,Nn=q(()=>{"use strict";zn();Vn=(e,t)=>{Dt.wasm.trace&&console.timeStamp(`${e}::ORT::${t}`)},ca=(e,t)=>{let r=new Error().stack?.split(/\\r\\n|\\r|\\n/g)||[],o=!1;for(let n=0;n<r.length;n++){if(o&&!r[n].includes("TRACE_FUNC")){let s=`FUNC_${e}::${r[n].trim().split(" ")[1]}`;t&&(s+=`::${t}`),Vn("CPU",s);return}r[n].includes("TRACE_FUNC")&&(o=!0)}},Mt=e=>{Dt.wasm.trace&&ca("BEGIN",e)},Ut=e=>{Dt.wasm.trace&&ca("END",e)}});var pa=q(()=>{"use strict";jr();Kr();Nn()});var ma=q(()=>{"use strict";pa()});var fa=q(()=>{"use strict"});var ha=q(()=>{"use strict";jr();Kr()});var ga=q(()=>{"use strict";ha()});var Xt=q(()=>{"use strict";ta();aa();ma();Kr();Nn();fa();ga()});var Sd,xd,ya,ba,wa,_d,Me,At=q(()=>{"use strict";Ve();Sd=["V","I","W","E","F"],xd=(e,t)=>{console.log(`[${Sd[e]},${new Date().toISOString()}]${t}`)},wa=(e,t)=>{ya=e,ba=t},_d=(e,t)=>{let r=xr(e),o=xr(ya);r>=o&&xd(r,typeof t=="function"?t():t)},Me=(...e)=>{ba&&_d(...e)}});var va,$a=q(()=>{"use strict";Ve();va=(e,t)=>new(Fr(t))(e)});var Yr=q(()=>{"use strict"});var Zr,Cd,Sa,Id,Wn,Hn,Gn,_a,Ca=q(()=>{"use strict";At();Yr();Zr=e=>Math.ceil(e/16)*16,Cd=1,Sa=()=>Cd++,Id=1,Wn=()=>Id++,Hn=async(e,t,r,o)=>{let n=Zr(r),s=e.device.createBuffer({size:n,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let u=e.getCommandEncoder();e.endComputePass(),u.copyBufferToBuffer(t,0,s,0,n),e.flush(),await s.mapAsync(GPUMapMode.READ);let l=s.getMappedRange();if(o){let a=o();return a.set(new Uint8Array(l,0,r)),a}else return new Uint8Array(l.slice(0,r))}finally{s.destroy()}},Gn=class{constructor(t){this.backend=t;this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersForUploadingPending=[],this.buffersPending=[],this.externalBuffers=new Map}upload(t,r){let o=r.buffer,n=r.byteOffset,s=r.byteLength,u=Zr(s),l=this.storageCache.get(t);if(!l)throw new Error("gpu data for uploading does not exist");if(l.originalSize!==s)throw new Error(`inconsistent data size. gpu data size=${l.originalSize}, data size=${s}`);let a=this.backend.device.createBuffer({mappedAtCreation:!0,size:u,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),p=a.getMappedRange();new Uint8Array(p).set(new Uint8Array(o,n,s)),a.unmap();let h=this.backend.getCommandEncoder();this.backend.endComputePass(),h.copyBufferToBuffer(a,0,l.gpuData.buffer,0,u),Me("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${t})`),this.buffersForUploadingPending.push(a)}memcpy(t,r){let o=this.storageCache.get(t);if(!o)throw new Error("source gpu data for memcpy does not exist");let n=this.storageCache.get(r);if(!n)throw new Error("destination gpu data for memcpy does not exist");if(o.originalSize!==n.originalSize)throw new Error("inconsistent source and destination gpu data size");let s=Zr(o.originalSize),u=this.backend.getCommandEncoder();this.backend.endComputePass(),u.copyBufferToBuffer(o.gpuData.buffer,0,n.gpuData.buffer,0,s)}registerExternalBuffer(t,r,o){let n;if(o){if(n=this.externalBuffers.get(o),n===void 0)throw new Error("previous buffer is not registered");if(t===o)return Me("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${r}) => id=${n}, buffer is the same, skip.`),n;this.externalBuffers.delete(o)}else n=Sa();return this.storageCache.set(n,{gpuData:{id:n,type:0,buffer:t,permamentID:Wn()},originalSize:r}),this.externalBuffers.set(t,n),Me("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${r}) => id=${n}, registered.`),n}unregisterExternalBuffer(t){let r=this.externalBuffers.get(t);r!==void 0&&(this.storageCache.delete(r),this.externalBuffers.delete(t),Me("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${r}`))}create(t,r=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let o=Zr(t),n,s=(r&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,u=(r&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(s||u){let a=s?this.freeBuffers:this.freeUniformBuffers,p=a.get(o);p||(p=[],a.set(o,p)),p.length>0?n=p.pop():n={buffer:this.backend.device.createBuffer({size:o,usage:r}),permamentID:Wn()}}else n={buffer:this.backend.device.createBuffer({size:o,usage:r}),permamentID:Wn()};let l={id:Sa(),type:0,buffer:n.buffer,permamentID:n.permamentID};return this.storageCache.set(l.id,{gpuData:l,originalSize:t}),Me("verbose",()=>`[WebGPU] GpuDataManager.create(size=${t}) => id=${l.id}`),l}get(t){return this.storageCache.get(t)?.gpuData}release(t){let r=this.storageCache.get(t);if(!r)throw new Error("releasing data does not exist");return Me("verbose",()=>`[WebGPU] GpuDataManager.release(id=${t}), gpuDataId=${r.gpuData.id}`),this.storageCache.delete(t),this.buffersPending.push({buffer:r.gpuData.buffer,permamentID:r.gpuData.permamentID}),r.originalSize}async download(t,r){let o=this.storageCache.get(t);if(!o)throw new Error("data does not exist");await Hn(this.backend,o.gpuData.buffer,o.originalSize,r)}refreshPendingBuffers(){for(let t of this.buffersForUploadingPending)t.destroy();this.buffersForUploadingPending=[];for(let t of this.buffersPending)(t.buffer.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE?this.freeBuffers.get(t.buffer.size).push(t):(t.buffer.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM?this.freeUniformBuffers.get(t.buffer.size).push(t):t.buffer.destroy();this.buffersPending=[]}dispose(){this.freeBuffers.forEach(t=>{t.forEach(r=>{r.buffer.destroy()})}),this.freeUniformBuffers.forEach(t=>{t.forEach(r=>{r.buffer.destroy()})}),this.storageCache.forEach(t=>{t.gpuData.buffer.destroy()}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map}},_a=(...e)=>new Gn(...e)});var Ln,ge,Fe=q(()=>{"use strict";Ln=class{constructor(t){Object.assign(this,t)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(t=>`${this[t]}`).join(";")),this.key}},ge=e=>new Ln(e)});var Fn,dt,z,zt,Jr,Qr,Xr,$e=q(()=>{"use strict";Fn=class{static calcMatMulShape(t,r){return t[1]!==r[0]?void 0:[t[0],r[1]]}},dt=class{static calcShape(t,r,o=!1){let n=t.length,s=r.length;if(n===0)return r;if(s===0)return t;let u=Math.max(t.length,r.length),l=new Array(u);if(o){if(n<2||s<2)return;let a=Fn.calcMatMulShape([t[n-2],t[n-1]],[r[s-2],r[s-1]]);if(a===void 0)return;[l[u-2],l[u-1]]=a}for(let a=o?3:1;a<=u;a++){let p=n-a<0?1:t[n-a],h=s-a<0?1:r[s-a];if(p!==h&&p>1&&h>1)return;l[u-a]=Math.max(p,h)}return l}static isValidBroadcast(t,r){let o=t.length,n=r.length;if(o>n)return!1;for(let s=1;s<=o;s++)if(t[o-s]!==1&&t[o-s]!==r[n-s])return!1;return!0}},z=class e{static size(t){return e.getSizeFromDimensionRange(t,0,t.length)}static sizeFromDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,r,t.length)}static sizeToDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeToDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,0,r)}static getSizeFromDimensionRange(t,r,o){let n=1;for(let s=r;s<o;s++){if(t[s]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");n*=t[s]}return n}static computeStrides(t){let r=t.length;if(r===0)return[];if(r===1)return[1];let o=new Array(r);o[r-1]=1,o[r-2]=t[r-1];for(let n=r-3;n>=0;--n)o[n]=o[n+1]*t[n+1];return o}static normalizeAxis(t,r){if(t<-r&&t>=r)throw new Error("unsupported axis for this operation.");return t<0?t+r:t}static normalizeAxes(t,r){return t.map(o=>this.normalizeAxis(o,r??t.length))}static sortBasedOnPerm(t,r){return r?r.map(o=>t[o]):t.slice().reverse()}static padShape(t,r){let o=t.length;return t.map((n,s)=>n+r[s]+r[s+o])}static areEqual(t,r){return t.length!==r.length?!1:t.every((o,n)=>o===r[n])}},zt=class e{static adjustPoolAttributes(t,r,o,n,s,u){if(!t&&o.length!==r.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(t)for(let l=0;l<r.length-2;l++)l>=o.length?o.push(r[l+2]):o[l]=r[l+2];for(let l=0;l<o.length;l++)if(l<n.length){if(n[l]<0)throw new Error("strides should be greater than or equal to 1")}else n.push(1);for(let l=0;l<o.length;l++)if(l<s.length){if(s[l]<0)throw new Error("dilations should be greater than or equal to 1")}else s.push(1);for(let l=0;l<o.length*2;l++)if(l<u.length){if(u[l]<0)throw new Error("pad should be greater than or equal to 1")}else u.push(0);for(let l=0;l<o.length;l++){if(o[l]<=0)throw new Error("kernel shapes need to be greater than 0");if(u[l]>=o[l]||u[l+o.length]>=o[l])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,r,o,n,s,u,l){if(l){if(s.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(r.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(n.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let a=0;a<t.length-2;a++)e.adjustPadAndReturnShape(t[a+(u?1:2)],r[a],o[a],n[a],s,a,a+t.length-2,l)}}static computePoolOutputShape(t,r,o,n,s,u,l){if(r.length<=0)throw new Error("input shape must be of size greater than 0");let a=[r[0],r[1]];return e.computeShapeHelper(t,r,a,o,n,s,u,l),a}static computeConvOutputShape(t,r,o,n,s,u,l){if(t.length<=0||r.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let a=[t[0],r[0]];return e.computeShapeHelper(!1,t,a,o,n,s,u,l),a}static computeShapeHelper(t,r,o,n,s,u,l,a){if(t)for(let p=0;p<r.length-2;p++)o.push(1);else for(let p=0;p<r.length-2;p++)o.push(e.adjustPadAndReturnShape(r[p+2],n[p],s[p],u[p],l,p,p+r.length-2,a))}static adjustPadAndReturnShape(t,r,o,n,s,u,l,a){let p=o*(n-1)+1;if(a&&a!=="NOTSET")switch(a){case"VALID":return s[u]=0,s[l]=0,Math.floor((t-p)/r+1);case"SAME_LOWER":case"SAME_UPPER":if(o!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let g=((t+r-1)/r-1)*r+n-t;return s[u]=Math.floor(a==="SAME_LOWER"?(g+1)/2:g/2),s[l]=g-s[u],Math.floor((t+g-n)/r+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((t+s[u]+s[l]-p)/r+1)}},Jr=class{static getShapeOfGemmResult(t,r,o,n,s){if(t.length!==2||o.length!==2)throw new Error("shape need to be of size 2");let u,l,a;r?(u=t[1],l=t[0]):(u=t[0],l=t[1]);let p=-1;if(n?(a=o[0],p=1):(a=o[1],p=0),o[p]!==l)throw new Error("dimension mismatch");if(u<=0||a<=0||l<=0)throw new Error("invalid shape specified");if(s&&!dt.isValidBroadcast(s,[u,a]))throw new Error("gemm: invalid bias shape for broadcast");return[u,a,l]}},Qr=-34028234663852886e22,Xr=34028234663852886e22});var Ad,qn,He,lt,F,Le,Ze,it,tt,le,Kn,M,j,en,jn,Ia,er,Re,we=q(()=>{"use strict";Ve();$e();Ad=64,qn=(e,t)=>{if(t===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(e){case 10:return t>1?`vec${t}<f16>`:"f16";case 1:return t>1?`vec${t}<f32>`:"f32";case 6:return t>1?`vec${t}<i32>`:"i32";case 12:return t>1?`vec${t}<u32>`:"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(t!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];default:throw new Error(`Unknown data type: ${e}`)}},He=(e,t=1)=>{let r=qn(e,t);return typeof r=="string"?r:r[0]},lt=(e,t=1)=>{let r=qn(e,t);return typeof r=="string"?r:r[1]},F=e=>e.length===0?[]:[{type:"uint32",data:e},{type:"uint32",data:z.computeStrides(e)}],Le=e=>e%4===0?4:e%2===0?2:1,Ze=(e="f32",t,r="0")=>!t||t===1?`${e}(${r})`:`vec${t}<${e}>(${r})`,it=(e,t,r)=>e==="f32"?r:t===1?`f32(${r})`:`vec${t}f(${r})`,tt=(e,t)=>t===4?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:t===2?`(${e}.x + ${e}.y)`:t===3?`(${e}.x + ${e}.y + ${e}.z)`:e,le=(e,t,r)=>e.startsWith("uniforms.")&&r>4?typeof t=="string"?`${e}[(${t}) / 4][(${t}) % 4]`:`${e}[${Math.floor(t/4)}][${t%4}]`:r>1?`${e}[${t}]`:e,Kn=(e,t,r,o,n)=>{let s=typeof r=="number",u=s?r:r.length,l=[...new Array(u).keys()],a=u<2?"u32":u<=4?`vec${u}<u32>`:`array<u32, ${u}>`,p=qn(t,n),h=typeof p=="string"?p:p[1],g=typeof p=="string"?p:p[0],w={indices:a,value:h,storage:g,tensor:t},v=H=>typeof H=="string"?H:`${H}u`,y={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},_=s?"uniforms.":"",A=`${_}${e}_shape`,S=`${_}${e}_strides`,I="";for(let H=0;H<u-1;H++)I+=`\n    let dim${H} = current / ${le(S,H,u)};\n    let rest${H} = current % ${le(S,H,u)};\n    indices[${H}] = dim${H};\n    current = rest${H};\n    `;I+=`indices[${u-1}] = current;`;let P=u<2?"":`\n  fn o2i_${e}(offset: u32) -> ${w.indices} {\n    var indices: ${w.indices};\n    var current = offset;\n    ${I}\n    return indices;\n  }`,C=H=>(y.offsetToIndices=!0,u<2?H:`o2i_${e}(${H})`),V=[];if(u>=2)for(let H=u-1;H>=0;H--)V.push(`${le(S,H,u)} * (indices[${H}])`);let D=u<2?"":`\n  fn i2o_${e}(indices: ${w.indices}) -> u32 {\n    return ${V.join("+")};\n  }`,G=H=>(y.indicesToOffset=!0,u<2?H:`i2o_${e}(${H})`),T=(...H)=>u===0?"0u":`${w.indices}(${H.map(v).join(",")})`,W=(H,re)=>u<2?`${H}`:`${le(H,re,u)}`,pe=(H,re,be)=>u<2?`${H}=${be};`:`${le(H,re,u)}=${be};`,Z={},K=(H,re)=>{y.broadcastedIndicesToOffset=!0;let be=`${re.name}broadcastedIndicesTo${e}Offset`;if(be in Z)return`${be}(${H})`;let rt=[];for(let ze=u-1;ze>=0;ze--){let Be=re.indicesGet("outputIndices",ze+re.rank-u);rt.push(`${W(S,ze)} * (${Be} % ${W(A,ze)})`)}return Z[be]=`fn ${be}(outputIndices: ${re.type.indices}) -> u32 {\n             return ${rt.length>0?rt.join("+"):"0u"};\n           }`,`${be}(${H})`},X=(H,re)=>(()=>{if(w.storage===w.value)return`${e}[${H}]=${re};`;if(w.storage==="vec2<u32>"&&w.value==="i32")return`${e}[${H}]=vec2<u32>(u32(${re}), select(0u, 0xFFFFFFFFu, ${re} < 0));`;if(w.storage==="vec2<u32>"&&w.value==="u32")return`${e}[${H}]=vec2<u32>(u32(${re}), 0u);`;if(w.storage==="u32"&&w.value==="vec4<bool>")return`${e}[${H}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${re}));`;throw new Error(`not supported combination of storage type ${w.storage} and value type ${w.value} yet`)})(),J=H=>(()=>{if(w.storage===w.value)return`${e}[${H}]`;if(w.storage==="vec2<u32>"&&w.value==="i32")return`i32(${e}[${H}].x)`;if(w.storage==="vec2<u32>"&&w.value==="u32")return`u32(${e}[${H}].x)`;if(w.storage==="u32"&&w.value==="vec4<bool>")return`vec4<bool>(bool(${e}[${H}] & 0xFFu), bool(${e}[${H}] & 0xFF00u), bool(${e}[${H}] & 0xFF0000u), bool(${e}[${H}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${w.storage} and value type ${w.value} yet`)})(),Ae=u<2?"":`\n  fn get_${e}ByIndices(indices: ${w.indices}) -> ${h} {\n    return ${J(`i2o_${e}(indices)`)};\n  }`,Oe=u<2?"":(()=>{let H=l.map(be=>`d${be}: u32`).join(", "),re=l.map(be=>`d${be}`).join(", ");return`\n  fn get_${e}(${H}) -> ${h} {\n    return get_${e}ByIndices(${T(re)});\n  }`})(),fe=(...H)=>{if(H.length!==u)throw new Error(`indices length must be ${u}`);let re=H.map(v).join(",");return u===0?J("0u"):u===1?J(re[0]):(y.get=!0,y.getByIndices=!0,y.indicesToOffset=!0,`get_${e}(${re})`)},Ce=H=>u<2?J(H):(y.getByIndices=!0,y.indicesToOffset=!0,`get_${e}ByIndices(${H})`),he=u<2?"":`\n  fn set_${e}ByIndices(indices: ${w.indices}, value: ${h}) {\n    ${X(`i2o_${e}(indices)`,"value")}\n  }`,ye=u<2?"":(()=>{let H=l.map(be=>`d${be}: u32`).join(", "),re=l.map(be=>`d${be}`).join(", ");return`\n  fn set_${e}(${H}, value: ${h}) {\n    set_${e}ByIndices(${T(re)}, value);\n  }`})();return{impl:()=>{let H=[],re=!1;return y.offsetToIndices&&(H.push(P),re=!0),y.indicesToOffset&&(H.push(D),re=!0),y.broadcastedIndicesToOffset&&(Object.values(Z).forEach(be=>H.push(be)),re=!0),y.set&&(H.push(ye),re=!0),y.setByIndices&&(H.push(he),re=!0),y.get&&(H.push(Oe),re=!0),y.getByIndices&&(H.push(Ae),re=!0),!s&&re&&H.unshift(`const ${A} = ${w.indices}(${r.join(",")});`,`const ${S} = ${w.indices}(${z.computeStrides(r).join(",")});`),H.join(`\n`)},type:w,offsetToIndices:C,indicesToOffset:G,broadcastedIndicesToOffset:K,indices:T,indicesGet:W,indicesSet:pe,set:(...H)=>{if(H.length!==u+1)throw new Error(`indices length must be ${u}`);let re=H[u];if(typeof re!="string")throw new Error("value must be string");let be=H.slice(0,u).map(v).join(",");return u===0?X("0u",re):u===1?X(be[0],re):(y.set=!0,y.setByIndices=!0,y.indicesToOffset=!0,`set_${e}(${be}, ${re})`)},setByOffset:X,setByIndices:(H,re)=>u<2?X(H,re):(y.setByIndices=!0,y.indicesToOffset=!0,`set_${e}ByIndices(${H}, ${re});`),get:fe,getByOffset:J,getByIndices:Ce,usage:o,name:e,strides:S,shape:A,rank:u}},M=(e,t,r,o=1)=>Kn(e,t,r,"input",o),j=(e,t,r,o=1)=>Kn(e,t,r,"output",o),en=(e,t,r,o=1)=>Kn(e,t,r,"internal",o),jn=class{constructor(t){this.normalizedDispatchGroup=t;this.internalVariables=[];this.variables=[];this.uniforms=[];this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(t){return`if (global_idx >= ${typeof t=="number"?`${t}u`:t}) { return; }`}mainStart(t=Ad){let r=typeof t=="number"?t:t[0],o=typeof t=="number"?1:t[1],n=typeof t=="number"?1:t[2],s=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,u=s?`@builtin(global_invocation_id) global_id : vec3<u32>,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(local_invocation_id) local_id : vec3<u32>,\n    @builtin(local_invocation_index) local_idx : u32,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(num_workgroups) num_workgroups : vec3<u32>`,l=s?"let global_idx = global_id.x; let local_idx = local_id.x;":`let global_idx = (workgroup_id.z * num_workgroups[0] * num_workgroups[1] +\n          workgroup_id.y * num_workgroups[0] + workgroup_id.x) * ${r*o*n}u + local_idx;`;return`@compute @workgroup_size(${r}, ${o}, ${n})\n  fn main(${u}) {\n    ${l}\n  `}appendVariableUniforms(t){t.rank!==0&&(t.shape.startsWith("uniforms.")&&this.uniforms.push({name:t.shape.replace("uniforms.",""),type:"u32",length:t.rank}),t.strides.startsWith("uniforms.")&&this.uniforms.push({name:t.strides.replace("uniforms.",""),type:"u32",length:t.rank}))}declareVariable(t,r){if(t.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(t),this.appendVariableUniforms(t);let o=t.usage==="input"?"read":"read_write",n=t.type.storage;return`@group(0) @binding(${r}) var<storage, ${o}> ${t.name}: array<${n}>;`}declareVariables(...t){return t.map(r=>this.declareVariable(r,this.variableIndex++)).join(`\n`)}registerInternalVariable(t){if(t.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(t),this.appendVariableUniforms(t)}registerInternalVariables(...t){return t.forEach(r=>this.registerInternalVariable(r)),this}registerUniform(t,r,o=1){return this.uniforms.push({name:t,type:r,length:o}),this}registerUniforms(t){return this.uniforms=this.uniforms.concat(t),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let t=[];for(let{name:r,type:o,length:n}of this.uniforms)if(n&&n>4)t.push(`${r}:array<vec4<${o}>, ${Math.ceil(n/4)}>`);else{let s=n==null||n===1?o:`vec${n}<${o}>`;t.push(`${r}:${s}`)}return`\n      struct Uniforms { ${t.join(", ")} };\n      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(t=>t.impl()).join(`\n`)+this.internalVariables.map(t=>t.impl()).join(`\n`)}},Ia=e=>new jn(e),er=(e,t)=>{let r=e.length,o=[];for(let n=0;n<r;n++){let s=r-1-n,u=e[s]||1;(t[t.length-1-n]||1)>1&&u===1&&o.unshift(s)}return o},Re=e=>!0});var Td,Aa,Ed,Od,st,Ta,Ea,tr=q(()=>{"use strict";$e();Fe();we();Td=e=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.")},Aa=(e,t)=>t&&t.length!==e?[...new Array(e).keys()].reverse():t,Ed=(e,t)=>z.sortBasedOnPerm(e,Aa(e.length,t)),Od=(e,t,r,o)=>{let n=[];n.push(`fn perm(i: ${o.type.indices}) -> ${r.type.indices} {\n    var a: ${r.type.indices};`);for(let s=0;s<t;++s)n.push(r.indicesSet("a",e[s],`i[${s}]`));return n.push("return a;}"),n.join(`\n`)},st=(e,t)=>{let r=e.dataType,o=e.dims.length,n=Aa(o,t),s=Re(o),u=Ed(e.dims,n),l=s?u.length:u,a=s?o:e.dims,p=j("output",r,l),h=M("a",r,a),g=w=>`\n  ${w.registerUniform("output_size","u32").declareVariables(h,p)}\n\n  ${Od(n,o,h,p)}\n\n  ${w.mainStart()}\n    ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let indices = ${p.offsetToIndices("global_idx")};\n    let aIndices = perm(indices);\n\n    ${p.setByOffset("global_idx",h.getByIndices("aIndices"))}\n  }`;return{name:"Transpose",shaderCache:{hint:`${t}`,inputDependencies:s?["rank"]:["dims"]},getRunData:w=>{let v=z.size(u);return{outputs:[{dims:u,dataType:w[0].dataType}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:s?[{type:"uint32",data:v},...F(w[0].dims),...F(u)]:[{type:"uint32",data:v}]}},getShaderSource:g}},Ta=(e,t)=>{Td(e.inputs),e.compute(st(e.inputs[0],t.perm))},Ea=e=>ge({perm:e.perm})});var Pd,Bd,kd,Rd,Dd,Md,Ud,zd,Vd,Nd,ct,Oa,Pa,Ba,ka,Ra,Da,Ma,Ua,za,Va,Na=q(()=>{"use strict";$e();we();tn();tr();Pd={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},Bd={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},kd={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},Rd={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},Dd=(e,t)=>{let r=[];for(let o=t-e;o<t;++o)r.push(o);return r},Md=(e,t)=>{let r=[],o=e.length;for(let s=0;s<o;s++)t.indexOf(s)===-1&&r.push(e[s]);let n=t.map(s=>e[s]);return[r,n]},Ud=(e,t)=>{let r=e.length+t.length,o=[],n=0;for(let s=0;s<r;s++)t.indexOf(s)===-1?o.push(e[n++]):o.push(1);return o},zd=(e,t)=>{for(let r=0;r<e.length;++r)if(e[e.length-r-1]!==t-1-r)return!1;return!0},Vd=(e,t)=>{let r=[];if(!zd(e,t)){for(let o=0;o<t;++o)e.indexOf(o)===-1&&r.push(o);e.forEach(o=>r.push(o))}return r},Nd=(e,t,r,o,n,s,u)=>{let l=r[0].dims,a=z.size(s),p=z.size(u),h=M("_A",r[0].dataType,l),g=j("output",n,s),w=32,v=`\n          var<workgroup> aBestValues : array<${g.type.storage}, ${w}>;\n       `;return{name:e,shaderCache:t,getShaderSource:_=>`\n        ${_.registerUniform("reduceSize","u32").declareVariables(h,g)}\n        ${v}\n        fn DIV_CEIL(a : u32, b : u32) -> u32 {\n          return ((a - 1u) / b + 1u);\n         }\n         ${_.mainStart(w)}\n\n          let outputIndex = global_idx / ${w};\n          let offset = outputIndex * uniforms.reduceSize;\n\n          var bestValue = ${g.type.storage}(${kd[o]});\n          let Length = uniforms.reduceSize;\n          for (var k = local_idx; k < Length; k = k + ${w}) {\n           let candidate = ${g.type.storage}(${h.getByOffset("offset + k")});\n           bestValue = ${Pd[o]};\n          }\n          aBestValues[local_idx] = bestValue;\n          workgroupBarrier();\n\n         var reduceSize = min(Length, ${w}u);\n         for (var currentSize = reduceSize / 2u; reduceSize > 1u;\n             currentSize = reduceSize / 2u) {\n           let interval = DIV_CEIL(reduceSize, 2u);\n           if (local_idx < currentSize) {\n            let candidate = aBestValues[local_idx + interval];\n            bestValue = ${Bd[o]};\n            aBestValues[local_idx] = bestValue;\n           }\n           reduceSize = interval;\n           workgroupBarrier();\n         }\n\n         if (local_idx == 0u) {\n          ${g.setByOffset("outputIndex",`${o==="mean"?`bestValue / ${g.type.storage}(uniforms.reduceSize)`:`${Rd[o]}`}`)};\n         }\n        }`,getRunData:()=>({outputs:[{dims:s,dataType:n}],dispatchGroup:{x:a},programUniforms:[{type:"uint32",data:p}]})}},ct=(e,t,r,o)=>{let n=e.inputs.length===1?r:Yn(e.inputs,r),s=n.axes;s.length===0&&!n.noopWithEmptyAxes&&(s=e.inputs[0].dims.map((v,y)=>y));let u=z.normalizeAxes(s,e.inputs[0].dims.length),l=u,a=e.inputs[0],p=Vd(l,e.inputs[0].dims.length);p.length>0&&(a=e.compute(st(e.inputs[0],p),{inputs:[0],outputs:[-1]})[0],l=Dd(l.length,a.dims.length));let[h,g]=Md(a.dims,l),w=h;n.keepDims&&(w=Ud(h,u)),e.compute(Nd(t,{hint:n.cacheKey,inputDependencies:["type"]},[a],o,e.inputs[0].dataType,w,g),{inputs:[a]})},Oa=(e,t)=>{ct(e,"ReduceMeanShared",t,"mean")},Pa=(e,t)=>{ct(e,"ReduceL1Shared",t,"l1")},Ba=(e,t)=>{ct(e,"ReduceL2Shared",t,"l2")},ka=(e,t)=>{ct(e,"ReduceLogSumExpShared",t,"logSumExp")},Ra=(e,t)=>{ct(e,"ReduceMaxShared",t,"max")},Da=(e,t)=>{ct(e,"ReduceMinShared",t,"min")},Ma=(e,t)=>{ct(e,"ReduceProdShared",t,"prod")},Ua=(e,t)=>{ct(e,"ReduceSumShared",t,"sum")},za=(e,t)=>{ct(e,"ReduceSumSquareShared",t,"sumSquare")},Va=(e,t)=>{ct(e,"ReduceLogSumShared",t,"logSum")}});var pt,Wd,rn,Yn,mt,Gd,Hd,Ld,Fd,jd,qd,Kd,Yd,Zd,Jd,ft,Wa,Ga,Ha,La,Fa,ja,qa,Ka,Ya,Za,tn=q(()=>{"use strict";$e();Fe();we();Na();pt=e=>{if(!e||e.length===0||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(e.length===2&&e[1].dims.length!==1)throw new Error("Invalid axes input dims.")},Wd=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],rn=(e,t,r,o,n,s,u=!1,l=!1)=>{let a=[],p=r[0].dims,h=p.length,g=z.normalizeAxes(n,h),w=!l&&g.length===0;p.forEach((A,S)=>{w||g.indexOf(S)>=0?u&&a.push(1):a.push(A)});let v=a.length,y=z.size(a);return{name:e,shaderCache:t,getShaderSource:A=>{let S=[],I=M("_A",r[0].dataType,h),P=j("output",s,v),C=o(I,P,g),V=C[2];for(let D=0,G=0;D<h;D++)w||g.indexOf(D)>=0?(u&&G++,V=`for(var j${D}: u32 = 0; j${D} < ${p[D]}; j${D}++) {\n                  ${C[2].includes("last_index")?`let last_index = j${D};`:""}\n                  ${I.indicesSet("input_indices",D,`j${D}`)}\n                  ${V}\n                }`):(S.push(`${I.indicesSet("input_indices",D,P.indicesGet("output_indices",G))};`),G++);return`\n\n        ${A.registerUniform("output_size","u32").declareVariables(I,P)}\n\n        ${A.mainStart()}\n          ${A.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n          var input_indices: ${I.type.indices};\n          let output_indices = ${P.offsetToIndices("global_idx")};\n\n          ${S.join(`\n`)}\n          ${C[0]}       // init ops for reduce max/min\n          ${C[1]}\n          ${V}\n          ${C[3]}\n          ${C.length===4?P.setByOffset("global_idx","value"):C.slice(4).join(`\n`)}\n        }`},getRunData:()=>({outputs:[{dims:a,dataType:s}],dispatchGroup:{x:Math.ceil(y/64)},programUniforms:[{type:"uint32",data:y},...F(p),...F(a)]})}},Yn=(e,t)=>{let r=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(o=>r.push(Number(o))),ge({axes:r,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},mt=(e,t,r,o)=>{let n=e.inputs,s=n.length===1?r:Yn(n,r);e.compute(rn(t,{hint:s.cacheKey,inputDependencies:["rank"]},[n[0]],s.noopWithEmptyAxes&&s.axes.length===0?Wd:o,s.axes,n[0].dataType,s.keepDims,s.noopWithEmptyAxes),{inputs:[0]})},Gd=(e,t)=>{pt(e.inputs),mt(e,"ReduceLogSum",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += ${o.getByIndices("input_indices")};`,"value = log(value);"])},Hd=(e,t)=>{pt(e.inputs),mt(e,"ReduceL1",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += abs(${o.getByIndices("input_indices")});`,""])},Ld=(e,t)=>{pt(e.inputs),mt(e,"ReduceL2",t,(o,n)=>[`var t = ${n.type.value}(0); var value = ${n.type.value}(0);`,"",`t = ${o.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},Fd=(e,t)=>{pt(e.inputs),mt(e,"ReduceLogSumExp",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += exp(${o.getByIndices("input_indices")});`,"value = log(value);"])},jd=(e,t)=>{pt(e.inputs),mt(e,"ReduceMax",t,(o,n,s)=>{let u=[];for(let l=0;l<o.rank;l++)(s.indexOf(l)>=0||s.length===0)&&u.push(o.indicesSet("input_indices",l,0));return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};`,`value = max(value, ${o.getByIndices("input_indices")});`,""]})},qd=(e,t)=>{pt(e.inputs),mt(e,"ReduceMean",t,(o,n,s)=>{let u=1;for(let l=0;l<o.rank;l++)(s.indexOf(l)>=0||s.length===0)&&(u*=e.inputs[0].dims[l]);return["var sum = f32(0);","",`sum += f32(${o.getByIndices("input_indices")});`,`let value = ${n.type.value}(sum / ${u});`]})},Kd=(e,t)=>{pt(e.inputs),mt(e,"ReduceMin",t,(o,n,s)=>{let u=[];for(let l=0;l<o.rank;l++)(s.indexOf(l)>=0||s.length===0)&&u.push(`input_indices[${l}] = 0;`);return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};`,`value = min(value, ${o.getByIndices("input_indices")});`,""]})},Yd=(e,t)=>{pt(e.inputs),mt(e,"ReduceProd",t,(o,n)=>[`var value = ${n.type.storage}(1);`,"",`value *= ${o.getByIndices("input_indices")};`,""])},Zd=(e,t)=>{pt(e.inputs),mt(e,"ReduceSum",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += ${o.getByIndices("input_indices")};`,""])},Jd=(e,t)=>{pt(e.inputs),mt(e,"ReduceSumSquare",t,(o,n)=>[`var t = ${n.type.value}(0); var value = ${n.type.value}(0);`,"",`t = ${o.getByIndices("input_indices")}; value += t * t;`,""])},ft=(e,t,r)=>{if(t.length===0)return r;let o=1,n=1;for(let s=0;s<t.length;s++)t.indexOf(s)===-1?o*=e[s]:n*=e[s];return n<32&&o>1024},Wa=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?qd(e,t):Oa(e,t)},Ga=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Hd(e,t):Pa(e,t)},Ha=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Ld(e,t):Ba(e,t)},La=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Fd(e,t):ka(e,t)},Fa=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?jd(e,t):Ra(e,t)},ja=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Kd(e,t):Da(e,t)},qa=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Yd(e,t):Ma(e,t)},Ka=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Zd(e,t):Ua(e,t)},Ya=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Jd(e,t):za(e,t)},Za=(e,t)=>{ft(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Gd(e,t):Va(e,t)}});var Ja,Qa,Xa,Zn,ei=q(()=>{"use strict";Ve();Fe();tn();Ja=e=>{if(!e||e.length===0||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(e[0].dataType!==1)throw new Error("Invalid input type.")},Qa=(e,t)=>{Ja(e.inputs);let r=(o,n,s)=>{let u=[];for(let l=0;l<o.rank;l++)(s.indexOf(l)>=0||s.length===0)&&u.push(`input_indices[${l}] = 0;`);return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${t.selectLastIndex>0?"<=":"<"} value) {\n         value = ${o.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",n.setByOffset("global_idx","best_index")]};e.compute(rn("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},Xa=(e,t)=>{Ja(e.inputs);let r=(o,n,s)=>{let u=[];for(let l=0;l<o.rank;l++)(s.indexOf(l)>=0||s.length===0)&&u.push(`input_indices[${l}] = 0;`);return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${t.selectLastIndex>0?">=":">"} value) {\n         value = ${o.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",n.setByOffset("global_idx","best_index")]};e.compute(rn("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},Zn=e=>ge(e)});var Qd,Xd,el,tl,nn,rl,ti,Jn=q(()=>{"use strict";Ve();Yr();we();Qd=(e,t)=>{let r=e[0],o=e[1],n=e[2],s=e[3],u=e[4],l=e[5];if(u&&l)throw new Error("Attention cannot have both past and relative_position_bias");if(r.dims.length!==3)throw new Error(\'Input "input" must have 3 dimensions\');let a=r.dims[0],p=r.dims[1],h=r.dims[2];if(n.dims.length!==1)throw new Error(\'Input "bias" is expected to have 1 dimensions\');if(o.dims.length!==2)throw new Error(\'Input "weights" is expected to have 2 dimensions\');if(o.dims[0]!==h)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(n.dims[0]!==o.dims[1])throw new Error(\'Input "bias" dimension 0 should have same length as dimension 1 of input "weights"\');let g=n.dims[0]/3,w=g,v=w;if(t.qkvHiddenSizes.length>0){if(t.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let P of t.qkvHiddenSizes)if(P%t.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");g=t.qkvHiddenSizes[0],w=t.qkvHiddenSizes[1],v=t.qkvHiddenSizes[2]}let y=p;if(g!==w)throw new Error("qkv_hidden_sizes first element should be same as the second");if(n.dims[0]!==g+w+v)throw new Error(\'Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes\');let _=0;if(u){if(w!==v)throw new Error(\'Input "past" expect k_hidden_size == v_hidden_size\');if(u.dims.length!==5)throw new Error(\'Input "past" must have 5 dimensions\');if(u.dims[0]!==2)throw new Error(\'Input "past" first dimension must be 2\');if(u.dims[1]!==a)throw new Error(\'Input "past" second dimension must be batch_size\');if(u.dims[2]!==t.numHeads)throw new Error(\'Input "past" third dimension must be num_heads\');if(u.dims[4]!==w/t.numHeads)throw new Error(\'Input "past" fifth dimension must be k_hidden_size / num_heads\');t.pastPresentShareBuffer||(_=u.dims[3])}let A=y+_,S=-1,I=0;if(s)throw new Error("Mask not supported");if(u)throw new Error("past is not supported");if(l)throw new Error("relativePositionBias is not supported");return{batchSize:a,sequenceLength:p,pastSequenceLength:_,kvSequenceLength:y,totalSequenceLength:A,maxSequenceLength:S,inputHiddenSize:h,hiddenSize:g,vHiddenSize:v,headSize:Math.floor(g/t.numHeads),vHeadSize:Math.floor(v/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:I,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},Xd=(e,t,r,o)=>{let n=Le(o),s=64,u=o/n;u<s?s=1:u/8<64&&(s=Math.ceil(u/8));let l=Math.ceil(o/n/s),p=[{type:et(t.dataType),data:1/o},{type:"uint32",data:u},{type:"uint32",data:l}],h=He(t.dataType,n),g=w=>{let v=j("x",t.dataType,t.dims,n),y="thread_max_vector";n===2?y="max(thread_max_vector.x, thread_max_vector.y)":n===4&&(y="max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))");let _=lt(t.dataType),A=[{name:"d_inv",type:_},{name:"d_comp",type:"u32"},{name:"elements_per_wg",type:"u32"}];return`\n  var<workgroup> wgMax: array<f32, ${s}>;\n  var<workgroup> wgSum: array<f32, ${s}>;\n  ${w.registerUniforms(A).declareVariables(v)}\n  ${w.mainStart([s,1,1])}\n    let localOffset = local_idx * uniforms.elements_per_wg;\n    let offset: u32 = workgroup_id.x * uniforms.d_comp + localOffset;\n\n    var thread_max_vector = ${Ze("f32",n,"-3.402823e+38f")};\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      thread_max_vector = max(${it(_,n,"x[offset + i]")}, thread_max_vector);\n    }\n    wgMax[local_idx] = ${y};\n    workgroupBarrier();\n\n    var maxValue = -3.402823e+38f;\n    for (var i = 0u; i < ${s}; i++) {\n      maxValue = max(wgMax[i], maxValue);\n    }\n\n    var sumVector = ${Ze("f32",n,"0")};\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      sumVector += exp(${it(_,n,"x[offset + i]")} - maxValue);\n    }\n    wgSum[local_idx] = ${tt("sumVector",n)};\n    workgroupBarrier();\n\n    var sum: f32 = 0;\n    for (var i = 0u; i < ${s}; i++) {\n      sum += wgSum[i];\n    }\n\n    if (sum == 0) {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        x[offset + i] = ${Ze("f32",n,"uniforms.d_inv")};\n      }\n    } else {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        let f32input = ${it(_,n,"x[offset + i]")};\n        x[offset + i] = ${v.type.value}(exp(f32input - maxValue) / sum);\n      }\n    }\n  }`};e.compute({name:"AttentionProbsSoftmax",shaderCache:{hint:`${s};${h};${n}`},getShaderSource:g,getRunData:()=>({outputs:[],dispatchGroup:{x:r},programUniforms:p})},{inputs:[t],outputs:[]})},el=(e,t,r,o,n,s)=>{let u=[n.batchSize,n.numHeads,n.sequenceLength,n.kvSequenceLength+n.pastSequenceLength],l=s.scale===0?1/Math.sqrt(n.headSize):s.scale,a=Le(n.headSize),p=n.headSize/a,h=12,g={x:Math.ceil(n.totalSequenceLength/h),y:Math.ceil(n.sequenceLength/h),z:n.batchSize*n.numHeads},w=et(t.dataType),v=[{type:"uint32",data:n.sequenceLength},{type:"uint32",data:p},{type:"uint32",data:n.totalSequenceLength},{type:"uint32",data:n.kvSequenceLength},{type:w,data:l}],y=[t,r],_=S=>{let I=M("q",t.dataType,t.dims,a),P=M("key",r.dataType,r.dims,a),C=j("output",t.dataType,u),V=He(t.dataType),D=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"alpha",type:V}];return`\n  const beta: ${V} = 1.0;\n  const TILE_SIZE = ${h}u;\n\n  var<workgroup> tileQ: array<${I.type.storage}, ${h*h}>;\n  var<workgroup> tileK: array<${I.type.storage}, ${h*h}>;\n  ${S.registerUniforms(D).declareVariables(I,P,C)}\n  ${S.mainStart([h,h,1])}\n    // x holds the N and y holds the M\n    let headIdx = workgroup_id.z;\n    let m = workgroup_id.y * TILE_SIZE;\n    let n = workgroup_id.x * TILE_SIZE;\n    let lm = m + local_id.y;\n    let ln = n + local_id.x;\n\n    let qOffset = uniforms.M * uniforms.K * headIdx + m * uniforms.K;\n    let kOffset = uniforms.kv_sequence_length * uniforms.K * headIdx + n * uniforms.K;\n\n    var value = ${Ze(V,a)};\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m + local_id.y < uniforms.M && w + local_id.x < uniforms.K) {\n        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {\n        tileK[TILE_SIZE * local_id.y + local_id.x] = key[kOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      workgroupBarrier();\n\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = headIdx * uniforms.M * uniforms.N;\n    if (lm < uniforms.M && ln < uniforms.N) {\n      let outputIdx = headOffset + lm * uniforms.N + ln;\n      output[outputIdx] = ${tt("value",a)} * uniforms.alpha;\n    }\n  }`},A=e.compute({name:"AttentionProbs",shaderCache:{hint:`${a}`,inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:u,dataType:t.dataType,gpuDataType:0}],dispatchGroup:g,programUniforms:v}),getShaderSource:_},{inputs:y,outputs:[-1]})[0];return Xd(e,A,n.batchSize*n.numHeads*n.sequenceLength,n.totalSequenceLength),A},tl=(e,t,r,o)=>{let n=[o.batchSize,o.sequenceLength,o.vHiddenSize],s=12,u={x:Math.ceil(o.vHeadSize/s),y:Math.ceil(o.sequenceLength/s),z:o.batchSize*o.numHeads},l=[{type:"uint32",data:o.sequenceLength},{type:"uint32",data:o.totalSequenceLength},{type:"uint32",data:o.vHeadSize},{type:"uint32",data:o.numHeads},{type:"uint32",data:o.vHiddenSize}],a=p=>{let h=M("probs",t.dataType,t.dims),g=M("v",r.dataType,r.dims),w=j("output",t.dataType,n),v=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"v_hidden_size",type:"u32"}];return`\n  const TILE_SIZE = ${s}u;\n  var<workgroup> tileQ: array<${h.type.value}, ${s*s}>;\n  var<workgroup> tileK: array<${h.type.value}, ${s*s}>;\n  ${p.registerUniforms(v).declareVariables(h,g,w)}\n  ${p.mainStart([s,s,1])}\n   let headIdx = workgroup_id.z;\n   let m = workgroup_id.y * TILE_SIZE + local_id.y;\n   let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n   let offsetA = headIdx * (uniforms.M * uniforms.K) + m * uniforms.K;\n   let offsetB = headIdx * (uniforms.N * uniforms.K) + n;\n\n   var value = ${h.type.storage}(0);\n   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n     if (m < uniforms.M && w + local_id.x < uniforms.K) {\n       tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];\n     }\n     if (n < uniforms.N && w + local_id.y < uniforms.K) {\n       tileK[TILE_SIZE * local_id.y + local_id.x] = v[offsetB + (w + local_id.y) * uniforms.N];\n     }\n     workgroupBarrier();\n     for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n       value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * k + local_id.x];\n     }\n     workgroupBarrier();\n   }\n\n   // we need to transpose output from BNSH_v to BSND_v\n   let batchIdx = workgroup_id.z / uniforms.num_heads;\n   let currentBatchHeadNumber = workgroup_id.z % uniforms.num_heads;\n   let headOffset = (batchIdx * uniforms.M * uniforms.num_heads + currentBatchHeadNumber) * uniforms.N;\n   if (m < uniforms.M && n < uniforms.N) {\n     let outputIdx = batchIdx * uniforms.M *uniforms.v_hidden_size + m * uniforms.v_hidden_size\n       + currentBatchHeadNumber * uniforms.N + n;\n     output[outputIdx] = value;\n   }\n  }`};return e.compute({name:"AttentionScore",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:n,dataType:t.dataType,gpuDataType:0}],dispatchGroup:u,programUniforms:l}),getShaderSource:a},{inputs:[t,r],outputs:[0]})[0]},nn=(e,t,r,o,n,s,u,l,a,p,h)=>{let g=el(e,t,r,a,p,h);tl(e,g,o,p)},rl=(e,t)=>{let r=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],o=t.sequenceLength,n=t.inputHiddenSize,s=t.headSize,u=12,l={x:Math.ceil(t.headSize/u),y:Math.ceil(t.sequenceLength/u),z:t.batchSize*t.numHeads},a=[e.inputs[0],e.inputs[1],e.inputs[2]],p=[{type:"uint32",data:o},{type:"uint32",data:n},{type:"uint32",data:s},{type:"uint32",data:t.numHeads},{type:"uint32",data:t.headSize},{type:"uint32",data:t.hiddenSize},{type:"uint32",data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}],h=g=>{let w=j("output_q",a[0].dataType,r),v=j("output_k",a[0].dataType,r),y=j("output_v",a[0].dataType,r),_=M("input",a[0].dataType,a[0].dims),A=M("weight",a[1].dataType,a[1].dims),S=M("bias",a[2].dataType,a[2].dims),I=_.type.storage,P=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`\n  const TILE_SIZE = ${u}u;\n  var<workgroup> tileInput: array<${I}, ${u*u}>;\n  var<workgroup> tileWeightQ: array<${I}, ${u*u}>;\n  var<workgroup> tileWeightK: array<${I}, ${u*u}>;\n  var<workgroup> tileWeightV: array<${I}, ${u*u}>;\n  ${g.registerUniforms(P).declareVariables(_,A,S,w,v,y)}\n  ${g.mainStart([u,u,1])}\n    let batchIndex = workgroup_id.z / uniforms.num_heads;\n    let headNumber = workgroup_id.z % uniforms.num_heads;\n    let m = workgroup_id.y * TILE_SIZE + local_id.y;\n    let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;\n    let biasOffsetQ = headNumber * uniforms.head_size;\n    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;\n    let biasOffsetV = uniforms.hidden_size + biasOffsetK;\n\n    var valueQ = ${I}(0);\n    var valueK = ${I}(0);\n    var valueV = ${I}(0);\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m < uniforms.M && w + local_id.x < uniforms.K) {\n        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];\n      }\n      if (n < uniforms.N && w + local_id.y < uniforms.K) {\n        let offset = n + (w + local_id.y) * uniforms.ldb;\n        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];\n        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];\n        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];\n      }\n      workgroupBarrier();\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        let inputTileOffset = TILE_SIZE * local_id.y + k;\n        let weightTileOffset = TILE_SIZE * k + local_id.x;\n        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];\n        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];\n        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = (m * uniforms.N + n) % uniforms.head_size;\n    valueQ += bias[headOffset + biasOffsetQ];\n    valueK += bias[headOffset + biasOffsetK];\n    valueV += bias[headOffset + biasOffsetV];\n\n    let offset = workgroup_id.z * uniforms.M * uniforms.N;\n    if (m < uniforms.M && n < uniforms.N) {\n      let outputIdx = offset + m * uniforms.N + n;\n      output_q[outputIdx] = valueQ;\n      output_k[outputIdx] = valueK;\n      output_v[outputIdx] = valueV;\n    }\n  }`};return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:l,programUniforms:p}),getShaderSource:h},{inputs:a,outputs:[-1,-1,-1]})},ti=(e,t)=>{let r=Qd(e.inputs,t),[o,n,s]=rl(e,r);return nn(e,o,n,s,e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t)}});var nl,ol,al,ri,ni=q(()=>{"use strict";Xt();$e();Fe();we();nl=(e,t)=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs");let r=(o,n,s)=>{let u=n.length;if(u!==o.length)throw new Error(`${s}: num dimensions != ${u}`);n.forEach((l,a)=>{if(l!==o[a])throw new Error(`${s}: dim[${a}] do not match`)})};if(e[0].dims.length>1){let o=t.format==="NHWC"?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);r(e[1].dims,o,"Invalid input scale"),r(e[2].dims,o,"Invalid input B"),r(e[3].dims,o,"Invalid input mean"),r(e[4].dims,o,"Invalid input var")}else r(e[1].dims,[1],"Invalid input scale"),r(e[2].dims,[1],"Invalid input B"),r(e[3].dims,[1],"Invalid input mean"),r(e[4].dims,[1],"Invalid input var")},ol=(e,t)=>{let{epsilon:r,spatial:o,format:n}=t,s=e[0].dims,u=o?Le(s[s.length-1]):1,l=n==="NHWC"&&s.length>1?u:1,a=z.size(s)/u,p=Re(s.length)&&o,h=p?s.length:s,g=M("x",e[0].dataType,e[0].dims,u),w=M("scale",e[1].dataType,e[1].dims,l),v=M("bias",e[2].dataType,e[2].dims,l),y=M("inputMean",e[3].dataType,e[3].dims,l),_=M("inputVar",e[4].dataType,e[4].dims,l),A=j("y",e[0].dataType,h,u),S=()=>{let P="";if(o)P=`let cOffset = ${s.length===1?"0u":n==="NHWC"?`outputIndices[${s.length-1}] / ${u}`:"outputIndices[1]"};`;else if(n==="NCHW")P=`\n            ${A.indicesSet("outputIndices","0","0")}\n            let cOffset = ${A.indicesToOffset("outputIndices")};`;else{P=`var cIndices = ${w.type.indices}(0);\n                       cIndices[0] = outputIndices[${s.length-1}];`;for(let C=1;C<w.rank;C++)P+=`cIndices[${C}] = outputIndices[${C}];`;P+=`let cOffset = ${w.indicesToOffset("cIndices")};`}return P},I=P=>`\n  const epsilon = ${r};\n  ${P.registerUniform("outputSize","u32").declareVariables(g,w,v,y,_,A)}\n  ${P.mainStart()}\n  ${P.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n    var outputIndices = ${A.offsetToIndices(`global_idx * ${u}`)};\n    ${S()}\n    let scale = ${w.getByOffset("cOffset")};\n    let bias = ${v.getByOffset("cOffset")};\n    let inputMean = ${y.getByOffset("cOffset")};\n    let inputVar = ${_.getByOffset("cOffset")};\n    let x = ${g.getByOffset("global_idx")};\n    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;\n    ${A.setByOffset("global_idx","value")}\n  }`;return{name:"BatchNormalization",shaderCache:{hint:`${t.epsilon}_${t.format}_${o}_${u}`,inputDependencies:p?["rank","type","type","type","type"]:void 0},getShaderSource:I,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:p?[{type:"uint32",data:a},...F(s)]:[{type:"uint32",data:a}]})}},al=e=>ge(e),ri=(e,t)=>{let{inputs:r,outputCount:o}=e,n=al({...t,outputCount:o});if(Qt.webgpu.validateInputContent&&nl(r,n),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(ol(r,n))}});var il,sl,oi,ai=q(()=>{"use strict";$e();we();il=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},sl=e=>{let t=e[0].dims,r=e[0].dims[2],o=z.size(t)/4,n=e[0].dataType,s=M("input",n,t,4),u=M("bias",n,[r],4),l=M("residual",n,t,4),a=j("output",n,t,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)}}),getShaderSource:h=>`\n  const channels = ${r}u / 4;\n  ${h.declareVariables(s,u,l,a)}\n\n  ${h.mainStart()}\n    ${h.guardAgainstOutOfBoundsWorkgroupSizes(o)}\n    let value = ${s.getByOffset("global_idx")}\n      + ${u.getByOffset("global_idx % channels")} + ${l.getByOffset("global_idx")};\n    ${a.setByOffset("global_idx","value")}\n  }`}},oi=e=>{il(e.inputs),e.compute(sl(e.inputs))}});var ul,Te,ii,si,ui,di,li,ci,pi,mi,fi,dl,hi,gi,yi,bi,on,wi,an,vi,$i,Si,xi,_i,Ci,Ii,Ai,Ti,Ei,Oi,Pi,Bi,ki,Ri,Di,Mi,Qn=q(()=>{"use strict";Ve();$e();Fe();we();ul=(e,t,r,o,n,s)=>{let u=Math.ceil(t/4),l="";typeof n=="string"?l=`${n}(a)`:l=n("a");let a=M("inputData",r,[u],4),p=j("outputData",o,[u],4);return`\n      ${e.registerUniform("vec_size","u32").declareVariables(a,p)}\n\n  ${s??""}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n\n    let a = ${a.getByOffset("global_idx")};\n    ${p.setByOffset("global_idx",l)}\n  }`},Te=(e,t,r,o,n,s=e.dataType)=>({name:t,shaderCache:{hint:n,inputDependencies:["type"]},getShaderSource:u=>ul(u,z.size(e.dims),e.dataType,s,r,o),getRunData:u=>({outputs:[{dims:e.dims,dataType:s}],dispatchGroup:{x:Math.ceil(z.size(u[0].dims)/64/4)},programUniforms:[{type:"uint32",data:Math.ceil(z.size(e.dims)/4)}]})}),ii=e=>{e.compute(Te(e.inputs[0],"Abs","abs"))},si=e=>{e.compute(Te(e.inputs[0],"Acos","acos"))},ui=e=>{e.compute(Te(e.inputs[0],"Acosh","acosh"))},di=e=>{e.compute(Te(e.inputs[0],"Asin","asin"))},li=e=>{e.compute(Te(e.inputs[0],"Asinh","asinh"))},ci=e=>{e.compute(Te(e.inputs[0],"Atan","atan"))},pi=e=>{e.compute(Te(e.inputs[0],"Atanh","atanh"))},mi=e=>ge(e),fi=(e,t)=>{let r;switch(t.to){case 10:r="vec4<f16>";break;case 1:r="vec4<f32>";break;case 12:r="vec4<u32>";break;case 6:r="vec4<i32>";break;case 9:r="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute \'to\' from \'Cast\' operator): ${t.to}`)}e.compute(Te(e.inputs[0],"Cast",r,void 0,t.cacheKey,t.to))},dl=e=>{let t=e.length>=2&&e[1].data!==0?e[1].getFloat32Array()[0]:Qr,r=e.length>=3&&e[2].data!==0?e[2].getFloat32Array()[0]:Xr;return ge({min:t,max:r})},hi=(e,t)=>{let r=e.inputs.length===1?t:dl(e.inputs),o=lt(e.inputs[0].dataType);e.compute(Te(e.inputs[0],"Clip",n=>`clamp(${n}, clip_min_, clip_max_)`,`\n    const clip_min_: vec4<${o}> = vec4(${o}(${r.min}));\n    const clip_max_: vec4<${o}> = vec4(${o}(${r.max}));\n`,r.cacheKey),{inputs:[0]})},gi=e=>{e.compute(Te(e.inputs[0],"Ceil","ceil"))},yi=e=>{e.compute(Te(e.inputs[0],"Cos","cos"))},bi=e=>{e.compute(Te(e.inputs[0],"Cosh","cosh"))},on=e=>ge(e),wi=(e,t)=>{let r=lt(e.inputs[0].dataType);e.compute(Te(e.inputs[0],"Elu",o=>`elu_vf32(${o})`,`\n  const elu_alpha_ = ${r}(${t.alpha});\n\n  fn elu_f32(a: ${r}) -> ${r} {\n  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);\n  }\n\n  fn elu_vf32(v: vec4<${r}>) -> vec4<${r}> {\n  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));\n  }`,t.cacheKey))},an=(e,t="f32")=>`\nconst r0: ${t} = 0.3275911;\nconst r1: ${t} = 0.254829592;\nconst r2: ${t} = -0.284496736;\nconst r3: ${t} = 1.421413741;\nconst r4: ${t} = -1.453152027;\nconst r5: ${t} = 1.061405429;\n\nfn erf_vf32(v: ${e}) -> ${e} {\n  let absv = abs(v);\n  let x = 1.0 / (1.0 + r0 * absv);\n  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));\n}`,vi=e=>{let t=lt(e.inputs[0].dataType);e.compute(Te(e.inputs[0],"Erf",r=>`erf_vf32(${r})`,an(`vec4<${t}>`,t)))},$i=e=>{e.compute(Te(e.inputs[0],"Exp","exp"))},Si=e=>{e.compute(Te(e.inputs[0],"Floor","floor"))},xi=e=>{let t=lt(e.inputs[0].dataType);e.compute(Te(e.inputs[0],"Gelu",r=>`0.5 * ${r} * (1.0 + erf_vf32(${r} * 0.7071067811865475))`,an(`vec4<${t}>`,t)))},_i=(e,t)=>{let r=lt(e.inputs[0].dataType);e.compute(Te(e.inputs[0],"LeakyRelu",o=>`select(leaky_relu_alpha_ * ${o}, ${o}, ${o} >= vec4<${r}>(0.0))`,`const leaky_relu_alpha_ = ${r}(${t.alpha});`,t.cacheKey))},Ci=e=>{e.compute(Te(e.inputs[0],"Not",t=>`!${t}`))},Ii=e=>{e.compute(Te(e.inputs[0],"Neg",t=>`-${t}`))},Ai=e=>{e.compute(Te(e.inputs[0],"Reciprocal",t=>`1.0/${t}`))},Ti=e=>{let t=lt(e.inputs[0].dataType);e.compute(Te(e.inputs[0],"Relu",r=>`select(vec4<${t}>(0.0), ${r}, ${r} > vec4<${t}>(0.0))`))},Ei=e=>{e.compute(Te(e.inputs[0],"Sigmoid",t=>`(1.0 / (1.0 + exp(-${t})))`))},Oi=e=>{e.compute(Te(e.inputs[0],"Sin","sin"))},Pi=e=>{e.compute(Te(e.inputs[0],"Sinh","sinh"))},Bi=e=>{e.compute(Te(e.inputs[0],"Sqrt","sqrt"))},ki=e=>{e.compute(Te(e.inputs[0],"Tan","tan"))},Ri=e=>{e.compute(Te(e.inputs[0],"Tanh","tanh"))},Di=(e,t)=>{let r=lt(e.inputs[0].dataType);return e.compute(Te(e.inputs[0],"ThresholdedRelu",o=>`select(vec4<${r}>(0.0), ${o}, ${o} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${r}>(${t.alpha});`,t.cacheKey)),0},Mi=e=>{e.compute(Te(e.inputs[0],"Log","log"))}});var cl,pl,Ui,zi=q(()=>{"use strict";$e();we();Qn();cl=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},pl=e=>{let t=e[0].dims.slice();t[2]=t[2]/2;let r=M("input",e[0].dataType,e[0].dims,4),o=M("bias",e[0].dataType,[e[0].dims[2]],4),n=j("output",e[0].dataType,t,4),s=z.size(t)/4,u=He(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)}}),getShaderSource:a=>`\n  const M_SQRT2 = sqrt(2.0);\n  const halfChannels = ${e[0].dims[2]/4/2}u;\n\n  ${a.declareVariables(r,o,n)}\n\n  ${an(`vec4<${u}>`,u)}\n\n  ${a.mainStart()}\n    ${a.guardAgainstOutOfBoundsWorkgroupSizes(s)}\n    let biasIdx = global_idx % halfChannels;\n    let batchIndex = global_idx / halfChannels;\n    let inputOffset = biasIdx + batchIndex * halfChannels * 2;\n    let valueLeft = input[inputOffset] + bias[biasIdx];\n    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];\n    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);\n\n    ${n.setByOffset("global_idx","valueLeft * geluRight")}\n  }`}},Ui=e=>{cl(e.inputs),e.compute(pl(e.inputs))}});var ml,fl,ht,Vi,Ni,Wi,Gi,Hi,Li,Fi,ji,qi,Ki,Yi=q(()=>{"use strict";Ve();$e();we();ml=(e,t,r,o,n,s,u,l,a,p,h,g,w)=>{let v,y;typeof l=="string"?v=y=(D,G)=>`${l}((${D}),(${G}))`:typeof l=="function"?v=y=l:(v=l.scalar,y=l.vector);let _=g?t.length:t,A=g?r.length:r,S=g?o.length:o,I=j("outputData",h,S,4),P=M("aData",a,_,4),C=M("bData",p,A,4),V;if(n)if(s){let D=z.size(t)===1,G=z.size(r)===1,T=t.length>0&&t[t.length-1]%4===0,W=r.length>0&&r[r.length-1]%4===0;D||G?V=I.setByOffset("global_idx",y(D?`${P.type.value}(${P.getByOffset("0")}.x)`:P.getByOffset("global_idx"),G?`${C.type.value}(${C.getByOffset("0")}.x)`:C.getByOffset("global_idx"))):V=`\n            let outputIndices = ${I.offsetToIndices("global_idx * 4u")};\n            let offsetA = ${P.broadcastedIndicesToOffset("outputIndices",I)};\n            let offsetB = ${C.broadcastedIndicesToOffset("outputIndices",I)};\n            ${I.setByOffset("global_idx",y(u||T?P.getByOffset("offsetA / 4u"):`${P.type.value}(${P.getByOffset("offsetA / 4u")}[offsetA % 4u])`,u||W?C.getByOffset("offsetB / 4u"):`${C.type.value}(${C.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}\n          `}else V=I.setByOffset("global_idx",y(P.getByOffset("global_idx"),C.getByOffset("global_idx")));else{if(!s)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let D=(G,T,W="")=>{let pe=`aData[indexA${T}][componentA${T}]`,Z=`bData[indexB${T}][componentB${T}]`;return`\n            let outputIndices${T} = ${I.offsetToIndices(`global_idx * 4u + ${T}u`)};\n            let offsetA${T} = ${P.broadcastedIndicesToOffset(`outputIndices${T}`,I)};\n            let offsetB${T} = ${C.broadcastedIndicesToOffset(`outputIndices${T}`,I)};\n            let indexA${T} = offsetA${T} / 4u;\n            let indexB${T} = offsetB${T} / 4u;\n            let componentA${T} = offsetA${T} % 4u;\n            let componentB${T} = offsetB${T} % 4u;\n            ${G}[${T}] = ${W}(${v(pe,Z)});\n          `};h===9?V=`\n            var data = vec4<u32>(0);\n            ${D("data",0,"u32")}\n            ${D("data",1,"u32")}\n            ${D("data",2,"u32")}\n            ${D("data",3,"u32")}\n            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:V=`\n            ${D("outputData[global_idx]",0)}\n            ${D("outputData[global_idx]",1)}\n            ${D("outputData[global_idx]",2)}\n            ${D("outputData[global_idx]",3)}\n          `}return`\n        ${e.registerUniform("vec_size","u32").declareVariables(P,C,I)}\n\n        ${w??""}\n\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${V}\n      }`},fl=(e,t,r,o,n,s,u=r.dataType)=>{let l=!z.areEqual(r.dims,o.dims),a=r.dims,p=z.size(r.dims),h=!1,g=!1,w=[l];if(l){let y=dt.calcShape(r.dims,o.dims,!1);if(!y)throw new Error("Can\'t perform binary op on the given tensors");a=y,p=z.size(a);let _=z.size(r.dims)===1,A=z.size(o.dims)===1,S=r.dims.length>0&&r.dims[r.dims.length-1]%4===0,I=o.dims.length>0&&o.dims[o.dims.length-1]%4===0;w.push(_),w.push(A),w.push(S),w.push(I);let P=1;for(let C=1;C<a.length;C++){let V=r.dims[r.dims.length-C]??1,D=o.dims[o.dims.length-C]??1;if(V===D)P*=V;else break}P%4===0?(g=!0,h=!0):(_||A||S||I)&&(h=!0)}else h=!0;w.push(h);let v=Re(r.dims.length)&&Re(o.dims.length)&&Re(a.length);return{name:e,shaderCache:{hint:t+w.map(y=>y.toString()).join("_"),inputDependencies:v?["rank","rank"]:["dims","dims"]},getShaderSource:y=>ml(y,r.dims,o.dims,a,h,l,g,n,r.dataType,o.dataType,u,v,s),getRunData:()=>({outputs:[{dims:a,dataType:u}],dispatchGroup:{x:Math.ceil(p/64/4)},programUniforms:v?[{type:"uint32",data:Math.ceil(z.size(a)/4)},...F(r.dims),...F(o.dims),...F(a)]:[{type:"uint32",data:Math.ceil(z.size(a)/4)}]})}},ht=(e,t,r,o,n,s)=>{e.compute(fl(t,n??"",e.inputs[0],e.inputs[1],r,o,s))},Vi=e=>{ht(e,"Add",(t,r)=>`${t}+${r}`)},Ni=e=>{ht(e,"Div",(t,r)=>`${t}/${r}`)},Wi=e=>{ht(e,"Equal",{scalar:(t,r)=>`u32(${t}==${r})`,vector:(t,r)=>`vec4<u32>(${t}==${r})`},void 0,void 0,9)},Gi=e=>{ht(e,"Mul",(t,r)=>`${t}*${r}`)},Hi=e=>{let t=M("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;ht(e,"Pow",{scalar:(o,n)=>`pow_custom(${o},${n})`,vector:(o,n)=>`pow_vector_custom(${o},${n})`},`\n    fn pow_custom(a : ${t}, b : ${t}) -> ${t} {\n      if (b == ${t}(0.0)) {\n        return ${t}(1.0);\n      } else if (a < ${t}(0.0) && f32(b) != floor(f32(b))) {\n        return ${t}(pow(f32(a), f32(b))); // NaN\n      }\n      return select(sign(a), ${t}(1.0), round(f32(abs(b) % ${t}(2.0))) != 1.0) * ${t}(${t==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));\n    }\n    fn pow_vector_custom(a : vec4<${t}>, b : vec4<${t}>) -> vec4<${t}> {\n      // TODO: implement vectorized pow\n      return vec4<${t}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));\n    }\n      `)},Li=e=>{ht(e,"Sub",(t,r)=>`${t}-${r}`)},Fi=e=>{ht(e,"Greater",{scalar:(t,r)=>`u32(${t}>${r})`,vector:(t,r)=>`vec4<u32>(${t}>${r})`},void 0,void 0,9)},ji=e=>{ht(e,"Less",{scalar:(t,r)=>`u32(${t}<${r})`,vector:(t,r)=>`vec4<u32>(${t}<${r})`},void 0,void 0,9)},qi=e=>{ht(e,"GreaterOrEqual",{scalar:(t,r)=>`u32(${t}>=${r})`,vector:(t,r)=>`vec4<u32>(${t}>=${r})`},void 0,void 0,9)},Ki=e=>{ht(e,"LessOrEqual",{scalar:(t,r)=>`u32(${t}<=${r})`,vector:(t,r)=>`vec4<u32>(${t}<=${r})`},void 0,void 0,9)}});var gl,yl,bl,wl,Zi,Ji,Qi=q(()=>{"use strict";$e();Fe();we();gl=e=>{if(!e||e.length<1)throw new Error("too few inputs");let t=e[0].dataType,r=e[0].dims.length;for(let o of e){if(o.dataType!==t)throw new Error("input tensors should be one type");if(o.dims.length!==r)throw new Error("input tensors should have the same shape")}},yl=(e,t)=>`\n  fn calculateInputIndex(index: u32) -> u32 {\n    let sizeInConcatAxis = array<u32, ${e}u>(${t});\n    for (var i: u32 = 0u; i < ${e}; i += 1u ) {\n      if (index < sizeInConcatAxis[i]) {\n        return i;\n      }\n    }\n    return ${e}u;\n  }`,bl=(e,t)=>{let r=e.length,o=[];for(let n=0;n<r;++n){let s=t.setByOffset("global_idx",e[n].getByIndices("indices"));r===1?o.push(s):n===0?o.push(`if (inputIndex == ${n}u) { ${s} }`):n===r-1?o.push(`else { ${s} }`):o.push(`else if (inputIndex == ${n}) { ${s} }`)}return o.join(`\n`)},wl=(e,t)=>{let r=e[0].dims.slice();if(t>=r.length||t<-1*r.length)throw new Error("axis specified for concat doesn\'t match input dimensionality");let o=t<0?r.length+t:t,n=r.slice(0);for(let C=1;C<e.length;C++){let V=e[C].dims.slice();for(let D=0;D<r.length;D++)if(D===o)n[o]+=V[D];else if(r[D]!==V[D])throw new Error("non concat dimensions must match")}let s=z.size(n),u=new Array(e.length),l=new Array(e.length),a=e[0].dataType,p=0,h=[],g=[],w=[],v=[{type:"uint32",data:s}];for(let C=0;C<e.length;++C)p+=e[C].dims[o],u[C]=p,w.push(Re(e[C].dims.length)),g.push(w[C]?e[C].dims.length:e[C].dims),l[C]=M(`input${C}`,a,g[C]),h.push(w[C]?"rank":"dims"),v.push({type:"uint32",data:u[C]});for(let C=0;C<e.length;++C)w[C]&&v.push(...F(e[C].dims));let y=Re(n.length);y&&v.push(...F(n));let _=y?n.length:n,A=j("output",a,_),S=A.indicesGet("indices",o),I=Array.from(Array(u.length).keys()).map(C=>`uniforms.sizeInConcatAxis${C}`).join(","),P=C=>`\n\n  ${(()=>{C.registerUniform("outputSize","u32");for(let V=0;V<e.length;V++)C.registerUniform(`sizeInConcatAxis${V}`,"u32");return C.declareVariables(...l,A)})()}\n\n  ${yl(u.length,I)}\n\n  ${C.mainStart()}\n    ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n    var indices = ${A.offsetToIndices("global_idx")};\n\n    let inputIndex = calculateInputIndex(${S});\n    if (inputIndex != 0u) {\n      let sizeInConcatAxis = array<u32, ${u.length}u>(${I});\n      ${S} -= sizeInConcatAxis[inputIndex - 1u];\n    }\n\n    ${bl(l,A)}\n  }`;return{name:"Concat",shaderCache:{hint:`${t}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:v}),getShaderSource:P}},Zi=(e,t)=>{gl(e.inputs),e.compute(wl(e.inputs,t.axis))},Ji=e=>ge({axis:e.axis})});var gt,sn,Tt=q(()=>{"use strict";$e();gt=(e,t)=>{switch(e.activation){case"Relu":return{activationFunction:"",applyActivation:`value = max(value, ${t}(0.0));`};case"Sigmoid":return{activationFunction:"",applyActivation:`value = (${t}(1.0) / (${t}(1.0) + exp(-value)));`};case"Clip":return{activationFunction:`const clip_min_=${t}(${e.clipMin});const clip_max_=${t}(${e.clipMax});`,applyActivation:"value = clamp(value, clip_min_, clip_max_);"};default:return{activationFunction:"",applyActivation:""}}},sn=e=>{let t=e?.activation||"";if(t==="Clip"){let[r,o]=e?.activation_params||[Qr,Xr];return{activation:t,clipMax:o,clipMin:r,activationCacheKey:`${t}:${r},${o}`}}return{activation:t,activationCacheKey:t}}});var qe,un,dn=q(()=>{"use strict";qe=(e,t)=>{switch(e){case 1:return t;case 2:return`vec2<${t}>`;case 3:return`vec3<${t}>`;case 4:return`vec4<${t}>`;default:throw new Error(`${e}-component is not supported.`)}},un=e=>`\n      ${e?"value = value + getBiasByOutputCoords(coords);":""}\n      `});var ln,Xn=q(()=>{"use strict";ln=e=>`\nfn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));\n}\nfn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));\n}\n`});var vl,$l,_r,Xi,Sl,Cr,xl,cn,Ir=q(()=>{"use strict";$e();we();Tt();dn();vl=(e,t)=>e?`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          kStart + inputRow,\n          globalRowStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `:`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          globalRow + innerRow,\n          kStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `,$l=(e,t)=>e?`\n        let ACached0 = mm_Asub[k * innerElementSize][localRow];\n        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];\n        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];\n        ${t===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          acc[i] = BCached0 * ACached0[i] + acc[i];\n          acc[i] = BCached1 * ACached1[i] + acc[i];\n          acc[i] = BCached2 * ACached2[i] + acc[i];\n          ${t===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}\n        }`:`\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          let ACached = mm_Asub[tileRow + i][k];\n          acc[i] = BCached0 * ACached.x + acc[i];\n          acc[i] = BCached1 * ACached.y + acc[i];\n          acc[i] = BCached2 * ACached.z + acc[i];\n          ${t===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}\n        }`,_r=(e,t,r="f32",o,n=!1,s=32,u=!1,l=32)=>{let a=t[1]*e[1],p=t[0]*e[0],h=n?a:s,g=n?s:a,w=h/t[0],v=s/t[1];if(!((n&&w===4&&e[1]===4||!n&&(w===3||w===4))&&h%t[0]===0&&s%t[1]===0&&e[0]===4))throw new Error(`If transposeA ${n} is true, innerElementSize ${w} and workPerThread[1] ${e[1]} must be 4.\n      Otherwise, innerElementSize ${w} must be 3 or 4.\n  tileAWidth ${h} must be divisible by workgroupSize[0]${t[0]}. tileInner ${s} must be divisible by workgroupSize[1] ${t[1]}. colPerThread ${e[0]} must be 4.`);return`\nvar<workgroup> mm_Asub: array<array<vec${w}<${r}>, ${h/w}>, ${g}>;\nvar<workgroup> mm_Bsub: array<array<vec4<${r}>, ${p/e[0]}>, ${s}>;\n\nconst rowPerThread = ${e[1]};\nconst colPerThread = ${e[0]};\nconst innerElementSize = ${w};\nconst tileInner = ${s};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n  let localRow = i32(localId.y);\n  let tileRow = localRow * rowPerThread;\n  let tileCol = i32(localId.x);\n\n  let globalRow =i32(globalId.y) * rowPerThread;\n  let globalCol = i32(globalId.x);\n  let batch = ${u?"0":"i32(globalId.z)"};\n  ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}\n  let globalRowStart = i32(workgroupId.y) * ${a};\n\n  let numTiles = ${u?`${Math.ceil(l/s)}`:"(uniforms.dimInner - 1) / tileInner + 1"};\n  var kStart = ${u?`i32(globalId.z) * ${l}`:"0"};\n\n  var acc: array<vec4<${r}>, rowPerThread>;\n\n  // Loop over shared dimension.\n  let tileRowB = localRow * ${v};\n  for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let inputRow = tileRow + innerRow;\n          let inputCol = tileCol;\n          ${vl(n,o)}\n      }\n\n      // Load one tile of B into local memory.\n      for (var innerRow = 0; innerRow < ${v}; innerRow = innerRow + 1) {\n          let inputRow = tileRowB + innerRow;\n          let inputCol = tileCol;\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${o?", batchIndices":""});\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {\n          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];\n          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];\n          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];\n          ${w===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}\n\n          ${$l(n,w)}\n      }\n\n      workgroupBarrier();\n  }\n\n  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);\n  }\n}`},Xi=(e,t)=>e?`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              kStart + inputRow,\n              globalRowStart + inputCol${t?", batchIndices":""});\n            `:`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              globalRowStart + inputRow,\n              kStart + inputCol${t?", batchIndices":""});\n            `,Sl=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",Cr=(e,t,r="f32",o,n=!1,s=32,u=!1,l=32,a=!1)=>{let p=e[1]*t[1],h=e[0]*t[0],g=n?p:s,w=n?s:p;if(!(w%t[1]===0&&g%t[0]===0&&s%t[1]===0))throw new Error(`tileAHight ${w} must be divisible by workgroupSize[1]${t[1]}, tileAWidth ${g} must be divisible by workgroupSize[0]${t[0]}, tileInner ${s} must be divisible by workgroupSize[1]${t[1]}`);let v=w/t[1],y=g/t[0],_=s/t[1],A=a?`\n    let localRow = i32(localId.y);\n    let localCol = i32(localId.x);\n    let globalRowStart = i32(workgroupId.y) * ${p};\n    let globalColStart = i32(workgroupId.x) * ${h};\n\n    // Loop over shared dimension.\n    for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var inputRow = localRow; inputRow < ${w}; inputRow = inputRow + ${t[1]}) {\n        for (var inputCol = localCol; inputCol < ${g}; inputCol = inputCol + ${t[0]}) {\n          ${Xi(n,o)}\n        }\n      }\n      // Load one tile of B into local memory.\n      for (var inputRow = localRow; inputRow < ${s}; inputRow = inputRow + ${t[1]}) {\n            for (var inputCol = localCol; inputCol < ${h}; inputCol = inputCol + ${t[0]}) {\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n            kStart + inputRow,\n            globalColStart + inputCol${o?", batchIndices":""});\n        }\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      var BCached : array<${r}, colPerThread>;\n      for (var k = 0; k < tileInner; k = k + 1) {\n        for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n          BCached[inner] = mm_Bsub[k][localCol + inner * ${t[0]}];\n        }\n        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let ACached = ${n?`mm_Asub[k][localRow + innerRow * ${t[1]}];`:`mm_Asub[localRow + innerRow * ${t[1]}][k];`}\n          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n            acc[innerRow][innerCol] = acc[innerRow][innerCol] +\n                ACached * BCached[innerCol];\n          }\n        }\n      }\n      workgroupBarrier();\n    }\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      let gRow = globalRowStart + localRow + innerRow * ${t[1]};\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        let gCol = globalColStart + localCol + innerCol * ${t[0]};\n        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);\n      }\n    }\n    `:`\nlet tileRow = i32(localId.y) * rowPerThread;\nlet tileCol = i32(localId.x) * colPerThread;\n\nlet globalRow = i32(globalId.y) * rowPerThread;\nlet globalCol = i32(globalId.x) * colPerThread;\nlet globalRowStart = i32(workgroupId.y) * ${p};\n\nlet tileRowA = i32(localId.y) * ${v};\nlet tileColA = i32(localId.x) * ${y};\nlet tileRowB = i32(localId.y) * ${_};\n// Loop over shared dimension.\nfor (var t = 0; t < numTiles; t = t + 1) {\n  // Load one tile of A into local memory.\n  for (var innerRow = 0; innerRow < ${v}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < ${y}; innerCol = innerCol + 1) {\n      let inputRow = tileRowA + innerRow;\n      let inputCol = tileColA + innerCol;\n      ${Xi(n,o)}\n    }\n  }\n\n  // Load one tile of B into local memory.\n  for (var innerRow = 0; innerRow < ${_}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n      let inputRow = tileRowB + innerRow;\n      let inputCol = tileCol + innerCol;\n      mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n        kStart + inputRow,\n        globalCol + innerCol${o?", batchIndices":""});\n    }\n  }\n  kStart = kStart + tileInner;\n  workgroupBarrier();\n\n  // Compute acc values for a single thread.\n  var BCached : array<${r}, colPerThread>;\n  for (var k = 0; k < tileInner; k = k + 1) {\n    for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n      BCached[inner] = mm_Bsub[k][tileCol + inner];\n    }\n\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      ${Sl(n)}\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];\n      }\n    }\n  }\n\n  workgroupBarrier();\n}\n\nfor (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n    mm_write(batch, globalRow + innerRow, globalCol + innerCol,\n        acc[innerRow][innerCol]);\n  }\n}\n`;return`\n  var<workgroup> mm_Asub : array<array<${r}, ${g}>, ${w}>;\n  var<workgroup> mm_Bsub : array<array<${r}, ${h}>, ${s}>;\n  const rowPerThread = ${e[1]};\n  const colPerThread = ${e[0]};\n  const tileInner = ${s};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n    let batch = ${u?"0":"i32(globalId.z)"};\n    ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}\n    let numTiles = ${u?`${Math.ceil(l/s)}`:"(uniforms.dimInner - 1) / tileInner + 1"};\n    var kStart = ${u?`i32(globalId.z) * ${l}`:"0"};\n\n    var acc : array<array<${r}, colPerThread>, rowPerThread>;\n\n    // Without this initialization strange values show up in acc.\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = 0.0;\n      }\n    }\n    ${A}\n  }\n`},xl=(e,t,r,o,n,s=!1)=>{let[u,l,a]=n,[p,h,g,w]=o,v=er(u,a),y=er(l,a),_=He(o[0].type.tensor),A=()=>{let P=h.rank,C=p.rank,V=`var aIndices: ${h.type.indices};`;for(let D=P-2-1,G=C-1;D>=0;D--,G--)V+=`\naIndices[${D}] = ${C>1?`batchIndices[${G}]`:"batchIndices"};`;return v.forEach(D=>{V+=`\naIndices[${D}] = 0;`}),V+=`\naIndices[${P-2}] = u32(row);\n                   aIndices[${P-1}] = u32(colIn);`,V},S=()=>{let P=g.rank,C=p.rank,V=`var bIndices: ${g.type.indices};`;for(let D=P-2-1,G=C-1;D>=0;D--,G--)V+=`\nbIndices[${D}] = ${C>1?`batchIndices[${G}]`:"batchIndices"};`;return y.forEach(D=>{V+=`\nbIndices[${D}] = 0;`}),V+=`\nbIndices[${P-2}] = u32(row);\n                   bIndices[${P-1}] = u32(colIn);`,V};return`\n    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${p.type.indices}) -> ${qe(e,_)} {\n      var value = ${qe(e,_)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dimAOuter && col < uniforms.dimInner)\n      {\n        ${A()}\n        value = ${h.getByIndices("aIndices")};\n      }\n      return value;\n    }\n\n    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${p.type.indices}) -> ${qe(e,_)} {\n      var value = ${qe(e,_)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dimInner && col < uniforms.dimBOuter)\n      {\n        ${S()}\n        value = ${g.getByIndices("bIndices")};\n      }\n      return value;\n    }\n\n    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${qe(e,_)}) {\n      let col = colIn * ${e};\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n        var value = valueIn;\n        let coords = vec3<i32>(batch, row, colIn);\n        ${t?`value = value + ${s?"bias[colIn]":`${qe(e,_)}(bias[row])`};`:""}\n        ${r}\n        ${w.setByIndices("vec3<u32>(coords)","value")}\n      }\n    }\n    `},cn=(e,t,r,o,n=!1)=>{let s=e[0].dims,u=e[1].dims,l=s.slice(0,-2),a=u.slice(0,-2),p=o?o.slice(0,-2):r.slice(0,-2),h=Re(p.length),g=h?p.length:p,w=en("batchDims",e[0].dataType,g,1),v=z.size(p),y=s[s.length-2],_=s[s.length-1],A=u[u.length-1],S=_%4===0&&A%4===0,I=y<=8?[4,1,1]:[4,4,1],P=[8,8,1],C=[Math.ceil(A/P[0]/I[0]),Math.ceil(y/P[1]/I[1]),Math.ceil(v/P[2]/I[2])],V=He(e[0].dataType),D=S?4:1,G=[...l,y,_/D],T=Re(G.length),W=T?G.length:G,pe=[...a,_,A/D],Z=Re(pe.length),K=Z?pe.length:pe,X=[v,y,A/D],J=M("a",e[0].dataType,W,D),Ae=M("b",e[1].dataType,K,D),Oe=j("result",e[0].dataType,X.length,D),fe=[J,Ae],Ce=[{type:"int32",data:y},{type:"int32",data:A},{type:"int32",data:_}];h&&Ce.push(...F(p)),T&&Ce.push(...F(G)),Z&&Ce.push(...F(pe));let he=[];he.push(T?"rank":"dims"),he.push(Z?"rank":"dims");let ye=e.length>2,{activationFunction:Ne,applyActivation:Ue}=gt(t,Oe.type.value),Ge=xl(D,ye,Ue,[w,J,Ae,Oe],[l,a,p],n);if(ye){let re=n?D:1;fe.push(M("bias",e[2].dataType,e[2].dims.length,re)),Ce.push(...F(e[2].dims)),he.push("rank")}Ce.push(...F(X));let H=re=>`\n  ${re.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").registerInternalVariables(w).declareVariables(...fe,Oe)}\n  ${Ne}\n  ${Ge}\n  ${S?_r(I,P,V,w):Cr(I,P,V,w)}\n                   `;return{name:"MatMul",shaderCache:{hint:t.activationCacheKey+`${I}${S}${n}`,inputDependencies:he},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:C[0],y:C[1],z:C[2]},programUniforms:Ce}),getShaderSource:H}}});var _l,es,ts=q(()=>{"use strict";At();we();Tt();dn();Xn();Ir();_l=(e,t,r,o,n=!1,s,u=4,l=4,a=4,p="f32")=>{let h=Z=>{switch(Z){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${p}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${Z} is not supported.`)}},g=Z=>{switch(Z){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${Z} is not supported.`)}},w=e?`\n    let coord = vec4<i32>(batch, xRow, xCol, xCh);\n    `:`\n    let coord = vec4<i32>(batch, xCh, xRow, xCol);\n    `,v=e?`\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    `:`\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    `,y=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",_=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",A=e?"row":"col",S=e?"col":"row",I=`\n    let inChannels = i32(uniforms.w_shape[2]);\n    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n    let outRow = ${A} / outWidth;\n    let outCol = ${A} % outWidth;\n\n    let WRow = ${S} / (filterDims[1] * inChannels);\n    let WCol = ${S} / inChannels % filterDims[1];\n    let xRow = outRow * stride[0] + dilation[0] * WRow - pad[0];\n    let xCol = outCol * stride[1] + dilation[1] * WCol - pad[1];\n    let xCh = ${S} % inChannels;\n    var resData = ${qe(u,p)}(0.0);\n    // The bounds checking is always needed since we use it to pad zero for\n    // the \'same\' padding type.\n    if (xRow >= 0 && xRow < ${y} && xCol >= 0 && xCol < ${_}) {\n      ${w}\n      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));\n      ${h(u)}\n    }\n    return resData;`,P=e?t&&o?`\n    let col = colIn * ${u};\n    ${I}`:`\n    let col = colIn * ${u};\n    if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n      ${I}\n    }\n    return ${qe(u,p)}(0.0);`:o&&r?`\n    let col = colIn * ${u};\n    ${I}`:`\n    let col = colIn * ${u};\n    if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n      ${I}\n    }\n    return ${qe(u,p)}(0.0);`,C=`${g(l)}`,V=qe(a,p),D=e?qe(u,p):qe(l,p),G=e?qe(l,p):qe(u,p),{activationFunction:T,applyActivation:W}=gt(s,V);return`\n    ${T}\n    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${D} {\n      ${e?P:C}\n    }\n\n    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${G} {\n      ${e?C:P}\n    }\n\n    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${V}) {\n      let col = colIn * ${a};\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)\n      {\n      var value = valueIn;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${v}\n      ${un(n)}\n      ${W}\n      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n      }\n    }`},es=(e,t,r,o,n,s,u,l)=>{let a=t.format==="NHWC",p=a?e[0].dims[3]:e[0].dims[1],h=r[0],g=a?r[2]:r[3],w=a?r[1]:r[2],v=a?r[3]:r[1],y=a&&(p%4===0||p%3===0)&&v%4===0,_=a?v:g*w,A=a?g*w:v,S=[8,8,1],I=o<=8?[4,1,1]:[4,4,1],P=[Math.ceil(_/S[0]/I[0]),Math.ceil(A/S[1]/I[1]),Math.ceil(h/S[2]/I[2])];Me("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${P}`);let C=y?a&&p%4!==0?3:4:1,V=S[1]*I[1],D=S[0]*I[0],G=Math.max(S[0]*C,S[1]),T=o%V===0,W=n%D===0,pe=s%G===0,Z=y?[C,4,4]:[1,1,1],K=He(e[0].dataType),X=y?4:1,J=[{type:"int32",data:o},{type:"int32",data:n},{type:"int32",data:s}],Ae=M("x",e[0].dataType,e[0].dims.length,C===3?1:C),Oe=M("w",e[1].dataType,e[1].dims.length,X),fe=[Ae,Oe];J.push(...F(e[0].dims)),J.push(...F(e[1].dims));let Ce=`\n      fn setOutputAtIndex(flatIndex : i32, value : ${y?`vec4<${K}>`:K}) {\n        result[flatIndex] = ${y?`vec4<${K}>`:K}(value);\n      }\n      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${y?`vec4<${K}>`:K}) {\n        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));\n        setOutputAtIndex(flatIndex ${y?"/ 4":""}, value);\n      }`;if(u){let ye=M("bias",e[2].dataType,e[2].dims.length,X);fe.push(ye),J.push(...F(e[2].dims)),Ce+=`\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${y?`vec4<${K}>`:K} {\n          return bias[coords.${a?"w":"y"}${y?"/ 4":""}];\n        }`}let he=j("result",e[0].dataType,r.length,X);return J.push(...F(r)),{name:"Conv2DMatMul",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:P[0],y:P[1],z:P[2]},programUniforms:J}),getShaderSource:ye=>`\n        ${ln("uniforms.result_strides")}\n        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,\n        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,\n        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };\n        ${ye.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").declareVariables(...fe,he)}\n        const filterDims : vec2<i32> = vec2<i32>(${t.kernelShape[0]}, ${t.kernelShape[1]});\n        const pad : vec2<i32> = vec2<i32>(${t.pads[0]}, ${t.pads[1]});\n        const stride : vec2<i32> = vec2<i32>(${t.strides[0]}, ${t.strides[1]});\n        const dilation : vec2<i32> = vec2<i32>(${t.dilations[0]}, ${t.dilations[1]});\n        ${Ce}\n        ${_l(a,T,W,pe,u,t,Z[0],Z[1],Z[2],K)}\n            ${y?_r(I,S,K,void 0,!a,G):Cr(I,S,K,void 0,!a,G,!1,void 0,l)}`}}});var eo,rs=q(()=>{"use strict";$e();we();ro();Tt();eo=(e,t,r)=>{let o=e.length>2,n=o?"value += b[output_channel];":"",s=e[0].dims,u=e[1].dims,l=u[0]/t.group,a=t.format==="NHWC",p=to(s,u,t.dilations,t.pads,t.strides,a),h=z.size(p),g=j("output",e[0].dataType,p),{activationFunction:w,applyActivation:v}=gt(t,g.type.value),y=M("x",e[0].dataType,s),_=M("w",e[1].dataType,u),A=[y,_];o&&A.push(M("b",e[2].dataType,e[2].dims));let S=I=>`\n  const strides: vec2<u32> = vec2(${t.strides[0]}u, ${t.strides[1]}u);\n  const pads: vec2<u32> = vec2(${t.pads[0]}u, ${t.pads[1]}u);\n\n  ${I.declareVariables(...A,g)}\n\n  ${w}\n\n  ${I.mainStart()}\n    ${I.guardAgainstOutOfBoundsWorkgroupSizes(h)}\n\n    let outputIndices = ${g.offsetToIndices("global_idx")};\n    let batch: u32 = outputIndices[0];\n    let output_channel: u32 = outputIndices[${a?3:1}];\n    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${a?1:2}], outputIndices[${a?2:3}]) * strides - pads;\n    let group_id: u32 = output_channel / ${l}u;\n\n    var value: ${g.type.value} = ${g.type.value}(0);\n    for (var wInChannel: u32 = 0u; wInChannel < ${u[1]}u; wInChannel++) {\n      let input_channel = group_id * ${u[1]}u + wInChannel;\n      for (var wHeight: u32 = 0u; wHeight < ${u[2]}u; wHeight++) {\n        let xHeight = xRCCorner.x + wHeight * ${t.dilations[0]}u;\n\n        if (xHeight < 0u || xHeight >= ${s[a?1:2]}u) {\n          continue;\n        }\n\n        for (var wWidth: u32 = 0u; wWidth < ${u[3]}u; wWidth++) {\n          let xWidth = xRCCorner.y + wWidth * ${t.dilations[1]}u;\n          if (xWidth < 0u || xWidth >= ${s[a?2:3]}u) {\n            continue;\n          }\n\n          let xVal = ${a?y.get("batch","xHeight","xWidth","input_channel"):y.get("batch","input_channel","xHeight","xWidth")};\n          let wVal = ${_.get("output_channel","wInChannel","wHeight","wWidth")};\n          value += xVal*wVal;\n        }\n      }\n    }\n    ${n}\n    ${v}\n    ${g.setByOffset("global_idx","value")}\n  }`;return{name:"GroupedConv",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r?r(p):p,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)}}),getShaderSource:S}}});var no,Cl,ns,oo=q(()=>{"use strict";$e();Ir();we();Tt();no=(e,t,r,o,n=!1)=>{let s=e[0].dims,u=e[1].dims,l=s[s.length-2],a=u[u.length-1],p=s[s.length-1],h=Le(a),g=Le(p),w=Le(l),v=z.size(r)/h/w,y=e.length>2,_=o?o.slice(0,-2):r.slice(0,-2),S=[z.size(_),l,a],I=[{type:"uint32",data:v},{type:"uint32",data:l},{type:"uint32",data:a},{type:"uint32",data:p},...F(_),...F(s),...F(u)];y&&I.push(...F(e[2].dims)),I.push(...F(S));let P=C=>{let V=en("batch_dims",e[0].dataType,_.length),D=M("a",e[0].dataType,s.length,g),G=M("b",e[1].dataType,u.length,h),T=j("output",e[0].dataType,S.length,h),{activationFunction:W,applyActivation:pe}=gt(t,T.type.value),Z=[D,G],K="";if(y){let he=n?h:1;Z.push(M("bias",e[2].dataType,e[2].dims.length,he)),K=`${n?`value += bias[col / ${he}];`:`value += ${T.type.value}(bias[row + i]);`}`}let X=s.slice(0,-2),J=u.slice(0,-2),Ae=er(X,_),Oe=er(J,_),fe=(he,ye)=>{let Ne=he.rank,Ue=he.name;if(Ne===2)return`var ${Ue}_indices = ${he.type.indices}(0u, 0u);`;let Ge=V.rank,H=`var ${Ue}_indices: ${he.type.indices};`;for(let re=Ne-2-1,be=Ge-1;re>=0;re--,be--)H+=`\n${Ue}_indices[${re}] = ${Ge>1?`batch_indices[${be}]`:"batch_indices"};`;return ye.forEach(re=>{H+=`\n${Ue}_indices[${re}] = 0;`}),H+=`${Ue}_indices[${Ne-2}] = 0u;\n                     ${Ue}_indices[${Ne-1}] = 0u;`,H},Ce=()=>{let he=`var a_data: ${D.type.value};`;for(let ye=0;ye<g;ye++)he+=`\n              let b_data${ye} = b[(b_offset + (k + ${ye}) * uniforms.N + col) / ${h}];`;for(let ye=0;ye<w;ye++){he+=`a_data = a[(a_offset + (row + ${ye}) * uniforms.K + k) / ${g}];`;for(let Ne=0;Ne<g;Ne++)he+=`\n            values[${ye}] = fma(${G.type.value}(a_data${g===1?"":`[${Ne}]`}), b_data${Ne}, values[${ye}]);\n`}return he};return`\n  ${C.registerUniform("outputSize","u32").registerUniform("M","u32").registerUniform("N","u32").registerUniform("K","u32").registerInternalVariables(V).declareVariables(...Z,T)}\n  ${W}\n  ${C.mainStart()}\n    ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n    let col = (global_idx % (uniforms.N / ${h})) * ${h};\n    var index1 = global_idx / (uniforms.N / ${h});\n    let stride1 = uniforms.M / ${w};\n    let row = (index1 % stride1) * ${w};\n    let batch = index1 / stride1;\n\n    ${r.length===2?"":`let batch_indices = ${V.offsetToIndices("batch")};`}\n    ${fe(D,Ae)}\n    let a_offset = ${D.indicesToOffset("a_indices")};\n    ${fe(G,Oe)}\n    let b_offset = ${G.indicesToOffset("b_indices")};\n    var values: array<${T.type.value}, ${w}>;\n    for (var k: u32 = 0u; k < uniforms.K; k = k + ${g}) {\n      ${Ce()}\n    }\n    for (var i = 0u; i < ${w}u; i++) {\n      var value = values[i];\n      ${K}\n      ${pe}\n      let cur_indices = ${T.type.indices}(batch, row + i, col);\n      let offset = ${T.indicesToOffset("cur_indices")};\n      ${T.setByOffset(`offset / ${h}`,"value")};\n    }\n  }\n  `};return{name:"MatMulNaive",shaderCache:{hint:`${t.activationCacheKey}_${h}_${g}_${w}_${n}`,inputDependencies:y?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:I}),getShaderSource:P}},Cl=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},ns=e=>{Cl(e.inputs);let t=dt.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can\'t use matmul on the given tensors");let r=t[t.length-1],o=e.inputs[0].dims[e.inputs[0].dims.length-1];r<8&&o<8?e.compute(no(e.inputs,{activation:"",activationCacheKey:""},t)):e.compute(cn(e.inputs,{activation:"",activationCacheKey:""},t))}});var to,os,Il,as,ao,Al,Tl,io,ro=q(()=>{"use strict";$e();Fe();ts();Ir();rs();Tt();oo();tr();to=(e,t,r,o,n,s)=>{let u=e[0],l=e.slice(s?1:2,s?3:4),a=l.length,p=t[0],g=t.slice(2).map((y,_)=>y+(y-1)*(r[_]-1)),v=l.map((y,_)=>y+o[_]+o[_+a]).map((y,_)=>Math.floor((y-g[_]+n[_])/n[_]));return v.splice(0,0,u),v.splice(s?3:1,0,p),v},os=[2,3,1,0],Il=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support conv 1D and 2D");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[1]*t.group;if(r!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let n=e[0].dims.length-2;if(t.dilations.length!==n)throw new Error(`dilations should be ${n}D`);if(t.strides.length!==n)throw new Error(`strides should be ${n}D`);if(t.pads.length!==n*2)throw new Error(`pads should be ${n*2}D`);if(t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},as=(e,t)=>{let r=e.kernelShape.slice();for(let s=2;s<t[1].dims.length;++s)r[s-2]===0&&(r[s-2]=t[1].dims[s]);let o=e.pads.slice();zt.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,o,e.format==="NHWC",e.autoPad);let n=Object.assign({},e);return Object.assign(n,{kernelShape:r,pads:o,cacheKey:e.cacheKey}),n},ao=e=>{let t=sn(e),r=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],n=e.dilations,s=e.group,u=e.kernel_shape,l=e.pads,a=e.strides,p=e.w_is_const();return ge({autoPad:o,format:r,dilations:n,group:s,kernelShape:u,pads:l,strides:a,wIsConst:p,...t})},Al=(e,t,r)=>{let o=as(r,t),n=r.format==="NHWC";if(r.group!==1){e.compute(eo(t,o));return}let s=t.length===3,u=t[0].dims[n?1:2],l=t[0].dims[n?2:3],a=t[0].dims[n?3:1],p=t[1].dims[2],h=t[1].dims[3],g=to(t[0].dims,t[1].dims,r.dilations,o.pads,r.strides,n),w=g[n?1:2],v=g[n?2:3],y=g[n?3:1],_=n&&p===u&&h===l&&r.pads[0]===0&&r.pads[1]===0;if(_||p===1&&h===1&&r.dilations[0]===1&&r.dilations[1]===1&&r.strides[0]===1&&r.strides[1]===1&&r.pads[0]===0&&r.pads[1]===0){let D=g[0],G,T,W,pe=[];if(n){let X=e.kernelCustomData.wT??e.compute(st(t[1],os),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];if(r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=X),_){let J=u*l*a;G=t[0].reshape([1,D,J]),T=X.reshape([1,J,y]),W=[1,D,y]}else G=t[0].reshape([D,u*l,a]),T=X.reshape([1,a,y]),W=[D,w*v,y];pe.push(G),pe.push(T)}else G=t[0].reshape([D,a,u*l]),T=t[1].reshape([1,y,a]),W=[D,y,w*v],pe.push(T),pe.push(G);s&&pe.push(t[2]);let Z=W[2],K=pe[0].dims[pe[0].dims.length-1];Z<8&&K<8?e.compute(no(pe,o,g,W,n),{inputs:pe}):e.compute(cn(pe,o,g,W,n),{inputs:pe});return}let A=!0,S=e.kernelCustomData.wT??e.compute(st(t[1],os),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=S);let I=[t[0],S];s&&I.push(t[2]);let P=n?w*v:y,C=n?y:w*v,V=p*h*a;e.compute(es(I,o,g,P,C,V,s,A),{inputs:I})},Tl=(e,t)=>{let r=t.format==="NHWC",o=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&o.push(e.inputs[2]);let n=[0,t.pads[0],0,t.pads[1]],s=[1].concat(t.strides),u=[1].concat(t.dilations),l=[1].concat(t.kernelShape),a=as({...t,pads:n,strides:s,dilations:u,kernelShape:l},o);e.compute(eo(o,a,p=>r?[p[0],p[2],p[3]]:[]))},io=(e,t)=>{Il(e.inputs,t),e.inputs[0].dims.length===3?Tl(e,t):Al(e,e.inputs,t)}});var El,is,ss=q(()=>{"use strict";At();we();Tt();dn();Xn();Ir();El=(e,t=!1,r,o=4)=>{let n=qe(o,"f32"),s=I=>{switch(I){case 1:return"return w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];";case 4:return`\n            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);\n            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);\n            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);\n            let v0 = w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];\n            let v1 = w[getIndexFromCoords4D(coord1, vec4<i32>(uniforms.w_shape))];\n            let v2 = w[getIndexFromCoords4D(coord2, vec4<i32>(uniforms.w_shape))];\n            let v3 = w[getIndexFromCoords4D(coord3, vec4<i32>(uniforms.w_shape))];\n            return vec4<f32>(v0, v1, v2, v3);\n            `;default:throw new Error(`innerElementSize ${I} is not supported.`)}},u=e?`\n      let coord = vec4<i32>(batch, iXR, iXC, xCh);\n      `:`\n      let coord = vec4<i32>(batch, xCh, iXR, iXC);\n      `,l=e?`\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    `:`\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    `,a=e?"outBackprop[1]":"outBackprop[2]",p=e?"outBackprop[2]":"outBackprop[3]",h=e?"row":"col",g=e?"col":"row",w=`\n      let inChannels = ${e?"outBackprop[3]":"outBackprop[1]"};\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      let outRow = ${h} / outWidth;\n      let outCol = ${h} % outWidth;\n\n      let WRow = ${g} / (filterDims[1] * inChannels);\n      let WCol = ${g} / inChannels % filterDims[1];\n      let xR = f32(outRow - pads[0] + dilation[0] * WRow) / f32(strides[0]);\n      let xC = f32(outCol - pads[1] + dilation[1] * WCol) / f32(strides[1]);\n      if (xR < 0.0 || xR >= f32(${a}) || fract(xR) > 0.0) {\n        return ${n}(0.0);\n      }\n      if (xC < 0.0 || xC >= f32(${p}) || fract(xC) > 0.0) {\n        return ${n}(0.0);\n      }\n      let iXR = i32(xR);\n      let iXC = i32(xC);\n      let xCh = ${g} % inChannels;\n      ${u}\n      return x[getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape))/${o}];`,v=e?`\n      let col = colIn * ${o};\n      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n        ${w}\n      }\n      return ${n}(0.0);`:`\n      let col = colIn * ${o};\n      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n        ${w}\n      }\n      return ${n}(0.0);`,y=`\n      let col = colIn * ${o};\n      let inChannels = ${e?"outBackprop[3]":"outBackprop[1]"};\n      let coordX = filterDims.x - 1 - row / (filterDims[1] * inChannels);\n      let coordY = filterDims.y - 1 - (row / inChannels) % filterDims[1];\n      if (${e?"row < uniforms.dimInner && col < uniforms.dimBOuter":"row < uniforms.dimInner && col < uniforms.dimAOuter"}  && coordX >= 0 && coordY >= 0) {\n        let rowInner = row % inChannels;\n        let coord = vec4<i32>(coordX, coordY, col, rowInner);\n        ${s(o)}\n      }\n      return ${n}(0.0);\n      `,{activationFunction:_,applyActivation:A}=gt(r,n);return`\n      ${_}\n  fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${n} {\n    ${e?v:y}\n  }\n\n  fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${n} {\n    ${e?y:v}\n  }\n\n  fn mm_write(batch: i32, row : i32, colIn : i32, valueInput : ${n}) {\n    let col = colIn * ${o};\n    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n      var value = valueInput;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${l}\n      ${un(t)}\n      ${A}\n      result[getIndexFromCoords4D(coords, vec4<i32>(uniforms.result_shape))/${o}] = value;\n    }\n  }`},is=(e,t,r,o,n,s,u,l)=>{let a=t.format==="NHWC",p=a?e[0].dims[3]:e[0].dims[1],h=r[0],g=a?r[2]:r[3],w=a?r[1]:r[2],v=a?r[3]:r[1],y=a?p%4===0&&v%4===0:g%4===0&&v%4===0,_=a?v:g*w,A=a?g*w:v,S=y?[8,8,1]:[_<=4||A<=4?4:16,_>4&&A<=4?4:16,1],I=y?[4,4,1]:[_<=4?1:4,_>4&&A<=4?1:4,1],P=[Math.ceil(_/S[0]/I[0]),Math.ceil(A/S[1]/I[1]),Math.ceil(h/S[2]/I[2])];Me("verbose",()=>`[conv_backprop_mm_webgpu] dispatch = ${P}`);let C=y?4:1,V=Math.max(S[0]*C,S[1]),D=y?4:1,G=[{type:"int32",data:o},{type:"int32",data:n},{type:"int32",data:s}],T=M("x",e[0].dataType,e[0].dims.length,D),W=M("w",e[1].dataType,e[1].dims.length,1),pe=j("result",e[0].dataType,r.length,D),Z=[T,W];G.push(...F(e[0].dims)),G.push(...F(e[1].dims));let K="";if(u){let X=M("bias",e[2].dataType,e[2].dims.length,D);Z.push(X),G.push(...F(e[2].dims)),K+=`\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${y?"vec4<f32>":"f32"} {\n          return bias[coords.${a?"w":"y"}${y?"/ 4":""}];\n        }`}return G.push(...F(r)),{name:"Conv2DTransposeMatMul",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:P[0],y:P[1],z:P[2]},programUniforms:G}),getShaderSource:X=>`\n        ${ln("uniforms.result_strides")}\n        ${X.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").declareVariables(...Z,pe)};\n        const outBackprop : vec4<i32> = vec4<i32>(${e[0].dims.join(",")});\n        const filterDims : vec2<i32> = vec2<i32>(${t.kernelShape[a?1:2]}, ${t.kernelShape[a?2:3]});\n        const effectiveFilterDims : vec2<i32> = filterDims + vec2<i32>(\n              ${t.dilations[0]<=1?0:(t.kernelShape[a?1:2]-1)*(t.dilations[0]-1)},\n              ${t.dilations[1]<=1?0:(t.kernelShape[a?2:3]-1)*(t.dilations[1]-1)});\n        const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (${t.pads[0]+t.pads[2]})/2,\n                                         i32(effectiveFilterDims[1]) - 1 - (${t.pads[1]+t.pads[3]})/2);\n        const strides : vec2<i32> = vec2<i32>(${t.strides[0]}, ${t.strides[1]});\n        const dilation : vec2<i32> = vec2<i32>(${t.dilations[0]}, ${t.dilations[1]});\n        const dimAOuter : i32 = ${o};\n        const dimBOuter : i32 = ${n};\n        const dimInner : i32 = ${s};\n        ${K}\n        ${El(a,u,t,C)}\n        ${y?_r(I,S,"f32",void 0,!a,V):Cr(I,S,"f32",void 0,!a,V,!1,void 0,l)}`}}});var Ol,so,us=q(()=>{"use strict";At();$e();we();Ol=(e,t,r,o,n,s,u=!1,l)=>{let a=r.format==="NHWC",p=a?1:2,h=a?2:3,g=a?3:1,w=z.size(o),v=u?2:1,y=r.group,_=t[1].dims,A=_[0]/y,S=_[1],I=`\n  fn setOutputAtIndex(flatIndex : u32, value : ${u?`vec4<${l}>`:l}) {\n    result[flatIndex] = ${u?`vec4<${l}>`:l}(value);\n  }`;n&&(I+=`\n    fn getBiasByOutputCoords(coords : vec4<u32>) -> ${u?`vec4<${l}>`:l} {\n      return bias[coords.${a?"w":"y"}${u?"/ 4":""}];\n    }`);let P=u?4:1,C=M("W",t[1].dataType,t[1].dims,P),V=M("Dy",t[0].dataType,t[0].dims,P),D=[V,C];n&&D.push(M("bias",t[2].dataType,[o[g]],P));let G=j("result",t[0].dataType,o,P),T=`{\n        let batch: u32 = ${s?"global_id.z":"workgroup_id.z"} / outShape[1];\n        let r = ${s?"global_id.z":"workgroup_id.z"} % outShape[1];\n        let c = ${s?"global_id.y":"workgroup_id.y"} * ${v};\n        let d1: u32 = ${s?"global_id.x":"workgroup_id.x"} * 4;\n\n        let dyCorner = vec2<i32>(i32(r), i32(c)) - vec2<i32>(pads);\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd: array<vec4<${l}>, ${v}>;\n        for (var i = 0; i < ${v}; i++) {\n          dotProd[i] = vec4<${l}>(0.0);\n        }\n        for (var wR: u32 = 0; wR < filterDims[0]; wR = wR + 1) {\n          var dyR = (${l}(dyCorner.x) + ${l}(wR)) / ${l}(strides.x);\n          let wRPerm = filterDims[0] - 1 - wR;\n          if (dyR < 0.0 || dyR >= ${l}(outBackprop[1]) ||\n              fract(dyR) > 0.0 || wRPerm < 0) {\n            continue;\n          }\n          let idyR: u32 = u32(dyR);\n\n          for (var wC: u32 = 0; wC < filterDims[1]; wC = wC + 1) {\n            let dyC = (${l}(dyCorner.y) + ${l}(wC)) / ${l}(strides.y);\n            let dyC2 = (${l}(dyCorner.y) + 1.0 + ${l}(wC)) / ${l}(strides.y);\n            let wCPerm = filterDims[1] - 1 - wC;\n            if (wCPerm < 0) {\n              continue;\n            }\n            var bDyCVal = true;\n            var bDyCVal2 = true;\n            if (dyC < 0.0 || dyC >= ${l}(outBackprop[2]) ||\n                fract(dyC) > 0.0) {\n              bDyCVal = false;\n            }\n            if (dyC2 < 0.0 || dyC2 >= ${l}(outBackprop[2]) ||\n                fract(dyC2) > 0.0) {\n              bDyCVal2 = false;\n            }\n\n            let idyC: u32 = u32(dyC);\n            let idyC2: u32 = u32(dyC2);\n            if (bDyCVal && bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2 :u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${V.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${l}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n\n                xValue =  ${V.get("batch","idyR","idyC2","d2")};\n\n                dotProd[1] = dotProd[1] + vec4<${l}>(dot(xValue, wValue0),\n                                                    dot(xValue, wValue1),\n                                                    dot(xValue, wValue2),\n                                                    dot(xValue, wValue3));\n              }\n            } else if (bDyCVal) {\n              let d2Length = outBackprop[${g}];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${V.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${l}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n              }\n            } else if (bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${V.get("batch","idyR","idyC2","d2")};\n                let tmpval = vec4<${l}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[1] = dotProd[1] + tmpval;\n              }\n            }\n          }\n        }\n\n        for (var i: u32 = 0; i < ${v}; i = i + 1) {\n          let value = dotProd[i] + ${n?"bias[c+i]":`vec4<${l}>(0.0)`};\n          ${G.set("batch","r","c + i","d1","value")};\n        }\n      }`,W=`\n          let outputIndices = ${G.offsetToIndices("global_idx")};\n          let batch = ${G.indicesGet("outputIndices",0)};\n          let d1 = ${G.indicesGet("outputIndices",g)};\n          let r = ${G.indicesGet("outputIndices",p)};\n          let c = ${G.indicesGet("outputIndices",h)};\n          let dyCorner = vec2<i32>(i32(r), i32(c)) - pads;\n          let dyRCorner = dyCorner.x;\n          let dyCCorner = dyCorner.y;\n          let groupId = d1 / ${S};\n          let wOutChannel = d1 - groupId * ${S};\n          // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n          // ? = to be determined. : = across all values in that axis.\n          var dotProd = ${l}(0.0);\n          for (var wR: u32 = 0; wR < effectiveFilterDims.x; wR = wR + 1) {\n            if (wR % dilations.x != 0) {\n              continue;\n            }\n            let dyR = (${l}(dyRCorner) + ${l}(wR)) / ${l}(strides[0]);\n            let wRPerm = filterDims.x - 1 - wR / dilations.x;\n            if (dyR < 0.0 || dyR >= ${l}(outBackprop[${p}]) || fract(dyR) > 0.0 ||\n                wRPerm < 0) {\n              continue;\n            }\n            let idyR: u32 = u32(dyR);\n\n            for (var wC: u32 = 0; wC < effectiveFilterDims.y; wC = wC + 1) {\n              if (wC % dilations.y != 0) {\n                continue;\n              }\n              let dyC = (${l}(dyCCorner) + ${l}(wC)) / ${l}(strides.y);\n              let wCPerm = filterDims.y - 1 - wC / dilations.y;\n              if (dyC < 0.0 || dyC >= ${l}(outBackprop[${h}]) ||\n                  fract(dyC) > 0.0 || wCPerm < 0) {\n                continue;\n              }\n              let idyC: u32 = u32(dyC);\n              var inputChannel = groupId * ${A};\n              for (var d2: u32 = 0; d2 < ${A}; d2 = d2 + 1) {\n                let xValue = ${a?V.get("batch","idyR","idyC","inputChannel"):V.get("batch","inputChannel","idyR","idyC")};\n                let wValue = ${C.get("inputChannel","wOutChannel","u32(wRPerm)","u32(wCPerm)")};\n                dotProd = dotProd + xValue * wValue;\n                inputChannel = inputChannel + 1;\n              }\n            }\n          }\n          let value = dotProd + ${n?"bias[d1]":`${l}(0.0)`};\n          ${G.setByOffset("global_idx","value")};\n        `;return`\n  ${e.declareVariables(...D,G)}\n  ${I}\n  const outShape : vec4<u32> = vec4<u32>(${o.join(",")});\n  const outBackprop : vec4<u32> = vec4<u32>(${t[0].dims.join(",")});\n  const strides : vec2<u32> = vec2<u32>(${r.strides[0]}, ${r.strides[1]});\n  const filterDims : vec2<u32> = vec2<u32>(${r.kernelShape[a?1:2]}, ${r.kernelShape[a?2:3]});\n  const dilations : vec2<u32> = vec2<u32>(${r.dilations[0]}, ${r.dilations[1]});\n  const effectiveFilterDims : vec2<u32> = filterDims + vec2<u32>(\n          ${r.dilations[0]<=1?0:(r.kernelShape[a?1:2]-1)*(r.dilations[0]-1)},\n          ${r.dilations[1]<=1?0:(r.kernelShape[a?2:3]-1)*(r.dilations[1]-1)});\n  const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (${r.pads[0]+r.pads[2]})/2,\n                                     i32(effectiveFilterDims[1]) - 1 - (${r.pads[1]+r.pads[3]})/2);\n    ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(w)};\n  ${u?T:W}}`},so=(e,t,r)=>{let o=e.length>2,n=t.outputShape,s=z.size(n),u=[Math.ceil(s/64),1,1];Me("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${u}`);let l=He(e[0].dataType);return{name:"ConvTranspose2D",shaderCache:{hint:t.cacheKey},getRunData:()=>({dispatchGroup:{x:u[0],y:u[1],z:u[2]},outputs:[{dims:r?r(n):n,dataType:e[0].dataType}]}),getShaderSource:a=>Ol(a,e,t,n,o,u[1]===1&&u[2]===1,!1,l)}}});var Pl,Bl,kl,ds,ls,Rl,Dl,Ml,Ul,cs,ps=q(()=>{"use strict";Fe();ss();us();Tt();tr();Pl=(e,t,r,o,n,s)=>(e-1)*t+r+(o-1)*n+1-s,Bl=(e,t,r,o,n)=>{let s=Math.floor(e/2);t==="SAME_UPPER"?(r[o]=s,r[n]=e-s):t==="SAME_LOWER"&&(r[o]=e-s,r[n]=s)},kl=(e,t,r,o,n,s,u,l,a,p)=>{let h=e.length-2,g=p.length===0;if(a.length===0)for(let y=0;y<h;++y)a.push(0);let w=e[0],v=t[l?3:1]*n;for(let y=0,_=e.length-h-(l?1:0);y<h;++y,++_){let A=e[_],S=g?A*u[y]:p[y],I=Pl(A,u[y],s[y],t[_],r[y],S);Bl(I,o,s,y,y+h),g&&p.push(u[y]*(A-1)+a[y]+(t[_]-1)*r[y]+1-s[y]-s[y+h])}p.splice(0,0,w),p.splice(l?3:1,0,v)},ds=(e,t)=>{let r=e.kernelShape.slice();if(e.kernelShape.length===0||e.kernelShape.reduce((w,v)=>w*v,1)===0){r.length=0;for(let w=2;w<t[1].dims.length;++w)r.push(t[1].dims[w])}let o=e.format==="NHWC";r.splice(0,0,t[1].dims[0]),r.splice(o?3:1,0,t[1].dims[1]);let n=e.pads.slice(),s=e.outputShape.slice(),u=e.outputPadding.slice(),l=t[0].dims,a=e.dilations.slice();if(a.reduce((w,v)=>w+v,0)===0){let w=t[0].dims.length-2;a=new Array(w).fill(1)}let p=e.strides.slice();if(p.reduce((w,v)=>w+v,0)===0){let w=t[0].dims.length-2;p=new Array(w).fill(1)}kl(l,r,a,e.autoPad,e.group,n,p,o,u,s);let h=Object.assign({},e),g=e.cacheKey+[r.join("n,"),n.join(","),p.join(","),u.join(","),s.join(","),a.join(",")].join("_");return Object.assign(h,{kernelShape:r,pads:n,outputPadding:u,outputShape:s,dilations:a,strides:p,cacheKey:g}),h},ls=e=>{let t=sn(e),r=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],n=e.dilations,s=e.group,u=e.kernelShape,l=e.pads,a=e.strides,p=e.wIsConst(),h=e.outputPadding,g=e.outputShape;return ge({autoPad:o,format:r,dilations:n,group:s,kernelShape:u,outputPadding:h,outputShape:g,pads:l,strides:a,wIsConst:p,...t})},Rl=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[0];if(r!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let n=e[1].dims[1]*t.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==n))throw new Error("invalid bias");let s=e[0].dims.length-2;if(t.dilations.reduce((h,g)=>h+g,0)>0&&t.dilations.length!==s)throw new Error(`dilations should be ${s}D`);if(t.strides.reduce((h,g)=>h+g,0)>0&&t.strides.length!==s)throw new Error(`strides should be ${s}D`);if(t.pads.reduce((h,g)=>h+g,0)>0&&t.pads.length!==s*2)throw new Error(`pads should be ${s*2}D`);if(t.outputPadding.length!==s&&t.outputPadding.length!==0)throw new Error(`output_padding should be ${s}D`);if(t.kernelShape.reduce((h,g)=>h+g,0)>0&&t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(t.outputShape.length!==0&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},Dl=[2,3,1,0],Ml=(e,t,r)=>{let o=ds(r,t),n=r.format==="NHWC",s=o.outputShape,u=s[n?3:1],l=t[0].dims[n?3:1];if(o.group!==1||u===1&&l===1){e.compute(so(t,o));return}let a=s[n?1:2],p=s[n?2:3],h=t[1].dims[2],g=t[1].dims[3],w=n?a*p:u,v=n?u:a*p,y=h*g*l,_=!0,A=e.kernelCustomData.wT??e.compute(st(t[1],Dl),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=A);let S=[t[0],A],I=t.length===3;I&&(!n&&t[2].dims.length===1?S.push(t[2].reshape([t[2].dims[0],1,1])):S.push(t[2])),e.compute(is(S,o,s,w,v,y,I,_),{inputs:S})},Ul=(e,t)=>{let r=t.format==="NHWC",o=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];o.length===3&&o.push(e.inputs[2]);let n=t.kernelShape;(n.length===0||n[0]===0)&&(n=[e.inputs[1].dims[2]]);let s=t.dilations;(s.length===0||s[0]===0)&&(s=[1]);let u=t.strides;(u.length===0||u[0]===0)&&(u=[1]);let l=t.pads;l.length===0&&(l=[0,0]),l=[0,l[0],0,l[1]],u=[1].concat(u),s=[1].concat(s),n=[1].concat(n);let a=ds({...t,pads:l,strides:u,dilations:s,kernelShape:n},o);e.compute(so(o,a,p=>r?[p[0],p[2],p[3]]:[p[0],p[1],p[3]]))},cs=(e,t)=>{Rl(e.inputs,t),e.inputs[0].dims.length===3?Ul(e,t):Ml(e,e.inputs,t)}});var zl,ms,fs,hs=q(()=>{"use strict";Ve();$e();Fe();we();zl=(e,t,r,o)=>{let n=z.size(t),s=t.length,u=M("input",e,s),l=j("output",e,s),a=r.dataType===6?r.getInt32Array()[0]:Number(r.getBigInt64Array()[0]),p=z.normalizeAxis(a,s),h=g=>{let w=` i32(${u.indicesGet("inputIndices","uniforms.axis")}) `,v=le("uniforms.input_shape","uniforms.axis",s),y=o.reverse?w+(o.exclusive?" + 1":""):"0",_=o.reverse?v:w+(o.exclusive?"":" + 1");return`\n                ${g.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(u,l)}\n                ${g.mainStart()}\n                  ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n                  var inputIndices = ${l.offsetToIndices("global_idx")};\n                  var sum = ${l.type.value}(0);\n                  let first : i32 = ${y};\n                  let last : i32 = ${_};\n                  for (var i : i32 = first; i < last; i++) {\n                    ${u.indicesSet("inputIndices","uniforms.axis","u32(i)")};\n                    sum = sum + ${u.getByIndices("inputIndices")};\n                  }\n                  ${l.setByOffset("global_idx","sum")};\n                }`};return{name:"CumSum",shaderCache:{hint:o.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(n/64)},programUniforms:[{type:"uint32",data:n},{type:"int32",data:p},...F(t),...F(t)]}),getShaderSource:h}},ms=(e,t)=>{let r=e.inputs[0].dims,o=e.inputs[0].dataType,n=e.inputs[1];e.compute(zl(o,r,n,t),{inputs:[0]})},fs=e=>{let t=e.exclusive===1,r=e.reverse===1;return ge({exclusive:t,reverse:r})}});var uo,pn,gs,Vl,Nl,lo,co,ys,Wl,bs,ws,vs=q(()=>{"use strict";$e();Fe();we();uo="[a-zA-Z]|\\\\.\\\\.\\\\.",pn="("+uo+")+",gs="^"+pn+"$",Vl="("+pn+",)*"+pn,Nl="^"+Vl+"$",lo=class{constructor(t=-1){this.symbolToIndices=new Map,this.inputIndex=t}addSymbol(t,r){let o=this.symbolToIndices.get(t);o===void 0?o=[r]:o.push(r),this.symbolToIndices.set(t,o)}},co=class{constructor(t,r){this.equation=r;this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[o,n]=r.includes("->")?r.split("->",2):[r,""];if(!o.match(RegExp(Nl)))throw new Error("Invalid LHS term");if(o.split(",").forEach((l,a)=>{let p=t[a].dims.slice();if(!l.match(RegExp(gs)))throw new Error("Invalid LHS term");let h=this.processTerm(l,!0,p,a);this.lhs.push(h)}),n==="")n+=[...this.symbolToInfo.entries()].filter(([l,a])=>a.count===1||l==="...").map(([l])=>l).join("");else if(!n.match(RegExp(pn)))throw new Error("Invalid RHS");n.match(RegExp(uo,"g"))?.forEach(l=>{if(l==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let a=this.symbolToInfo.get(l);if(a===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(a.dimValue)}}),this.rhs=this.processTerm(n,!1,this.outputDims)}addSymbol(t,r,o){let n=this.symbolToInfo.get(t);if(n!==void 0){if(n.dimValue!==r&&n.count!==1)throw new Error("Dimension mismatch");n.count++,n.inputIndices.push(o)}else n={count:1,dimValue:r,inputIndices:[o]};this.symbolToInfo.set(t,n)}processTerm(t,r,o,n=-1){let s=o.length,u=!1,l=[],a=0;if(!t.match(RegExp(gs))&&!r&&t!=="")throw new Error("Invalid LHS term");let p=t.match(RegExp(uo,"g")),h=new lo(n);return p?.forEach((g,w)=>{if(g==="..."){if(u)throw new Error("Only one ellipsis is allowed per input term");u=!0;let v=s-p.length+1;if(v<0)throw new Error("Ellipsis out of bounds");if(l=o.slice(a,a+v),this.hasEllipsis){if(this.ellipsisDims.length!==l.length||this.ellipsisDims.toString()!==l.toString())throw new Error("Ellipsis dimensions mismatch")}else if(r)this.hasEllipsis=!0,this.ellipsisDims=l;else throw new Error("Ellipsis must be specified in the LHS");for(let y=0;y<l.length;y++){let _=String.fromCharCode("0".charCodeAt(0)+y);h.addSymbol(_,w+y),this.addSymbol(_,o[a++],n)}}else h.addSymbol(g,w+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(g,o[a++],n)}),h}},ys=e=>e+"_max",Wl=(e,t,r,o,n)=>{let u=t.map((v,y)=>e[y]?v.length:v).map((v,y)=>M(`input${y}`,r,v)),l=z.size(n),a=Re(n.length),p=a?n.length:n,h=j("output",r,p),g=[...o.symbolToInfo.keys()].filter(v=>!o.rhs.symbolToIndices.has(v)),w=v=>{let y=[],_="var prod = 1.0;",A="var sum = 0.0;",S="sum += prod;",I=[],P=[],C=[],V=[],D=o.symbolToInfo.size===o.rhs.symbolToIndices.size;o.symbolToInfo.forEach((T,W)=>{if(o.rhs.symbolToIndices.has(W)){let pe=o.rhs.symbolToIndices.get(W)?.[0];pe!==void 0&&o.lhs.forEach((Z,K)=>{if(T.inputIndices.includes(K)){let X=Z.symbolToIndices.get(W);if(X===void 0)throw new Error("Invalid symbol error");X.forEach(J=>{y.push(`${u[K].indicesSet(`input${K}Indices`,J,h.indicesGet("outputIndices",pe))}`)})}})}else o.lhs.forEach((pe,Z)=>{if(T.inputIndices.includes(Z)){let K=pe.symbolToIndices.get(W);if(K===void 0)throw new Error("Invalid symbol error");K.forEach(X=>{I.push(`${u[Z].indicesSet(`input${Z}Indices`,X,`${W}`)}`)}),V.push(`prod *= ${u[Z].getByIndices(`input${Z}Indices`)};`)}}),P.push(`for(var ${W}: u32 = 0; ${W} < uniforms.${ys(W)}; ${W}++) {`),C.push("}")});let G=D?[...y,`let sum = ${u.map((T,W)=>T.getByIndices(`input${W}Indices`)).join(" * ")};`]:[...y,A,...P,...I,_,...V,S,...C];return`\n            ${v.registerUniforms(g.map(T=>({name:`${ys(T)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...u,h)}\n\n            ${v.mainStart()}\n            ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n            var outputIndices = ${h.offsetToIndices("global_idx")};\n            ${u.map((T,W)=>`var input${W}Indices: ${u[W].type.indices};`).join(`\n`)}\n            ${G.join(`\n`)};\n            ${h.setByOffset("global_idx","sum")};\n          }`};return{name:"Einsum",shaderCache:{hint:o.equation,inputDependencies:e.map(v=>v?"rank":"dims")},getRunData:()=>{let v=g.filter(_=>o.symbolToInfo.has(_)).map(_=>({type:"uint32",data:o.symbolToInfo.get(_)?.dimValue||0}));v.push({type:"uint32",data:l});let y=t.filter((_,A)=>e[A]).map((_,A)=>[...F(_)]).reduce((_,A)=>_.concat(A),v);return a&&y.push(...F(n)),{outputs:[{dims:n,dataType:r}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:y}},getShaderSource:w}},bs=(e,t)=>{let r=new co(e.inputs,t.equation),o=e.inputs.map((u,l)=>Re(u.dims.length)),n=r.outputDims,s=e.inputs.map((u,l)=>u.dims);e.compute(Wl(o,s,e.inputs[0].dataType,r,n))},ws=e=>{let t=e.equation.replace(/\\s+/g,"");return ge({equation:t})}});var Gl,$s,Hl,Ll,Ss,xs=q(()=>{"use strict";Ve();$e();we();Gl=e=>{if(!e||e.length!==2)throw new Error("Expand requires 2 input.");let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),o=r.length<t.length?0:r.length-t.length,n=t.length<r.length?0:t.length-r.length;for(;o<r.length&&n<t.length;++o,++n)if(r[o]!==t[n]&&r[o]!==1&&t[n]!==1)throw new Error("Expand requires shape to be broadcastable to input")},$s=(e,t)=>{let r=e.length-t.length,o=[];for(let n=0;n<r;++n)o.push(e[n]);for(let n=0;n<t.length;++n)o.push(t[n]===1?e[n+r]:t[n]);return o},Hl=(e,t)=>e.length>t.length?$s(e,t):$s(t,e),Ll=e=>{let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),o=Hl(t,r),n=e[0].dataType,s=n===9?4:1,u=Math.ceil(z.size(o)/s),l=Re(t.length),a=Re(o.length),p=g=>{let w=l?t.length:t,v=a?o.length:o,y=M("input",n,w,s),_=j("output",n,v,s),A;if(n===9){let S=(I,P,C="")=>`\n          let outputIndices${P} = ${_.offsetToIndices(`outputOffset + ${P}u`)};\n          let offset${P} = ${y.broadcastedIndicesToOffset(`outputIndices${P}`,_)};\n          let index${P} = offset${P} / 4u;\n          let component${P} = offset${P} % 4u;\n          ${I}[${P}] = ${C}(${y.getByOffset(`index${P}`)}[component${P}]);\n        `;A=`\n        let outputOffset = global_idx * ${s};\n        var data = vec4<u32>(0);\n        ${S("data",0,"u32")}\n        ${S("data",1,"u32")}\n        ${S("data",2,"u32")}\n        ${S("data",3,"u32")}\n        ${_.setByOffset("global_idx","data")}\n      }`}else A=`\n        let outputIndices = ${_.offsetToIndices("global_idx")};\n        let inputOffset = ${y.broadcastedIndicesToOffset("outputIndices",_)};\n        ${_.setByOffset("global_idx",y.getByOffset("inputOffset"))}\n      }`;return`\n    ${g.registerUniform("vec_size","u32").declareVariables(y,_)}\n    ${g.mainStart()}\n    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n    ${A}`},h=[{type:"uint32",data:u}];return l&&h.push(...F(t)),a&&h.push(...F(o)),{name:"Expand",shaderCache:{hint:`${o.length}`,inputDependencies:[l?"rank":"dims"]},getShaderSource:p,getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:h})}},Ss=e=>{Gl(e.inputs),e.compute(Ll(e.inputs),{inputs:[0]})}});var Fl,jl,_s,Cs,Is=q(()=>{"use strict";Ve();$e();Fe();we();Fl=e=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.")},jl=(e,t)=>{let r=e[0].dims,o=e[1].dims,n=r.length,s=z.normalizeAxis(t.axis,n),u=r.slice(0);u.splice(s,1,...o);let l=r[s],a=e[0].dataType===9?4:1,p=Math.ceil(z.size(u)/a),h=Re(e[0].dims.length),g=h?e[0].dims.length:e[0].dims,w=Re(e[1].dims.length),v=w?e[1].dims.length:e[1].dims,y=Re(u.length),_=y?u.length:u,A=[{type:"uint32",data:p},{type:"int32",data:l},{type:"uint32",data:s}];h&&A.push(...F(e[0].dims)),w&&A.push(...F(e[1].dims)),y&&A.push(...F(u));let S=[];S.push(h?"rank":"dims"),S.push(w?"rank":"dims");let I=P=>{let C=M("data",e[0].dataType,g,a),V=M("inputIndices",e[1].dataType,v),D=j("output",e[0].dataType,_,a),G=W=>{let pe=o.length,Z=`var indicesIndices${W}  = ${V.type.indices}(0);`;for(let K=0;K<pe;K++)Z+=`${pe>1?`indicesIndices${W}[${K}]`:`indicesIndices${W}`} = ${u.length>1?`outputIndices${W}[uniforms.axis + ${K}]`:`outputIndices${W}`};`;Z+=`\n          var idx${W} = ${V.getByIndices(`indicesIndices${W}`)};\n          if (idx${W} < 0) {\n            idx${W} = idx${W} + uniforms.axisDimLimit;\n          }\n          var dataIndices${W} = ${C.type.indices}(0);\n        `;for(let K=0,X=0;K<n;K++)K===s?(Z+=`${n>1?`dataIndices${W}[${K}]`:`dataIndices${W}`} = u32(idx${W});`,X+=pe):(Z+=`${n>1?`dataIndices${W}[${K}]`:`dataIndices${W}`} = ${u.length>1?`outputIndices${W}[${X}]`:`outputIndices${W}`};`,X++);return Z},T;if(e[0].dataType===9){let W=(pe,Z,K="")=>`\n          let outputIndices${Z} = ${D.offsetToIndices(`outputOffset + ${Z}u`)};\n          ${G(Z)};\n          let offset${Z} = ${C.indicesToOffset(`dataIndices${Z}`)};\n          let index${Z} = offset${Z} / 4u;\n          let component${Z} = offset${Z} % 4u;\n          ${pe}[${Z}] = ${K}(${C.getByOffset(`index${Z}`)}[component${Z}]);\n        `;T=`\n        let outputOffset = global_idx * ${a};\n        var value = vec4<u32>(0);\n        ${W("value",0,"u32")}\n        ${W("value",1,"u32")}\n        ${W("value",2,"u32")}\n        ${W("value",3,"u32")}\n        ${D.setByOffset("global_idx","value")}\n      `}else T=`\n      let outputIndices = ${D.offsetToIndices("global_idx")};\n      ${G("")};\n      let value = ${C.getByIndices("dataIndices")};\n      ${D.setByOffset("global_idx","value")};\n      `;return`\n      ${P.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(C,V,D)}\n      ${P.mainStart()}\n        ${P.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        ${T}\n      }`};return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:S},getRunData:()=>({outputs:[{dims:u,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:A}),getShaderSource:I}},_s=e=>ge({axis:e.axis}),Cs=(e,t)=>{let r=e.inputs;Fl(r),e.compute(jl(e.inputs,t))}});var ql,Kl,As,Ts,Es=q(()=>{"use strict";$e();Fe();we();ql=e=>{if(!e||e.length!==2)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error(`GatherElements requires that the data input and\n                     indices input tensors be of same rank.`)},Kl=(e,t)=>{let r=e[0].dims,o=e[0].dataType,n=r.length,s=e[1].dims,u=e[1].dataType,l=z.normalizeAxis(t.axis,n),a=r[l],p=s.slice(0),h=z.size(p),g=M("input",o,n),w=M("indicesInput",u,s.length),v=j("output",o,p.length),y=[{type:"uint32",data:h},{type:"int32",data:a},{type:"uint32",data:l}];return y.push(...F(r)),y.push(...F(s)),y.push(...F(p)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:p,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:y}),getShaderSource:S=>`\n      ${S.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(g,w,v)}\n      ${S.mainStart()}\n      ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n      let outputIndices = ${v.offsetToIndices("global_idx")};\n\n      var idx = ${w.getByOffset("global_idx")};\n      if (idx < 0) {\n        idx = idx + uniforms.axisDimLimit;\n      }\n      var inputIndices = ${g.type.indices}(outputIndices);\n      ${g.indicesSet("inputIndices","uniforms.axis","u32(idx)")};\n      let value = ${g.getByIndices("inputIndices")};\n\n      ${v.setByOffset("global_idx","value")};\n  }`}},As=e=>ge({axis:e.axis}),Ts=(e,t)=>{let r=e.inputs;ql(r),e.compute(Kl(e.inputs,t))}});var Yl,Zl,Os,Ps,Bs=q(()=>{"use strict";$e();we();Yl=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(e.length===3&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},Zl=(e,t)=>{let r=e[0].dims.slice(),o=e[1].dims.slice(),[n,s,u]=Jr.getShapeOfGemmResult(r,t.transA,o,t.transB,e.length===3?e[2].dims:void 0),l=[n,s];if(!l)throw new Error("Can\'t use gemm on the given tensors");let a=z.size(l),p=[{type:"uint32",data:a},{type:"uint32",data:n},{type:"uint32",data:s},{type:"uint32",data:u},{type:"float32",data:t.alpha},{type:"float32",data:t.beta}],h=["type","type"];e.length===3&&(p.push(...F(e[2].dims)),h.push("rank")),p.push(...F(l));let g=w=>{let v="";t.transA&&t.transB?v="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?v="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?v="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!t.transA&&!t.transB&&(v="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let y=t.alpha===1?"":"value *= uniforms.alpha;",_=M("a",e[0].dataType,e[0].dims),A=M("b",e[1].dataType,e[1].dims),S=_.type.value,I=null,P=[_,A];e.length===3&&(I=M("c",e[2].dataType,e[2].dims.length),P.push(I));let C=j("output",e[0].dataType,l.length);P.push(C);let V=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`\n  ${w.registerUniforms(V).declareVariables(...P)}\n\n  ${w.mainStart()}\n    ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let m = global_idx / uniforms.N;\n    let n = global_idx % uniforms.N;\n\n    var value = ${S}(0);\n    for (var k: u32 = 0u; k < uniforms.K; k++) {\n      ${v}\n    }\n\n    ${y}\n    ${(()=>I!=null?`let cOffset = ${I.broadcastedIndicesToOffset("vec2(m, n)",C)}; value += ${S}(uniforms.beta) * ${I.getByOffset("cOffset")};`:"")()}\n    output[global_idx] = value;\n  }`};return{name:"Gemm",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:l,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:p}),getShaderSource:g}},Os=e=>{let t=e.transA,r=e.transB,o=e.alpha,n=e.beta;return{transA:t,transB:r,alpha:o,beta:n,cacheKey:`${e.transA};${e.transB};${e.alpha===1}`}},Ps=(e,t)=>{Yl(e.inputs),e.compute(Zl(e.inputs,t))}});var Jl,Ql,Xl,ks,Rs=q(()=>{"use strict";Ve();$e();we();Jl=(e,t)=>{let r=e[0].dims,o=r,n=2,s=z.sizeToDimension(r,n),u=z.sizeFromDimension(r,n),l=Le(u),a=u/l,p=[r[0],r[1],a],h=["rank","type","type"],g=[{type:"uint32",data:u},{type:"uint32",data:a}];g.push(...F(p),...F(p));let w=v=>{let y=M("x",e[0].dataType,p.length,l),_=M("scale",e[1].dataType,e[1].dims),A=M("bias",e[2].dataType,e[2].dims),S=j("output",e[0].dataType,p.length,l),I=[y,_,A,S],P=y.type.value,C=l===1?"f32":`vec${l}<f32>`,V=64,D=[{name:"normSize",type:"u32"},{name:"normPackedSize",type:"u32"}];return`\n  var<workgroup> meanShared : f32;\n  var<workgroup> squaredNormShared : f32;\n  var<workgroup> workgroupShared : array<${C}, ${V}>;\n  const workgroupSize = ${V}u;\n  ${v.registerUniforms(D).declareVariables(...I)}\n  ${v.mainStart(V)}\n    let norm = global_idx / workgroupSize;\n    let batch = norm / uniforms.x_shape[1];\n    let channel = norm % uniforms.x_shape[1];\n    let localIndex = local_id.x;\n\n    // initialize workgroup memory\n    var initial = ${C}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      initial = initial + ${C}(${y.get("batch","channel","h")});\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the mean of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      meanShared = ${tt("workgroupShared[0]",l)} / f32(uniforms.normSize);\n    }\n    workgroupBarrier();\n\n    // reinitialize workgroup memory.\n    initial = ${C}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let deviation =  ${C}(${y.get("batch","channel","h")}) - ${C}(meanShared);\n      initial = initial + deviation * deviation;\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the sum of square of deviation of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      squaredNormShared = ${tt("workgroupShared[0]",l)};\n    }\n    workgroupBarrier();\n\n    let invStdDev = inverseSqrt(squaredNormShared / f32(uniforms.normSize) + f32(${t.epsilon}));\n    let channelScale = invStdDev * f32(${_.getByOffset("channel")});\n    let channelShift = f32(${A.getByOffset("channel")}) - meanShared * channelScale;\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let value = ${y.get("batch","channel","h")} * ${P}(${C}(channelScale)) + ${P}(${C}(channelShift));\n      ${S.set("batch","channel","h","value")};\n    }\n  }`};return{name:"InstanceNormalization",shaderCache:{hint:`${t.epsilon};${l}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:s},programUniforms:g}),getShaderSource:w}},Ql=(e,t,r,o,n,s,u,l)=>{let a=Le(u),p=64,h=a===1?"vec2f":`mat2x${a}f`,g=a===1?"f32":`vec${a}f`,w=(D,G)=>`${h}(${D}, ${G})`,v=n*u/a,y=Math.ceil(s/p),_=["type"],A=[{type:"uint32",data:y},{type:"uint32",data:s},{type:"uint32",data:Math.floor(u/a)},{type:"uint32",data:Math.floor(s*u/a)}],S=D=>{let G=M("input",t.dataType,t.dims,a);return`\n  ${D.declareVariables(G)}\n  @group(0) @binding(1) var<storage, read_write> output : array<${h}>;\n  struct Uniforms {wg_size:u32, H:u32, C:u32, image_size:u32};\n  @group(0) @binding(2) var<uniform> uniforms: Uniforms;\n\n  ${D.mainStart(p)}\n    let currentImageNumber = global_idx / ${p} / uniforms.C;\n    let currentChannelNumber = (global_idx / ${p}) % uniforms.C;\n    let wgId = global_idx % ${p};\n    let wgOffset = wgId * uniforms.wg_size;\n    if (wgOffset >= uniforms.H) {\n        return;\n    }\n    let wgMax = min(wgOffset + uniforms.wg_size, uniforms.H);\n\n    let offset = currentImageNumber * uniforms.image_size + currentChannelNumber;\n    var sum = ${Ze("f32",a)};\n    var squaredSum = ${Ze("f32",a)};\n    for (var i: u32 = wgOffset; i < wgMax; i++) {\n        let value = ${g}(input[offset + i * uniforms.C]);\n        sum += value;\n        squaredSum += value * value;\n    }\n    output[global_idx] = ${w("sum","squaredSum")};\n  }`},I=e.compute({name:"InstanceNormComputeMean",shaderCache:{hint:`${a}`,inputDependencies:_},getRunData:()=>({outputs:[{dims:[n,u,p,2],dataType:1}],dispatchGroup:{x:n*u/a},programUniforms:A}),getShaderSource:S},{inputs:[t],outputs:[-1]})[0],P=[{type:"uint32",data:v},{type:"uint32",data:s},{type:"uint32",data:Math.floor(u/a)},{type:"uint32",data:Math.floor(p*u/a)}],C=["type","type","type"],V=D=>{let G=M("scale",r.dataType,r.dims,a),T=M("bias",o.dataType,o.dims,a);return`\n  @group(0) @binding(0) var<storage, read> input : array<${h}>;\n  @group(0) @binding(1) var<storage, read> scale : array<${G.type.storage}>;\n  @group(0) @binding(2) var<storage, read> bias : array<${T.type.storage}>;\n  @group(0) @binding(3) var<storage, read_write> output : array<${h}>;\n  struct Uniforms {units_of_work : u32, H: u32, C : u32, image_size : u32};\n  @group(0) @binding(4) var<uniform> uniforms: Uniforms;\n\n  ${D.mainStart()}\n    ${D.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.units_of_work")}\n    let currentImageNumber = global_idx / uniforms.C;\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let offset = currentImageNumber * uniforms.image_size;\n    var sum = ${Ze("f32",a)};\n    var squaredSum = ${Ze("f32",a)};\n    for (var i: u32 = 0; i < ${p}; i++) {\n        let value = input[offset + i + currentChannelNumber * ${p}];\n        sum += value[0];\n        squaredSum += value[1];\n    }\n    sum = sum / f32(uniforms.H);\n    squaredSum = squaredSum / f32(uniforms.H);\n    let invStdDev = inverseSqrt(squaredSum - sum * sum + f32(${l}));\n    let channelScale = invStdDev * ${g}(scale[currentChannelNumber]);\n    let channelShift = ${g}(bias[currentChannelNumber]) - sum * channelScale;\n\n    output[global_idx] = ${w("channelScale","channelShift")};\n  }`};return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${a};${l}`,inputDependencies:C},getRunData:()=>({outputs:[{dims:[n,u,2],dataType:1}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:P}),getShaderSource:V},{inputs:[I,r,o],outputs:[-1]})[0]},Xl=(e,t,r)=>{let o=t[0].dims,n=o,s=o[0],u=o[o.length-1],l=z.sizeFromDimension(o,1)/u,a=Le(u),p=z.size(n)/a,h=[{type:"uint32",data:l},{type:"uint32",data:Math.floor(u/a)}],g=["type","type"],w=Ql(e,t[0],t[1],t[2],s,l,u,r.epsilon),v=y=>{let _=He(t[0].dataType),A=a===1?"vec2f":`mat2x${a}f`,S=a===1?_:`vec${a}<${_}>`,I=M("input",t[0].dataType,t[0].dims,a),P=j("output",t[0].dataType,n,a);return`\n  @group(0) @binding(0) var<storage, read> input : array<${I.type.storage}>;\n  @group(0) @binding(1) var<storage, read> scaleInput : array<${A}>;\n  @group(0) @binding(2) var<storage, read_write> output : array<${P.type.storage}>;\n  struct Uniforms {H: u32, C : u32};\n  @group(0) @binding(3) var<uniform> uniforms: Uniforms;\n\n  ${y.mainStart()}\n    let currentImageNumber = global_idx / (uniforms.C * uniforms.H);\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let scaleOffset = currentImageNumber * uniforms.C + currentChannelNumber;\n    let scale = scaleInput[scaleOffset];\n    output[global_idx] = fma(input[global_idx], ${S}(scale[0]), ${S}(scale[1]));\n  }`};e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${a}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:n,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:h}),getShaderSource:v},{inputs:[t[0],w]})},ks=(e,t)=>{t.format==="NHWC"?Xl(e,e.inputs,t):e.compute(Jl(e.inputs,t))}});var ec,tc,Ds,Ms=q(()=>{"use strict";Ve();$e();we();ec=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},tc=(e,t,r)=>{let o=e[0].dims,n=e[1],s=e[2],u=o,l=z.normalizeAxis(t.axis,o.length),a=z.sizeToDimension(o,l),p=z.sizeFromDimension(o,l),h=z.size(n.dims),g=s?z.size(s.dims):0;if(h!==p||s&&g!==p)throw new Error(`Size of X.shape()[axis:] == ${p}.\n       Size of scale and bias (if provided) must match this.\n       Got scale size of ${h} and bias size of ${g}`);let w=[];for(let C=0;C<o.length;++C)C<l?w.push(o[C]):w.push(1);let v=Le(p),y=["type","type"],_=[{type:"uint32",data:a},{type:"float32",data:p},{type:"uint32",data:Math.floor(p/v)},{type:"float32",data:t.epsilon}];s&&y.push("type");let A=r>1,S=r>2,I=C=>{let V=He(e[0].dataType),D=[M("x",e[0].dataType,e[0].dims,v),M("scale",n.dataType,n.dims,v)];s&&D.push(M("bias",s.dataType,s.dims,v)),D.push(j("output",e[0].dataType,u,v)),A&&D.push(j("mean_data_output",1,w)),S&&D.push(j("inv_std_output",1,w));let G=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`\n  ${C.registerUniforms(G).declareVariables(...D)}\n  ${C.mainStart()}\n    ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}\n    let offset = global_idx * uniforms.norm_size_vectorized;\n    var meanVector = ${Ze("f32",v)};\n    var meanSquareVector = ${Ze("f32",v)};\n\n    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {\n      let value = ${it(V,v,"x[h + offset]")};\n      meanVector += value;\n      meanSquareVector += value * value;\n    }\n    let mean = ${tt("meanVector",v)} / uniforms.norm_size;\n    let invStdDev =\n        inverseSqrt(${tt("meanSquareVector",v)} / uniforms.norm_size - mean * mean + uniforms.epsilon);\n\n    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {\n      let f32input = ${it(V,v,"x[j + offset]")};\n      let f32scale = ${it(V,v,"scale[j]")};\n      output[j + offset] = ${D[0].type.value}((f32input - mean) * invStdDev * f32scale\n        ${s?`+ ${it(V,v,"bias[j]")}`:""}\n      );\n    }\n\n    ${A?"mean_data_output[global_idx] = mean":""};\n    ${S?"inv_std_output[global_idx] = invStdDev":""};\n  }`},P=[{dims:u,dataType:e[0].dataType}];return A&&P.push({dims:w,dataType:1}),S&&P.push({dims:w,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${v};${r}`,inputDependencies:y},getRunData:()=>({outputs:P,dispatchGroup:{x:Math.ceil(a/64)},programUniforms:_}),getShaderSource:I}},Ds=(e,t)=>{ec(e.inputs),e.compute(tc(e.inputs,t,e.outputCount))}});var rc,zs,Us,nc,po,Vs,Ns=q(()=>{"use strict";$e();Fe();Yr();Jn();we();tr();rc=(e,t)=>{let r=e[0],o=e[1],n=e[2],s=e[3],u=e[4],l=e[5],a=e[6],p=e[7];if(r.dims.length!==3&&r.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let h=!1,g=r.dims[0],w=r.dims[1],v=r.dims.length===3?h?r.dims[2]/3:r.dims[2]:t.numHeads*r.dims[4],y=w,_=0,A=0,S=Math.floor(v/t.numHeads);if(a&&p){if(a.dims.length!==4)throw new Error(\'Input "past_key" is expected to have 4 dimensions\');if(p.dims.length!==4)throw new Error(\'Input "past_value" is expected to have 4 dimensions\');_=a.dims[2],A=a.dims[2]}else if(a||p)throw new Error(\'Input "past_key" and "past_value" shall be both present or both absent\');let I;if(o){if(r.dims.length!==3)throw new Error(\'Input "query" is expected to have 3 dimensions when key is given\');if(o.dims.length<3||o.dims.length>5)throw new Error(\'Input "key" is expected to have 3, 4, or 5 dimensions\');if(r.dims[0]!==o.dims[0])throw new Error(\'Input "query" and "key" shall have same dim 0 (batch size)\');if(o.dims.length===3){if(o.dims[2]!==r.dims[2])throw new Error(\'Input "query" and "key" shall have same dim 2 (hidden_size)\');I=2,y=o.dims[1]}else if(o.dims.length===5){if(o.dims[2]!==t.numHeads||o.dims[3]!==2||o.dims[4]!==S)throw new Error(\'Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv\');if(n)throw new Error(\'Expect "value" be none when "key" has packed kv format.\');I=5,y=o.dims[1]}else{if(o.dims[1]!==t.numHeads||o.dims[3]!==S)throw new Error(\'Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key\');I=0,y=o.dims[2]}}else{if(r.dims.length!==3&&r.dims.length!==5)throw new Error(\'Input "query" is expected to have 3 or 5 dimensions when key is empty\');if(r.dims.length===5&&(r.dims[2]!==t.numHeads||r.dims[3]!==3))throw new Error(\'Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv\');I=3}if(s){if(s.dims.length!==1)throw new Error(\'Input "bias" is expected to have 1 dimension\');if(n&&r.dims.length===5&&r.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let P=0;if(u){P=8;let T=u.dims;throw T.length===1?T[0]===g?P=1:T[0]===3*g+2&&(P=3):T.length===2&&T[0]===g&&T[1]===y&&(P=5),P===8?new Error(\'Input "key_padding_mask" shape shall be (batch_size) or (batch_size, kv_sequence_length)\'):new Error("Mask not supported")}let C=!1,V=v;if(n){if(n.dims.length!==3&&n.dims.length!==4)throw new Error(\'Input "value" is expected to have 3 or 4 dimensions\');if(r.dims[0]!==n.dims[0])throw new Error(\'Input "query" and "value" shall have same dim 0 (batch_size)\');if(n.dims.length===3){if(y!==n.dims[1])throw new Error(\'Input "key" and "value" shall have the same dim 1 (kv_sequence_length)\');V=n.dims[2]}else{if(y!==n.dims[2])throw new Error(\'Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)\');V=n.dims[1]*n.dims[3],C=!0}}let D=_+y,G=!1;if(u)throw new Error("Key padding mask is not supported");if(l)throw new Error("extraAddQk is not supported");if(a)throw new Error("pastKey is not supported");if(p)throw new Error("pastValue is not supported");return{batchSize:g,sequenceLength:w,pastSequenceLength:_,kvSequenceLength:y,totalSequenceLength:D,maxSequenceLength:A,inputHiddenSize:0,hiddenSize:v,vHiddenSize:V,headSize:S,vHeadSize:Math.floor(V/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:P,scale:t.scale,broadcastResPosBias:G,passPastInKv:C,qkvFormat:I}},zs=e=>ge({...e}),Us=ge({perm:[0,2,1,3]}),nc=(e,t,r,o,n,s,u)=>{let l=[o,n,s],a=z.size(l),p=[{type:"uint32",data:a},{type:"uint32",data:u},{type:"uint32",data:s}],h=g=>{let w=j("qkv_with_bias",t.dataType,l),v=M("qkv",t.dataType,l),y=M("bias",r.dataType,l),_=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`\n  ${g.registerUniforms(_).declareVariables(v,y,w)}\n  ${g.mainStart()}\n    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;\n\n    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];\n  }`};return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:l,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:p}),getShaderSource:h},{inputs:[t,r],outputs:[-1]})[0]},po=(e,t,r,o,n,s,u,l)=>{let a=s;if(u){if(o===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return a=nc(e,s,u,t,o,r*n,l),a=a.reshape([t,o,r,n]),e.compute(st(a,Us.perm),{inputs:[a],outputs:[-1]})[0]}else return s.dims.length===3&&(a=s.reshape([t,o,r,n])),e.compute(st(a,Us.perm),{inputs:[a],outputs:[-1]})[0]},Vs=(e,t)=>{let r=rc(e.inputs,t);if(e.inputs[0].dims.length===5)throw new Error("Packed QKV is not implemented");if(e.inputs[1]?.dims.length===5)throw new Error("Packed KV is not implemented");let o=e.inputs[1]&&e.inputs[2]&&e.inputs[1].dims.length===4&&e.inputs[2].dims.length===4,n=po(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,e.inputs[0],e.inputs[3],0);if(o)return nn(e,n,e.inputs[1],e.inputs[2],e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t);let s=po(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.headSize,e.inputs[1],e.inputs[3],r.hiddenSize),u=po(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.vHeadSize,e.inputs[2],e.inputs[3],2*r.hiddenSize);nn(e,n,s,u,e.inputs[4],void 0,e.inputs[6],e.inputs[7],e.inputs[5],r,t)}});var oc,ac,ic,sc,uc,dc,lc,cc,Ws,Gs=q(()=>{"use strict";Ve();$e();we();oc=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(e[0].dataType!==1)throw new Error("Input type must be float.");if(e.length>=2){let t=e[0].dims.length*2===e[1].dims[0];if(e.length===4&&(t=e[3].dims[0]*2===e[1].dims[0]),!t)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},ac=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n            k = i32(${e.indicesGet("indices",n)}) - ${le("uniforms.pads",n,r)};\n            if (k < 0) {\n              break;\n            }\n            if (k >= i32(${le("uniforms.x_shape",n,t)})) {\n              break;\n            }\n            offset += k * i32(${le("uniforms.x_strides",n,t)});\n        `;return`\n          value = ${e.type.value}(uniforms.constant_value);\n          for (var i = 0; i < 1; i++) {\n            var offset = 0;\n            var k = 0;\n            ${o}\n            value = x[offset];\n          }\n      `},ic=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n                k = i32(${e.indicesGet("indices",n)}) - ${le("uniforms.pads",n,r)};\n                if (k < 0) {\n                  k = -k;\n                }\n                {\n                  let _2n_1 = 2 * (i32(${le("uniforms.x_shape",n,t)}) - 1);\n                  k = k % _2n_1;\n                  if(k >= i32(${le("uniforms.x_shape",n,t)})) {\n                    k = _2n_1 - k;\n                  }\n                }\n                offset += k * i32(${le("uniforms.x_strides",n,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},sc=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n                k = i32(${e.indicesGet("indices",n)}) - ${le("uniforms.pads",n,r)};\n                if (k < 0) {\n                  k = 0;\n                }\n                if (k >= i32(${le("uniforms.x_shape",n,t)})) {\n                  k = i32(${le("uniforms.x_shape",n,t)}) - 1;\n                }\n                offset += k * i32(${le("uniforms.x_strides",n,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},uc=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n                k = i32(${e.indicesGet("indices",n)}) - ${le("uniforms.pads",n,r)};\n                if (k < 0)  {\n                  k += i32(${le("uniforms.x_shape",n,t)}]);\n                }\n                if (k >= i32(${le("uniforms.x_shape",n,t)})) {\n                  k -= i32(${le("uniforms.x_shape",n,t)});\n                }\n                offset += k * i32(${le("uniforms.x_strides",n,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},dc=(e,t,r)=>{switch(r.mode){case 0:return ac(e,t,r.pads.length);case 1:return ic(e,t,r.pads.length);case 2:return sc(e,t,r.pads.length);case 3:return uc(e,t,r.pads.length);default:throw new Error("Invalid mode")}},lc=(e,t)=>{let r=z.padShape(e[0].dims.slice(),t.pads),o=e[0].dims,s=[{type:"uint32",data:z.size(r)},{type:"uint32",data:t.pads}];if(t.mode===0){let a=et(e[0].dataType);s.push({type:a,data:t.value})}s.push(...F(e[0].dims),...F(r));let u=["rank"],l=a=>{let p=j("output",e[0].dataType,r.length),h=M("x",e[0].dataType,o.length),g=h.type.value,w=dc(p,o.length,t),v=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return t.mode===0&&v.push({name:"constant_value",type:g}),`\n            ${a.registerUniforms(v).declareVariables(h,p)}\n            ${a.mainStart()}\n            ${a.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n            let indices = ${p.offsetToIndices("global_idx")};\n\n            var value = ${g}(0);\n            ${w}\n            output[global_idx] = value;\n        }`};return{name:"Pad",shaderCache:{hint:`${t.mode}`,inputDependencies:u},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(z.size(r)/64)},programUniforms:s}),getShaderSource:l}},cc=(e,t)=>{if(e.length>1){let r=e[1].getBigInt64Array(),o=e.length>=3&&e[2].data?e[2].getFloat32Array()[0]:0,n=e[0].dims.length,s=new Int32Array(2*n).fill(0);if(e.length>=4){let l=e[3].getBigInt64Array();for(let a=0;a<l.length;a++)s[Number(l[a])]=Number(r[a]),s[Number(l[a])+n]=Number(r[a+l.length])}else r.forEach((l,a)=>s[Number(a)]=Number(l));let u=[];return s.forEach(l=>u.push(l)),{mode:t.mode,value:o,pads:u}}else return t},Ws=(e,t)=>{oc(e.inputs);let r=cc(e.inputs,t);e.compute(lc(e.inputs,r),{inputs:[0]})}});var mn,Hs,Ls,Fs,js,pc,mc,qs,Ks,Ys,Zs,Js,Qs,Xs,eu,tu,ru,nu,ou,au=q(()=>{"use strict";Xt();$e();we();mn=e=>{if(Qt.webgpu.validateInputContent&&(!e||e.length!==1))throw new Error("Pool ops requires 1 input.")},Hs=(e,t,r)=>{let o=t.format==="NHWC",n=e.dims.slice();o&&n.splice(1,0,n.pop());let s=Object.hasOwnProperty.call(t,"dilations"),u=t.kernelShape.slice(),l=t.strides.slice(),a=s?t.dilations.slice():[],p=t.pads.slice();zt.adjustPoolAttributes(r,n,u,l,a,p);let h=zt.computePoolOutputShape(r,n,l,a,u,p,t.autoPad),g=Object.assign({},t);s?Object.assign(g,{kernelShape:u,strides:l,pads:p,dilations:a,cacheKey:t.cacheKey}):Object.assign(g,{kernelShape:u,strides:l,pads:p,cacheKey:t.cacheKey});let w=h.slice();return w.push(w.splice(1,1)[0]),[g,o?w:h]},Ls=(e,t)=>{let r=t.format==="NHWC",o=z.size(e),n=z.size(t.kernelShape),s=[{type:"uint32",data:o},{type:"uint32",data:n}],u=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){let l=t.kernelShape[t.kernelShape.length-1],a=t.strides[t.strides.length-1],p=t.pads[t.pads.length/2-1],h=t.pads[t.pads.length-1],g=!!(p+h);s.push({type:"uint32",data:l},{type:"uint32",data:a},{type:"uint32",data:p},{type:"uint32",data:h}),u.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let w=!1;if(t.kernelShape.length===2){let v=t.kernelShape[t.kernelShape.length-2],y=t.strides[t.strides.length-2],_=t.pads[t.pads.length/2-2],A=t.pads[t.pads.length-2];w=!!(_+A),s.push({type:"uint32",data:v},{type:"uint32",data:y},{type:"uint32",data:_},{type:"uint32",data:A}),u.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[s,u,!0,g,w]}else{if(r)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let l=z.computeStrides(t.kernelShape);s.push({type:"uint32",data:l},{type:"uint32",data:t.pads},{type:"uint32",data:t.strides}),u.push({name:"kernelStrides",type:"u32",length:l.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length});let a=t.pads.reduce((p,h)=>p+h);return[s,u,!!a,!1,!1]}},Fs=(e,t,r,o,n,s,u,l,a,p,h,g)=>{let w=n.format==="NHWC",v=t.type.value,y=j("output",t.type.tensor,o);if(n.kernelShape.length<=2){let _="",A="",S="",I=r-(w?2:1);if(h?_=`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${I}] = indices[${I}] * uniforms.sw - uniforms.pwStart + i;\n                  if (xIndices[${I}] < 0 || xIndices[${I}]\n                      >= uniforms.x_shape[${I}]) {\n                    pad++;\n                    continue;\n                  }\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${s}\n                }`:_=`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${I}] = indices[${I}] * uniforms.sw - uniforms.pwStart + i;\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${s}\n                }`,n.kernelShape.length===2){let C=r-(w?3:2);g?A=`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${C}] = indices[${C}] * uniforms.sh - uniforms.phStart + j;\n                  if (xIndices[${C}] < 0 || xIndices[${C}] >= uniforms.x_shape[${C}]) {\n                    pad += i32(uniforms.kw);\n                    continue;\n                  }\n              `:A=`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${C}] = indices[${C}] * uniforms.sh - uniforms.phStart + j;\n                `,S=`\n              }\n            `}return`\n            ${e.registerUniforms(a).declareVariables(t,y)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n              let indices = ${y.offsetToIndices("global_idx")};\n              var xIndices = ${y.offsetToIndices("global_idx")};\n\n              var value = ${v}(${l});\n              var pad = 0;\n              ${A}\n              ${_}\n              ${S}\n              ${u}\n\n              output[global_idx] = value;\n            }`}else{if(w)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let _=n.kernelShape.length,A=n.pads.length,S="";return p?S=`\n                if (xIndices[j] >= uniforms.x_shape[j]) {\n                  pad++;\n                  isPad = true;\n                  break;\n                }\n              }\n              if (!isPad) {\n                let x_val = x[${t.indicesToOffset("xIndices")}];\n                ${s}\n              }`:S=`\n              }\n              let x_val = x[${t.indicesToOffset("xIndices")}];\n              ${s}\n            `,`\n            ${e.registerUniforms(a).declareVariables(t,y)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n              let indices = ${y.offsetToIndices("global_idx")};\n              var xIndices = ${y.offsetToIndices("global_idx")};\n\n              var offsets: array<u32, ${_}>;\n\n              var value = ${v}(${l});\n              var pad = 0;\n              var isPad = false;\n\n              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {\n                var offset = i;\n                for (var j = 0u; j < ${_-1}u; j++) {\n                  offsets[j] = offset / ${le("uniforms.kernelStrides","j",_)};\n                  offset -= offsets[j] * ${le("uniforms.kernelStrides","j",_)};\n                }\n                offsets[${_-1}] = offset;\n\n                isPad = false;\n                for (var j = ${r-_}u; j < ${r}u; j++) {\n                  xIndices[j] = indices[j] * ${le("uniforms.strides",`j - ${r-_}u`,_)}\n                    + offsets[j - ${r-_}u] - ${le("uniforms.pads","j - 2u",A)};\n                  ${S}\n              }\n              ${u}\n\n              output[global_idx] = value;\n            }`}},js=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,pc=e=>`${js(e)};${e.countIncludePad}`,mc=e=>`${js(e)};${e.storageOrder};${e.dilations}`,qs=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),Ks=(e,t,r,o)=>{let[n,s]=Hs(t,o,r),u=M("x",t.dataType,t.dims.length),l=u.type.value,a="value += x_val;",p="";n.countIncludePad?p+=`value /= ${l}(uniforms.kernelSize);`:p+=`value /= ${l}(i32(uniforms.kernelSize) - pad);`;let[h,g,w,v,y]=Ls(s,n);h.push(...F(t.dims),...F(s));let _=["rank"];return{name:e,shaderCache:{hint:`${o.cacheKey};${w};${v};${y}`,inputDependencies:_},getRunData:()=>({outputs:[{dims:s,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(z.size(s)/64)},programUniforms:h}),getShaderSource:A=>Fs(A,u,t.dims.length,s.length,n,a,p,0,g,w,v,y)}},Ys=e=>{let t=e.count_include_pad!==0,r=qs(e);if(r.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let o={countIncludePad:t,...r,cacheKey:""};return{...o,cacheKey:pc(o)}},Zs=(e,t)=>{mn(e.inputs),e.compute(Ks("AveragePool",e.inputs[0],!1,t))},Js={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},Qs=e=>{let t=e.format;return{format:t,...Js,cacheKey:t}},Xs=(e,t)=>{mn(e.inputs),e.compute(Ks("GlobalAveragePool",e.inputs[0],!0,t))},eu=(e,t,r,o)=>{let[n,s]=Hs(t,o,r),u=`\n      value = max(x_val, value);\n    `,l="",a=M("x",t.dataType,t.dims.length),p=["rank"],[h,g,w,v,y]=Ls(s,n);return h.push(...F(t.dims),...F(s)),{name:e,shaderCache:{hint:`${o.cacheKey};${w};${v};${y}`,inputDependencies:p},getRunData:()=>({outputs:[{dims:s,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(z.size(s)/64)},programUniforms:h}),getShaderSource:_=>Fs(_,a,t.dims.length,s.length,n,u,l,-1e5,g,w,v,y)}},tu=(e,t)=>{mn(e.inputs),e.compute(eu("MaxPool",e.inputs[0],!1,t))},ru=e=>{let t=e.storage_order,r=e.dilations,o=qs(e);if(t!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(o.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let n={storageOrder:t,dilations:r,...o,cacheKey:""};return{...n,cacheKey:mc(n)}},nu=e=>{let t=e.format;return{format:t,...Js,cacheKey:t}},ou=(e,t)=>{mn(e.inputs),e.compute(eu("GlobalMaxPool",e.inputs[0],!0,t))}});var hc,gc,iu,su=q(()=>{"use strict";Xt();Ve();we();hc=(e,t,r)=>{let o=e===t,n=e<t&&r<0,s=e>t&&r>0;if(o||n||s)throw new Error("Range these inputs\' contents are invalid.")},gc=(e,t,r,o)=>{let n=Math.abs(Math.ceil((t-e)/r)),s=[n],u=n,l=et(o),a=[{type:"uint32",data:u},{type:l,data:e},{type:l,data:r},...F(s)],p=h=>{let g=j("output",o,s.length),w=g.type.value,v=[{name:"outputSize",type:"u32"},{name:"start",type:w},{name:"delta",type:w}];return`\n        ${h.registerUniforms(v).declareVariables(g)}\n        ${h.mainStart()}\n        ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        output[global_idx] = uniforms.start + ${w}(global_idx) * uniforms.delta;\n      }`};return{name:"Range",shaderCache:{hint:`${o}`},getShaderSource:p,getRunData:()=>({outputs:[{dims:s,dataType:o}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:a})}},iu=e=>{let t=0,r=0,o=0;e.inputs[0].dataType===6?(t=e.inputs[0].getInt32Array()[0],r=e.inputs[1].getInt32Array()[0],o=e.inputs[2].getInt32Array()[0]):e.inputs[0].dataType===1&&(t=e.inputs[0].getFloat32Array()[0],r=e.inputs[1].getFloat32Array()[0],o=e.inputs[2].getFloat32Array()[0]),Qt.webgpu.validateInputContent&&hc(t,r,o),e.compute(gc(t,r,o,e.inputs[0].dataType),{inputs:[]})}});var yc,bc,wc,vc,$c,Sc,xc,_c,Cc,Ic,Ac,uu,Tc,Ec,Oc,Pc,Bc,du,lu,cu=q(()=>{"use strict";$e();Fe();we();yc=(e,t)=>{if(e.every(r=>r>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),e.length>0){if(t.mode==="linear"){if(!(e.length===2||e.length===3||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1||e.length===5&&e[0]===1&&e[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and\n            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(t.mode==="cubic"&&!(e.length===2||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},bc=(e,t,r)=>{t.every(n=>n>=0&&n<r||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let o=new Array(r).fill(1);return t.forEach((n,s)=>o[n]=e[s]),o},wc=(e,t,r,o,n,s)=>{let[u,l,a]=r>10?[1,2,3]:[-1,e.length>1?1:-1,-1],p=e[0].dims.length;if(u>0&&e.length>u&&e[u].dims.length>0)e[u].getFloat32Array().forEach(h=>s.push(h));else if(t.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(l>0&&e.length>l&&e[l].dims.length>0){if(e[l].getFloat32Array().forEach(h=>o.push(h)),o.length!==0&&o.length!==p&&r>=18&&o.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");yc(o,t),t.axes.length>0&&bc(o,t.axes,p).forEach((h,g)=>o[g]=h)}if(a>0&&e.length>a&&(e[a].getBigInt64Array().forEach(h=>n.push(Number(h))),n.length!==p||r>=18&&n.length===t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(o.length!==t.axes.length)throw new Error(\'Resize requires "scales" input size to be of axes rank when axes attributes is specified\');if(n.length!==t.axes.length)throw new Error(\'Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified\')}if(typeof o<"u"&&typeof n<"u"&&o.length>0&&n.length>p)throw new Error("Resize requires only of scales or sizes to be specified")},vc=(e,t)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,\n     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${t} { `+(()=>{switch(e){case"asymmetric":return`return ${t}(xResized) / ${t}(xScale);`;case"pytorch_half_pixel":return`if (lengthResized > 1) {\n                    return (${t}(xResized) + 0.5) / ${t}(xScale) - 0.5;\n                  } else {\n                    return 0.0;\n                  }`;case"tf_half_pixel_for_nn":return`return (${t}(xResized) + 0.5) / ${t}(xScale);`;case"align_corners":return`if (lengthResized == 1) {\n                    return 0.0;\n                  } else {\n                    // The whole part and the fractional part are calculated separately due to inaccuracy of floating\n                    // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an\n                    // offset-by-one error later in floor().\n                    let whole = ${t}(xResized * (lengthOriginal - 1) / (lengthResized - 1));\n                    let fract =\n                        ${t}(xResized * (lengthOriginal - 1) % (lengthResized - 1)) / ${t}(lengthResized - 1);\n                    return whole + fract;\n                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {\n                    return ${t}(roiStart) * ${t}(lengthOriginal - 1) +\n                        (${t}(xResized) * ${t}(roiEnd - roiStart) * ${t}(lengthOriginal - 1)) /\n                        ${t}(lengthResized - 1);\n                  } else {\n                    return 0.5 * ${t}(roiStart + roiEnd) * ${t}(lengthOriginal - 1);\n                  }`;case"half_pixel_symmetric":return`const outputWidth = ${t}xScale * ${t}(lengthResized);\n                  const adjustment = ${t}(lengthResized) / outputWidth;\n                  const center = ${t}(lengthOriginal) / 2;\n                  const offset = center * (1 - adjustment);\n                  return offset + ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;case"half_pixel":return`return ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",$c=(e,t,r)=>`fn getNearestPixelFromOriginal(xOriginal: ${r}, isDownSample: bool) -> ${r} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";case"simple":default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",Sc=(e,t,r)=>{let o=new Array(r).fill(0).concat(new Array(r).fill(1)),n=e.length===0?o:e.slice();return t.length>0?(t.forEach((s,u)=>{o[s]=n[u],o[u+r]=n[t.length+u]}),o):n},xc=(e,t,r,o)=>{let n=[];if(r.length>0)if(o.length>0){if(e.forEach(s=>n.push(s)),Math.max(...o)>e.length)throw new Error("axes is out of bound");o.forEach((s,u)=>n[s]=r[u])}else r.forEach(s=>n.push(s));else{if(t.length===0)throw new Error("Resize requires either scales or sizes.");n=e.map((s,u)=>Math.round(s*t[u]))}return n},_c=(e,t,r)=>{let o=(()=>{switch(r.keepAspectRatioPolicy){case"not_larger":return r.axes.length>0?Math.min(...r.axes.map(s=>t[s]),Number.MAX_VALUE):Math.min(...t,Number.MAX_VALUE);case"not_smaller":return r.axes.length>0?Math.max(...r.axes.map(s=>t[s]),Number.MIN_VALUE):Math.max(...t,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${r.keepAspectRatioPolicy} is not supported`)}})();t.fill(1,0,t.length);let n=e.slice();return r.axes.length>0?(r.axes.forEach(s=>t[s]=o),r.axes.forEach(s=>n[s]=Math.round(e[s]*t[s]))):(t.fill(o,0,t.length),n.forEach((s,u)=>n[u]=Math.round(s*t[u]))),n},Cc=(e,t,r,o,n)=>`\n    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${r.length}> {\n      var original_indices: array<${e.type.value}, ${r.length}>;\n      for (var i:u32 = 0; i < ${r.length}; i++) {\n        var output_index = ${e.indicesGet("output_indices","i")};\n        var scale = ${le("uniforms.scales","i",o)};\n        var roi_low = ${le("uniforms.roi","i",n)};\n        var roi_hi = ${le("uniforms.roi",`i + ${t.length}`,n)};\n        if (scale == 1.0) {\n          original_indices[i] = ${e.type.value}(output_index);\n        } else {\n          var input_shape_i = ${le("uniforms.input_shape","i",t.length)};\n          var output_shape_i = ${le("uniforms.output_shape","i",r.length)};\n          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                           input_shape_i, roi_low, roi_hi);\n        }\n      }\n      return original_indices;\n    }`,Ic=(e,t,r,o,n,s,u)=>`\n    fn calculateInputIndicesFromOutputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n      var input_indices: ${e.type.indices};\n      for (var i:u32 = 0; i < ${o.length}; i++) {\n        var output_index = ${t.indicesGet("output_indices","i")};\n        var input_index: u32;\n        var scale = ${le("uniforms.scales","i",n)};\n        if (scale == 1.0) {\n          input_index = output_index;\n        } else {\n          var roi_low = ${le("uniforms.roi","i",s)};\n          var roi_hi = ${le("uniforms.roi",`i + ${r.length}`,s)};\n          var input_shape_i = ${le("uniforms.input_shape","i",r.length)};\n          var output_shape_i = ${le("uniforms.output_shape","i",o.length)};\n          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                        input_shape_i, roi_low, roi_hi);\n          if (!${u} || (original_idx >= 0 && original_idx < ${t.type.value}(input_shape_i))) {\n            if (original_idx < 0) {\n              input_index = 0;\n            } else if (original_idx > ${t.type.value}(input_shape_i - 1)) {\n              input_index = input_shape_i - 1;\n            } else {\n              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));\n            }\n          } else {\n            input_index = u32(original_idx);\n          }\n        }\n        ${e.indicesSet("input_indices","i"," input_index")}\n      }\n      return input_indices;\n    }`,Ac=(e,t)=>`\n    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {\n      for (var i:u32 = 0; i < ${t.length}; i++) {\n        var input_index = ${e.indicesGet("input_indices","i")};\n        if (input_index < 0 || input_index >= ${le("uniforms.input_shape","i",t.length)}) {\n          return false;\n        }\n      }\n      return true;\n    }`,uu=(e,t,r,o)=>e.rank>o?`\n    ${e.indicesSet("input_indices",t,"channel")};\n    ${e.indicesSet("input_indices",r,"batch")};\n`:"",Tc=(e,t,r,o,n)=>{let[u,l,a,p]=r.length===2?[-1,0,1,-1]:[0,2,3,1],h=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${h} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",l,`max(0, min(row, ${r[l]} - 1))`)};\n      ${e.indicesSet("input_indices",a,`max(0, min(col, ${r[a]} - 1))`)};\n      ${uu(e,p,u,2)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn bilinearInterpolation(output_indices: ${t.type.indices}) -> ${h} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var row:${h} = originalIndices[${l}];\n      var col:${h} = originalIndices[${a}];\n      ${o?`if (row < 0 || row > (${r[l]} - 1) || col < 0 || col > (${r[a]} - 1)) {\n        return ${n};\n      }`:""};\n      row = max(0, min(row, ${r[l]} - 1));\n      col = max(0, min(col, ${r[a]} - 1));\n      var row1: u32 = u32(row);\n      var col1: u32 = u32(col);\n      var row2: u32 = u32(row + 1);\n      var col2: u32 = u32(col + 1);\n      var channel: u32 = ${r.length>2?`u32(originalIndices[${p}])`:"0"};\n      var batch: u32 =  ${r.length>2?`u32(originalIndices[${u}])`:"0"};\n      var x11: ${h} = getInputValue(batch, channel, row1, col1);\n      var x12: ${h} = getInputValue(batch, channel, row1, col2);\n      var x21: ${h} = getInputValue(batch, channel, row2, col1);\n      var x22: ${h} = getInputValue(batch, channel, row2, col2);\n      var dx1: ${h} = abs(row - ${h}(row1));\n      var dx2: ${h} = abs(${h}(row2) - row);\n      var dy1: ${h} = abs(col - ${h}(col1));\n      var dy2: ${h} = abs(${h}(col2) - col);\n      if (row1 == row2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (col1 == col2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);\n    }`},Ec=(e,t,r,o,n,s,u,l,a,p)=>{let h=r.length===2,g=!0,[w,v]=h?[0,1]:g?[2,3]:[1,2],y=e.type.value,_=A=>{let S=A===w?"row":"col";return`\n      fn ${S}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${t.type.indices}) -> ${y} {\n        var output_index = ${t.indicesGet("output_indices",A)};\n        var originalIdx: ${y} = getOriginalCoordinateFromResizedCoordinate(output_index, ${n[A]},\n        ${o[A]}, ${r[A]}, ${s[A]}, ${s[A]} + ${r.length});\n        var fractOriginalIdx: ${y} = originalIdx - floor(originalIdx);\n        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);\n\n        if (${l} && (originalIdx < 0 || originalIdx > (${r[A]} - 1))) {\n          return ${a};\n        }\n        var data: array<${y}, 4> = array<${y}, 4>(0.0, 0.0, 0.0, 0.0);\n        for (var i: i32 = -1; i < 3; i++) {\n          var ${S}: ${y} = originalIdx + ${y}(i);\n          if (${S} < 0 || ${S} >= ${r[A]}) {\n            ${(()=>p?`coefs[i + 1] = 0.0;\n                        continue;`:l?`return ${a};`:`${S} = max(0, min(${S}, ${r[A]} - 1));`)()};\n          }\n        var input_indices_copy: ${e.type.indices} = input_indices;\n          ${e.indicesSet("input_indices_copy",A,`u32(${S})`)};\n          data[i + 1] = ${A===w?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};\n        }\n        return cubicInterpolation1D(data, coefs);\n      }`};return`\n    ${_(w)};\n    ${_(v)};\n  fn getCubicInterpolationCoefs(s: ${y}) -> array<${y}, 4> {\n    var absS = abs(s);\n    var coeffs: array<${y}, 4> = array<${y}, 4>(0.0, 0.0, 0.0, 0.0);\n    var oneMinusAbsS: ${y} = 1.0 - absS;\n    var twoMinusAbsS: ${y} = 2.0 - absS;\n    var onePlusAbsS: ${y} = 1.0 + absS;\n    coeffs[0] = ((${u} * onePlusAbsS - 5 * ${u}) * onePlusAbsS + 8 * ${u}) * onePlusAbsS - 4 * ${u};\n    coeffs[1] = ((${u} + 2) * absS - (${u} + 3)) * absS * absS + 1;\n    coeffs[2] = ((${u} + 2) * oneMinusAbsS - (${u} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;\n    coeffs[3] = ((${u} * twoMinusAbsS - 5 * ${u}) * twoMinusAbsS + 8 * ${u}) * twoMinusAbsS - 4 * ${u};\n    return coeffs;\n  }\n\n  fn cubicInterpolation1D(x: array<${y}, 4>, coefs: array<${y}, 4>) -> ${y} {\n    var coefsSum: ${y} = coefs[0] + coefs[1] + coefs[2] + coefs[3];\n    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;\n  }\n\n  fn bicubicInterpolation(output_indices: ${t.type.indices}) -> ${y} {\n    var input_indices: ${e.type.indices} = output_indices;\n    return colCubicInterpolation(input_indices, output_indices);\n  }\n    `},Oc=(e,t,r,o,n)=>{let[u,l,a,p,h]=r.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],g=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${g} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",l,`max(0, min(depth, ${r[l]} - 1))`)};\n      ${e.indicesSet("input_indices",a,`max(0, min(height, ${r[a]} - 1))`)};\n      ${e.indicesSet("input_indices",p,`max(0, min(width, ${r[p]} - 1))`)};\n      ${uu(e,h,u,3)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn trilinearInterpolation(output_indices: ${t.type.indices}) -> ${g} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var depth:${g} = originalIndices[${l}];\n      var height:${g} = originalIndices[${a}];\n      var width:${g} = originalIndices[${p}];\n      ${o?`if (depth < 0 || depth > (${r[l]} - 1) || height < 0 || height > (${r[a]} - 1) || width < 0 || (width > ${r[p]} - 1)) {\n      return ${n};\n        }`:""};\n\n    depth = max(0, min(depth, ${r[l]} - 1));\n      height = max(0, min(height, ${r[a]} - 1));\n      width = max(0, min(width, ${r[p]} - 1));\n      var depth1: u32 = u32(depth);\n      var height1: u32 = u32(height);\n      var width1: u32 = u32(width);\n      var depth2: u32 = u32(depth + 1);\n      var height2: u32 = u32(height + 1);\n      var width2: u32 = u32(width + 1);\n      var channel: u32 = ${r.length>3?`u32(originalIndices[${h}])`:"0"};\n      var batch: u32 =  ${r.length>3?`u32(originalIndices[${u}])`:"0"};\n\n      var x111: ${g} = getInputValue(batch, channel, depth1, height1, width1);\n      var x112: ${g} = getInputValue(batch, channel, depth1, height1, width2);\n      var x121: ${g} = getInputValue(batch, channel, depth1, height2, width1);\n      var x122: ${g} = getInputValue(batch, channel, depth1, height2, width2);\n      var x211: ${g} = getInputValue(batch, channel, depth2, height1, width1);\n      var x212: ${g} = getInputValue(batch, channel, depth2, height1, width2);\n      var x221: ${g} = getInputValue(batch, channel, depth2, height2, width1);\n      var x222: ${g} = getInputValue(batch, channel, depth2, height2, width2);\n      var dx1: ${g} = abs(depth - ${g}(depth1));\n      var dx2: ${g} = abs(${g}(depth2) - depth);\n      var dy1: ${g} = abs(height - ${g}(height1));\n      var dy2: ${g} = abs(${g}(height2) - height);\n      var dz1: ${g} = abs(width - ${g}(width1));\n      var dz2: ${g} = abs(${g}(width2) - width);\n      if (depth1 == depth2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (height1 == height2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      if (width1 == width2) {\n        dz1 = 0.5;\n        dz2 = 0.5;\n      }\n      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +\n              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);\n    }`},Pc=(e,t,r,o,n,s)=>{let u=e.dims,l=Sc(s,t.axes,u.length),a=xc(u,o,n,t.axes),p=o.slice();o.length===0&&(p=u.map((I,P)=>I===0?1:a[P]/I),t.keepAspectRatioPolicy!=="stretch"&&(a=_c(u,p,t)));let h=j("output",e.dataType,a.length),g=M("input",e.dataType,u.length),w=z.size(a),v=u.length===a.length&&u.every((I,P)=>I===a[P]),y=t.coordinateTransformMode==="tf_crop_and_resize",_=t.extrapolationValue,A=g.type.value,S=I=>`\n      ${v?"":`\n      ${vc(t.coordinateTransformMode,A)};\n      ${(()=>{switch(t.mode){case"nearest":return`\n              ${Ac(g,u)};\n              ${$c(t.nearestMode,r,A)};\n              ${Ic(g,h,u,a,p.length,l.length,y)};\n              `;case"linear":return`\n              ${Cc(h,u,a,p.length,l.length)};\n              ${(()=>{if(u.length===2||u.length===4)return`${Tc(g,h,u,y,_)}`;if(u.length===3||u.length===5)return`${Oc(g,h,u,y,_)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};\n            `;case"cubic":return`\n            ${(()=>{if(u.length===2||u.length===4)return`${Ec(g,h,u,a,p,l,t.cubicCoeffA,y,t.extrapolationValue,t.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};\n            `;default:throw Error("Invalid resize mode")}})()};\n      `}\n      ${I.registerUniform("output_size","u32").registerUniform("scales","f32",p.length).registerUniform("roi","f32",l.length).declareVariables(g,h)}\n      ${I.mainStart()}\n        ${I.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n        ${v?"output[global_idx] = input[global_idx];":`\n        let output_indices = ${h.offsetToIndices("global_idx")};\n        var input_indices: ${g.type.indices};\n        ${(()=>{switch(t.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);\n                if (checkInputIndices(input_indices)) {\n                  output[global_idx] = ${g.getByIndices("input_indices")};\n                } else {\n                  output[global_idx] = ${t.extrapolationValue};\n                }`;case"linear":return`output[global_idx] = ${u.length===2||u.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${t.mode}`)}})()};\n`}\n      }`;return{name:"Resize",shaderCache:{hint:`${t.cacheKey}|${r}|${p.length>0?p:""}|${n.length>0?n:""}|${l.length>0?l:""}|${v}|${u}`,inputDependencies:["rank"]},getShaderSource:S,getRunData:()=>({outputs:[{dims:a,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(w/64)},programUniforms:[{type:"uint32",data:w},{type:"float32",data:p},{type:"float32",data:l},...F(u),...F(a)]})}},Bc=e=>{let t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},du=(e,t)=>{let r=[],o=[],n=[],s=Bc(e);if(t.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");wc(e.inputs,t,s,r,o,n),e.compute(Pc(e.inputs[0],t,s,r,o,n),{inputs:[0]})},lu=e=>{let t=e.antialias,r=e.axes,o=e.coordinateTransformMode,n=e.cubicCoeffA,s=e.excludeOutside!==0,u=e.extrapolationValue,l=e.keepAspectRatioPolicy,a=e.mode,p=e.nearestMode===""?"simple":e.nearestMode;return ge({antialias:t,axes:r,coordinateTransformMode:o,cubicCoeffA:n,excludeOutside:s,extrapolationValue:u,keepAspectRatioPolicy:l,mode:a,nearestMode:p})}});var kc,Rc,pu,mu,fu=q(()=>{"use strict";Ve();$e();Fe();we();kc=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let t=e[0],r=e[1],o=e[2];if(t.dataType!==r.dataType||t.dataType!==o.dataType)throw new Error("All inputs must have the same data type");if(t.dims.length!==3&&t.dims.length!==2)throw new Error("Input must be 2D or 3D");if(r.dims.length!==3&&r.dims.length!==2)throw new Error("Skip must be 2D or 3D");let n=t.dims[t.dims.length-1],s=t.dims[t.dims.length-2];if(r.dims[r.dims.length-1]!==n)throw new Error("Skip must have the same hidden size as input");if(r.dims[r.dims.length-2]!==s)throw new Error("Skip must have the same sequence length as input");if(o.dims.length!==1)throw new Error("Gamma must be 1D");if(o.dims[o.dims.length-1]!==n)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let u=e[3];if(u.dims.length!==1)throw new Error("Beta must be 1D");if(u.dims[u.dims.length-1]!==n)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let u=e[4];if(u.dims.length!==1)throw new Error("Bias must be 1D");if(u.dims[u.dims.length-1]!==n)throw new Error("Bias must have the same hidden size as input")}},Rc=(e,t,r,o)=>{let n=e[0].dims,s=z.size(n),u=n,l=s,a=n.slice(-1)[0],p=o?n.slice(0,-1).concat(1):[],h=e.length>3,g=e.length>4,w=o&&r>1,v=o&&r>2,y=r>3,_=Le(a),A=[M("x",e[0].dataType,e[0].dims,_),M("skip",e[1].dataType,e[1].dims,_),M("gamma",e[2].dataType,e[2].dims,_)];h&&A.push(M("beta",e[3].dataType,e[3].dims,_)),g&&A.push(M("bias",e[4].dataType,e[4].dims,_)),A.push(j("output",e[0].dataType,u,_)),w&&A.push(j("meanOutput",1,p)),v&&A.push(j("invStdOutput",1,p)),y&&A.push(j("inputSkipBiasSum",e[0].dataType,u,_));let S=He(e[0].dataType),I=C=>`\n      const hiddenSize: f32 = ${a};\n      const hiddenSizeVectorized: u32 = ${a/_};\n      const epsilon: f32 = ${t.epsilon};\n\n      ${C.declareVariables(...A)}\n\n      ${C.mainStart()}\n        ${C.guardAgainstOutOfBoundsWorkgroupSizes(l/a)}\n        let offset = global_idx * hiddenSizeVectorized;\n        var sum = ${Ze("f32",_)};\n        var squareSum = ${Ze("f32",_)};\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          let skipValue = skip[offset + i];\n          let biasValue = ${g?"bias[i]":"0.0"};\n          let inputValue = x[offset + i];\n          let value = inputValue + skipValue + biasValue;\n          ${y?"inputSkipBiasSum[offset + i] = value;":""}\n          output[offset + i] = value;\n          let f32Value = ${it(S,_,"value")};\n          sum += f32Value;\n          squareSum += f32Value * f32Value;\n        }\n        let mean = ${tt("sum",_)} / hiddenSize;\n        let invStdDev = inverseSqrt(${tt("squareSum",_)} / hiddenSize - mean * mean + epsilon);\n        ${w?"meanOutput[global_idx] = mean;":""}\n        ${v?"invStdOutput[global_idx] = invStdDev;":""}\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          output[offset + i] = (output[offset + i] - ${S}(mean)) * ${S}(invStdDev) * gamma[i]\n           + ${h?"beta[i]":"0.0"};\n        }\n      }`,P=[{dims:u,dataType:e[0].dataType}];return r>1&&P.push({dims:p,dataType:1}),r>2&&P.push({dims:p,dataType:1}),r>3&&P.push({dims:n,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:t.cacheKey},getShaderSource:I,getRunData:()=>({outputs:P,dispatchGroup:{x:Math.ceil(l/a/64)}})}},pu=(e,t)=>{kc(e.inputs);let o=[0];e.outputCount>1&&o.push(-3),e.outputCount>2&&o.push(-3),e.outputCount>3&&o.push(3),e.compute(Rc(e.inputs,t,e.outputCount,!1),{outputs:o})},mu=e=>{let t=e.epsilon;return ge({epsilon:t})}});var Dc,fn,Mc,hu,Uc,zc,gu,yu,bu=q(()=>{"use strict";Ve();$e();Fe();we();Dc=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");if(t.axes.length!==0){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach((r,o)=>{if(e[o+1].dataType!==6&&e[o+1].dataType!==7)throw new Error(`Input ${o} must be an array of int32 or int64`)})},fn=(e,t)=>{let r=[];if(e.length>t)if(e[t].dataType===7)e[t].getBigInt64Array().forEach(o=>r.push(Number(o)));else if(e[t].dataType===6)e[t].getInt32Array().forEach(o=>r.push(Number(o)));else throw new Error(`Input ${t} must be an array of int32 or int64`);return r},Mc=(e,t)=>{if(e.length>1){let r=fn(e,1),o=fn(e,2),n=fn(e,3);return n.length===0&&(n=[...Array(e[0].dims.length).keys()]),ge({starts:r,ends:o,axes:n})}else return t},hu=(e,t,r,o,n)=>{let s=e;return e<0&&(s+=r[o[t]]),n[t]<0?Math.max(0,Math.min(s,r[o[t]]-1)):Math.max(0,Math.min(s,r[o[t]]))},Uc=(e,t,r)=>`fn calculateInputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n          var input_indices: ${e.type.indices};\n          var carry = 0u;\n          for (var i = ${r.length}; i >= 0; i--) {\n            let input_shape_i = ${le("uniforms.input_shape","i",r.length)};\n            let steps_i = ${le("uniforms.steps","i",r.length)};\n            let signs_i = ${le("uniforms.signs","i",r.length)};\n            let starts_i = ${le("uniforms.starts","i",r.length)};\n            var output_index = ${t.indicesGet("output_indices","i")};\n            var input_index = output_index * steps_i + starts_i + carry;\n            carry = input_index / input_shape_i;\n            input_index = input_index % input_shape_i;\n            if (signs_i < 0) {\n              input_index = input_shape_i - input_index - 1u + starts_i;\n            }\n            ${e.indicesSet("input_indices","i","input_index")};\n          }\n          return input_indices;\n      }`,zc=(e,t)=>{let r=e[0].dims,o=z.size(r),n=t.axes.length>0?z.normalizeAxes(t.axes,r.length):[...Array(r.length).keys()],s=fn(e,4);s.forEach(S=>S!==0||(()=>{throw new Error("step cannot be 0")})),s.length===0&&(s=Array(n.length).fill(1));let u=t.starts.map((S,I)=>hu(S,I,r,n,s)),l=t.ends.map((S,I)=>hu(S,I,r,n,s));if(n.length!==u.length||n.length!==l.length)throw new Error("start, ends and axes should have the same number of elements");if(n.length!==r.length)for(let S=0;S<r.length;++S)n.includes(S)||(u.splice(S,0,0),l.splice(S,0,r[S]),s.splice(S,0,1));let a=s.map(S=>Math.sign(S));s.forEach((S,I,P)=>{if(S<0){let C=(l[I]-u[I])/S,V=u[I],D=V+C*s[I];u[I]=D,l[I]=V,P[I]=-S}});let p=r.slice(0);n.forEach((S,I)=>{p[S]=Math.ceil((l[S]-u[S])/s[S])});let h={dims:p,dataType:e[0].dataType},g=j("output",e[0].dataType,p.length),w=M("input",e[0].dataType,e[0].dims.length),v=z.size(p),y=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:u.length},{name:"signs",type:"i32",length:a.length},{name:"steps",type:"u32",length:s.length}],_=[{type:"uint32",data:v},{type:"uint32",data:u},{type:"int32",data:a},{type:"uint32",data:s},...F(e[0].dims),...F(p)],A=S=>`\n      ${S.registerUniforms(y).declareVariables(w,g)}\n        ${Uc(w,g,r)}\n        ${S.mainStart()}\n          ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n          let output_indices = ${g.offsetToIndices("global_idx")};\n          let input_indices = calculateInputIndices(output_indices);\n          ${g.setByOffset("global_idx",w.getByIndices("input_indices"))}\n      }`;return{name:"Slice",shaderCache:{hint:`${a.length}_${u.length}_${s.length}`,inputDependencies:["rank"]},getShaderSource:A,getRunData:()=>({outputs:[h],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:_})}},gu=(e,t)=>{Dc(e.inputs,t);let r=Mc(e.inputs,t);e.compute(zc(e.inputs,r),{inputs:[0]})},yu=e=>{let t=e.starts,r=e.ends,o=e.axes;return ge({starts:t,ends:r,axes:o})}});var Vc,Nc,wu,vu,$u=q(()=>{"use strict";$e();Fe();we();Vc=e=>{if(!e||e.length!==1)throw new Error("Softmax op requires 1 input.")},Nc=(e,t)=>{let r=e.dims,o=z.size(r),n=64,s=t.axis;if(s<0&&(s=r.length+s),s<r.length-1)throw new Error("softmax only supports last axis for now.");let u=r[s],l=o/u,a=Le(u),p=u/a,h=(A,S)=>S===4?`max(max(${A}.x, ${A}.y), max(${A}.z, ${A}.w))`:S===2?`max(${A}.x, ${A}.y)`:S===3?`max(max(${A}.x, ${A}.y), ${A}.z)`:A,g=M("x",e.dataType,e.dims,a),w=j("result",e.dataType,e.dims,a),v=g.type.value,y=He(e.dataType)==="f32"?`var threadMax = ${v}(-3.402823e+38f);`:`var threadMax = ${v}(-65504.0h);`,_=A=>`\n      var<workgroup> rowMaxShared : ${v};\n      var<workgroup> rowSumShared : ${v};\n      var<workgroup> threadShared : array<${v}, ${n}>;\n\n      fn getValue(row: i32, col: i32, row_stride: i32) -> ${v} {\n        let index = row * row_stride + col;\n        return x[index];\n      }\n\n      fn setValue(row: i32, col: i32, row_stride: i32, value: ${v}) {\n        let index = row * row_stride + col;\n        result[index] = value;\n      }\n      ${A.registerUniform("packedCols","i32").declareVariables(g,w)}\n      ${A.mainStart()}\n        let gindex = i32(global_idx);\n        let lindex = i32(local_idx);\n        const wg = ${n};\n        let row = gindex / wg;\n        let cols = uniforms.packedCols;\n        let row_stride : i32 = uniforms.packedCols;\n\n        // find the rows max\n        ${y}\n        for (var col = lindex; col < cols; col += wg) {\n          let value = getValue(row, col, row_stride);\n          threadMax = max(threadMax, value);\n        }\n        if (lindex < cols) {\n          threadShared[lindex] = threadMax;\n        }\n        workgroupBarrier();\n\n        var reduceSize = min(cols, wg);\n        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {\n          reduceSize = currSize + (reduceSize & 1);\n          if (lindex < currSize) {\n            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowMaxShared = ${v}(${h("threadShared[0]",a)});\n        }\n        workgroupBarrier();\n\n        // find the rows sum\n        var threadSum = ${v}(0.0);\n        for (var col = lindex; col < cols; col += wg) {\n          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);\n          threadSum += subExp;\n        }\n        threadShared[lindex] = threadSum;\n        workgroupBarrier();\n\n        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {\n          if (lindex < currSize) {\n            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowSumShared = ${v}(${tt("threadShared[0]",a)});\n        }\n        workgroupBarrier();\n\n        // calculate final value for each element in the row\n        for (var col = lindex; col < cols; col += wg) {\n          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;\n          setValue(row, col, row_stride, value);\n        }\n      }`;return{name:"Softmax",shaderCache:{hint:`${a}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.dataType}],dispatchGroup:{x:l},programUniforms:[{type:"uint32",data:p}]}),getShaderSource:_}},wu=(e,t)=>{Vc(e.inputs),e.compute(Nc(e.inputs[0],t))},vu=e=>ge({axis:e.axis})});var Wc,Gc,Hc,Lc,Fc,Su,xu,_u=q(()=>{"use strict";$e();Fe();we();Wc=e=>{if(!e||e.length<1)throw new Error("too few inputs")},Gc=(e,t)=>{let r=[],o=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(n=>r.push(Number(n))),o=r.length),ge({numOutputs:o,axis:t.axis,splitSizes:r})},Hc=e=>`\nfn calculateOutputIndex(index: u32) -> u32 {\n    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {\n    if (index < ${le("uniforms.size_in_split_axis","i",e)}) {\n        return i;\n    }\n    }\n    return ${e}u;\n}`,Lc=e=>{let t=e.length,r=[];for(let o=0;o<t;++o){let n=e[o].setByIndices("indices","input[global_idx]");t===1?r.push(n):o===0?r.push(`if (output_number == ${o}u) { ${n} }`):o===t-1?r.push(`else { ${n} }`):r.push(`else if (output_number == ${o}) { ${n} }`)}return`\n      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {\n        ${r.join(`\n`)}\n      }`},Fc=(e,t)=>{let r=e[0].dims,o=z.size(r),n=e[0].dataType,s=z.normalizeAxis(t.axis,r.length),u=new Array(t.numOutputs),l=M("input",n,r),a=new Array(t.numOutputs),p=[],h=[],g=0,w=[{type:"uint32",data:o}];for(let y=0;y<t.numOutputs;y++){g+=t.splitSizes[y],a[y]=g;let _=r.slice();_[t.axis]=t.splitSizes[y],h.push(_),u[y]=j(`output${y}`,n,_),p.push({dims:h[y],dataType:e[0].dataType})}w.push({type:"uint32",data:a}),w.push(...F(r)),h.forEach(y=>w.push(...F(y)));let v=y=>`\n  ${y.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",a.length).declareVariables(l,...u)}\n  ${Hc(a.length)}\n  ${Lc(u)}\n\n  ${y.mainStart()}\n    ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}\n\n    var indices = ${l.offsetToIndices("global_idx")};\n    var index = ${l.indicesGet("indices",s)};\n    let output_number = calculateOutputIndex(index);\n    if (output_number != 0) {\n      index -= ${le("uniforms.size_in_split_axis","output_number - 1u",a.length)};\n      ${l.indicesSet("indices",s,"index")};\n    }\n    writeBufferData(output_number, indices, global_idx);\n  }`;return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:v,getRunData:()=>({outputs:p,dispatchGroup:{x:Math.ceil(o/64)},programUniforms:w})}},Su=(e,t)=>{Wc(e.inputs);let r=e.inputs.length===1?t:Gc(e.inputs,t);e.compute(Fc(e.inputs,r),{inputs:[0]})},xu=e=>{let t=e.axis,r=e.splitSizes,o=e.numOutputs<0?r.length:e.numOutputs;if(o!==r.length)throw new Error("numOutputs and splitSizes lengh must be equal");return ge({axis:t,numOutputs:o,splitSizes:r})}});var Cu,jc,qc,Kc,Iu,Au=q(()=>{"use strict";Ve();$e();we();Cu=e=>Array.from(e.getBigInt64Array(),Number),jc=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 inputs.");if(e[0].dataType!==1&&e[0].dataType!==6&&e[0].dataType!==12)throw new Error("Tile only support float, int32, and uint32 data types");if(e[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(e[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(Cu(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},qc=(e,t)=>{let r=[];for(let o=0;o<e.length;++o)r.push(e[o]*t[o]);return r},Kc=e=>{let t=e[0].dims,r=Cu(e[1]),o=qc(t,r),n=z.size(o),s=e[0].dataType,u=M("input",s,t.length),l=j("output",s,o.length),a=p=>`\n      const inputShape = ${u.indices(...t)};\n      ${p.registerUniform("output_size","u32").declareVariables(u,l)}\n      ${p.mainStart()}\n      ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n      let output_indices = ${l.offsetToIndices("global_idx")};\n      var input_indices: ${u.type.indices};\n      for (var i = 0; i < ${t.length}; i++) {\n        let input_dim_i = ${u.indicesGet("uniforms.input_shape","i")};\n        let input_dim_value = ${l.indicesGet("output_indices","i")}  % input_dim_i;\n\n        ${u.indicesSet("input_indices","i","input_dim_value")}\n      }\n      ${l.setByOffset("global_idx",u.getByIndices("input_indices"))}\n    }`;return{name:"Tile",shaderCache:{hint:`${r}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(n/64)},programUniforms:[{type:"uint32",data:n},...F(e[0].dims),...F(o)]}),getShaderSource:a}},Iu=e=>{jc(e.inputs),e.compute(Kc(e.inputs),{inputs:[0]})}});var Yc,Zc,Tu,Eu=q(()=>{"use strict";Ve();$e();we();Yc=(e,t,r,o,n)=>{let s=j("output_data",n,r.length,4),u=M("a_data",t[1].dataType,t[1].dims.length,4),l=M("b_data",t[2].dataType,t[2].dims.length,4),a=M("c_data",t[0].dataType,t[0].dims.length,4),p,h=(g,w,v)=>`select(${w}, ${g}, ${v})`;if(!o)p=s.setByOffset("global_idx",h(u.getByOffset("global_idx"),l.getByOffset("global_idx"),a.getByOffset("global_idx")));else{let g=(w,v,y="")=>{let _=`a_data[index_a${v}][component_a${v}]`,A=`b_data[index_b${v}][component_b${v}]`,S=`bool(c_data[index_c${v}] & ${4278190080>>>(3-v)*8}u)`;return`\n            let output_indices${v} = ${s.offsetToIndices(`global_idx * 4u + ${v}u`)};\n            let offset_a${v} = ${u.broadcastedIndicesToOffset(`output_indices${v}`,s)};\n            let offset_b${v} = ${l.broadcastedIndicesToOffset(`output_indices${v}`,s)};\n            let offset_c${v} = ${a.broadcastedIndicesToOffset(`output_indices${v}`,s)};\n            let index_a${v} = offset_a${v} / 4u;\n            let index_b${v} = offset_b${v} / 4u;\n            let index_c${v} = offset_c${v} / 4u;\n            let component_a${v} = offset_a${v} % 4u;\n            let component_b${v} = offset_b${v} % 4u;\n            ${w}[${v}] = ${y}(${h(_,A,S)});\n          `};n===9?p=`\n            var data = vec4<u32>(0);\n            ${g("data",0,"u32")}\n            ${g("data",1,"u32")}\n            ${g("data",2,"u32")}\n            ${g("data",3,"u32")}\n            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:p=`\n            ${g("output_data[global_idx]",0)}\n            ${g("output_data[global_idx]",1)}\n            ${g("output_data[global_idx]",2)}\n            ${g("output_data[global_idx]",3)}\n          `}return`\n        ${e.registerUniform("vec_size","u32").declareVariables(a,u,l,s)}\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${p}\n      }`},Zc=e=>{let t=e[1].dims,r=e[2].dims,o=e[0].dims,n=e[1].dataType,s=!(z.areEqual(t,r)&&z.areEqual(r,o)),u=t,l=z.size(t);if(s){let p=dt.calcShape(dt.calcShape(t,r,!1),o,!1);if(!p)throw new Error("Can\'t perform where op on the given tensors");u=p,l=z.size(u)}let a=Math.ceil(l/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:p=>Yc(p,e,u,s,n),getRunData:()=>({outputs:[{dims:u,dataType:n}],dispatchGroup:{x:Math.ceil(l/64/4)},programUniforms:[{type:"uint32",data:a},...F(o),...F(t),...F(r),...F(u)]})}},Tu=e=>{e.compute(Zc(e.inputs))}});var Ou,Pu=q(()=>{"use strict";ei();Jn();ni();ai();zi();Yi();Qi();ro();ps();hs();vs();xs();Is();Es();Bs();Rs();Ms();oo();Ns();Gs();au();su();tn();cu();fu();bu();$u();_u();Au();tr();Qn();Eu();Ou=new Map([["Abs",[ii]],["Acos",[si]],["Acosh",[ui]],["Add",[Vi]],["ArgMax",[Xa,Zn]],["ArgMin",[Qa,Zn]],["Asin",[di]],["Asinh",[li]],["Atan",[ci]],["Atanh",[pi]],["Attention",[ti]],["AveragePool",[Zs,Ys]],["BatchNormalization",[ri]],["BiasAdd",[oi]],["BiasSplitGelu",[Ui]],["Cast",[fi,mi]],["Ceil",[gi]],["Clip",[hi]],["Concat",[Zi,Ji]],["Conv",[io,ao]],["ConvTranspose",[cs,ls]],["Cos",[yi]],["Cosh",[bi]],["CumSum",[ms,fs]],["Div",[Ni]],["Einsum",[bs,ws]],["Elu",[wi,on]],["Equal",[Wi]],["Erf",[vi]],["Exp",[$i]],["Expand",[Ss]],["Floor",[Si]],["FusedConv",[io,ao]],["Gather",[Cs,_s]],["GatherElements",[Ts,As]],["Gelu",[xi]],["Gemm",[Ps,Os]],["GlobalAveragePool",[Xs,Qs]],["GlobalMaxPool",[ou,nu]],["Greater",[Fi]],["GreaterOrEqual",[qi]],["InstanceNormalization",[ks]],["LayerNormalization",[Ds]],["LeakyRelu",[_i,on]],["Less",[ji]],["LessOrEqual",[Ki]],["Log",[Mi]],["MatMul",[ns]],["MaxPool",[tu,ru]],["Mul",[Gi]],["MultiHeadAttention",[Vs,zs]],["Neg",[Ii]],["Not",[Ci]],["Pad",[Ws]],["Pow",[Hi]],["Range",[iu]],["Reciprocal",[Ai]],["ReduceMin",[ja]],["ReduceMean",[Wa]],["ReduceMax",[Fa]],["ReduceSum",[Ka]],["ReduceProd",[qa]],["ReduceL1",[Ga]],["ReduceL2",[Ha]],["ReduceLogSum",[Za]],["ReduceLogSumExp",[La]],["ReduceSumSquare",[Ya]],["Relu",[Ti]],["Resize",[du,lu]],["Sigmoid",[Ei]],["Sin",[Oi]],["Sinh",[Pi]],["Slice",[gu,yu]],["SkipLayerNormalization",[pu,mu]],["Split",[Su,xu]],["Sqrt",[Bi]],["Softmax",[wu,vu]],["Sub",[Li]],["Tan",[ki]],["Tanh",[Ri]],["ThresholdedRelu",[Di,on]],["Tile",[Iu]],["Transpose",[Ta,Ea]],["Where",[Tu]]])});var hn,Bu=q(()=>{"use strict";Xt();At();we();hn=class{constructor(t){this.backend=t;this.repo=new Map,this.attributesBound=!1}getArtifact(t){return this.repo.get(t)}setArtifact(t,r){this.repo.set(t,r)}run(t,r,o){Mt(t.programInfo.name);let n=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2),n.setPipeline(t.computePipeline),n.setBindGroup(0,r),n.dispatchWorkgroups(...o),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),Ut(t.programInfo.name)}dispose(){}build(t,r){Mt(t.name);let o=this.backend.device,n=[];o.features.has("shader-f16")&&n.push("enable f16;");let s=Ia(r),u=t.getShaderSource(s),l=`${n.join(`\n`)}\n${s.additionalImplementations}\n${u}`,a=o.createShaderModule({code:l,label:t.name});Me("verbose",()=>`[WebGPU] ${t.name} shader code: ${l}`);let p=o.createComputePipeline({compute:{module:a,entryPoint:"main"},layout:"auto",label:t.name});return Ut(t.name),{programInfo:t,computePipeline:p}}normalizeDispatchGroupSize(t){let r=typeof t=="number"?t:t.x,o=typeof t=="number"?1:t.y||1,n=typeof t=="number"?1:t.z||1,s=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(r<=s&&o<=s&&n<=s)return[r,o,n];let u=r*o*n,l=Math.ceil(Math.sqrt(u));if(l>s){if(l=Math.ceil(Math.cbrt(u)),l>s)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[l,l,l]}else return[l,l,1]}}});var Jc,Qc,gn,ku=q(()=>{"use strict";Xt();Ve();At();$a();Ca();Pu();Bu();Jc=(e,t)=>{if(t.length!==e.length)throw new Error(`inputDependencies length ${t.length} is not equal to inputTensors length ${e.length}.`);let r=[];for(let o=0;o<e.length;++o){let n=e[o].dataType;switch(t[o]){case"none":{r.push("");break}case"type":{r.push(`${n}`);break}case"rank":{let s=e[o].dims.length;r.push(`${n};${s}`);break}case"dims":{let s=e[o].dims.join(",");r.push(`${n};${s}`);break}default:throw new Error(`unsupported input dependency: ${t[o]}`)}}return r.join("|")},Qc=(e,t,r)=>{let o=e.name;return e.shaderCache?.hint&&(o+="["+e.shaderCache.hint+"]"),o+=":"+r+`:${Jc(t,e.shaderCache?.inputDependencies??new Array(t.length).fill("dims"))}`,o},gn=class{constructor(){this.currentKernelId=null;this.commandEncoder=null;this.computePassEncoder=null;this.maxDispatchNumber=32;this.pendingDispatchNumber=0;this.pendingKernels=[];this.pendingQueries=new Map;this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let t=this.kernelCustomData.get(this.currentKernelId);return t||(t={},this.kernelCustomData.set(this.currentKernelId,t)),t}async initialize(t,r){this.env=t;let o=[],n={requiredLimits:{maxComputeWorkgroupStorageSize:r.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:r.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:r.limits.maxStorageBufferBindingSize,maxBufferSize:r.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:r.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:r.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:r.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:r.limits.maxComputeWorkgroupSizeZ},requiredFeatures:o};r.features.has("chromium-experimental-timestamp-query-inside-passes")?o.push("chromium-experimental-timestamp-query-inside-passes"):r.features.has("timestamp-query")&&o.push("timestamp-query"),r.features.has("shader-f16")&&o.push("shader-f16"),this.device=await r.requestDevice(n),this.gpuDataManager=_a(this),this.programManager=new hn(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,this.kernelUniformCache=new Map,this.kernelGpuBindGroupCache=new Map,wa(t.logLevel,!!t.debug),this.device.onuncapturederror=s=>{s.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${s.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder(),this.setQueryType(),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE}))),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let t={};this.queryType==="at-passes"&&(t.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=this.getCommandEncoder().beginComputePass(t)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;Mt(),this.endComputePass();let t;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),t=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(t,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,t,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&t.mapAsync(GPUMapMode.READ).then(()=>{let r=new BigUint64Array(t.getMappedRange()),o=this.pendingQueries.get(t);for(let n=0;n<r.length/2;n++){let s=o[n],u=s.kernelId,l=this.kernels.get(u),a=l.kernelType,p=l.kernelName,h=s.programName,g=s.inputTensorViews,w=s.outputTensorViews,v=r[n*2],y=r[n*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=v);let _=Number(v-this.queryTimeBase),A=Number(y-this.queryTimeBase);if(!Number.isSafeInteger(_)||!Number.isSafeInteger(A))throw new RangeError("incorrect timestamp range");if(this.env.webgpu.profiling?.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:g.map(S=>({dims:S.dims,dataType:et(S.dataType)})),outputsMetadata:w.map(S=>({dims:S.dims,dataType:et(S.dataType)})),kernelId:u,kernelType:a,kernelName:p,programName:h,startTime:_,endTime:A});else{let S="";g.forEach((P,C)=>{S+=`input[${C}]: [${P.dims}] | ${et(P.dataType)}, `});let I="";w.forEach((P,C)=>{I+=`output[${C}]: [${P.dims}] | ${et(P.dataType)}, `}),console.log(`[profiling] kernel "${u}|${a}|${p}|${h}" ${S}${I}execution time: ${A-_} ns`)}Vn("GPU",`${h}::${v}::${y}`)}t.unmap(),this.pendingQueries.delete(t)}),Ut()}run(t,r,o,n,s){Mt(t.name);let u=[];for(let C=0;C<r.length;++C){let V=this.gpuDataManager.get(r[C].data);if(!V)throw new Error(`no GPU data for input: ${r[C].data}`);u[C]=V}let{outputs:l,dispatchGroup:a,programUniforms:p}=t.getRunData(r),h=o.length===0?l.map((C,V)=>V):o;if(h.length!==l.length)throw new Error(`Output size ${h.length} must be equal to ${l.length}.`);let g=[],w=[];for(let C=0;C<l.length;++C){if(!Number.isInteger(h[C])||h[C]<-3||h[C]>=l.length)throw new Error(`Invalid output index: ${h[C]}`);if(h[C]===-3)continue;let V=h[C]===-1,D=h[C]===-2,G=V||D?s(l[C].dataType,l[C].dims):n(h[C],l[C].dataType,l[C].dims),T=this.gpuDataManager.get(G.data);if(!T)throw new Error(`no GPU data for output: ${G.data}`);if(V&&this.temporaryData.push(T),D){let W=this.kernelPersistentData.get(this.currentKernelId);W||(W=[],this.kernelPersistentData.set(this.currentKernelId,W)),W.push(T)}g.push(G),w.push(T)}let v;if(p){let C=this.kernelUniformCache.get(this.currentKernelId);C&&(this.compareProgramUniforms(C.programUniforms,p)||(this.gpuDataManager.release(C.gpuData.id),C=void 0)),C||(C=this.createCachedUniform(p),this.kernelUniformCache.set(this.currentKernelId,C)),v=C.binding}let y=this.programManager.normalizeDispatchGroupSize(a),_=y[1]===1&&y[2]===1,A=Qc(t,r,_),S=this.programManager.getArtifact(A);if(S||(S=this.programManager.build(t,y),this.programManager.setArtifact(A,S),Me("info",()=>`[artifact] key: ${A}, programName: ${t.name}`)),Me("info",()=>`[ProgramManager] run "${t.name}" (key=${A}) with ${y[0]}x${y[1]}x${y[2]}`),this.queryType!=="none"){let C={kernelId:this.currentKernelId,programName:S.programInfo.name,inputTensorViews:r,outputTensorViews:g};this.pendingKernels.push(C)}let I=this.kernelGpuBindGroupCache.get(this.currentKernelId);I||(I=[],this.kernelGpuBindGroupCache.set(this.currentKernelId,I));let P;for(let C of I)if(this.checkCachedBindGroup(C,S,u,w,v)){P=C;break}if(!P)for(P=this.createCachedBindGroup(S,u,w,v),I.push(P);I.length>20;)I.shift();return this.programManager.run(S,P.binding,y),Ut(t.name),g}compareProgramUniforms(t,r){return t.length!==r.length?!1:t.every((n,s)=>n.type===r[s].type)}createCachedUniform(t){let r=0,o=[];t.forEach(a=>{let p=typeof a.data=="number"?[a.data]:a.data;if(p.length===0)return;let h=p.length<=2?p.length*4:16;r=Math.ceil(r/h)*h,o.push(r),r+=p.length>4?Math.ceil(p.length/4)*16:p.length*4});let n=16;r=Math.ceil(r/n)*n;let s=new ArrayBuffer(r);t.forEach((a,p)=>{let h=o[p],g=typeof a.data=="number"?[a.data]:a.data;a.type==="int32"?new Int32Array(s,h,g.length).set(g):a.type==="uint32"?new Uint32Array(s,h,g.length).set(g):new Float32Array(s,h,g.length).set(g)});let u=this.gpuDataManager.create(r,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(u.buffer,0,s,0,r);let l={offset:0,size:r,buffer:u.buffer};return{programUniforms:t,binding:l,gpuData:u}}checkCachedBindGroup(t,r,o,n,s){if(r!==t.artifact)return!1;let u=o.every((p,h)=>p.permamentID===t.inputPermamentIDs[h]),l=n.every((p,h)=>p.permamentID===t.outputPermamentIDs[h]),a=s===t.uniformBinding;return u&&l&&a}createCachedBindGroup(t,r,o,n){let s=[];for(let l of r)s.push({binding:s.length,resource:{buffer:l.buffer}});for(let l of o)s.push({binding:s.length,resource:{buffer:l.buffer}});return n&&s.push({binding:s.length,resource:n}),{binding:this.device.createBindGroup({layout:t.computePipeline.getBindGroupLayout(0),entries:s,label:t.programInfo.name}),artifact:t,inputPermamentIDs:r.map(l=>l.permamentID),outputPermamentIDs:o.map(l=>l.permamentID),uniformBinding:n}}upload(t,r){this.gpuDataManager.upload(t,r)}memcpy(t,r){this.gpuDataManager.memcpy(t,r)}async download(t,r){await this.gpuDataManager.download(t,r)}alloc(t){return this.gpuDataManager.create(t).id}free(t){return this.gpuDataManager.release(t)}createKernel(t,r,o,n){let s=Ou.get(t);if(!s)throw new Error(`kernel not implemented: ${t}`);let u={kernelType:t,kernelName:n,kernelEntry:s[0],attributes:[s[1],o]};this.kernels.set(r,u)}releaseKernel(t){let r=this.kernelPersistentData.get(t);if(r){for(let n of r)this.gpuDataManager.release(n.id);this.kernelPersistentData.delete(t)}this.kernelCustomData.delete(t),this.kernelGpuBindGroupCache.delete(t);let o=this.kernelUniformCache.get(t);console.log("Release kernelId: ",t," has cached: ",o),o&&(this.gpuDataManager.release(o.gpuData.id),this.kernelUniformCache.delete(t)),this.kernels.delete(t)}computeKernel(t,r,o){let n=this.kernels.get(t);if(!n)throw new Error(`kernel not created: ${t}`);let s=n.kernelType,u=n.kernelName,l=n.kernelEntry,a=n.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${s}] ${u}" is not allowed to be called recursively`);this.currentKernelId=t,a[0]&&(a[1]=a[0](a[1]),a[0]=void 0),Me("info",()=>`[WebGPU] Start to run kernel "[${s}] ${u}"...`);let p=this.env.debug;this.temporaryData=[];try{return p&&this.device.pushErrorScope("validation"),l(r,a[1]),0}catch(h){return o.push(Promise.resolve(`[WebGPU] Kernel "[${s}] ${u}" failed. ${h}`)),1}finally{p&&o.push(this.device.popErrorScope().then(h=>h?`GPU validation error for kernel "[${s}] ${u}": ${h.message}`:null));for(let h of this.temporaryData)this.gpuDataManager.release(h.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(t,r,o,n){let s=this.sessionExternalDataMapping.get(t);s||(s=new Map,this.sessionExternalDataMapping.set(t,s));let u=s.get(r),l=this.gpuDataManager.registerExternalBuffer(o,n,u?.[1]);return s.set(r,[l,o]),l}unregisterBuffers(t){let r=this.sessionExternalDataMapping.get(t);r&&(r.forEach(o=>this.gpuDataManager.unregisterExternalBuffer(o[1])),this.sessionExternalDataMapping.delete(t))}getBuffer(t){let r=this.gpuDataManager.get(t);if(!r)throw new Error(`no GPU data for buffer: ${t}`);return r.buffer}createDownloader(t,r,o){return async()=>{let n=await Hn(this,t,r);return va(n.buffer,o)}}writeTimestamp(t){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,t)}setQueryType(){this.queryType="none",(this.env.webgpu.profiling?.mode==="default"||this.env.wasm.trace)&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"))}}});var Ru={};vr(Ru,{init:()=>Xc});var Ar,mo,Xc,Du=q(()=>{"use strict";Ve();ku();At();$e();Ar=class e{constructor(t,r,o,n){this.module=t;this.dataType=r;this.data=o;this.dims=n}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let t=z.size(this.dims);return t===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,t)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let t=z.size(this.dims);return t===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,t)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let t=z.size(this.dims);return t===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,t)}reshape(t){if(z.size(t)!==z.size(this.dims))throw new Error("Invalid new shape");return new e(this.module,this.dataType,this.data,t)}},mo=class{constructor(t,r,o){this.module=t;this.backend=r;this.customDataOffset=0;this.customDataSize=0;let n=t.HEAPU32,s=o>>>2;this.opKernelContext=n[s++];let u=n[s++];this.outputCount=n[s++],this.customDataOffset=n[s++],this.customDataSize=n[s++];let l=[];for(let a=0;a<u;a++){let p=n[s++],h=n[s++],g=n[s++],w=[];for(let v=0;v<g;v++)w.push(n[s++]);l.push(new Ar(t,p,h,w))}this.inputs=l}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(t,r){let o=r?.inputs?.map(l=>typeof l=="number"?this.inputs[l]:l)??this.inputs,n=r?.outputs??[],s=(l,a,p)=>new Ar(this.module,a,this.output(l,p),p),u=(l,a)=>{let p=Sr(l);if(!p)throw new Error(`Unsupported data type: ${l}`);let h=p*z.size(a);return new Ar(this.module,l,this.backend.gpuDataManager.create(h).id,a)};return this.backend.run(t,o,n,s,u)}output(t,r){let o=this.module.stackSave();try{let n=this.module.stackAlloc((1+r.length)*4),s=n>>2;this.module.HEAPU32[s++]=r.length;for(let u=0;u<r.length;u++)this.module.HEAPU32[s++]=r[u];return this.module._JsepOutput(this.opKernelContext,t,n)}catch(n){throw new Error(`Failed to generate kernel\'s output[${t}] with dims [${r}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${n}`)}finally{this.module.stackRestore(o)}}},Xc=async(e,t,r)=>{let o=e.jsepInit;if(!o)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");let n=new gn;await n.initialize(t,r),o(n,s=>n.alloc(s),s=>n.free(s),(s,u,l,a=!1)=>{if(a)Me("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${s}, dst=${u}, size=${l}`),n.memcpy(s,u);else{Me("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${s}, gpuDataId=${u}, size=${l}`);let p=e.HEAPU8.subarray(s>>>0,(s>>>0)+l);n.upload(u,p)}},async(s,u,l)=>{Me("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${s}, dataOffset=${u}, size=${l}`),await n.download(s,()=>e.HEAPU8.subarray(u>>>0,(u>>>0)+l))},(s,u,l)=>n.createKernel(s,u,l,e.UTF8ToString(e._JsepGetNodeName(u))),s=>n.releaseKernel(s),(s,u,l,a)=>{Me("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${l}, kernel=${s}, contextDataOffset=${u}`);let p=new mo(e,n,u);return n.computeKernel(s,p,a)})}});var Yo;Yo=Vo();var pd=jo(),Rn,Dn=!1,Lr=!1,Ko=!1,md=e=>{if(e===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},fd=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},hd=(e,t)=>e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Zo=async e=>{if(Dn)return Promise.resolve();if(Lr)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(Ko)throw new Error("previous call to \'initializeWebAssembly()\' failed.");Lr=!0;let t=e.initTimeout,r=e.numThreads,o=e.simd,n=md(r),s=o&&fd(),u=e.wasmPaths,l=typeof u=="string"?u:void 0,a=hd(s,n),p=typeof u=="object"?u[a]:void 0,h=!1,g=[];if(t>0&&g.push(new Promise(w=>{setTimeout(()=>{h=!0,w()},t)})),g.push(new Promise((w,v)=>{let y=n?pd:Yo,_={locateFile:(A,S)=>{if(n&&A.endsWith(".worker.js")&&typeof Blob<"u")return URL.createObjectURL(new Blob([qo()],{type:"text/javascript"}));if(A.endsWith(".wasm")){if(p)return p;let I=l??S;return a==="ort-wasm-simd.wasm"?I+"ort-wasm-simd.jsep.wasm":a==="ort-wasm-simd-threaded.wasm"?I+"ort-wasm-simd-threaded.jsep.wasm":I+a}return S+A}};if(n)if(_.numThreads=r,typeof Blob>"u")_.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let A=`var ortWasmThreaded=${y.toString()};`;_.mainScriptUrlOrBlob=new Blob([A],{type:"text/javascript"})}y(_).then(A=>{Lr=!1,Dn=!0,Rn=A,w()},A=>{Lr=!1,Ko=!0,v(A)})})),await Promise.race(g),h)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},De=()=>{if(Dn&&Rn)return Rn;throw new Error("WebAssembly is not initialized yet.")};var We=(e,t)=>{let r=De(),o=r.lengthBytesUTF8(e)+1,n=r._malloc(o);return r.stringToUTF8(e,n,o),t.push(n),n},$r=(e,t,r,o)=>{if(typeof e=="object"&&e!==null){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach(([n,s])=>{let u=t?t+n:n;if(typeof s=="object")$r(s,u+".",r,o);else if(typeof s=="string"||typeof s=="number")o(u,s.toString());else if(typeof s=="boolean")o(u,s?"1":"0");else throw new Error(`Can\'t handle extra config type: ${typeof s}`)})},ke=e=>{let t=De(),r=t.stackSave();try{let o=t.stackAlloc(8);t._OrtGetLastError(o,o+4);let n=t.HEAP32[o/4],s=t.HEAPU32[o/4+1],u=s?t.UTF8ToString(s):"";throw new Error(`${e} ERROR_CODE: ${n}, ERROR_MESSAGE: ${u}`)}finally{t.stackRestore(r)}};var Jo=e=>{let t=De(),r=0,o=[],n=e||{};try{if(e?.logSeverityLevel===void 0)n.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(e?.logVerbosityLevel===void 0)n.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);e?.terminate===void 0&&(n.terminate=!1);let s=0;return e?.tag!==void 0&&(s=We(e.tag,o)),r=t._OrtCreateRunOptions(n.logSeverityLevel,n.logVerbosityLevel,!!n.terminate,s),r===0&&ke("Can\'t create run options."),e?.extra!==void 0&&$r(e.extra,"",new WeakSet,(u,l)=>{let a=We(u,o),p=We(l,o);t._OrtAddRunConfigEntry(r,a,p)!==0&&ke(`Can\'t set a run config entry: ${u} - ${l}.`)}),[r,o]}catch(s){throw r!==0&&t._OrtReleaseRunOptions(r),o.forEach(u=>t._free(u)),s}};var gd=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},yd=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},bd=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(r=>(typeof r=="string"?r:r.name)==="webgpu")&&(e.enableMemPattern=!1)},wd=(e,t,r)=>{for(let o of t){let n=typeof o=="string"?o:o.name;switch(n){case"webnn":if(n="WEBNN",typeof o!="string"){let u=o;if(u?.deviceType){let l=We("deviceType",r),a=We(u.deviceType,r);De()._OrtAddSessionConfigEntry(e,l,a)!==0&&ke(`Can\'t set a session config entry: \'deviceType\' - ${u.deviceType}.`)}if(u?.numThreads){let l=u.numThreads;(typeof l!="number"||!Number.isInteger(l)||l<0)&&(l=0);let a=We("numThreads",r),p=We(l.toString(),r);De()._OrtAddSessionConfigEntry(e,a,p)!==0&&ke(`Can\'t set a session config entry: \'numThreads\' - ${u.numThreads}.`)}if(u?.powerPreference){let l=We("powerPreference",r),a=We(u.powerPreference,r);De()._OrtAddSessionConfigEntry(e,l,a)!==0&&ke(`Can\'t set a session config entry: \'powerPreference\' - ${u.powerPreference}.`)}}break;case"webgpu":if(n="JS",typeof o!="string"){let u=o;if(u?.preferredLayout){if(u.preferredLayout!=="NCHW"&&u.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either \'NCHW\' or \'NHWC\': ${u.preferredLayout}`);let l=We("preferredLayout",r),a=We(u.preferredLayout,r);De()._OrtAddSessionConfigEntry(e,l,a)!==0&&ke(`Can\'t set a session config entry: \'preferredLayout\' - ${u.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${n}`)}let s=We(n,r);De()._OrtAppendExecutionProvider(e,s)!==0&&ke(`Can\'t append execution provider: ${n}.`)}},Qo=e=>{let t=De(),r=0,o=[],n=e||{};bd(n);try{let s=gd(n.graphOptimizationLevel??"all"),u=yd(n.executionMode??"sequential"),l=typeof n.logId=="string"?We(n.logId,o):0,a=n.logSeverityLevel??2;if(!Number.isInteger(a)||a<0||a>4)throw new Error(`log serverity level is not valid: ${a}`);let p=n.logVerbosityLevel??0;if(!Number.isInteger(p)||p<0||p>4)throw new Error(`log verbosity level is not valid: ${p}`);let h=typeof n.optimizedModelFilePath=="string"?We(n.optimizedModelFilePath,o):0;if(r=t._OrtCreateSessionOptions(s,!!n.enableCpuMemArena,!!n.enableMemPattern,u,!!n.enableProfiling,0,l,a,p,h),r===0&&ke("Can\'t create session options."),n.executionProviders&&wd(r,n.executionProviders,o),n.freeDimensionOverrides)for(let[g,w]of Object.entries(n.freeDimensionOverrides)){if(typeof g!="string")throw new Error(`free dimension override name must be a string: ${g}`);if(typeof w!="number"||!Number.isInteger(w)||w<0)throw new Error(`free dimension override value must be a non-negative integer: ${w}`);let v=We(g,o);t._OrtAddFreeDimensionOverride(r,v,w)!==0&&ke(`Can\'t set a free dimension override: ${g} - ${w}.`)}return n.extra!==void 0&&$r(n.extra,"",new WeakSet,(g,w)=>{let v=We(g,o),y=We(w,o);t._OrtAddSessionConfigEntry(r,v,y)!==0&&ke(`Can\'t set a session config entry: ${g} - ${w}.`)}),[r,o]}catch(s){throw r!==0&&t._OrtReleaseSessionOptions(r),o.forEach(u=>t._free(u)),s}};Ve();var ea=async e=>{if(typeof e=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(e))}catch(t){if(t.code==="ERR_FS_FILE_TOO_LARGE"){let r=(void 0)(e),o=[];for await(let n of r)o.push(n);return new Uint8Array(Buffer.concat(o))}throw t}else{let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let r=t.headers.get("Content-Length"),o=r?parseInt(r,10):0;if(o<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let n=t.body.getReader(),s;try{s=new ArrayBuffer(o)}catch(l){if(l instanceof RangeError){let a=Math.ceil(o/65536);s=new WebAssembly.Memory({initial:a,maximum:a}).buffer}else throw l}let u=0;for(;;){let{done:l,value:a}=await n.read();if(l)break;let p=a.byteLength;new Uint8Array(s,u,p).set(a),u+=p}return new Uint8Array(s,0,o)}}else return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)};var ep=(e,t)=>{De()._OrtInit(e,t)!==0&&ke("Can\'t initialize onnxruntime.")},Uu=async e=>{ep(e.wasm.numThreads,xr(e.logLevel))},zu=async(e,t)=>{if(t==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let r=await navigator.gpu.requestAdapter();if(!r)throw new Error(\'Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.\');if(!e.wasm.simd)throw new Error("Not supported for WebGPU=ON and SIMD=OFF. Please set `env.wasm.simd` to true when using `webgpu` EP");let o=(Du(),It(Ru)).init;await o(De(),e,r)}},Tr=new Map,tp=e=>{let t=De(),r=t.stackSave();try{let o=t.stackAlloc(8);return t._OrtGetInputOutputCount(e,o,o+4)!==0&&ke("Can\'t get session input/output count."),[t.HEAP32[o/4],t.HEAP32[o/4+1]]}finally{t.stackRestore(r)}},fo=e=>{let t=De(),r=t._malloc(e.byteLength);if(r===0)throw new Error(`Can\'t create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},Vu=async(e,t)=>{let r,o,n=De();Array.isArray(e)?[r,o]=e:e.buffer===n.HEAPU8.buffer?[r,o]=[e.byteOffset,e.byteLength]:[r,o]=fo(e);let s=0,u=0,l=0,a=[],p=[],h=[];try{if([u,a]=Qo(t),t?.externalData&&n.mountExternalData){let S=[];for(let I of t.externalData){let P=typeof I=="string"?I:I.path;S.push(ea(typeof I=="string"?I:I.data).then(C=>{n.mountExternalData(P,C)}))}await Promise.all(S)}s=n._OrtCreateSession(r,o,u),s===0&&ke("Can\'t create a session.");let[g,w]=tp(s),v=[],y=[],_=[];for(let S=0;S<g;S++){let I=n._OrtGetInputName(s,S);I===0&&ke("Can\'t get an input name."),p.push(I),v.push(n.UTF8ToString(I))}for(let S=0;S<w;S++){let I=n._OrtGetOutputName(s,S);I===0&&ke("Can\'t get an output name."),h.push(I);let P=n.UTF8ToString(I);y.push(P);{let C=typeof t?.preferredOutputLocation=="string"?t.preferredOutputLocation:t?.preferredOutputLocation?.[P]??"cpu";if(C!=="cpu"&&C!=="cpu-pinned"&&C!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${C}.`);_.push(C)}}let A=null;return _.some(S=>S==="gpu-buffer")&&(l=n._OrtCreateBinding(s),l===0&&ke("Can\'t create IO binding."),A={handle:l,outputPreferredLocations:_,outputPreferredLocationsEncoded:_.map(S=>Un(S))}),Tr.set(s,[s,p,h,A]),[s,v,y]}catch(g){throw p.forEach(w=>n._OrtFree(w)),h.forEach(w=>n._OrtFree(w)),l!==0&&n._OrtReleaseBinding(l),s!==0&&n._OrtReleaseSession(s),g}finally{n._free(r),u!==0&&n._OrtReleaseSessionOptions(u),a.forEach(g=>n._free(g)),n.unmountExternalData?.()}},Nu=e=>{let t=De(),r=Tr.get(e);if(!r)throw new Error(`cannot release session. invalid session id: ${e}`);let[o,n,s,u]=r;u&&t._OrtReleaseBinding(u.handle),t.jsepUnregisterBuffers?.(e),n.forEach(l=>t._OrtFree(l)),s.forEach(l=>t._OrtFree(l)),t._OrtReleaseSession(o),Tr.delete(e)},rp=(e,t,r)=>{if(e!==null&&e[0]===t){let n=e[2];if(n.length===r)return n}let o=Fr(t);return new o(r)},Mu=(e,t,r,o,n)=>{if(!e){t.push(0);return}let s=De(),u=e[0],l=e[1],a=e[3],p,h;if(u==="string"&&a==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(a==="gpu-buffer"){let v=e[2].gpuBuffer,y=Sr(Mn(u));h=l.reduce((_,A)=>_*A,1)*y,p=s.jsepRegisterBuffer(o,n,v,h)}else{let v=e[2];if(Array.isArray(v)){h=4*v.length,p=s._malloc(h),r.push(p);let y=p/4;for(let _=0;_<v.length;_++){if(typeof v[_]!="string")throw new TypeError(`tensor data at index ${_} is not a string`);s.HEAPU32[y++]=We(v[_],r)}}else h=v.byteLength,p=s._malloc(h),r.push(p),s.HEAPU8.set(new Uint8Array(v.buffer,v.byteOffset,h),p)}let g=s.stackSave(),w=s.stackAlloc(4*l.length);try{let v=w/4;l.forEach(_=>s.HEAP32[v++]=_);let y=s._OrtCreateTensor(Mn(u),p,h,w,l.length,Un(a));y===0&&ke(`Can\'t create tensor for input/output. session=${o}, index=${n}.`),t.push(y)}finally{s.stackRestore(g)}},Wu=e=>{let r=new TextEncoder().encode(e),o=De(),n=o._malloc(r.byteLength);o.HEAPU8.set(r,n);let s=o._OrtConfigure(n,r.byteLength);if(s===0)throw new Error("Can\'t get an configure key");let u=o.UTF8ToString(s);return o._OrtFree(s),u},Gu=e=>{let r=new TextEncoder().encode(e),o=De(),n=o._malloc(r.byteLength);o.HEAPU8.set(r,n);let s=o._OrtAuth(n,r.byteLength);if(s===0)throw new Error("Can\'t get an auth result");let u=o.UTF8ToString(s);return o._OrtFree(s),u},Hu=async(e,t,r,o,n,s)=>{let u=De(),l=Tr.get(e);if(!l)throw new Error(`cannot run inference. invalid session id: ${e}`);let[a,p,h,g]=l,w=t.length,v=o.length,y=0,_=[],A=[],S=[],I=[],P=u.stackSave(),C=u.stackAlloc(w*4),V=u.stackAlloc(w*4),D=u.stackAlloc(v*4),G=u.stackAlloc(v*4);try{[y,_]=Jo(s);for(let J=0;J<w;J++)Mu(r[J],A,I,e,t[J]);for(let J=0;J<v;J++){let Ae=n[J],Oe=Ae?.[3]??"";Mu(Oe==="gpu-buffer"?Ae:null,S,I,e,w+o[J])}let T=C/4,W=V/4,pe=D/4,Z=G/4;for(let J=0;J<w;J++)u.HEAPU32[T++]=A[J],u.HEAPU32[W++]=p[t[J]];for(let J=0;J<v;J++)u.HEAPU32[pe++]=S[J],u.HEAPU32[Z++]=h[o[J]];if(g){let{handle:J,outputPreferredLocations:Ae,outputPreferredLocationsEncoded:Oe}=g;if(p.length!==w)throw new Error(`input count from feeds (${w}) is expected to be always equal to model\'s input count (${p.length}).`);for(let fe=0;fe<w;fe++){let Ce=t[fe];await u._OrtBindInput(J,p[Ce],A[fe])!==0&&ke(`Can\'t bind input[${fe}] for session=${e}.`)}for(let fe=0;fe<v;fe++){let Ce=o[fe];n[fe]?.[3]?u._OrtBindOutput(J,h[Ce],S[fe],0)!==0&&ke(`Can\'t bind pre-allocated output[${fe}] for session=${e}.`):u._OrtBindOutput(J,h[Ce],0,Oe[Ce])!==0&&ke(`Can\'t bind output[${fe}] to ${Ae[fe]} for session=${e}.`)}}let K;g?K=await u._OrtRunWithBinding(a,g.handle,v,D,y):K=await u._OrtRun(a,V,C,w,G,v,D,y),K!==0&&ke("failed to call OrtRun().");let X=[];for(let J=0;J<v;J++){let Ae=u.HEAPU32[D/4+J];if(Ae===S[J]){X.push(n[J]);continue}let Oe=u.stackSave(),fe=u.stackAlloc(4*4),Ce=!1,he,ye=0;try{u._OrtGetTensorData(Ae,fe,fe+4,fe+8,fe+12)!==0&&ke(`Can\'t access output tensor data on index ${J}.`);let Ue=fe/4,Ge=u.HEAPU32[Ue++];ye=u.HEAPU32[Ue++];let H=u.HEAPU32[Ue++],re=u.HEAPU32[Ue++],be=[];for(let Be=0;Be<re;Be++)be.push(u.HEAPU32[H/4+Be]);u._OrtFree(H);let rt=be.reduce((Be,Ke)=>Be*Ke,1);he=et(Ge);let ze=g?.outputPreferredLocations[o[J]];if(he==="string"){if(ze==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let Be=[],Ke=ye/4;for(let St=0;St<rt;St++){let nt=u.HEAPU32[Ke++],Vt=St===rt-1?void 0:u.HEAPU32[Ke]-nt;Be.push(u.UTF8ToString(nt,Vt))}X.push([he,be,Be,"cpu"])}else if(ze==="gpu-buffer"&&rt>0){let Be=u.jsepGetBuffer(ye),Ke=Sr(Ge);if(Ke===void 0||!Xo(he))throw new Error(`Unsupported data type: ${he}`);Ce=!0,X.push([he,be,{gpuBuffer:Be,download:u.jsepCreateDownloader(Be,rt*Ke,he),dispose:()=>{u._OrtReleaseTensor(Ae)}},"gpu-buffer"])}else{let Be=rp(n[J],he,rt);new Uint8Array(Be.buffer,Be.byteOffset,Be.byteLength).set(u.HEAPU8.subarray(ye,ye+Be.byteLength)),X.push([he,be,Be,"cpu"])}}finally{u.stackRestore(Oe),he==="string"&&ye&&u._free(ye),Ce||u._OrtReleaseTensor(Ae)}}return g&&u._OrtClearBoundOutputs(g.handle),X}finally{u.stackRestore(P),A.forEach(T=>u._OrtReleaseTensor(T)),S.forEach(T=>u._OrtReleaseTensor(T)),I.forEach(T=>u._free(T)),y!==0&&u._OrtReleaseRunOptions(y),_.forEach(T=>u._free(T))}},Lu=e=>{let t=De(),r=Tr.get(e);if(!r)throw new Error("invalid session id");let o=r[0],n=t._OrtEndProfiling(o);n===0&&ke("Can\'t get an profile file name."),t._OrtFree(n)},ho=e=>{let t=[];for(let r of e){let o=r[2];!Array.isArray(o)&&"buffer"in o&&t.push(o.buffer)}return t};self.onmessage=e=>{let{type:t,in:r}=e.data;try{switch(t){case"init-wasm":Zo(r.wasm).then(()=>{Uu(r).then(()=>{postMessage({type:t})},o=>{postMessage({type:t,err:o})})},o=>{postMessage({type:t,err:o})});break;case"init-ep":{let{epName:o,env:n}=r;zu(n,o).then(()=>{postMessage({type:t})},s=>{postMessage({type:t,err:s})});break}case"copy-from":{let{buffer:o}=r,n=fo(o);postMessage({type:t,out:n});break}case"create":{let{model:o,options:n}=r;Vu(o,n).then(s=>{postMessage({type:t,out:s})},s=>{postMessage({type:t,err:s})});break}case"release":Nu(r),postMessage({type:t});break;case"run":{let{sessionId:o,inputIndices:n,inputs:s,outputIndices:u,options:l}=r,a=e.data.prealloc??[];for(;a.length<u.length;)a.push(null);Hu(o,n,s,u,a,l).then(p=>{p.some(h=>h[3]!=="cpu")?postMessage({type:t,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:t,out:p,inputsBack:s},ho(p).concat(ho(s)))},p=>{postMessage({type:t,err:p})});break}case"configure":try{let o=Wu(e.data.in);postMessage({type:"configure",out:o})}catch(o){postMessage({type:"configure",err:o})}break;case"auth":try{let o=Gu(e.data.in);postMessage({type:"auth",out:o})}catch(o){postMessage({type:"auth",err:o})}break;case"end-profiling":Lu(r),postMessage({type:t});break;default:}}catch(o){postMessage({type:t,err:o})}};})();\n/**\n * @license\n * Copyright 2021 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n/**\n * @license\n * Copyright 2020 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n/**\n * @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n';}),Ot,it,Vr,zn,Nn,Ha,Vn,Ut,zt,lm,Un,dm,Pl,Rl,Dl,Ml,Ul,zl,Nl,Vl,Wl,La=q(function(){var _document2;dt(),kl(),dr(),Ot=function Ot(){return!!Se.wasm.proxy&&(typeof document==="undefined"?"undefined":_typeof2(document))<"u";},Vr=!1,zn=!1,Nn=!1,Vn=new Map(),Ut=function Ut(e,t){var r=Vn.get(e);r?r.push(t):Vn.set(e,[t]);},zt=function zt(){if(Vr||!zn||Nn||!it)throw new Error("worker not ready");},lm=function lm(e){switch(e.data.type){case"init-wasm":Vr=!1,e.data.err?(Nn=!0,Ha[1](e.data.err)):(zn=!0,Ha[0]());break;case"init-ep":case"copy-from":case"create":case"configure":case"auth":case"release":case"end-profiling":{var _t410=Vn.get(e.data.type);e.data.err?_t410.shift()[1](e.data.err):_t410.shift()[0](e.data.out);break;}case"run":{var _t411=Vn.get(e.data.type);e.data.err?_t411.shift()[1](e.data.err):_t411.shift()[0](e.data.out.concat(e.data.inputsBack));break;}}},Un=(typeof document==="undefined"?"undefined":_typeof2(document))<"u"?(_document2=document)===null||_document2===void 0||(_document2=_document2.currentScript)===null||_document2===void 0?void 0:_document2.src:void 0,dm=function dm(e){var t=[];for(var r=0;r<e.length;++r){var n=e[r];null!==n&&t.push(n);}return t;},Pl=/*#__PURE__*/function(){var _ref105=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee168(){return _regeneratorRuntime2().wrap(function _callee168$(_context174){while(1)switch(_context174.prev=_context174.next){case 0:if(zn){_context174.next=21;break;}if(!Vr){_context174.next=3;break;}throw new Error("multiple calls to 'initWasm()' detected.");case 3:if(!Nn){_context174.next=5;break;}throw new Error("previous call to 'initWasm()' failed.");case 5:if(!(Vr=!0,Ot())){_context174.next=7;break;}return _context174.abrupt("return",(void 0===Se.wasm.wasmPaths&&Un&&0!==Un.indexOf("blob:")&&(Se.wasm.wasmPaths=Un.substr(0,+Un.lastIndexOf("/")+1)),new Promise(function(e,t){var _it2;(_it2=it)===null||_it2===void 0||_it2.terminate();var r=URL.createObjectURL(new Blob([Bl()],{type:"text/javascript"}));(it=new Worker(r,{name:"ort-wasm-proxy-worker"})).onerror=function(e){return t(e);},it.onmessage=lm,URL.revokeObjectURL(r),Ha=[e,t];var n={type:"init-wasm","in":Se};it.postMessage(n);})));case 7:_context174.prev=7;_context174.next=10;return Xi(Se.wasm);case 10:_context174.next=12;return xl(Se);case 12:zn=!0;_context174.next=18;break;case 15:_context174.prev=15;_context174.t0=_context174["catch"](7);throw Nn=!0,_context174.t0;case 18:_context174.prev=18;Vr=!1;return _context174.finish(18);case 21:case"end":return _context174.stop();}},_callee168,null,[[7,15,18,21]]);}));return function Pl(){return _ref105.apply(this,arguments);};}(),Rl=/*#__PURE__*/function(){var _ref106=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee169(e){return _regeneratorRuntime2().wrap(function _callee169$(_context175){while(1)switch(_context175.prev=_context175.next){case 0:if(!Ot()){_context175.next=2;break;}return _context175.abrupt("return",(zt(),new Promise(function(t,r){Ut("init-ep",[t,r]);var n={type:"init-ep","in":{epName:e,env:Se}};it.postMessage(n);})));case 2:_context175.next=4;return Sl(Se,e);case 4:case"end":return _context175.stop();}},_callee169);}));return function Rl(_x207){return _ref106.apply(this,arguments);};}(),Dl=/*#__PURE__*/function(){var _ref107=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee170(e){return _regeneratorRuntime2().wrap(function _callee170$(_context176){while(1)switch(_context176.prev=_context176.next){case 0:return _context176.abrupt("return",Ot()?(zt(),new Promise(function(t,r){Ut("copy-from",[t,r]);var n={type:"copy-from","in":{buffer:e}};it.postMessage(n,[e.buffer]);})):Wa(e));case 1:case"end":return _context176.stop();}},_callee170);}));return function Dl(_x208){return _ref107.apply(this,arguments);};}(),Ml=/*#__PURE__*/function(){var _ref108=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee171(e,t){return _regeneratorRuntime2().wrap(function _callee171$(_context177){while(1)switch(_context177.prev=_context177.next){case 0:if(!Ot()){_context177.next=4;break;}if(!(t!==null&&t!==void 0&&t.preferredOutputLocation)){_context177.next=3;break;}throw new Error('session option "preferredOutputLocation" is not supported for proxy.');case 3:return _context177.abrupt("return",(zt(),new Promise(function(r,n){Ut("create",[r,n]);var i={type:"create","in":{model:e,options:t}},o=[];e instanceof Uint8Array&&o.push(e.buffer),it.postMessage(i,o);})));case 4:return _context177.abrupt("return",Il(e,t));case 5:case"end":return _context177.stop();}},_callee171);}));return function Ml(_x209,_x210){return _ref108.apply(this,arguments);};}(),Ul=/*#__PURE__*/function(){var _ref109=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee172(e){return _regeneratorRuntime2().wrap(function _callee172$(_context178){while(1)switch(_context178.prev=_context178.next){case 0:if(!Ot()){_context178.next=2;break;}return _context178.abrupt("return",(zt(),new Promise(function(t,r){Ut("release",[t,r]);var n={type:"release","in":e};it.postMessage(n);})));case 2:Cl(e);case 3:case"end":return _context178.stop();}},_callee172);}));return function Ul(_x211){return _ref109.apply(this,arguments);};}(),zl=/*#__PURE__*/function(){var _ref110=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee173(e){return _regeneratorRuntime2().wrap(function _callee173$(_context179){while(1)switch(_context179.prev=_context179.next){case 0:return _context179.abrupt("return",Ot()?(zt(),new Promise(function(t,r){Ut("configure",[t,r]);var n={type:"configure","in":e};it.postMessage(n);})):Al(e));case 1:case"end":return _context179.stop();}},_callee173);}));return function zl(_x212){return _ref110.apply(this,arguments);};}(),Nl=/*#__PURE__*/function(){var _ref111=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee174(e){return _regeneratorRuntime2().wrap(function _callee174$(_context180){while(1)switch(_context180.prev=_context180.next){case 0:return _context180.abrupt("return",Ot()?(zt(),new Promise(function(t,r){Ut("auth",[t,r]);var n={type:"auth","in":e};it.postMessage(n);})):Tl(e));case 1:case"end":return _context180.stop();}},_callee174);}));return function Nl(_x213){return _ref111.apply(this,arguments);};}(),Vl=/*#__PURE__*/function(){var _ref112=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee175(e,t,r,n,i,o){return _regeneratorRuntime2().wrap(function _callee175$(_context181){while(1)switch(_context181.prev=_context181.next){case 0:if(!Ot()){_context181.next=4;break;}if(!r.some(function(e){return"cpu"!==e[3];})){_context181.next=3;break;}throw new Error("input tensor on GPU is not supported for proxy.");case 3:return _context181.abrupt("return",(zt(),new Promise(function(a,s){Ut("run",[a,s]);var u=r,l={type:"run","in":{sessionId:e,inputIndices:t,inputs:u,outputIndices:n,options:o},prealloc:i};it.postMessage(l,Ga(u).concat(Ga(dm(i))));})));case 4:return _context181.abrupt("return",El(e,t,r,n,i,o).then(function(e){return e.concat(r);}));case 5:case"end":return _context181.stop();}},_callee175);}));return function Vl(_x214,_x215,_x216,_x217,_x218,_x219){return _ref112.apply(this,arguments);};}(),Wl=/*#__PURE__*/function(){var _ref113=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee176(e){return _regeneratorRuntime2().wrap(function _callee176$(_context182){while(1)switch(_context182.prev=_context182.next){case 0:if(!Ot()){_context182.next=2;break;}return _context182.abrupt("return",(zt(),new Promise(function(t,r){Ut("end-profiling",[t,r]);var n={type:"end-profiling","in":e};it.postMessage(n);})));case 2:Ol(e);case 3:case"end":return _context182.stop();}},_callee176);}));return function Wl(_x220){return _ref113.apply(this,arguments);};}();}),Gl,Hl,Wn,Ll=q(function(){dt(),La(),Ne(),fa(),Gl=function Gl(e,t){switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];default:throw new Error("invalid data location: ".concat(e.location," for ").concat(t()));}},Hl=function Hl(e){switch(e[3]){case"cpu":return new Xe(e[0],e[2],e[1]);case"gpu-buffer":{var _t412=e[0];if(!hn(_t412))throw new Error("not supported data type: ".concat(_t412," for deserializing GPU tensor"));var _e$2=e[2],r=_e$2.gpuBuffer,n=_e$2.download,i=_e$2.dispose;return Xe.fromGpuBuffer(r,{dataType:_t412,dims:e[1],download:n,dispose:i});}default:throw new Error("invalid data location: ".concat(e[3]));}},Wn=/*#__PURE__*/function(){function Wn(){_classCallCheck2(this,Wn);}return _createClass2(Wn,[{key:"fetchModelAndCopyToWasmMemory",value:function(){var _fetchModelAndCopyToWasmMemory2=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee177(e){return _regeneratorRuntime2().wrap(function _callee177$(_context183){while(1)switch(_context183.prev=_context183.next){case 0:_context183.t0=Dl;_context183.next=3;return Rr(e);case 3:_context183.t1=_context183.sent;return _context183.abrupt("return",(0,_context183.t0)(_context183.t1));case 5:case"end":return _context183.stop();}},_callee177);}));function fetchModelAndCopyToWasmMemory(_x221){return _fetchModelAndCopyToWasmMemory2.apply(this,arguments);}return fetchModelAndCopyToWasmMemory;}()},{key:"loadModel",value:function(){var _loadModel3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee178(e,t){var _yield$Ml,_yield$Ml2;var r;return _regeneratorRuntime2().wrap(function _callee178$(_context184){while(1)switch(_context184.prev=_context184.next){case 0:st();if(!("string"==typeof e)){_context184.next=14;break;}if(!(_typeof2(process)<"u"&&process.versions&&process.versions.node)){_context184.next=8;break;}_context184.next=5;return Rr(e);case 5:_context184.t1=_context184.sent;_context184.next=11;break;case 8:_context184.next=10;return this.fetchModelAndCopyToWasmMemory(e);case 10:_context184.t1=_context184.sent;case 11:_context184.t0=_context184.t1;_context184.next=15;break;case 14:_context184.t0=e;case 15:r=_context184.t0;_context184.next=18;return Ml(r,t);case 18:_yield$Ml=_context184.sent;_yield$Ml2=_slicedToArray2(_yield$Ml,3);this.sessionId=_yield$Ml2[0];this.inputNames=_yield$Ml2[1];this.outputNames=_yield$Ml2[2];ut();case 24:case"end":return _context184.stop();}},_callee178,this);}));function loadModel(_x222,_x223){return _loadModel3.apply(this,arguments);}return loadModel;}()},{key:"dispose",value:function(){var _dispose3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee179(){return _regeneratorRuntime2().wrap(function _callee179$(_context185){while(1)switch(_context185.prev=_context185.next){case 0:return _context185.abrupt("return",Ul(this.sessionId));case 1:case"end":return _context185.stop();}},_callee179,this);}));function dispose(){return _dispose3.apply(this,arguments);}return dispose;}()},{key:"configure",value:function(){var _configure5=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee180(e){return _regeneratorRuntime2().wrap(function _callee180$(_context186){while(1)switch(_context186.prev=_context186.next){case 0:return _context186.abrupt("return",zl(e));case 1:case"end":return _context186.stop();}},_callee180);}));function configure(_x224){return _configure5.apply(this,arguments);}return configure;}()},{key:"auth",value:function(){var _auth5=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee181(e){return _regeneratorRuntime2().wrap(function _callee181$(_context187){while(1)switch(_context187.prev=_context187.next){case 0:return _context187.abrupt("return",Nl(e));case 1:case"end":return _context187.stop();}},_callee181);}));function auth(_x225){return _auth5.apply(this,arguments);}return auth;}()},{key:"run",value:function(){var _run7=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee182(e,t,r){var _this157=this;var n,i,o,a,s,u,l,c,h,f,_e955,_s74;return _regeneratorRuntime2().wrap(function _callee182$(_context188){while(1)switch(_context188.prev=_context188.next){case 0:st();n=[],i=[];Object.entries(e).forEach(function(e){var t=e[0],r=e[1],o=_this157.inputNames.indexOf(t);if(-1===o)throw new Error("invalid input '".concat(t,"'"));n.push(r),i.push(o);});o=[],a=[],s=function s(e){return null!==e&&"gpu-buffer"===e.location?e:null;};Object.entries(t).forEach(function(e){var t=e[0],r=e[1],n=_this157.outputNames.indexOf(t);if(-1===n)throw new Error("invalid output '".concat(t,"'"));o.push(r),a.push(n);});u=n.map(function(e,t){return Gl(e,function(){return"input \"".concat(_this157.inputNames[i[t]],"\"");});});l=o.map(function(e,t){return e?Gl(e,function(){return"output \"".concat(_this157.outputNames[a[t]],"\"");}):null;});_context188.next=9;return Vl(this.sessionId,i,u,a,l,r);case 9:c=_context188.sent;h={};f=[];for(_e955=0;_e955<c.length;_e955++){_e955>=a.length?f.push(Hl(c[_e955])):h[this.outputNames[a[_e955]]]=(_s74=s(o[_e955]))!==null&&_s74!==void 0?_s74:Hl(c[_e955]);}return _context188.abrupt("return",(f.length>0&&(h.inputBack=f[0]),ut(),h));case 14:case"end":return _context188.stop();}},_callee182,this);}));function run(_x226,_x227,_x228){return _run7.apply(this,arguments);}return run;}()},{key:"startProfiling",value:function startProfiling(){}},{key:"endProfiling",value:function endProfiling(){Wl(this.sessionId);}}]);}();}),cm,Gn,Fl=q(function(){dt(),La(),Ll(),cm=function cm(){if(("number"!=typeof Se.wasm.initTimeout||Se.wasm.initTimeout<0)&&(Se.wasm.initTimeout=0),"boolean"!=typeof Se.wasm.simd&&(Se.wasm.simd=!0),"boolean"!=typeof Se.wasm.proxy&&(Se.wasm.proxy=!1),"boolean"!=typeof Se.wasm.trace&&(Se.wasm.trace=!1),"number"!=typeof Se.wasm.numThreads||!Number.isInteger(Se.wasm.numThreads)||Se.wasm.numThreads<=0){((typeof self==="undefined"?"undefined":_typeof2(self))<"u"&&!self.crossOriginIsolated||_typeof2(process)<"u"&&process.versions&&process.versions.node)&&(Se.wasm.numThreads=1);var _e956=(typeof navigator==="undefined"?"undefined":_typeof2(navigator))>"u"?(void 0)().length:navigator.hardwareConcurrency;Se.wasm.numThreads=Math.min(4,Math.ceil((_e956||1)/2));}},Gn=/*#__PURE__*/function(){function Gn(){_classCallCheck2(this,Gn);}return _createClass2(Gn,[{key:"init",value:function(){var _init4=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee183(e){return _regeneratorRuntime2().wrap(function _callee183$(_context189){while(1)switch(_context189.prev=_context189.next){case 0:cm();_context189.next=3;return Pl();case 3:_context189.next=5;return Rl(e);case 5:case"end":return _context189.stop();}},_callee183);}));function init(_x229){return _init4.apply(this,arguments);}return init;}()},{key:"createInferenceSessionHandler",value:function(){var _createInferenceSessionHandler3=_asyncToGenerator2(/*#__PURE__*/_regeneratorRuntime2().mark(function _callee184(e,t){var r;return _regeneratorRuntime2().wrap(function _callee184$(_context190){while(1)switch(_context190.prev=_context190.next){case 0:r=new Wn();_context190.next=3;return r.loadModel(e,t);case 3:return _context190.abrupt("return",Promise.resolve(r));case 4:case"end":return _context190.stop();}},_callee184);}));function createInferenceSessionHandler(_x230,_x231){return _createInferenceSessionHandler3.apply(this,arguments);}return createInferenceSessionHandler;}()}]);}();}),ql={};Ft(ql,{wasmBackend:function wasmBackend(){return pm;}});var pm,jl=q(function(){Fl(),pm=new Gn();});dt(),dt(),dt();var Mi="1.17.0",iv=null;{var _e957=(jl(),Et(ql)).wasmBackend;lr("webgpu",_e957,5),lr("cpu",_e957,10),lr("wasm",_e957,10);}Object.defineProperty(Se.versions,"web",{value:Mi,enumerable:!0});var src_settings=__webpack_require__(8380),user_uid=__webpack_require__(2004),axios=__webpack_require__(2505),axios_default=__webpack_require__.n(axios);function loader_typeof(e){return loader_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},loader_typeof(e);}function loader_regeneratorRuntime(){loader_regeneratorRuntime=function loader_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==loader_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(loader_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function loader_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function loader_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){loader_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){loader_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function loader_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function loader_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,loader_toPropertyKey(n.key),n);}}function loader_createClass(e,t,r){return t&&loader_defineProperties(e.prototype,t),r&&loader_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function loader_toPropertyKey(e){var t=loader_toPrimitive(e,"string");return"symbol"==loader_typeof(t)?t:t+"";}function loader_toPrimitive(e,t){if("object"!=loader_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=loader_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var loader_Loader=function(){return loader_createClass(function e(){loader_classCallCheck(this,e),this._name="tsvb";},[{key:"get",value:function(){var e=loader_asyncToGenerator(loader_regeneratorRuntime().mark(function e(t,r){var n,i;return loader_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cache){e.next=4;break;}return e.next=3,caches.open(this._name);case 3:this._cache=e.sent;case 4:return e.next=6,this._cache.match(t);case 6:if(void 0===(n=e.sent)){e.next=9;break;}return e.abrupt("return",n);case 9:return e.next=11,fetch(t);case 11:if((n=e.sent).ok){e.next=15;break;}return errorBus.bv.notify({message:"".concat(t," don't found"),emitter:errorBus.JK.ML_INFERENCE}),e.abrupt("return",n);case 15:if(!r){e.next=20;break;}return i=n.clone(),e.next=19,this._cache.put(t,n);case 19:return e.abrupt("return",i);case 20:return e.abrupt("return",n);case 21:case"end":return e.stop();}},e,this);}));return function(t,r){return e.apply(this,arguments);};}()},{key:"delete",value:(e=loader_asyncToGenerator(loader_regeneratorRuntime().mark(function e(){return loader_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,caches["delete"](this._name);case 2:case"end":return e.stop();}},e,this);})),function(){return e.apply(this,arguments);})}]);var e;}(),_isWebGPUSupported;function gpu_typeof(e){return gpu_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},gpu_typeof(e);}function gpu_regeneratorRuntime(){gpu_regeneratorRuntime=function gpu_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==gpu_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(gpu_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function gpu_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function gpu_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){gpu_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){gpu_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function isWebGPUSupported(){return _isWebGPUSupported2.apply(this,arguments);}function _isWebGPUSupported2(){return _isWebGPUSupported2=gpu_asyncToGenerator(gpu_regeneratorRuntime().mark(function e(){var t,r=arguments;return gpu_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},void 0===_isWebGPUSupported){e.next=3;break;}return e.abrupt("return",_isWebGPUSupported);case 3:return e.next=5,gpu_asyncToGenerator(gpu_regeneratorRuntime().mark(function e(){var r;return gpu_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.gpu){e.next=3;break;}return e.abrupt("return",!1);case 3:return e.prev=3,e.next=6,navigator.gpu.requestAdapter(t);case 6:return r=e.sent,e.next=9,r.requestDevice();case 9:return e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e["catch"](3),e.abrupt("return",!1);case 15:case"end":return e.stop();}},e,null,[[3,12]]);}))();case 5:return _isWebGPUSupported=e.sent,e.abrupt("return",_isWebGPUSupported);case 7:case"end":return e.stop();}},e);})),_isWebGPUSupported2.apply(this,arguments);}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var _n221=0,i=function i(){};return{s:i,n:function n(){return _n221>=e.length?{done:!0}:{done:!1,value:e[_n221++]};},e:function e(_e958){throw _e958;},f:i};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,a=!0,s=!1;return{s:function s(){r=r.call(e);},n:function n(){var e=r.next();return a=e.done,e;},e:function e(_e959){s=!0,o=_e959;},f:function f(){try{a||null==r["return"]||r["return"]();}finally{if(s)throw o;}}};}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0;}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n;}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1;}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e;}finally{try{if(!u&&null!=r["return"]&&(a=r["return"](),Object(a)!==a))return;}finally{if(l)throw i;}}return s;}}function _arrayWithHoles(e){if(Array.isArray(e))return e;}function ml_inference_typeof(e){return ml_inference_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},ml_inference_typeof(e);}function ml_inference_regeneratorRuntime(){ml_inference_regeneratorRuntime=function ml_inference_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==ml_inference_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(ml_inference_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function ml_inference_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function ml_inference_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){ml_inference_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){ml_inference_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function ml_inference_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function ml_inference_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ml_inference_toPropertyKey(n.key),n);}}function ml_inference_createClass(e,t,r){return t&&ml_inference_defineProperties(e.prototype,t),r&&ml_inference_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function ml_inference_toPropertyKey(e){var t=ml_inference_toPrimitive(e,"string");return"symbol"==ml_inference_typeof(t)?t:t+"";}function ml_inference_toPrimitive(e,t){if("object"!=ml_inference_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ml_inference_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var dimensions={segmentation:4,facedetector:3,colorcorrector:3,lowlighter:3},CustomMLInference=function(){return ml_inference_createClass(function e(){ml_inference_classCallCheck(this,e),this.inference=null,this.ready=!1,this.preset="balanced",this.isGPU=!1;},[{key:"onAuth",value:function value(){}},{key:"setPresetManager",value:function value(e){this.presetManager=e;}},{key:"preload",value:(n=ml_inference_asyncToGenerator(ml_inference_regeneratorRuntime().mark(function e(t){return ml_inference_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop();}},e);})),function(e){return n.apply(this,arguments);})},{key:"cache",value:(r=ml_inference_asyncToGenerator(ml_inference_regeneratorRuntime().mark(function e(t,r){return ml_inference_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop();}},e);})),function(e,t){return r.apply(this,arguments);})},{key:"getType",value:function value(){return"custom";}},{key:"setPreset",value:function value(e){this.preset=e;}},{key:"setBackend",value:function value(e){this.inference=e;}},{key:"init",value:(t=ml_inference_asyncToGenerator(ml_inference_regeneratorRuntime().mark(function e(t){var r,n,i,o;return ml_inference_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.inference.setPreset(this.preset);case 3:return e.next=5,this.inference.configure(t);case 5:return n=e.sent,e.next=8,sdkAuth(n,t);case 8:return i=e.sent,e.next=11,this.inference.auth(i.data.key);case 11:if(o=e.sent,"active"==JSON.parse(o).status){e.next=15;break;}throw new Error("Authentication failed");case 15:this.ready=!0,errorBus.bv.notify({message:"custom ".concat(this.preset),type:errorBus.By.INFO,emitter:errorBus.JK.ML_INFERENCE}),e.next=23;break;case 19:throw e.prev=19,e.t0=e["catch"](0),errorBus.bv.notify({message:null!==(r=e.t0.message)&&void 0!==r?r:e.t0,emitter:errorBus.JK.ML_INFERENCE,cause:e.t0}),e.t0;case 23:case"end":return e.stop();}},e,this,[[0,19]]);})),function(e){return t.apply(this,arguments);})},{key:"isReady",value:function value(){return this.ready;}},{key:"run",value:(e=ml_inference_asyncToGenerator(ml_inference_regeneratorRuntime().mark(function e(t,r,n,i,o){var a;return ml_inference_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.inference.run(t);case 2:return a=e.sent,e.abrupt("return",{seg:{data:a},inputBack:{data:t}});case 4:case"end":return e.stop();}},e,this);})),function(t,r,n,i,o){return e.apply(this,arguments);})}]);var e,t,r,n;}(),ONNXMLInference=function(){return ml_inference_createClass(function e(){ml_inference_classCallCheck(this,e),this.sessions=new Map(),this.sessionPromises=new Map(),this.ready=!1,this.preset="balanced",this.segmentationModel="",this.isGPU=!1,this._loader=new loader_Loader();},[{key:"onAuth",value:function value(e){var t="function"==typeof e;this.authFunction=t?e:void 0;}},{key:"setPresetManager",value:function value(e){this.presetManager=e;}},{key:"getModel",value:function value(e){return"segmentation"===e?this.segmentationModel:src_settings.yy.getModelUrl(src_settings.yy.MODELS[e]);}},{key:"getType",value:function value(){return"onnx";}},{key:"setBackend",value:function value(e){}},{key:"setPreset",value:function value(e){this.preset=e,this.presetManager?this.segmentationModel=this.presetManager.getModelURL(this.preset):this.segmentationModel=src_settings.yy.getModelUrl(src_settings.yy.PRESETS[src_settings.yy.PRESET]);}},{key:"cache",value:(o=ml_inference_asyncToGenerator(ml_inference_regeneratorRuntime().mark(function e(){var t,r,n,i,o,a=arguments;return ml_inference_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>1&&void 0!==a[1]&&a[1],!(a.length>0&&void 0!==a[0]&&a[0])){e.next=6;break;}return e.next=5,this._loader["delete"]();case 5:return e.abrupt("return");case 6:for(r=0,n=Object.entries(src_settings.yy.MODELS);r<n.length;r++)i=_slicedToArray(n[r],2),o=i[0],""!==i[1]&&this._loader.get(this.getModel(o),!0);t||(this.setPreset(src_settings.yy.PRESET),this._loader.get(this.getModel("segmentation"),!0));case 8:case"end":return e.stop();}},e,this);})),function(){return o.apply(this,arguments);})},{key:"preload",value:(i=ml_inference_asyncToGenerator(ml_inference_regeneratorRuntime().mark(function e(){var t,r,n,i,o,a=arguments;return ml_inference_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a.length>0&&void 0!==a[0]&&a[0],r=0,n=Object.entries(src_settings.yy.MODELS);case 2:if(!(r<n.length)){e.next=10;break;}if(i=_slicedToArray(n[r],2),o=i[0],""===i[1]){e.next=7;break;}return e.next=7,this.init(src_settings.yy.CUSTOMER_ID,o);case 7:r++,e.next=2;break;case 10:if(t){e.next=14;break;}return this.setPreset(src_settings.yy.PRESET),e.next=14,this.init(src_settings.yy.CUSTOMER_ID,"segmentation");case 14:case"end":return e.stop();}},e,this);})),function(){return i.apply(this,arguments);})},{key:"init",value:(n=ml_inference_asyncToGenerator(ml_inference_regeneratorRuntime().mark(function e(t,r){var n,i,o,a,s,u,l,c,h,f=this;return ml_inference_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=[],this.sessionPromises.forEach(function(e,t,r){"pending"==e.state&&i.push(e.promise);}),e.next=4,Promise.all(i);case 4:if(o=this.getModel(r),!this.sessionPromises.has(o)){e.next=7;break;}return e.abrupt("return",null===(n=this.sessionPromises.get(o))||void 0===n?void 0:n.promise);case 7:return a=new Deferred(),this.sessionPromises.set(o,a),e.next=11,this._loader.get(o);case 11:return s=e.sent,e.next=14,s.arrayBuffer();case 14:if(u=e.sent,ort_min.wV,l="wasm","segmentation"!=r){e.next=23;break;}if("webgpu"!=src_settings.yy.PROVIDER&&"auto"!=src_settings.yy.PROVIDER){e.next=23;break;}return e.next=21,isWebGPUSupported();case 21:e.sent?l="webgpu":errorBus.bv.notify({message:"WebGPU is not supported",emitter:errorBus.JK.ML_INFERENCE});case 23:return"webgpu"==l?(c=this.createGPUSession(u),this.isGPU=!0):c=this.createCPUSession(u),e.abrupt("return",c.then(function(e){return(h=e).configure(t);}).then(function(e){if("extension"!==src_settings.yy.APP_ENV)return sdkAuth(e,src_settings.yy.CUSTOMER_ID);if("function"!=typeof f.authFunction)throw"Can't find auth function";var t=src_settings.yy.API_URL+src_settings.yy.CUSTOMER_ID,r=user_uid.W.getInstance().getUID(src_settings.yy.CUSTOMER_ID);return f.authFunction(t,{user_id:r,payload:e});}).then(function(e){var t;return h.auth(null!==(t=e.key)&&void 0!==t?t:e.data.key);}).then(function(e){if("active"!==JSON.parse(e).status)throw new Error("Authentication failed");f.ready=!0,f.sessions.set(o,{session:h,isGPU:"webgpu"==l}),a.resolve(),errorBus.bv.notify({message:"init ".concat(r),type:errorBus.By.INFO,emitter:errorBus.JK.ML_INFERENCE});})["catch"](function(e){var t;throw errorBus.bv.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:errorBus.JK.ML_INFERENCE,cause:e}),e;}));case 25:case"end":return e.stop();}},e,this);})),function(e,t){return n.apply(this,arguments);})},{key:"createCPUSession",value:(r=ml_inference_asyncToGenerator(ml_inference_regeneratorRuntime().mark(function e(t){var r;return ml_inference_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={executionProviders:["wasm"],enableCpuMemArena:!0,enableMemPattern:!0,executionMode:"parallel",graphOptimizationLevel:"all",extra:{session:{set_denormal_as_zero:"1",disable_prepacking:"1",dynamic_block_base:"4"},optimization:{enable_gelu_approximation:"1"}}},ort_min._K.wasm.numThreads=1,src_settings.yy.PROXY&&(ort_min._K.wasm.proxy=!0),Object.keys(src_settings.yy.WASM_PATHS).length&&(ort_min._K.wasm.wasmPaths=src_settings.yy.WASM_PATHS),e.abrupt("return",ort_min.wV.create(t,r));case 5:case"end":return e.stop();}},e);})),function(e){return r.apply(this,arguments);})},{key:"createGPUSession",value:(t=ml_inference_asyncToGenerator(ml_inference_regeneratorRuntime().mark(function e(t){var r,n,i,o,a,s,u,l;return ml_inference_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r={executionProviders:["webgpu"]},Se.wasm.numThreads=1,src_settings.yy.PROXY&&(Se.wasm.proxy=!1),Object.keys(src_settings.yy.WASM_PATHS).length){for(n=[],i=0,o=Object.entries(src_settings.yy.WASM_PATHS);i<o.length;i++)a=_slicedToArray(o[i],2),s=a[0],u=a[1],n[s]=u.replace(".wasm",".jsep.wasm");l=Object.assign({},n),Se.wasm.wasmPaths=l;}return e.abrupt("return",ld.create(t,r));case 5:case"end":return e.stop();}},e);})),function(e){return t.apply(this,arguments);})},{key:"isReady",value:function value(){return this.ready;}},{key:"run",value:(e=ml_inference_asyncToGenerator(ml_inference_regeneratorRuntime().mark(function e(t,r,n,i,o){var a,s,u,l,c,h,f,d,p,y;return ml_inference_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.getModel(i),this.sessions.has(a)){e.next=4;break;}return errorBus.bv.notify({message:"ML inference for ".concat(i," model is not initialized"),emitter:errorBus.JK.ML_INFERENCE}),e.abrupt("return",null);case 4:if(s=this.sessions.get(a),u=s.session,l=s.isGPU,c=this.wrapTensor(t,[1,dimensions[i],n,r],l),!o){e.next=11;break;}h={},f=_createForOfIteratorHelper(u.outputNames);try{for(f.s();!(d=f.n()).done;)p=d.value,y=o[p],h[p]=this.wrapTensor(y.data,y.dims,l);}catch(e){f.e(e);}finally{f.f();}return e.abrupt("return",u.run({input:c},h));case 11:return e.abrupt("return",u.run({input:c}));case 12:case"end":return e.stop();}},e,this);})),function(t,r,n,i,o){return e.apply(this,arguments);})},{key:"wrapTensor",value:function value(e,t,r){return r?new Xe("float32",e,t):new ort_min.qY("float32",e,t);}}]);var e,t,r,n,i,o;}(),inferenceMap={onnx:ONNXMLInference,custom:CustomMLInference},MLInferenceFactory=function(){return ml_inference_createClass(function e(){ml_inference_classCallCheck(this,e);},null,[{key:"getInference",value:function value(e){return new inferenceMap[e]();}}]);}();function sdkAuth(e,t){return _sdkAuth.apply(this,arguments);}function _sdkAuth(){return(_sdkAuth=ml_inference_asyncToGenerator(ml_inference_regeneratorRuntime().mark(function e(t,r){return ml_inference_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",axios_default().post(src_settings.yy.API_URL+r,{user_id:user_uid.W.getInstance().getUID(r),payload:t},{headers:{"Tsvb-Version":src_settings.yy.VERSION}})["catch"](function(e){throw new Error(e.response.data.message);}));case 1:case"end":return e.stop();}},e);}))).apply(this,arguments);}function metricsHelper_typeof(e){return metricsHelper_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},metricsHelper_typeof(e);}function metricsHelper_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function metricsHelper_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,metricsHelper_toPropertyKey(n.key),n);}}function metricsHelper_createClass(e,t,r){return t&&metricsHelper_defineProperties(e.prototype,t),r&&metricsHelper_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function metricsHelper_toPropertyKey(e){var t=metricsHelper_toPrimitive(e,"string");return"symbol"==metricsHelper_typeof(t)?t:t+"";}function metricsHelper_toPrimitive(e,t){if("object"!=metricsHelper_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=metricsHelper_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var MetricsHelper=function(){return metricsHelper_createClass(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;metricsHelper_classCallCheck(this,e),this.sdkOptions=r,this.container=new _Container2(),this.background=new _Sprite(Texture_Texture.WHITE),this.background.tint=0,t.background&&(this.background.tint=t.background);var n={fontFamily:"Arial",fontSize:t.size?t.size:24,fill:t.color?t.color:16777215,align:"left"};this.text=new _Text2("",n);var i=t.padding?t.padding:7;this.text.x=i,this.text.y=i,this.container.addChild(this.background),this.container.addChild(this.text),this.container.visible=!1,this.sdkOptions.on("update",this.onOptionsUpdate,this);},[{key:"onOptionsUpdate",value:function value(){this.text.style.fontSize=Math.round(.02*this.sdkOptions.width);}},{key:"updateText",value:function value(e){this.text.text=e;var t=this.text.getLocalBounds();this.background.width=2*this.text.x+t.width,this.background.height=2*this.text.y+t.height;}},{key:"destroy",value:function value(){this.sdkOptions.off("update",this.onOptionsUpdate,this);}}]);}();var yuvShader="precision mediump float;\nuniform sampler2D uSampler;\nin vec2 vTextureCoord;\nuniform vec4 filterArea;\nlayout(location = 0) out vec4 outColor;\n\nuniform sampler2D u_Texture;\nuniform float u_Offset;\nuniform vec2 u_ImgSize;\n//Y =  0.299R + 0.587G + 0.114B\n//U = -0.147R - 0.289G + 0.436B\n//V =  0.615R - 0.515G - 0.100B\nconst vec3 COEF_Y = vec3(0.2126, 0.7152, 0.0722);\nconst vec3 COEF_U = vec3(-0.1146, -0.3854, 0.5);\nconst vec3 COEF_V = vec3(0.5, -0.4542, -0.0458);\nconst float U_DIVIDE_LINE = 2.0 / 3.0;\nconst float V_DIVIDE_LINE = 5.0 / 6.0;\n\nvoid main() {\n  vec2 texelOffset = vec2(u_Offset, 0.0);\n  //outColor = vec4(vTextureCoord.y, vTextureCoord.y, vTextureCoord.y, vTextureCoord.y);\n\n  if (vTextureCoord.y <= U_DIVIDE_LINE) {\n    vec2 texCoord = vec2(vTextureCoord.x, vTextureCoord.y * 3.0 / 2.0);\n    vec4 color0 = texture(u_Texture, texCoord);\n    vec4 color1 = texture(u_Texture, texCoord + texelOffset);\n    vec4 color2 = texture(u_Texture, texCoord + texelOffset * 2.0);\n    vec4 color3 = texture(u_Texture, texCoord + texelOffset * 3.0);\n\n    float y0 = dot(color0.rgb, COEF_Y);\n    float y1 = dot(color1.rgb, COEF_Y);\n    float y2 = dot(color2.rgb, COEF_Y);\n    float y3 = dot(color3.rgb, COEF_Y);\n    outColor = vec4(y0, y1, y2, y3);\n  } else if (vTextureCoord.y <= V_DIVIDE_LINE) {\n    float offsetY = 1.0 / 3.0 / u_ImgSize.y;\n    vec2 texCoord;\n    if (vTextureCoord.x <= 0.5) {\n      texCoord = vec2(vTextureCoord.x * 2.0, (vTextureCoord.y - U_DIVIDE_LINE) * 2.0 * 3.0);\n    } else {\n      texCoord = vec2(\n        (vTextureCoord.x - 0.5) * 2.0,\n        ((vTextureCoord.y - U_DIVIDE_LINE) * 2.0 + offsetY) * 3.0\n      );\n    }\n\n    vec4 color0 = texture(u_Texture, texCoord);\n    vec4 color1 = texture(u_Texture, texCoord + texelOffset * 2.0);\n    vec4 color2 = texture(u_Texture, texCoord + texelOffset * 4.0);\n    vec4 color3 = texture(u_Texture, texCoord + texelOffset * 6.0);\n\n    float u0 = dot(color0.rgb, COEF_U) + 0.5;\n    float u1 = dot(color1.rgb, COEF_U) + 0.5;\n    float u2 = dot(color2.rgb, COEF_U) + 0.5;\n    float u3 = dot(color3.rgb, COEF_U) + 0.5;\n    outColor = vec4(u0, u1, u2, u3);\n  } else {\n    float offsetY = 1.0 / 3.0 / u_ImgSize.y;\n    vec2 texCoord;\n    if (vTextureCoord.x <= 0.5) {\n      texCoord = vec2(vTextureCoord.x * 2.0, (vTextureCoord.y - V_DIVIDE_LINE) * 2.0 * 3.0);\n    } else {\n      texCoord = vec2(\n        (vTextureCoord.x - 0.5) * 2.0,\n        ((vTextureCoord.y - V_DIVIDE_LINE) * 2.0 + offsetY) * 3.0\n      );\n    }\n\n    vec4 color0 = texture(u_Texture, texCoord);\n    vec4 color1 = texture(u_Texture, texCoord + texelOffset * 2.0);\n    vec4 color2 = texture(u_Texture, texCoord + texelOffset * 4.0);\n    vec4 color3 = texture(u_Texture, texCoord + texelOffset * 6.0);\n\n    float v0 = dot(color0.rgb, COEF_V) + 0.5;\n    float v1 = dot(color1.rgb, COEF_V) + 0.5;\n    float v2 = dot(color2.rgb, COEF_V) + 0.5;\n    float v3 = dot(color3.rgb, COEF_V) + 0.5;\n    outColor = vec4(v0, v1, v2, v3);\n  }\n}\n",yuv_yuvShader="in vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nout vec2 vVertexPosition;\nout vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition(void ) {\n  vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.0)) + outputFrame.xy;\n\n  return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord(void ) {\n  return aVertexPosition; // * (outputFrame.zw);\n}\n\nvoid main(void ) {\n  gl_Position = filterVertexPosition();\n  vTextureCoord = filterTextureCoord();\n}\n";function filterYUV_typeof(e){return filterYUV_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},filterYUV_typeof(e);}function filterYUV_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,filterYUV_toPropertyKey(n.key),n);}}function filterYUV_createClass(e,t,r){return t&&filterYUV_defineProperties(e.prototype,t),r&&filterYUV_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function filterYUV_toPropertyKey(e){var t=filterYUV_toPrimitive(e,"string");return"symbol"==filterYUV_typeof(t)?t:t+"";}function filterYUV_toPrimitive(e,t){if("object"!=filterYUV_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=filterYUV_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function filterYUV_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function filterYUV_callSuper(e,t,r){return t=filterYUV_getPrototypeOf(t),filterYUV_possibleConstructorReturn(e,filterYUV_isNativeReflectConstruct()?Reflect.construct(t,r||[],filterYUV_getPrototypeOf(e).constructor):t.apply(e,r));}function filterYUV_possibleConstructorReturn(e,t){if(t&&("object"==filterYUV_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return filterYUV_assertThisInitialized(e);}function filterYUV_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function filterYUV_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(filterYUV_isNativeReflectConstruct=function filterYUV_isNativeReflectConstruct(){return!!e;})();}function filterYUV_getPrototypeOf(e){return filterYUV_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},filterYUV_getPrototypeOf(e);}function filterYUV_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&filterYUV_setPrototypeOf(e,t);}function filterYUV_setPrototypeOf(e,t){return filterYUV_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},filterYUV_setPrototypeOf(e,t);}var FilterYUV=function(e){function t(e){var r;return filterYUV_classCallCheck(this,t),(r=filterYUV_callSuper(this,t,[yuv_yuvShader,yuvShader,e.uniforms])).program.fragmentSrc.includes("#version 300 es")||(r.program.fragmentSrc="#version 300 es \n"+r.program.fragmentSrc),r.program.vertexSrc.includes("#version 300 es")||(r.program.vertexSrc="#version 300 es \n"+r.program.vertexSrc),r;}return filterYUV_inherits(t,_Filter2),filterYUV_createClass(t);}();function converterYUV_typeof(e){return converterYUV_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},converterYUV_typeof(e);}function converterYUV_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function converterYUV_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,converterYUV_toPropertyKey(n.key),n);}}function converterYUV_createClass(e,t,r){return t&&converterYUV_defineProperties(e.prototype,t),r&&converterYUV_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function converterYUV_toPropertyKey(e){var t=converterYUV_toPrimitive(e,"string");return"symbol"==converterYUV_typeof(t)?t:t+"";}function converterYUV_toPrimitive(e,t){if("object"!=converterYUV_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=converterYUV_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var ConverterYUV=function(){return converterYUV_createClass(function e(t,r){converterYUV_classCallCheck(this,e),this.sdkOptions=r;var n=this.sdkOptions.width,i=this.sdkOptions.height;this.renderer=t,this.widthYUV=n/4,this.heightYUV=3*i/2,this.textureYUV=_RenderTexture.create({width:this.widthYUV,height:this.heightYUV}),this.textureRBG=_RenderTexture.create({width:n,height:i}),this.spriteYUV=new _Sprite(this.textureYUV),this.filterYUV=new FilterYUV({uniforms:{u_Offset:1/n,u_ImgSize:[n,i],u_Texture:this.textureRBG}}),this.spriteYUV.filters=[this.filterYUV],this.sdkOptions.on("update",this.onOptionsUpdate,this);},[{key:"onOptionsUpdate",value:function value(){var e=this.sdkOptions.width,t=this.sdkOptions.height;this.widthYUV=e/4,this.heightYUV=3*t/2,this.textureYUV.resize(this.widthYUV,this.heightYUV),this.textureRBG.resize(e,t),this.filterYUV.uniforms.u_Offset=1/e,this.filterYUV.uniforms.u_ImgSize=[e,t];}},{key:"getVideoFrameArray",value:function value(){var e=new Uint8Array(4*this.widthYUV*this.heightYUV),t=this.renderer.generateTexture(this.spriteYUV);this.renderer.renderTexture.bind(t);var r=t.framebuffer.glFramebuffers[this.renderer.CONTEXT_UID];r.blitFramebuffer&&this.renderer.framebuffer.bind(r.blitFramebuffer);var n=this.renderer.gl;return n.readPixels(0,0,this.widthYUV,this.heightYUV,n.RGBA,n.UNSIGNED_BYTE,e),t.destroy(!0),e;}},{key:"getVideoFrameSettings",value:function value(){return{format:"I420",codedWidth:this.sdkOptions.width,codedHeight:this.sdkOptions.height};}},{key:"destroy",value:function value(){this.sdkOptions.off("update",this.onOptionsUpdate,this);}}]);}();function gl_helper_typeof(e){return gl_helper_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},gl_helper_typeof(e);}function gl_helper_regeneratorRuntime(){gl_helper_regeneratorRuntime=function gl_helper_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==gl_helper_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(gl_helper_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function gl_helper_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function gl_helper_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){gl_helper_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){gl_helper_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function gl_helper_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function gl_helper_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gl_helper_toPropertyKey(n.key),n);}}function gl_helper_createClass(e,t,r){return t&&gl_helper_defineProperties(e.prototype,t),r&&gl_helper_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function gl_helper_toPropertyKey(e){var t=gl_helper_toPrimitive(e,"string");return"symbol"==gl_helper_typeof(t)?t:t+"";}function gl_helper_toPrimitive(e,t){if("object"!=gl_helper_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=gl_helper_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var GLHelper=function(){return gl_helper_createClass(function e(){gl_helper_classCallCheck(this,e);},[{key:"clientWaitAsync",value:function value(e,t,r,n){return new Promise(function(i,o){!function a(){var s=e.clientWaitSync(t,r,0);s!==e.WAIT_FAILED?s!==e.TIMEOUT_EXPIRED?i(!0):module_setTimeout(a,n):o();}();});}},{key:"getBufferSubDataAsync",value:(t=gl_helper_asyncToGenerator(gl_helper_regeneratorRuntime().mark(function e(t,r,n,i,o,a,s){var u;return gl_helper_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=t.fenceSync(t.SYNC_GPU_COMMANDS_COMPLETE,0),t.flush(),e.next=4,this.clientWaitAsync(t,u,0,2);case 4:t.deleteSync(u),t.bindBuffer(r,n),t.getBufferSubData(r,i,o,a,s),t.bindBuffer(r,null);case 8:case"end":return e.stop();}},e,this);})),function(e,r,n,i,o,a,s){return t.apply(this,arguments);})},{key:"readPixelsAsync",value:(e=gl_helper_asyncToGenerator(gl_helper_regeneratorRuntime().mark(function e(t,r,n,i,o,a,s,u){var l;return gl_helper_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=t.createBuffer(),e.prev=1,t.bindBuffer(t.PIXEL_PACK_BUFFER,l),t.bufferData(t.PIXEL_PACK_BUFFER,u.byteLength,t.STREAM_READ),t.readPixels(r,n,i,o,a,s,0),t.bindBuffer(t.PIXEL_PACK_BUFFER,null),e.next=8,this.getBufferSubDataAsync(t,t.PIXEL_PACK_BUFFER,l,0,u);case 8:return e.abrupt("return",u);case 9:return e.prev=9,t.deleteBuffer(l),e.finish(9);case 12:case"end":return e.stop();}},e,this,[[1,,9,12]]);})),function(t,r,n,i,o,a,s,u){return e.apply(this,arguments);})}]);var e,t;}();function renderer_typeof(e){return renderer_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},renderer_typeof(e);}function renderer_regeneratorRuntime(){renderer_regeneratorRuntime=function renderer_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==renderer_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(renderer_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function renderer_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function renderer_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){renderer_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){renderer_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function renderer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function renderer_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,renderer_toPropertyKey(n.key),n);}}function renderer_createClass(e,t,r){return t&&renderer_defineProperties(e.prototype,t),r&&renderer_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function renderer_toPropertyKey(e){var t=renderer_toPrimitive(e,"string");return"symbol"==renderer_typeof(t)?t:t+"";}function renderer_toPrimitive(e,t){if("object"!=renderer_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=renderer_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var renderer_Renderer=function(){return renderer_createClass(function e(t,r){renderer_classCallCheck(this,e),this.color=65280,this.frameFormat="RGBX",r&&(this.frameFormat=r),this.sdkOptions=t,this.PIXI=pixi_js_lib_namespaceObject,this.renderer=new _Application2({width:this.sdkOptions.width,height:this.sdkOptions.height,antialias:!0,backgroundAlpha:0}),this.filter_manager=new _FilterSystem(this.renderer.renderer),this.timinngs={stats:new FrameStatistics(),sprite:new MetricsHelper({size:Math.round(.02*this.sdkOptions.width),padding:5},this.sdkOptions)},this.effectsContainer=new _Container2(),this.renderer.stage.addChild(this.effectsContainer),this.overlayContainer=new _Container2(),this.renderer.stage.addChild(this.overlayContainer),this.stopTickers(),this.GLHelper=new GLHelper(),"I420"===this.frameFormat&&(this.converterYUV=new ConverterYUV(this.renderer.renderer,this.sdkOptions)),this.sdkOptions.on("update",this.onOptionsUpdate,this);},[{key:"onOptionsUpdate",value:function value(){this.renderer.renderer.resize(this.sdkOptions.width,this.sdkOptions.height);}},{key:"stopTickers",value:function value(){this.renderer.ticker.stop(),_Ticker2.system.stop();}},{key:"startTickers",value:function value(){this.renderer.ticker.start(),_Ticker2.system.start();}},{key:"updateVideoFrame",value:function value(e){this.video_frame||(this.video_frame=this.createFrom(e)),this.video_frame.texture.destroy(!0),this.video_frame.texture=Texture_Texture.from(e);}},{key:"addStatistics",value:function value(){this.addToStage(this.timinngs.sprite.container);}},{key:"removeStatistics",value:function value(){this.removeFromStage(this.timinngs.sprite.container);}},{key:"updateStatistics",value:function value(e,t){this.timinngs.stats.updateStats(e,t);}},{key:"hideStatistics",value:function value(){this.timinngs.sprite.container.visible=!1;}},{key:"drawStatistics",value:function value(){this.timinngs.sprite.updateText(this.timinngs.stats.getText()),this.timinngs.sprite.container.visible=!0;}},{key:"destroy",value:function value(){this.renderer.renderer&&(this.sdkOptions.off("update",this.onOptionsUpdate,this),this.converterYUV&&this.converterYUV.destroy(),this.timinngs.sprite&&this.timinngs.sprite.destroy(),this.renderer.destroy(!0,{children:!0,texture:!0,baseTexture:!0}));}},{key:"renderTo",value:function value(e,t){var r;try{this.renderer.renderer.render(e,{renderTexture:t});}catch(e){errorBus.bv.notify({message:null!==(r=e.message)&&void 0!==r?r:e,emitter:errorBus.JK.RENDERER,cause:e});}}},{key:"createCanvas",value:function value(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r;}},{key:"createTextureFromBuffer",value:function value(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Texture_Texture.fromBuffer(e,t,r,n);}},{key:"createRenderTexture",value:function value(e,t){return _RenderTexture.create({width:e,height:t});}},{key:"pixels",value:function value(e){return this.renderer.renderer.extract.pixels(e);}},{key:"pixelsAsync",value:(e=renderer_asyncToGenerator(renderer_regeneratorRuntime().mark(function e(t,r){var n,i,o,a,s,u;return renderer_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=4*t._frame.width*t._frame.height,a=null!==(i=null===(n=null==r?void 0:r.pool)||void 0===n?void 0:n.getBuffer("u8",o))&&void 0!==i?i:new Uint8Array(o),(s=this.renderer.renderer).renderTexture.bind(t),(u=t.framebuffer.glFramebuffers[s.CONTEXT_UID]).blitFramebuffer&&s.framebuffer.bind(u.blitFramebuffer),e.next=8,this.GLHelper.readPixelsAsync(s.gl,0,0,t._frame.width,t._frame.height,s.gl.RGBA,s.gl.UNSIGNED_BYTE,a);case 8:return e.abrupt("return",a);case 9:case"end":return e.stop();}},e,this);})),function(t,r){return e.apply(this,arguments);})},{key:"calculateSpriteMatrix",value:function value(e){var t=new _Matrix();return this.filter_manager.calculateSpriteMatrix(t,e);}},{key:"getFilterManager",value:function value(){return this.filter_manager;}},{key:"setTintColor",value:function value(e){this.color=e;}},{key:"getTintColor",value:function value(){return this.color;}},{key:"createTexture",value:function value(e){return e instanceof Texture_Texture?e:Texture_Texture.from(e);}},{key:"createFromTexture",value:function value(e){return new _Sprite(e);}},{key:"createFrom",value:function value(e){return new _Sprite(Texture_Texture.from(e));}},{key:"createFromURL",value:function value(e){var t;return"string"==typeof e&&"color"===e?((t=new _Sprite(Texture_Texture.WHITE)).tint=this.getTintColor(),t.width=this.sdkOptions.width,t.height=this.sdkOptions.height,t):t=_Sprite.from(e);}},{key:"createContainer",value:function value(){return new _Container2();}},{key:"addToStage",value:function value(e){var t;null===(t=this.renderer.stage)||void 0===t||t.addChild(e);}},{key:"addToEffects",value:function value(e){var t;this.renderer.renderer&&(null===(t=this.effectsContainer)||void 0===t||t.addChild(e));}},{key:"addToOverlay",value:function value(e){var t;null===(t=this.overlayContainer)||void 0===t||t.addChild(e);}},{key:"addToStageAt",value:function value(e,t){var r;null===(r=this.renderer.stage)||void 0===r||r.addChildAt(e,t);}},{key:"addToEffectsAt",value:function value(e,t){var r;null===(r=this.effectsContainer)||void 0===r||r.addChildAt(e,t);}},{key:"addToOverlayAt",value:function value(e,t){var r;null===(r=this.overlayContainer)||void 0===r||r.addChildAt(e,t);}},{key:"removeFromStage",value:function value(e){var t;null===(t=this.renderer.stage)||void 0===t||t.removeChild(e);}},{key:"removeFromEffects",value:function value(e){var t;null===(t=this.effectsContainer)||void 0===t||t.removeChild(e);}},{key:"removeFromOverlay",value:function value(e){var t;null===(t=this.overlayContainer)||void 0===t||t.removeChild(e);}},{key:"useAsMask",value:function value(e){this.renderer.stage.mask=e;}},{key:"setCanvas",value:function value(e){this.canvas=e;}},{key:"render",value:function value(){var e;try{this.renderer.render(),this.converterYUV&&(this.renderTo(this.renderer.stage,this.converterYUV.textureRBG),this.renderer.renderer.render(this.renderer.stage,{renderTexture:this.converterYUV.textureYUV}));}catch(t){errorBus.bv.notify({message:null!==(e=t.message)&&void 0!==e?e:t,emitter:errorBus.JK.RENDERER,cause:t});}}},{key:"getVideoFrameData",value:function value(){return this.converterYUV?this.converterYUV.getVideoFrameArray():this.renderer.renderer.view;}},{key:"getVideoFrameSettings",value:function value(){return this.converterYUV?this.converterYUV.getVideoFrameSettings():{displayHeight:this.sdkOptions.height,displayWidth:this.sdkOptions.width};}}]);var e;}();function effect_processor_typeof(e){return effect_processor_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},effect_processor_typeof(e);}function effect_processor_slicedToArray(e,t){return effect_processor_arrayWithHoles(e)||effect_processor_iterableToArrayLimit(e,t)||effect_processor_unsupportedIterableToArray(e,t)||effect_processor_nonIterableRest();}function effect_processor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function effect_processor_iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1;}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e;}finally{try{if(!u&&null!=r["return"]&&(a=r["return"](),Object(a)!==a))return;}finally{if(l)throw i;}}return s;}}function effect_processor_arrayWithHoles(e){if(Array.isArray(e))return e;}function effect_processor_createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=effect_processor_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var _n222=0,i=function i(){};return{s:i,n:function n(){return _n222>=e.length?{done:!0}:{done:!1,value:e[_n222++]};},e:function e(_e960){throw _e960;},f:i};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,a=!0,s=!1;return{s:function s(){r=r.call(e);},n:function n(){var e=r.next();return a=e.done,e;},e:function e(_e961){s=!0,o=_e961;},f:function f(){try{a||null==r["return"]||r["return"]();}finally{if(s)throw o;}}};}function effect_processor_unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return effect_processor_arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?effect_processor_arrayLikeToArray(e,t):void 0;}}function effect_processor_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n;}function effect_processor_regeneratorRuntime(){effect_processor_regeneratorRuntime=function effect_processor_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==effect_processor_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(effect_processor_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function effect_processor_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function effect_processor_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){effect_processor_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){effect_processor_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function effect_processor_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,effect_processor_toPropertyKey(n.key),n);}}function effect_processor_createClass(e,t,r){return t&&effect_processor_defineProperties(e.prototype,t),r&&effect_processor_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function effect_processor_toPropertyKey(e){var t=effect_processor_toPrimitive(e,"string");return"symbol"==effect_processor_typeof(t)?t:t+"";}function effect_processor_toPrimitive(e,t){if("object"!=effect_processor_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=effect_processor_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function effect_processor_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}var SharedResources=effect_processor_createClass(function e(){effect_processor_classCallCheck(this,e),this.transform=null,this.mirror=!1,this.filters=new Map();}),AbstractEffect=function(){return effect_processor_createClass(function e(t){effect_processor_classCallCheck(this,e),this.enabled=!1,this.sdkOptions=t;},[{key:"useResources",value:function value(e){this.resources=e;}},{key:"prepare",value:function value(){}},{key:"process",value:(e=effect_processor_asyncToGenerator(effect_processor_regeneratorRuntime().mark(function e(){return effect_processor_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop();}},e);})),function(){return e.apply(this,arguments);})},{key:"nextFrame",value:function value(e){}},{key:"clearBuffers",value:function value(){}},{key:"enable",value:function value(){this.enabled=!0;}},{key:"disable",value:function value(){this.enabled=!1;}},{key:"destroy",value:function value(){}}]);var e;}(),EffectProcessor=function(){return effect_processor_createClass(function e(t,r){effect_processor_classCallCheck(this,e),this.effects=[],this.isPaused=!1,this.isSkipPipeline=!1,this.components={},this.hasFrames=!1,this.textures=[],this.resources=new SharedResources(),this.resources.renderer=t,this.components=null!=r?r:{},this.resources.texture=new Texture();},[{key:"destroy",value:function value(){this.removeComponents(),this.resources.renderer.destroy(),this.effects.forEach(function(e){e.destroy();});}},{key:"addEffect",value:function value(e){e.useResources(this.resources),e.prepare(),this.effects.push(e);}},{key:"clearBuffers",value:function value(){this.textures=[],this.effects.forEach(function(e,t){e.clearBuffers();});}},{key:"pause",value:function value(){this.isPaused=!0;}},{key:"unpause",value:function value(){this.isPaused=!1;}},{key:"enablePipelineSkipping",value:function value(){this.isSkipPipeline=!0;}},{key:"disablePipelineSkipping",value:function value(){this.isSkipPipeline=!1;}},{key:"nextFrame",value:function value(e){if(this.isPaused||this.isSkipPipeline)return e.texture.destroy(!0),void(this.textures=[]);if(this.effects.forEach(function(t,r){t.nextFrame(e);}),this.textures.length>1){var t=this.textures.shift();null==t||t.destroy();}this.textures.push(e);}},{key:"updateFrame",value:function value(){if(this.textures.length){var e=this.textures.shift();e&&this.resources.texture.update(e.texture);}}},{key:"addComponents",value:function value(){var e=this;this.components._getSortedComponentsArr.forEach(function(t){return e.resources.renderer.addToStage(t.container);});}},{key:"removeComponents",value:function value(){var e=this;Object.values(this.components).forEach(function(t){return e.resources.renderer.removeFromStage(t.container);});}},{key:"process",value:(e=effect_processor_asyncToGenerator(effect_processor_regeneratorRuntime().mark(function e(){var t,r,n,i,o,a;return effect_processor_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPaused){e.next=2;break;}return e.abrupt("return");case 2:if(!this.isSkipPipeline){e.next=7;break;}return this.addComponents(),this.resources.renderer.render(),this.removeComponents(),e.abrupt("return");case 7:this.updateFrame(),t=effect_processor_createForOfIteratorHelper(this.effects.entries()),e.prev=9,t.s();case 11:if((r=t.n()).done){e.next=20;break;}return n=effect_processor_slicedToArray(r.value,2),i=n[0],o=n[1],(a=i+1===this.effects.length)&&this.addComponents(),e.next=17,o.process();case 17:a&&this.removeComponents();case 18:e.next=11;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e["catch"](9),t.e(e.t0);case 25:return e.prev=25,t.f(),e.finish(25);case 28:this.hasFrames=!0;case 29:case"end":return e.stop();}},e,this,[[9,22,25,28]]);})),function(){return e.apply(this,arguments);})}]);var e;}();var lutShader="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D uLUT;\n\nuniform float uFilterPart;\nuniform float uFilterPower;\nuniform float uLutSize;\nuniform float uNormalizator;\nuniform float uHalfPx;\nuniform int uEdges;\nuniform int uEnabled;\n\nvec4 newColor(float rectNum, vec2 coord) {\n  int num = int(rectNum);\n  int red = num - uEdges * (num / uEdges);\n  int green = num / uEdges;\n\n  vec2 bCoord = vec2(float(red) / float(uEdges), float(green) / float(uEdges));\n\n  vec2 lutTextureCoord = vec2(coord.r + bCoord.r, coord.g + bCoord.g);\n  return texture2D(uLUT, lutTextureCoord);\n}\n\nfloat normalizeColor(float color) {\n  return color * uNormalizator + uHalfPx;\n}\n\nvoid main() {\n  vec4 color = texture2D(uSampler, vTextureCoord);\n\n  //. Check enabled\n  if (uEnabled < 1) {\n    gl_FragColor = color;\n    return;\n  }\n\n  //. Check filter part\n  if (vTextureCoord.x > uFilterPart) {\n    gl_FragColor = color;\n    return;\n  }\n\n  vec2 rgCoord = vec2(normalizeColor(color.r), normalizeColor(color.g));\n\n  //. Count number of the LUT-cell\n  float rectNumReal = color.b * (uLutSize - 1.0);\n\n  float rectNumMin = floor(rectNumReal);\n  float rectNumMax = ceil(rectNumReal);\n\n  vec4 colorLut1 = newColor(rectNumMin, rgCoord);\n  vec4 colorLut2 = newColor(rectNumMax, rgCoord);\n\n  vec4 colorInterpolated = mix(colorLut1, colorLut2, rectNumReal - rectNumMin);\n  vec3 resultColor = mix(color.rgb, colorLut1.rgb, uFilterPower);\n\n  gl_FragColor = vec4(resultColor.rgb, color.a);\n}\n\n";function filterLut_typeof(e){return filterLut_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},filterLut_typeof(e);}function filterLut_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function filterLut_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,filterLut_toPropertyKey(n.key),n);}}function filterLut_createClass(e,t,r){return t&&filterLut_defineProperties(e.prototype,t),r&&filterLut_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function filterLut_toPropertyKey(e){var t=filterLut_toPrimitive(e,"string");return"symbol"==filterLut_typeof(t)?t:t+"";}function filterLut_toPrimitive(e,t){if("object"!=filterLut_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=filterLut_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function filterLut_callSuper(e,t,r){return t=filterLut_getPrototypeOf(t),filterLut_possibleConstructorReturn(e,filterLut_isNativeReflectConstruct()?Reflect.construct(t,r||[],filterLut_getPrototypeOf(e).constructor):t.apply(e,r));}function filterLut_possibleConstructorReturn(e,t){if(t&&("object"==filterLut_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return filterLut_assertThisInitialized(e);}function filterLut_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function filterLut_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(filterLut_isNativeReflectConstruct=function filterLut_isNativeReflectConstruct(){return!!e;})();}function filterLut_getPrototypeOf(e){return filterLut_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},filterLut_getPrototypeOf(e);}function filterLut_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&filterLut_setPrototypeOf(e,t);}function filterLut_setPrototypeOf(e,t){return filterLut_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},filterLut_setPrototypeOf(e,t);}var FilterLut=function(e){function t(e){var r,n,i,o;return filterLut_classCallCheck(this,t),(r=filterLut_callSuper(this,t,[void 0,lutShader,{uFilterPart:1,uFilterPower:1,uEnabled:0,uLutSize:null!==(n=null==e?void 0:e.lutSize)&&void 0!==n?n:36,uEdges:null!==(i=null==e?void 0:e.edges)&&void 0!==i?i:6,uLUT:null!==(o=null==e?void 0:e.texture)&&void 0!==o?o:Texture_Texture.WHITE}])).calcNormatizator(),r;}return filterLut_inherits(t,_Filter2),filterLut_createClass(t,[{key:"setLUT",value:function value(e){var t;(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(null===(t=this.uniforms.uLUT)||void 0===t||t.destroy(!0)),(null==e?void 0:e.edges)&&(this.uniforms.uEdges=e.edges),(null==e?void 0:e.lutSize)&&(this.uniforms.uLutSize=e.lutSize),this.calcNormatizator(),(null==e?void 0:e.texture)?(this.uniforms.uLUT=e.texture,this.uniforms.uEnabled=1):this.uniforms.uEnabled=0;}},{key:"setFilterPart",value:function value(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPart=e;}},{key:"setFilterPower",value:function value(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPower=e;}},{key:"calcNormatizator",value:function value(){var e=this.uniforms,t=e.uLutSize,r=e.uEdges;this.uniforms.uNormalizator=(t-1)/(t*r),this.uniforms.uHalfPx=.5/(t*r);}}]);}(),defaultConfig=function defaultConfig(){return{lut:"none",part:1,power:1,capacity:1};};function lutParser_typeof(e){return lutParser_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},lutParser_typeof(e);}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||lutParser_unsupportedIterableToArray(e)||_nonIterableSpread();}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function lutParser_unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return lutParser_arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?lutParser_arrayLikeToArray(e,t):void 0;}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e);}function _arrayWithoutHoles(e){if(Array.isArray(e))return lutParser_arrayLikeToArray(e);}function lutParser_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n;}function lutParser_regeneratorRuntime(){lutParser_regeneratorRuntime=function lutParser_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==lutParser_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(lutParser_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function lutParser_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function lutParser_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){lutParser_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){lutParser_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function lutParser_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function lutParser_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lutParser_toPropertyKey(n.key),n);}}function lutParser_createClass(e,t,r){return t&&lutParser_defineProperties(e.prototype,t),r&&lutParser_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function lutParser_toPropertyKey(e){var t=lutParser_toPrimitive(e,"string");return"symbol"==lutParser_typeof(t)?t:t+"";}function lutParser_toPrimitive(e,t){if("object"!=lutParser_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=lutParser_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var extArr=["cube"],LutParser=function(){return lutParser_createClass(function e(){lutParser_classCallCheck(this,e);},[{key:"parse",value:function value(e){var t,r=this;return new Promise(function(){var n=lutParser_asyncToGenerator(lutParser_regeneratorRuntime().mark(function n(i,o){var a,s,u,l,c;return lutParser_regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(e instanceof File)){n.next=14;break;}if(r.checkFileExtention(e.name)){n.next=4;break;}return o('[ Lut Parser ] - Invalid file extention (file "'.concat(e.name,'", available extentions: ').concat(extArr.join(", "),")")),n.abrupt("return");case 4:return n.prev=4,n.next=7,r.readFile(e);case 7:t=n.sent,n.next=14;break;case 10:return n.prev=10,n.t0=n["catch"](4),o(n.t0),n.abrupt("return");case 14:if("string"!=typeof e){n.next=25;break;}return n.prev=15,n.next=18,fetch(e).then(function(e){return e.text();});case 18:t=n.sent,n.next=25;break;case 21:return n.prev=21,n.t1=n["catch"](15),o(n.t1),n.abrupt("return");case 25:if("3D"===(a=r.parseCUBE(t)).type.toUpperCase()){n.next=29;break;}return o("[ Lut Parser ] - invalid lut type(".concat(a.type,"). Support 3DLUT only")),n.abrupt("return");case 29:return s=Math.ceil(Math.sqrt(a.size)),u=r.prepareTextureArray(a,s),l=a.size*s,c=Texture_Texture.fromBuffer(u,l,l,{scaleMode:1,mipmap:_MIPMAP_MODES.OFF}),i({texture:c,lutSize:a.size,textureSize:l,edges:s}),n.abrupt("return");case 35:case"end":return n.stop();}},n,null,[[4,10],[15,21]]);}));return function(e,t){return n.apply(this,arguments);};}());}},{key:"parseCUBE",value:function value(e){for(var t,r={title:"",type:"",size:0,domain:[[0,0,0],[1,1,1]],data:[]},n=e.split("\n"),i=0;i<n.length;i++){var o=n[i].trim();if("#"!==o[0]&&""!==o){var a=o.split(/\s+/);switch(a[0]){case"TITLE":r.title=o.slice(7,-1);break;case"DOMAIN_MIN":r.domain[0]=a.slice(1).map(Number);break;case"DOMAIN_MAX":r.domain[1]=a.slice(1).map(Number);break;case"LUT_1D_SIZE":r.type="1D",r.size=Number(a[1]);break;case"LUT_3D_SIZE":r.type="3D",r.size=Number(a[1]);break;default:(t=r.data).push.apply(t,_toConsumableArray(a.map(Number)));}}}return r;}},{key:"prepareTextureArray",value:function value(e,t){var r=e.data,n=e.size,i=n*n*n,o=new Uint8ClampedArray(4*Math.pow(n*t,2)),a={value:0,isNil:function isNil(){return 0===a.value;},setDefault:function setDefault(){return a.value=n*n;},dec:function dec(){return a.value--;}};a.setDefault();for(var s=0,u=0,l=function l(e,r){return 4*(n*(t*u+s)+r%n)+e;},c=0;c<3*i;c+=3)o[l(0,c/3)]=255*r[c+0],o[l(1,c/3)]=255*r[c+1],o[l(2,c/3)]=255*r[c+2],o[l(3,c/3)]=255,a.dec(),c/3%n==n-2&&u++,a.isNil()&&(a.setDefault(),++s>=t?s=0:u-=n);return o;}},{key:"checkFileExtention",value:function value(e){var t=e.split(".").pop();return!!t&&extArr.includes(t.toLowerCase());}},{key:"readFile",value:(e=lutParser_asyncToGenerator(lutParser_regeneratorRuntime().mark(function e(t){return lutParser_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){var n=new FileReader();n.readAsText(t),n.onload=function(){e(n.result);},n.onerror=function(){r("[ Lut Parser ] - filereader: ".concat(n.error));};}));case 1:case"end":return e.stop();}},e);})),function(t){return e.apply(this,arguments);})}]);var e;}();function activityIndexator_typeof(e){return activityIndexator_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},activityIndexator_typeof(e);}function activityIndexator_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function activityIndexator_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,activityIndexator_toPropertyKey(n.key),n);}}function activityIndexator_createClass(e,t,r){return t&&activityIndexator_defineProperties(e.prototype,t),r&&activityIndexator_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function activityIndexator_toPropertyKey(e){var t=activityIndexator_toPrimitive(e,"string");return"symbol"==activityIndexator_typeof(t)?t:t+"";}function activityIndexator_toPrimitive(e,t){if("object"!=activityIndexator_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=activityIndexator_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var ActivityIndexator=function(){return activityIndexator_createClass(function e(t){var r;activityIndexator_classCallCheck(this,e),this.size=null!==(r=t.size)&&void 0!==r?r:1,this.store=[];},[{key:"add",value:function value(e){var t=this,r=this.store.find(function(t){return t.id===e;}),n=Date.now();if(r)return r.time=n,{hasItem:!0};var i={id:e,time:n};if(this.store.push(i),this.store.length<=this.size)return{};var o=this.store.reduce(function(e,r,n){return t.store[e].time<r.time?e:n;},0);return{removedID:this.store.splice(o,1)[0].id};}},{key:"setSize",value:function value(e){var t;if(this.size=e,!(this.store.length<=e)){this.store=this.store.sort(function(e,t){return t.time-e.time;});for(var r=[];this.store.length>this.size;){var n=null===(t=this.store.pop())||void 0===t?void 0:t.id;void 0!==n&&r.push(n);}return r;}}},{key:"checkItemByID",value:function value(e){return!!~this.store.findIndex(function(t){return t.id===e;});}}]);}();function colorFilterEffect_typeof(e){return colorFilterEffect_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},colorFilterEffect_typeof(e);}function colorFilterEffect_regeneratorRuntime(){colorFilterEffect_regeneratorRuntime=function colorFilterEffect_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==colorFilterEffect_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(colorFilterEffect_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function colorFilterEffect_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function colorFilterEffect_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){colorFilterEffect_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){colorFilterEffect_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function colorFilterEffect_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function colorFilterEffect_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,colorFilterEffect_toPropertyKey(n.key),n);}}function colorFilterEffect_createClass(e,t,r){return t&&colorFilterEffect_defineProperties(e.prototype,t),r&&colorFilterEffect_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function colorFilterEffect_toPropertyKey(e){var t=colorFilterEffect_toPrimitive(e,"string");return"symbol"==colorFilterEffect_typeof(t)?t:t+"";}function colorFilterEffect_toPrimitive(e,t){if("object"!=colorFilterEffect_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=colorFilterEffect_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function colorFilterEffect_callSuper(e,t,r){return t=colorFilterEffect_getPrototypeOf(t),colorFilterEffect_possibleConstructorReturn(e,colorFilterEffect_isNativeReflectConstruct()?Reflect.construct(t,r||[],colorFilterEffect_getPrototypeOf(e).constructor):t.apply(e,r));}function colorFilterEffect_possibleConstructorReturn(e,t){if(t&&("object"==colorFilterEffect_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return colorFilterEffect_assertThisInitialized(e);}function colorFilterEffect_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function colorFilterEffect_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(colorFilterEffect_isNativeReflectConstruct=function colorFilterEffect_isNativeReflectConstruct(){return!!e;})();}function colorFilterEffect_getPrototypeOf(e){return colorFilterEffect_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},colorFilterEffect_getPrototypeOf(e);}function colorFilterEffect_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&colorFilterEffect_setPrototypeOf(e,t);}function colorFilterEffect_setPrototypeOf(e,t){return colorFilterEffect_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},colorFilterEffect_setPrototypeOf(e,t);}var ColorFilterEffect=function(e){function t(e){var r;return colorFilterEffect_classCallCheck(this,t),(r=colorFilterEffect_callSuper(this,t,[e])).parser=new LutParser(),r.lutStore={},r.config=defaultConfig(),r.activityIndexator=new ActivityIndexator({size:r.config.capacity}),r.filterName="color-filter",r;}return colorFilterEffect_inherits(t,AbstractEffect),colorFilterEffect_createClass(t,[{key:"prepare",value:function value(){this.resources.texture;this.filter=new FilterLut(),this.setConfig(this.config);}},{key:"process",value:(n=colorFilterEffect_asyncToGenerator(colorFilterEffect_regeneratorRuntime().mark(function e(){return colorFilterEffect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled&&"none"!==this.config.lut){e.next=3;break;}return this.resources.filters.has(this.filterName)&&this.resources.filters["delete"](this.filterName),e.abrupt("return");case 3:this.resources.filters.set(this.filterName,this.filter);case 4:case"end":return e.stop();}},e,this);})),function(){return n.apply(this,arguments);})},{key:"setConfig",value:function value(e){this.setFilterPart(e.part),this.setFilterPower(e.power),this.setFilterLut(e.lut,e.promise),this.setCapacity(e.capacity);}},{key:"setFilterPart",value:function value(e){void 0!==e&&(this.config.part=e,this.filter.setFilterPart(e));}},{key:"setFilterPower",value:function value(e){void 0!==e&&(this.config.power=e,this.filter.setFilterPower(e));}},{key:"setFilterLut",value:(r=colorFilterEffect_asyncToGenerator(colorFilterEffect_regeneratorRuntime().mark(function e(t,r){var n,i,o,a,s;return colorFilterEffect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break;}return e.abrupt("return");case 2:if("none"!==t){e.next=5;break;}return this.config.lut="none",e.abrupt("return");case 5:if(n=this.countID(t),this.config.lut=t,this.selectedID=n,i=this.activityIndexator.add(n),o=i.hasItem,a=i.removedID,o){e.next=19;break;}return e.next=12,this.parser.parse(t);case 12:if(s=e.sent,this.activityIndexator.checkItemByID(n)){e.next=18;break;}return s.texture.destroy(),this.removeLutByID(a),this.resolver(n,null==r?void 0:r.resolve()),e.abrupt("return");case 18:this.lutStore[n]=s;case 19:this.filter.setLUT(this.lutStore[this.selectedID],!1),this.removeLutByID(a),this.resolver(n,null==r?void 0:r.resolve());case 22:case"end":return e.stop();}},e,this);})),function(e,t){return r.apply(this,arguments);})},{key:"setCapacity",value:function value(e){var t=this;if(void 0!==e){this.config.capacity=e;var r=this.activityIndexator.setSize(e);(null==r?void 0:r.length)&&r.forEach(function(e){return t.removeLutByID(e);});}}},{key:"removeLutByID",value:function value(e){var t,r;void 0!==e&&(null===(r=null===(t=this.lutStore[e])||void 0===t?void 0:t.texture)||void 0===r||r.destroy(),delete this.lutStore[e]);}},{key:"countID",value:function value(e){return e instanceof File?e.name:e;}},{key:"onSuccess",value:function value(e){var t="function"==typeof e;this.onSuccessFunction=t?e:void 0;}},{key:"resolver",value:function value(e,t){"function"==typeof this.onSuccessFunction&&this.onSuccessFunction(e),"function"==typeof t&&t();}},{key:"destroy",value:function value(){}}]);var r,n;}();var beautyShader="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\n#define SIGMA (10.0)\n#define BSIGMA (0.1)\n#define MSIZE (15)\n\nfloat kernel[MSIZE];\n\nuniform float uBeautyficationLevel;\nuniform int uWidth;\nuniform int uHeight;\n\nfloat normpdf(float x, float sigma) {\n  return 0.39894 * exp(-0.5 * x * x / (sigma * sigma)) / sigma;\n}\n\nfloat normpdf3(vec3 v, float sigma) {\n  return 0.39894 * exp(-0.5 * dot(v, v) / (sigma * sigma)) / sigma;\n}\n\nvec4 overlay(vec4 a, vec4 b) {\n  vec4 x = vec4(2.0) * a * b;\n  vec4 y = vec4(1.0) - vec4(2.0) * (vec4(1.0) - a) * (vec4(1.0) - b);\n  vec4 result;\n  result.r = mix(x.r, y.r, float(a.r > 0.5));\n  result.g = mix(x.g, y.g, float(a.g > 0.5));\n  result.b = mix(x.b, y.b, float(a.b > 0.5));\n  result.a = mix(x.a, y.a, float(a.a > 0.5));\n  return result;\n}\n\nvec3 rgb2xyz(vec3 c) {\n  vec3 tmp;\n  tmp.x = c.r > 0.04045 ? pow((c.r + 0.055) / 1.055, 2.4) : c.r / 12.92;\n  tmp.y = c.g > 0.04045 ? pow((c.g + 0.055) / 1.055, 2.4) : c.g / 12.92,\n    tmp.z = c.b > 0.04045 ? pow((c.b + 0.055) / 1.055, 2.4) : c.b / 12.92;\n  return 100.0 *\n  tmp *\n  mat3(0.4124, 0.3576, 0.1805, 0.2126, 0.7152, 0.0722, 0.0193, 0.1192, 0.9505);\n}\n\nvec3 xyz2lab(vec3 c) {\n  vec3 n = c / vec3(95.047, 100, 108.883);\n  vec3 v;\n  v.x = n.x > 0.008856 ? pow(n.x, 1.0 / 3.0) : 7.787 * n.x + 16.0 / 116.0;\n  v.y = n.y > 0.008856 ? pow(n.y, 1.0 / 3.0) : 7.787 * n.y + 16.0 / 116.0;\n  v.z = n.z > 0.008856 ? pow(n.z, 1.0 / 3.0) : 7.787 * n.z + 16.0 / 116.0;\n  return vec3(116.0 * v.y - 16.0, 500.0 * (v.x - v.y), 200.0 * (v.y - v.z));\n}\n\nvec3 rgb2lab(vec3 c) {\n  vec3 lab = xyz2lab(rgb2xyz(c));\n  return vec3(\n    lab.x / 100.0,\n    0.5 + 0.5 * (lab.y / 127.0),\n    0.5 + 0.5 * (lab.z / 127.0)\n  );\n}\n\nbool skin_mask(vec4 color) {\n  vec3 lab = rgb2lab(color.rgb);\n  return lab.g >= uBeautyficationLevel + 0.05 &&\n  lab.b >= uBeautyficationLevel + 0.04 &&\n  lab.r <= 0.98 &&\n  length(lab.gb) <= 0.9;\n}\n\nvoid main() {\n  vec2 iResolution = vec2(float(uWidth), float(uHeight));\n  vec3 c = texture2D(uSampler, vTextureCoord).rgb;\n  float a = texture2D(uSampler, vTextureCoord).a;\n\n  if (a > 0.9 && (uBeautyficationLevel > 0.95 || skin_mask(texture2D(uSampler, vTextureCoord)))) {\n    const int kSize = (MSIZE - 1) / 2;\n    vec3 final_colour = vec3(0.0);\n    float Z = 0.0;\n\n    kernel[0] = kernel[14] = 0.031225216;\n    kernel[1] = kernel[13] = 0.033322271;\n    kernel[2] = kernel[12] = 0.035206333;\n    kernel[3] = kernel[11] = 0.036826804;\n    kernel[4] = kernel[10] = 0.038138565;\n    kernel[5] = kernel[9] = 0.039104044;\n    kernel[6] = kernel[8] = 0.039695028;\n    kernel[7] = 0.039894;\n    float bZ = 0.2506642602897679;\n\n    //create the 1-D kernel\n\n    //   for (int j = 0; j <= kSize; ++j)\n    //   {\n    //     kernel[kSize+j] = kernel[kSize-j] = normpdf(float(j), SIGMA);\n    //   }\n\n    vec3 cc;\n    float factor;\n    //float bZ = 1.0/normpdf(0.0, BSIGMA);\n    //read out the texels\n    for (int i = -kSize; i <= kSize; ++i) {\n      for (int j = -kSize; j <= kSize; ++j) {\n        cc = texture2D(\n          uSampler,\n          vTextureCoord.xy + vec2(float(i), float(j)) / iResolution.xy\n        ).rgb;\n        factor =\n          normpdf3(cc - c, BSIGMA) * bZ * kernel[kSize + j] * kernel[kSize + i];\n        Z += factor;\n        final_colour += factor * cc;\n      }\n    }\n\n    //fragColor = vec4(final_colour / Z, 1.0);\n\n    vec4 origin = texture2D(uSampler, vTextureCoord);\n    vec4 blurred = vec4(final_colour / Z, 1.0);\n    vec4 highpass =\n      vec4(\n        origin.r - blurred.r,\n        origin.g - blurred.g,\n        origin.b - blurred.b,\n        1\n      ) +\n      vec4(0.5, 0.5, 0.5, 0);\n    vec4 highpass_inverted = vec4(\n      1.0 - highpass.r,\n      1.0 - highpass.g,\n      1.0 - highpass.b,\n      1\n    );\n    gl_FragColor = overlay(origin, highpass_inverted);\n\n  } else {\n    gl_FragColor = vec4(c, a);\n\n  }\n}\n",beautyHPassBoxBilateralShader="precision mediump float;\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform float uStepSize;\n\n#define KERNEL_RAD 4\n\nvec4 readTex(vec2 uv)\n{\n  return texture2D(uSampler, uv);\n}\n\nfloat getLength(vec4 vec)\n{\n    return sqrt(dot(vec, vec));\n}\n\nfloat getDistance(vec4 a, vec4 b)\n{\n    return getLength(a - b);\n}\n\nfloat getDistanceWeight(vec4 a, vec4 b)\n{\n    return 1.0 - min(getDistance(a, b) * 5.248639, 1.0);\n}\n\nvec4 blurPass(vec2 uv)\n{    \n  float bilateralWeights[KERNEL_RAD + 1];\n  bilateralWeights[0] = 0.18;\n  bilateralWeights[1] = 0.15;\n  bilateralWeights[2] = 0.12;\n  bilateralWeights[3] = 0.09; \n  bilateralWeights[4] = 0.05;\n\n  vec4 origPixel = readTex(uv);\n  vec4 sum = origPixel * bilateralWeights[0]; \n  float weightSum = bilateralWeights[0];\n\n  for (int i = 1; i <= KERNEL_RAD; i++) {\n    vec4 pixel = readTex(uv - vec2((float(i) * uStepSize), 0.0));\n    float weight = bilateralWeights[i];\n    float sampleWeight = (weight * getDistanceWeight(origPixel, pixel));\n    weightSum = (weightSum + sampleWeight);\n    sum = (sum + (pixel * sampleWeight));\n  }\n  \n  for (int i = 1; i <= KERNEL_RAD; i++) {\n    vec4 pixel = readTex(uv + vec2((float(i) * uStepSize), 0.0));\n    float weight = bilateralWeights[i];\n    float sampleWeight = (weight * getDistanceWeight(origPixel, pixel));\n    weightSum = (weightSum + sampleWeight);\n    sum = (sum + (pixel * sampleWeight));\n  }\n  \n  if ((weightSum < 0.4)) {\n      return origPixel;\n  } else {\n      if ((weightSum < 0.5)) {\n          return mix (origPixel, (sum / weightSum), ((weightSum - 0.4) / 0.1));\n      } else {\n          return (sum / weightSum);\n      };\n  };\n}\n\nvoid main() {\n  gl_FragColor = blurPass(vTextureCoord);\n}\n",beautyVPassBoxBilateralShader="precision mediump float;\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D uOrigin;\n\nuniform float uBeautyficationLevel;\nuniform float uStepSize;\n\n#define KERNEL_RAD 4\n#define HIGHPASS_ENABLED 0//%%highpassEnabled%%\n\nvec4 overlay(vec4 a, vec4 b) {\n  vec4 x = vec4(2.0) * a * b;\n  vec4 y = vec4(1.0) - vec4(2.0) * (vec4(1.0) - a) * (vec4(1.0) - b);\n  vec4 result;\n  result.r = mix(x.r, y.r, float(a.r > 0.5));\n  result.g = mix(x.g, y.g, float(a.g > 0.5));\n  result.b = mix(x.b, y.b, float(a.b > 0.5));\n  result.a = mix(x.a, y.a, float(a.a > 0.5));\n  return result;\n}\n\nvec3 rgb2xyz(vec3 c) {\n  vec3 tmp;\n  tmp.x = c.r > 0.04045 ? pow((c.r + 0.055) / 1.055, 2.4) : c.r / 12.92;\n  tmp.y = c.g > 0.04045 ? pow((c.g + 0.055) / 1.055, 2.4) : c.g / 12.92,\n  tmp.z = c.b > 0.04045 ? pow((c.b + 0.055) / 1.055, 2.4) : c.b / 12.92;\n  return 100.0 *\n  tmp *\n  mat3(0.4124, 0.3576, 0.1805, 0.2126, 0.7152, 0.0722, 0.0193, 0.1192, 0.9505);\n}\n\nvec3 xyz2lab(vec3 c) {\n  vec3 n = c / vec3(95.047, 100, 108.883);\n  vec3 v;\n  v.x = n.x > 0.008856 ? pow(n.x, 1.0 / 3.0) : 7.787 * n.x + 16.0 / 116.0;\n  v.y = n.y > 0.008856 ? pow(n.y, 1.0 / 3.0) : 7.787 * n.y + 16.0 / 116.0;\n  v.z = n.z > 0.008856 ? pow(n.z, 1.0 / 3.0) : 7.787 * n.z + 16.0 / 116.0;\n  return vec3(116.0 * v.y - 16.0, 500.0 * (v.x - v.y), 200.0 * (v.y - v.z));\n}\n\nvec3 rgb2lab(vec3 c) {\n  vec3 lab = xyz2lab(rgb2xyz(c));\n  return vec3(\n    lab.x / 100.0,\n    0.5 + 0.5 * (lab.y / 127.0),\n    0.5 + 0.5 * (lab.z / 127.0)\n  );\n}\n\nbool skin_mask(vec4 color) {\n  vec3 lab = rgb2lab(color.rgb);\n  return lab.g >= uBeautyficationLevel + 0.05 &&\n  lab.b >= uBeautyficationLevel + 0.04 &&\n  lab.r <= 0.98 &&\n  length(lab.gb) <= 0.9;\n}\n\nvec4 readOrig(vec2 uv) \n{\n  return texture2D(uOrigin, uv);\n}\n\nvec4 readTex(vec2 uv)\n{\n  return texture2D(uSampler, uv);\n}\n\nfloat getLength(vec4 vec)\n{\n    return sqrt(dot(vec, vec));\n}\n\nfloat getDistance(vec4 a, vec4 b)\n{\n    return getLength(a - b);\n}\n\nfloat getDistanceWeight(vec4 a, vec4 b)\n{\n    return 1.0 - min(getDistance(a, b) * 5.248639, 1.0);\n}\n\nint abs(int i) \n{\n  return (i<0)? -i : i;\n}\n\nvec4 blurPass(vec2 uv)\n{    \n  float bilateralWeights[KERNEL_RAD + 1];\n  bilateralWeights[0] = 0.18;\n  bilateralWeights[1] = 0.15;\n  bilateralWeights[2] = 0.12;\n  bilateralWeights[3] = 0.09; \n  bilateralWeights[4] = 0.05;\n\n  vec4 origPixel = readTex(uv);\n  vec4 sum = origPixel * bilateralWeights[0]; \n  float weightSum = bilateralWeights[0];\n\n  for (int i = 1; i <= KERNEL_RAD; i++) {\n    vec4 pixel = readTex(uv - vec2(0.0, (float(i) * uStepSize)));\n    float weight = bilateralWeights[i];\n    float sampleWeight = (weight * getDistanceWeight(origPixel, pixel));\n    weightSum = (weightSum + sampleWeight);\n    sum = (sum + (pixel * sampleWeight));\n  }\n  \n  for (int i = 1; i <= KERNEL_RAD; i++) {\n    vec4 pixel = readTex(uv + vec2(0.0, (float(i) * uStepSize)));\n    float weight = bilateralWeights[i];\n    float sampleWeight = (weight * getDistanceWeight(origPixel, pixel));\n    weightSum = (weightSum + sampleWeight);\n    sum = (sum + (pixel * sampleWeight));\n  }\n  \n  if ((weightSum < 0.4)) {\n      return origPixel;\n  } else {\n      if ((weightSum < 0.5)) {\n          return mix (origPixel, (sum / weightSum), ((weightSum - 0.4) / 0.1));\n      } else {\n          return (sum / weightSum);\n      };\n  };\n}\n\nvoid main() {\n  vec4 origin = readOrig(vTextureCoord);\n  float a = origin.a;\n\n  if (a < 0.9 || (uBeautyficationLevel < 0.95 && !skin_mask(origin))) {\n    gl_FragColor = origin;\n    return;\n  }\n\n  vec4 blurred = blurPass(vTextureCoord);\n\n#if HIGHPASS_ENABLED\n    vec4 highpass =\n      vec4(\n        origin.r - blurred.r,\n        origin.g - blurred.g,\n        origin.b - blurred.b,\n        1\n      ) +\n      vec4(0.5, 0.5, 0.5, 0);\n    vec4 highpass_inverted = vec4(\n      1.0 - highpass.r,\n      1.0 - highpass.g,\n      1.0 - highpass.b,\n      1\n    );\n    gl_FragColor = overlay(origin, highpass_inverted);\n#else \n    gl_FragColor = blurred;\n#endif\n}\n";function filterBeauty_typeof(e){return filterBeauty_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},filterBeauty_typeof(e);}function filterBeauty_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function filterBeauty_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,filterBeauty_toPropertyKey(n.key),n);}}function filterBeauty_createClass(e,t,r){return t&&filterBeauty_defineProperties(e.prototype,t),r&&filterBeauty_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function filterBeauty_toPropertyKey(e){var t=filterBeauty_toPrimitive(e,"string");return"symbol"==filterBeauty_typeof(t)?t:t+"";}function filterBeauty_toPrimitive(e,t){if("object"!=filterBeauty_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=filterBeauty_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function filterBeauty_callSuper(e,t,r){return t=filterBeauty_getPrototypeOf(t),filterBeauty_possibleConstructorReturn(e,filterBeauty_isNativeReflectConstruct()?Reflect.construct(t,r||[],filterBeauty_getPrototypeOf(e).constructor):t.apply(e,r));}function filterBeauty_possibleConstructorReturn(e,t){if(t&&("object"==filterBeauty_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return filterBeauty_assertThisInitialized(e);}function filterBeauty_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function filterBeauty_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(filterBeauty_isNativeReflectConstruct=function filterBeauty_isNativeReflectConstruct(){return!!e;})();}function filterBeauty_getPrototypeOf(e){return filterBeauty_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},filterBeauty_getPrototypeOf(e);}function filterBeauty_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&filterBeauty_setPrototypeOf(e,t);}function filterBeauty_setPrototypeOf(e,t){return filterBeauty_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},filterBeauty_setPrototypeOf(e,t);}var BlurType;function processShader(e,t){var r=t.sigma||.3*(t.radius-1)+.8;return e.replaceAll("0//%%kernelRad%%",t.radius.toString()).replaceAll("0//%%highpassEnabled%%",t.highpassEnabled?"1":"0").replaceAll("10.0//%%sigma%%","float("+r.toString()+")");}!function(e){e.prod="prod",e.boxBilateral="box_bilateral";}(BlurType||(BlurType={}));var FilterBeauty=function(e){function t(e){var r;return filterBeauty_classCallCheck(this,t),r=filterBeauty_callSuper(this,t,[void 0,processShader(e.blurType===BlurType.boxBilateral?beautyVPassBoxBilateralShader:beautyShader,e),{uBeautificationLevel:e.uBeautificationLevel,uWidth:e.uWidth,uHeight:e.uHeight}]),e.blurType===BlurType.boxBilateral&&(r.hPassFilter=new _Filter2(void 0,beautyHPassBoxBilateralShader)),r.blurType=e.blurType,r;}return filterBeauty_inherits(t,_Filter2),filterBeauty_createClass(t,[{key:"setBeautificationLevel",value:function value(e){this.uniforms.uBeautyficationLevel=e;}},{key:"apply",value:function value(e,t,r,n){if(this.blurType!==BlurType.prod){var i=e.getFilterTexture();this.hPassFilter.uniforms.uStepSize=1.5/t._frame.width,e.applyFilter(this.hPassFilter,t,i,_CLEAR_MODES.NO),this.uniforms.uStepSize=1.5/t._frame.height,this.uniforms.uOrigin=t,e.applyFilter(this,i,r,n),e.returnFilterTexture(i);}else e.applyFilter(this,t,r,n);}}]);}();var showShader="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vOriginCoord;\nvarying vec2 vOutputFrame;\nvarying vec2 vInputSize;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\nuniform mat3 uTransformMatrix;\n\nvec4 filterVertexPosition(void ) {\n  vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.0)) + outputFrame.xy;\n\n  return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord(void ) {\n  return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void ) {\n  gl_Position = filterVertexPosition();\n  vTextureCoord = filterTextureCoord();\n\n  vOutputFrame = outputFrame.zw;\n  vInputSize = inputSize.xy;\n\n  vOriginCoord = (uTransformMatrix * vec3(vTextureCoord * inputSize.xy / outputFrame.zw, 1.0)).xy;\n}\n",show_showShader="uniform sampler2D uSampler;\nuniform sampler2D uOriginFrame;\n\nuniform bool useMask;\nuniform float distColor;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vOriginCoord;\nvarying vec2 vOutputFrame;\nvarying vec2 vInputSize;\n\nvoid main() {\n  float personMask = texture2D(uSampler, vTextureCoord).r;\n\n  personMask = smoothstep(0.0, 1.0, personMask);\n  personMask = smoothstep(0.0, 1.0, personMask);\n  personMask = smoothstep(0.0, 1.0, personMask);\n\n  vec4 personFrame = texture2D(uOriginFrame, vOriginCoord);\n  \n  //rounded video preparation\n  //gl_FragColor = mix(vec4(0), personFrame, step(distance(vec2(vOriginCoord.x , vOriginCoord.y * vOutputFrame.y/vOutputFrame.x), vec2(0.5, 0.5 * vOutputFrame.y/vOutputFrame.x) ), 0.281) );\n  //step(distance(vTextureCoord.y, 0.5), 0.5)\n\n  if (useMask) {\n    gl_FragColor = mix(vec4(0), personFrame, personMask);  \n  } else {\n    gl_FragColor = mix(vec4(0), personFrame, distColor);\n  }\n}\n";function filterShow_typeof(e){return filterShow_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},filterShow_typeof(e);}function filterShow_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function filterShow_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,filterShow_toPropertyKey(n.key),n);}}function filterShow_createClass(e,t,r){return t&&filterShow_defineProperties(e.prototype,t),r&&filterShow_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function filterShow_toPropertyKey(e){var t=filterShow_toPrimitive(e,"string");return"symbol"==filterShow_typeof(t)?t:t+"";}function filterShow_toPrimitive(e,t){if("object"!=filterShow_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=filterShow_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function filterShow_callSuper(e,t,r){return t=filterShow_getPrototypeOf(t),filterShow_possibleConstructorReturn(e,filterShow_isNativeReflectConstruct()?Reflect.construct(t,r||[],filterShow_getPrototypeOf(e).constructor):t.apply(e,r));}function filterShow_possibleConstructorReturn(e,t){if(t&&("object"==filterShow_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return filterShow_assertThisInitialized(e);}function filterShow_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function filterShow_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(filterShow_isNativeReflectConstruct=function filterShow_isNativeReflectConstruct(){return!!e;})();}function filterShow_getPrototypeOf(e){return filterShow_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},filterShow_getPrototypeOf(e);}function filterShow_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&filterShow_setPrototypeOf(e,t);}function filterShow_setPrototypeOf(e,t){return filterShow_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},filterShow_setPrototypeOf(e,t);}var FilterShow=function(e){function t(e,r,n){var i;return filterShow_classCallCheck(this,t),(i=filterShow_callSuper(this,t,[showShader,show_showShader,Object.assign({},e)])).matrix=new _Matrix(),i.originalFrame=r,i.maskSprite=n,i.setLayout(),i;}return filterShow_inherits(t,_Filter2),filterShow_createClass(t,[{key:"setLayout",value:function value(){var e=this.maskSprite.position.x<0?1-Math.abs(this.maskSprite.position.x)/this.maskSprite.width:(this.originalFrame.width-this.maskSprite.position.x)/this.maskSprite.width;e=Math.min(1,e);var t=this.maskSprite.position.x<0?-this.maskSprite.position.x/this.maskSprite.width:0,r=this.maskSprite.position.y<0?1-Math.abs(this.maskSprite.position.y)/this.maskSprite.height:(this.originalFrame.height-this.maskSprite.position.y)/this.maskSprite.height;r=Math.min(1,r);var n=this.maskSprite.position.y<0?-this.maskSprite.position.y/this.maskSprite.height:0;this.matrix.a=e,this.matrix.d=r,this.matrix.tx=t,this.matrix.ty=n,this.uniforms.uTransformMatrix=this.matrix;}},{key:"setOrigin",value:function value(e){this.uniforms.uOriginFrame=e;}},{key:"setLayoutMode",value:function value(e){switch(e){case"segmentation":this.uniforms.useMask=!0,this.uniforms.distColor=0;break;case"circle":case"hide":this.uniforms.useMask=!1,this.uniforms.distColor=0;break;case"full":this.uniforms.useMask=!1,this.uniforms.distColor=1;}}},{key:"setIsBoundaryStrong",value:function value(e){this.uniforms.uIsBoundaryStrong=e;}}]);}();var nchwShader="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec2 pixelSize;\nuniform vec2 quarter;\nuniform vec2 _vrScale;\nuniform vec4 toPosTransform;\nuniform vec4 fromPosTransform;\nvec4 readTex(vec2 uv)\n{\n    return texture2D(uSampler, uv);\n}\nvec2 mapInsideChannel(vec2 pos)\n{\n    vec2 result = mod(pos, quarter) * 4.0;\n    result.y += floor(pos.x / quarter.x);\n    \n    return result;\n}\nvec4 extractChannel(vec4 c0, vec4 c1, vec4 c2, vec4 c3, float yPos)\n{\n    vec4 result = vec4(c0.r, c1.r, c2.r, c3.r);\n    \n    float condition = step(quarter.y, yPos);\n    result = mix(result, vec4(c0.g, c1.g, c2.g, c3.g), condition);\n    condition = step(2.0 * quarter.y, yPos);\n    result = mix(result, vec4(c0.b, c1.b, c2.b, c3.b), condition);\n    \n    \n    return result;\n}\nvec2 toPos(vec2 uv)\n{\n    return uv * toPosTransform.xy + toPosTransform.zw;\n}\nvec2 fromPos(vec2 pos)\n{\n    return ( pos * fromPosTransform.xy ) + fromPosTransform.zw;\n}\nvoid main()\n{\n    vec2 uv = vTextureCoord;\n    \n    vec2 pos = toPos(uv);\n    vec2 chPos = mapInsideChannel(pos);\n    uv = fromPos(chPos);\n    \n    vec4 c0 = readTex(uv);\n    uv.x += pixelSize.x; \n    vec4 c1 = readTex(uv);\n    uv.x += pixelSize.x; \n    vec4 c2 = readTex(uv);\n    uv.x += pixelSize.x; \n    vec4 c3 = readTex(uv);\n    gl_FragColor = extractChannel(c0, c1, c2, c3, pos.y);\n}";function filterNCHW_typeof(e){return filterNCHW_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},filterNCHW_typeof(e);}function filterNCHW_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function filterNCHW_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,filterNCHW_toPropertyKey(n.key),n);}}function filterNCHW_createClass(e,t,r){return t&&filterNCHW_defineProperties(e.prototype,t),r&&filterNCHW_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function filterNCHW_toPropertyKey(e){var t=filterNCHW_toPrimitive(e,"string");return"symbol"==filterNCHW_typeof(t)?t:t+"";}function filterNCHW_toPrimitive(e,t){if("object"!=filterNCHW_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=filterNCHW_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function filterNCHW_callSuper(e,t,r){return t=filterNCHW_getPrototypeOf(t),filterNCHW_possibleConstructorReturn(e,filterNCHW_isNativeReflectConstruct()?Reflect.construct(t,r||[],filterNCHW_getPrototypeOf(e).constructor):t.apply(e,r));}function filterNCHW_possibleConstructorReturn(e,t){if(t&&("object"==filterNCHW_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return filterNCHW_assertThisInitialized(e);}function filterNCHW_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function filterNCHW_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(filterNCHW_isNativeReflectConstruct=function filterNCHW_isNativeReflectConstruct(){return!!e;})();}function filterNCHW_getPrototypeOf(e){return filterNCHW_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},filterNCHW_getPrototypeOf(e);}function filterNCHW_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&filterNCHW_setPrototypeOf(e,t);}function filterNCHW_setPrototypeOf(e,t){return filterNCHW_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},filterNCHW_setPrototypeOf(e,t);}var FilterNCHW=function(e){function t(e,r){var n;return filterNCHW_classCallCheck(this,t),(n=filterNCHW_callSuper(this,t,[void 0,nchwShader])).setSize(e,r),n;}return filterNCHW_inherits(t,_Filter2),filterNCHW_createClass(t,[{key:"setSize",value:function value(e,t){var r=e,n=t;t>128&&(n=256),e<256&&(r=256),this.virtualSize=new _Point(e,t),this.realSize=new _Point(r,n),this._vrScale=new _Point(this.realSize.x/this.virtualSize.x,this.realSize.y/this.virtualSize.y),this.pixelSize=new _Point(1/this.realSize.x,1/this.realSize.y),this.quarter=new _Point(this.virtualSize.x/4,this.virtualSize.y/4),this.toPosTransform=[1/((this.virtualSize.x-1)*this.pixelSize.x)*(this.virtualSize.x-1),1/((this.virtualSize.y-1)*this.pixelSize.y)*(this.virtualSize.y-1),-.5*this.pixelSize.x*(1/((this.virtualSize.x-1)*this.pixelSize.x)*(this.virtualSize.x-1)),-.5*this.pixelSize.y*(1/((this.virtualSize.y-1)*this.pixelSize.y)*(this.virtualSize.y-1))],this.fromPosTransform=[(this.virtualSize.x-1)*this.pixelSize.x/(this.virtualSize.x-1),(this.virtualSize.y-1)*this.pixelSize.y/(this.virtualSize.y-1),.5*this.pixelSize.x,.5*this.pixelSize.y],this.uniforms.pixelSize=this.pixelSize,this.uniforms.quarter=this.quarter,this.uniforms.toPosTransform=this.toPosTransform,this.uniforms.fromPosTransform=this.fromPosTransform;}}]);}();var blurKawaseShader="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec2 uOffset;\n\nuniform int uHasMask;\nuniform sampler2D uMask;\n\nuniform int uClamped;\nuniform vec4 filterClamp;\n\nuniform mat3 uTransformMatrix;\n\nbool checkCoord(vec2 coord) {\n  vec4 color = texture2D(uMask, coord);\n  return color.r < 0.5;\n}\n\nvoid main(void ) {\n  vec4 color = vec4(0.0);\n  bool hasMask = uHasMask > 0;\n  bool isClamped = uClamped > 0;\n  bool isInside = hasMask && !checkCoord(vTextureCoord);\n\n  vec2 pickCoord[4];\n  pickCoord[0] = vTextureCoord + vec2(-1.0, +1.0) * uOffset;\n  pickCoord[1] = vTextureCoord + vec2(+1.0, +1.0) * uOffset;\n  pickCoord[2] = vTextureCoord + vec2(+1.0, -1.0) * uOffset;\n  pickCoord[3] = vTextureCoord + vec2(-1.0, -1.0) * uOffset;\n\n  for (int i = 0; i < 4; i += 1) {\n    vec2 coord = pickCoord[i];\n\n    //. Get original point if needed\n    if (hasMask && !isInside && !checkCoord(pickCoord[i])) {\n      coord = vTextureCoord;\n    }\n\n    //. Check clamped mode\n    color += isClamped\n      ? texture2D(uSampler, clamp(coord, filterClamp.xy, filterClamp.zw))\n      : texture2D(uSampler, coord);\n  }\n\n  gl_FragColor = color * 0.25;\n}\n";function filterBlurKawase_typeof(e){return filterBlurKawase_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},filterBlurKawase_typeof(e);}function filterBlurKawase_toConsumableArray(e){return filterBlurKawase_arrayWithoutHoles(e)||filterBlurKawase_iterableToArray(e)||filterBlurKawase_unsupportedIterableToArray(e)||filterBlurKawase_nonIterableSpread();}function filterBlurKawase_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function filterBlurKawase_unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return filterBlurKawase_arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?filterBlurKawase_arrayLikeToArray(e,t):void 0;}}function filterBlurKawase_iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e);}function filterBlurKawase_arrayWithoutHoles(e){if(Array.isArray(e))return filterBlurKawase_arrayLikeToArray(e);}function filterBlurKawase_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n;}function filterBlurKawase_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function filterBlurKawase_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,filterBlurKawase_toPropertyKey(n.key),n);}}function filterBlurKawase_createClass(e,t,r){return t&&filterBlurKawase_defineProperties(e.prototype,t),r&&filterBlurKawase_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function filterBlurKawase_toPropertyKey(e){var t=filterBlurKawase_toPrimitive(e,"string");return"symbol"==filterBlurKawase_typeof(t)?t:t+"";}function filterBlurKawase_toPrimitive(e,t){if("object"!=filterBlurKawase_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=filterBlurKawase_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function filterBlurKawase_callSuper(e,t,r){return t=filterBlurKawase_getPrototypeOf(t),filterBlurKawase_possibleConstructorReturn(e,filterBlurKawase_isNativeReflectConstruct()?Reflect.construct(t,r||[],filterBlurKawase_getPrototypeOf(e).constructor):t.apply(e,r));}function filterBlurKawase_possibleConstructorReturn(e,t){if(t&&("object"==filterBlurKawase_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return filterBlurKawase_assertThisInitialized(e);}function filterBlurKawase_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function filterBlurKawase_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(filterBlurKawase_isNativeReflectConstruct=function filterBlurKawase_isNativeReflectConstruct(){return!!e;})();}function filterBlurKawase_getPrototypeOf(e){return filterBlurKawase_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},filterBlurKawase_getPrototypeOf(e);}function filterBlurKawase_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&filterBlurKawase_setPrototypeOf(e,t);}function filterBlurKawase_setPrototypeOf(e,t){return filterBlurKawase_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},filterBlurKawase_setPrototypeOf(e,t);}var FilterBlurKawase=function(e){function t(e){var r,n,i;return filterBlurKawase_classCallCheck(this,t),(r=filterBlurKawase_callSuper(this,t,[void 0,blurKawaseShader]))._kernels=[],r._blur=4,r._quality=3,r.isMaskEnabled=!0,r.uniforms.uOffset=new Float32Array(2),r.uniforms.uClamped=e.clamp?1:0,r.uniforms.uHasMask=0,r.uniforms.uMask=Texture_Texture.WHITE,r.uniforms.uTransformMatrix=new _Matrix(),r._pixelSize=new _Point(),r.pixelSize=1,r._clamp=!!e.clamp,Array.isArray(e.blur)?r.kernels=e.blur:(r._blur=null!==(n=e.blur)&&void 0!==n?n:4,r.quality=null!==(i=e.quality)&&void 0!==i?i:3),r;}return filterBlurKawase_inherits(t,_Filter2),filterBlurKawase_createClass(t,[{key:"apply",value:function value(e,t,r,n){var i,o=this._pixelSize.x/t._frame.width,a=this._pixelSize.y/t._frame.height;if(1===this._quality||0===this._blur)i=this._kernels[0]+.5,this.uniforms.uOffset[0]=i*o,this.uniforms.uOffset[1]=i*a,e.applyFilter(this,t,r,n);else{for(var s,u=e.getFilterTexture(),l=t,c=u,h=this._quality-1,f=0;f<h;f++)i=this._kernels[f]+.5,this.uniforms.uOffset[0]=i*o,this.uniforms.uOffset[1]=i*a,e.applyFilter(this,l,c,1),s=l,l=c,c=s;i=this._kernels[h]+.5,this.uniforms.uOffset[0]=i*o,this.uniforms.uOffset[1]=i*a,e.applyFilter(this,l,r,n),e.returnFilterTexture(u);}}},{key:"_updatePadding",value:function value(){this.padding=Math.ceil(this._kernels.reduce(function(e,t){return e+t+.5;},0));}},{key:"_generateKernels",value:function value(){var e=this._blur,t=this._quality,r=[e];if(e>0)for(var n=e,i=e/t,o=1;o<t;o++)n-=i,r.push(n);this._kernels=r,this._updatePadding();}},{key:"kernels",get:function get(){return this._kernels;},set:function set(e){Array.isArray(e)&&e.length>0?(this._kernels=e,this._quality=e.length,this._blur=Math.max.apply(Math,filterBlurKawase_toConsumableArray(e))):(this._kernels=[0],this._quality=1);}},{key:"clamp",get:function get(){return this._clamp;}},{key:"pixelSize",get:function get(){return this._pixelSize;},set:function set(e){"number"==typeof e?(this._pixelSize.x=e,this._pixelSize.y=e):Array.isArray(e)?(this._pixelSize.x=e[0],this._pixelSize.y=e[1]):e instanceof _Point?(this._pixelSize.x=e.x,this._pixelSize.y=e.y):(this._pixelSize.x=1,this._pixelSize.y=1);}},{key:"quality",get:function get(){return this._quality;},set:function set(e){this._quality=Math.max(1,Math.round(e)),this._generateKernels();}},{key:"blur",get:function get(){return this._blur;},set:function set(e){this._blur=e,this._generateKernels();}},{key:"enableMask",value:function value(){this.isMaskEnabled=!0;}},{key:"disableMask",value:function value(){this.isMaskEnabled=!1;}},{key:"setMask",value:function value(e){this.uniforms.uMask=e,this.uniforms.uHasMask=this.isMaskEnabled?1:0;}}]);}();var mirrorShaderVert="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\nuniform mat3 uTransformMatrix;\n\nvec4 filterVertexPosition(void ) {\n  vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.0)) + outputFrame.xy;\n\n  return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord(void ) {\n  return vec2(1.0 - aVertexPosition.x, aVertexPosition.y) * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void ) {\n  gl_Position = filterVertexPosition();\n  vTextureCoord = filterTextureCoord();\n}\n";function filterMirror_typeof(e){return filterMirror_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},filterMirror_typeof(e);}function filterMirror_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,filterMirror_toPropertyKey(n.key),n);}}function filterMirror_createClass(e,t,r){return t&&filterMirror_defineProperties(e.prototype,t),r&&filterMirror_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function filterMirror_toPropertyKey(e){var t=filterMirror_toPrimitive(e,"string");return"symbol"==filterMirror_typeof(t)?t:t+"";}function filterMirror_toPrimitive(e,t){if("object"!=filterMirror_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=filterMirror_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function filterMirror_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function filterMirror_callSuper(e,t,r){return t=filterMirror_getPrototypeOf(t),filterMirror_possibleConstructorReturn(e,filterMirror_isNativeReflectConstruct()?Reflect.construct(t,r||[],filterMirror_getPrototypeOf(e).constructor):t.apply(e,r));}function filterMirror_possibleConstructorReturn(e,t){if(t&&("object"==filterMirror_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return filterMirror_assertThisInitialized(e);}function filterMirror_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function filterMirror_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(filterMirror_isNativeReflectConstruct=function filterMirror_isNativeReflectConstruct(){return!!e;})();}function filterMirror_getPrototypeOf(e){return filterMirror_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},filterMirror_getPrototypeOf(e);}function filterMirror_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&filterMirror_setPrototypeOf(e,t);}function filterMirror_setPrototypeOf(e,t){return filterMirror_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},filterMirror_setPrototypeOf(e,t);}var FilterMirror=function(e){function t(){return filterMirror_classCallCheck(this,t),filterMirror_callSuper(this,t,[mirrorShaderVert,void 0]);}return filterMirror_inherits(t,_Filter2),filterMirror_createClass(t);}();function Model_typeof(e){return Model_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},Model_typeof(e);}function Model_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function Model_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Model_toPropertyKey(n.key),n);}}function Model_createClass(e,t,r){return t&&Model_defineProperties(e.prototype,t),r&&Model_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function Model_toPropertyKey(e){var t=Model_toPrimitive(e,"string");return"symbol"==Model_typeof(t)?t:t+"";}function Model_toPrimitive(e,t){if("object"!=Model_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Model_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function Model_callSuper(e,t,r){return t=Model_getPrototypeOf(t),Model_possibleConstructorReturn(e,Model_isNativeReflectConstruct()?Reflect.construct(t,r||[],Model_getPrototypeOf(e).constructor):t.apply(e,r));}function Model_possibleConstructorReturn(e,t){if(t&&("object"==Model_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Model_assertThisInitialized(e);}function Model_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function Model_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(Model_isNativeReflectConstruct=function Model_isNativeReflectConstruct(){return!!e;})();}function Model_getPrototypeOf(e){return Model_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},Model_getPrototypeOf(e);}function Model_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Model_setPrototypeOf(e,t);}function Model_setPrototypeOf(e,t){return Model_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},Model_setPrototypeOf(e,t);}var Model=function(e){function t(){return Model_classCallCheck(this,t),Model_callSuper(this,t);}return Model_inherits(t,eventemitter3),Model_createClass(t,[{key:"set",value:function value(e,t,r){this.preset=e,this.width=t,this.height=r,this.size=4*this.width*this.height,this.emit("update",this);}}]);}();function bufferPool_typeof(e){return bufferPool_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},bufferPool_typeof(e);}function bufferPool_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function bufferPool_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bufferPool_toPropertyKey(n.key),n);}}function bufferPool_createClass(e,t,r){return t&&bufferPool_defineProperties(e.prototype,t),r&&bufferPool_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function bufferPool_toPropertyKey(e){var t=bufferPool_toPrimitive(e,"string");return"symbol"==bufferPool_typeof(t)?t:t+"";}function bufferPool_toPrimitive(e,t){if("object"!=bufferPool_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=bufferPool_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var BufferPool=function(){return bufferPool_createClass(function e(){bufferPool_classCallCheck(this,e),this.u8Buffers={},this.f32Buffers={};},[{key:"getBuffer",value:function value(e,t){var r,n;return null!==(n=null===(r=("f32"===e?this.f32Buffers:this.u8Buffers)[t])||void 0===r?void 0:r.pop())&&void 0!==n?n:"f32"===e?new Float32Array(t):new Uint8Array(t);}},{key:"returnBuffer",value:function value(e){e instanceof Float32Array?this.returnBufferAs(e,this.f32Buffers,e.length):this.returnBufferAs(e,this.u8Buffers,e.length);}},{key:"returnBufferAs",value:function value(e,t,r){var n=t[r];void 0!==n?n.push(e):t[r]=[e];}}]);}();function preset_callSuper(e,t,r){return t=preset_getPrototypeOf(t),preset_possibleConstructorReturn(e,preset_isNativeReflectConstruct()?Reflect.construct(t,r||[],preset_getPrototypeOf(e).constructor):t.apply(e,r));}function preset_possibleConstructorReturn(e,t){if(t&&("object"==preset_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return preset_assertThisInitialized(e);}function preset_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function preset_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(preset_isNativeReflectConstruct=function preset_isNativeReflectConstruct(){return!!e;})();}function preset_getPrototypeOf(e){return preset_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},preset_getPrototypeOf(e);}function preset_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&preset_setPrototypeOf(e,t);}function preset_setPrototypeOf(e,t){return preset_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},preset_setPrototypeOf(e,t);}function preset_typeof(e){return preset_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},preset_typeof(e);}function preset_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function preset_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,preset_toPropertyKey(n.key),n);}}function preset_createClass(e,t,r){return t&&preset_defineProperties(e.prototype,t),r&&preset_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function preset_toPropertyKey(e){var t=preset_toPrimitive(e,"string");return"symbol"==preset_typeof(t)?t:t+"";}function preset_toPrimitive(e,t){if("object"!=preset_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=preset_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var SegmentationModel=function(){return preset_createClass(function e(t){preset_classCallCheck(this,e),this.isLandscape=!0,this.sdkOptions=t,this.landscapeSize={height:144,width:256},this.portraitSize={height:192,width:192},this.updateOrientation();},[{key:"isOrientationChanged",value:function value(){return this.isLandscape!=this.sdkOptions.isLandscape();}},{key:"updateOrientation",value:function value(){this.isLandscape=this.sdkOptions.isLandscape();}},{key:"getModelSize",value:function value(){return this.isLandscape?this.landscapeSize:this.portraitSize;}},{key:"getURL",value:function value(){var e=this.isLandscape?"PRESETS":"PRESETS_PORTRAIT",t=src_settings.yy[e][this.preset];return t?src_settings.yy.getPresetUrl(t):src_settings.yy.MODEL_URL;}}]);}(),SegmentationModelQuality=function(e){function t(e){var r;return preset_classCallCheck(this,t),(r=preset_callSuper(this,t,[e])).preset="quality",r;}return preset_inherits(t,SegmentationModel),preset_createClass(t);}(),SegmentationModelBalanced=function(e){function t(e){var r;return preset_classCallCheck(this,t),(r=preset_callSuper(this,t,[e])).preset="balanced",r.landscapeSize={height:128,width:256},r;}return preset_inherits(t,SegmentationModel),preset_createClass(t);}(),SegmentationModelSpeed=function(e){function t(e){var r;return preset_classCallCheck(this,t),(r=preset_callSuper(this,t,[e])).preset="speed",r.landscapeSize={height:160,width:256},r;}return preset_inherits(t,SegmentationModel),preset_createClass(t);}(),SegmentationModelLightning=function(e){function t(e){var r;return preset_classCallCheck(this,t),(r=preset_callSuper(this,t,[e])).preset="lightning",r;}return preset_inherits(t,SegmentationModel),preset_createClass(t);}(),PresetManager=function(){return preset_createClass(function e(t){preset_classCallCheck(this,e),this.modelMap=new Map(),this.modelMap.set("balanced",new SegmentationModelBalanced(t)),this.modelMap.set("quality",new SegmentationModelQuality(t)),this.modelMap.set("speed",new SegmentationModelSpeed(t)),this.modelMap.set("lightning",new SegmentationModelLightning(t));},[{key:"isOrientationChanged",value:function value(e){var t;return null===(t=this.getModel(e))||void 0===t?void 0:t.isOrientationChanged();}},{key:"updateOrientation",value:function value(){return this.modelMap.forEach(function(e,t){e.updateOrientation();});}},{key:"getModelSize",value:function value(e){var t,r;return null!==(r=null===(t=this.getModel(e))||void 0===t?void 0:t.getModelSize())&&void 0!==r?r:{height:144,width:256};}},{key:"getModelURL",value:function value(e){var t,r;return null!==(r=null===(t=this.getModel(e))||void 0===t?void 0:t.getURL())&&void 0!==r?r:"";}},{key:"getModel",value:function value(e){return this.modelMap.has(e)?this.modelMap.get(e):(errorBus.bv.notify({emitter:errorBus.JK.PRESET_INIT,message:"Can't find preset ".concat(e)}),null);}}]);}();function Background_typeof(e){return Background_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},Background_typeof(e);}function Background_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function Background_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Background_toPropertyKey(n.key),n);}}function Background_createClass(e,t,r){return t&&Background_defineProperties(e.prototype,t),r&&Background_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function Background_toPropertyKey(e){var t=Background_toPrimitive(e,"string");return"symbol"==Background_typeof(t)?t:t+"";}function Background_toPrimitive(e,t){if("object"!=Background_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Background_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function Background_callSuper(e,t,r){return t=Background_getPrototypeOf(t),Background_possibleConstructorReturn(e,Background_isNativeReflectConstruct()?Reflect.construct(t,r||[],Background_getPrototypeOf(e).constructor):t.apply(e,r));}function Background_possibleConstructorReturn(e,t){if(t&&("object"==Background_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Background_assertThisInitialized(e);}function Background_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function Background_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(Background_isNativeReflectConstruct=function Background_isNativeReflectConstruct(){return!!e;})();}function Background_getPrototypeOf(e){return Background_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},Background_getPrototypeOf(e);}function Background_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Background_setPrototypeOf(e,t);}function Background_setPrototypeOf(e,t){return Background_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},Background_setPrototypeOf(e,t);}var Background=function(e){function t(e,r,n){var i;return Background_classCallCheck(this,t),(i=Background_callSuper(this,t)).filters={blur:{}},i.sdkOptions=e,i.type="origin",i.options=Object.assign({},t.defaultOptions,n),i.frame=r,i.filters.blur=new FilterBlurKawase({blur:5,quality:5}),i.backgroundTrack=new VideoTrack(),i.backgroundTrack.on("ended",i.clearBackground,i),i.backgroundTrack.on("update",i.calculateBackgroundSize,i),i.globalWidth=e.width,i.globalHeight=e.height,i.sdkOptions.on("update",i.onOptionsUpdate,i),i;}return Background_inherits(t,eventemitter3),Background_createClass(t,[{key:"destroy",value:function value(){this.backgroundTrack.off("ended",this.clearBackground,this),this.backgroundTrack.off("update",this.calculateBackgroundSize,this),this.sdkOptions.off("update",this.onOptionsUpdate,this);}},{key:"onOptionsUpdate",value:function value(e){this.globalWidth=e.width,this.globalHeight=e.height,this.frame.resize(this.globalWidth,this.globalHeight),this.calculateBackgroundSize();}},{key:"render",value:function value(){this.backgroundTrack.update(),document.hidden&&this.frame.frame.texture.baseTexture.resource&&this.frame.frame.texture.baseTexture.resource.source instanceof HTMLVideoElement&&this.frame.frame.texture.baseTexture.update();}},{key:"set",value:function value(e){this.backgroundTrack.stop(),this.applyBackground(e);}},{key:"applyBlur",value:function value(e){this.frame.frame.filters=[],this.filters.blur.disableMask(),e&&(this.filters.blur.blur=+e,this.frame.frame.filters.push(this.filters.blur),"origin"==this.frame.active&&this.filters.blur.enableMask());}},{key:"setMask",value:function value(e){this.filters.blur.blur&&this.filters.blur.setMask(e);}},{key:"applyBackground",value:function value(e){var t,r=this;if(this.frame.frame.tint="color"==e?this.options.color:16777215,this.options.source!=e){if(this.options.source=e,null==e)return this.type="origin",void(this.frame.active!==this.type&&(this.frame.activateTexture(this.type),this.calculateBackgroundSize(),(null===(t=this.frame.frame.filters)||void 0===t?void 0:t.length)&&"origin"==this.frame.active?this.filters.blur.enableMask():this.filters.blur.disableMask()));var n,i,o;switch(e.constructor){case String:"color"==e?(this.type="color",n=Texture_Texture.WHITE):(n=e,this.type="url");break;case MediaStream:this.backgroundTrack.set(e),(i=document.createElement("video")).srcObject=e,n=i,this.type="media_stream";break;case CanvasCaptureMediaStreamTrack:case BrowserCaptureMediaStreamTrack:case MediaStreamTrack:o=new MediaStream([e]),this.backgroundTrack.set(o),(i=document.createElement("video")).srcObject=o,n=i,this.type="media_stream_track";break;case HTMLVideoElement:n=e,this.type="video";}if(n&&n instanceof Texture_Texture)this.texture=n;else{if(e.constructor==String)return void Texture_Texture.fromURL(n).then(function(e){r.texture=e,r.onBackgroundLoaded();});this.texture=Texture_Texture.from(n);}this.texture.baseTexture.valid?this.onBackgroundLoaded():this.texture.baseTexture.once("loaded",function(){return r.onBackgroundLoaded();});}}},{key:"onBackgroundLoaded",value:function value(){this.texture.baseTexture&&(this.frame.addTexture("swap",this.texture),this.switchBackground(),this.calculateBackgroundSize(),this.loopAndRestart());}},{key:"loopAndRestart",value:function value(){this.frame.frame.texture.baseTexture.resource.source instanceof HTMLVideoElement&&(this.frame.frame.texture.baseTexture.resource.source.loop=!0,this.frame.frame.texture.baseTexture.resource.source.currentTime=0,this.frame.frame.texture.baseTexture.resource.source.muted=!0);}},{key:"setColor",value:function value(e){this.options.color=e,this.frame.frame.tint=this.options.color;}},{key:"switchBackground",value:function value(){var e;this.frame.activateTexture("swap"),"color"==this.type&&(this.frame.frame.tint=this.options.color),(null===(e=this.frame.frame.filters)||void 0===e?void 0:e.length)&&"origin"==this.frame.active?this.filters.blur.enableMask():this.filters.blur.disableMask(),this.emit("update",this);}},{key:"clearBackground",value:function value(){this.backgroundTrack.stop(),this.applyBackground(null),this.emit("clear",this);}},{key:"updateBackgroundSize",value:function value(e,t,r,n){this.frame.frame.width=r,this.frame.frame.height=n,this.frame.frame.x=e,this.frame.frame.y=t;}},{key:"setFitMode",value:function value(e){this.options.fit_mode=e,this.calculateBackgroundSize();}},{key:"calculateBackgroundSize",value:function value(){var e=this.globalWidth,t=this.globalHeight;if("color"!=this.type&&"origin"!=this.type){if(!(this.frame.frame.texture.baseTexture.width<20)){var r=this.frame.frame.texture.baseTexture.width/this.frame.frame.texture.baseTexture.height;"fill"==this.options.fit_mode?e/r>=t?this.updateBackgroundSize(0,-Math.abs(t-e/r)/2,e,e/r):this.updateBackgroundSize(-Math.abs(e-t*r)/2,0,t*r,t):e/r<=t?this.updateBackgroundSize(0,Math.abs(t-e/r)/2,e,e/r):this.updateBackgroundSize(Math.abs(e-t*r)/2,0,t*r,t);}}else this.updateBackgroundSize(0,0,e,t);}}]);}(),LayoutMode;function virtual_background_effect_typeof(e){return virtual_background_effect_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},virtual_background_effect_typeof(e);}function virtual_background_effect_regeneratorRuntime(){virtual_background_effect_regeneratorRuntime=function virtual_background_effect_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==virtual_background_effect_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(virtual_background_effect_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function virtual_background_effect_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function virtual_background_effect_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){virtual_background_effect_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){virtual_background_effect_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function virtual_background_effect_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function virtual_background_effect_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,virtual_background_effect_toPropertyKey(n.key),n);}}function virtual_background_effect_createClass(e,t,r){return t&&virtual_background_effect_defineProperties(e.prototype,t),r&&virtual_background_effect_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function virtual_background_effect_toPropertyKey(e){var t=virtual_background_effect_toPrimitive(e,"string");return"symbol"==virtual_background_effect_typeof(t)?t:t+"";}function virtual_background_effect_toPrimitive(e,t){if("object"!=virtual_background_effect_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=virtual_background_effect_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function virtual_background_effect_callSuper(e,t,r){return t=virtual_background_effect_getPrototypeOf(t),virtual_background_effect_possibleConstructorReturn(e,virtual_background_effect_isNativeReflectConstruct()?Reflect.construct(t,r||[],virtual_background_effect_getPrototypeOf(e).constructor):t.apply(e,r));}function virtual_background_effect_possibleConstructorReturn(e,t){if(t&&("object"==virtual_background_effect_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return virtual_background_effect_assertThisInitialized(e);}function virtual_background_effect_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function virtual_background_effect_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(virtual_background_effect_isNativeReflectConstruct=function virtual_background_effect_isNativeReflectConstruct(){return!!e;})();}function virtual_background_effect_getPrototypeOf(e){return virtual_background_effect_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},virtual_background_effect_getPrototypeOf(e);}function virtual_background_effect_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&virtual_background_effect_setPrototypeOf(e,t);}function virtual_background_effect_setPrototypeOf(e,t){return virtual_background_effect_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},virtual_background_effect_setPrototypeOf(e,t);}Background.defaultOptions={source:null,fit_mode:"fill",color:16777215},function(e){e.SEGMENTATION="segmentation",e.FULL="full",e.HIDE="hide",e.TRANSPARENT="transparent",e.CIRCLE="circle";}(LayoutMode||(LayoutMode={}));var VirtualBackgroundEffect=function(e){function t(e,r){var n;return virtual_background_effect_classCallCheck(this,t),(n=virtual_background_effect_callSuper(this,t,[e])).pixels=[],n.filters={blurMask:{},show:{},beautification:{},nchw:{},mirror:{}},n.skip_frames_counter=0,n.customLayoutOptions={width:1280,height:720,xOffset:0,yOffset:0},n.customLayoutOptions.width=e.width,n.customLayoutOptions.height=e.height,n.customer_id=r,n.presetManager=new PresetManager(n.sdkOptions),n.inferenceTimer=new FrameTimer(),n.drawTimer=new FrameTimer(),n.settings={boundary_level:0,boundary_mode:"strong",beautification:!1,beautification_level:.48,beautification_highpass:!0,beautification_radius:7,beautification_blur_type:BlurType.boxBilateral,blur:0,layout:"center",preset:src_settings.yy.PRESET,skip_frames:!1,layout_mode:LayoutMode.SEGMENTATION},n.bufferPool=new BufferPool(),n.model=new Model(),n.model.on("update",n.updateModelSize,n),n.is_running=!1,n.isNewPreset=!1,n.enable(),n;}return virtual_background_effect_inherits(t,AbstractEffect),virtual_background_effect_createClass(t,[{key:"onOptionsUpdate",value:function value(){this.original.resize(this.sdkOptions.width,this.sdkOptions.height),this.mask.resize(this.sdkOptions.width,this.sdkOptions.height),this.effectContainer.height=this.sdkOptions.height,this.effectContainer.width=this.sdkOptions.width,this.applyLayout();}},{key:"clearBuffers",value:function value(){this.pixels=[],this.bufferPool=new BufferPool();}},{key:"nextFrame",value:function value(e){var t,r;if(this.enabled&&this.isActive()&&!(this.pixels.length>0)){if(this.small.addTexture("frame",e.texture),this.small.activateTexture("frame"),this.resources.transform){var n=this.resources.transform.xOffset,i=this.resources.transform.yOffset,o=Math.abs(this.sdkOptions.width*this.resources.transform.scaleValue),a=Math.abs(this.sdkOptions.height*this.resources.transform.scaleValue);this.resources.mirror&&(n=this.sdkOptions.width-this.resources.transform.xOffset-o),this.small.frame.texture.trim=new _Rectangle(n,i,o,a);}this.resources.mirror&&(null===(t=this.small.frame.filters)||void 0===t||t.push(this.filters.mirror)),null===(r=this.small.frame.filters)||void 0===r||r.push(this.filters.nchw),this.resources.renderer.renderTo(this.small.frame,this.small.getBuffer("model")),this.small.frame.filters=[],this.small.frame.texture.trim=new _Rectangle(0,0,this.sdkOptions.width,this.sdkOptions.height),this.small.activateTexture("origin");var s=this.small.getBuffer("model"),u=this.resources.renderer.pixelsAsync(s,{pool:this.bufferPool});this.pixels.push(u);}}},{key:"init",value:(a=virtual_background_effect_asyncToGenerator(virtual_background_effect_regeneratorRuntime().mark(function e(t){var r=this;return virtual_background_effect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.disable(),this.inference=t,this.inference.setPresetManager(this.presetManager),this.inference.setPreset(this.settings.preset),e.next=6,this.setPreset(this.settings.preset);case 6:return e.abrupt("return",this.inference.init(this.customer_id,"segmentation").then(function(){r.enable();}));case 7:case"end":return e.stop();}},e,this);})),function(e){return a.apply(this,arguments);})},{key:"setPreset",value:(o=virtual_background_effect_asyncToGenerator(virtual_background_effect_regeneratorRuntime().mark(function e(t){var r,n,i;return virtual_background_effect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.model.preset!=t||this.presetManager.isOrientationChanged(this.model.preset)){e.next=2;break;}return e.abrupt("return");case 2:if(!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=5;break;}return e.next=5,this.onProcessPromise.promise;case 5:this.isNewPreset=!0,this.settings.preset=t,this.presetManager.updateOrientation(),r=this.presetManager.getModelSize(t),n=r.width,i=r.height,this.model.set(t,n,i);case 10:case"end":return e.stop();}},e,this);})),function(e){return o.apply(this,arguments);})},{key:"updateModelSize",value:(i=virtual_background_effect_asyncToGenerator(virtual_background_effect_regeneratorRuntime().mark(function e(){var t,r;return virtual_background_effect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.pixelBuffer=new Uint8Array(this.model.width*this.model.height*4).fill(255),this.model.previous=new Float32Array(this.model.size/4),this.clearBuffers(),null===(t=this.small)||void 0===t||t.resize(this.model.width,this.model.height),null===(r=this.mask)||void 0===r||r.resize(this.model.width,this.model.height),this.filters.nchw=new FilterNCHW(this.model.width,this.model.height),this.filters.nchw.setSize(this.model.width,this.model.height),this.mask&&this.applyLayout();case 8:case"end":return e.stop();}},e,this);})),function(){return i.apply(this,arguments);})},{key:"prepare",value:function value(){var e=this.model.width,t=this.model.height;this.effectContainer=new _Container2(),this.effectContainer.height=this.sdkOptions.height,this.effectContainer.width=this.sdkOptions.width,this.original=new Frame(this.resources.texture,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.original.addBuffer("result"),this.background=new Background(this.sdkOptions,new Frame(this.resources.texture,{width:this.sdkOptions.width,height:this.sdkOptions.height})),this.small=new Frame(this.resources.texture,{width:e,height:t}),this.small.addBuffer("model"),this.small.addBuffer("mask"),this.mask=new Frame(this.small.getBuffer("mask"),{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.pixelBuffer=new Uint8Array(this.model.width*this.model.height*4).fill(255),this.prepareFilters(),this.applyBlur(),this.updateModelSize(),this.sdkOptions.on("update",this.onOptionsUpdate,this);}},{key:"prepareFilters",value:function value(){var e={uIsBoundaryStrong:"strong"===this.settings.boundary_mode,uOriginFrame:this.original.frame.texture,useMask:!0,distColor:1};this.filters.blurMask=new FilterBlurKawase({blur:.1,quality:4,clamp:!0}),this.filters.show=new FilterShow(e,this.original.frame,this.mask.frame),this.filters.nchw=new FilterNCHW(this.model.width,this.model.height),this.filters.mirror=new FilterMirror(),this.updateBeautyFilter(),this.mask.frame.filters=[this.filters.show];}},{key:"updateBeautyFilter",value:function value(){this.filters.beautification=new FilterBeauty({uBeautificationLevel:this.settings.beautification_level,uWidth:this.mask.frame.width,uHeight:this.mask.frame.height,radius:this.settings.beautification_radius,highpassEnabled:this.settings.beautification_highpass,sigma:this.settings.beautification_sigma,blurType:this.settings.beautification_blur_type});}},{key:"updateMaskFilters",value:function value(){this.mask.frame.filters=[this.filters.show],this.settings.beautification&&this.mask.frame.filters.push(this.filters.beautification);}},{key:"clearBackground",value:function value(){this.background.clearBackground();}},{key:"process",value:(n=virtual_background_effect_asyncToGenerator(virtual_background_effect_regeneratorRuntime().mark(function e(){var t;return virtual_background_effect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break;}return e.abrupt("return");case 2:if(!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=5;break;}return e.next=5,this.onProcessPromise.promise;case 5:if(this.onProcessPromise=new Deferred(),this.drawTimer.start(),this.inference&&this.inference.isReady()){e.next=9;break;}return e.abrupt("return");case 9:if(e.prev=9,!this.shouldSegmentationRun()){e.next=13;break;}return e.next=13,this.prepareSegmentationMask();case 13:e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](9),this.disable(),e.t0&&errorBus.bv.notify({message:null!==(t="Prepare segmentation mask. "+e.t0.message)&&void 0!==t?t:e.t0,emitter:errorBus.JK.EFFECT_VIRTUAL_BACKGROUND,cause:e.t0});case 19:this.skip_frames_counter=this.skip_frames_counter?0:1,this.isActive()?(this.filters.show.setOrigin(this.original.frame.texture),this.settings.layout_mode!=LayoutMode.TRANSPARENT&&(this.resources.renderer.addToEffects(this.background.frame.frame),this.background.render()),this.resources.renderer.addToEffects(this.mask.frame)):this.resources.renderer.addToEffects(this.original.frame),this.resources.renderer.addStatistics(),this.resources.renderer.render(),this.resources.renderer.removeStatistics(),this.resources.renderer.removeFromEffects(this.background.frame.frame),this.resources.renderer.removeFromEffects(this.mask.frame),this.drawTimer.finish(),this.resources.renderer.updateStatistics("frame_time",this.drawTimer.getFrameTime()),this.resources.renderer.updateStatistics("inference_time",this.inferenceTimer.getFrameTime()),this.onProcessPromise.resolve();case 30:case"end":return e.stop();}},e,this,[[9,15]]);})),function(){return n.apply(this,arguments);})},{key:"isActive",value:function value(){return null!==this.background.options.source||"center"!==this.settings.layout||!!this.settings.blur||!!this.settings.beautification;}},{key:"shouldSegmentationRun",value:function value(){return(!this.settings.skip_frames||!this.skip_frames_counter)&&(this.settings.layout_mode===LayoutMode.SEGMENTATION||this.settings.layout_mode===LayoutMode.TRANSPARENT)&&this.isActive();}},{key:"setBoundaryMode",value:function value(e){this.settings.boundary_mode=e,this.filters.show.setIsBoundaryStrong("strong"===e);}},{key:"setBoundaryLevel",value:function value(e){errorBus.bv.notify({type:errorBus.By.INFO,message:"Boundary level was deprecated and will not show any effect.",emitter:errorBus.JK.EFFECT_VIRTUAL_BACKGROUND});}},{key:"setBeautificationLevel",value:function value(e){e=.34+.34*(e=1-Math.min(Math.max(Number(e),0),1)),this.filters.beautification.setBeautificationLevel(e);}},{key:"enableFrameSkipping",value:function value(){this.settings.skip_frames=!0;}},{key:"disableFrameSkipping",value:function value(){this.settings.skip_frames=!1;}},{key:"enableBeautification",value:function value(){this.settings.beautification||(this.mask.frame.filters.push(this.filters.beautification),this.settings.beautification=!0);}},{key:"disableBeautification",value:function value(){this.settings.beautification&&(this.mask.frame.filters.pop(),this.settings.beautification=!1);}},{key:"getPreset",value:function value(){return this.settings.preset;}},{key:"setLayout",value:function value(e){this.settings.layout=e,this.applyLayout();}},{key:"setLayoutMode",value:function value(e){this.settings.layout_mode=e,this.filters.show.setLayoutMode(e);}},{key:"setCustomLayout",value:function value(e){var t=this;Object.keys(e).forEach(function(r){t.customLayoutOptions[r]=e[r];}),this.updateMaskPosition(this.customLayoutOptions.width,this.customLayoutOptions.height,this.customLayoutOptions.xOffset,this.customLayoutOptions.yOffset);}},{key:"applyLayout",value:function value(){switch(this.settings.layout){case"left":this.updateMaskPosition(this.sdkOptions.width,this.sdkOptions.height,-this.sdkOptions.width/4,0);break;case"right":this.updateMaskPosition(this.sdkOptions.width,this.sdkOptions.height,this.sdkOptions.width/4,0);break;case"left-bottom":this.updateMaskPosition(this.sdkOptions.width/2,this.sdkOptions.height/2,0,this.sdkOptions.height/2);break;case"right-bottom":this.updateMaskPosition(this.sdkOptions.width/2,this.sdkOptions.height/2,this.sdkOptions.width/2,this.sdkOptions.height/2);break;case"center":this.updateMaskPosition(this.sdkOptions.width,this.sdkOptions.height,0,0);}}},{key:"updateMaskPosition",value:function value(e,t,r,n){this.mask.frame.width=e,this.mask.frame.height=t,this.mask.frame.position.x=r,this.mask.frame.position.y=n,this.filters.show.setLayout();}},{key:"setBackground",value:function value(e){this.background.set(e);}},{key:"setBackgroundFitMode",value:function value(e){this.background.setFitMode(e);}},{key:"setBackgroundColor",value:function value(e){this.background.setColor(e);}},{key:"setBlur",value:function value(e){this.settings.blur=e,this.applyBlur();}},{key:"clearBlur",value:function value(){this.settings.blur=0,this.applyBlur();}},{key:"applyBlur",value:function value(){this.background.applyBlur(this.settings.blur);}},{key:"prepareSegmentationMask",value:(r=virtual_background_effect_asyncToGenerator(virtual_background_effect_regeneratorRuntime().mark(function e(){var t,r,n,i,o,a,s=this;return virtual_background_effect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break;}return e.abrupt("return");case 2:if(t=this.model.width,r=this.model.height,this.pixels.length){e.next=6;break;}return e.abrupt("return");case 6:return e.next=8,this.pixels.shift();case 8:if((null==(n=e.sent)?void 0:n.length)==4*t*r){e.next=11;break;}return e.abrupt("return");case 11:return i=3*t*r,(o=this.bufferPool.getBuffer("f32",4*t*r)).set(n.subarray(0,i)),o.set(this.model.previous,i),this.bufferPool.returnBuffer(n),this.inferenceTimer.start(),a={seg:{data:this.bufferPool.getBuffer("f32",t*r),dims:[1,1,r,t]}},e.abrupt("return",this.inference.run(o,t,r,"segmentation",a).then(function(e){var n,i,o;if(s.inferenceTimer.finish(),s.isNewPreset)s.isNewPreset=!1;else{s.bufferPool.returnBuffer(e.inputBack.data);var a=null!==(o=null!==(i=null===(n=e.seg)||void 0===n?void 0:n.data)&&void 0!==i?i:e.seg)&&void 0!==o?o:e;s.model.previous&&s.bufferPool.returnBuffer(s.model.previous),s.model.previous=a;for(var u=0;u<s.model.previous.length;u++)s.pixelBuffer[4*u+3]=255*a[u];var l=s.resources.renderer.createTextureFromBuffer(s.pixelBuffer,t,r);s.small.addTexture("mask",l,!1),s.small.activateTexture("mask"),s.small.frame.filters=[s.filters.blurMask],s.resources.renderer.renderTo(s.small.frame,s.small.getBuffer("mask")),s.small.frame.filters=[],s.small.activateTexture("origin"),l.destroy(!0),s.background.setMask(s.small.getBuffer("mask"));}})["catch"](function(e){var t;errorBus.bv.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:errorBus.JK.EFFECT_VIRTUAL_BACKGROUND,cause:e});}));case 19:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"setBeauty",value:function value(e){this.settings.beautification_radius=e.rad||this.settings.beautification_radius,null!==e.highpass&&void 0!==e.highpass&&(this.settings.beautification_highpass=e.highpass),this.settings.beautification_sigma=e.sigma||this.settings.beautification_sigma,e.blur&&(this.settings.beautification_blur_type=e.blur),this.updateBeautyFilter(),this.settings.beautification&&this.updateMaskFilters();}},{key:"destroy",value:function value(){this.disable(),this.clearBuffers(),this.sdkOptions.off("update",this.onOptionsUpdate,this),this.model.off("update",this.updateModelSize,this),this.background.destroy();}}]);var r,n,i,o,a;}();var lowLightShader="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D uLL;\nuniform int uEnabled;\n\nvoid main() {\n  vec4 texel = texture2D(uSampler, vTextureCoord);\n\n  if (uEnabled == 0) {\n    gl_FragColor = vec4(texel);\n    return;\n  }\n\n  vec3 curve = texture2D(uLL, vTextureCoord).rgb;\n\n  vec3 x = texel.rgb + curve * (texel.rgb * texel.rgb - texel.rgb);\n\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n  x = x - curve * (x * x - x);\n\n  x = clamp(x, 0.0, 1.0);\n\n  gl_FragColor = vec4(x, texel.a);\n}\n";function filterLowLight_typeof(e){return filterLowLight_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},filterLowLight_typeof(e);}function filterLowLight_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function filterLowLight_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,filterLowLight_toPropertyKey(n.key),n);}}function filterLowLight_createClass(e,t,r){return t&&filterLowLight_defineProperties(e.prototype,t),r&&filterLowLight_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function filterLowLight_toPropertyKey(e){var t=filterLowLight_toPrimitive(e,"string");return"symbol"==filterLowLight_typeof(t)?t:t+"";}function filterLowLight_toPrimitive(e,t){if("object"!=filterLowLight_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=filterLowLight_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function filterLowLight_callSuper(e,t,r){return t=filterLowLight_getPrototypeOf(t),filterLowLight_possibleConstructorReturn(e,filterLowLight_isNativeReflectConstruct()?Reflect.construct(t,r||[],filterLowLight_getPrototypeOf(e).constructor):t.apply(e,r));}function filterLowLight_possibleConstructorReturn(e,t){if(t&&("object"==filterLowLight_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return filterLowLight_assertThisInitialized(e);}function filterLowLight_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function filterLowLight_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(filterLowLight_isNativeReflectConstruct=function filterLowLight_isNativeReflectConstruct(){return!!e;})();}function filterLowLight_getPrototypeOf(e){return filterLowLight_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},filterLowLight_getPrototypeOf(e);}function filterLowLight_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&filterLowLight_setPrototypeOf(e,t);}function filterLowLight_setPrototypeOf(e,t){return filterLowLight_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},filterLowLight_setPrototypeOf(e,t);}var FilterLowLight=function(e){function t(){return filterLowLight_classCallCheck(this,t),filterLowLight_callSuper(this,t,[void 0,lowLightShader,{uLL:Texture_Texture.EMPTY,uEnabled:0}]);}return filterLowLight_inherits(t,_Filter2),filterLowLight_createClass(t,[{key:"setLowLightTexture",value:function value(e){this.uniforms.uLL=e,this.uniforms.uEnabled=1;}}]);}();function lowlightPreprocess(e,t,r,n){for(var i=r*t,o=2*r*t,a=0;a<n.length/3;a++)n[0+a]=e[4*a+2]/255,n[i+a]=e[4*a]/127.5,n[o+a]=e[4*a+1]/127.5;}var DEFAULT_CONFIG={modelHeight:144,modelWidth:144,power:1};var proxyMarker=Symbol("Comlink.proxy"),createEndpoint=Symbol("Comlink.endpoint"),releaseProxy=Symbol("Comlink.releaseProxy"),finalizer=Symbol("Comlink.finalizer"),throwMarker=Symbol("Comlink.thrown"),isObject=function isObject(e){return"object"==_typeof2(e)&&null!==e||"function"==typeof e;},proxyTransferHandler={canHandle:function canHandle(e){return isObject(e)&&e[proxyMarker];},serialize:function serialize(e){var _MessageChannel=new MessageChannel(),t=_MessageChannel.port1,r=_MessageChannel.port2;return expose(e,t),[r,[r]];},deserialize:function deserialize(e){return e.start(),wrap(e);}},throwTransferHandler={canHandle:function canHandle(e){return isObject(e)&&throwMarker in e;},serialize:function serialize(_ref114){var e=_ref114.value;var t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]];},deserialize:function deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value;}},transferHandlers=new Map([["proxy",proxyTransferHandler],["throw",throwTransferHandler]]);function isAllowedOrigin(e,t){var _iterator77=_createForOfIteratorHelper2(e),_step77;try{for(_iterator77.s();!(_step77=_iterator77.n()).done;){var r=_step77.value;if(t===r||"*"===r)return!0;if(r instanceof RegExp&&r.test(t))return!0;}}catch(err){_iterator77.e(err);}finally{_iterator77.f();}return!1;}function expose(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:globalThis;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:["*"];t.addEventListener("message",function n(i){if(!i||!i.data)return;if(!isAllowedOrigin(r,i.origin))return void console.warn("Invalid origin '".concat(i.origin,"' for comlink proxy"));var _Object$assign4=Object.assign({path:[]},i.data),o=_Object$assign4.id,a=_Object$assign4.type,s=_Object$assign4.path,u=(i.data.argumentList||[]).map(fromWireValue);var l;try{var _t413=s.slice(0,-1).reduce(function(e,t){return e[t];},e),_r316=s.reduce(function(e,t){return e[t];},e);switch(a){case"GET":l=_r316;break;case"SET":_t413[s.slice(-1)[0]]=fromWireValue(i.data.value),l=!0;break;case"APPLY":l=_r316.apply(_t413,u);break;case"CONSTRUCT":l=proxy(_construct(_r316,_toConsumableArray2(u)));break;case"ENDPOINT":{var _MessageChannel2=new MessageChannel(),_t414=_MessageChannel2.port1,_r317=_MessageChannel2.port2;expose(e,_r317),l=transfer(_t414,[_t414]);}break;case"RELEASE":l=void 0;break;default:return;}}catch(e){l=_defineProperty({value:e},throwMarker,0);}Promise.resolve(l)["catch"](function(e){return _defineProperty({value:e},throwMarker,0);}).then(function(r){var _toWireValue=toWireValue(r),_toWireValue2=_slicedToArray2(_toWireValue,2),i=_toWireValue2[0],s=_toWireValue2[1];t.postMessage(Object.assign(Object.assign({},i),{id:o}),s),"RELEASE"===a&&(t.removeEventListener("message",n),closeEndPoint(t),finalizer in e&&"function"==typeof e[finalizer]&&e[finalizer]());})["catch"](function(e){var _toWireValue3=toWireValue(_defineProperty({value:new TypeError("Unserializable return value")},throwMarker,0)),_toWireValue4=_slicedToArray2(_toWireValue3,2),r=_toWireValue4[0],n=_toWireValue4[1];t.postMessage(Object.assign(Object.assign({},r),{id:o}),n);});}),t.start&&t.start();}function isMessagePort(e){return"MessagePort"===e.constructor.name;}function closeEndPoint(e){isMessagePort(e)&&e.close();}function wrap(e,t){return createProxy(e,[],t);}function throwIfProxyReleased(e){if(e)throw new Error("Proxy has been released and is not useable");}function releaseEndpoint(e){return requestResponseMessage(e,{type:"RELEASE"}).then(function(){closeEndPoint(e);});}var proxyCounter=new WeakMap(),proxyFinalizers="FinalizationRegistry"in globalThis&&new FinalizationRegistry(function(e){var t=(proxyCounter.get(e)||0)-1;proxyCounter.set(e,t),0===t&&releaseEndpoint(e);});function registerProxy(e,t){var r=(proxyCounter.get(t)||0)+1;proxyCounter.set(t,r),proxyFinalizers&&proxyFinalizers.register(e,t,e);}function unregisterProxy(e){proxyFinalizers&&proxyFinalizers.unregister(e);}function createProxy(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:function(){};var n=!1;var i=new Proxy(r,{get:function get(r,o){if(throwIfProxyReleased(n),o===releaseProxy)return function(){unregisterProxy(i),releaseEndpoint(e),n=!0;};if("then"===o){if(0===t.length)return{then:function then(){return i;}};var _r318=requestResponseMessage(e,{type:"GET",path:t.map(function(e){return e.toString();})}).then(fromWireValue);return _r318.then.bind(_r318);}return createProxy(e,[].concat(_toConsumableArray2(t),[o]));},set:function set(r,i,o){throwIfProxyReleased(n);var _toWireValue6=toWireValue(o),_toWireValue7=_slicedToArray2(_toWireValue6,2),a=_toWireValue7[0],s=_toWireValue7[1];return requestResponseMessage(e,{type:"SET",path:[].concat(_toConsumableArray2(t),[i]).map(function(e){return e.toString();}),value:a},s).then(fromWireValue);},apply:function apply(r,i,o){throwIfProxyReleased(n);var a=t[t.length-1];if(a===createEndpoint)return requestResponseMessage(e,{type:"ENDPOINT"}).then(fromWireValue);if("bind"===a)return createProxy(e,t.slice(0,-1));var _processArguments=processArguments(o),_processArguments2=_slicedToArray2(_processArguments,2),s=_processArguments2[0],u=_processArguments2[1];return requestResponseMessage(e,{type:"APPLY",path:t.map(function(e){return e.toString();}),argumentList:s},u).then(fromWireValue);},construct:function construct(r,i){throwIfProxyReleased(n);var _processArguments3=processArguments(i),_processArguments4=_slicedToArray2(_processArguments3,2),o=_processArguments4[0],a=_processArguments4[1];return requestResponseMessage(e,{type:"CONSTRUCT",path:t.map(function(e){return e.toString();}),argumentList:o},a).then(fromWireValue);}});return registerProxy(i,e),i;}function myFlat(e){return Array.prototype.concat.apply([],e);}function processArguments(e){var t=e.map(toWireValue);return[t.map(function(e){return e[0];}),myFlat(t.map(function(e){return e[1];}))];}var transferCache=new WeakMap();function transfer(e,t){return transferCache.set(e,t),e;}function proxy(e){return Object.assign(e,_defineProperty({},proxyMarker,!0));}function windowEndpoint(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:globalThis;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"*";return{postMessage:function postMessage(t,n){return e.postMessage(t,r,n);},addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)};}function toWireValue(e){var _iterator78=_createForOfIteratorHelper2(transferHandlers),_step78;try{for(_iterator78.s();!(_step78=_iterator78.n()).done;){var _step78$value=_slicedToArray2(_step78.value,2),_t415=_step78$value[0],r=_step78$value[1];if(r.canHandle(e)){var _r$serialize=r.serialize(e),_r$serialize2=_slicedToArray2(_r$serialize,2),n=_r$serialize2[0],i=_r$serialize2[1];return[{type:"HANDLER",name:_t415,value:n},i];}}}catch(err){_iterator78.e(err);}finally{_iterator78.f();}return[{type:"RAW",value:e},transferCache.get(e)||[]];}function fromWireValue(e){switch(e.type){case"HANDLER":return transferHandlers.get(e.name).deserialize(e.value);case"RAW":return e.value;}}function requestResponseMessage(e,t,r){return new Promise(function(n){var i=generateUUID();e.addEventListener("message",function t(r){r.data&&r.data.id&&r.data.id===i&&(e.removeEventListener("message",t),n(r.data));}),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),r);});}function generateUUID(){return new Array(4).fill(0).map(function(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16);}).join("-");}function lowLightEffect_typeof(e){return lowLightEffect_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},lowLightEffect_typeof(e);}function lowLightEffect_regeneratorRuntime(){lowLightEffect_regeneratorRuntime=function lowLightEffect_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==lowLightEffect_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(lowLightEffect_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function lowLightEffect_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function lowLightEffect_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){lowLightEffect_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){lowLightEffect_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function lowLightEffect_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function lowLightEffect_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lowLightEffect_toPropertyKey(n.key),n);}}function lowLightEffect_createClass(e,t,r){return t&&lowLightEffect_defineProperties(e.prototype,t),r&&lowLightEffect_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function lowLightEffect_toPropertyKey(e){var t=lowLightEffect_toPrimitive(e,"string");return"symbol"==lowLightEffect_typeof(t)?t:t+"";}function lowLightEffect_toPrimitive(e,t){if("object"!=lowLightEffect_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=lowLightEffect_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function lowLightEffect_callSuper(e,t,r){return t=lowLightEffect_getPrototypeOf(t),lowLightEffect_possibleConstructorReturn(e,lowLightEffect_isNativeReflectConstruct()?Reflect.construct(t,r||[],lowLightEffect_getPrototypeOf(e).constructor):t.apply(e,r));}function lowLightEffect_possibleConstructorReturn(e,t){if(t&&("object"==lowLightEffect_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return lowLightEffect_assertThisInitialized(e);}function lowLightEffect_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function lowLightEffect_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(lowLightEffect_isNativeReflectConstruct=function lowLightEffect_isNativeReflectConstruct(){return!!e;})();}function lowLightEffect_superPropGet(e,t,r,n){var i=lowLightEffect_get(lowLightEffect_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e);}:i;}function lowLightEffect_get(){return lowLightEffect_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=lowLightEffect_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value;}},lowLightEffect_get.apply(null,arguments);}function lowLightEffect_superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=lowLightEffect_getPrototypeOf(e)););return e;}function lowLightEffect_getPrototypeOf(e){return lowLightEffect_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},lowLightEffect_getPrototypeOf(e);}function lowLightEffect_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lowLightEffect_setPrototypeOf(e,t);}function lowLightEffect_setPrototypeOf(e,t){return lowLightEffect_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},lowLightEffect_setPrototypeOf(e,t);}var lowLightEffect_url=new URL(__webpack_require__(4788),__webpack_require__.b).href,lowLightEffect_worker=new Worker(lowLightEffect_url,{type:"module"}),LowLightEffect=function(e){function t(e,r){var n;return lowLightEffect_classCallCheck(this,t),(n=lowLightEffect_callSuper(this,t,[e])).bufferPool=new BufferPool(),n.customer_id=r,n.setConfig(DEFAULT_CONFIG),n.worker=wrap(lowLightEffect_worker),n.filterName="low-light",n;}return lowLightEffect_inherits(t,AbstractEffect),lowLightEffect_createClass(t,[{key:"init",value:(n=lowLightEffect_asyncToGenerator(lowLightEffect_regeneratorRuntime().mark(function e(t){return lowLightEffect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.inference=t,e.next=3,this.inference.init(this.customer_id,"lowlighter");case 3:case"end":return e.stop();}},e,this);})),function(e){return n.apply(this,arguments);})},{key:"prepare",value:function value(){this.filterLowLight=new FilterLowLight(),this.original=new Frame(this.resources.texture,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.original.addBuffer("result"),this.original.addBuffer("output"),this.filterLUT=new FilterLut(),this.lut=new Frame(this.resources.texture,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.lut.addBuffer("result"),this.lut.frame.filters=[this.filterLUT];var e=this.config,t=e.modelHeight,r=e.modelWidth;this.small=new Frame(this.resources.texture,{width:r,height:t}),this.small.addBuffer("model"),this.sdkOptions.on("update",this.onOptionsUpdate,this);}},{key:"onOptionsUpdate",value:function value(){this.original.resize(this.sdkOptions.width,this.sdkOptions.height),this.lut.resize(this.sdkOptions.width,this.sdkOptions.height);}},{key:"process",value:(r=lowLightEffect_asyncToGenerator(lowLightEffect_regeneratorRuntime().mark(function e(){return lowLightEffect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break;}return e.abrupt("return");case 2:this.isOutdatedLUT&&this.updateLUT(),this.resources.filters.set(this.filterName,this.filterLUT);case 4:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"setConfig",value:function value(e){var t;this.config=Object.assign(null!==(t=this.config)&&void 0!==t?t:{},e),this.setFilterPower(e.power);}},{key:"onSuccess",value:function value(e){var t="function"==typeof e;this.onSuccessFunction=t?e:void 0;}},{key:"enable",value:function value(){lowLightEffect_superPropGet(t,"enable",this,3)([]),this.isOutdatedLUT=!this.inWork;}},{key:"disable",value:function value(){lowLightEffect_superPropGet(t,"disable",this,3)([]),this.resources.filters["delete"](this.filterName),this.bufferPool=new BufferPool();}},{key:"updateLUT",value:function value(){var e=this;if(!this.inWork){this.inWork=!0;var t=this.config,r=t.modelHeight,n=t.modelWidth;this.resources.renderer.renderTo(this.original.frame,this.original.getBuffer("result")),this.resources.renderer.renderTo(this.small.frame,this.small.getBuffer("model"));var i=this.small.getBuffer("model"),o=this.resources.renderer.pixels(i),a=this.bufferPool.getBuffer("f32",3*n*r);lowlightPreprocess(new Uint8ClampedArray(o),n,r,a),this.inference.run(a,n,r,"lowlighter").then(function(t){e.original.activateBuffer("result"),e.original.frame.filters=[e.filterLowLight],e.filterLowLight.setLowLightTexture(t.coefs),e.resources.renderer.renderTo(e.original.frame,e.original.getBuffer("output")),e.original.activateTexture("origin"),e.original.frame.filters=[];var r=e.resources.renderer.pixels(e.original.getBuffer("output")),n=e.resources.renderer.pixels(e.original.getBuffer("result"));return e.worker.getLUTTexture(new Uint8ClampedArray(n),new Uint8ClampedArray(r));}).then(function(t){e.applyLowlightLUT(t),e.emitSuccess();})["catch"](function(e){var t;errorBus.bv.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:errorBus.JK.EFFECT_LOW_LIGHT,cause:e});})["finally"](function(){e.inWork=!1,e.isOutdatedLUT=!1;});}}},{key:"applyLowlightLUT",value:function value(e){var t=this.getLutTextureData(e).LUTTexture;this.filterLUT.setLUT({texture:t});}},{key:"getLutTextureData",value:function value(e){var t=Math.sqrt(e.length/4);return{LUTTexture:Texture_Texture.fromBuffer(new Uint8Array(e),t,t,{scaleMode:1}),LUTSize:t};}},{key:"setFilterPower",value:function value(e){var t;void 0!==e&&(this.config.power=e,null===(t=this.filterLUT)||void 0===t||t.setFilterPower(e));}},{key:"emitSuccess",value:function value(){"function"==typeof this.onSuccessFunction&&this.onSuccessFunction();}},{key:"destroy",value:function value(){this.sdkOptions.off("update",this.onOptionsUpdate,this);}}]);var r,n;}();var config={modelHeight:256,modelWidth:256,modelPediod_ms:1e3,filterPart:100,cc_power:100};function usePreprocessData(e,t,r,n){for(var i=r*t,o=2*r*t,a=0;a<n.length/3;a++)n[0+a]=e[4*a],n[i+a]=e[4*a+1],n[o+a]=e[4*a+2];return n;}var edge=33,sidesCount=6;function getPostprocessOutputSize(){return 4*Math.pow(edge*sidesCount,2);}function usePostprocessData(e,t){var r=e.tensor,n=edge*edge*edge,i=r.output.data,o=new Uint8ClampedArray(t.buffer),a={value:0,isNil:function isNil(){return 0===a.value;},setDefault:function setDefault(){return a.value=edge*edge;},dec:function dec(){return a.value--;}};a.setDefault();for(var s=0,u=0,l=function l(e,t){return 4*(edge*(sidesCount*u+s)+t%edge)+e;},c=function c(e){[e,n+e,2*n+e].forEach(function(t,r){o[l(r,e)]=255*i[t];}),o[l(3,e)]=255,a.dec(),e%edge==edge-1&&u++,a.isNil()&&(a.setDefault(),++s>=sidesCount?s=0:u-=edge);},h=0;h<n;h++)c(h);}var lut33Shader="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D uLUT;\nuniform float uFilterPart;\nuniform float uFilterPower;\n\nfloat clampedCoord(float coord) {\n  float min = 0.5 / 198.0;\n  float max = 1.0 - min;\n  return clamp(coord, min, max);\n}\n\nfloat clampColor(float color) {\n  float min = 1.0 / 256.0;\n  float max = 1.0 / 6.0 - min;\n  return clamp(color, min, max);\n}\n\nvec4 newColor(float rectNum, vec2 coord) {\n  vec2 bCoord = vec2(mod(rectNum, 6.0) / 6.0, floor(rectNum / 6.0) / 6.0);\n  vec2 lutTextureCoord = vec2(clampedCoord(coord.r + bCoord.r), clampedCoord(coord.g + bCoord.g));\n  return texture2D(uLUT, lutTextureCoord);\n}\n\nvoid main() {\n  vec4 color = texture2D(uSampler, vTextureCoord);\n\n  if (vTextureCoord.x > uFilterPart) {\n    gl_FragColor = color;\n    return;\n  }\n\n  vec2 rgCoord = vec2(clampColor(color.r / 6.0), clampColor(color.g / 6.0));\n\n  //. Count number of the LUT-cell\n  float rectNumReal = color.b * 32.0;\n  float rectNumMin = floor(rectNumReal);\n  float rectNumMax = ceil(rectNumReal);\n\n  vec4 colorLut1 = newColor(rectNumMin, rgCoord);\n  vec4 colorLut2 = newColor(rectNumMax, rgCoord);\n\n  vec3 interpolatedColor = mix(colorLut1.rgb, colorLut2.rgb, rectNumReal - rectNumMin);\n\n  //. Add filter power\n  vec3 resultColor = mix(color.rgb, interpolatedColor.rgb, uFilterPower);\n\n  gl_FragColor = vec4(resultColor.rgb, color.a);\n}\n";function filterLut33_typeof(e){return filterLut33_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},filterLut33_typeof(e);}function filterLut33_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function filterLut33_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,filterLut33_toPropertyKey(n.key),n);}}function filterLut33_createClass(e,t,r){return t&&filterLut33_defineProperties(e.prototype,t),r&&filterLut33_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function filterLut33_toPropertyKey(e){var t=filterLut33_toPrimitive(e,"string");return"symbol"==filterLut33_typeof(t)?t:t+"";}function filterLut33_toPrimitive(e,t){if("object"!=filterLut33_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=filterLut33_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function filterLut33_callSuper(e,t,r){return t=filterLut33_getPrototypeOf(t),filterLut33_possibleConstructorReturn(e,filterLut33_isNativeReflectConstruct()?Reflect.construct(t,r||[],filterLut33_getPrototypeOf(e).constructor):t.apply(e,r));}function filterLut33_possibleConstructorReturn(e,t){if(t&&("object"==filterLut33_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return filterLut33_assertThisInitialized(e);}function filterLut33_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function filterLut33_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(filterLut33_isNativeReflectConstruct=function filterLut33_isNativeReflectConstruct(){return!!e;})();}function filterLut33_getPrototypeOf(e){return filterLut33_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},filterLut33_getPrototypeOf(e);}function filterLut33_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&filterLut33_setPrototypeOf(e,t);}function filterLut33_setPrototypeOf(e,t){return filterLut33_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},filterLut33_setPrototypeOf(e,t);}var FilterLut33=function(e){function t(){var e;return filterLut33_classCallCheck(this,t),(e=filterLut33_callSuper(this,t,[void 0,lut33Shader,{uFilterPart:1,uFilterPower:1}])).lutTextureHeight=198,e.lutTextureWidth=198,e;}return filterLut33_inherits(t,_Filter2),filterLut33_createClass(t,[{key:"setLUT",value:function value(e,t){var r;null===(r=this.lutTexture)||void 0===r||r.destroy(!0),this.onLutDestroyedCallback&&this.onLutDestroyedCallback(),this.lutTexture=Texture_Texture.fromBuffer(e,this.lutTextureWidth,this.lutTextureHeight,{scaleMode:1}),this.onLutDestroyedCallback=t,this.uniforms.uLUT=this.lutTexture;}},{key:"setFilterPart",value:function value(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPart=e;}},{key:"setFilterPower",value:function value(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPower=e;}}]);}();function colorCorrectionEffect_typeof(e){return colorCorrectionEffect_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},colorCorrectionEffect_typeof(e);}function colorCorrectionEffect_regeneratorRuntime(){colorCorrectionEffect_regeneratorRuntime=function colorCorrectionEffect_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==colorCorrectionEffect_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(colorCorrectionEffect_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function colorCorrectionEffect_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function colorCorrectionEffect_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){colorCorrectionEffect_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){colorCorrectionEffect_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function colorCorrectionEffect_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function colorCorrectionEffect_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,colorCorrectionEffect_toPropertyKey(n.key),n);}}function colorCorrectionEffect_createClass(e,t,r){return t&&colorCorrectionEffect_defineProperties(e.prototype,t),r&&colorCorrectionEffect_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function colorCorrectionEffect_toPropertyKey(e){var t=colorCorrectionEffect_toPrimitive(e,"string");return"symbol"==colorCorrectionEffect_typeof(t)?t:t+"";}function colorCorrectionEffect_toPrimitive(e,t){if("object"!=colorCorrectionEffect_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=colorCorrectionEffect_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function colorCorrectionEffect_callSuper(e,t,r){return t=colorCorrectionEffect_getPrototypeOf(t),colorCorrectionEffect_possibleConstructorReturn(e,colorCorrectionEffect_isNativeReflectConstruct()?Reflect.construct(t,r||[],colorCorrectionEffect_getPrototypeOf(e).constructor):t.apply(e,r));}function colorCorrectionEffect_possibleConstructorReturn(e,t){if(t&&("object"==colorCorrectionEffect_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return colorCorrectionEffect_assertThisInitialized(e);}function colorCorrectionEffect_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function colorCorrectionEffect_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(colorCorrectionEffect_isNativeReflectConstruct=function colorCorrectionEffect_isNativeReflectConstruct(){return!!e;})();}function colorCorrectionEffect_superPropGet(e,t,r,n){var i=colorCorrectionEffect_get(colorCorrectionEffect_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e);}:i;}function colorCorrectionEffect_get(){return colorCorrectionEffect_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=colorCorrectionEffect_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value;}},colorCorrectionEffect_get.apply(null,arguments);}function colorCorrectionEffect_superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=colorCorrectionEffect_getPrototypeOf(e)););return e;}function colorCorrectionEffect_getPrototypeOf(e){return colorCorrectionEffect_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},colorCorrectionEffect_getPrototypeOf(e);}function colorCorrectionEffect_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&colorCorrectionEffect_setPrototypeOf(e,t);}function colorCorrectionEffect_setPrototypeOf(e,t){return colorCorrectionEffect_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},colorCorrectionEffect_setPrototypeOf(e,t);}var ColorCorrectorEffect=function(e){function t(e,r){var n;return colorCorrectionEffect_classCallCheck(this,t),(n=colorCorrectionEffect_callSuper(this,t,[e])).hasLUT=!1,n.inWork=!1,n.bufferPool=new BufferPool(),n.customer_id=r,n.config=Object.assign({},config),n.filterName="color-correction",n;}return colorCorrectionEffect_inherits(t,AbstractEffect),colorCorrectionEffect_createClass(t,[{key:"init",value:(i=colorCorrectionEffect_asyncToGenerator(colorCorrectionEffect_regeneratorRuntime().mark(function e(t){return colorCorrectionEffect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.inference=t,e.next=3,this.inference.init(this.customer_id,"colorcorrector");case 3:case"end":return e.stop();}},e,this);})),function(e){return i.apply(this,arguments);})},{key:"prepare",value:function value(){var e=this.config,t=e.modelHeight,r=e.modelWidth,n=this.resources.texture;this.small=new Frame(n,{width:r,height:t}),this.small.addBuffer("model"),this.ccFilter=new FilterLut33();}},{key:"process",value:(n=colorCorrectionEffect_asyncToGenerator(colorCorrectionEffect_regeneratorRuntime().mark(function e(){return colorCorrectionEffect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break;}return e.abrupt("return");case 2:this.resources.renderer.renderTo(this.small.frame,this.small.getBuffer("model")),this.modelProcess(),this.hasLUT&&this.resources.filters.set(this.filterName,this.ccFilter);case 5:case"end":return e.stop();}},e,this);})),function(){return n.apply(this,arguments);})},{key:"disable",value:function value(){colorCorrectionEffect_superPropGet(t,"disable",this,3)([]),this.resources.filters["delete"](this.filterName),this.bufferPool=new BufferPool();}},{key:"modelProcess",value:(r=colorCorrectionEffect_asyncToGenerator(colorCorrectionEffect_regeneratorRuntime().mark(function e(){var t,r,n,i,o,a,s,u,l=this;return colorCorrectionEffect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.inWork){e.next=2;break;}return e.abrupt("return");case 2:if(this.checkTimer()){e.next=4;break;}return e.abrupt("return");case 4:return this.inWork=!0,t=this.config,r=t.modelHeight,n=t.modelWidth,i=this.small.getBuffer("model"),e.next=9,this.resources.renderer.pixelsAsync(i,{pool:this.bufferPool});case 9:return o=e.sent,a=this.bufferPool.getBuffer("f32",r*n*3),usePreprocessData(o,n,r,a),this.bufferPool.returnBuffer(o),s=this.bufferPool,u={output:{data:s.getBuffer("f32",107811),dims:[3,33,33,33]}},e.abrupt("return",this.inference.run(a,n,r,"colorcorrector",u).then(function(e){s.returnBuffer(e.inputBack.data);var t=s.getBuffer("u8",getPostprocessOutputSize());usePostprocessData({tensor:e},t),s.returnBuffer(e.output.data),l.ccFilter.setLUT(t,function(){s.returnBuffer(t);}),l.hasLUT=!0;})["catch"](function(e){var t;errorBus.bv.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:errorBus.JK.EFFECT_COLOR_CORRECTION,cause:e});})["finally"](function(){l.inWork=!1;}));case 16:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"setConfig",value:function value(e,t){this.config[e]=t,"filterPart"===e&&this.ccFilter.setFilterPart(t),"cc_power"===e&&this.ccFilter.setFilterPower(t);}},{key:"checkTimer",value:function value(){return this.modelTimer?(performance.now()-this.modelTimer<this.config.modelPediod_ms||(this.modelTimer=0),!1):(this.modelTimer=performance.now(),!0);}},{key:"destroy",value:function value(){}}]);var r,n,i;}();var smart_zoom_config={smoothPower:20,sensitivityValue:.15,faceAreaProportion:.1,modelHeight:240,modelWidth:320,faceDetectorAccuracy:.75,waiterSeconds:1,isFaceSquareDrawingEnabled:!1,isPreFaceSquareDrawingEnabled:!1,faceDetectorPediod_ms:250};function faceCombiner_typeof(e){return faceCombiner_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},faceCombiner_typeof(e);}function faceCombiner_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function faceCombiner_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,faceCombiner_toPropertyKey(n.key),n);}}function faceCombiner_createClass(e,t,r){return t&&faceCombiner_defineProperties(e.prototype,t),r&&faceCombiner_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function faceCombiner_toPropertyKey(e){var t=faceCombiner_toPrimitive(e,"string");return"symbol"==faceCombiner_typeof(t)?t:t+"";}function faceCombiner_toPrimitive(e,t){if("object"!=faceCombiner_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=faceCombiner_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var FaceCombiner=function(){return faceCombiner_createClass(function e(t,r){faceCombiner_classCallCheck(this,e),this.setCoord(t),this.id=null!=r?r:Math.round(100*Math.random());},[{key:"setID",value:function value(e){this.id=e;}},{key:"getID",value:function value(){return this.id;}},{key:"checkSame",value:function value(e){if(void 0===this.x1)return!1;if(!(e.x1>this.x1&&e.x1<this.x2||e.x2>this.x1&&e.x2<this.x2||this.x1>e.x1&&this.x1<e.x2||this.x2>e.x1&&this.x2<e.x2))return!1;if(!(e.y1>this.y1&&e.y1<this.y2||e.y2>this.y1&&e.y2<this.y2||this.y1>e.y1&&this.y1<e.y2||this.y2>e.y1&&this.y2<e.y2))return!1;var t=this.calcSquare(e),r=Math.abs(Math.max(this.x1,e.x1)-Math.min(this.x2,e.x2));return!!(Math.abs(Math.max(this.y1,e.y1)-Math.min(this.y2,e.y2))*r/Math.min(this.square,t)>.7)&&(this.setCoord(e),!0);}},{key:"getRect",value:function value(){return{x1:this.x1,y1:this.y1,width:this.x2-this.x1,height:this.y2-this.y1};}},{key:"getCoord",value:function value(){return{x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2};}},{key:"getSquare",value:function value(){return this.square;}},{key:"getCenter",value:function value(){return{x:this.x1+(this.x2-this.x1)/2,y:this.y1+(this.y2-this.y1)/2};}},{key:"isEqual",value:function value(e,t,r,n){if(!e)return!1;var i=e.getCoord();return!(Math.abs(this.x1-i.x1)/(null!=n?n:this.x2-this.x1)>t)&&!(Math.abs(this.x2-i.x2)/(null!=n?n:this.x2-this.x1)>t)&&!(Math.abs(this.y1-i.y1)/(null!=r?r:this.y2-this.y1)>t)&&!(Math.abs(this.y2-i.y2)/(null!=r?r:this.y2-this.y1)>t);}},{key:"setCoord",value:function value(e){var t=void 0===this.x1;this.x1=t?e.x1:Math.min(this.x1,e.x1),this.y1=t?e.y1:Math.min(this.y1,e.y1),this.x2=t?e.x2:Math.max(this.x2,e.x2),this.y2=t?e.y2:Math.max(this.y2,e.y2),this.square=this.calcSquare(e);}},{key:"calcSquare",value:function value(e){return(e.x2-e.x1)*(e.y2-e.y1);}}]);}();var priors=[{x:.0125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0125,y:.016666666666666666,w:.075,h:.1},{x:.0375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0375,y:.016666666666666666,w:.075,h:.1},{x:.0625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0625,y:.016666666666666666,w:.075,h:.1},{x:.0875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0875,y:.016666666666666666,w:.075,h:.1},{x:.1125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1125,y:.016666666666666666,w:.075,h:.1},{x:.1375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1375,y:.016666666666666666,w:.075,h:.1},{x:.1625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1625,y:.016666666666666666,w:.075,h:.1},{x:.1875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1875,y:.016666666666666666,w:.075,h:.1},{x:.2125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2125,y:.016666666666666666,w:.075,h:.1},{x:.2375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2375,y:.016666666666666666,w:.075,h:.1},{x:.2625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2625,y:.016666666666666666,w:.075,h:.1},{x:.2875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2875,y:.016666666666666666,w:.075,h:.1},{x:.3125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3125,y:.016666666666666666,w:.075,h:.1},{x:.3375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3375,y:.016666666666666666,w:.075,h:.1},{x:.3625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3625,y:.016666666666666666,w:.075,h:.1},{x:.3875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3875,y:.016666666666666666,w:.075,h:.1},{x:.4125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4125,y:.016666666666666666,w:.075,h:.1},{x:.4375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4375,y:.016666666666666666,w:.075,h:.1},{x:.4625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4625,y:.016666666666666666,w:.075,h:.1},{x:.4875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4875,y:.016666666666666666,w:.075,h:.1},{x:.5125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5125,y:.016666666666666666,w:.075,h:.1},{x:.5375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5375,y:.016666666666666666,w:.075,h:.1},{x:.5625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5625,y:.016666666666666666,w:.075,h:.1},{x:.5875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5875,y:.016666666666666666,w:.075,h:.1},{x:.6125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6125,y:.016666666666666666,w:.075,h:.1},{x:.6375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6375,y:.016666666666666666,w:.075,h:.1},{x:.6625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6625,y:.016666666666666666,w:.075,h:.1},{x:.6875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6875,y:.016666666666666666,w:.075,h:.1},{x:.7125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7125,y:.016666666666666666,w:.075,h:.1},{x:.7375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7375,y:.016666666666666666,w:.075,h:.1},{x:.7625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7625,y:.016666666666666666,w:.075,h:.1},{x:.7875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7875,y:.016666666666666666,w:.075,h:.1},{x:.8125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8125,y:.016666666666666666,w:.075,h:.1},{x:.8375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8375,y:.016666666666666666,w:.075,h:.1},{x:.8625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8625,y:.016666666666666666,w:.075,h:.1},{x:.8875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8875,y:.016666666666666666,w:.075,h:.1},{x:.9125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9125,y:.016666666666666666,w:.075,h:.1},{x:.9375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9375,y:.016666666666666666,w:.075,h:.1},{x:.9625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9625,y:.016666666666666666,w:.075,h:.1},{x:.9875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9875,y:.016666666666666666,w:.075,h:.1},{x:.0125,y:.05,w:.03125,h:.041666666666666664},{x:.0125,y:.05,w:.05,h:.06666666666666667},{x:.0125,y:.05,w:.075,h:.1},{x:.0375,y:.05,w:.03125,h:.041666666666666664},{x:.0375,y:.05,w:.05,h:.06666666666666667},{x:.0375,y:.05,w:.075,h:.1},{x:.0625,y:.05,w:.03125,h:.041666666666666664},{x:.0625,y:.05,w:.05,h:.06666666666666667},{x:.0625,y:.05,w:.075,h:.1},{x:.0875,y:.05,w:.03125,h:.041666666666666664},{x:.0875,y:.05,w:.05,h:.06666666666666667},{x:.0875,y:.05,w:.075,h:.1},{x:.1125,y:.05,w:.03125,h:.041666666666666664},{x:.1125,y:.05,w:.05,h:.06666666666666667},{x:.1125,y:.05,w:.075,h:.1},{x:.1375,y:.05,w:.03125,h:.041666666666666664},{x:.1375,y:.05,w:.05,h:.06666666666666667},{x:.1375,y:.05,w:.075,h:.1},{x:.1625,y:.05,w:.03125,h:.041666666666666664},{x:.1625,y:.05,w:.05,h:.06666666666666667},{x:.1625,y:.05,w:.075,h:.1},{x:.1875,y:.05,w:.03125,h:.041666666666666664},{x:.1875,y:.05,w:.05,h:.06666666666666667},{x:.1875,y:.05,w:.075,h:.1},{x:.2125,y:.05,w:.03125,h:.041666666666666664},{x:.2125,y:.05,w:.05,h:.06666666666666667},{x:.2125,y:.05,w:.075,h:.1},{x:.2375,y:.05,w:.03125,h:.041666666666666664},{x:.2375,y:.05,w:.05,h:.06666666666666667},{x:.2375,y:.05,w:.075,h:.1},{x:.2625,y:.05,w:.03125,h:.041666666666666664},{x:.2625,y:.05,w:.05,h:.06666666666666667},{x:.2625,y:.05,w:.075,h:.1},{x:.2875,y:.05,w:.03125,h:.041666666666666664},{x:.2875,y:.05,w:.05,h:.06666666666666667},{x:.2875,y:.05,w:.075,h:.1},{x:.3125,y:.05,w:.03125,h:.041666666666666664},{x:.3125,y:.05,w:.05,h:.06666666666666667},{x:.3125,y:.05,w:.075,h:.1},{x:.3375,y:.05,w:.03125,h:.041666666666666664},{x:.3375,y:.05,w:.05,h:.06666666666666667},{x:.3375,y:.05,w:.075,h:.1},{x:.3625,y:.05,w:.03125,h:.041666666666666664},{x:.3625,y:.05,w:.05,h:.06666666666666667},{x:.3625,y:.05,w:.075,h:.1},{x:.3875,y:.05,w:.03125,h:.041666666666666664},{x:.3875,y:.05,w:.05,h:.06666666666666667},{x:.3875,y:.05,w:.075,h:.1},{x:.4125,y:.05,w:.03125,h:.041666666666666664},{x:.4125,y:.05,w:.05,h:.06666666666666667},{x:.4125,y:.05,w:.075,h:.1},{x:.4375,y:.05,w:.03125,h:.041666666666666664},{x:.4375,y:.05,w:.05,h:.06666666666666667},{x:.4375,y:.05,w:.075,h:.1},{x:.4625,y:.05,w:.03125,h:.041666666666666664},{x:.4625,y:.05,w:.05,h:.06666666666666667},{x:.4625,y:.05,w:.075,h:.1},{x:.4875,y:.05,w:.03125,h:.041666666666666664},{x:.4875,y:.05,w:.05,h:.06666666666666667},{x:.4875,y:.05,w:.075,h:.1},{x:.5125,y:.05,w:.03125,h:.041666666666666664},{x:.5125,y:.05,w:.05,h:.06666666666666667},{x:.5125,y:.05,w:.075,h:.1},{x:.5375,y:.05,w:.03125,h:.041666666666666664},{x:.5375,y:.05,w:.05,h:.06666666666666667},{x:.5375,y:.05,w:.075,h:.1},{x:.5625,y:.05,w:.03125,h:.041666666666666664},{x:.5625,y:.05,w:.05,h:.06666666666666667},{x:.5625,y:.05,w:.075,h:.1},{x:.5875,y:.05,w:.03125,h:.041666666666666664},{x:.5875,y:.05,w:.05,h:.06666666666666667},{x:.5875,y:.05,w:.075,h:.1},{x:.6125,y:.05,w:.03125,h:.041666666666666664},{x:.6125,y:.05,w:.05,h:.06666666666666667},{x:.6125,y:.05,w:.075,h:.1},{x:.6375,y:.05,w:.03125,h:.041666666666666664},{x:.6375,y:.05,w:.05,h:.06666666666666667},{x:.6375,y:.05,w:.075,h:.1},{x:.6625,y:.05,w:.03125,h:.041666666666666664},{x:.6625,y:.05,w:.05,h:.06666666666666667},{x:.6625,y:.05,w:.075,h:.1},{x:.6875,y:.05,w:.03125,h:.041666666666666664},{x:.6875,y:.05,w:.05,h:.06666666666666667},{x:.6875,y:.05,w:.075,h:.1},{x:.7125,y:.05,w:.03125,h:.041666666666666664},{x:.7125,y:.05,w:.05,h:.06666666666666667},{x:.7125,y:.05,w:.075,h:.1},{x:.7375,y:.05,w:.03125,h:.041666666666666664},{x:.7375,y:.05,w:.05,h:.06666666666666667},{x:.7375,y:.05,w:.075,h:.1},{x:.7625,y:.05,w:.03125,h:.041666666666666664},{x:.7625,y:.05,w:.05,h:.06666666666666667},{x:.7625,y:.05,w:.075,h:.1},{x:.7875,y:.05,w:.03125,h:.041666666666666664},{x:.7875,y:.05,w:.05,h:.06666666666666667},{x:.7875,y:.05,w:.075,h:.1},{x:.8125,y:.05,w:.03125,h:.041666666666666664},{x:.8125,y:.05,w:.05,h:.06666666666666667},{x:.8125,y:.05,w:.075,h:.1},{x:.8375,y:.05,w:.03125,h:.041666666666666664},{x:.8375,y:.05,w:.05,h:.06666666666666667},{x:.8375,y:.05,w:.075,h:.1},{x:.8625,y:.05,w:.03125,h:.041666666666666664},{x:.8625,y:.05,w:.05,h:.06666666666666667},{x:.8625,y:.05,w:.075,h:.1},{x:.8875,y:.05,w:.03125,h:.041666666666666664},{x:.8875,y:.05,w:.05,h:.06666666666666667},{x:.8875,y:.05,w:.075,h:.1},{x:.9125,y:.05,w:.03125,h:.041666666666666664},{x:.9125,y:.05,w:.05,h:.06666666666666667},{x:.9125,y:.05,w:.075,h:.1},{x:.9375,y:.05,w:.03125,h:.041666666666666664},{x:.9375,y:.05,w:.05,h:.06666666666666667},{x:.9375,y:.05,w:.075,h:.1},{x:.9625,y:.05,w:.03125,h:.041666666666666664},{x:.9625,y:.05,w:.05,h:.06666666666666667},{x:.9625,y:.05,w:.075,h:.1},{x:.9875,y:.05,w:.03125,h:.041666666666666664},{x:.9875,y:.05,w:.05,h:.06666666666666667},{x:.9875,y:.05,w:.075,h:.1},{x:.0125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.08333333333333333,w:.075,h:.1},{x:.0375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.08333333333333333,w:.075,h:.1},{x:.0625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.08333333333333333,w:.075,h:.1},{x:.0875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.08333333333333333,w:.075,h:.1},{x:.1125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.08333333333333333,w:.075,h:.1},{x:.1375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.08333333333333333,w:.075,h:.1},{x:.1625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.08333333333333333,w:.075,h:.1},{x:.1875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.08333333333333333,w:.075,h:.1},{x:.2125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.08333333333333333,w:.075,h:.1},{x:.2375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.08333333333333333,w:.075,h:.1},{x:.2625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.08333333333333333,w:.075,h:.1},{x:.2875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.08333333333333333,w:.075,h:.1},{x:.3125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.08333333333333333,w:.075,h:.1},{x:.3375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.08333333333333333,w:.075,h:.1},{x:.3625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.08333333333333333,w:.075,h:.1},{x:.3875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.08333333333333333,w:.075,h:.1},{x:.4125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.08333333333333333,w:.075,h:.1},{x:.4375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.08333333333333333,w:.075,h:.1},{x:.4625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.08333333333333333,w:.075,h:.1},{x:.4875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.08333333333333333,w:.075,h:.1},{x:.5125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.08333333333333333,w:.075,h:.1},{x:.5375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.08333333333333333,w:.075,h:.1},{x:.5625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.08333333333333333,w:.075,h:.1},{x:.5875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.08333333333333333,w:.075,h:.1},{x:.6125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.08333333333333333,w:.075,h:.1},{x:.6375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.08333333333333333,w:.075,h:.1},{x:.6625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.08333333333333333,w:.075,h:.1},{x:.6875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.08333333333333333,w:.075,h:.1},{x:.7125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.08333333333333333,w:.075,h:.1},{x:.7375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.08333333333333333,w:.075,h:.1},{x:.7625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.08333333333333333,w:.075,h:.1},{x:.7875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.08333333333333333,w:.075,h:.1},{x:.8125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.08333333333333333,w:.075,h:.1},{x:.8375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.08333333333333333,w:.075,h:.1},{x:.8625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.08333333333333333,w:.075,h:.1},{x:.8875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.08333333333333333,w:.075,h:.1},{x:.9125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.08333333333333333,w:.075,h:.1},{x:.9375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.08333333333333333,w:.075,h:.1},{x:.9625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.08333333333333333,w:.075,h:.1},{x:.9875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.08333333333333333,w:.075,h:.1},{x:.0125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.11666666666666667,w:.075,h:.1},{x:.0375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.11666666666666667,w:.075,h:.1},{x:.0625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.11666666666666667,w:.075,h:.1},{x:.0875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.11666666666666667,w:.075,h:.1},{x:.1125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.11666666666666667,w:.075,h:.1},{x:.1375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.11666666666666667,w:.075,h:.1},{x:.1625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.11666666666666667,w:.075,h:.1},{x:.1875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.11666666666666667,w:.075,h:.1},{x:.2125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.11666666666666667,w:.075,h:.1},{x:.2375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.11666666666666667,w:.075,h:.1},{x:.2625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.11666666666666667,w:.075,h:.1},{x:.2875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.11666666666666667,w:.075,h:.1},{x:.3125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.11666666666666667,w:.075,h:.1},{x:.3375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.11666666666666667,w:.075,h:.1},{x:.3625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.11666666666666667,w:.075,h:.1},{x:.3875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.11666666666666667,w:.075,h:.1},{x:.4125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.11666666666666667,w:.075,h:.1},{x:.4375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.11666666666666667,w:.075,h:.1},{x:.4625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.11666666666666667,w:.075,h:.1},{x:.4875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.11666666666666667,w:.075,h:.1},{x:.5125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.11666666666666667,w:.075,h:.1},{x:.5375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.11666666666666667,w:.075,h:.1},{x:.5625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.11666666666666667,w:.075,h:.1},{x:.5875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.11666666666666667,w:.075,h:.1},{x:.6125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.11666666666666667,w:.075,h:.1},{x:.6375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.11666666666666667,w:.075,h:.1},{x:.6625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.11666666666666667,w:.075,h:.1},{x:.6875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.11666666666666667,w:.075,h:.1},{x:.7125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.11666666666666667,w:.075,h:.1},{x:.7375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.11666666666666667,w:.075,h:.1},{x:.7625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.11666666666666667,w:.075,h:.1},{x:.7875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.11666666666666667,w:.075,h:.1},{x:.8125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.11666666666666667,w:.075,h:.1},{x:.8375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.11666666666666667,w:.075,h:.1},{x:.8625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.11666666666666667,w:.075,h:.1},{x:.8875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.11666666666666667,w:.075,h:.1},{x:.9125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.11666666666666667,w:.075,h:.1},{x:.9375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.11666666666666667,w:.075,h:.1},{x:.9625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.11666666666666667,w:.075,h:.1},{x:.9875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.11666666666666667,w:.075,h:.1},{x:.0125,y:.15,w:.03125,h:.041666666666666664},{x:.0125,y:.15,w:.05,h:.06666666666666667},{x:.0125,y:.15,w:.075,h:.1},{x:.0375,y:.15,w:.03125,h:.041666666666666664},{x:.0375,y:.15,w:.05,h:.06666666666666667},{x:.0375,y:.15,w:.075,h:.1},{x:.0625,y:.15,w:.03125,h:.041666666666666664},{x:.0625,y:.15,w:.05,h:.06666666666666667},{x:.0625,y:.15,w:.075,h:.1},{x:.0875,y:.15,w:.03125,h:.041666666666666664},{x:.0875,y:.15,w:.05,h:.06666666666666667},{x:.0875,y:.15,w:.075,h:.1},{x:.1125,y:.15,w:.03125,h:.041666666666666664},{x:.1125,y:.15,w:.05,h:.06666666666666667},{x:.1125,y:.15,w:.075,h:.1},{x:.1375,y:.15,w:.03125,h:.041666666666666664},{x:.1375,y:.15,w:.05,h:.06666666666666667},{x:.1375,y:.15,w:.075,h:.1},{x:.1625,y:.15,w:.03125,h:.041666666666666664},{x:.1625,y:.15,w:.05,h:.06666666666666667},{x:.1625,y:.15,w:.075,h:.1},{x:.1875,y:.15,w:.03125,h:.041666666666666664},{x:.1875,y:.15,w:.05,h:.06666666666666667},{x:.1875,y:.15,w:.075,h:.1},{x:.2125,y:.15,w:.03125,h:.041666666666666664},{x:.2125,y:.15,w:.05,h:.06666666666666667},{x:.2125,y:.15,w:.075,h:.1},{x:.2375,y:.15,w:.03125,h:.041666666666666664},{x:.2375,y:.15,w:.05,h:.06666666666666667},{x:.2375,y:.15,w:.075,h:.1},{x:.2625,y:.15,w:.03125,h:.041666666666666664},{x:.2625,y:.15,w:.05,h:.06666666666666667},{x:.2625,y:.15,w:.075,h:.1},{x:.2875,y:.15,w:.03125,h:.041666666666666664},{x:.2875,y:.15,w:.05,h:.06666666666666667},{x:.2875,y:.15,w:.075,h:.1},{x:.3125,y:.15,w:.03125,h:.041666666666666664},{x:.3125,y:.15,w:.05,h:.06666666666666667},{x:.3125,y:.15,w:.075,h:.1},{x:.3375,y:.15,w:.03125,h:.041666666666666664},{x:.3375,y:.15,w:.05,h:.06666666666666667},{x:.3375,y:.15,w:.075,h:.1},{x:.3625,y:.15,w:.03125,h:.041666666666666664},{x:.3625,y:.15,w:.05,h:.06666666666666667},{x:.3625,y:.15,w:.075,h:.1},{x:.3875,y:.15,w:.03125,h:.041666666666666664},{x:.3875,y:.15,w:.05,h:.06666666666666667},{x:.3875,y:.15,w:.075,h:.1},{x:.4125,y:.15,w:.03125,h:.041666666666666664},{x:.4125,y:.15,w:.05,h:.06666666666666667},{x:.4125,y:.15,w:.075,h:.1},{x:.4375,y:.15,w:.03125,h:.041666666666666664},{x:.4375,y:.15,w:.05,h:.06666666666666667},{x:.4375,y:.15,w:.075,h:.1},{x:.4625,y:.15,w:.03125,h:.041666666666666664},{x:.4625,y:.15,w:.05,h:.06666666666666667},{x:.4625,y:.15,w:.075,h:.1},{x:.4875,y:.15,w:.03125,h:.041666666666666664},{x:.4875,y:.15,w:.05,h:.06666666666666667},{x:.4875,y:.15,w:.075,h:.1},{x:.5125,y:.15,w:.03125,h:.041666666666666664},{x:.5125,y:.15,w:.05,h:.06666666666666667},{x:.5125,y:.15,w:.075,h:.1},{x:.5375,y:.15,w:.03125,h:.041666666666666664},{x:.5375,y:.15,w:.05,h:.06666666666666667},{x:.5375,y:.15,w:.075,h:.1},{x:.5625,y:.15,w:.03125,h:.041666666666666664},{x:.5625,y:.15,w:.05,h:.06666666666666667},{x:.5625,y:.15,w:.075,h:.1},{x:.5875,y:.15,w:.03125,h:.041666666666666664},{x:.5875,y:.15,w:.05,h:.06666666666666667},{x:.5875,y:.15,w:.075,h:.1},{x:.6125,y:.15,w:.03125,h:.041666666666666664},{x:.6125,y:.15,w:.05,h:.06666666666666667},{x:.6125,y:.15,w:.075,h:.1},{x:.6375,y:.15,w:.03125,h:.041666666666666664},{x:.6375,y:.15,w:.05,h:.06666666666666667},{x:.6375,y:.15,w:.075,h:.1},{x:.6625,y:.15,w:.03125,h:.041666666666666664},{x:.6625,y:.15,w:.05,h:.06666666666666667},{x:.6625,y:.15,w:.075,h:.1},{x:.6875,y:.15,w:.03125,h:.041666666666666664},{x:.6875,y:.15,w:.05,h:.06666666666666667},{x:.6875,y:.15,w:.075,h:.1},{x:.7125,y:.15,w:.03125,h:.041666666666666664},{x:.7125,y:.15,w:.05,h:.06666666666666667},{x:.7125,y:.15,w:.075,h:.1},{x:.7375,y:.15,w:.03125,h:.041666666666666664},{x:.7375,y:.15,w:.05,h:.06666666666666667},{x:.7375,y:.15,w:.075,h:.1},{x:.7625,y:.15,w:.03125,h:.041666666666666664},{x:.7625,y:.15,w:.05,h:.06666666666666667},{x:.7625,y:.15,w:.075,h:.1},{x:.7875,y:.15,w:.03125,h:.041666666666666664},{x:.7875,y:.15,w:.05,h:.06666666666666667},{x:.7875,y:.15,w:.075,h:.1},{x:.8125,y:.15,w:.03125,h:.041666666666666664},{x:.8125,y:.15,w:.05,h:.06666666666666667},{x:.8125,y:.15,w:.075,h:.1},{x:.8375,y:.15,w:.03125,h:.041666666666666664},{x:.8375,y:.15,w:.05,h:.06666666666666667},{x:.8375,y:.15,w:.075,h:.1},{x:.8625,y:.15,w:.03125,h:.041666666666666664},{x:.8625,y:.15,w:.05,h:.06666666666666667},{x:.8625,y:.15,w:.075,h:.1},{x:.8875,y:.15,w:.03125,h:.041666666666666664},{x:.8875,y:.15,w:.05,h:.06666666666666667},{x:.8875,y:.15,w:.075,h:.1},{x:.9125,y:.15,w:.03125,h:.041666666666666664},{x:.9125,y:.15,w:.05,h:.06666666666666667},{x:.9125,y:.15,w:.075,h:.1},{x:.9375,y:.15,w:.03125,h:.041666666666666664},{x:.9375,y:.15,w:.05,h:.06666666666666667},{x:.9375,y:.15,w:.075,h:.1},{x:.9625,y:.15,w:.03125,h:.041666666666666664},{x:.9625,y:.15,w:.05,h:.06666666666666667},{x:.9625,y:.15,w:.075,h:.1},{x:.9875,y:.15,w:.03125,h:.041666666666666664},{x:.9875,y:.15,w:.05,h:.06666666666666667},{x:.9875,y:.15,w:.075,h:.1},{x:.0125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0125,y:.18333333333333332,w:.075,h:.1},{x:.0375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0375,y:.18333333333333332,w:.075,h:.1},{x:.0625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0625,y:.18333333333333332,w:.075,h:.1},{x:.0875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0875,y:.18333333333333332,w:.075,h:.1},{x:.1125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1125,y:.18333333333333332,w:.075,h:.1},{x:.1375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1375,y:.18333333333333332,w:.075,h:.1},{x:.1625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1625,y:.18333333333333332,w:.075,h:.1},{x:.1875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1875,y:.18333333333333332,w:.075,h:.1},{x:.2125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2125,y:.18333333333333332,w:.075,h:.1},{x:.2375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2375,y:.18333333333333332,w:.075,h:.1},{x:.2625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2625,y:.18333333333333332,w:.075,h:.1},{x:.2875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2875,y:.18333333333333332,w:.075,h:.1},{x:.3125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3125,y:.18333333333333332,w:.075,h:.1},{x:.3375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3375,y:.18333333333333332,w:.075,h:.1},{x:.3625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3625,y:.18333333333333332,w:.075,h:.1},{x:.3875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3875,y:.18333333333333332,w:.075,h:.1},{x:.4125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4125,y:.18333333333333332,w:.075,h:.1},{x:.4375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4375,y:.18333333333333332,w:.075,h:.1},{x:.4625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4625,y:.18333333333333332,w:.075,h:.1},{x:.4875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4875,y:.18333333333333332,w:.075,h:.1},{x:.5125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5125,y:.18333333333333332,w:.075,h:.1},{x:.5375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5375,y:.18333333333333332,w:.075,h:.1},{x:.5625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5625,y:.18333333333333332,w:.075,h:.1},{x:.5875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5875,y:.18333333333333332,w:.075,h:.1},{x:.6125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6125,y:.18333333333333332,w:.075,h:.1},{x:.6375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6375,y:.18333333333333332,w:.075,h:.1},{x:.6625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6625,y:.18333333333333332,w:.075,h:.1},{x:.6875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6875,y:.18333333333333332,w:.075,h:.1},{x:.7125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7125,y:.18333333333333332,w:.075,h:.1},{x:.7375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7375,y:.18333333333333332,w:.075,h:.1},{x:.7625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7625,y:.18333333333333332,w:.075,h:.1},{x:.7875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7875,y:.18333333333333332,w:.075,h:.1},{x:.8125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8125,y:.18333333333333332,w:.075,h:.1},{x:.8375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8375,y:.18333333333333332,w:.075,h:.1},{x:.8625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8625,y:.18333333333333332,w:.075,h:.1},{x:.8875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8875,y:.18333333333333332,w:.075,h:.1},{x:.9125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9125,y:.18333333333333332,w:.075,h:.1},{x:.9375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9375,y:.18333333333333332,w:.075,h:.1},{x:.9625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9625,y:.18333333333333332,w:.075,h:.1},{x:.9875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9875,y:.18333333333333332,w:.075,h:.1},{x:.0125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.21666666666666667,w:.075,h:.1},{x:.0375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.21666666666666667,w:.075,h:.1},{x:.0625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.21666666666666667,w:.075,h:.1},{x:.0875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.21666666666666667,w:.075,h:.1},{x:.1125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.21666666666666667,w:.075,h:.1},{x:.1375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.21666666666666667,w:.075,h:.1},{x:.1625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.21666666666666667,w:.075,h:.1},{x:.1875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.21666666666666667,w:.075,h:.1},{x:.2125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.21666666666666667,w:.075,h:.1},{x:.2375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.21666666666666667,w:.075,h:.1},{x:.2625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.21666666666666667,w:.075,h:.1},{x:.2875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.21666666666666667,w:.075,h:.1},{x:.3125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.21666666666666667,w:.075,h:.1},{x:.3375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.21666666666666667,w:.075,h:.1},{x:.3625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.21666666666666667,w:.075,h:.1},{x:.3875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.21666666666666667,w:.075,h:.1},{x:.4125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.21666666666666667,w:.075,h:.1},{x:.4375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.21666666666666667,w:.075,h:.1},{x:.4625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.21666666666666667,w:.075,h:.1},{x:.4875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.21666666666666667,w:.075,h:.1},{x:.5125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.21666666666666667,w:.075,h:.1},{x:.5375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.21666666666666667,w:.075,h:.1},{x:.5625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.21666666666666667,w:.075,h:.1},{x:.5875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.21666666666666667,w:.075,h:.1},{x:.6125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.21666666666666667,w:.075,h:.1},{x:.6375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.21666666666666667,w:.075,h:.1},{x:.6625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.21666666666666667,w:.075,h:.1},{x:.6875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.21666666666666667,w:.075,h:.1},{x:.7125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.21666666666666667,w:.075,h:.1},{x:.7375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.21666666666666667,w:.075,h:.1},{x:.7625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.21666666666666667,w:.075,h:.1},{x:.7875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.21666666666666667,w:.075,h:.1},{x:.8125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.21666666666666667,w:.075,h:.1},{x:.8375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.21666666666666667,w:.075,h:.1},{x:.8625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.21666666666666667,w:.075,h:.1},{x:.8875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.21666666666666667,w:.075,h:.1},{x:.9125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.21666666666666667,w:.075,h:.1},{x:.9375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.21666666666666667,w:.075,h:.1},{x:.9625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.21666666666666667,w:.075,h:.1},{x:.9875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.21666666666666667,w:.075,h:.1},{x:.0125,y:.25,w:.03125,h:.041666666666666664},{x:.0125,y:.25,w:.05,h:.06666666666666667},{x:.0125,y:.25,w:.075,h:.1},{x:.0375,y:.25,w:.03125,h:.041666666666666664},{x:.0375,y:.25,w:.05,h:.06666666666666667},{x:.0375,y:.25,w:.075,h:.1},{x:.0625,y:.25,w:.03125,h:.041666666666666664},{x:.0625,y:.25,w:.05,h:.06666666666666667},{x:.0625,y:.25,w:.075,h:.1},{x:.0875,y:.25,w:.03125,h:.041666666666666664},{x:.0875,y:.25,w:.05,h:.06666666666666667},{x:.0875,y:.25,w:.075,h:.1},{x:.1125,y:.25,w:.03125,h:.041666666666666664},{x:.1125,y:.25,w:.05,h:.06666666666666667},{x:.1125,y:.25,w:.075,h:.1},{x:.1375,y:.25,w:.03125,h:.041666666666666664},{x:.1375,y:.25,w:.05,h:.06666666666666667},{x:.1375,y:.25,w:.075,h:.1},{x:.1625,y:.25,w:.03125,h:.041666666666666664},{x:.1625,y:.25,w:.05,h:.06666666666666667},{x:.1625,y:.25,w:.075,h:.1},{x:.1875,y:.25,w:.03125,h:.041666666666666664},{x:.1875,y:.25,w:.05,h:.06666666666666667},{x:.1875,y:.25,w:.075,h:.1},{x:.2125,y:.25,w:.03125,h:.041666666666666664},{x:.2125,y:.25,w:.05,h:.06666666666666667},{x:.2125,y:.25,w:.075,h:.1},{x:.2375,y:.25,w:.03125,h:.041666666666666664},{x:.2375,y:.25,w:.05,h:.06666666666666667},{x:.2375,y:.25,w:.075,h:.1},{x:.2625,y:.25,w:.03125,h:.041666666666666664},{x:.2625,y:.25,w:.05,h:.06666666666666667},{x:.2625,y:.25,w:.075,h:.1},{x:.2875,y:.25,w:.03125,h:.041666666666666664},{x:.2875,y:.25,w:.05,h:.06666666666666667},{x:.2875,y:.25,w:.075,h:.1},{x:.3125,y:.25,w:.03125,h:.041666666666666664},{x:.3125,y:.25,w:.05,h:.06666666666666667},{x:.3125,y:.25,w:.075,h:.1},{x:.3375,y:.25,w:.03125,h:.041666666666666664},{x:.3375,y:.25,w:.05,h:.06666666666666667},{x:.3375,y:.25,w:.075,h:.1},{x:.3625,y:.25,w:.03125,h:.041666666666666664},{x:.3625,y:.25,w:.05,h:.06666666666666667},{x:.3625,y:.25,w:.075,h:.1},{x:.3875,y:.25,w:.03125,h:.041666666666666664},{x:.3875,y:.25,w:.05,h:.06666666666666667},{x:.3875,y:.25,w:.075,h:.1},{x:.4125,y:.25,w:.03125,h:.041666666666666664},{x:.4125,y:.25,w:.05,h:.06666666666666667},{x:.4125,y:.25,w:.075,h:.1},{x:.4375,y:.25,w:.03125,h:.041666666666666664},{x:.4375,y:.25,w:.05,h:.06666666666666667},{x:.4375,y:.25,w:.075,h:.1},{x:.4625,y:.25,w:.03125,h:.041666666666666664},{x:.4625,y:.25,w:.05,h:.06666666666666667},{x:.4625,y:.25,w:.075,h:.1},{x:.4875,y:.25,w:.03125,h:.041666666666666664},{x:.4875,y:.25,w:.05,h:.06666666666666667},{x:.4875,y:.25,w:.075,h:.1},{x:.5125,y:.25,w:.03125,h:.041666666666666664},{x:.5125,y:.25,w:.05,h:.06666666666666667},{x:.5125,y:.25,w:.075,h:.1},{x:.5375,y:.25,w:.03125,h:.041666666666666664},{x:.5375,y:.25,w:.05,h:.06666666666666667},{x:.5375,y:.25,w:.075,h:.1},{x:.5625,y:.25,w:.03125,h:.041666666666666664},{x:.5625,y:.25,w:.05,h:.06666666666666667},{x:.5625,y:.25,w:.075,h:.1},{x:.5875,y:.25,w:.03125,h:.041666666666666664},{x:.5875,y:.25,w:.05,h:.06666666666666667},{x:.5875,y:.25,w:.075,h:.1},{x:.6125,y:.25,w:.03125,h:.041666666666666664},{x:.6125,y:.25,w:.05,h:.06666666666666667},{x:.6125,y:.25,w:.075,h:.1},{x:.6375,y:.25,w:.03125,h:.041666666666666664},{x:.6375,y:.25,w:.05,h:.06666666666666667},{x:.6375,y:.25,w:.075,h:.1},{x:.6625,y:.25,w:.03125,h:.041666666666666664},{x:.6625,y:.25,w:.05,h:.06666666666666667},{x:.6625,y:.25,w:.075,h:.1},{x:.6875,y:.25,w:.03125,h:.041666666666666664},{x:.6875,y:.25,w:.05,h:.06666666666666667},{x:.6875,y:.25,w:.075,h:.1},{x:.7125,y:.25,w:.03125,h:.041666666666666664},{x:.7125,y:.25,w:.05,h:.06666666666666667},{x:.7125,y:.25,w:.075,h:.1},{x:.7375,y:.25,w:.03125,h:.041666666666666664},{x:.7375,y:.25,w:.05,h:.06666666666666667},{x:.7375,y:.25,w:.075,h:.1},{x:.7625,y:.25,w:.03125,h:.041666666666666664},{x:.7625,y:.25,w:.05,h:.06666666666666667},{x:.7625,y:.25,w:.075,h:.1},{x:.7875,y:.25,w:.03125,h:.041666666666666664},{x:.7875,y:.25,w:.05,h:.06666666666666667},{x:.7875,y:.25,w:.075,h:.1},{x:.8125,y:.25,w:.03125,h:.041666666666666664},{x:.8125,y:.25,w:.05,h:.06666666666666667},{x:.8125,y:.25,w:.075,h:.1},{x:.8375,y:.25,w:.03125,h:.041666666666666664},{x:.8375,y:.25,w:.05,h:.06666666666666667},{x:.8375,y:.25,w:.075,h:.1},{x:.8625,y:.25,w:.03125,h:.041666666666666664},{x:.8625,y:.25,w:.05,h:.06666666666666667},{x:.8625,y:.25,w:.075,h:.1},{x:.8875,y:.25,w:.03125,h:.041666666666666664},{x:.8875,y:.25,w:.05,h:.06666666666666667},{x:.8875,y:.25,w:.075,h:.1},{x:.9125,y:.25,w:.03125,h:.041666666666666664},{x:.9125,y:.25,w:.05,h:.06666666666666667},{x:.9125,y:.25,w:.075,h:.1},{x:.9375,y:.25,w:.03125,h:.041666666666666664},{x:.9375,y:.25,w:.05,h:.06666666666666667},{x:.9375,y:.25,w:.075,h:.1},{x:.9625,y:.25,w:.03125,h:.041666666666666664},{x:.9625,y:.25,w:.05,h:.06666666666666667},{x:.9625,y:.25,w:.075,h:.1},{x:.9875,y:.25,w:.03125,h:.041666666666666664},{x:.9875,y:.25,w:.05,h:.06666666666666667},{x:.9875,y:.25,w:.075,h:.1},{x:.0125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.2833333333333333,w:.075,h:.1},{x:.0375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.2833333333333333,w:.075,h:.1},{x:.0625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.2833333333333333,w:.075,h:.1},{x:.0875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.2833333333333333,w:.075,h:.1},{x:.1125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.2833333333333333,w:.075,h:.1},{x:.1375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.2833333333333333,w:.075,h:.1},{x:.1625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.2833333333333333,w:.075,h:.1},{x:.1875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.2833333333333333,w:.075,h:.1},{x:.2125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.2833333333333333,w:.075,h:.1},{x:.2375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.2833333333333333,w:.075,h:.1},{x:.2625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.2833333333333333,w:.075,h:.1},{x:.2875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.2833333333333333,w:.075,h:.1},{x:.3125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.2833333333333333,w:.075,h:.1},{x:.3375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.2833333333333333,w:.075,h:.1},{x:.3625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.2833333333333333,w:.075,h:.1},{x:.3875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.2833333333333333,w:.075,h:.1},{x:.4125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.2833333333333333,w:.075,h:.1},{x:.4375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.2833333333333333,w:.075,h:.1},{x:.4625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.2833333333333333,w:.075,h:.1},{x:.4875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.2833333333333333,w:.075,h:.1},{x:.5125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.2833333333333333,w:.075,h:.1},{x:.5375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.2833333333333333,w:.075,h:.1},{x:.5625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.2833333333333333,w:.075,h:.1},{x:.5875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.2833333333333333,w:.075,h:.1},{x:.6125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.2833333333333333,w:.075,h:.1},{x:.6375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.2833333333333333,w:.075,h:.1},{x:.6625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.2833333333333333,w:.075,h:.1},{x:.6875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.2833333333333333,w:.075,h:.1},{x:.7125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.2833333333333333,w:.075,h:.1},{x:.7375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.2833333333333333,w:.075,h:.1},{x:.7625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.2833333333333333,w:.075,h:.1},{x:.7875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.2833333333333333,w:.075,h:.1},{x:.8125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.2833333333333333,w:.075,h:.1},{x:.8375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.2833333333333333,w:.075,h:.1},{x:.8625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.2833333333333333,w:.075,h:.1},{x:.8875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.2833333333333333,w:.075,h:.1},{x:.9125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.2833333333333333,w:.075,h:.1},{x:.9375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.2833333333333333,w:.075,h:.1},{x:.9625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.2833333333333333,w:.075,h:.1},{x:.9875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.2833333333333333,w:.075,h:.1},{x:.0125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0125,y:.31666666666666665,w:.075,h:.1},{x:.0375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0375,y:.31666666666666665,w:.075,h:.1},{x:.0625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0625,y:.31666666666666665,w:.075,h:.1},{x:.0875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0875,y:.31666666666666665,w:.075,h:.1},{x:.1125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1125,y:.31666666666666665,w:.075,h:.1},{x:.1375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1375,y:.31666666666666665,w:.075,h:.1},{x:.1625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1625,y:.31666666666666665,w:.075,h:.1},{x:.1875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1875,y:.31666666666666665,w:.075,h:.1},{x:.2125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2125,y:.31666666666666665,w:.075,h:.1},{x:.2375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2375,y:.31666666666666665,w:.075,h:.1},{x:.2625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2625,y:.31666666666666665,w:.075,h:.1},{x:.2875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2875,y:.31666666666666665,w:.075,h:.1},{x:.3125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3125,y:.31666666666666665,w:.075,h:.1},{x:.3375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3375,y:.31666666666666665,w:.075,h:.1},{x:.3625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3625,y:.31666666666666665,w:.075,h:.1},{x:.3875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3875,y:.31666666666666665,w:.075,h:.1},{x:.4125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4125,y:.31666666666666665,w:.075,h:.1},{x:.4375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4375,y:.31666666666666665,w:.075,h:.1},{x:.4625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4625,y:.31666666666666665,w:.075,h:.1},{x:.4875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4875,y:.31666666666666665,w:.075,h:.1},{x:.5125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5125,y:.31666666666666665,w:.075,h:.1},{x:.5375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5375,y:.31666666666666665,w:.075,h:.1},{x:.5625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5625,y:.31666666666666665,w:.075,h:.1},{x:.5875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5875,y:.31666666666666665,w:.075,h:.1},{x:.6125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6125,y:.31666666666666665,w:.075,h:.1},{x:.6375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6375,y:.31666666666666665,w:.075,h:.1},{x:.6625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6625,y:.31666666666666665,w:.075,h:.1},{x:.6875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6875,y:.31666666666666665,w:.075,h:.1},{x:.7125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7125,y:.31666666666666665,w:.075,h:.1},{x:.7375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7375,y:.31666666666666665,w:.075,h:.1},{x:.7625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7625,y:.31666666666666665,w:.075,h:.1},{x:.7875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7875,y:.31666666666666665,w:.075,h:.1},{x:.8125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8125,y:.31666666666666665,w:.075,h:.1},{x:.8375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8375,y:.31666666666666665,w:.075,h:.1},{x:.8625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8625,y:.31666666666666665,w:.075,h:.1},{x:.8875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8875,y:.31666666666666665,w:.075,h:.1},{x:.9125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9125,y:.31666666666666665,w:.075,h:.1},{x:.9375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9375,y:.31666666666666665,w:.075,h:.1},{x:.9625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9625,y:.31666666666666665,w:.075,h:.1},{x:.9875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9875,y:.31666666666666665,w:.075,h:.1},{x:.0125,y:.35,w:.03125,h:.041666666666666664},{x:.0125,y:.35,w:.05,h:.06666666666666667},{x:.0125,y:.35,w:.075,h:.1},{x:.0375,y:.35,w:.03125,h:.041666666666666664},{x:.0375,y:.35,w:.05,h:.06666666666666667},{x:.0375,y:.35,w:.075,h:.1},{x:.0625,y:.35,w:.03125,h:.041666666666666664},{x:.0625,y:.35,w:.05,h:.06666666666666667},{x:.0625,y:.35,w:.075,h:.1},{x:.0875,y:.35,w:.03125,h:.041666666666666664},{x:.0875,y:.35,w:.05,h:.06666666666666667},{x:.0875,y:.35,w:.075,h:.1},{x:.1125,y:.35,w:.03125,h:.041666666666666664},{x:.1125,y:.35,w:.05,h:.06666666666666667},{x:.1125,y:.35,w:.075,h:.1},{x:.1375,y:.35,w:.03125,h:.041666666666666664},{x:.1375,y:.35,w:.05,h:.06666666666666667},{x:.1375,y:.35,w:.075,h:.1},{x:.1625,y:.35,w:.03125,h:.041666666666666664},{x:.1625,y:.35,w:.05,h:.06666666666666667},{x:.1625,y:.35,w:.075,h:.1},{x:.1875,y:.35,w:.03125,h:.041666666666666664},{x:.1875,y:.35,w:.05,h:.06666666666666667},{x:.1875,y:.35,w:.075,h:.1},{x:.2125,y:.35,w:.03125,h:.041666666666666664},{x:.2125,y:.35,w:.05,h:.06666666666666667},{x:.2125,y:.35,w:.075,h:.1},{x:.2375,y:.35,w:.03125,h:.041666666666666664},{x:.2375,y:.35,w:.05,h:.06666666666666667},{x:.2375,y:.35,w:.075,h:.1},{x:.2625,y:.35,w:.03125,h:.041666666666666664},{x:.2625,y:.35,w:.05,h:.06666666666666667},{x:.2625,y:.35,w:.075,h:.1},{x:.2875,y:.35,w:.03125,h:.041666666666666664},{x:.2875,y:.35,w:.05,h:.06666666666666667},{x:.2875,y:.35,w:.075,h:.1},{x:.3125,y:.35,w:.03125,h:.041666666666666664},{x:.3125,y:.35,w:.05,h:.06666666666666667},{x:.3125,y:.35,w:.075,h:.1},{x:.3375,y:.35,w:.03125,h:.041666666666666664},{x:.3375,y:.35,w:.05,h:.06666666666666667},{x:.3375,y:.35,w:.075,h:.1},{x:.3625,y:.35,w:.03125,h:.041666666666666664},{x:.3625,y:.35,w:.05,h:.06666666666666667},{x:.3625,y:.35,w:.075,h:.1},{x:.3875,y:.35,w:.03125,h:.041666666666666664},{x:.3875,y:.35,w:.05,h:.06666666666666667},{x:.3875,y:.35,w:.075,h:.1},{x:.4125,y:.35,w:.03125,h:.041666666666666664},{x:.4125,y:.35,w:.05,h:.06666666666666667},{x:.4125,y:.35,w:.075,h:.1},{x:.4375,y:.35,w:.03125,h:.041666666666666664},{x:.4375,y:.35,w:.05,h:.06666666666666667},{x:.4375,y:.35,w:.075,h:.1},{x:.4625,y:.35,w:.03125,h:.041666666666666664},{x:.4625,y:.35,w:.05,h:.06666666666666667},{x:.4625,y:.35,w:.075,h:.1},{x:.4875,y:.35,w:.03125,h:.041666666666666664},{x:.4875,y:.35,w:.05,h:.06666666666666667},{x:.4875,y:.35,w:.075,h:.1},{x:.5125,y:.35,w:.03125,h:.041666666666666664},{x:.5125,y:.35,w:.05,h:.06666666666666667},{x:.5125,y:.35,w:.075,h:.1},{x:.5375,y:.35,w:.03125,h:.041666666666666664},{x:.5375,y:.35,w:.05,h:.06666666666666667},{x:.5375,y:.35,w:.075,h:.1},{x:.5625,y:.35,w:.03125,h:.041666666666666664},{x:.5625,y:.35,w:.05,h:.06666666666666667},{x:.5625,y:.35,w:.075,h:.1},{x:.5875,y:.35,w:.03125,h:.041666666666666664},{x:.5875,y:.35,w:.05,h:.06666666666666667},{x:.5875,y:.35,w:.075,h:.1},{x:.6125,y:.35,w:.03125,h:.041666666666666664},{x:.6125,y:.35,w:.05,h:.06666666666666667},{x:.6125,y:.35,w:.075,h:.1},{x:.6375,y:.35,w:.03125,h:.041666666666666664},{x:.6375,y:.35,w:.05,h:.06666666666666667},{x:.6375,y:.35,w:.075,h:.1},{x:.6625,y:.35,w:.03125,h:.041666666666666664},{x:.6625,y:.35,w:.05,h:.06666666666666667},{x:.6625,y:.35,w:.075,h:.1},{x:.6875,y:.35,w:.03125,h:.041666666666666664},{x:.6875,y:.35,w:.05,h:.06666666666666667},{x:.6875,y:.35,w:.075,h:.1},{x:.7125,y:.35,w:.03125,h:.041666666666666664},{x:.7125,y:.35,w:.05,h:.06666666666666667},{x:.7125,y:.35,w:.075,h:.1},{x:.7375,y:.35,w:.03125,h:.041666666666666664},{x:.7375,y:.35,w:.05,h:.06666666666666667},{x:.7375,y:.35,w:.075,h:.1},{x:.7625,y:.35,w:.03125,h:.041666666666666664},{x:.7625,y:.35,w:.05,h:.06666666666666667},{x:.7625,y:.35,w:.075,h:.1},{x:.7875,y:.35,w:.03125,h:.041666666666666664},{x:.7875,y:.35,w:.05,h:.06666666666666667},{x:.7875,y:.35,w:.075,h:.1},{x:.8125,y:.35,w:.03125,h:.041666666666666664},{x:.8125,y:.35,w:.05,h:.06666666666666667},{x:.8125,y:.35,w:.075,h:.1},{x:.8375,y:.35,w:.03125,h:.041666666666666664},{x:.8375,y:.35,w:.05,h:.06666666666666667},{x:.8375,y:.35,w:.075,h:.1},{x:.8625,y:.35,w:.03125,h:.041666666666666664},{x:.8625,y:.35,w:.05,h:.06666666666666667},{x:.8625,y:.35,w:.075,h:.1},{x:.8875,y:.35,w:.03125,h:.041666666666666664},{x:.8875,y:.35,w:.05,h:.06666666666666667},{x:.8875,y:.35,w:.075,h:.1},{x:.9125,y:.35,w:.03125,h:.041666666666666664},{x:.9125,y:.35,w:.05,h:.06666666666666667},{x:.9125,y:.35,w:.075,h:.1},{x:.9375,y:.35,w:.03125,h:.041666666666666664},{x:.9375,y:.35,w:.05,h:.06666666666666667},{x:.9375,y:.35,w:.075,h:.1},{x:.9625,y:.35,w:.03125,h:.041666666666666664},{x:.9625,y:.35,w:.05,h:.06666666666666667},{x:.9625,y:.35,w:.075,h:.1},{x:.9875,y:.35,w:.03125,h:.041666666666666664},{x:.9875,y:.35,w:.05,h:.06666666666666667},{x:.9875,y:.35,w:.075,h:.1},{x:.0125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0125,y:.38333333333333336,w:.075,h:.1},{x:.0375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0375,y:.38333333333333336,w:.075,h:.1},{x:.0625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0625,y:.38333333333333336,w:.075,h:.1},{x:.0875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0875,y:.38333333333333336,w:.075,h:.1},{x:.1125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1125,y:.38333333333333336,w:.075,h:.1},{x:.1375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1375,y:.38333333333333336,w:.075,h:.1},{x:.1625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1625,y:.38333333333333336,w:.075,h:.1},{x:.1875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1875,y:.38333333333333336,w:.075,h:.1},{x:.2125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2125,y:.38333333333333336,w:.075,h:.1},{x:.2375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2375,y:.38333333333333336,w:.075,h:.1},{x:.2625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2625,y:.38333333333333336,w:.075,h:.1},{x:.2875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2875,y:.38333333333333336,w:.075,h:.1},{x:.3125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3125,y:.38333333333333336,w:.075,h:.1},{x:.3375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3375,y:.38333333333333336,w:.075,h:.1},{x:.3625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3625,y:.38333333333333336,w:.075,h:.1},{x:.3875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3875,y:.38333333333333336,w:.075,h:.1},{x:.4125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4125,y:.38333333333333336,w:.075,h:.1},{x:.4375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4375,y:.38333333333333336,w:.075,h:.1},{x:.4625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4625,y:.38333333333333336,w:.075,h:.1},{x:.4875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4875,y:.38333333333333336,w:.075,h:.1},{x:.5125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5125,y:.38333333333333336,w:.075,h:.1},{x:.5375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5375,y:.38333333333333336,w:.075,h:.1},{x:.5625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5625,y:.38333333333333336,w:.075,h:.1},{x:.5875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5875,y:.38333333333333336,w:.075,h:.1},{x:.6125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6125,y:.38333333333333336,w:.075,h:.1},{x:.6375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6375,y:.38333333333333336,w:.075,h:.1},{x:.6625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6625,y:.38333333333333336,w:.075,h:.1},{x:.6875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6875,y:.38333333333333336,w:.075,h:.1},{x:.7125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7125,y:.38333333333333336,w:.075,h:.1},{x:.7375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7375,y:.38333333333333336,w:.075,h:.1},{x:.7625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7625,y:.38333333333333336,w:.075,h:.1},{x:.7875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7875,y:.38333333333333336,w:.075,h:.1},{x:.8125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8125,y:.38333333333333336,w:.075,h:.1},{x:.8375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8375,y:.38333333333333336,w:.075,h:.1},{x:.8625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8625,y:.38333333333333336,w:.075,h:.1},{x:.8875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8875,y:.38333333333333336,w:.075,h:.1},{x:.9125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9125,y:.38333333333333336,w:.075,h:.1},{x:.9375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9375,y:.38333333333333336,w:.075,h:.1},{x:.9625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9625,y:.38333333333333336,w:.075,h:.1},{x:.9875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9875,y:.38333333333333336,w:.075,h:.1},{x:.0125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.4166666666666667,w:.075,h:.1},{x:.0375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.4166666666666667,w:.075,h:.1},{x:.0625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.4166666666666667,w:.075,h:.1},{x:.0875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.4166666666666667,w:.075,h:.1},{x:.1125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.4166666666666667,w:.075,h:.1},{x:.1375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.4166666666666667,w:.075,h:.1},{x:.1625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.4166666666666667,w:.075,h:.1},{x:.1875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.4166666666666667,w:.075,h:.1},{x:.2125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.4166666666666667,w:.075,h:.1},{x:.2375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.4166666666666667,w:.075,h:.1},{x:.2625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.4166666666666667,w:.075,h:.1},{x:.2875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.4166666666666667,w:.075,h:.1},{x:.3125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.4166666666666667,w:.075,h:.1},{x:.3375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.4166666666666667,w:.075,h:.1},{x:.3625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.4166666666666667,w:.075,h:.1},{x:.3875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.4166666666666667,w:.075,h:.1},{x:.4125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.4166666666666667,w:.075,h:.1},{x:.4375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.4166666666666667,w:.075,h:.1},{x:.4625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.4166666666666667,w:.075,h:.1},{x:.4875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.4166666666666667,w:.075,h:.1},{x:.5125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.4166666666666667,w:.075,h:.1},{x:.5375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.4166666666666667,w:.075,h:.1},{x:.5625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.4166666666666667,w:.075,h:.1},{x:.5875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.4166666666666667,w:.075,h:.1},{x:.6125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.4166666666666667,w:.075,h:.1},{x:.6375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.4166666666666667,w:.075,h:.1},{x:.6625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.4166666666666667,w:.075,h:.1},{x:.6875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.4166666666666667,w:.075,h:.1},{x:.7125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.4166666666666667,w:.075,h:.1},{x:.7375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.4166666666666667,w:.075,h:.1},{x:.7625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.4166666666666667,w:.075,h:.1},{x:.7875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.4166666666666667,w:.075,h:.1},{x:.8125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.4166666666666667,w:.075,h:.1},{x:.8375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.4166666666666667,w:.075,h:.1},{x:.8625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.4166666666666667,w:.075,h:.1},{x:.8875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.4166666666666667,w:.075,h:.1},{x:.9125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.4166666666666667,w:.075,h:.1},{x:.9375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.4166666666666667,w:.075,h:.1},{x:.9625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.4166666666666667,w:.075,h:.1},{x:.9875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.4166666666666667,w:.075,h:.1},{x:.0125,y:.45,w:.03125,h:.041666666666666664},{x:.0125,y:.45,w:.05,h:.06666666666666667},{x:.0125,y:.45,w:.075,h:.1},{x:.0375,y:.45,w:.03125,h:.041666666666666664},{x:.0375,y:.45,w:.05,h:.06666666666666667},{x:.0375,y:.45,w:.075,h:.1},{x:.0625,y:.45,w:.03125,h:.041666666666666664},{x:.0625,y:.45,w:.05,h:.06666666666666667},{x:.0625,y:.45,w:.075,h:.1},{x:.0875,y:.45,w:.03125,h:.041666666666666664},{x:.0875,y:.45,w:.05,h:.06666666666666667},{x:.0875,y:.45,w:.075,h:.1},{x:.1125,y:.45,w:.03125,h:.041666666666666664},{x:.1125,y:.45,w:.05,h:.06666666666666667},{x:.1125,y:.45,w:.075,h:.1},{x:.1375,y:.45,w:.03125,h:.041666666666666664},{x:.1375,y:.45,w:.05,h:.06666666666666667},{x:.1375,y:.45,w:.075,h:.1},{x:.1625,y:.45,w:.03125,h:.041666666666666664},{x:.1625,y:.45,w:.05,h:.06666666666666667},{x:.1625,y:.45,w:.075,h:.1},{x:.1875,y:.45,w:.03125,h:.041666666666666664},{x:.1875,y:.45,w:.05,h:.06666666666666667},{x:.1875,y:.45,w:.075,h:.1},{x:.2125,y:.45,w:.03125,h:.041666666666666664},{x:.2125,y:.45,w:.05,h:.06666666666666667},{x:.2125,y:.45,w:.075,h:.1},{x:.2375,y:.45,w:.03125,h:.041666666666666664},{x:.2375,y:.45,w:.05,h:.06666666666666667},{x:.2375,y:.45,w:.075,h:.1},{x:.2625,y:.45,w:.03125,h:.041666666666666664},{x:.2625,y:.45,w:.05,h:.06666666666666667},{x:.2625,y:.45,w:.075,h:.1},{x:.2875,y:.45,w:.03125,h:.041666666666666664},{x:.2875,y:.45,w:.05,h:.06666666666666667},{x:.2875,y:.45,w:.075,h:.1},{x:.3125,y:.45,w:.03125,h:.041666666666666664},{x:.3125,y:.45,w:.05,h:.06666666666666667},{x:.3125,y:.45,w:.075,h:.1},{x:.3375,y:.45,w:.03125,h:.041666666666666664},{x:.3375,y:.45,w:.05,h:.06666666666666667},{x:.3375,y:.45,w:.075,h:.1},{x:.3625,y:.45,w:.03125,h:.041666666666666664},{x:.3625,y:.45,w:.05,h:.06666666666666667},{x:.3625,y:.45,w:.075,h:.1},{x:.3875,y:.45,w:.03125,h:.041666666666666664},{x:.3875,y:.45,w:.05,h:.06666666666666667},{x:.3875,y:.45,w:.075,h:.1},{x:.4125,y:.45,w:.03125,h:.041666666666666664},{x:.4125,y:.45,w:.05,h:.06666666666666667},{x:.4125,y:.45,w:.075,h:.1},{x:.4375,y:.45,w:.03125,h:.041666666666666664},{x:.4375,y:.45,w:.05,h:.06666666666666667},{x:.4375,y:.45,w:.075,h:.1},{x:.4625,y:.45,w:.03125,h:.041666666666666664},{x:.4625,y:.45,w:.05,h:.06666666666666667},{x:.4625,y:.45,w:.075,h:.1},{x:.4875,y:.45,w:.03125,h:.041666666666666664},{x:.4875,y:.45,w:.05,h:.06666666666666667},{x:.4875,y:.45,w:.075,h:.1},{x:.5125,y:.45,w:.03125,h:.041666666666666664},{x:.5125,y:.45,w:.05,h:.06666666666666667},{x:.5125,y:.45,w:.075,h:.1},{x:.5375,y:.45,w:.03125,h:.041666666666666664},{x:.5375,y:.45,w:.05,h:.06666666666666667},{x:.5375,y:.45,w:.075,h:.1},{x:.5625,y:.45,w:.03125,h:.041666666666666664},{x:.5625,y:.45,w:.05,h:.06666666666666667},{x:.5625,y:.45,w:.075,h:.1},{x:.5875,y:.45,w:.03125,h:.041666666666666664},{x:.5875,y:.45,w:.05,h:.06666666666666667},{x:.5875,y:.45,w:.075,h:.1},{x:.6125,y:.45,w:.03125,h:.041666666666666664},{x:.6125,y:.45,w:.05,h:.06666666666666667},{x:.6125,y:.45,w:.075,h:.1},{x:.6375,y:.45,w:.03125,h:.041666666666666664},{x:.6375,y:.45,w:.05,h:.06666666666666667},{x:.6375,y:.45,w:.075,h:.1},{x:.6625,y:.45,w:.03125,h:.041666666666666664},{x:.6625,y:.45,w:.05,h:.06666666666666667},{x:.6625,y:.45,w:.075,h:.1},{x:.6875,y:.45,w:.03125,h:.041666666666666664},{x:.6875,y:.45,w:.05,h:.06666666666666667},{x:.6875,y:.45,w:.075,h:.1},{x:.7125,y:.45,w:.03125,h:.041666666666666664},{x:.7125,y:.45,w:.05,h:.06666666666666667},{x:.7125,y:.45,w:.075,h:.1},{x:.7375,y:.45,w:.03125,h:.041666666666666664},{x:.7375,y:.45,w:.05,h:.06666666666666667},{x:.7375,y:.45,w:.075,h:.1},{x:.7625,y:.45,w:.03125,h:.041666666666666664},{x:.7625,y:.45,w:.05,h:.06666666666666667},{x:.7625,y:.45,w:.075,h:.1},{x:.7875,y:.45,w:.03125,h:.041666666666666664},{x:.7875,y:.45,w:.05,h:.06666666666666667},{x:.7875,y:.45,w:.075,h:.1},{x:.8125,y:.45,w:.03125,h:.041666666666666664},{x:.8125,y:.45,w:.05,h:.06666666666666667},{x:.8125,y:.45,w:.075,h:.1},{x:.8375,y:.45,w:.03125,h:.041666666666666664},{x:.8375,y:.45,w:.05,h:.06666666666666667},{x:.8375,y:.45,w:.075,h:.1},{x:.8625,y:.45,w:.03125,h:.041666666666666664},{x:.8625,y:.45,w:.05,h:.06666666666666667},{x:.8625,y:.45,w:.075,h:.1},{x:.8875,y:.45,w:.03125,h:.041666666666666664},{x:.8875,y:.45,w:.05,h:.06666666666666667},{x:.8875,y:.45,w:.075,h:.1},{x:.9125,y:.45,w:.03125,h:.041666666666666664},{x:.9125,y:.45,w:.05,h:.06666666666666667},{x:.9125,y:.45,w:.075,h:.1},{x:.9375,y:.45,w:.03125,h:.041666666666666664},{x:.9375,y:.45,w:.05,h:.06666666666666667},{x:.9375,y:.45,w:.075,h:.1},{x:.9625,y:.45,w:.03125,h:.041666666666666664},{x:.9625,y:.45,w:.05,h:.06666666666666667},{x:.9625,y:.45,w:.075,h:.1},{x:.9875,y:.45,w:.03125,h:.041666666666666664},{x:.9875,y:.45,w:.05,h:.06666666666666667},{x:.9875,y:.45,w:.075,h:.1},{x:.0125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0125,y:.48333333333333334,w:.075,h:.1},{x:.0375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0375,y:.48333333333333334,w:.075,h:.1},{x:.0625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0625,y:.48333333333333334,w:.075,h:.1},{x:.0875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0875,y:.48333333333333334,w:.075,h:.1},{x:.1125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1125,y:.48333333333333334,w:.075,h:.1},{x:.1375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1375,y:.48333333333333334,w:.075,h:.1},{x:.1625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1625,y:.48333333333333334,w:.075,h:.1},{x:.1875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1875,y:.48333333333333334,w:.075,h:.1},{x:.2125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2125,y:.48333333333333334,w:.075,h:.1},{x:.2375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2375,y:.48333333333333334,w:.075,h:.1},{x:.2625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2625,y:.48333333333333334,w:.075,h:.1},{x:.2875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2875,y:.48333333333333334,w:.075,h:.1},{x:.3125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3125,y:.48333333333333334,w:.075,h:.1},{x:.3375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3375,y:.48333333333333334,w:.075,h:.1},{x:.3625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3625,y:.48333333333333334,w:.075,h:.1},{x:.3875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3875,y:.48333333333333334,w:.075,h:.1},{x:.4125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4125,y:.48333333333333334,w:.075,h:.1},{x:.4375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4375,y:.48333333333333334,w:.075,h:.1},{x:.4625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4625,y:.48333333333333334,w:.075,h:.1},{x:.4875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4875,y:.48333333333333334,w:.075,h:.1},{x:.5125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5125,y:.48333333333333334,w:.075,h:.1},{x:.5375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5375,y:.48333333333333334,w:.075,h:.1},{x:.5625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5625,y:.48333333333333334,w:.075,h:.1},{x:.5875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5875,y:.48333333333333334,w:.075,h:.1},{x:.6125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6125,y:.48333333333333334,w:.075,h:.1},{x:.6375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6375,y:.48333333333333334,w:.075,h:.1},{x:.6625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6625,y:.48333333333333334,w:.075,h:.1},{x:.6875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6875,y:.48333333333333334,w:.075,h:.1},{x:.7125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7125,y:.48333333333333334,w:.075,h:.1},{x:.7375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7375,y:.48333333333333334,w:.075,h:.1},{x:.7625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7625,y:.48333333333333334,w:.075,h:.1},{x:.7875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7875,y:.48333333333333334,w:.075,h:.1},{x:.8125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8125,y:.48333333333333334,w:.075,h:.1},{x:.8375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8375,y:.48333333333333334,w:.075,h:.1},{x:.8625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8625,y:.48333333333333334,w:.075,h:.1},{x:.8875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8875,y:.48333333333333334,w:.075,h:.1},{x:.9125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9125,y:.48333333333333334,w:.075,h:.1},{x:.9375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9375,y:.48333333333333334,w:.075,h:.1},{x:.9625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9625,y:.48333333333333334,w:.075,h:.1},{x:.9875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9875,y:.48333333333333334,w:.075,h:.1},{x:.0125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.5166666666666667,w:.075,h:.1},{x:.0375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.5166666666666667,w:.075,h:.1},{x:.0625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.5166666666666667,w:.075,h:.1},{x:.0875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.5166666666666667,w:.075,h:.1},{x:.1125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.5166666666666667,w:.075,h:.1},{x:.1375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.5166666666666667,w:.075,h:.1},{x:.1625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.5166666666666667,w:.075,h:.1},{x:.1875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.5166666666666667,w:.075,h:.1},{x:.2125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.5166666666666667,w:.075,h:.1},{x:.2375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.5166666666666667,w:.075,h:.1},{x:.2625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.5166666666666667,w:.075,h:.1},{x:.2875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.5166666666666667,w:.075,h:.1},{x:.3125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.5166666666666667,w:.075,h:.1},{x:.3375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.5166666666666667,w:.075,h:.1},{x:.3625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.5166666666666667,w:.075,h:.1},{x:.3875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.5166666666666667,w:.075,h:.1},{x:.4125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.5166666666666667,w:.075,h:.1},{x:.4375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.5166666666666667,w:.075,h:.1},{x:.4625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.5166666666666667,w:.075,h:.1},{x:.4875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.5166666666666667,w:.075,h:.1},{x:.5125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.5166666666666667,w:.075,h:.1},{x:.5375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.5166666666666667,w:.075,h:.1},{x:.5625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.5166666666666667,w:.075,h:.1},{x:.5875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.5166666666666667,w:.075,h:.1},{x:.6125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.5166666666666667,w:.075,h:.1},{x:.6375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.5166666666666667,w:.075,h:.1},{x:.6625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.5166666666666667,w:.075,h:.1},{x:.6875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.5166666666666667,w:.075,h:.1},{x:.7125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.5166666666666667,w:.075,h:.1},{x:.7375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.5166666666666667,w:.075,h:.1},{x:.7625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.5166666666666667,w:.075,h:.1},{x:.7875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.5166666666666667,w:.075,h:.1},{x:.8125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.5166666666666667,w:.075,h:.1},{x:.8375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.5166666666666667,w:.075,h:.1},{x:.8625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.5166666666666667,w:.075,h:.1},{x:.8875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.5166666666666667,w:.075,h:.1},{x:.9125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.5166666666666667,w:.075,h:.1},{x:.9375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.5166666666666667,w:.075,h:.1},{x:.9625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.5166666666666667,w:.075,h:.1},{x:.9875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.5166666666666667,w:.075,h:.1},{x:.0125,y:.55,w:.03125,h:.041666666666666664},{x:.0125,y:.55,w:.05,h:.06666666666666667},{x:.0125,y:.55,w:.075,h:.1},{x:.0375,y:.55,w:.03125,h:.041666666666666664},{x:.0375,y:.55,w:.05,h:.06666666666666667},{x:.0375,y:.55,w:.075,h:.1},{x:.0625,y:.55,w:.03125,h:.041666666666666664},{x:.0625,y:.55,w:.05,h:.06666666666666667},{x:.0625,y:.55,w:.075,h:.1},{x:.0875,y:.55,w:.03125,h:.041666666666666664},{x:.0875,y:.55,w:.05,h:.06666666666666667},{x:.0875,y:.55,w:.075,h:.1},{x:.1125,y:.55,w:.03125,h:.041666666666666664},{x:.1125,y:.55,w:.05,h:.06666666666666667},{x:.1125,y:.55,w:.075,h:.1},{x:.1375,y:.55,w:.03125,h:.041666666666666664},{x:.1375,y:.55,w:.05,h:.06666666666666667},{x:.1375,y:.55,w:.075,h:.1},{x:.1625,y:.55,w:.03125,h:.041666666666666664},{x:.1625,y:.55,w:.05,h:.06666666666666667},{x:.1625,y:.55,w:.075,h:.1},{x:.1875,y:.55,w:.03125,h:.041666666666666664},{x:.1875,y:.55,w:.05,h:.06666666666666667},{x:.1875,y:.55,w:.075,h:.1},{x:.2125,y:.55,w:.03125,h:.041666666666666664},{x:.2125,y:.55,w:.05,h:.06666666666666667},{x:.2125,y:.55,w:.075,h:.1},{x:.2375,y:.55,w:.03125,h:.041666666666666664},{x:.2375,y:.55,w:.05,h:.06666666666666667},{x:.2375,y:.55,w:.075,h:.1},{x:.2625,y:.55,w:.03125,h:.041666666666666664},{x:.2625,y:.55,w:.05,h:.06666666666666667},{x:.2625,y:.55,w:.075,h:.1},{x:.2875,y:.55,w:.03125,h:.041666666666666664},{x:.2875,y:.55,w:.05,h:.06666666666666667},{x:.2875,y:.55,w:.075,h:.1},{x:.3125,y:.55,w:.03125,h:.041666666666666664},{x:.3125,y:.55,w:.05,h:.06666666666666667},{x:.3125,y:.55,w:.075,h:.1},{x:.3375,y:.55,w:.03125,h:.041666666666666664},{x:.3375,y:.55,w:.05,h:.06666666666666667},{x:.3375,y:.55,w:.075,h:.1},{x:.3625,y:.55,w:.03125,h:.041666666666666664},{x:.3625,y:.55,w:.05,h:.06666666666666667},{x:.3625,y:.55,w:.075,h:.1},{x:.3875,y:.55,w:.03125,h:.041666666666666664},{x:.3875,y:.55,w:.05,h:.06666666666666667},{x:.3875,y:.55,w:.075,h:.1},{x:.4125,y:.55,w:.03125,h:.041666666666666664},{x:.4125,y:.55,w:.05,h:.06666666666666667},{x:.4125,y:.55,w:.075,h:.1},{x:.4375,y:.55,w:.03125,h:.041666666666666664},{x:.4375,y:.55,w:.05,h:.06666666666666667},{x:.4375,y:.55,w:.075,h:.1},{x:.4625,y:.55,w:.03125,h:.041666666666666664},{x:.4625,y:.55,w:.05,h:.06666666666666667},{x:.4625,y:.55,w:.075,h:.1},{x:.4875,y:.55,w:.03125,h:.041666666666666664},{x:.4875,y:.55,w:.05,h:.06666666666666667},{x:.4875,y:.55,w:.075,h:.1},{x:.5125,y:.55,w:.03125,h:.041666666666666664},{x:.5125,y:.55,w:.05,h:.06666666666666667},{x:.5125,y:.55,w:.075,h:.1},{x:.5375,y:.55,w:.03125,h:.041666666666666664},{x:.5375,y:.55,w:.05,h:.06666666666666667},{x:.5375,y:.55,w:.075,h:.1},{x:.5625,y:.55,w:.03125,h:.041666666666666664},{x:.5625,y:.55,w:.05,h:.06666666666666667},{x:.5625,y:.55,w:.075,h:.1},{x:.5875,y:.55,w:.03125,h:.041666666666666664},{x:.5875,y:.55,w:.05,h:.06666666666666667},{x:.5875,y:.55,w:.075,h:.1},{x:.6125,y:.55,w:.03125,h:.041666666666666664},{x:.6125,y:.55,w:.05,h:.06666666666666667},{x:.6125,y:.55,w:.075,h:.1},{x:.6375,y:.55,w:.03125,h:.041666666666666664},{x:.6375,y:.55,w:.05,h:.06666666666666667},{x:.6375,y:.55,w:.075,h:.1},{x:.6625,y:.55,w:.03125,h:.041666666666666664},{x:.6625,y:.55,w:.05,h:.06666666666666667},{x:.6625,y:.55,w:.075,h:.1},{x:.6875,y:.55,w:.03125,h:.041666666666666664},{x:.6875,y:.55,w:.05,h:.06666666666666667},{x:.6875,y:.55,w:.075,h:.1},{x:.7125,y:.55,w:.03125,h:.041666666666666664},{x:.7125,y:.55,w:.05,h:.06666666666666667},{x:.7125,y:.55,w:.075,h:.1},{x:.7375,y:.55,w:.03125,h:.041666666666666664},{x:.7375,y:.55,w:.05,h:.06666666666666667},{x:.7375,y:.55,w:.075,h:.1},{x:.7625,y:.55,w:.03125,h:.041666666666666664},{x:.7625,y:.55,w:.05,h:.06666666666666667},{x:.7625,y:.55,w:.075,h:.1},{x:.7875,y:.55,w:.03125,h:.041666666666666664},{x:.7875,y:.55,w:.05,h:.06666666666666667},{x:.7875,y:.55,w:.075,h:.1},{x:.8125,y:.55,w:.03125,h:.041666666666666664},{x:.8125,y:.55,w:.05,h:.06666666666666667},{x:.8125,y:.55,w:.075,h:.1},{x:.8375,y:.55,w:.03125,h:.041666666666666664},{x:.8375,y:.55,w:.05,h:.06666666666666667},{x:.8375,y:.55,w:.075,h:.1},{x:.8625,y:.55,w:.03125,h:.041666666666666664},{x:.8625,y:.55,w:.05,h:.06666666666666667},{x:.8625,y:.55,w:.075,h:.1},{x:.8875,y:.55,w:.03125,h:.041666666666666664},{x:.8875,y:.55,w:.05,h:.06666666666666667},{x:.8875,y:.55,w:.075,h:.1},{x:.9125,y:.55,w:.03125,h:.041666666666666664},{x:.9125,y:.55,w:.05,h:.06666666666666667},{x:.9125,y:.55,w:.075,h:.1},{x:.9375,y:.55,w:.03125,h:.041666666666666664},{x:.9375,y:.55,w:.05,h:.06666666666666667},{x:.9375,y:.55,w:.075,h:.1},{x:.9625,y:.55,w:.03125,h:.041666666666666664},{x:.9625,y:.55,w:.05,h:.06666666666666667},{x:.9625,y:.55,w:.075,h:.1},{x:.9875,y:.55,w:.03125,h:.041666666666666664},{x:.9875,y:.55,w:.05,h:.06666666666666667},{x:.9875,y:.55,w:.075,h:.1},{x:.0125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0125,y:.5833333333333334,w:.075,h:.1},{x:.0375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0375,y:.5833333333333334,w:.075,h:.1},{x:.0625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0625,y:.5833333333333334,w:.075,h:.1},{x:.0875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0875,y:.5833333333333334,w:.075,h:.1},{x:.1125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1125,y:.5833333333333334,w:.075,h:.1},{x:.1375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1375,y:.5833333333333334,w:.075,h:.1},{x:.1625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1625,y:.5833333333333334,w:.075,h:.1},{x:.1875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1875,y:.5833333333333334,w:.075,h:.1},{x:.2125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2125,y:.5833333333333334,w:.075,h:.1},{x:.2375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2375,y:.5833333333333334,w:.075,h:.1},{x:.2625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2625,y:.5833333333333334,w:.075,h:.1},{x:.2875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2875,y:.5833333333333334,w:.075,h:.1},{x:.3125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3125,y:.5833333333333334,w:.075,h:.1},{x:.3375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3375,y:.5833333333333334,w:.075,h:.1},{x:.3625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3625,y:.5833333333333334,w:.075,h:.1},{x:.3875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3875,y:.5833333333333334,w:.075,h:.1},{x:.4125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4125,y:.5833333333333334,w:.075,h:.1},{x:.4375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4375,y:.5833333333333334,w:.075,h:.1},{x:.4625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4625,y:.5833333333333334,w:.075,h:.1},{x:.4875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4875,y:.5833333333333334,w:.075,h:.1},{x:.5125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5125,y:.5833333333333334,w:.075,h:.1},{x:.5375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5375,y:.5833333333333334,w:.075,h:.1},{x:.5625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5625,y:.5833333333333334,w:.075,h:.1},{x:.5875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5875,y:.5833333333333334,w:.075,h:.1},{x:.6125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6125,y:.5833333333333334,w:.075,h:.1},{x:.6375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6375,y:.5833333333333334,w:.075,h:.1},{x:.6625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6625,y:.5833333333333334,w:.075,h:.1},{x:.6875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6875,y:.5833333333333334,w:.075,h:.1},{x:.7125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7125,y:.5833333333333334,w:.075,h:.1},{x:.7375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7375,y:.5833333333333334,w:.075,h:.1},{x:.7625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7625,y:.5833333333333334,w:.075,h:.1},{x:.7875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7875,y:.5833333333333334,w:.075,h:.1},{x:.8125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8125,y:.5833333333333334,w:.075,h:.1},{x:.8375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8375,y:.5833333333333334,w:.075,h:.1},{x:.8625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8625,y:.5833333333333334,w:.075,h:.1},{x:.8875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8875,y:.5833333333333334,w:.075,h:.1},{x:.9125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9125,y:.5833333333333334,w:.075,h:.1},{x:.9375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9375,y:.5833333333333334,w:.075,h:.1},{x:.9625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9625,y:.5833333333333334,w:.075,h:.1},{x:.9875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9875,y:.5833333333333334,w:.075,h:.1},{x:.0125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.6166666666666667,w:.075,h:.1},{x:.0375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.6166666666666667,w:.075,h:.1},{x:.0625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.6166666666666667,w:.075,h:.1},{x:.0875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.6166666666666667,w:.075,h:.1},{x:.1125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.6166666666666667,w:.075,h:.1},{x:.1375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.6166666666666667,w:.075,h:.1},{x:.1625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.6166666666666667,w:.075,h:.1},{x:.1875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.6166666666666667,w:.075,h:.1},{x:.2125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.6166666666666667,w:.075,h:.1},{x:.2375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.6166666666666667,w:.075,h:.1},{x:.2625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.6166666666666667,w:.075,h:.1},{x:.2875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.6166666666666667,w:.075,h:.1},{x:.3125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.6166666666666667,w:.075,h:.1},{x:.3375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.6166666666666667,w:.075,h:.1},{x:.3625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.6166666666666667,w:.075,h:.1},{x:.3875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.6166666666666667,w:.075,h:.1},{x:.4125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.6166666666666667,w:.075,h:.1},{x:.4375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.6166666666666667,w:.075,h:.1},{x:.4625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.6166666666666667,w:.075,h:.1},{x:.4875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.6166666666666667,w:.075,h:.1},{x:.5125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.6166666666666667,w:.075,h:.1},{x:.5375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.6166666666666667,w:.075,h:.1},{x:.5625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.6166666666666667,w:.075,h:.1},{x:.5875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.6166666666666667,w:.075,h:.1},{x:.6125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.6166666666666667,w:.075,h:.1},{x:.6375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.6166666666666667,w:.075,h:.1},{x:.6625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.6166666666666667,w:.075,h:.1},{x:.6875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.6166666666666667,w:.075,h:.1},{x:.7125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.6166666666666667,w:.075,h:.1},{x:.7375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.6166666666666667,w:.075,h:.1},{x:.7625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.6166666666666667,w:.075,h:.1},{x:.7875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.6166666666666667,w:.075,h:.1},{x:.8125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.6166666666666667,w:.075,h:.1},{x:.8375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.6166666666666667,w:.075,h:.1},{x:.8625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.6166666666666667,w:.075,h:.1},{x:.8875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.6166666666666667,w:.075,h:.1},{x:.9125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.6166666666666667,w:.075,h:.1},{x:.9375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.6166666666666667,w:.075,h:.1},{x:.9625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.6166666666666667,w:.075,h:.1},{x:.9875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.6166666666666667,w:.075,h:.1},{x:.0125,y:.65,w:.03125,h:.041666666666666664},{x:.0125,y:.65,w:.05,h:.06666666666666667},{x:.0125,y:.65,w:.075,h:.1},{x:.0375,y:.65,w:.03125,h:.041666666666666664},{x:.0375,y:.65,w:.05,h:.06666666666666667},{x:.0375,y:.65,w:.075,h:.1},{x:.0625,y:.65,w:.03125,h:.041666666666666664},{x:.0625,y:.65,w:.05,h:.06666666666666667},{x:.0625,y:.65,w:.075,h:.1},{x:.0875,y:.65,w:.03125,h:.041666666666666664},{x:.0875,y:.65,w:.05,h:.06666666666666667},{x:.0875,y:.65,w:.075,h:.1},{x:.1125,y:.65,w:.03125,h:.041666666666666664},{x:.1125,y:.65,w:.05,h:.06666666666666667},{x:.1125,y:.65,w:.075,h:.1},{x:.1375,y:.65,w:.03125,h:.041666666666666664},{x:.1375,y:.65,w:.05,h:.06666666666666667},{x:.1375,y:.65,w:.075,h:.1},{x:.1625,y:.65,w:.03125,h:.041666666666666664},{x:.1625,y:.65,w:.05,h:.06666666666666667},{x:.1625,y:.65,w:.075,h:.1},{x:.1875,y:.65,w:.03125,h:.041666666666666664},{x:.1875,y:.65,w:.05,h:.06666666666666667},{x:.1875,y:.65,w:.075,h:.1},{x:.2125,y:.65,w:.03125,h:.041666666666666664},{x:.2125,y:.65,w:.05,h:.06666666666666667},{x:.2125,y:.65,w:.075,h:.1},{x:.2375,y:.65,w:.03125,h:.041666666666666664},{x:.2375,y:.65,w:.05,h:.06666666666666667},{x:.2375,y:.65,w:.075,h:.1},{x:.2625,y:.65,w:.03125,h:.041666666666666664},{x:.2625,y:.65,w:.05,h:.06666666666666667},{x:.2625,y:.65,w:.075,h:.1},{x:.2875,y:.65,w:.03125,h:.041666666666666664},{x:.2875,y:.65,w:.05,h:.06666666666666667},{x:.2875,y:.65,w:.075,h:.1},{x:.3125,y:.65,w:.03125,h:.041666666666666664},{x:.3125,y:.65,w:.05,h:.06666666666666667},{x:.3125,y:.65,w:.075,h:.1},{x:.3375,y:.65,w:.03125,h:.041666666666666664},{x:.3375,y:.65,w:.05,h:.06666666666666667},{x:.3375,y:.65,w:.075,h:.1},{x:.3625,y:.65,w:.03125,h:.041666666666666664},{x:.3625,y:.65,w:.05,h:.06666666666666667},{x:.3625,y:.65,w:.075,h:.1},{x:.3875,y:.65,w:.03125,h:.041666666666666664},{x:.3875,y:.65,w:.05,h:.06666666666666667},{x:.3875,y:.65,w:.075,h:.1},{x:.4125,y:.65,w:.03125,h:.041666666666666664},{x:.4125,y:.65,w:.05,h:.06666666666666667},{x:.4125,y:.65,w:.075,h:.1},{x:.4375,y:.65,w:.03125,h:.041666666666666664},{x:.4375,y:.65,w:.05,h:.06666666666666667},{x:.4375,y:.65,w:.075,h:.1},{x:.4625,y:.65,w:.03125,h:.041666666666666664},{x:.4625,y:.65,w:.05,h:.06666666666666667},{x:.4625,y:.65,w:.075,h:.1},{x:.4875,y:.65,w:.03125,h:.041666666666666664},{x:.4875,y:.65,w:.05,h:.06666666666666667},{x:.4875,y:.65,w:.075,h:.1},{x:.5125,y:.65,w:.03125,h:.041666666666666664},{x:.5125,y:.65,w:.05,h:.06666666666666667},{x:.5125,y:.65,w:.075,h:.1},{x:.5375,y:.65,w:.03125,h:.041666666666666664},{x:.5375,y:.65,w:.05,h:.06666666666666667},{x:.5375,y:.65,w:.075,h:.1},{x:.5625,y:.65,w:.03125,h:.041666666666666664},{x:.5625,y:.65,w:.05,h:.06666666666666667},{x:.5625,y:.65,w:.075,h:.1},{x:.5875,y:.65,w:.03125,h:.041666666666666664},{x:.5875,y:.65,w:.05,h:.06666666666666667},{x:.5875,y:.65,w:.075,h:.1},{x:.6125,y:.65,w:.03125,h:.041666666666666664},{x:.6125,y:.65,w:.05,h:.06666666666666667},{x:.6125,y:.65,w:.075,h:.1},{x:.6375,y:.65,w:.03125,h:.041666666666666664},{x:.6375,y:.65,w:.05,h:.06666666666666667},{x:.6375,y:.65,w:.075,h:.1},{x:.6625,y:.65,w:.03125,h:.041666666666666664},{x:.6625,y:.65,w:.05,h:.06666666666666667},{x:.6625,y:.65,w:.075,h:.1},{x:.6875,y:.65,w:.03125,h:.041666666666666664},{x:.6875,y:.65,w:.05,h:.06666666666666667},{x:.6875,y:.65,w:.075,h:.1},{x:.7125,y:.65,w:.03125,h:.041666666666666664},{x:.7125,y:.65,w:.05,h:.06666666666666667},{x:.7125,y:.65,w:.075,h:.1},{x:.7375,y:.65,w:.03125,h:.041666666666666664},{x:.7375,y:.65,w:.05,h:.06666666666666667},{x:.7375,y:.65,w:.075,h:.1},{x:.7625,y:.65,w:.03125,h:.041666666666666664},{x:.7625,y:.65,w:.05,h:.06666666666666667},{x:.7625,y:.65,w:.075,h:.1},{x:.7875,y:.65,w:.03125,h:.041666666666666664},{x:.7875,y:.65,w:.05,h:.06666666666666667},{x:.7875,y:.65,w:.075,h:.1},{x:.8125,y:.65,w:.03125,h:.041666666666666664},{x:.8125,y:.65,w:.05,h:.06666666666666667},{x:.8125,y:.65,w:.075,h:.1},{x:.8375,y:.65,w:.03125,h:.041666666666666664},{x:.8375,y:.65,w:.05,h:.06666666666666667},{x:.8375,y:.65,w:.075,h:.1},{x:.8625,y:.65,w:.03125,h:.041666666666666664},{x:.8625,y:.65,w:.05,h:.06666666666666667},{x:.8625,y:.65,w:.075,h:.1},{x:.8875,y:.65,w:.03125,h:.041666666666666664},{x:.8875,y:.65,w:.05,h:.06666666666666667},{x:.8875,y:.65,w:.075,h:.1},{x:.9125,y:.65,w:.03125,h:.041666666666666664},{x:.9125,y:.65,w:.05,h:.06666666666666667},{x:.9125,y:.65,w:.075,h:.1},{x:.9375,y:.65,w:.03125,h:.041666666666666664},{x:.9375,y:.65,w:.05,h:.06666666666666667},{x:.9375,y:.65,w:.075,h:.1},{x:.9625,y:.65,w:.03125,h:.041666666666666664},{x:.9625,y:.65,w:.05,h:.06666666666666667},{x:.9625,y:.65,w:.075,h:.1},{x:.9875,y:.65,w:.03125,h:.041666666666666664},{x:.9875,y:.65,w:.05,h:.06666666666666667},{x:.9875,y:.65,w:.075,h:.1},{x:.0125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.6833333333333333,w:.075,h:.1},{x:.0375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.6833333333333333,w:.075,h:.1},{x:.0625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.6833333333333333,w:.075,h:.1},{x:.0875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.6833333333333333,w:.075,h:.1},{x:.1125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.6833333333333333,w:.075,h:.1},{x:.1375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.6833333333333333,w:.075,h:.1},{x:.1625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.6833333333333333,w:.075,h:.1},{x:.1875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.6833333333333333,w:.075,h:.1},{x:.2125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.6833333333333333,w:.075,h:.1},{x:.2375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.6833333333333333,w:.075,h:.1},{x:.2625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.6833333333333333,w:.075,h:.1},{x:.2875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.6833333333333333,w:.075,h:.1},{x:.3125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.6833333333333333,w:.075,h:.1},{x:.3375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.6833333333333333,w:.075,h:.1},{x:.3625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.6833333333333333,w:.075,h:.1},{x:.3875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.6833333333333333,w:.075,h:.1},{x:.4125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.6833333333333333,w:.075,h:.1},{x:.4375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.6833333333333333,w:.075,h:.1},{x:.4625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.6833333333333333,w:.075,h:.1},{x:.4875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.6833333333333333,w:.075,h:.1},{x:.5125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.6833333333333333,w:.075,h:.1},{x:.5375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.6833333333333333,w:.075,h:.1},{x:.5625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.6833333333333333,w:.075,h:.1},{x:.5875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.6833333333333333,w:.075,h:.1},{x:.6125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.6833333333333333,w:.075,h:.1},{x:.6375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.6833333333333333,w:.075,h:.1},{x:.6625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.6833333333333333,w:.075,h:.1},{x:.6875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.6833333333333333,w:.075,h:.1},{x:.7125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.6833333333333333,w:.075,h:.1},{x:.7375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.6833333333333333,w:.075,h:.1},{x:.7625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.6833333333333333,w:.075,h:.1},{x:.7875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.6833333333333333,w:.075,h:.1},{x:.8125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.6833333333333333,w:.075,h:.1},{x:.8375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.6833333333333333,w:.075,h:.1},{x:.8625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.6833333333333333,w:.075,h:.1},{x:.8875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.6833333333333333,w:.075,h:.1},{x:.9125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.6833333333333333,w:.075,h:.1},{x:.9375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.6833333333333333,w:.075,h:.1},{x:.9625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.6833333333333333,w:.075,h:.1},{x:.9875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.6833333333333333,w:.075,h:.1},{x:.0125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.7166666666666667,w:.075,h:.1},{x:.0375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.7166666666666667,w:.075,h:.1},{x:.0625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.7166666666666667,w:.075,h:.1},{x:.0875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.7166666666666667,w:.075,h:.1},{x:.1125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.7166666666666667,w:.075,h:.1},{x:.1375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.7166666666666667,w:.075,h:.1},{x:.1625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.7166666666666667,w:.075,h:.1},{x:.1875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.7166666666666667,w:.075,h:.1},{x:.2125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.7166666666666667,w:.075,h:.1},{x:.2375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.7166666666666667,w:.075,h:.1},{x:.2625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.7166666666666667,w:.075,h:.1},{x:.2875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.7166666666666667,w:.075,h:.1},{x:.3125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.7166666666666667,w:.075,h:.1},{x:.3375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.7166666666666667,w:.075,h:.1},{x:.3625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.7166666666666667,w:.075,h:.1},{x:.3875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.7166666666666667,w:.075,h:.1},{x:.4125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.7166666666666667,w:.075,h:.1},{x:.4375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.7166666666666667,w:.075,h:.1},{x:.4625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.7166666666666667,w:.075,h:.1},{x:.4875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.7166666666666667,w:.075,h:.1},{x:.5125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.7166666666666667,w:.075,h:.1},{x:.5375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.7166666666666667,w:.075,h:.1},{x:.5625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.7166666666666667,w:.075,h:.1},{x:.5875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.7166666666666667,w:.075,h:.1},{x:.6125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.7166666666666667,w:.075,h:.1},{x:.6375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.7166666666666667,w:.075,h:.1},{x:.6625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.7166666666666667,w:.075,h:.1},{x:.6875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.7166666666666667,w:.075,h:.1},{x:.7125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.7166666666666667,w:.075,h:.1},{x:.7375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.7166666666666667,w:.075,h:.1},{x:.7625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.7166666666666667,w:.075,h:.1},{x:.7875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.7166666666666667,w:.075,h:.1},{x:.8125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.7166666666666667,w:.075,h:.1},{x:.8375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.7166666666666667,w:.075,h:.1},{x:.8625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.7166666666666667,w:.075,h:.1},{x:.8875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.7166666666666667,w:.075,h:.1},{x:.9125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.7166666666666667,w:.075,h:.1},{x:.9375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.7166666666666667,w:.075,h:.1},{x:.9625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.7166666666666667,w:.075,h:.1},{x:.9875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.7166666666666667,w:.075,h:.1},{x:.0125,y:.75,w:.03125,h:.041666666666666664},{x:.0125,y:.75,w:.05,h:.06666666666666667},{x:.0125,y:.75,w:.075,h:.1},{x:.0375,y:.75,w:.03125,h:.041666666666666664},{x:.0375,y:.75,w:.05,h:.06666666666666667},{x:.0375,y:.75,w:.075,h:.1},{x:.0625,y:.75,w:.03125,h:.041666666666666664},{x:.0625,y:.75,w:.05,h:.06666666666666667},{x:.0625,y:.75,w:.075,h:.1},{x:.0875,y:.75,w:.03125,h:.041666666666666664},{x:.0875,y:.75,w:.05,h:.06666666666666667},{x:.0875,y:.75,w:.075,h:.1},{x:.1125,y:.75,w:.03125,h:.041666666666666664},{x:.1125,y:.75,w:.05,h:.06666666666666667},{x:.1125,y:.75,w:.075,h:.1},{x:.1375,y:.75,w:.03125,h:.041666666666666664},{x:.1375,y:.75,w:.05,h:.06666666666666667},{x:.1375,y:.75,w:.075,h:.1},{x:.1625,y:.75,w:.03125,h:.041666666666666664},{x:.1625,y:.75,w:.05,h:.06666666666666667},{x:.1625,y:.75,w:.075,h:.1},{x:.1875,y:.75,w:.03125,h:.041666666666666664},{x:.1875,y:.75,w:.05,h:.06666666666666667},{x:.1875,y:.75,w:.075,h:.1},{x:.2125,y:.75,w:.03125,h:.041666666666666664},{x:.2125,y:.75,w:.05,h:.06666666666666667},{x:.2125,y:.75,w:.075,h:.1},{x:.2375,y:.75,w:.03125,h:.041666666666666664},{x:.2375,y:.75,w:.05,h:.06666666666666667},{x:.2375,y:.75,w:.075,h:.1},{x:.2625,y:.75,w:.03125,h:.041666666666666664},{x:.2625,y:.75,w:.05,h:.06666666666666667},{x:.2625,y:.75,w:.075,h:.1},{x:.2875,y:.75,w:.03125,h:.041666666666666664},{x:.2875,y:.75,w:.05,h:.06666666666666667},{x:.2875,y:.75,w:.075,h:.1},{x:.3125,y:.75,w:.03125,h:.041666666666666664},{x:.3125,y:.75,w:.05,h:.06666666666666667},{x:.3125,y:.75,w:.075,h:.1},{x:.3375,y:.75,w:.03125,h:.041666666666666664},{x:.3375,y:.75,w:.05,h:.06666666666666667},{x:.3375,y:.75,w:.075,h:.1},{x:.3625,y:.75,w:.03125,h:.041666666666666664},{x:.3625,y:.75,w:.05,h:.06666666666666667},{x:.3625,y:.75,w:.075,h:.1},{x:.3875,y:.75,w:.03125,h:.041666666666666664},{x:.3875,y:.75,w:.05,h:.06666666666666667},{x:.3875,y:.75,w:.075,h:.1},{x:.4125,y:.75,w:.03125,h:.041666666666666664},{x:.4125,y:.75,w:.05,h:.06666666666666667},{x:.4125,y:.75,w:.075,h:.1},{x:.4375,y:.75,w:.03125,h:.041666666666666664},{x:.4375,y:.75,w:.05,h:.06666666666666667},{x:.4375,y:.75,w:.075,h:.1},{x:.4625,y:.75,w:.03125,h:.041666666666666664},{x:.4625,y:.75,w:.05,h:.06666666666666667},{x:.4625,y:.75,w:.075,h:.1},{x:.4875,y:.75,w:.03125,h:.041666666666666664},{x:.4875,y:.75,w:.05,h:.06666666666666667},{x:.4875,y:.75,w:.075,h:.1},{x:.5125,y:.75,w:.03125,h:.041666666666666664},{x:.5125,y:.75,w:.05,h:.06666666666666667},{x:.5125,y:.75,w:.075,h:.1},{x:.5375,y:.75,w:.03125,h:.041666666666666664},{x:.5375,y:.75,w:.05,h:.06666666666666667},{x:.5375,y:.75,w:.075,h:.1},{x:.5625,y:.75,w:.03125,h:.041666666666666664},{x:.5625,y:.75,w:.05,h:.06666666666666667},{x:.5625,y:.75,w:.075,h:.1},{x:.5875,y:.75,w:.03125,h:.041666666666666664},{x:.5875,y:.75,w:.05,h:.06666666666666667},{x:.5875,y:.75,w:.075,h:.1},{x:.6125,y:.75,w:.03125,h:.041666666666666664},{x:.6125,y:.75,w:.05,h:.06666666666666667},{x:.6125,y:.75,w:.075,h:.1},{x:.6375,y:.75,w:.03125,h:.041666666666666664},{x:.6375,y:.75,w:.05,h:.06666666666666667},{x:.6375,y:.75,w:.075,h:.1},{x:.6625,y:.75,w:.03125,h:.041666666666666664},{x:.6625,y:.75,w:.05,h:.06666666666666667},{x:.6625,y:.75,w:.075,h:.1},{x:.6875,y:.75,w:.03125,h:.041666666666666664},{x:.6875,y:.75,w:.05,h:.06666666666666667},{x:.6875,y:.75,w:.075,h:.1},{x:.7125,y:.75,w:.03125,h:.041666666666666664},{x:.7125,y:.75,w:.05,h:.06666666666666667},{x:.7125,y:.75,w:.075,h:.1},{x:.7375,y:.75,w:.03125,h:.041666666666666664},{x:.7375,y:.75,w:.05,h:.06666666666666667},{x:.7375,y:.75,w:.075,h:.1},{x:.7625,y:.75,w:.03125,h:.041666666666666664},{x:.7625,y:.75,w:.05,h:.06666666666666667},{x:.7625,y:.75,w:.075,h:.1},{x:.7875,y:.75,w:.03125,h:.041666666666666664},{x:.7875,y:.75,w:.05,h:.06666666666666667},{x:.7875,y:.75,w:.075,h:.1},{x:.8125,y:.75,w:.03125,h:.041666666666666664},{x:.8125,y:.75,w:.05,h:.06666666666666667},{x:.8125,y:.75,w:.075,h:.1},{x:.8375,y:.75,w:.03125,h:.041666666666666664},{x:.8375,y:.75,w:.05,h:.06666666666666667},{x:.8375,y:.75,w:.075,h:.1},{x:.8625,y:.75,w:.03125,h:.041666666666666664},{x:.8625,y:.75,w:.05,h:.06666666666666667},{x:.8625,y:.75,w:.075,h:.1},{x:.8875,y:.75,w:.03125,h:.041666666666666664},{x:.8875,y:.75,w:.05,h:.06666666666666667},{x:.8875,y:.75,w:.075,h:.1},{x:.9125,y:.75,w:.03125,h:.041666666666666664},{x:.9125,y:.75,w:.05,h:.06666666666666667},{x:.9125,y:.75,w:.075,h:.1},{x:.9375,y:.75,w:.03125,h:.041666666666666664},{x:.9375,y:.75,w:.05,h:.06666666666666667},{x:.9375,y:.75,w:.075,h:.1},{x:.9625,y:.75,w:.03125,h:.041666666666666664},{x:.9625,y:.75,w:.05,h:.06666666666666667},{x:.9625,y:.75,w:.075,h:.1},{x:.9875,y:.75,w:.03125,h:.041666666666666664},{x:.9875,y:.75,w:.05,h:.06666666666666667},{x:.9875,y:.75,w:.075,h:.1},{x:.0125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.7833333333333333,w:.075,h:.1},{x:.0375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.7833333333333333,w:.075,h:.1},{x:.0625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.7833333333333333,w:.075,h:.1},{x:.0875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.7833333333333333,w:.075,h:.1},{x:.1125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.7833333333333333,w:.075,h:.1},{x:.1375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.7833333333333333,w:.075,h:.1},{x:.1625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.7833333333333333,w:.075,h:.1},{x:.1875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.7833333333333333,w:.075,h:.1},{x:.2125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.7833333333333333,w:.075,h:.1},{x:.2375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.7833333333333333,w:.075,h:.1},{x:.2625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.7833333333333333,w:.075,h:.1},{x:.2875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.7833333333333333,w:.075,h:.1},{x:.3125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.7833333333333333,w:.075,h:.1},{x:.3375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.7833333333333333,w:.075,h:.1},{x:.3625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.7833333333333333,w:.075,h:.1},{x:.3875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.7833333333333333,w:.075,h:.1},{x:.4125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.7833333333333333,w:.075,h:.1},{x:.4375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.7833333333333333,w:.075,h:.1},{x:.4625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.7833333333333333,w:.075,h:.1},{x:.4875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.7833333333333333,w:.075,h:.1},{x:.5125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.7833333333333333,w:.075,h:.1},{x:.5375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.7833333333333333,w:.075,h:.1},{x:.5625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.7833333333333333,w:.075,h:.1},{x:.5875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.7833333333333333,w:.075,h:.1},{x:.6125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.7833333333333333,w:.075,h:.1},{x:.6375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.7833333333333333,w:.075,h:.1},{x:.6625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.7833333333333333,w:.075,h:.1},{x:.6875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.7833333333333333,w:.075,h:.1},{x:.7125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.7833333333333333,w:.075,h:.1},{x:.7375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.7833333333333333,w:.075,h:.1},{x:.7625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.7833333333333333,w:.075,h:.1},{x:.7875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.7833333333333333,w:.075,h:.1},{x:.8125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.7833333333333333,w:.075,h:.1},{x:.8375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.7833333333333333,w:.075,h:.1},{x:.8625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.7833333333333333,w:.075,h:.1},{x:.8875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.7833333333333333,w:.075,h:.1},{x:.9125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.7833333333333333,w:.075,h:.1},{x:.9375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.7833333333333333,w:.075,h:.1},{x:.9625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.7833333333333333,w:.075,h:.1},{x:.9875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.7833333333333333,w:.075,h:.1},{x:.0125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.8166666666666667,w:.075,h:.1},{x:.0375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.8166666666666667,w:.075,h:.1},{x:.0625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.8166666666666667,w:.075,h:.1},{x:.0875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.8166666666666667,w:.075,h:.1},{x:.1125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.8166666666666667,w:.075,h:.1},{x:.1375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.8166666666666667,w:.075,h:.1},{x:.1625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.8166666666666667,w:.075,h:.1},{x:.1875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.8166666666666667,w:.075,h:.1},{x:.2125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.8166666666666667,w:.075,h:.1},{x:.2375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.8166666666666667,w:.075,h:.1},{x:.2625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.8166666666666667,w:.075,h:.1},{x:.2875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.8166666666666667,w:.075,h:.1},{x:.3125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.8166666666666667,w:.075,h:.1},{x:.3375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.8166666666666667,w:.075,h:.1},{x:.3625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.8166666666666667,w:.075,h:.1},{x:.3875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.8166666666666667,w:.075,h:.1},{x:.4125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.8166666666666667,w:.075,h:.1},{x:.4375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.8166666666666667,w:.075,h:.1},{x:.4625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.8166666666666667,w:.075,h:.1},{x:.4875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.8166666666666667,w:.075,h:.1},{x:.5125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.8166666666666667,w:.075,h:.1},{x:.5375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.8166666666666667,w:.075,h:.1},{x:.5625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.8166666666666667,w:.075,h:.1},{x:.5875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.8166666666666667,w:.075,h:.1},{x:.6125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.8166666666666667,w:.075,h:.1},{x:.6375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.8166666666666667,w:.075,h:.1},{x:.6625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.8166666666666667,w:.075,h:.1},{x:.6875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.8166666666666667,w:.075,h:.1},{x:.7125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.8166666666666667,w:.075,h:.1},{x:.7375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.8166666666666667,w:.075,h:.1},{x:.7625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.8166666666666667,w:.075,h:.1},{x:.7875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.8166666666666667,w:.075,h:.1},{x:.8125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.8166666666666667,w:.075,h:.1},{x:.8375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.8166666666666667,w:.075,h:.1},{x:.8625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.8166666666666667,w:.075,h:.1},{x:.8875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.8166666666666667,w:.075,h:.1},{x:.9125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.8166666666666667,w:.075,h:.1},{x:.9375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.8166666666666667,w:.075,h:.1},{x:.9625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.8166666666666667,w:.075,h:.1},{x:.9875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.8166666666666667,w:.075,h:.1},{x:.0125,y:.85,w:.03125,h:.041666666666666664},{x:.0125,y:.85,w:.05,h:.06666666666666667},{x:.0125,y:.85,w:.075,h:.1},{x:.0375,y:.85,w:.03125,h:.041666666666666664},{x:.0375,y:.85,w:.05,h:.06666666666666667},{x:.0375,y:.85,w:.075,h:.1},{x:.0625,y:.85,w:.03125,h:.041666666666666664},{x:.0625,y:.85,w:.05,h:.06666666666666667},{x:.0625,y:.85,w:.075,h:.1},{x:.0875,y:.85,w:.03125,h:.041666666666666664},{x:.0875,y:.85,w:.05,h:.06666666666666667},{x:.0875,y:.85,w:.075,h:.1},{x:.1125,y:.85,w:.03125,h:.041666666666666664},{x:.1125,y:.85,w:.05,h:.06666666666666667},{x:.1125,y:.85,w:.075,h:.1},{x:.1375,y:.85,w:.03125,h:.041666666666666664},{x:.1375,y:.85,w:.05,h:.06666666666666667},{x:.1375,y:.85,w:.075,h:.1},{x:.1625,y:.85,w:.03125,h:.041666666666666664},{x:.1625,y:.85,w:.05,h:.06666666666666667},{x:.1625,y:.85,w:.075,h:.1},{x:.1875,y:.85,w:.03125,h:.041666666666666664},{x:.1875,y:.85,w:.05,h:.06666666666666667},{x:.1875,y:.85,w:.075,h:.1},{x:.2125,y:.85,w:.03125,h:.041666666666666664},{x:.2125,y:.85,w:.05,h:.06666666666666667},{x:.2125,y:.85,w:.075,h:.1},{x:.2375,y:.85,w:.03125,h:.041666666666666664},{x:.2375,y:.85,w:.05,h:.06666666666666667},{x:.2375,y:.85,w:.075,h:.1},{x:.2625,y:.85,w:.03125,h:.041666666666666664},{x:.2625,y:.85,w:.05,h:.06666666666666667},{x:.2625,y:.85,w:.075,h:.1},{x:.2875,y:.85,w:.03125,h:.041666666666666664},{x:.2875,y:.85,w:.05,h:.06666666666666667},{x:.2875,y:.85,w:.075,h:.1},{x:.3125,y:.85,w:.03125,h:.041666666666666664},{x:.3125,y:.85,w:.05,h:.06666666666666667},{x:.3125,y:.85,w:.075,h:.1},{x:.3375,y:.85,w:.03125,h:.041666666666666664},{x:.3375,y:.85,w:.05,h:.06666666666666667},{x:.3375,y:.85,w:.075,h:.1},{x:.3625,y:.85,w:.03125,h:.041666666666666664},{x:.3625,y:.85,w:.05,h:.06666666666666667},{x:.3625,y:.85,w:.075,h:.1},{x:.3875,y:.85,w:.03125,h:.041666666666666664},{x:.3875,y:.85,w:.05,h:.06666666666666667},{x:.3875,y:.85,w:.075,h:.1},{x:.4125,y:.85,w:.03125,h:.041666666666666664},{x:.4125,y:.85,w:.05,h:.06666666666666667},{x:.4125,y:.85,w:.075,h:.1},{x:.4375,y:.85,w:.03125,h:.041666666666666664},{x:.4375,y:.85,w:.05,h:.06666666666666667},{x:.4375,y:.85,w:.075,h:.1},{x:.4625,y:.85,w:.03125,h:.041666666666666664},{x:.4625,y:.85,w:.05,h:.06666666666666667},{x:.4625,y:.85,w:.075,h:.1},{x:.4875,y:.85,w:.03125,h:.041666666666666664},{x:.4875,y:.85,w:.05,h:.06666666666666667},{x:.4875,y:.85,w:.075,h:.1},{x:.5125,y:.85,w:.03125,h:.041666666666666664},{x:.5125,y:.85,w:.05,h:.06666666666666667},{x:.5125,y:.85,w:.075,h:.1},{x:.5375,y:.85,w:.03125,h:.041666666666666664},{x:.5375,y:.85,w:.05,h:.06666666666666667},{x:.5375,y:.85,w:.075,h:.1},{x:.5625,y:.85,w:.03125,h:.041666666666666664},{x:.5625,y:.85,w:.05,h:.06666666666666667},{x:.5625,y:.85,w:.075,h:.1},{x:.5875,y:.85,w:.03125,h:.041666666666666664},{x:.5875,y:.85,w:.05,h:.06666666666666667},{x:.5875,y:.85,w:.075,h:.1},{x:.6125,y:.85,w:.03125,h:.041666666666666664},{x:.6125,y:.85,w:.05,h:.06666666666666667},{x:.6125,y:.85,w:.075,h:.1},{x:.6375,y:.85,w:.03125,h:.041666666666666664},{x:.6375,y:.85,w:.05,h:.06666666666666667},{x:.6375,y:.85,w:.075,h:.1},{x:.6625,y:.85,w:.03125,h:.041666666666666664},{x:.6625,y:.85,w:.05,h:.06666666666666667},{x:.6625,y:.85,w:.075,h:.1},{x:.6875,y:.85,w:.03125,h:.041666666666666664},{x:.6875,y:.85,w:.05,h:.06666666666666667},{x:.6875,y:.85,w:.075,h:.1},{x:.7125,y:.85,w:.03125,h:.041666666666666664},{x:.7125,y:.85,w:.05,h:.06666666666666667},{x:.7125,y:.85,w:.075,h:.1},{x:.7375,y:.85,w:.03125,h:.041666666666666664},{x:.7375,y:.85,w:.05,h:.06666666666666667},{x:.7375,y:.85,w:.075,h:.1},{x:.7625,y:.85,w:.03125,h:.041666666666666664},{x:.7625,y:.85,w:.05,h:.06666666666666667},{x:.7625,y:.85,w:.075,h:.1},{x:.7875,y:.85,w:.03125,h:.041666666666666664},{x:.7875,y:.85,w:.05,h:.06666666666666667},{x:.7875,y:.85,w:.075,h:.1},{x:.8125,y:.85,w:.03125,h:.041666666666666664},{x:.8125,y:.85,w:.05,h:.06666666666666667},{x:.8125,y:.85,w:.075,h:.1},{x:.8375,y:.85,w:.03125,h:.041666666666666664},{x:.8375,y:.85,w:.05,h:.06666666666666667},{x:.8375,y:.85,w:.075,h:.1},{x:.8625,y:.85,w:.03125,h:.041666666666666664},{x:.8625,y:.85,w:.05,h:.06666666666666667},{x:.8625,y:.85,w:.075,h:.1},{x:.8875,y:.85,w:.03125,h:.041666666666666664},{x:.8875,y:.85,w:.05,h:.06666666666666667},{x:.8875,y:.85,w:.075,h:.1},{x:.9125,y:.85,w:.03125,h:.041666666666666664},{x:.9125,y:.85,w:.05,h:.06666666666666667},{x:.9125,y:.85,w:.075,h:.1},{x:.9375,y:.85,w:.03125,h:.041666666666666664},{x:.9375,y:.85,w:.05,h:.06666666666666667},{x:.9375,y:.85,w:.075,h:.1},{x:.9625,y:.85,w:.03125,h:.041666666666666664},{x:.9625,y:.85,w:.05,h:.06666666666666667},{x:.9625,y:.85,w:.075,h:.1},{x:.9875,y:.85,w:.03125,h:.041666666666666664},{x:.9875,y:.85,w:.05,h:.06666666666666667},{x:.9875,y:.85,w:.075,h:.1},{x:.0125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.8833333333333333,w:.075,h:.1},{x:.0375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.8833333333333333,w:.075,h:.1},{x:.0625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.8833333333333333,w:.075,h:.1},{x:.0875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.8833333333333333,w:.075,h:.1},{x:.1125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.8833333333333333,w:.075,h:.1},{x:.1375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.8833333333333333,w:.075,h:.1},{x:.1625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.8833333333333333,w:.075,h:.1},{x:.1875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.8833333333333333,w:.075,h:.1},{x:.2125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.8833333333333333,w:.075,h:.1},{x:.2375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.8833333333333333,w:.075,h:.1},{x:.2625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.8833333333333333,w:.075,h:.1},{x:.2875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.8833333333333333,w:.075,h:.1},{x:.3125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.8833333333333333,w:.075,h:.1},{x:.3375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.8833333333333333,w:.075,h:.1},{x:.3625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.8833333333333333,w:.075,h:.1},{x:.3875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.8833333333333333,w:.075,h:.1},{x:.4125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.8833333333333333,w:.075,h:.1},{x:.4375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.8833333333333333,w:.075,h:.1},{x:.4625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.8833333333333333,w:.075,h:.1},{x:.4875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.8833333333333333,w:.075,h:.1},{x:.5125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.8833333333333333,w:.075,h:.1},{x:.5375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.8833333333333333,w:.075,h:.1},{x:.5625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.8833333333333333,w:.075,h:.1},{x:.5875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.8833333333333333,w:.075,h:.1},{x:.6125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.8833333333333333,w:.075,h:.1},{x:.6375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.8833333333333333,w:.075,h:.1},{x:.6625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.8833333333333333,w:.075,h:.1},{x:.6875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.8833333333333333,w:.075,h:.1},{x:.7125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.8833333333333333,w:.075,h:.1},{x:.7375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.8833333333333333,w:.075,h:.1},{x:.7625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.8833333333333333,w:.075,h:.1},{x:.7875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.8833333333333333,w:.075,h:.1},{x:.8125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.8833333333333333,w:.075,h:.1},{x:.8375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.8833333333333333,w:.075,h:.1},{x:.8625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.8833333333333333,w:.075,h:.1},{x:.8875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.8833333333333333,w:.075,h:.1},{x:.9125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.8833333333333333,w:.075,h:.1},{x:.9375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.8833333333333333,w:.075,h:.1},{x:.9625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.8833333333333333,w:.075,h:.1},{x:.9875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.8833333333333333,w:.075,h:.1},{x:.0125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0125,y:.9166666666666666,w:.075,h:.1},{x:.0375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0375,y:.9166666666666666,w:.075,h:.1},{x:.0625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0625,y:.9166666666666666,w:.075,h:.1},{x:.0875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0875,y:.9166666666666666,w:.075,h:.1},{x:.1125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1125,y:.9166666666666666,w:.075,h:.1},{x:.1375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1375,y:.9166666666666666,w:.075,h:.1},{x:.1625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1625,y:.9166666666666666,w:.075,h:.1},{x:.1875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1875,y:.9166666666666666,w:.075,h:.1},{x:.2125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2125,y:.9166666666666666,w:.075,h:.1},{x:.2375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2375,y:.9166666666666666,w:.075,h:.1},{x:.2625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2625,y:.9166666666666666,w:.075,h:.1},{x:.2875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2875,y:.9166666666666666,w:.075,h:.1},{x:.3125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3125,y:.9166666666666666,w:.075,h:.1},{x:.3375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3375,y:.9166666666666666,w:.075,h:.1},{x:.3625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3625,y:.9166666666666666,w:.075,h:.1},{x:.3875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3875,y:.9166666666666666,w:.075,h:.1},{x:.4125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4125,y:.9166666666666666,w:.075,h:.1},{x:.4375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4375,y:.9166666666666666,w:.075,h:.1},{x:.4625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4625,y:.9166666666666666,w:.075,h:.1},{x:.4875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4875,y:.9166666666666666,w:.075,h:.1},{x:.5125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5125,y:.9166666666666666,w:.075,h:.1},{x:.5375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5375,y:.9166666666666666,w:.075,h:.1},{x:.5625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5625,y:.9166666666666666,w:.075,h:.1},{x:.5875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5875,y:.9166666666666666,w:.075,h:.1},{x:.6125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6125,y:.9166666666666666,w:.075,h:.1},{x:.6375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6375,y:.9166666666666666,w:.075,h:.1},{x:.6625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6625,y:.9166666666666666,w:.075,h:.1},{x:.6875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6875,y:.9166666666666666,w:.075,h:.1},{x:.7125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7125,y:.9166666666666666,w:.075,h:.1},{x:.7375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7375,y:.9166666666666666,w:.075,h:.1},{x:.7625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7625,y:.9166666666666666,w:.075,h:.1},{x:.7875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7875,y:.9166666666666666,w:.075,h:.1},{x:.8125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8125,y:.9166666666666666,w:.075,h:.1},{x:.8375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8375,y:.9166666666666666,w:.075,h:.1},{x:.8625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8625,y:.9166666666666666,w:.075,h:.1},{x:.8875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8875,y:.9166666666666666,w:.075,h:.1},{x:.9125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9125,y:.9166666666666666,w:.075,h:.1},{x:.9375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9375,y:.9166666666666666,w:.075,h:.1},{x:.9625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9625,y:.9166666666666666,w:.075,h:.1},{x:.9875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9875,y:.9166666666666666,w:.075,h:.1},{x:.0125,y:.95,w:.03125,h:.041666666666666664},{x:.0125,y:.95,w:.05,h:.06666666666666667},{x:.0125,y:.95,w:.075,h:.1},{x:.0375,y:.95,w:.03125,h:.041666666666666664},{x:.0375,y:.95,w:.05,h:.06666666666666667},{x:.0375,y:.95,w:.075,h:.1},{x:.0625,y:.95,w:.03125,h:.041666666666666664},{x:.0625,y:.95,w:.05,h:.06666666666666667},{x:.0625,y:.95,w:.075,h:.1},{x:.0875,y:.95,w:.03125,h:.041666666666666664},{x:.0875,y:.95,w:.05,h:.06666666666666667},{x:.0875,y:.95,w:.075,h:.1},{x:.1125,y:.95,w:.03125,h:.041666666666666664},{x:.1125,y:.95,w:.05,h:.06666666666666667},{x:.1125,y:.95,w:.075,h:.1},{x:.1375,y:.95,w:.03125,h:.041666666666666664},{x:.1375,y:.95,w:.05,h:.06666666666666667},{x:.1375,y:.95,w:.075,h:.1},{x:.1625,y:.95,w:.03125,h:.041666666666666664},{x:.1625,y:.95,w:.05,h:.06666666666666667},{x:.1625,y:.95,w:.075,h:.1},{x:.1875,y:.95,w:.03125,h:.041666666666666664},{x:.1875,y:.95,w:.05,h:.06666666666666667},{x:.1875,y:.95,w:.075,h:.1},{x:.2125,y:.95,w:.03125,h:.041666666666666664},{x:.2125,y:.95,w:.05,h:.06666666666666667},{x:.2125,y:.95,w:.075,h:.1},{x:.2375,y:.95,w:.03125,h:.041666666666666664},{x:.2375,y:.95,w:.05,h:.06666666666666667},{x:.2375,y:.95,w:.075,h:.1},{x:.2625,y:.95,w:.03125,h:.041666666666666664},{x:.2625,y:.95,w:.05,h:.06666666666666667},{x:.2625,y:.95,w:.075,h:.1},{x:.2875,y:.95,w:.03125,h:.041666666666666664},{x:.2875,y:.95,w:.05,h:.06666666666666667},{x:.2875,y:.95,w:.075,h:.1},{x:.3125,y:.95,w:.03125,h:.041666666666666664},{x:.3125,y:.95,w:.05,h:.06666666666666667},{x:.3125,y:.95,w:.075,h:.1},{x:.3375,y:.95,w:.03125,h:.041666666666666664},{x:.3375,y:.95,w:.05,h:.06666666666666667},{x:.3375,y:.95,w:.075,h:.1},{x:.3625,y:.95,w:.03125,h:.041666666666666664},{x:.3625,y:.95,w:.05,h:.06666666666666667},{x:.3625,y:.95,w:.075,h:.1},{x:.3875,y:.95,w:.03125,h:.041666666666666664},{x:.3875,y:.95,w:.05,h:.06666666666666667},{x:.3875,y:.95,w:.075,h:.1},{x:.4125,y:.95,w:.03125,h:.041666666666666664},{x:.4125,y:.95,w:.05,h:.06666666666666667},{x:.4125,y:.95,w:.075,h:.1},{x:.4375,y:.95,w:.03125,h:.041666666666666664},{x:.4375,y:.95,w:.05,h:.06666666666666667},{x:.4375,y:.95,w:.075,h:.1},{x:.4625,y:.95,w:.03125,h:.041666666666666664},{x:.4625,y:.95,w:.05,h:.06666666666666667},{x:.4625,y:.95,w:.075,h:.1},{x:.4875,y:.95,w:.03125,h:.041666666666666664},{x:.4875,y:.95,w:.05,h:.06666666666666667},{x:.4875,y:.95,w:.075,h:.1},{x:.5125,y:.95,w:.03125,h:.041666666666666664},{x:.5125,y:.95,w:.05,h:.06666666666666667},{x:.5125,y:.95,w:.075,h:.1},{x:.5375,y:.95,w:.03125,h:.041666666666666664},{x:.5375,y:.95,w:.05,h:.06666666666666667},{x:.5375,y:.95,w:.075,h:.1},{x:.5625,y:.95,w:.03125,h:.041666666666666664},{x:.5625,y:.95,w:.05,h:.06666666666666667},{x:.5625,y:.95,w:.075,h:.1},{x:.5875,y:.95,w:.03125,h:.041666666666666664},{x:.5875,y:.95,w:.05,h:.06666666666666667},{x:.5875,y:.95,w:.075,h:.1},{x:.6125,y:.95,w:.03125,h:.041666666666666664},{x:.6125,y:.95,w:.05,h:.06666666666666667},{x:.6125,y:.95,w:.075,h:.1},{x:.6375,y:.95,w:.03125,h:.041666666666666664},{x:.6375,y:.95,w:.05,h:.06666666666666667},{x:.6375,y:.95,w:.075,h:.1},{x:.6625,y:.95,w:.03125,h:.041666666666666664},{x:.6625,y:.95,w:.05,h:.06666666666666667},{x:.6625,y:.95,w:.075,h:.1},{x:.6875,y:.95,w:.03125,h:.041666666666666664},{x:.6875,y:.95,w:.05,h:.06666666666666667},{x:.6875,y:.95,w:.075,h:.1},{x:.7125,y:.95,w:.03125,h:.041666666666666664},{x:.7125,y:.95,w:.05,h:.06666666666666667},{x:.7125,y:.95,w:.075,h:.1},{x:.7375,y:.95,w:.03125,h:.041666666666666664},{x:.7375,y:.95,w:.05,h:.06666666666666667},{x:.7375,y:.95,w:.075,h:.1},{x:.7625,y:.95,w:.03125,h:.041666666666666664},{x:.7625,y:.95,w:.05,h:.06666666666666667},{x:.7625,y:.95,w:.075,h:.1},{x:.7875,y:.95,w:.03125,h:.041666666666666664},{x:.7875,y:.95,w:.05,h:.06666666666666667},{x:.7875,y:.95,w:.075,h:.1},{x:.8125,y:.95,w:.03125,h:.041666666666666664},{x:.8125,y:.95,w:.05,h:.06666666666666667},{x:.8125,y:.95,w:.075,h:.1},{x:.8375,y:.95,w:.03125,h:.041666666666666664},{x:.8375,y:.95,w:.05,h:.06666666666666667},{x:.8375,y:.95,w:.075,h:.1},{x:.8625,y:.95,w:.03125,h:.041666666666666664},{x:.8625,y:.95,w:.05,h:.06666666666666667},{x:.8625,y:.95,w:.075,h:.1},{x:.8875,y:.95,w:.03125,h:.041666666666666664},{x:.8875,y:.95,w:.05,h:.06666666666666667},{x:.8875,y:.95,w:.075,h:.1},{x:.9125,y:.95,w:.03125,h:.041666666666666664},{x:.9125,y:.95,w:.05,h:.06666666666666667},{x:.9125,y:.95,w:.075,h:.1},{x:.9375,y:.95,w:.03125,h:.041666666666666664},{x:.9375,y:.95,w:.05,h:.06666666666666667},{x:.9375,y:.95,w:.075,h:.1},{x:.9625,y:.95,w:.03125,h:.041666666666666664},{x:.9625,y:.95,w:.05,h:.06666666666666667},{x:.9625,y:.95,w:.075,h:.1},{x:.9875,y:.95,w:.03125,h:.041666666666666664},{x:.9875,y:.95,w:.05,h:.06666666666666667},{x:.9875,y:.95,w:.075,h:.1},{x:.0125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.9833333333333333,w:.075,h:.1},{x:.0375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.9833333333333333,w:.075,h:.1},{x:.0625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.9833333333333333,w:.075,h:.1},{x:.0875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.9833333333333333,w:.075,h:.1},{x:.1125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.9833333333333333,w:.075,h:.1},{x:.1375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.9833333333333333,w:.075,h:.1},{x:.1625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.9833333333333333,w:.075,h:.1},{x:.1875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.9833333333333333,w:.075,h:.1},{x:.2125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.9833333333333333,w:.075,h:.1},{x:.2375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.9833333333333333,w:.075,h:.1},{x:.2625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.9833333333333333,w:.075,h:.1},{x:.2875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.9833333333333333,w:.075,h:.1},{x:.3125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.9833333333333333,w:.075,h:.1},{x:.3375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.9833333333333333,w:.075,h:.1},{x:.3625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.9833333333333333,w:.075,h:.1},{x:.3875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.9833333333333333,w:.075,h:.1},{x:.4125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.9833333333333333,w:.075,h:.1},{x:.4375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.9833333333333333,w:.075,h:.1},{x:.4625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.9833333333333333,w:.075,h:.1},{x:.4875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.9833333333333333,w:.075,h:.1},{x:.5125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.9833333333333333,w:.075,h:.1},{x:.5375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.9833333333333333,w:.075,h:.1},{x:.5625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.9833333333333333,w:.075,h:.1},{x:.5875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.9833333333333333,w:.075,h:.1},{x:.6125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.9833333333333333,w:.075,h:.1},{x:.6375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.9833333333333333,w:.075,h:.1},{x:.6625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.9833333333333333,w:.075,h:.1},{x:.6875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.9833333333333333,w:.075,h:.1},{x:.7125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.9833333333333333,w:.075,h:.1},{x:.7375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.9833333333333333,w:.075,h:.1},{x:.7625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.9833333333333333,w:.075,h:.1},{x:.7875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.9833333333333333,w:.075,h:.1},{x:.8125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.9833333333333333,w:.075,h:.1},{x:.8375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.9833333333333333,w:.075,h:.1},{x:.8625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.9833333333333333,w:.075,h:.1},{x:.8875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.9833333333333333,w:.075,h:.1},{x:.9125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.9833333333333333,w:.075,h:.1},{x:.9375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.9833333333333333,w:.075,h:.1},{x:.9625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.9833333333333333,w:.075,h:.1},{x:.9875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.9833333333333333,w:.075,h:.1},{x:.025,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.025,y:.03333333333333333,w:.15,h:.2},{x:.075,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.075,y:.03333333333333333,w:.15,h:.2},{x:.125,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.125,y:.03333333333333333,w:.15,h:.2},{x:.175,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.175,y:.03333333333333333,w:.15,h:.2},{x:.225,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.225,y:.03333333333333333,w:.15,h:.2},{x:.275,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.275,y:.03333333333333333,w:.15,h:.2},{x:.325,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.325,y:.03333333333333333,w:.15,h:.2},{x:.375,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.375,y:.03333333333333333,w:.15,h:.2},{x:.425,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.425,y:.03333333333333333,w:.15,h:.2},{x:.475,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.475,y:.03333333333333333,w:.15,h:.2},{x:.525,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.525,y:.03333333333333333,w:.15,h:.2},{x:.575,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.575,y:.03333333333333333,w:.15,h:.2},{x:.625,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.625,y:.03333333333333333,w:.15,h:.2},{x:.675,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.675,y:.03333333333333333,w:.15,h:.2},{x:.725,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.725,y:.03333333333333333,w:.15,h:.2},{x:.775,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.775,y:.03333333333333333,w:.15,h:.2},{x:.825,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.825,y:.03333333333333333,w:.15,h:.2},{x:.875,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.875,y:.03333333333333333,w:.15,h:.2},{x:.925,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.925,y:.03333333333333333,w:.15,h:.2},{x:.975,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.975,y:.03333333333333333,w:.15,h:.2},{x:.025,y:.1,w:.1,h:.13333333333333333},{x:.025,y:.1,w:.15,h:.2},{x:.075,y:.1,w:.1,h:.13333333333333333},{x:.075,y:.1,w:.15,h:.2},{x:.125,y:.1,w:.1,h:.13333333333333333},{x:.125,y:.1,w:.15,h:.2},{x:.175,y:.1,w:.1,h:.13333333333333333},{x:.175,y:.1,w:.15,h:.2},{x:.225,y:.1,w:.1,h:.13333333333333333},{x:.225,y:.1,w:.15,h:.2},{x:.275,y:.1,w:.1,h:.13333333333333333},{x:.275,y:.1,w:.15,h:.2},{x:.325,y:.1,w:.1,h:.13333333333333333},{x:.325,y:.1,w:.15,h:.2},{x:.375,y:.1,w:.1,h:.13333333333333333},{x:.375,y:.1,w:.15,h:.2},{x:.425,y:.1,w:.1,h:.13333333333333333},{x:.425,y:.1,w:.15,h:.2},{x:.475,y:.1,w:.1,h:.13333333333333333},{x:.475,y:.1,w:.15,h:.2},{x:.525,y:.1,w:.1,h:.13333333333333333},{x:.525,y:.1,w:.15,h:.2},{x:.575,y:.1,w:.1,h:.13333333333333333},{x:.575,y:.1,w:.15,h:.2},{x:.625,y:.1,w:.1,h:.13333333333333333},{x:.625,y:.1,w:.15,h:.2},{x:.675,y:.1,w:.1,h:.13333333333333333},{x:.675,y:.1,w:.15,h:.2},{x:.725,y:.1,w:.1,h:.13333333333333333},{x:.725,y:.1,w:.15,h:.2},{x:.775,y:.1,w:.1,h:.13333333333333333},{x:.775,y:.1,w:.15,h:.2},{x:.825,y:.1,w:.1,h:.13333333333333333},{x:.825,y:.1,w:.15,h:.2},{x:.875,y:.1,w:.1,h:.13333333333333333},{x:.875,y:.1,w:.15,h:.2},{x:.925,y:.1,w:.1,h:.13333333333333333},{x:.925,y:.1,w:.15,h:.2},{x:.975,y:.1,w:.1,h:.13333333333333333},{x:.975,y:.1,w:.15,h:.2},{x:.025,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.025,y:.16666666666666666,w:.15,h:.2},{x:.075,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.075,y:.16666666666666666,w:.15,h:.2},{x:.125,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.125,y:.16666666666666666,w:.15,h:.2},{x:.175,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.175,y:.16666666666666666,w:.15,h:.2},{x:.225,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.225,y:.16666666666666666,w:.15,h:.2},{x:.275,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.275,y:.16666666666666666,w:.15,h:.2},{x:.325,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.325,y:.16666666666666666,w:.15,h:.2},{x:.375,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.375,y:.16666666666666666,w:.15,h:.2},{x:.425,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.425,y:.16666666666666666,w:.15,h:.2},{x:.475,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.475,y:.16666666666666666,w:.15,h:.2},{x:.525,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.525,y:.16666666666666666,w:.15,h:.2},{x:.575,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.575,y:.16666666666666666,w:.15,h:.2},{x:.625,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.625,y:.16666666666666666,w:.15,h:.2},{x:.675,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.675,y:.16666666666666666,w:.15,h:.2},{x:.725,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.725,y:.16666666666666666,w:.15,h:.2},{x:.775,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.775,y:.16666666666666666,w:.15,h:.2},{x:.825,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.825,y:.16666666666666666,w:.15,h:.2},{x:.875,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.875,y:.16666666666666666,w:.15,h:.2},{x:.925,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.925,y:.16666666666666666,w:.15,h:.2},{x:.975,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.975,y:.16666666666666666,w:.15,h:.2},{x:.025,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.025,y:.23333333333333334,w:.15,h:.2},{x:.075,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.075,y:.23333333333333334,w:.15,h:.2},{x:.125,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.125,y:.23333333333333334,w:.15,h:.2},{x:.175,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.175,y:.23333333333333334,w:.15,h:.2},{x:.225,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.225,y:.23333333333333334,w:.15,h:.2},{x:.275,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.275,y:.23333333333333334,w:.15,h:.2},{x:.325,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.325,y:.23333333333333334,w:.15,h:.2},{x:.375,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.375,y:.23333333333333334,w:.15,h:.2},{x:.425,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.425,y:.23333333333333334,w:.15,h:.2},{x:.475,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.475,y:.23333333333333334,w:.15,h:.2},{x:.525,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.525,y:.23333333333333334,w:.15,h:.2},{x:.575,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.575,y:.23333333333333334,w:.15,h:.2},{x:.625,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.625,y:.23333333333333334,w:.15,h:.2},{x:.675,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.675,y:.23333333333333334,w:.15,h:.2},{x:.725,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.725,y:.23333333333333334,w:.15,h:.2},{x:.775,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.775,y:.23333333333333334,w:.15,h:.2},{x:.825,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.825,y:.23333333333333334,w:.15,h:.2},{x:.875,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.875,y:.23333333333333334,w:.15,h:.2},{x:.925,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.925,y:.23333333333333334,w:.15,h:.2},{x:.975,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.975,y:.23333333333333334,w:.15,h:.2},{x:.025,y:.3,w:.1,h:.13333333333333333},{x:.025,y:.3,w:.15,h:.2},{x:.075,y:.3,w:.1,h:.13333333333333333},{x:.075,y:.3,w:.15,h:.2},{x:.125,y:.3,w:.1,h:.13333333333333333},{x:.125,y:.3,w:.15,h:.2},{x:.175,y:.3,w:.1,h:.13333333333333333},{x:.175,y:.3,w:.15,h:.2},{x:.225,y:.3,w:.1,h:.13333333333333333},{x:.225,y:.3,w:.15,h:.2},{x:.275,y:.3,w:.1,h:.13333333333333333},{x:.275,y:.3,w:.15,h:.2},{x:.325,y:.3,w:.1,h:.13333333333333333},{x:.325,y:.3,w:.15,h:.2},{x:.375,y:.3,w:.1,h:.13333333333333333},{x:.375,y:.3,w:.15,h:.2},{x:.425,y:.3,w:.1,h:.13333333333333333},{x:.425,y:.3,w:.15,h:.2},{x:.475,y:.3,w:.1,h:.13333333333333333},{x:.475,y:.3,w:.15,h:.2},{x:.525,y:.3,w:.1,h:.13333333333333333},{x:.525,y:.3,w:.15,h:.2},{x:.575,y:.3,w:.1,h:.13333333333333333},{x:.575,y:.3,w:.15,h:.2},{x:.625,y:.3,w:.1,h:.13333333333333333},{x:.625,y:.3,w:.15,h:.2},{x:.675,y:.3,w:.1,h:.13333333333333333},{x:.675,y:.3,w:.15,h:.2},{x:.725,y:.3,w:.1,h:.13333333333333333},{x:.725,y:.3,w:.15,h:.2},{x:.775,y:.3,w:.1,h:.13333333333333333},{x:.775,y:.3,w:.15,h:.2},{x:.825,y:.3,w:.1,h:.13333333333333333},{x:.825,y:.3,w:.15,h:.2},{x:.875,y:.3,w:.1,h:.13333333333333333},{x:.875,y:.3,w:.15,h:.2},{x:.925,y:.3,w:.1,h:.13333333333333333},{x:.925,y:.3,w:.15,h:.2},{x:.975,y:.3,w:.1,h:.13333333333333333},{x:.975,y:.3,w:.15,h:.2},{x:.025,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.025,y:.36666666666666664,w:.15,h:.2},{x:.075,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.075,y:.36666666666666664,w:.15,h:.2},{x:.125,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.125,y:.36666666666666664,w:.15,h:.2},{x:.175,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.175,y:.36666666666666664,w:.15,h:.2},{x:.225,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.225,y:.36666666666666664,w:.15,h:.2},{x:.275,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.275,y:.36666666666666664,w:.15,h:.2},{x:.325,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.325,y:.36666666666666664,w:.15,h:.2},{x:.375,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.375,y:.36666666666666664,w:.15,h:.2},{x:.425,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.425,y:.36666666666666664,w:.15,h:.2},{x:.475,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.475,y:.36666666666666664,w:.15,h:.2},{x:.525,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.525,y:.36666666666666664,w:.15,h:.2},{x:.575,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.575,y:.36666666666666664,w:.15,h:.2},{x:.625,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.625,y:.36666666666666664,w:.15,h:.2},{x:.675,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.675,y:.36666666666666664,w:.15,h:.2},{x:.725,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.725,y:.36666666666666664,w:.15,h:.2},{x:.775,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.775,y:.36666666666666664,w:.15,h:.2},{x:.825,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.825,y:.36666666666666664,w:.15,h:.2},{x:.875,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.875,y:.36666666666666664,w:.15,h:.2},{x:.925,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.925,y:.36666666666666664,w:.15,h:.2},{x:.975,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.975,y:.36666666666666664,w:.15,h:.2},{x:.025,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.025,y:.43333333333333335,w:.15,h:.2},{x:.075,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.075,y:.43333333333333335,w:.15,h:.2},{x:.125,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.125,y:.43333333333333335,w:.15,h:.2},{x:.175,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.175,y:.43333333333333335,w:.15,h:.2},{x:.225,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.225,y:.43333333333333335,w:.15,h:.2},{x:.275,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.275,y:.43333333333333335,w:.15,h:.2},{x:.325,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.325,y:.43333333333333335,w:.15,h:.2},{x:.375,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.375,y:.43333333333333335,w:.15,h:.2},{x:.425,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.425,y:.43333333333333335,w:.15,h:.2},{x:.475,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.475,y:.43333333333333335,w:.15,h:.2},{x:.525,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.525,y:.43333333333333335,w:.15,h:.2},{x:.575,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.575,y:.43333333333333335,w:.15,h:.2},{x:.625,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.625,y:.43333333333333335,w:.15,h:.2},{x:.675,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.675,y:.43333333333333335,w:.15,h:.2},{x:.725,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.725,y:.43333333333333335,w:.15,h:.2},{x:.775,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.775,y:.43333333333333335,w:.15,h:.2},{x:.825,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.825,y:.43333333333333335,w:.15,h:.2},{x:.875,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.875,y:.43333333333333335,w:.15,h:.2},{x:.925,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.925,y:.43333333333333335,w:.15,h:.2},{x:.975,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.975,y:.43333333333333335,w:.15,h:.2},{x:.025,y:.5,w:.1,h:.13333333333333333},{x:.025,y:.5,w:.15,h:.2},{x:.075,y:.5,w:.1,h:.13333333333333333},{x:.075,y:.5,w:.15,h:.2},{x:.125,y:.5,w:.1,h:.13333333333333333},{x:.125,y:.5,w:.15,h:.2},{x:.175,y:.5,w:.1,h:.13333333333333333},{x:.175,y:.5,w:.15,h:.2},{x:.225,y:.5,w:.1,h:.13333333333333333},{x:.225,y:.5,w:.15,h:.2},{x:.275,y:.5,w:.1,h:.13333333333333333},{x:.275,y:.5,w:.15,h:.2},{x:.325,y:.5,w:.1,h:.13333333333333333},{x:.325,y:.5,w:.15,h:.2},{x:.375,y:.5,w:.1,h:.13333333333333333},{x:.375,y:.5,w:.15,h:.2},{x:.425,y:.5,w:.1,h:.13333333333333333},{x:.425,y:.5,w:.15,h:.2},{x:.475,y:.5,w:.1,h:.13333333333333333},{x:.475,y:.5,w:.15,h:.2},{x:.525,y:.5,w:.1,h:.13333333333333333},{x:.525,y:.5,w:.15,h:.2},{x:.575,y:.5,w:.1,h:.13333333333333333},{x:.575,y:.5,w:.15,h:.2},{x:.625,y:.5,w:.1,h:.13333333333333333},{x:.625,y:.5,w:.15,h:.2},{x:.675,y:.5,w:.1,h:.13333333333333333},{x:.675,y:.5,w:.15,h:.2},{x:.725,y:.5,w:.1,h:.13333333333333333},{x:.725,y:.5,w:.15,h:.2},{x:.775,y:.5,w:.1,h:.13333333333333333},{x:.775,y:.5,w:.15,h:.2},{x:.825,y:.5,w:.1,h:.13333333333333333},{x:.825,y:.5,w:.15,h:.2},{x:.875,y:.5,w:.1,h:.13333333333333333},{x:.875,y:.5,w:.15,h:.2},{x:.925,y:.5,w:.1,h:.13333333333333333},{x:.925,y:.5,w:.15,h:.2},{x:.975,y:.5,w:.1,h:.13333333333333333},{x:.975,y:.5,w:.15,h:.2},{x:.025,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.025,y:.5666666666666667,w:.15,h:.2},{x:.075,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.075,y:.5666666666666667,w:.15,h:.2},{x:.125,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.125,y:.5666666666666667,w:.15,h:.2},{x:.175,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.175,y:.5666666666666667,w:.15,h:.2},{x:.225,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.225,y:.5666666666666667,w:.15,h:.2},{x:.275,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.275,y:.5666666666666667,w:.15,h:.2},{x:.325,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.325,y:.5666666666666667,w:.15,h:.2},{x:.375,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.375,y:.5666666666666667,w:.15,h:.2},{x:.425,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.425,y:.5666666666666667,w:.15,h:.2},{x:.475,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.475,y:.5666666666666667,w:.15,h:.2},{x:.525,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.525,y:.5666666666666667,w:.15,h:.2},{x:.575,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.575,y:.5666666666666667,w:.15,h:.2},{x:.625,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.625,y:.5666666666666667,w:.15,h:.2},{x:.675,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.675,y:.5666666666666667,w:.15,h:.2},{x:.725,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.725,y:.5666666666666667,w:.15,h:.2},{x:.775,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.775,y:.5666666666666667,w:.15,h:.2},{x:.825,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.825,y:.5666666666666667,w:.15,h:.2},{x:.875,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.875,y:.5666666666666667,w:.15,h:.2},{x:.925,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.925,y:.5666666666666667,w:.15,h:.2},{x:.975,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.975,y:.5666666666666667,w:.15,h:.2},{x:.025,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.025,y:.6333333333333333,w:.15,h:.2},{x:.075,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.075,y:.6333333333333333,w:.15,h:.2},{x:.125,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.125,y:.6333333333333333,w:.15,h:.2},{x:.175,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.175,y:.6333333333333333,w:.15,h:.2},{x:.225,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.225,y:.6333333333333333,w:.15,h:.2},{x:.275,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.275,y:.6333333333333333,w:.15,h:.2},{x:.325,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.325,y:.6333333333333333,w:.15,h:.2},{x:.375,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.375,y:.6333333333333333,w:.15,h:.2},{x:.425,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.425,y:.6333333333333333,w:.15,h:.2},{x:.475,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.475,y:.6333333333333333,w:.15,h:.2},{x:.525,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.525,y:.6333333333333333,w:.15,h:.2},{x:.575,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.575,y:.6333333333333333,w:.15,h:.2},{x:.625,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.625,y:.6333333333333333,w:.15,h:.2},{x:.675,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.675,y:.6333333333333333,w:.15,h:.2},{x:.725,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.725,y:.6333333333333333,w:.15,h:.2},{x:.775,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.775,y:.6333333333333333,w:.15,h:.2},{x:.825,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.825,y:.6333333333333333,w:.15,h:.2},{x:.875,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.875,y:.6333333333333333,w:.15,h:.2},{x:.925,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.925,y:.6333333333333333,w:.15,h:.2},{x:.975,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.975,y:.6333333333333333,w:.15,h:.2},{x:.025,y:.7,w:.1,h:.13333333333333333},{x:.025,y:.7,w:.15,h:.2},{x:.075,y:.7,w:.1,h:.13333333333333333},{x:.075,y:.7,w:.15,h:.2},{x:.125,y:.7,w:.1,h:.13333333333333333},{x:.125,y:.7,w:.15,h:.2},{x:.175,y:.7,w:.1,h:.13333333333333333},{x:.175,y:.7,w:.15,h:.2},{x:.225,y:.7,w:.1,h:.13333333333333333},{x:.225,y:.7,w:.15,h:.2},{x:.275,y:.7,w:.1,h:.13333333333333333},{x:.275,y:.7,w:.15,h:.2},{x:.325,y:.7,w:.1,h:.13333333333333333},{x:.325,y:.7,w:.15,h:.2},{x:.375,y:.7,w:.1,h:.13333333333333333},{x:.375,y:.7,w:.15,h:.2},{x:.425,y:.7,w:.1,h:.13333333333333333},{x:.425,y:.7,w:.15,h:.2},{x:.475,y:.7,w:.1,h:.13333333333333333},{x:.475,y:.7,w:.15,h:.2},{x:.525,y:.7,w:.1,h:.13333333333333333},{x:.525,y:.7,w:.15,h:.2},{x:.575,y:.7,w:.1,h:.13333333333333333},{x:.575,y:.7,w:.15,h:.2},{x:.625,y:.7,w:.1,h:.13333333333333333},{x:.625,y:.7,w:.15,h:.2},{x:.675,y:.7,w:.1,h:.13333333333333333},{x:.675,y:.7,w:.15,h:.2},{x:.725,y:.7,w:.1,h:.13333333333333333},{x:.725,y:.7,w:.15,h:.2},{x:.775,y:.7,w:.1,h:.13333333333333333},{x:.775,y:.7,w:.15,h:.2},{x:.825,y:.7,w:.1,h:.13333333333333333},{x:.825,y:.7,w:.15,h:.2},{x:.875,y:.7,w:.1,h:.13333333333333333},{x:.875,y:.7,w:.15,h:.2},{x:.925,y:.7,w:.1,h:.13333333333333333},{x:.925,y:.7,w:.15,h:.2},{x:.975,y:.7,w:.1,h:.13333333333333333},{x:.975,y:.7,w:.15,h:.2},{x:.025,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.025,y:.7666666666666667,w:.15,h:.2},{x:.075,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.075,y:.7666666666666667,w:.15,h:.2},{x:.125,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.125,y:.7666666666666667,w:.15,h:.2},{x:.175,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.175,y:.7666666666666667,w:.15,h:.2},{x:.225,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.225,y:.7666666666666667,w:.15,h:.2},{x:.275,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.275,y:.7666666666666667,w:.15,h:.2},{x:.325,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.325,y:.7666666666666667,w:.15,h:.2},{x:.375,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.375,y:.7666666666666667,w:.15,h:.2},{x:.425,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.425,y:.7666666666666667,w:.15,h:.2},{x:.475,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.475,y:.7666666666666667,w:.15,h:.2},{x:.525,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.525,y:.7666666666666667,w:.15,h:.2},{x:.575,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.575,y:.7666666666666667,w:.15,h:.2},{x:.625,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.625,y:.7666666666666667,w:.15,h:.2},{x:.675,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.675,y:.7666666666666667,w:.15,h:.2},{x:.725,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.725,y:.7666666666666667,w:.15,h:.2},{x:.775,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.775,y:.7666666666666667,w:.15,h:.2},{x:.825,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.825,y:.7666666666666667,w:.15,h:.2},{x:.875,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.875,y:.7666666666666667,w:.15,h:.2},{x:.925,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.925,y:.7666666666666667,w:.15,h:.2},{x:.975,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.975,y:.7666666666666667,w:.15,h:.2},{x:.025,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.025,y:.8333333333333334,w:.15,h:.2},{x:.075,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.075,y:.8333333333333334,w:.15,h:.2},{x:.125,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.125,y:.8333333333333334,w:.15,h:.2},{x:.175,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.175,y:.8333333333333334,w:.15,h:.2},{x:.225,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.225,y:.8333333333333334,w:.15,h:.2},{x:.275,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.275,y:.8333333333333334,w:.15,h:.2},{x:.325,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.325,y:.8333333333333334,w:.15,h:.2},{x:.375,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.375,y:.8333333333333334,w:.15,h:.2},{x:.425,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.425,y:.8333333333333334,w:.15,h:.2},{x:.475,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.475,y:.8333333333333334,w:.15,h:.2},{x:.525,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.525,y:.8333333333333334,w:.15,h:.2},{x:.575,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.575,y:.8333333333333334,w:.15,h:.2},{x:.625,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.625,y:.8333333333333334,w:.15,h:.2},{x:.675,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.675,y:.8333333333333334,w:.15,h:.2},{x:.725,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.725,y:.8333333333333334,w:.15,h:.2},{x:.775,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.775,y:.8333333333333334,w:.15,h:.2},{x:.825,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.825,y:.8333333333333334,w:.15,h:.2},{x:.875,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.875,y:.8333333333333334,w:.15,h:.2},{x:.925,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.925,y:.8333333333333334,w:.15,h:.2},{x:.975,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.975,y:.8333333333333334,w:.15,h:.2},{x:.025,y:.9,w:.1,h:.13333333333333333},{x:.025,y:.9,w:.15,h:.2},{x:.075,y:.9,w:.1,h:.13333333333333333},{x:.075,y:.9,w:.15,h:.2},{x:.125,y:.9,w:.1,h:.13333333333333333},{x:.125,y:.9,w:.15,h:.2},{x:.175,y:.9,w:.1,h:.13333333333333333},{x:.175,y:.9,w:.15,h:.2},{x:.225,y:.9,w:.1,h:.13333333333333333},{x:.225,y:.9,w:.15,h:.2},{x:.275,y:.9,w:.1,h:.13333333333333333},{x:.275,y:.9,w:.15,h:.2},{x:.325,y:.9,w:.1,h:.13333333333333333},{x:.325,y:.9,w:.15,h:.2},{x:.375,y:.9,w:.1,h:.13333333333333333},{x:.375,y:.9,w:.15,h:.2},{x:.425,y:.9,w:.1,h:.13333333333333333},{x:.425,y:.9,w:.15,h:.2},{x:.475,y:.9,w:.1,h:.13333333333333333},{x:.475,y:.9,w:.15,h:.2},{x:.525,y:.9,w:.1,h:.13333333333333333},{x:.525,y:.9,w:.15,h:.2},{x:.575,y:.9,w:.1,h:.13333333333333333},{x:.575,y:.9,w:.15,h:.2},{x:.625,y:.9,w:.1,h:.13333333333333333},{x:.625,y:.9,w:.15,h:.2},{x:.675,y:.9,w:.1,h:.13333333333333333},{x:.675,y:.9,w:.15,h:.2},{x:.725,y:.9,w:.1,h:.13333333333333333},{x:.725,y:.9,w:.15,h:.2},{x:.775,y:.9,w:.1,h:.13333333333333333},{x:.775,y:.9,w:.15,h:.2},{x:.825,y:.9,w:.1,h:.13333333333333333},{x:.825,y:.9,w:.15,h:.2},{x:.875,y:.9,w:.1,h:.13333333333333333},{x:.875,y:.9,w:.15,h:.2},{x:.925,y:.9,w:.1,h:.13333333333333333},{x:.925,y:.9,w:.15,h:.2},{x:.975,y:.9,w:.1,h:.13333333333333333},{x:.975,y:.9,w:.15,h:.2},{x:.025,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.025,y:.9666666666666667,w:.15,h:.2},{x:.075,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.075,y:.9666666666666667,w:.15,h:.2},{x:.125,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.125,y:.9666666666666667,w:.15,h:.2},{x:.175,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.175,y:.9666666666666667,w:.15,h:.2},{x:.225,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.225,y:.9666666666666667,w:.15,h:.2},{x:.275,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.275,y:.9666666666666667,w:.15,h:.2},{x:.325,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.325,y:.9666666666666667,w:.15,h:.2},{x:.375,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.375,y:.9666666666666667,w:.15,h:.2},{x:.425,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.425,y:.9666666666666667,w:.15,h:.2},{x:.475,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.475,y:.9666666666666667,w:.15,h:.2},{x:.525,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.525,y:.9666666666666667,w:.15,h:.2},{x:.575,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.575,y:.9666666666666667,w:.15,h:.2},{x:.625,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.625,y:.9666666666666667,w:.15,h:.2},{x:.675,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.675,y:.9666666666666667,w:.15,h:.2},{x:.725,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.725,y:.9666666666666667,w:.15,h:.2},{x:.775,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.775,y:.9666666666666667,w:.15,h:.2},{x:.825,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.825,y:.9666666666666667,w:.15,h:.2},{x:.875,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.875,y:.9666666666666667,w:.15,h:.2},{x:.925,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.925,y:.9666666666666667,w:.15,h:.2},{x:.975,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.975,y:.9666666666666667,w:.15,h:.2},{x:.05,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.05,y:.06666666666666667,w:.3,h:.4},{x:.15,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.15,y:.06666666666666667,w:.3,h:.4},{x:.25,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.25,y:.06666666666666667,w:.3,h:.4},{x:.35,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.35,y:.06666666666666667,w:.3,h:.4},{x:.45,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.45,y:.06666666666666667,w:.3,h:.4},{x:.55,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.55,y:.06666666666666667,w:.3,h:.4},{x:.65,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.65,y:.06666666666666667,w:.3,h:.4},{x:.75,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.75,y:.06666666666666667,w:.3,h:.4},{x:.85,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.85,y:.06666666666666667,w:.3,h:.4},{x:.95,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.95,y:.06666666666666667,w:.3,h:.4},{x:.05,y:.2,w:.2,h:.26666666666666666},{x:.05,y:.2,w:.3,h:.4},{x:.15,y:.2,w:.2,h:.26666666666666666},{x:.15,y:.2,w:.3,h:.4},{x:.25,y:.2,w:.2,h:.26666666666666666},{x:.25,y:.2,w:.3,h:.4},{x:.35,y:.2,w:.2,h:.26666666666666666},{x:.35,y:.2,w:.3,h:.4},{x:.45,y:.2,w:.2,h:.26666666666666666},{x:.45,y:.2,w:.3,h:.4},{x:.55,y:.2,w:.2,h:.26666666666666666},{x:.55,y:.2,w:.3,h:.4},{x:.65,y:.2,w:.2,h:.26666666666666666},{x:.65,y:.2,w:.3,h:.4},{x:.75,y:.2,w:.2,h:.26666666666666666},{x:.75,y:.2,w:.3,h:.4},{x:.85,y:.2,w:.2,h:.26666666666666666},{x:.85,y:.2,w:.3,h:.4},{x:.95,y:.2,w:.2,h:.26666666666666666},{x:.95,y:.2,w:.3,h:.4},{x:.05,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.05,y:.3333333333333333,w:.3,h:.4},{x:.15,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.15,y:.3333333333333333,w:.3,h:.4},{x:.25,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.25,y:.3333333333333333,w:.3,h:.4},{x:.35,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.35,y:.3333333333333333,w:.3,h:.4},{x:.45,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.45,y:.3333333333333333,w:.3,h:.4},{x:.55,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.55,y:.3333333333333333,w:.3,h:.4},{x:.65,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.65,y:.3333333333333333,w:.3,h:.4},{x:.75,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.75,y:.3333333333333333,w:.3,h:.4},{x:.85,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.85,y:.3333333333333333,w:.3,h:.4},{x:.95,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.95,y:.3333333333333333,w:.3,h:.4},{x:.05,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.05,y:.4666666666666667,w:.3,h:.4},{x:.15,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.15,y:.4666666666666667,w:.3,h:.4},{x:.25,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.25,y:.4666666666666667,w:.3,h:.4},{x:.35,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.35,y:.4666666666666667,w:.3,h:.4},{x:.45,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.45,y:.4666666666666667,w:.3,h:.4},{x:.55,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.55,y:.4666666666666667,w:.3,h:.4},{x:.65,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.65,y:.4666666666666667,w:.3,h:.4},{x:.75,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.75,y:.4666666666666667,w:.3,h:.4},{x:.85,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.85,y:.4666666666666667,w:.3,h:.4},{x:.95,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.95,y:.4666666666666667,w:.3,h:.4},{x:.05,y:.6,w:.2,h:.26666666666666666},{x:.05,y:.6,w:.3,h:.4},{x:.15,y:.6,w:.2,h:.26666666666666666},{x:.15,y:.6,w:.3,h:.4},{x:.25,y:.6,w:.2,h:.26666666666666666},{x:.25,y:.6,w:.3,h:.4},{x:.35,y:.6,w:.2,h:.26666666666666666},{x:.35,y:.6,w:.3,h:.4},{x:.45,y:.6,w:.2,h:.26666666666666666},{x:.45,y:.6,w:.3,h:.4},{x:.55,y:.6,w:.2,h:.26666666666666666},{x:.55,y:.6,w:.3,h:.4},{x:.65,y:.6,w:.2,h:.26666666666666666},{x:.65,y:.6,w:.3,h:.4},{x:.75,y:.6,w:.2,h:.26666666666666666},{x:.75,y:.6,w:.3,h:.4},{x:.85,y:.6,w:.2,h:.26666666666666666},{x:.85,y:.6,w:.3,h:.4},{x:.95,y:.6,w:.2,h:.26666666666666666},{x:.95,y:.6,w:.3,h:.4},{x:.05,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.05,y:.7333333333333333,w:.3,h:.4},{x:.15,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.15,y:.7333333333333333,w:.3,h:.4},{x:.25,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.25,y:.7333333333333333,w:.3,h:.4},{x:.35,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.35,y:.7333333333333333,w:.3,h:.4},{x:.45,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.45,y:.7333333333333333,w:.3,h:.4},{x:.55,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.55,y:.7333333333333333,w:.3,h:.4},{x:.65,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.65,y:.7333333333333333,w:.3,h:.4},{x:.75,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.75,y:.7333333333333333,w:.3,h:.4},{x:.85,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.85,y:.7333333333333333,w:.3,h:.4},{x:.95,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.95,y:.7333333333333333,w:.3,h:.4},{x:.05,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.05,y:.8666666666666667,w:.3,h:.4},{x:.15,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.15,y:.8666666666666667,w:.3,h:.4},{x:.25,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.25,y:.8666666666666667,w:.3,h:.4},{x:.35,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.35,y:.8666666666666667,w:.3,h:.4},{x:.45,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.45,y:.8666666666666667,w:.3,h:.4},{x:.55,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.55,y:.8666666666666667,w:.3,h:.4},{x:.65,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.65,y:.8666666666666667,w:.3,h:.4},{x:.75,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.75,y:.8666666666666667,w:.3,h:.4},{x:.85,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.85,y:.8666666666666667,w:.3,h:.4},{x:.95,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.95,y:.8666666666666667,w:.3,h:.4},{x:.05,y:1,w:.2,h:.26666666666666666},{x:.05,y:1,w:.3,h:.4},{x:.15,y:1,w:.2,h:.26666666666666666},{x:.15,y:1,w:.3,h:.4},{x:.25,y:1,w:.2,h:.26666666666666666},{x:.25,y:1,w:.3,h:.4},{x:.35,y:1,w:.2,h:.26666666666666666},{x:.35,y:1,w:.3,h:.4},{x:.45,y:1,w:.2,h:.26666666666666666},{x:.45,y:1,w:.3,h:.4},{x:.55,y:1,w:.2,h:.26666666666666666},{x:.55,y:1,w:.3,h:.4},{x:.65,y:1,w:.2,h:.26666666666666666},{x:.65,y:1,w:.3,h:.4},{x:.75,y:1,w:.2,h:.26666666666666666},{x:.75,y:1,w:.3,h:.4},{x:.85,y:1,w:.2,h:.26666666666666666},{x:.85,y:1,w:.3,h:.4},{x:.95,y:1,w:.2,h:.26666666666666666},{x:.95,y:1,w:.3,h:.4},{x:.1,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.1,y:.13333333333333333,w:.6,h:.8},{x:.1,y:.13333333333333333,w:.8,h:1},{x:.3,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.3,y:.13333333333333333,w:.6,h:.8},{x:.3,y:.13333333333333333,w:.8,h:1},{x:.5,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.5,y:.13333333333333333,w:.6,h:.8},{x:.5,y:.13333333333333333,w:.8,h:1},{x:.7,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.7,y:.13333333333333333,w:.6,h:.8},{x:.7,y:.13333333333333333,w:.8,h:1},{x:.9,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.9,y:.13333333333333333,w:.6,h:.8},{x:.9,y:.13333333333333333,w:.8,h:1},{x:.1,y:.4,w:.4,h:.5333333333333333},{x:.1,y:.4,w:.6,h:.8},{x:.1,y:.4,w:.8,h:1},{x:.3,y:.4,w:.4,h:.5333333333333333},{x:.3,y:.4,w:.6,h:.8},{x:.3,y:.4,w:.8,h:1},{x:.5,y:.4,w:.4,h:.5333333333333333},{x:.5,y:.4,w:.6,h:.8},{x:.5,y:.4,w:.8,h:1},{x:.7,y:.4,w:.4,h:.5333333333333333},{x:.7,y:.4,w:.6,h:.8},{x:.7,y:.4,w:.8,h:1},{x:.9,y:.4,w:.4,h:.5333333333333333},{x:.9,y:.4,w:.6,h:.8},{x:.9,y:.4,w:.8,h:1},{x:.1,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.1,y:.6666666666666666,w:.6,h:.8},{x:.1,y:.6666666666666666,w:.8,h:1},{x:.3,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.3,y:.6666666666666666,w:.6,h:.8},{x:.3,y:.6666666666666666,w:.8,h:1},{x:.5,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.5,y:.6666666666666666,w:.6,h:.8},{x:.5,y:.6666666666666666,w:.8,h:1},{x:.7,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.7,y:.6666666666666666,w:.6,h:.8},{x:.7,y:.6666666666666666,w:.8,h:1},{x:.9,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.9,y:.6666666666666666,w:.6,h:.8},{x:.9,y:.6666666666666666,w:.8,h:1},{x:.1,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.1,y:.9333333333333333,w:.6,h:.8},{x:.1,y:.9333333333333333,w:.8,h:1},{x:.3,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.3,y:.9333333333333333,w:.6,h:.8},{x:.3,y:.9333333333333333,w:.8,h:1},{x:.5,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.5,y:.9333333333333333,w:.6,h:.8},{x:.5,y:.9333333333333333,w:.8,h:1},{x:.7,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.7,y:.9333333333333333,w:.6,h:.8},{x:.7,y:.9333333333333333,w:.8,h:1},{x:.9,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.9,y:.9333333333333333,w:.6,h:.8},{x:.9,y:.9333333333333333,w:.8,h:1}];function faceDetector_createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=faceDetector_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var _n223=0,i=function i(){};return{s:i,n:function n(){return _n223>=e.length?{done:!0}:{done:!1,value:e[_n223++]};},e:function e(_e962){throw _e962;},f:i};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,a=!0,s=!1;return{s:function s(){r=r.call(e);},n:function n(){var e=r.next();return a=e.done,e;},e:function e(_e963){s=!0,o=_e963;},f:function f(){try{a||null==r["return"]||r["return"]();}finally{if(s)throw o;}}};}function faceDetector_unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return faceDetector_arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?faceDetector_arrayLikeToArray(e,t):void 0;}}function faceDetector_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n;}function faceDetector_usePreprocessData(e,t,r,n){for(var i=r*t,o=2*r*t,a=0;a<n.length/3;a++)n[0+a]=e[4*a]/127.5-1,n[i+a]=e[4*a+1]/127.5-1,n[o+a]=e[4*a+2]/127.5-1;}function faceDetector_usePostprocessData(e){for(var t=e.tensor,r=e.faceDetectorAccuracy,n=void 0===r?.85:r,i=e.outputHeight,o=void 0===i?240:i,a=e.outputWidth,s=void 0===a?320:a,u=[],l=t.boxes.data,c=t.scores.data,h=0;h<4420;h++){if(!(c[2*h+1]<=n)){var f=.1*l[4*h+0]*priors[h].w+priors[h].x,d=.1*l[4*h+1]*priors[h].h+priors[h].y,p=Math.exp(.2*l[4*h+2])*priors[h].w,y=Math.exp(.2*l[4*h+3])*priors[h].h,m={x1:(f-p/2)*s,y1:(d-y/2)*o,x2:(f+p/2)*s,y2:(d+y/2)*o};if(u.length){var g,w=!1,b=faceDetector_createForOfIteratorHelper(u);try{for(b.s();!(g=b.n()).done;){if(g.value.checkSame(m)){w=!0;break;}}}catch(e){b.e(e);}finally{b.f();}w||u.push(new FaceCombiner(m));}else u.push(new FaceCombiner(m));}}return u;}function useDrawSquare(e,t,r){if(t&&(!Array.isArray(t)||0!==t.length)){var n=e.getContext("2d");n.lineWidth=3;var i=Math.floor(255*Math.random()),o=Math.floor(255*Math.random()),a=Math.floor(255*Math.random());n.strokeStyle=null!=r?r:"rgb(".concat(i,",").concat(o,",").concat(a,")"),n.beginPath(),Array.isArray(t)?t.forEach(function(e){return n.rect(e.x1,e.y1,e.width,e.height);}):n.rect(t.x1,t.y1,t.width,t.height),n.stroke();}}function smoother_typeof(e){return smoother_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},smoother_typeof(e);}function smoother_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function smoother_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,smoother_toPropertyKey(n.key),n);}}function smoother_createClass(e,t,r){return t&&smoother_defineProperties(e.prototype,t),r&&smoother_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function smoother_toPropertyKey(e){var t=smoother_toPrimitive(e,"string");return"symbol"==smoother_typeof(t)?t:t+"";}function smoother_toPrimitive(e,t){if("object"!=smoother_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=smoother_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var SmoothTarget=function(){return smoother_createClass(function e(t){var r,n;smoother_classCallCheck(this,e),this.isFinished=!0,this.startValue=t.startValue,this.currentValue=t.startValue,this.currentStep=0,this.endValue=null!==(r=t.endValue)&&void 0!==r?r:t.startValue,this.smoothPower=null!==(n=t.smoothPower)&&void 0!==n?n:1,this.smoothFunction=function(e){switch(t.smoothFunctionType){case"ease-out-sine":return Math.sin(e*Math.PI/2);case"ease-out-quint":return 1-Math.pow(1-e,5);case"ease-out-cubic":Math.pow(1-e,3);default:return e;}};},[{key:"isEnded",value:function value(e){var t,r=Math.max(0,Math.min(1,null!==(t=null==e?void 0:e.percentage)&&void 0!==t?t:1));return(null==e?void 0:e.isreverse)&&(r=1-r),(null==e?void 0:e.isreverse)?this.currentStep<=this.smoothPower*r:this.currentStep>=this.smoothPower*r;}},{key:"getCurrentValue",value:function value(){return this.currentValue;}},{key:"getEndValue",value:function value(){return this.endValue;}},{key:"setCurrentStep",value:function value(e){this.currentStep=e;}},{key:"checkEndValueChange",value:function value(e){e!==this.endValue&&(this.startValue=this.currentValue,this.endValue=e,this.currentStep=1);}},{key:"useAnimationPart",value:function value(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=Math.min(1,Math.max(0,e));var r=Math.max(1,Math.round(this.smoothPower*e));t?this.currentStep<r&&(this.currentStep=r):this.currentStep>r&&(this.currentStep=r);}},{key:"useSmooth",value:function value(e){var t;if(this.startValue===this.endValue)return this.currentValue;var r=(null==e?void 0:e.isReverse)?-1:1,n=this.currentStep/this.smoothPower,i=this.smoothFunction(n);return this.currentValue=this.startValue+(this.endValue-this.startValue)*i,this.smoothPower=null!==(t=null==e?void 0:e.newSmoothPower)&&void 0!==t?t:this.smoothPower,this.isFinished=this.currentStep===((null==e?void 0:e.isReverse)?0:this.smoothPower),this.currentStep=Math.max(0,Math.min(this.smoothPower,this.currentStep+r)),this.currentValue;}}]);}();function smartZoomEffect_typeof(e){return smartZoomEffect_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},smartZoomEffect_typeof(e);}function smartZoomEffect_regeneratorRuntime(){smartZoomEffect_regeneratorRuntime=function smartZoomEffect_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==smartZoomEffect_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(smartZoomEffect_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function smartZoomEffect_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function smartZoomEffect_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){smartZoomEffect_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){smartZoomEffect_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function smartZoomEffect_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function smartZoomEffect_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,smartZoomEffect_toPropertyKey(n.key),n);}}function smartZoomEffect_createClass(e,t,r){return t&&smartZoomEffect_defineProperties(e.prototype,t),r&&smartZoomEffect_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function smartZoomEffect_toPropertyKey(e){var t=smartZoomEffect_toPrimitive(e,"string");return"symbol"==smartZoomEffect_typeof(t)?t:t+"";}function smartZoomEffect_toPrimitive(e,t){if("object"!=smartZoomEffect_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=smartZoomEffect_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function smartZoomEffect_callSuper(e,t,r){return t=smartZoomEffect_getPrototypeOf(t),smartZoomEffect_possibleConstructorReturn(e,smartZoomEffect_isNativeReflectConstruct()?Reflect.construct(t,r||[],smartZoomEffect_getPrototypeOf(e).constructor):t.apply(e,r));}function smartZoomEffect_possibleConstructorReturn(e,t){if(t&&("object"==smartZoomEffect_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return smartZoomEffect_assertThisInitialized(e);}function smartZoomEffect_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function smartZoomEffect_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(smartZoomEffect_isNativeReflectConstruct=function smartZoomEffect_isNativeReflectConstruct(){return!!e;})();}function smartZoomEffect_superPropGet(e,t,r,n){var i=smartZoomEffect_get(smartZoomEffect_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e);}:i;}function smartZoomEffect_get(){return smartZoomEffect_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=smartZoomEffect_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value;}},smartZoomEffect_get.apply(null,arguments);}function smartZoomEffect_superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=smartZoomEffect_getPrototypeOf(e)););return e;}function smartZoomEffect_getPrototypeOf(e){return smartZoomEffect_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},smartZoomEffect_getPrototypeOf(e);}function smartZoomEffect_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&smartZoomEffect_setPrototypeOf(e,t);}function smartZoomEffect_setPrototypeOf(e,t){return smartZoomEffect_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},smartZoomEffect_setPrototypeOf(e,t);}var coordKeys=["x1","x2","y1","y2"],SmartZoomEffect=function(e){function t(e,r){var n;return smartZoomEffect_classCallCheck(this,t),(n=smartZoomEffect_callSuper(this,t,[e])).faceCoord={},n.inWork=!1,n.bufferPool=new BufferPool(),n.pixels=[],n.customer_id=r,n.config=Object.assign({},smart_zoom_config),n.filterMirror=new FilterMirror(),n;}return smartZoomEffect_inherits(t,AbstractEffect),smartZoomEffect_createClass(t,[{key:"init",value:(i=smartZoomEffect_asyncToGenerator(smartZoomEffect_regeneratorRuntime().mark(function e(t){return smartZoomEffect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.inference=t,e.next=3,this.inference.init(this.customer_id,"facedetector");case 3:case"end":return e.stop();}},e,this);})),function(e){return i.apply(this,arguments);})},{key:"nextFrame",value:function value(e){if(this.enabled&&!(this.pixels.length>1)){this.small.addTexture("frame",e.texture),this.small.activateTexture("frame"),this.resources.mirror&&(this.small.frame.filters=[this.filterMirror]),this.resources.renderer.renderTo(this.small.frame,this.small.getBuffer("model")),this.small.frame.filters=[],this.small.activateTexture("origin");var t=this.small.getBuffer("model");this.pixels.push(this.resources.renderer.pixelsAsync(t,{pool:this.bufferPool}));}}},{key:"prepare",value:function value(){var e=this,t=this.config,r=t.modelHeight,n=t.modelWidth,i=t.smoothPower;this.globalWidth=this.sdkOptions.width,this.globalHeight=this.sdkOptions.height,this.original=new Frame(this.resources.texture,{width:this.globalWidth,height:this.globalHeight}),this.original.addBuffer("result"),this.small=new Frame(this.resources.texture,{width:n,height:r}),this.small.addBuffer("model"),this.scaleValue=1,this.xOffset=0,this.yOffset=0;var o=this.defaultFaceCoord(),a={};coordKeys.forEach(function(t){e.faceCoord[t]=new SmoothTarget({startValue:o[t],smoothPower:i}),a[t]=e.faceCoord[t].getCurrentValue();}),this.currentFace=new FaceCombiner(a),this.sdkOptions.on("update",this.onOptionsUpdate,this);}},{key:"onOptionsUpdate",value:function value(){this.globalWidth=this.sdkOptions.width,this.globalHeight=this.sdkOptions.height,this.original.resize(this.globalWidth,this.globalHeight),this.scaleValue=1,this.xOffset=0,this.yOffset=0;}},{key:"process",value:(n=smartZoomEffect_asyncToGenerator(smartZoomEffect_regeneratorRuntime().mark(function e(){var t=arguments;return smartZoomEffect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break;}return e.abrupt("return");case 2:this.fps=t[1]||1,this.updateWaiter(),this.findFaces(),this.setCurrentFace(),this.calcScale(),this.calcOffset(),this.setTransfrom(),this.original.frame.setTransform(this.xOffset,this.yOffset,this.scaleValue,this.scaleValue),this.resources.renderer.renderTo(this.original.frame,this.original.getBuffer("result")),this.resources.texture.update(this.original.getBuffer("result"),!1);case 12:case"end":return e.stop();}},e,this);})),function(){return n.apply(this,arguments);})},{key:"getFaces",value:function value(){return this.enabled?this.faces:[];}},{key:"setCurrentFace",value:function value(){var e,t=this;(null===(e=this.faces)||void 0===e?void 0:e.length)?this.checkCurrentFace():this.noFaceWay();var r={};coordKeys.forEach(function(e){t.faceCoord[e].useSmooth({newSmoothPower:t.config.smoothPower}),r[e]=t.faceCoord[e].getCurrentValue();}),this.currentFace=new FaceCombiner(r),this.config.isFaceSquareDrawingEnabled,this.config.isPreFaceSquareDrawingEnabled;}},{key:"checkCurrentFace",value:function value(){var e=this;this.updateWaiter(!0);var t=this.faces.reduce(function(e,t){return t.getSquare()>e.getSquare()&&(e=t),e;},this.faces[0]),r=this.config.sensitivityValue/this.scaleValue;if(!t.isEqual(this.currentFace,r,this.globalHeight,this.globalWidth)){var n=t.getCoord();coordKeys.forEach(function(t){e.faceCoord[t].checkEndValueChange(n[t]);});}}},{key:"noFaceWay",value:function value(){var e=this;if(this.waiter.value>0)return this.waiter.value--,void this.updateWaiter(!1);var t=this.defaultFaceCoord();coordKeys.forEach(function(r){e.faceCoord[r].checkEndValueChange(t[r]);}),this.updateWaiter(!0);}},{key:"calcScale",value:function value(){var e=this.globalHeight*this.globalWidth,t=this.currentFace.getSquare()/e,r=this.config.faceAreaProportion/t;this.scaleValue=Math.sqrt(Math.max(r,1));}},{key:"calcOffset",value:function value(){var e=this,t=this.currentFace.getCenter(),r={x:{faceCenter:t.x,newOffset:0,base:this.globalWidth},y:{faceCenter:t.y,newOffset:0,base:this.globalHeight}};Object.values(r).forEach(function(t){var r=(e.scaleValue-1)/2*t.base,n=(t.base/2-t.faceCenter)*e.scaleValue,i=(e.scaleValue-1)*t.base,o=Math.max(n-r,-i);t.newOffset=Math.min(0,o);}),this.xOffset=r.x.newOffset,this.yOffset=r.y.newOffset;}},{key:"defaultFaceCoord",value:function value(){var e=this.globalWidth/2,t=this.globalHeight/2,r=e*Math.sqrt(this.config.faceAreaProportion),n=t*Math.sqrt(this.config.faceAreaProportion);return{x1:e-r,x2:e+r,y1:t-n,y2:t+n};}},{key:"updateWaiter",value:function value(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!this.waiter?this.waiter={value:this.fps*this.config.waiterSeconds,fps:this.fps}:(this.waiter.value=this.waiter.value/this.waiter.fps*this.fps,this.waiter.fps=this.fps);}},{key:"findFaces",value:(r=smartZoomEffect_asyncToGenerator(smartZoomEffect_regeneratorRuntime().mark(function e(){var t,r,n,i,o,a,s,u=this;return smartZoomEffect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.inWork){e.next=2;break;}return e.abrupt("return");case 2:if(this.checkTimer()){e.next=4;break;}return e.abrupt("return");case 4:if(this.pixels.length){e.next=6;break;}return e.abrupt("return");case 6:return this.inWork=!0,t=this.config,r=t.faceDetectorAccuracy,n=t.modelHeight,i=t.modelWidth,e.next=10,this.pixels.shift();case 10:return o=e.sent,a=this.bufferPool.getBuffer("f32",3*i*n),faceDetector_usePreprocessData(o,i,n,a),this.bufferPool.returnBuffer(o),s={scores:{data:this.bufferPool.getBuffer("f32",8840),dims:[1,4420,2]},boxes:{data:this.bufferPool.getBuffer("f32",17680),dims:[1,4420,4]}},e.abrupt("return",this.inference.run(a,i,n,"facedetector",s).then(function(e){u.bufferPool.returnBuffer(e.inputBack.data),u.faces=faceDetector_usePostprocessData({tensor:e,faceDetectorAccuracy:r,outputHeight:u.globalHeight,outputWidth:u.globalWidth}),u.bufferPool.returnBuffer(e.boxes.data),u.bufferPool.returnBuffer(e.scores.data);})["catch"](function(e){var t;errorBus.bv.notify({message:null!==(t=e.message)&&void 0!==t?t:e,emitter:errorBus.JK.EFFECT_SMART_ZOOM,cause:e});})["finally"](function(){u.inWork=!1;}));case 16:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"enable",value:function value(){smartZoomEffect_superPropGet(t,"enable",this,3)([]),this.setTransfrom();}},{key:"setTransfrom",value:function value(){this.resources.transform={xOffset:this.xOffset,yOffset:this.yOffset,scaleValue:this.scaleValue};}},{key:"disable",value:function value(){smartZoomEffect_superPropGet(t,"disable",this,3)([]),this.resources.transform=null,this.scaleValue=1,this.xOffset=0,this.yOffset=0,this.bufferPool=new BufferPool();}},{key:"clearBuffers",value:function value(){this.pixels=[];}},{key:"setConfig",value:function value(e,t){this.config[e]=t;}},{key:"checkTimer",value:function value(){return this.faceDetectorTimer?(performance.now()-this.faceDetectorTimer<this.config.faceDetectorPediod_ms||(this.faceDetectorTimer=0),!1):(this.faceDetectorTimer=performance.now(),!0);}},{key:"destroy",value:function value(){this.sdkOptions.off("update",this.onOptionsUpdate,this);}}]);var r,n,i;}();function CustomResolutionEffects_typeof(e){return CustomResolutionEffects_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},CustomResolutionEffects_typeof(e);}function CustomResolutionEffects_regeneratorRuntime(){CustomResolutionEffects_regeneratorRuntime=function CustomResolutionEffects_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==CustomResolutionEffects_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(CustomResolutionEffects_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function CustomResolutionEffects_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function CustomResolutionEffects_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){CustomResolutionEffects_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){CustomResolutionEffects_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function CustomResolutionEffects_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function CustomResolutionEffects_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CustomResolutionEffects_toPropertyKey(n.key),n);}}function CustomResolutionEffects_createClass(e,t,r){return t&&CustomResolutionEffects_defineProperties(e.prototype,t),r&&CustomResolutionEffects_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function CustomResolutionEffects_toPropertyKey(e){var t=CustomResolutionEffects_toPrimitive(e,"string");return"symbol"==CustomResolutionEffects_typeof(t)?t:t+"";}function CustomResolutionEffects_toPrimitive(e,t){if("object"!=CustomResolutionEffects_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=CustomResolutionEffects_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function CustomResolutionEffects_callSuper(e,t,r){return t=CustomResolutionEffects_getPrototypeOf(t),CustomResolutionEffects_possibleConstructorReturn(e,CustomResolutionEffects_isNativeReflectConstruct()?Reflect.construct(t,r||[],CustomResolutionEffects_getPrototypeOf(e).constructor):t.apply(e,r));}function CustomResolutionEffects_possibleConstructorReturn(e,t){if(t&&("object"==CustomResolutionEffects_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return CustomResolutionEffects_assertThisInitialized(e);}function CustomResolutionEffects_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function CustomResolutionEffects_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(CustomResolutionEffects_isNativeReflectConstruct=function CustomResolutionEffects_isNativeReflectConstruct(){return!!e;})();}function CustomResolutionEffects_getPrototypeOf(e){return CustomResolutionEffects_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},CustomResolutionEffects_getPrototypeOf(e);}function CustomResolutionEffects_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CustomResolutionEffects_setPrototypeOf(e,t);}function CustomResolutionEffects_setPrototypeOf(e,t){return CustomResolutionEffects_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},CustomResolutionEffects_setPrototypeOf(e,t);}var CustomResolution=function(e){function t(e){return CustomResolutionEffects_classCallCheck(this,t),CustomResolutionEffects_callSuper(this,t,[e]);}return CustomResolutionEffects_inherits(t,AbstractEffect),CustomResolutionEffects_createClass(t,[{key:"prepare",value:function value(){var e=this.resources.texture;this.original=new Frame(e,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.original.addBuffer("result"),this.sdkOptions.on("update",this.onOptionsUpdate,this);}},{key:"onOptionsUpdate",value:function value(){this.sdkOptions.isCustomSize()?(this.original.resize(this.sdkOptions.width,this.sdkOptions.height),this.enable()):this.disable();}},{key:"process",value:(r=CustomResolutionEffects_asyncToGenerator(CustomResolutionEffects_regeneratorRuntime().mark(function e(){return CustomResolutionEffects_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break;}return e.abrupt("return");case 2:this.resources.renderer.renderTo(this.original.frame,this.original.getBuffer("result")),this.resources.texture.update(this.original.getBuffer("result"),!1);case 4:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"destroy",value:function value(){this.sdkOptions.off("update",this.onOptionsUpdate,this);}}]);var r;}();function component_typeof(e){return component_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},component_typeof(e);}function component_slicedToArray(e,t){return component_arrayWithHoles(e)||component_iterableToArrayLimit(e,t)||component_unsupportedIterableToArray(e,t)||component_nonIterableRest();}function component_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function component_unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return component_arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?component_arrayLikeToArray(e,t):void 0;}}function component_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n;}function component_iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1;}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e;}finally{try{if(!u&&null!=r["return"]&&(a=r["return"](),Object(a)!==a))return;}finally{if(l)throw i;}}return s;}}function component_arrayWithHoles(e){if(Array.isArray(e))return e;}function component_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function component_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,component_toPropertyKey(n.key),n);}}function component_createClass(e,t,r){return t&&component_defineProperties(e.prototype,t),r&&component_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function component_toPropertyKey(e){var t=component_toPrimitive(e,"string");return"symbol"==component_typeof(t)?t:t+"";}function component_toPrimitive(e,t){if("object"!=component_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=component_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var Component=function(){return component_createClass(function e(t,r){component_classCallCheck(this,e),this.options={},this.sdkOptions=t,this.container=new _Container2(),this.setOptions(r);},[{key:"setOptions",value:function value(e){var t=this;e&&Object.entries(e).forEach(function(e){var r=component_slicedToArray(e,2),n=r[0],i=r[1];t.options[n]=i;});}},{key:"show",value:function value(){this.beforeShowFunction&&this.beforeShowFunction(),this.container.visible=!0,this.afterShowFunction&&this.afterShowFunction();}},{key:"hide",value:function value(){this.beforeHideFunction&&this.beforeHideFunction(),this.container.visible=!1,this.afterHideFunction&&this.afterHideFunction();}},{key:"onBeforeShow",value:function value(e){"function"==typeof e&&(this.beforeShowFunction=e);}},{key:"onAfterShow",value:function value(e){"function"==typeof e&&(this.afterShowFunction=e);}},{key:"onBeforeHide",value:function value(e){"function"==typeof e&&(this.beforeHideFunction=e);}},{key:"onAfterHide",value:function value(e){"function"==typeof e&&(this.afterHideFunction=e);}},{key:"isVisible",value:function value(){return this.container.visible;}},{key:"getOptions",value:function value(){return this.options;}},{key:"destroy",value:function value(){this.container.destroy(!0);}},{key:"px",value:function value(e){return this.sdkOptions.width/640*e;}},{key:"render",value:function value(){}}]);}(),componentsProxyHandler={set:function set(e,t,r){return r instanceof Component?"_"!==t[0]?Reflect.set(e,t,r):e.hasOwnProperty(t)?void 0!==e[t]?(errorBus.bv.notify({type:errorBus.By.WARNING,message:"You can't overwrite service component '".concat(t,"' (components that begin with a '_' character)"),emitter:errorBus.JK.COMPONENTS_SYSTEM}),!1):Reflect.set(e,t,r):(errorBus.bv.notify({type:errorBus.By.WARNING,message:"The component ID('".concat(t,"') cannot begin with the character '_', this case reserved for service components."),emitter:errorBus.JK.COMPONENTS_SYSTEM}),!1):(errorBus.bv.notify({type:errorBus.By.WARNING,message:"Wrong assigned value",emitter:errorBus.JK.COMPONENTS_SYSTEM}),!1);},get:function get(e,t,r){if("_getSortedComponentsArr"===t){var n=[],i=[];return Object.keys(e).forEach(function(t){e[t]&&("_"===t[0]?i.push(e[t]):n.push(e[t]));}),n.concat(i);}return Reflect.get(e,t,r);}},stats=__webpack_require__(6739);function overlaySprite_typeof(e){return overlaySprite_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},overlaySprite_typeof(e);}function overlaySprite_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function overlaySprite_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,overlaySprite_toPropertyKey(n.key),n);}}function overlaySprite_createClass(e,t,r){return t&&overlaySprite_defineProperties(e.prototype,t),r&&overlaySprite_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function overlaySprite_toPropertyKey(e){var t=overlaySprite_toPrimitive(e,"string");return"symbol"==overlaySprite_typeof(t)?t:t+"";}function overlaySprite_toPrimitive(e,t){if("object"!=overlaySprite_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=overlaySprite_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var OverlaySprite=function(){return overlaySprite_createClass(function e(t,r,n){overlaySprite_classCallCheck(this,e),this.sprite=_Sprite.from(t),this.sprite.width=null!=r?r:this.sprite.texture.baseTexture.width,this.sprite.height=null!=n?n:this.sprite.texture.baseTexture.height,this.ratio=this.sprite.width/this.sprite.height;},[{key:"destroy",value:function value(){var e,t;null===(t=null===(e=this.sprite)||void 0===e?void 0:e.texture)||void 0===t||t.destroy(!0);}}]);}();function overlayScreen_regeneratorRuntime(){overlayScreen_regeneratorRuntime=function overlayScreen_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==overlayScreen_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(overlayScreen_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function overlayScreen_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function overlayScreen_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){overlayScreen_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){overlayScreen_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function overlayScreen_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function overlayScreen_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,overlayScreen_toPropertyKey(n.key),n);}}function overlayScreen_createClass(e,t,r){return t&&overlayScreen_defineProperties(e.prototype,t),r&&overlayScreen_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function overlayScreen_toPropertyKey(e){var t=overlayScreen_toPrimitive(e,"string");return"symbol"==overlayScreen_typeof(t)?t:t+"";}function overlayScreen_toPrimitive(e,t){if("object"!=overlayScreen_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=overlayScreen_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function overlayScreen_callSuper(e,t,r){return t=overlayScreen_getPrototypeOf(t),overlayScreen_possibleConstructorReturn(e,overlayScreen_isNativeReflectConstruct()?Reflect.construct(t,r||[],overlayScreen_getPrototypeOf(e).constructor):t.apply(e,r));}function overlayScreen_possibleConstructorReturn(e,t){if(t&&("object"==overlayScreen_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return overlayScreen_assertThisInitialized(e);}function overlayScreen_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function overlayScreen_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(overlayScreen_isNativeReflectConstruct=function overlayScreen_isNativeReflectConstruct(){return!!e;})();}function overlayScreen_superPropGet(e,t,r,n){var i=overlayScreen_get(overlayScreen_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e);}:i;}function overlayScreen_get(){return overlayScreen_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=overlayScreen_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value;}},overlayScreen_get.apply(null,arguments);}function overlayScreen_superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=overlayScreen_getPrototypeOf(e)););return e;}function overlayScreen_getPrototypeOf(e){return overlayScreen_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},overlayScreen_getPrototypeOf(e);}function overlayScreen_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&overlayScreen_setPrototypeOf(e,t);}function overlayScreen_setPrototypeOf(e,t){return overlayScreen_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},overlayScreen_setPrototypeOf(e,t);}function overlayScreen_typeof(e){return overlayScreen_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},overlayScreen_typeof(e);}var __decorate=function __decorate(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":overlayScreen_typeof(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a;},__metadata=function __metadata(e,t){if("object"===("undefined"==typeof Reflect?"undefined":overlayScreen_typeof(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t);},OverlayScreen=function(e){function t(e,r){var n;return overlayScreen_classCallCheck(this,t),(n=overlayScreen_callSuper(this,t,[e,r])).isVideo=!1,n.hide(),n.render(),n;}return overlayScreen_inherits(t,Component),overlayScreen_createClass(t,[{key:"render",value:function value(){var e=this;this.container.removeChildren(),this.defaultOverlaySprite=new OverlaySprite(Texture_Texture.WHITE,1920,1280),this.initOverlayFromUrl(this.options)["finally"](function(){return e.setOverlayImage();});}},{key:"show",value:function value(){this.switchVideoTexture(!0),overlayScreen_superPropGet(t,"show",this,3)([]);}},{key:"hide",value:function value(){overlayScreen_superPropGet(t,"hide",this,3)([]),this.switchVideoTexture(!1);}},{key:"initOverlayFromUrl",value:(i=overlayScreen_asyncToGenerator(overlayScreen_regeneratorRuntime().mark(function e(t){return overlayScreen_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.loadImage(null==t?void 0:t.url).then(function(){var e;return null===(e=null==t?void 0:t.promise)||void 0===e?void 0:e.resolve();})["catch"](function(e){var r;return null===(r=null==t?void 0:t.promise)||void 0===r?void 0:r.reject(e);})["finally"](function(){return null==t||delete t.promise;}));case 1:case"end":return e.stop();}},e,this);})),function(e){return i.apply(this,arguments);})},{key:"setOptions",value:(n=overlayScreen_asyncToGenerator(overlayScreen_regeneratorRuntime().mark(function e(t){return overlayScreen_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break;}return e.abrupt("return");case 2:this.loadImage(t.url).then(function(){var e;return null===(e=t.promise)||void 0===e?void 0:e.resolve();})["catch"](function(e){var r;return null===(r=t.promise)||void 0===r?void 0:r.reject(e);})["finally"](function(){return null==t||delete t.promise;});case 3:case"end":return e.stop();}},e,this);})),function(e){return n.apply(this,arguments);})},{key:"setOverlayImage",value:function value(){var e,t=null!==(e=this.loadedOverlaySprite)&&void 0!==e?e:this.defaultOverlaySprite,r=t.sprite,n=t.ratio,i=this.sdkOptions.width,o=this.sdkOptions.height,a=i/o-n,s=r.width;r.width=a>0?i:i-i*a,r.height=r.height*r.width/s,r.anchor.set(.5-i/r.width/2,.5-o/r.height/2),this.container.addChild(r);}},{key:"loadImage",value:(r=overlayScreen_asyncToGenerator(overlayScreen_regeneratorRuntime().mark(function e(t){var r=this;return overlayScreen_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break;}throw new Error("Invalid url");case 2:if(this.currentURL!==t&&this.processedURL!==t){e.next=4;break;}throw new Error("Same url");case 4:return this.processedURL=t,e.next=7,fetch(t,{method:"HEAD"}).then(function(e){if(!e.ok)throw new Error("Overlay Screen: Image loading error");})["catch"](function(e){throw errorBus.bv.notify({type:errorBus.By.WARNING,message:'OverlayScreen image loading error [url = "'.concat(t,'"]. Error: ').concat(e),emitter:errorBus.JK.COMPONENTS_SYSTEM,cause:e}),new Error("Overlay Screen: Image loading error");});case 7:Texture_Texture.fromURL(t).then(function(e){var n,i;r.isVideo=(null===(n=e.baseTexture.resource)||void 0===n?void 0:n.source)instanceof HTMLVideoElement,r.resource=e.baseTexture.resource,r.isVideo&&(r.resource.source.loop=!0,r.resource.source.autoplay=!1,r.container.visible&&r.resource.source.play(),r.resource.source.loop=!0,r.resource.source.muted=!0),r.container.removeChildren(),null===(i=r.loadedOverlaySprite)||void 0===i||i.destroy(),r.loadedOverlaySprite=new OverlaySprite(e),r.currentURL=t;})["catch"](function(e){throw errorBus.bv.notify({type:errorBus.By.WARNING,message:'OverlayScreen image loading error [url = "'.concat(t,'"]. Error: ').concat(e),emitter:errorBus.JK.COMPONENTS_SYSTEM,cause:e}),new Error("Overlay Screen: Image loading error");})["finally"](function(){r.setOverlayImage(),r.processedURL="";});case 8:case"end":return e.stop();}},e,this);})),function(e){return r.apply(this,arguments);})},{key:"switchVideoTexture",value:function value(e){if(this.isVideo)return e?(this.resource.source.currentTime=0,void this.resource.source.play()):void this.resource.source.pause();}}]);var r,n,i;}();function prefetch_typeof(e){return prefetch_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},prefetch_typeof(e);}function prefetch_regeneratorRuntime(){prefetch_regeneratorRuntime=function prefetch_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==prefetch_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(prefetch_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function prefetch_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function prefetch_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){prefetch_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){prefetch_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function prefetch(e){return _prefetch.apply(this,arguments);}function _prefetch(){return _prefetch=prefetch_asyncToGenerator(prefetch_regeneratorRuntime().mark(function e(t){return prefetch_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"HEAD"});case 2:if(e.sent.ok){e.next=5;break;}throw new Error("Url is not available");case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop();}},e);})),_prefetch.apply(this,arguments);}function positionHelper_typeof(e){return positionHelper_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},positionHelper_typeof(e);}function positionHelper_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function positionHelper_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,positionHelper_toPropertyKey(n.key),n);}}function positionHelper_createClass(e,t,r){return t&&positionHelper_defineProperties(e.prototype,t),r&&positionHelper_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function positionHelper_toPropertyKey(e){var t=positionHelper_toPrimitive(e,"string");return"symbol"==positionHelper_typeof(t)?t:t+"";}function positionHelper_toPrimitive(e,t){if("object"!=positionHelper_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=positionHelper_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}__decorate([(0,stats.kc)("overlayScreen"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],OverlayScreen.prototype,"show",null),__decorate([(0,stats.kc)("overlayScreen"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],OverlayScreen.prototype,"hide",null);var PositionHelper=function(){return positionHelper_createClass(function e(){positionHelper_classCallCheck(this,e);},null,[{key:"calcPosition",value:function value(e,t,r,n){return"custom"===r.placement?this.getCustomPosition(e,t,r.x,r.y):this.getPositionFromPlacement(e,t,r.placement,n);}},{key:"getPositionFromPlacement",value:function value(e,t,r,n){var i=n.height,o=n.width,a=e,s=t,u={x:0,y:0};return"center"==r?(u.x=(a-o)/2,u.y=(s-i)/2,u):(r.endsWith("right")&&(u.x=a-o),r.startsWith("bottom")&&(u.y=s-i),u);}},{key:"getCustomPosition",value:function value(e,t,r,n){return{x:e*r,y:t*n};}}]);}();function watermark_typeof(e){return watermark_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},watermark_typeof(e);}function watermark_regeneratorRuntime(){watermark_regeneratorRuntime=function watermark_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==watermark_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(watermark_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function watermark_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function watermark_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){watermark_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){watermark_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function watermark_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function watermark_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,watermark_toPropertyKey(n.key),n);}}function watermark_createClass(e,t,r){return t&&watermark_defineProperties(e.prototype,t),r&&watermark_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function watermark_toPropertyKey(e){var t=watermark_toPrimitive(e,"string");return"symbol"==watermark_typeof(t)?t:t+"";}function watermark_toPrimitive(e,t){if("object"!=watermark_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=watermark_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function watermark_callSuper(e,t,r){return t=watermark_getPrototypeOf(t),watermark_possibleConstructorReturn(e,watermark_isNativeReflectConstruct()?Reflect.construct(t,r||[],watermark_getPrototypeOf(e).constructor):t.apply(e,r));}function watermark_possibleConstructorReturn(e,t){if(t&&("object"==watermark_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return watermark_assertThisInitialized(e);}function watermark_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function watermark_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(watermark_isNativeReflectConstruct=function watermark_isNativeReflectConstruct(){return!!e;})();}function watermark_getPrototypeOf(e){return watermark_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},watermark_getPrototypeOf(e);}function watermark_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&watermark_setPrototypeOf(e,t);}function watermark_setPrototypeOf(e,t){return watermark_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},watermark_setPrototypeOf(e,t);}var defaultOptions=function defaultOptions(){return{url:"",position:{placement:"top-left",x:0,y:0},size:.05};},Watermark=function(e){function t(e,r){var n;return watermark_classCallCheck(this,t),(n=watermark_callSuper(this,t,[e])).sprite=new _Sprite(),n.sprite.visible=!1,n.container.addChild(n.sprite),n.setOptions(Object.assign(defaultOptions(),r)),n;}return watermark_inherits(t,Component),watermark_createClass(t,[{key:"setOptions",value:function value(e){(null==e?void 0:e.size)&&this.setSize(e.size),(null==e?void 0:e.position)&&this.setPosition(e.position),(null==e?void 0:e.url)&&this.setURL(e.url);}},{key:"setURL",value:(r=watermark_asyncToGenerator(watermark_regeneratorRuntime().mark(function e(t){var r=this;return watermark_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.options.url!==t){e.next=2;break;}return e.abrupt("return");case 2:return e.abrupt("return",prefetch(t).then(function(){return Texture_Texture.fromURL(t);}).then(function(e){r.sprite.visible=!0,r.sprite.texture=e,r.sprite.height=r.sdkOptions.height*r.options.size,r.sprite.width=e.width/e.height*r.sprite.height,r.options.url=t,r.sprite.visible=!0;})["catch"](function(e){var t;errorBus.bv.notify({message:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:e,emitter:errorBus.JK.COMPONENTS_SYSTEM,cause:e});}));case 3:case"end":return e.stop();}},e,this);})),function(e){return r.apply(this,arguments);})},{key:"setSize",value:function value(e){this.options.size=Math.min(1,Math.max(.01,e));var t=this.sprite.width/this.sprite.height;this.sprite.height=this.sdkOptions.height*this.options.size,this.sprite.width=this.sprite.height*t,this.options.position&&"custom"!==this.options.position.placement&&this.setPosition(this.options.position);}},{key:"setPosition",value:function value(e){this.options.position=e;var t={width:this.sprite.width,height:this.sprite.height},r=PositionHelper.calcPosition(this.sdkOptions.width,this.sdkOptions.height,e,t),n=r.x,i=r.y;this.sprite.position.x=n,this.sprite.position.y=i;}},{key:"clear",value:function value(){this.sprite.visible=!1;}},{key:"render",value:function value(){this.setSize(this.options.size),this.setPosition(this.options.position);}}]);var r;}();function stickerSprite_typeof(e){return stickerSprite_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},stickerSprite_typeof(e);}function stickerSprite_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function stickerSprite_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,stickerSprite_toPropertyKey(n.key),n);}}function stickerSprite_createClass(e,t,r){return t&&stickerSprite_defineProperties(e.prototype,t),r&&stickerSprite_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function stickerSprite_toPropertyKey(e){var t=stickerSprite_toPrimitive(e,"string");return"symbol"==stickerSprite_typeof(t)?t:t+"";}function stickerSprite_toPrimitive(e,t){if("object"!=stickerSprite_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=stickerSprite_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var StickerSprite=function(){return stickerSprite_createClass(function e(t,r){var n;stickerSprite_classCallCheck(this,e),this.sdkOptions=t,this.sprite=r.sprite,this.id=r.id,this.player=r.player,this.canvas=r.canvas,this.aminationPhase=null!==(n=r.aminationPhase)&&void 0!==n?n:"static",this.sprite.alpha=0,this.shrink=Math.max(0,Math.min(1,r.shrink)),this.sourceRatio=this.sprite.texture.baseTexture.width/this.sprite.texture.baseTexture.height,this.setSpriteSize(r.size),this.sprite.height=this.height*this.shrink,this.sprite.width=this.width*this.shrink;},[{key:"isShowing",value:function value(){return"showing"===this.aminationPhase;}},{key:"isStatic",value:function value(){return"static"===this.aminationPhase;}},{key:"isHidingStop",value:function value(){return 0===this.sprite.alpha;}},{key:"animateAlpha",value:function value(e){this.isStatic()||(this.sprite.alpha=this.isShowing()?Math.min(this.sprite.alpha+e,1):Math.max(this.sprite.alpha-e,0),1!==this.sprite.alpha&&0!==this.sprite.alpha||(this.aminationPhase="static"));}},{key:"animateSize",value:function value(e){if(!this.isStatic()){var t=this.height*e*(1-this.shrink),r=this.width*e*(1-this.shrink);this.sprite.height=this.isShowing()?Math.min(this.sprite.height+t,this.height):Math.max(this.sprite.height-t,this.height*this.shrink),this.sprite.width=this.isShowing()?Math.min(this.sprite.width+r,this.width):Math.max(this.sprite.width-r,this.width*this.shrink);}}},{key:"animatePosition",value:function value(e){this.isStatic()||(this.sprite.position.x=e.x+(this.width-this.sprite.width)/2,this.sprite.position.y=e.y+(this.height-this.sprite.height)/2);}},{key:"reset",value:function value(){this.sprite.height=this.height*this.shrink,this.sprite.width=this.width*this.shrink,this.sprite.alpha=0;}},{key:"setSpriteSize",value:function value(e){this.height=this.sdkOptions.height*(null!=e?e:.3),this.width=this.height*this.sourceRatio,this.sprite.height=this.height,this.sprite.width=this.width;}}]);}(),lib=__webpack_require__(3161),lib_default=__webpack_require__.n(lib);function stickers_regeneratorRuntime(){stickers_regeneratorRuntime=function stickers_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==stickers_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(stickers_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function stickers_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function stickers_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){stickers_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){stickers_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function stickers_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function stickers_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,stickers_toPropertyKey(n.key),n);}}function stickers_createClass(e,t,r){return t&&stickers_defineProperties(e.prototype,t),r&&stickers_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function stickers_toPropertyKey(e){var t=stickers_toPrimitive(e,"string");return"symbol"==stickers_typeof(t)?t:t+"";}function stickers_toPrimitive(e,t){if("object"!=stickers_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=stickers_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function stickers_callSuper(e,t,r){return t=stickers_getPrototypeOf(t),stickers_possibleConstructorReturn(e,stickers_isNativeReflectConstruct()?Reflect.construct(t,r||[],stickers_getPrototypeOf(e).constructor):t.apply(e,r));}function stickers_possibleConstructorReturn(e,t){if(t&&("object"==stickers_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return stickers_assertThisInitialized(e);}function stickers_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function stickers_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(stickers_isNativeReflectConstruct=function stickers_isNativeReflectConstruct(){return!!e;})();}function stickers_superPropGet(e,t,r,n){var i=stickers_get(stickers_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e);}:i;}function stickers_get(){return stickers_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=stickers_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value;}},stickers_get.apply(null,arguments);}function stickers_superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=stickers_getPrototypeOf(e)););return e;}function stickers_getPrototypeOf(e){return stickers_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},stickers_getPrototypeOf(e);}function stickers_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&stickers_setPrototypeOf(e,t);}function stickers_setPrototypeOf(e,t){return stickers_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},stickers_setPrototypeOf(e,t);}function stickers_typeof(e){return stickers_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},stickers_typeof(e);}var stickers_decorate=function stickers_decorate(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":stickers_typeof(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a;},stickers_metadata=function stickers_metadata(e,t){if("object"===("undefined"==typeof Reflect?"undefined":stickers_typeof(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t);},stickers_defaultOptions=function stickers_defaultOptions(){return{capacity:8,duration:1500,animationSpeed:.08,position:{x:0,y:0,placement:"top-left"}};},Stickers=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return stickers_classCallCheck(this,t),(r=stickers_callSuper(this,t,[e,Object.assign(stickers_defaultOptions(),n)])).spriteStore=[],r.ticker=new _Ticker2(),r.ticker.add(function(){return r.animateSticker();}),r.hide(),r;}return stickers_inherits(t,Component),stickers_createClass(t,[{key:"show",value:function value(){stickers_superPropGet(t,"show",this,3)([]),this.ticker.start();}},{key:"hide",value:function value(){stickers_superPropGet(t,"hide",this,3)([]),this.ticker.stop();}},{key:"onLoadSucccess",value:function value(e){var t="function"==typeof e;this.loadSuccesssFunc=t?e:void 0;}},{key:"onLoadError",value:function value(e){var t="function"==typeof e;this.loadErrorFunc=t?e:void 0;}},{key:"setOptions",value:(n=stickers_asyncToGenerator(stickers_regeneratorRuntime().mark(function e(r){return stickers_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break;}return e.abrupt("return");case 2:r.position&&(this.updateSpritePosition(r.position),delete r.position),r.sticker&&(this.addSticker(r.sticker),delete r.sticker),r.id&&(this.selectSticker(r.id),delete r.id),stickers_superPropGet(t,"setOptions",this,3)([r]),r.size&&this.activeSticker&&this.activeSticker.setSpriteSize(r.size),r.duration&&this.activeSticker&&!this.activeSticker.isHidingStop()&&this.setOptions({id:this.activeID});case 8:case"end":return e.stop();}},e,this);})),function(e){return n.apply(this,arguments);})},{key:"selectSticker",value:function value(e){var t,r,n=this;if(e===this.activeID)return 0===this.activeSticker.sprite.alpha&&this.show(),this.activeSticker.aminationPhase="showing",clearTimeout(this.timerId),void(this.timerId=setTimeout(function(){return n.activeSticker.aminationPhase="hiding";},this.options.duration));this.activeSticker&&(this.container.removeChildren(),null===(t=this.activeSticker.player)||void 0===t||t.stop(),this.activeSticker.reset()),this.activeID=e;var i=this.spriteStore.find(function(e){return e.id===n.activeID;});i&&(null===(r=i.player)||void 0===r||r.play(),i.sprite.position.x=this.options.position.x,i.sprite.position.y=this.options.position.y,i.aminationPhase="showing",this.container.addChild(i.sprite),this.activeSticker=i,this.activeSticker.setSpriteSize(this.options.size),this.calcPosition(),clearTimeout(this.timerId),this.show(),this.timerId=setTimeout(function(){n.activeSticker.aminationPhase="hiding";},this.options.duration));}},{key:"loadSticker",value:(r=stickers_asyncToGenerator(stickers_regeneratorRuntime().mark(function e(t){var r,n,i,o,a,s,u,l,c,h=arguments;return stickers_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=h.length>1&&void 0!==h[1]&&h[1],i=void 0,o=void 0,a=void 0,e.next=6,isVideoSource(t);case 6:if(!e.sent){e.next=16;break;}return e.t0=_Sprite,e.next=11,Texture_Texture.fromURL(t);case 11:e.t1=e.sent,(a=new e.t0(e.t1)).texture.baseTexture.resource.source.loop=!0,e.next=35;break;case 16:return e.next=18,fetch(t).then(function(e){return e.arrayBuffer();})["catch"](function(e){throw console.log("[ Stickers component ] - url fetching: ".concat(e)),e;});case 18:if(s=e.sent,!((u=lib_default()(s))instanceof Error)){e.next=28;break;}return e.t2=_Sprite,e.next=24,Texture_Texture.fromURL(t);case 24:e.t3=e.sent,a=new e.t2(e.t3),e.next=35;break;case 28:return(i=document.createElement("canvas")).width=u.width,i.height=u.height,e.next=33,u.getPlayer(i.getContext("2d",{willReadFrequently:!0}),!0);case 33:o=e.sent,a=new _Sprite(Texture_Texture.from(i));case 35:return this.spriteStore.push(new StickerSprite(this.sdkOptions,{id:t,sprite:a,player:o,canvas:i,shrink:.99,size:this.options.size})),r||this.setOptions({id:t}),l={},this.spriteStore.length>this.options.capacity&&(c=this.spriteStore.shift(),l.removedID=null==c?void 0:c.id,null==c||c.sprite.destroy(!0),null===(n=null==c?void 0:c.canvas)||void 0===n||n.remove()),e.abrupt("return",l);case 40:case"end":return e.stop();}},e,this);})),function(e){return r.apply(this,arguments);})},{key:"animateSticker",value:function value(){var e,t,r;(null===(r=null===(t=null===(e=this.activeSticker)||void 0===e?void 0:e.sprite)||void 0===t?void 0:t.texture)||void 0===r?void 0:r.baseTexture)&&(this.activeSticker.animateSize(this.options.animationSpeed),this.activeSticker.animatePosition(this.options.position),this.activeSticker.animateAlpha(this.options.animationSpeed),this.activeSticker.isHidingStop()?this.hide():this.activeSticker.sprite.texture.update());}},{key:"updateSpritePosition",value:function value(e){var t;this.options.position||(this.options.position={});var r=this.sdkOptions.width,n=this.sdkOptions.height;e.x&&(this.options.position.x=r*e.x),e.y&&(this.options.position.y=n*e.y),e.placement&&(this.options.position.placement=e.placement),(null===(t=this.activeSticker)||void 0===t?void 0:t.sprite)&&(this.calcPosition(),this.activeSticker.sprite.position.x=this.options.position.x,this.activeSticker.sprite.position.y=this.options.position.y);}},{key:"addSticker",value:function value(e){var t=this,r=function r(_r319){var n,i;"function"==typeof(null===(n=null==e?void 0:e.promise)||void 0===n?void 0:n.resolve)&&(null===(i=null==e?void 0:e.promise)||void 0===i||i.resolve(_r319)),"function"==typeof t.loadSuccesssFunc&&t.loadSuccesssFunc(e.url,null==_r319?void 0:_r319.removedID);};this.spriteStore.some(function(t){return t.id===e.url;})?r():this.loadSticker(e.url,null==e?void 0:e.silenceMode).then(r)["catch"](function(r){var n,i;"function"==typeof(null===(n=null==e?void 0:e.promise)||void 0===n?void 0:n.reject)&&(null===(i=null==e?void 0:e.promise)||void 0===i||i.reject(r)),"function"==typeof t.loadErrorFunc&&t.loadErrorFunc(e.url);});}},{key:"calcPosition",value:function value(){if("custom"!==this.options.position.placement&&this.options.position.placement){var e=this.sdkOptions.width-this.activeSticker.width,t=this.sdkOptions.height-this.activeSticker.height;if("center"===this.options.position.placement)return this.options.position.x=.5*e,void(this.options.position.y=.5*t);this.options.position.x=~this.options.position.placement.indexOf("left")?0:e,this.options.position.y=~this.options.position.placement.indexOf("top")?0:t;}}}]);var r,n;}();function isVideoSource(e){return _isVideoSource.apply(this,arguments);}function _isVideoSource(){return _isVideoSource=stickers_asyncToGenerator(stickers_regeneratorRuntime().mark(function e(t){var r;return stickers_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"HEAD"});case 2:return r=e.sent,e.abrupt("return",!!~r.headers.get("content-type").indexOf("video"));case 4:case"end":return e.stop();}},e);})),_isVideoSource.apply(this,arguments);}function lowerThird_regeneratorRuntime(){lowerThird_regeneratorRuntime=function lowerThird_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==lowerThird_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(lowerThird_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function lowerThird_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function lowerThird_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){lowerThird_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){lowerThird_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function lowerThird_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function lowerThird_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lowerThird_toPropertyKey(n.key),n);}}function lowerThird_createClass(e,t,r){return t&&lowerThird_defineProperties(e.prototype,t),r&&lowerThird_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function lowerThird_toPropertyKey(e){var t=lowerThird_toPrimitive(e,"string");return"symbol"==lowerThird_typeof(t)?t:t+"";}function lowerThird_toPrimitive(e,t){if("object"!=lowerThird_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=lowerThird_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function lowerThird_callSuper(e,t,r){return t=lowerThird_getPrototypeOf(t),lowerThird_possibleConstructorReturn(e,lowerThird_isNativeReflectConstruct()?Reflect.construct(t,r||[],lowerThird_getPrototypeOf(e).constructor):t.apply(e,r));}function lowerThird_possibleConstructorReturn(e,t){if(t&&("object"==lowerThird_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return lowerThird_assertThisInitialized(e);}function lowerThird_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function lowerThird_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(lowerThird_isNativeReflectConstruct=function lowerThird_isNativeReflectConstruct(){return!!e;})();}function lowerThird_getPrototypeOf(e){return lowerThird_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},lowerThird_getPrototypeOf(e);}function lowerThird_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lowerThird_setPrototypeOf(e,t);}function lowerThird_setPrototypeOf(e,t){return lowerThird_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},lowerThird_setPrototypeOf(e,t);}function lowerThird_typeof(e){return lowerThird_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},lowerThird_typeof(e);}stickers_decorate([(0,stats.kc)(),stickers_metadata("design:type",Function),stickers_metadata("design:paramtypes",[String]),stickers_metadata("design:returntype",void 0)],Stickers.prototype,"selectSticker",null);var lowerThird_decorate=function lowerThird_decorate(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":lowerThird_typeof(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a;},lowerThird_metadata=function lowerThird_metadata(e,t){if("object"===("undefined"==typeof Reflect?"undefined":lowerThird_typeof(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t);},lowerThird_defaultOptions=function lowerThird_defaultOptions(){return{position:{x:0,y:0,placement:"bottom-left"},color:{primary:33777,secondary:16777215,text:1118481},offset:{x:0,y:0},text:{title:"LowerThird Title",subtitle:"LowerThird Subtitle",maxLengthTitle:10,maxLengthSubtitle:100}};},LowerThird=function(e){function t(e,r){var n;return lowerThird_classCallCheck(this,t),(n=lowerThird_callSuper(this,t,[e])).fonts={},n.isShowing=!1,n.isHiding=!1,n.options=lowerThird_defaultOptions(),n.setOptions(r,!1),n.ticker=new _Ticker2(),n.container.visible=!1,n;}return lowerThird_inherits(t,Component),lowerThird_createClass(t,[{key:"render",value:function value(){}},{key:"setOptions",value:function value(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&(this.setColor(e.color),this.setOffset(e.offset),this.setPosition(e.position),this.setText(e.text),t&&this.render());}},{key:"showLowerThird",value:function value(){this.stopHiding(),"function"==typeof this.showFunction&&(this.ticker.add(this.showFunction),this.ticker.started||this.ticker.start(),this.isShowing=!0);}},{key:"hideLowerThird",value:function value(){this.stopShowing(),"function"==typeof this.hideFunction&&(this.isHiding=!0,this.ticker.add(this.hideFunction),this.ticker.started||this.ticker.start());}},{key:"stopShowing",value:function value(){this.ticker.started&&this.ticker.stop(),this.ticker.remove(this.showFunction),this.isShowing=!1;}},{key:"stopHiding",value:function value(){this.ticker.started&&this.ticker.stop(),this.ticker.remove(this.hideFunction),this.isHiding=!1;}},{key:"setColor",value:function value(e){var t=this;e&&Object.keys(e).forEach(function(r){t.options.color[r]=e[r];});}},{key:"setOffset",value:function value(e){var t=this;e&&Object.keys(e).forEach(function(r){t.options.offset[r]=Math.min(.25,Math.max(0,e[r]));});}},{key:"setPosition",value:function value(e){var t=this;e&&Object.keys(e).forEach(function(r){t.options.position[r]=e[r];});}},{key:"setText",value:function value(e){var t=this;e&&Object.keys(e).forEach(function(r){t.options.text[r]=e[r];});}},{key:"offsetX",value:function value(){var e;return this.sdkOptions.width*(null!==(e=this.options.offset.x)&&void 0!==e?e:0);}},{key:"offsetY",value:function value(){var e;return this.sdkOptions.height*(null!==(e=this.options.offset.y)&&void 0!==e?e:0);}},{key:"strTrimAndEllipsis",value:function value(e,t){return(e=e.trim()).length<t?e:e.substring(0,t-3)+"...";}},{key:"showOffset",value:function value(){var e=new _Graphics2();e.lineStyle({color:14550873,width:1}).drawRect(this.offsetX(),this.offsetY(),this.sdkOptions.width-2*this.offsetX(),this.sdkOptions.height-2*this.offsetY()),this.container.addChild(e);}},{key:"drawRectPrimary",value:function value(e,t,r,n){var i=new _Graphics2();return i.beginFill(this.options.color.primary).drawRect(e,t,r,n).endFill(),i;}},{key:"drawRectSecondary",value:function value(e,t,r,n){var i=new _Graphics2();return i.beginFill(this.options.color.secondary).drawRect(e,t,r,n).endFill(),i;}},{key:"fontFamily",value:function value(e){var t;return null!==(t=this.fonts[e])&&void 0!==t?t:"Arial, Helvetica, sans-serif";}},{key:"loadFont",value:(r=lowerThird_asyncToGenerator(lowerThird_regeneratorRuntime().mark(function e(t,r){var n=this;return lowerThird_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_Assets.load(r).then(function(e){n.fonts[t]||(n.fonts[t]=[]),n.fonts[t].push('"'.concat(e.family.replace(/[\\"]/g,"\\$&"),'"'));})["catch"](function(e){errorBus.bv.notify({type:errorBus.By.WARNING,message:"LowerThird font loading. ".concat(e),cause:e,emitter:errorBus.JK.COMPONENTS_SYSTEM});});case 2:case"end":return e.stop();}},e);})),function(e,t){return r.apply(this,arguments);})},{key:"destroy",value:function value(){var e;this.stopShowing(),this.stopHiding(),this.hide(),null===(e=this.container)||void 0===e||e.destroy(!0);}}]);var r;}();function smoothNumber_typeof(e){return smoothNumber_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},smoothNumber_typeof(e);}function smoothNumber_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function smoothNumber_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,smoothNumber_toPropertyKey(n.key),n);}}function smoothNumber_createClass(e,t,r){return t&&smoothNumber_defineProperties(e.prototype,t),r&&smoothNumber_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function smoothNumber_toPropertyKey(e){var t=smoothNumber_toPrimitive(e,"string");return"symbol"==smoothNumber_typeof(t)?t:t+"";}function smoothNumber_toPrimitive(e,t){if("object"!=smoothNumber_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=smoothNumber_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}lowerThird_decorate([(0,stats.kc)(),lowerThird_metadata("design:type",Function),lowerThird_metadata("design:paramtypes",[]),lowerThird_metadata("design:returntype",void 0)],LowerThird.prototype,"showLowerThird",null),lowerThird_decorate([(0,stats.kc)(),lowerThird_metadata("design:type",Function),lowerThird_metadata("design:paramtypes",[]),lowerThird_metadata("design:returntype",void 0)],LowerThird.prototype,"hideLowerThird",null);var SmoothNumber=function(){return smoothNumber_createClass(function e(t){var r,n,i,o,a,s;smoothNumber_classCallCheck(this,e),this.startValue=t.startValue,this.currentValue=t.startValue,this.currentStep=0,this.endValue=null!==(r=t.endValue)&&void 0!==r?r:t.startValue,this.smoothPower=null!==(n=t.smoothPower)&&void 0!==n?n:1,this.range=this.endValue-this.startValue,this.speedNext=null!==(i=t.speedNext)&&void 0!==i?i:1,this.speedBack=null!==(a=null!==(o=t.speedBack)&&void 0!==o?o:t.speedNext)&&void 0!==a?a:1,this.smoothFunctionNext=this.getSmoothFunction(t.smoothFunctionNext),this.smoothFunctionBack=this.getSmoothFunction(null!==(s=t.smoothFunctionBack)&&void 0!==s?s:t.smoothFunctionNext);},[{key:"setCurrentStep",value:function value(e){this.currentStep=Math.max(0,Math.min(e,this.smoothPower));}},{key:"getCurrentStep",value:function value(){return this.currentStep;}},{key:"setEnd",value:function value(){return this.currentStep=this.smoothPower,this.endValue;}},{key:"isEnd",value:function value(e){return this.currentStep>=this.smoothPower*(null!=e?e:1);}},{key:"isStart",value:function value(e){return this.currentStep<=this.smoothPower*(null!=e?e:0);}},{key:"reset",value:function value(){this.currentStep=0;}},{key:"next",value:function value(){if(this.startValue===this.endValue)return this.currentValue;var e=this.currentStep/this.smoothPower,t=this.smoothFunctionNext(e);return this.currentValue=this.startValue+this.range*t,this.currentStep=Math.min(this.smoothPower,this.currentStep+this.speedNext),this.currentValue;}},{key:"back",value:function value(){if(this.startValue===this.endValue)return this.currentValue;this.currentStep=Math.max(0,this.currentStep-this.speedBack);var e=this.currentStep/this.smoothPower,t=this.smoothFunctionBack(e);return this.currentValue=this.startValue+this.range*t,this.currentValue;}},{key:"getSmoothFunction",value:function value(e){return function(t){switch(e){case"ease-out-sine":return Math.sin(t*Math.PI/2);case"ease-out-quint":return 1-Math.pow(1-t,5);case"ease-out-cubic":Math.pow(1-t,3);default:return t;}};}}]);}();function leftTextbox_typeof(e){return leftTextbox_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},leftTextbox_typeof(e);}function leftTextbox_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function leftTextbox_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,leftTextbox_toPropertyKey(n.key),n);}}function leftTextbox_createClass(e,t,r){return t&&leftTextbox_defineProperties(e.prototype,t),r&&leftTextbox_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function leftTextbox_toPropertyKey(e){var t=leftTextbox_toPrimitive(e,"string");return"symbol"==leftTextbox_typeof(t)?t:t+"";}function leftTextbox_toPrimitive(e,t){if("object"!=leftTextbox_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=leftTextbox_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function leftTextbox_callSuper(e,t,r){return t=leftTextbox_getPrototypeOf(t),leftTextbox_possibleConstructorReturn(e,leftTextbox_isNativeReflectConstruct()?Reflect.construct(t,r||[],leftTextbox_getPrototypeOf(e).constructor):t.apply(e,r));}function leftTextbox_possibleConstructorReturn(e,t){if(t&&("object"==leftTextbox_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return leftTextbox_assertThisInitialized(e);}function leftTextbox_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function leftTextbox_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(leftTextbox_isNativeReflectConstruct=function leftTextbox_isNativeReflectConstruct(){return!!e;})();}function leftTextbox_getPrototypeOf(e){return leftTextbox_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},leftTextbox_getPrototypeOf(e);}function leftTextbox_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&leftTextbox_setPrototypeOf(e,t);}function leftTextbox_setPrototypeOf(e,t){return leftTextbox_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},leftTextbox_setPrototypeOf(e,t);}var LtLeftTextbox=function(e){function t(e,r){var n;return leftTextbox_classCallCheck(this,t),(n=leftTextbox_callSuper(this,t,[e,r])).animations={},n.smoothPower=65,n.ltContainer=new _Container2(),n.container.addChild(n.ltContainer),n.addShowFunction(),n.addHideFunction(),n.render(),n;}return leftTextbox_inherits(t,LowerThird),leftTextbox_createClass(t,[{key:"render",value:function value(){var e;null===(e=this.ltContainer)||void 0===e||e.destroy(!0),this.ltContainer=new _Container2(),this.ltContainer.position.x=this.offsetX(),this.container.addChild(this.ltContainer),this.createText(),this.addRectangles(),this.addSpriteMask(),this.ltContainer.addChild(this.rectBack),this.ltContainer.addChild(this.rectFront),this.ltContainer.addChild(this.title),this.ltContainer.addChild(this.subtitle);}},{key:"createText",value:function value(){var e=this,t=this.sdkOptions.width-2*this.offsetX()-this.px(70),r=function r(_r320,n,i){return{fontFamily:"Trebuchet MS",fontSize:e.px(_r320),fontWeight:n,fill:i,wordWrapWidth:t,wordWrap:!0,breakWords:!0};};this.subtitle=new _Text2(this.options.text.subtitle,r(12,"400",this.options.color.primary)),this.subtitle.position.x=-this.subtitle.width,this.subtitle.position.y=this.sdkOptions.height-this.offsetY()-this.px(12)-this.subtitle.height,this.animations.subtitle=new SmoothNumber({startValue:-this.subtitle.width,endValue:this.px(15),smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.3}),this.title=new _Text2(this.options.text.title,r(20,"700",1118481)),this.title.width=Math.min(t,this.title.width),this.title.position.x=-this.title.width,this.title.position.y=this.sdkOptions.height-this.offsetY()-this.px(15)-this.subtitle.height-this.title.height,this.animations.title=new SmoothNumber({startValue:-this.title.width,endValue:this.px(15),smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.3}),this.ltWidth=Math.max(this.title.width,this.subtitle.width)+this.px(45),this.ltHeight=this.title.height+this.subtitle.height+this.px(23),this.isVisible()&&(this.title.position.x=this.animations.title.setEnd(),this.subtitle.position.x=this.animations.subtitle.setEnd());}},{key:"addRectangles",value:function value(){var e=this.sdkOptions.height-this.offsetY()-this.ltHeight;this.rectBack=new _Graphics2().beginFill(this.options.color.primary).drawRoundedRect(0,e,this.ltWidth,this.ltHeight,this.px(5)).endFill(),this.animations.rectBack=new SmoothNumber({startValue:-this.rectBack.width,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.1}),this.rectFront=new _Graphics2().beginFill(16777215).drawRoundedRect(0,e,this.ltWidth-this.px(15),this.ltHeight,this.px(5)).endFill(),this.rectFront.position.x=-this.ltWidth+this.px(15),this.animations.rectFront=new SmoothNumber({startValue:-this.rectFront.width,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.1}),this.isVisible()&&(this.rectBack.position.x=this.animations.rectBack.setEnd(),this.rectFront.position.x=this.animations.rectFront.setEnd());}},{key:"addSpriteMask",value:function value(){this.mask=new _Sprite(Texture_Texture.WHITE),this.mask.width=this.ltWidth,this.mask.height=this.sdkOptions.height,this.ltContainer.addChild(this.mask),this.ltContainer.mask=this.mask;}},{key:"addShowFunction",value:function value(){var e=this;this.showFunction=function(){e.show(),e.rectBack.position.x=e.animations.rectBack.next(),e.animations.rectBack.isEnd(.3)&&(e.rectFront.position.x=e.animations.rectFront.next()),e.animations.rectBack.isEnd(.8)&&(e.title.position.x=e.animations.title.next()),e.animations.title.isEnd(.3)&&(e.subtitle.position.x=e.animations.subtitle.next()),Object.values(e.animations).reduce(function(e,t){return e&&t.isEnd();},!0)&&e.stopShowing();};}},{key:"addHideFunction",value:function value(){var e=this;this.hideFunction=function(){e.isHiding||(e.stopHiding(),e.hide()),e.subtitle.position.x=e.animations.subtitle.back(),e.title.position.x=e.animations.title.back(),e.rectFront.position.x=e.animations.rectFront.back(),e.rectBack.position.x=e.animations.rectBack.back(),e.isHiding=!e.animations.rectBack.isStart();};}}]);}();function horizontalMirror_typeof(e){return horizontalMirror_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},horizontalMirror_typeof(e);}function horizontalMirror_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function horizontalMirror_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,horizontalMirror_toPropertyKey(n.key),n);}}function horizontalMirror_createClass(e,t,r){return t&&horizontalMirror_defineProperties(e.prototype,t),r&&horizontalMirror_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function horizontalMirror_toPropertyKey(e){var t=horizontalMirror_toPrimitive(e,"string");return"symbol"==horizontalMirror_typeof(t)?t:t+"";}function horizontalMirror_toPrimitive(e,t){if("object"!=horizontalMirror_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=horizontalMirror_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function horizontalMirror_callSuper(e,t,r){return t=horizontalMirror_getPrototypeOf(t),horizontalMirror_possibleConstructorReturn(e,horizontalMirror_isNativeReflectConstruct()?Reflect.construct(t,r||[],horizontalMirror_getPrototypeOf(e).constructor):t.apply(e,r));}function horizontalMirror_possibleConstructorReturn(e,t){if(t&&("object"==horizontalMirror_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return horizontalMirror_assertThisInitialized(e);}function horizontalMirror_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function horizontalMirror_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(horizontalMirror_isNativeReflectConstruct=function horizontalMirror_isNativeReflectConstruct(){return!!e;})();}function horizontalMirror_getPrototypeOf(e){return horizontalMirror_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},horizontalMirror_getPrototypeOf(e);}function horizontalMirror_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&horizontalMirror_setPrototypeOf(e,t);}function horizontalMirror_setPrototypeOf(e,t){return horizontalMirror_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},horizontalMirror_setPrototypeOf(e,t);}var fonts={title:{cyrillic:"https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjFhdVYNyB1Wk.woff2",latin:"https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjFhdVZNyB.woff2"},subtitle:{cyrillic:"https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjKhVVYNyB1Wk.woff2",latin:"https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjKhVVZNyB.woff2"}},LtHorizontalMirror=function(e){function t(e,r){var n;return horizontalMirror_classCallCheck(this,t),(n=horizontalMirror_callSuper(this,t,[e,r])).isReady=!1,n.animations={},n.smoothPower={title:35,subtitle:35,middleLine:50},n.addShowFunction(),n.addHideFunction(),Promise.all([n.loadFont("title",fonts.title.cyrillic),n.loadFont("title",fonts.title.latin),n.loadFont("subtitle",fonts.subtitle.cyrillic),n.loadFont("subtitle",fonts.subtitle.latin)])["finally"](function(){n.isReady=!0,n.render();}),n;}return horizontalMirror_inherits(t,LowerThird),horizontalMirror_createClass(t,[{key:"render",value:function value(){var e,t;this.container.removeChild(this.middleLine),this.container.removeChild(this.titleContainer),this.container.removeChild(this.subtitleContainer),null===(e=this.titleContainer)||void 0===e||e.destroy(!0),null===(t=this.subtitleContainer)||void 0===t||t.destroy(!0),this.createText(),this.createRectangles(),this.container.addChild(this.middleLine),this.container.addChild(this.titleContainer),this.container.addChild(this.subtitleContainer);}},{key:"createText",value:function value(){this.title=new _Text2(this.options.text.title,{fontFamily:this.fontFamily("title"),fontSize:this.px(35),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0,align:"right"}),this.title.position.x=0,this.title.position.y=this.title.height,this.titleContainer=new _Container2(),this.titleContainer.width=this.title.width,this.titleContainer.height=this.title.height+this.px(200);var e=new _Sprite(Texture_Texture.WHITE);e.tint=0,e.width=this.title.width,e.height=this.title.height,e.position.x=0,e.position.y=0,this.titleContainer.addChild(e),this.titleContainer.mask=e,this.titleContainer.addChild(this.title),this.animations.title=new SmoothNumber({startValue:this.title.position.y,endValue:0,smoothPower:this.smoothPower.title,smoothFunctionNext:"ease-out-quint"}),this.subtitle=new _Text2(this.options.text.subtitle,{fontFamily:this.fontFamily("subtitle"),fontSize:this.px(13),fontWeight:"100",fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0,align:"right"}),this.subtitle.position.x=0,this.subtitle.position.y=-this.subtitle.height-this.px(20),this.subtitleContainer=new _Container2(),this.subtitleContainer.width=this.subtitle.width,this.subtitleContainer.height=this.subtitle.height+this.px(20);var t=new _Sprite(Texture_Texture.WHITE);t.tint=0,t.width=this.subtitle.width,t.height=this.subtitle.height,t.position.x=0,t.position.y=0,this.subtitleContainer.addChild(t),this.subtitleContainer.mask=t,this.subtitleContainer.addChild(this.subtitle),this.animations.subtitle=new SmoothNumber({startValue:this.subtitle.position.y,smoothPower:this.smoothPower.subtitle,endValue:0,smoothFunctionNext:"ease-out-quint"}),this.ltWidth=Math.max(this.title.width,this.subtitle.width)+this.px(25),this.ltHeight=this.titleContainer.height+this.subtitleContainer.height+this.px(10),this.titleContainer.position.x=this.offsetX(),this.subtitleContainer.position.x=this.offsetX();var r=this.titleContainer.width-this.subtitleContainer.width;r>0?this.subtitleContainer.position.x+=r:this.titleContainer.position.x-=r,this.titleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.ltHeight,this.subtitleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.subtitleContainer.height,this.isVisible()&&(this.title.position.y=0,this.subtitle.position.y=0,this.animations.title.setCurrentStep(this.smoothPower.title),this.animations.subtitle.setCurrentStep(this.smoothPower.subtitle));}},{key:"createRectangles",value:function value(){this.middleLine=new _Graphics2();var e=this.ltWidth+this.offsetX(),t=this.sdkOptions.height-this.offsetY()-this.subtitleContainer.height-this.px(8);this.middleLine.beginFill(this.options.color.primary).drawRoundedRect(-e-this.px(2),t,e,this.px(3),this.px(2)).endFill(),this.animations.middleLine=new SmoothNumber({startValue:0,smoothPower:this.smoothPower.middleLine,endValue:e,smoothFunctionNext:"ease-out-quint"}),this.isVisible()&&(this.middleLine.position.x=e,this.animations.middleLine.setCurrentStep(this.smoothPower.middleLine));}},{key:"addShowFunction",value:function value(){var e=this;this.showFunction=function(){e.isReady&&(e.show(),e.middleLine.position.x=e.animations.middleLine.next(),e.animations.middleLine.isEnd(.5)&&(e.title.position.y=e.animations.title.next()),e.animations.middleLine.isEnd(.5)&&(e.subtitle.position.y=e.animations.subtitle.next()),Object.values(e.animations).reduce(function(e,t){return e&&t.isEnd();},!0)&&e.stopShowing());};}},{key:"addHideFunction",value:function value(){var e=this;this.hideFunction=function(){if(!e.isHiding)return e.stopHiding(),void e.hide();e.title.position.y=e.animations.title.back(),e.subtitle.position.y=e.animations.subtitle.back(),e.animations.title.isStart(.7)&&(e.middleLine.position.x=e.animations.middleLine.back()),e.isHiding=!Object.values(e.animations).reduce(function(e,t){return e&&t.isStart();},!0);};}}]);}();function slideBold_typeof(e){return slideBold_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},slideBold_typeof(e);}function slideBold_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function slideBold_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,slideBold_toPropertyKey(n.key),n);}}function slideBold_createClass(e,t,r){return t&&slideBold_defineProperties(e.prototype,t),r&&slideBold_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function slideBold_toPropertyKey(e){var t=slideBold_toPrimitive(e,"string");return"symbol"==slideBold_typeof(t)?t:t+"";}function slideBold_toPrimitive(e,t){if("object"!=slideBold_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=slideBold_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function slideBold_callSuper(e,t,r){return t=slideBold_getPrototypeOf(t),slideBold_possibleConstructorReturn(e,slideBold_isNativeReflectConstruct()?Reflect.construct(t,r||[],slideBold_getPrototypeOf(e).constructor):t.apply(e,r));}function slideBold_possibleConstructorReturn(e,t){if(t&&("object"==slideBold_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return slideBold_assertThisInitialized(e);}function slideBold_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function slideBold_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(slideBold_isNativeReflectConstruct=function slideBold_isNativeReflectConstruct(){return!!e;})();}function slideBold_getPrototypeOf(e){return slideBold_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},slideBold_getPrototypeOf(e);}function slideBold_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&slideBold_setPrototypeOf(e,t);}function slideBold_setPrototypeOf(e,t){return slideBold_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},slideBold_setPrototypeOf(e,t);}var slideBold_fonts={title:{cyrillic:"https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr73w9aXpsog.woff2",latin:"https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr73w5aXo.woff2"},subtitle:{cyrillic:"https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr6Hw9aXpsog.woff2",latin:"https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr6Hw5aXo.woff2"}},LtSlideBold=function(e){function t(e,r){var n;return slideBold_classCallCheck(this,t),(n=slideBold_callSuper(this,t,[e,r])).titleFontSize=35,n.animations={},n.isReady=!1,n.smoothPower={title:95,subtitle:95,titleRect:75,titleTextMask:75,titleRectMask:75,rectFront:40,rectBack:40},n.addShowFunction(),n.addHideFunction(),Promise.all([n.loadFont("title",slideBold_fonts.title.cyrillic),n.loadFont("title",slideBold_fonts.title.latin),n.loadFont("subtitle",slideBold_fonts.subtitle.cyrillic),n.loadFont("subtitle",slideBold_fonts.subtitle.latin)])["finally"](function(){n.isReady=!0,n.render();}),n;}return slideBold_inherits(t,LowerThird),slideBold_createClass(t,[{key:"render",value:function value(){var e,t,r;this.container.removeChild(this.titleContainer),this.container.removeChild(this.subtitleContainer),this.container.removeChild(this.vertLineContainer),null===(e=this.titleContainer)||void 0===e||e.destroy(!0),null===(t=this.subtitleContainer)||void 0===t||t.destroy(!0),null===(r=this.vertLineContainer)||void 0===r||r.destroy(!0),this.createSubtitle(),this.createTitle(),this.createRectangles(),this.container.addChild(this.titleContainer),this.container.addChild(this.subtitleContainer),this.container.addChild(this.vertLineContainer);}},{key:"createTitle",value:function value(){var e;this.title=new _Text2(null===(e=this.options.text.title)||void 0===e?void 0:e.toUpperCase(),{fontFamily:this.fontFamily("title"),fontSize:this.px(this.titleFontSize),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0,lineHeight:this.px(this.titleFontSize)}),this.title.position.x=.3*this.title.width,this.animations.title=new SmoothNumber({startValue:this.title.position.x,endValue:this.px(10),smoothPower:this.smoothPower.title,smoothFunctionNext:"ease-out-quint",speedBack:1.3});var t=new _Container2();t.width=this.title.width+this.px(10),t.height=this.title.height,t.addChild(this.title),this.titleTextMask=new _Sprite(Texture_Texture.WHITE),this.titleTextMask.width=0,this.titleTextMask.height=this.title.height,t.addChild(this.titleTextMask),t.mask=this.titleTextMask,this.animations.titleTextMask=new SmoothNumber({startValue:0,endValue:this.title.width+this.px(10),smoothPower:this.smoothPower.titleTextMask,smoothFunctionNext:"ease-out-quint",speedBack:1.25}),this.titleRect=this.drawRectSecondary(0,this.px(this.titleFontSize/3.5),this.title.width,this.title.height-this.px(this.titleFontSize/2.2)),this.animations.titleRect=new SmoothNumber({startValue:.2*-this.title.width,endValue:this.title.width+this.px(35),smoothPower:this.smoothPower.titleRect,smoothFunctionNext:"ease-out-quint",speedNext:.5,speedBack:1.1});var r=new _Container2();r.width=this.titleRect.width,r.height=this.titleRect.height,r.addChild(this.titleRect),this.titleRectMask=new _Sprite(Texture_Texture.WHITE),this.titleRectMask.width=0,this.titleRectMask.height=this.title.height,r.addChild(this.titleRectMask),r.mask=this.titleRectMask,this.animations.titleRectMask=new SmoothNumber({startValue:0,endValue:this.title.width+this.px(35),smoothPower:this.smoothPower.titleRectMask,smoothFunctionNext:"ease-out-quint",speedNext:1.5,speedBack:1}),this.titleContainer=new _Container2(),this.titleContainer.width=this.title.width+this.px(10),this.titleContainer.height=this.title.height,this.titleContainer.addChild(t),this.titleContainer.addChild(r),this.ltHeight=this.title.height+this.subtitleContainer.height,this.titleContainer.position.x=this.offsetX(),this.titleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.ltHeight+this.px(3),this.isVisible()&&(this.title.position.x=this.animations.title.setEnd(),this.titleTextMask.width=this.animations.titleTextMask.setEnd(),this.titleRect.position.x=this.animations.titleRect.setEnd(),this.titleRectMask.width=this.animations.titleRectMask.setEnd());}},{key:"createSubtitle",value:function value(){var e;this.subtitle=new _Text2(null===(e=this.options.text.subtitle)||void 0===e?void 0:e.toUpperCase(),{fontFamily:this.fontFamily("subtitle"),fontSize:this.px(11),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0}),this.subtitle.position.x=-this.subtitle.width,this.animations.subtitle=new SmoothNumber({startValue:this.subtitle.position.x,endValue:this.px(11),smoothPower:this.smoothPower.subtitle,smoothFunctionNext:"ease-out-quint",speedBack:1.2}),this.subtitleContainer=new _Container2(),this.subtitleContainer.width=this.subtitle.width+this.px(10),this.subtitleContainer.height=this.subtitle.height,this.subtitleContainer.addChild(this.subtitle),this.subtitleContainer.position.x=this.offsetX(),this.subtitleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.subtitle.height;var t=new _Sprite(Texture_Texture.WHITE);t.width=this.subtitle.width+this.px(10),t.height=this.subtitle.height,this.subtitleContainer.addChild(t),this.subtitleContainer.mask=t,this.isVisible()&&(this.subtitle.position.x=this.animations.subtitle.setEnd());}},{key:"createRectangles",value:function value(){var e=this.title.height-this.px(this.titleFontSize/2.2);this.rectFront=this.drawRectPrimary(0,0,this.px(4),e),this.animations.rectFront=new SmoothNumber({startValue:e,endValue:0,smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint",speedNext:.8,speedBack:1}),this.rectBack=this.drawRectSecondary(0,0,this.px(4),this.px(4)),this.animations.rectBack=new SmoothNumber({startValue:e,endValue:-this.px(4),smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint",speedNext:1.5,speedBack:.6}),this.vertLineContainer=new _Container2(),this.vertLineContainer.width=this.rectFront.width,this.vertLineContainer.height=e,this.vertLineContainer.addChild(this.rectBack),this.vertLineContainer.addChild(this.rectFront),this.vertLineContainer.position.x=this.offsetX(),this.vertLineContainer.position.y=this.titleContainer.position.y+this.px(this.titleFontSize/3.5);var t=new _Sprite(Texture_Texture.WHITE);t.width=this.vertLineContainer.width,t.height=e,this.vertLineContainer.addChild(t),this.vertLineContainer.mask=t,this.isVisible()&&(this.rectFront.position.y=this.animations.rectFront.setEnd());}},{key:"addShowFunction",value:function value(){var e=this;this.showFunction=function(){e.isReady&&(e.show(),e.rectFront.position.y=e.animations.rectFront.next(),e.rectBack.position.y=e.animations.rectBack.next(),e.animations.rectFront.isEnd(.9)&&(e.title.position.x=e.animations.title.next(),e.subtitle.position.x=e.animations.subtitle.next(),e.titleTextMask.width=e.animations.titleTextMask.next(),e.titleRectMask.width=e.animations.titleRectMask.next(),e.titleRect.position.x=e.animations.titleRect.next(),Object.values(e.animations).reduce(function(e,t){return e&&t.isEnd();},!0)&&e.stopShowing()));};}},{key:"addHideFunction",value:function value(){var e=this;this.hideFunction=function(){if(!e.isHiding)return e.stopHiding(),void e.hide();e.title.position.x=e.animations.title.back(),e.subtitle.position.x=e.animations.subtitle.back(),e.animations.titleRect.getCurrentStep()<e.smoothPower.titleRect-2&&(e.titleTextMask.width=e.animations.titleTextMask.back()),e.titleRect.position.x=e.animations.titleRect.back(),e.titleRectMask.width=e.animations.titleRectMask.back(),e.animations.titleRectMask.isStart(.2)&&(e.rectBack.position.y=e.animations.rectBack.back(),e.rectFront.position.y=e.animations.rectFront.back()),e.isHiding=!Object.values(e.animations).reduce(function(e,t){return e&&t.isStart();},!0);};}}]);}();function doubleSlideRect_typeof(e){return doubleSlideRect_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},doubleSlideRect_typeof(e);}function doubleSlideRect_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function doubleSlideRect_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,doubleSlideRect_toPropertyKey(n.key),n);}}function doubleSlideRect_createClass(e,t,r){return t&&doubleSlideRect_defineProperties(e.prototype,t),r&&doubleSlideRect_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function doubleSlideRect_toPropertyKey(e){var t=doubleSlideRect_toPrimitive(e,"string");return"symbol"==doubleSlideRect_typeof(t)?t:t+"";}function doubleSlideRect_toPrimitive(e,t){if("object"!=doubleSlideRect_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=doubleSlideRect_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function doubleSlideRect_callSuper(e,t,r){return t=doubleSlideRect_getPrototypeOf(t),doubleSlideRect_possibleConstructorReturn(e,doubleSlideRect_isNativeReflectConstruct()?Reflect.construct(t,r||[],doubleSlideRect_getPrototypeOf(e).constructor):t.apply(e,r));}function doubleSlideRect_possibleConstructorReturn(e,t){if(t&&("object"==doubleSlideRect_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return doubleSlideRect_assertThisInitialized(e);}function doubleSlideRect_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function doubleSlideRect_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(doubleSlideRect_isNativeReflectConstruct=function doubleSlideRect_isNativeReflectConstruct(){return!!e;})();}function doubleSlideRect_getPrototypeOf(e){return doubleSlideRect_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},doubleSlideRect_getPrototypeOf(e);}function doubleSlideRect_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&doubleSlideRect_setPrototypeOf(e,t);}function doubleSlideRect_setPrototypeOf(e,t){return doubleSlideRect_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},doubleSlideRect_setPrototypeOf(e,t);}var doubleSlideRect_fonts={title:{cyrillic:"https://fonts.gstatic.com/s/geologica/v1/oY1l8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckUWF1lEP2A.woff2",latin:"https://fonts.gstatic.com/s/geologica/v1/oY1l8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckUWE1lE.woff2"},subtitle:{cyrillic:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-ASAEWn.woff2",latin:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-QSAA.woff2"}},LtDoubleSlideRect=function(e){function t(e,r){var n;return doubleSlideRect_classCallCheck(this,t),(n=doubleSlideRect_callSuper(this,t,[e,r])).animations={},n.isReady=!1,n.smoothPower={title:75,subtitle:65,rectFront:40,rectBack:40},n.addShowFunction(),n.addHideFunction(),Promise.all([n.loadFont("title",doubleSlideRect_fonts.title.cyrillic),n.loadFont("title",doubleSlideRect_fonts.title.latin),n.loadFont("subtitle",doubleSlideRect_fonts.subtitle.cyrillic),n.loadFont("subtitle",doubleSlideRect_fonts.subtitle.latin)])["finally"](function(){n.isReady=!0,n.render();}),n;}return doubleSlideRect_inherits(t,LowerThird),doubleSlideRect_createClass(t,[{key:"render",value:function value(){var e,t;this.container.removeChild(this.titleContainer),this.container.removeChild(this.subtitleContainer),null===(e=this.titleContainer)||void 0===e||e.destroy(!0),null===(t=this.subtitleContainer)||void 0===t||t.destroy(!0),this.createSubtitle(),this.createTitle(),this.createRectangles(),this.container.addChild(this.titleContainer),this.container.addChild(this.subtitleContainer);}},{key:"createSubtitle",value:function value(){this.subtitle=new _Text2(this.options.text.subtitle,{fontFamily:this.fontFamily("subtitle"),fontSize:this.px(13),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0});var e=this.subtitle.width+this.px(6);this.subtitle.position.x=-this.subtitle.width,this.subtitle.position.y=this.px(3),this.animations.subtitle=new SmoothNumber({startValue:this.subtitle.position.x,endValue:this.px(10),smoothPower:this.smoothPower.subtitle,smoothFunctionNext:"ease-out-quint"}),this.subtitleContainer=new _Container2(),this.subtitleContainer.width=e,this.subtitleContainer.height=this.subtitle.height+this.px(6),this.subtitleContainer.position.x=this.offsetX(),this.subtitleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.subtitle.height-this.px(6),this.isVisible()&&(this.subtitle.position.x=this.animations.subtitle.setEnd());}},{key:"createTitle",value:function value(){this.title=new _Text2(this.options.text.title,{fontFamily:this.fontFamily("title"),fontSize:this.px(30),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0}),this.title.position.y=this.title.height,this.animations.title=new SmoothNumber({startValue:this.title.position.y,endValue:0,smoothPower:this.smoothPower.title,smoothFunctionNext:"ease-out-quint"});var e=new _Sprite(Texture_Texture.WHITE);e.width=this.title.width,e.height=this.title.height,this.titleContainer=new _Container2(),this.titleContainer.width=this.title.width,this.titleContainer.height=this.title.height,this.titleContainer.addChild(this.title),this.titleContainer.addChild(e),this.titleContainer.mask=e,this.ltWidth=Math.max(this.title.width,this.subtitle.width+this.px(15)),this.ltHeight=this.title.height+this.subtitle.height,this.titleContainer.position.x=this.offsetX(),this.titleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.ltHeight-this.px(6),this.isVisible()&&(this.title.position.y=this.animations.title.setEnd());}},{key:"createRectangles",value:function value(){var e=this.subtitle.height+this.px(6),t=this.ltWidth;this.rectFront=this.drawRectPrimary(0,0,t,e),this.rectFront.position.x=-t,this.animations.rectFront=new SmoothNumber({startValue:-t,endValue:0,smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint"}),this.rectBack=this.drawRectSecondary(0,0,t,e),this.rectBack.position.x=t,this.animations.rectBack=new SmoothNumber({startValue:t,endValue:0,smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint"});var r=new _Sprite(Texture_Texture.WHITE);r.width=t,r.height=this.subtitle.height+this.px(6),this.subtitleContainer.addChild(r),this.subtitleContainer.mask=r,this.subtitleContainer.addChild(this.rectBack),this.subtitleContainer.addChild(this.rectFront),this.subtitleContainer.addChild(this.subtitle),this.isVisible()&&(this.rectFront.position.x=this.animations.rectFront.setEnd(),this.rectBack.position.x=this.animations.rectBack.setEnd());}},{key:"addShowFunction",value:function value(){var e=this;this.showFunction=function(){e.isReady&&(e.show(),e.rectBack.position.x=e.animations.rectBack.next(),e.animations.rectBack.isEnd()&&(e.rectFront.position.x=e.animations.rectFront.next(),e.animations.rectFront.isEnd(.3)&&(e.subtitle.position.x=e.animations.subtitle.next(),e.title.position.y=e.animations.title.next(),e.animations.title.isEnd()&&e.animations.subtitle.isEnd()&&e.stopShowing())));};}},{key:"addHideFunction",value:function value(){var e=this;this.hideFunction=function(){if(!e.isHiding)return e.stopHiding(),void e.hide();e.title.position.y=e.animations.title.back(),e.subtitle.position.x=e.animations.subtitle.back(),e.animations.subtitle.isStart(.5)&&(e.rectFront.position.x=e.animations.rectFront.back(),e.animations.rectFront.isStart()&&(e.rectBack.position.x=e.animations.rectBack.back())),e.isHiding=!Object.values(e.animations).reduce(function(e,t){return e&&t.isStart();},!0);};}}]);}();function animatedBox_typeof(e){return animatedBox_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},animatedBox_typeof(e);}function animatedBox_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function animatedBox_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,animatedBox_toPropertyKey(n.key),n);}}function animatedBox_createClass(e,t,r){return t&&animatedBox_defineProperties(e.prototype,t),r&&animatedBox_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function animatedBox_toPropertyKey(e){var t=animatedBox_toPrimitive(e,"string");return"symbol"==animatedBox_typeof(t)?t:t+"";}function animatedBox_toPrimitive(e,t){if("object"!=animatedBox_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=animatedBox_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var AnimatedBox=function(){return animatedBox_createClass(function e(t,r){animatedBox_classCallCheck(this,e),this.padding=20,this.smoothPower=75,this.startRectValue=0,this.sdkOptions=t,this.container=new _Container2(),this.addText(r),this.addRect(r),this.addHidden(r);var n=new _Sprite(Texture_Texture.WHITE);n.height=this.height,n.width=r.offsetX+this.width,n.position.x=-r.offsetX,this.container.addChild(n),this.container.mask=n,r.isVisible&&(this.text.position.x=this.textInAnimation.setEnd(),this.hiddenMask.position.x=this.hiddenMaskAnimation.setEnd(),this.rect.position.x=this.rectAnimation.setEnd());},[{key:"textInAnimateFunction",value:function value(){this.text.position.x=this.textInAnimation.next();}},{key:"textOutAnimateFunction",value:function value(){this.text.position.x=this.textOutAnimation.next();}},{key:"textResetFunction",value:function value(){this.text.position.x=2*this.px(this.padding)+this.width;}},{key:"rectAnimateFunction",value:function value(e){this.rect.position.x=e?this.rectAnimation.next():this.rectAnimation.back();}},{key:"hiddenMaskAnimateFunction",value:function value(e){this.hiddenMask.position.x=e?this.rectAnimation.next():this.rectAnimation.back();}},{key:"destroy",value:function value(){var e;null===(e=this.container)||void 0===e||e.destroy(!0);}},{key:"addText",value:function value(e){this.text=new _Text2(e.text,{fontFamily:e.fontfamily,fontSize:this.px(e.size),fill:e.colorText,wordWrapWidth:this.sdkOptions.width-2*e.offsetX-2*this.px(this.padding),wordWrap:!0,breakWords:!0}),this.height=1.2*this.text.height,this.width=this.text.width+2*this.px(this.padding);var t=2*this.px(this.padding)+this.width;this.text.position.x=t,this.text.position.y=this.px(e.size/8.5),this.textInAnimation=new SmoothNumber({startValue:t,endValue:this.px(this.padding),smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"}),this.textOutAnimation=new SmoothNumber({startValue:this.px(this.padding),endValue:-this.width-this.px(this.padding)-e.offsetX,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"}),this.container.addChild(this.text);}},{key:"addRect",value:function value(e){this.rect=new _Graphics2().beginFill(e.colorRect).drawRect(0,0,this.width,this.height).endFill(),this.startRectValue=-e.offsetX-this.width,this.rect.position.x=this.startRectValue,this.rectAnimation=new SmoothNumber({startValue:this.startRectValue,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"}),this.container.addChild(this.rect);}},{key:"addHidden",value:function value(e){this.hiddenMask=new _Sprite(Texture_Texture.WHITE),this.hiddenMask.width=this.width,this.hiddenMask.height=this.height,this.hiddenMask.position.x=this.startRectValue,this.hiddenMaskAnimation=new SmoothNumber({startValue:this.startRectValue,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"});var t=new _Text2(e.text,{fontFamily:e.fontfamily,fontSize:this.px(e.size),fill:e.colorTextHidden,wordWrapWidth:this.sdkOptions.width-2*e.offsetX-2*this.px(this.padding),wordWrap:!0,breakWords:!0});this.hiddenContainer=new _Container2(),this.hiddenContainer.addChild(t),this.hiddenContainer.position.x=this.px(this.padding),this.hiddenContainer.position.y=this.px(e.size/8.5),this.hiddenContainer.addChild(this.hiddenMask),this.hiddenContainer.mask=this.hiddenMask,this.container.addChild(this.hiddenContainer);}},{key:"px",value:function value(e){return this.sdkOptions.width/640*e;}}]);}();function twoSlideRects_typeof(e){return twoSlideRects_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},twoSlideRects_typeof(e);}function twoSlideRects_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function twoSlideRects_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,twoSlideRects_toPropertyKey(n.key),n);}}function twoSlideRects_createClass(e,t,r){return t&&twoSlideRects_defineProperties(e.prototype,t),r&&twoSlideRects_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function twoSlideRects_toPropertyKey(e){var t=twoSlideRects_toPrimitive(e,"string");return"symbol"==twoSlideRects_typeof(t)?t:t+"";}function twoSlideRects_toPrimitive(e,t){if("object"!=twoSlideRects_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=twoSlideRects_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function twoSlideRects_callSuper(e,t,r){return t=twoSlideRects_getPrototypeOf(t),twoSlideRects_possibleConstructorReturn(e,twoSlideRects_isNativeReflectConstruct()?Reflect.construct(t,r||[],twoSlideRects_getPrototypeOf(e).constructor):t.apply(e,r));}function twoSlideRects_possibleConstructorReturn(e,t){if(t&&("object"==twoSlideRects_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return twoSlideRects_assertThisInitialized(e);}function twoSlideRects_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function twoSlideRects_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(twoSlideRects_isNativeReflectConstruct=function twoSlideRects_isNativeReflectConstruct(){return!!e;})();}function twoSlideRects_getPrototypeOf(e){return twoSlideRects_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},twoSlideRects_getPrototypeOf(e);}function twoSlideRects_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&twoSlideRects_setPrototypeOf(e,t);}function twoSlideRects_setPrototypeOf(e,t){return twoSlideRects_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},twoSlideRects_setPrototypeOf(e,t);}var twoSlideRects_fonts={title:{cyrillic:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-ASAEWn.woff2",latin:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-QSAA.woff2"},subtitle:{cyrillic:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqDx_rc-ASAEWn.woff2",latin:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqDx_rc-QSAA.woff2"}},LtTwoSlideRects=function(e){function t(e,r){var n;return twoSlideRects_classCallCheck(this,t),(n=twoSlideRects_callSuper(this,t,[e,r])).isTitleTextShown=!1,n.isTitleRectHidden=!1,n.isSubtitleTextShown=!1,n.isSubtitleRectHidden=!1,n.delay=300,n.gap=3,n.isReady=!1,n.addShowFunction(),n.addHideFunction(),Promise.all([n.loadFont("title",twoSlideRects_fonts.title.cyrillic),n.loadFont("title",twoSlideRects_fonts.title.latin),n.loadFont("subtitle",twoSlideRects_fonts.subtitle.cyrillic),n.loadFont("subtitle",twoSlideRects_fonts.subtitle.latin)])["finally"](function(){n.isReady=!0,n.render();}),n;}return twoSlideRects_inherits(t,LowerThird),twoSlideRects_createClass(t,[{key:"render",value:function value(){var e,t,r,n;this.container.removeChild(null===(e=this.titleBox)||void 0===e?void 0:e.container),null===(t=this.titleBox)||void 0===t||t.destroy(),this.container.removeChild(null===(r=this.subtitleBox)||void 0===r?void 0:r.container),null===(n=this.subtitleBox)||void 0===n||n.destroy(),this.subtitleBox=new AnimatedBox(this.sdkOptions,{fontfamily:this.fontFamily("subtitle"),text:this.options.text.subtitle,colorText:this.options.color.primary,colorTextHidden:16777215,colorRect:this.options.color.primary,size:12,isVisible:this.isVisible(),offsetX:this.offsetX()}),this.subtitleBox.container.position.x=this.offsetX(),this.subtitleBox.container.position.y=this.sdkOptions.height-this.offsetY()-this.subtitleBox.height,this.titleBox=new AnimatedBox(this.sdkOptions,{fontfamily:this.fontFamily("title"),text:this.options.text.title,colorText:this.options.color.primary,colorTextHidden:2236962,colorRect:this.options.color.secondary,size:25,isVisible:this.isVisible(),offsetX:this.offsetX()}),this.titleBox.container.position.x=this.offsetX(),this.titleBox.container.position.y=this.sdkOptions.height-this.offsetY()-this.titleBox.height-this.subtitleBox.height-this.px(this.gap),this.container.addChild(this.titleBox.container),this.container.addChild(this.subtitleBox.container);}},{key:"addShowFunction",value:function value(){var e=this;this.showFunction=function(){var t,r;e.isReady&&(e.isTitleRectHidden=!1,e.isSubtitleRectHidden=!1,null===(t=e.titleBox)||void 0===t||t.textOutAnimation.reset(),null===(r=e.subtitleBox)||void 0===r||r.textOutAnimation.reset(),e.show(),e.titleBox.textInAnimateFunction(),e.titleBox.textInAnimation.isEnd(.8)&&setTimeout(function(){return e.isTitleTextShown=!0;},e.delay),e.isTitleTextShown&&(e.titleBox.rectAnimateFunction(!0),e.titleBox.hiddenMaskAnimateFunction(!0)),e.subtitleBox.textInAnimateFunction(),e.subtitleBox.textInAnimation.isEnd(.8)&&setTimeout(function(){e.isSubtitleTextShown=!0;},e.delay),e.isSubtitleTextShown&&(e.subtitleBox.rectAnimateFunction(!0),e.subtitleBox.hiddenMaskAnimateFunction(!0)),e.titleBox.rectAnimation.isEnd()&&e.subtitleBox.rectAnimation.isEnd()&&e.stopShowing());};}},{key:"addHideFunction",value:function value(){var e=this;this.hideFunction=function(){if(e.isTitleTextShown=!1,e.isSubtitleTextShown=!1,e.titleBox.textInAnimation.reset(),e.subtitleBox.textInAnimation.reset(),!e.isHiding)return e.stopHiding(),e.hide(),e.titleBox.textResetFunction(),void e.subtitleBox.textResetFunction();e.titleBox.rectAnimateFunction(!1),e.titleBox.hiddenMaskAnimateFunction(!1),e.titleBox.rectAnimation.isStart()&&setTimeout(function(){return e.isTitleRectHidden=!0;},e.delay),e.isTitleRectHidden&&e.titleBox.textOutAnimateFunction(),e.subtitleBox.rectAnimateFunction(!1),e.subtitleBox.hiddenMaskAnimateFunction(!1),e.subtitleBox.rectAnimation.isStart()&&setTimeout(function(){return e.isSubtitleRectHidden=!0;},e.delay),e.isSubtitleRectHidden&&e.subtitleBox.textOutAnimateFunction(),e.isHiding=!e.titleBox.textOutAnimation.isEnd()&&!e.subtitleBox.textOutAnimation.isEnd();};}}]);}();function callbackStore_typeof(e){return callbackStore_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},callbackStore_typeof(e);}function callbackStore_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function callbackStore_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,callbackStore_toPropertyKey(n.key),n);}}function callbackStore_createClass(e,t,r){return t&&callbackStore_defineProperties(e.prototype,t),r&&callbackStore_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function callbackStore_toPropertyKey(e){var t=callbackStore_toPrimitive(e,"string");return"symbol"==callbackStore_typeof(t)?t:t+"";}function callbackStore_toPrimitive(e,t){if("object"!=callbackStore_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=callbackStore_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var CallbackStore=function(){return callbackStore_createClass(function e(){callbackStore_classCallCheck(this,e),this.store=new Map();},[{key:"setCallback",value:function value(e,t){return"function"!=typeof t?(this.store["delete"](e),!1):(this.store.set(e,t),!0);}},{key:"getCallback",value:function value(e){return this.store.get(e);}},{key:"call",value:function value(e){var t=this.store.get(e);if("function"==typeof t)return t();}}]);}(),promiseManager=__webpack_require__(7036),fix_webm_duration=__webpack_require__(1707),fix_webm_duration_default=__webpack_require__.n(fix_webm_duration);function timer_typeof(e){return timer_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},timer_typeof(e);}function timer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function timer_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,timer_toPropertyKey(n.key),n);}}function timer_createClass(e,t,r){return t&&timer_defineProperties(e.prototype,t),r&&timer_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function timer_toPropertyKey(e){var t=timer_toPrimitive(e,"string");return"symbol"==timer_typeof(t)?t:t+"";}function timer_toPrimitive(e,t){if("object"!=timer_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=timer_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}var Timer=function(){return timer_createClass(function e(){timer_classCallCheck(this,e),this.state="inactive",this._duration=0,this.timeStart=0;},[{key:"duration",get:function get(){return"active"===this.state?Date.now()-this.timeStart+this._duration:this._duration;}},{key:"start",value:function value(){"inactive"===this.state&&(this._duration=0,this.state="active",this.timeStart=Date.now());}},{key:"stop",value:function value(){"inactive"!==this.state&&("active"===this.state&&(this._duration=this._duration+Date.now()-this.timeStart),this.state="inactive");}},{key:"pause",value:function value(){"active"===this.state&&(this.state="paused",this._duration=this._duration+Date.now()-this.timeStart);}},{key:"resume",value:function value(){"paused"===this.state&&(this.state="active",this.timeStart=Date.now());}}]);}();function recorder_regeneratorRuntime(){recorder_regeneratorRuntime=function recorder_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==recorder_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(recorder_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function recorder_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function recorder_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){recorder_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){recorder_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function recorder_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function recorder_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,recorder_toPropertyKey(n.key),n);}}function recorder_createClass(e,t,r){return t&&recorder_defineProperties(e.prototype,t),r&&recorder_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function recorder_toPropertyKey(e){var t=recorder_toPrimitive(e,"string");return"symbol"==recorder_typeof(t)?t:t+"";}function recorder_toPrimitive(e,t){if("object"!=recorder_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=recorder_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function recorder_typeof(e){return recorder_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},recorder_typeof(e);}var recorder_decorate=function recorder_decorate(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":recorder_typeof(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a;},recorder_metadata=function recorder_metadata(e,t){if("object"===("undefined"==typeof Reflect?"undefined":recorder_typeof(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t);},Recorder=function(){return recorder_createClass(function e(){recorder_classCallCheck(this,e),this.onStartFunction=function(){},this.blobPromise=new promiseManager.P(),this.timer=new Timer();},[{key:"removeTracks",value:function value(e){var t=this;if(this.stream){("audio"===e?t.stream.getAudioTracks():"video"===e?t.stream.getVideoTracks():t.stream.getTracks()).forEach(function(e){t.stream.removeTrack(e);});}}},{key:"initRecorder",value:function value(e){var t=this;this.isActive()&&this.stop(),this.recorder=new MediaRecorder(e,{mimeType:this.mimeType}),this.recorder.ondataavailable=function(e){return t.blobPromise.resolve(e.data);};}},{key:"start",value:function value(){return!!this.recorder&&"inactive"===this.recorder.state&&(this.blobPromise.createPromise(),this.recorder.start(),this.timer.start(),this.onStartFunction(),!0);}},{key:"resume",value:function value(){return!!this.recorder&&"paused"===this.recorder.state&&(this.recorder.resume(),this.timer.resume(),!0);}},{key:"pause",value:function value(){return!!this.recorder&&"recording"===this.recorder.state&&(this.recorder.pause(),this.timer.pause(),!0);}},{key:"stop",value:function value(){return!!this.recorder&&"inactive"!==this.recorder.state&&(this.recorder.stop(),this.timer.stop(),!0);}},{key:"getRecord",value:(e=recorder_asyncToGenerator(recorder_regeneratorRuntime().mark(function e(){var t;return recorder_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("inactive"===this.recorder.state){e.next=2;break;}throw"[ recorder ]: Cannot get blob. First you need to stop the record.";case 2:return e.next=4,this.blobPromise.promise;case 4:if(t=e.sent){e.next=7;break;}return e.abrupt("return",void 0);case 7:return e.next=9,fix_webm_duration_default()(t,this.timer.duration,{logger:!1});case 9:return e.abrupt("return",t);case 10:case"end":return e.stop();}},e,this);})),function(){return e.apply(this,arguments);})},{key:"setVideoTrack",value:function value(e){e&&(this.removeTracks("video"),this.stream||(this.stream=new MediaStream()),this.stream.addTrack(e),this.initRecorder(this.stream));}},{key:"setSDKVideoTrack",value:function value(e){this.sdkVideoTrack=e,this.setVideoTrack(e);}},{key:"setAudioTracks",value:function value(e){if(0!==e.length){if(this.removeTracks("audio"),this.stream||(this.stream=new MediaStream()),1===e.length)return this.stream.addTrack(e[0]),void this.initRecorder(this.stream);var t=new AudioContext(),r=t.createMediaStreamDestination();e.forEach(function(e){var n=new MediaStream();n.addTrack(e),t.createMediaStreamSource(n).connect(r);});var n=r.stream;this.stream.addTrack(n.getAudioTracks()[0]),this.initRecorder(this.stream);}}},{key:"setMimeType",value:function value(e){MediaRecorder.isTypeSupported(e)?(this.mimeType=e,this.recorder&&this.stream&&this.initRecorder(this.stream)):errorBus.bv.notify({message:"mimeType ".concat(e," is not supported."),emitter:errorBus.JK.RECORDER});}},{key:"onStart",value:function value(e){"function"==typeof e&&(this.onStartFunction=e);}},{key:"isActive",value:function value(){var e,t;return"recording"===(null===(e=this.recorder)||void 0===e?void 0:e.state)||"paused"===(null===(t=this.recorder)||void 0===t?void 0:t.state);}},{key:"getDuration",value:function value(){return this.timer.duration;}},{key:"getSDKTracks",value:function value(){return{sdkAudioTrack:this.sdkAudioTrack,sdkVideoTrack:this.sdkVideoTrack};}}]);var e;}();function Options_typeof(e){return Options_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},Options_typeof(e);}function Options_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function Options_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Options_toPropertyKey(n.key),n);}}function Options_createClass(e,t,r){return t&&Options_defineProperties(e.prototype,t),r&&Options_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function Options_toPropertyKey(e){var t=Options_toPrimitive(e,"string");return"symbol"==Options_typeof(t)?t:t+"";}function Options_toPrimitive(e,t){if("object"!=Options_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Options_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function Options_callSuper(e,t,r){return t=Options_getPrototypeOf(t),Options_possibleConstructorReturn(e,Options_isNativeReflectConstruct()?Reflect.construct(t,r||[],Options_getPrototypeOf(e).constructor):t.apply(e,r));}function Options_possibleConstructorReturn(e,t){if(t&&("object"==Options_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Options_assertThisInitialized(e);}function Options_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function Options_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(Options_isNativeReflectConstruct=function Options_isNativeReflectConstruct(){return!!e;})();}function Options_getPrototypeOf(e){return Options_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},Options_getPrototypeOf(e);}function Options_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Options_setPrototypeOf(e,t);}function Options_setPrototypeOf(e,t){return Options_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},Options_setPrototypeOf(e,t);}Recorder=recorder_decorate([(0,stats.Y)("recorder"),recorder_metadata("design:paramtypes",[])],Recorder);var Options=function(e){function t(){var e;return Options_classCallCheck(this,t),(e=Options_callSuper(this,t)).width=1280,e.height=720,e.customWidth=1280,e.customHeight=720,e.customSize=!1,e;}return Options_inherits(t,eventemitter3),Options_createClass(t,[{key:"setSize",value:function value(e,t){var r=!1;this.width!=e&&(this.width=e,r=!0),this.height!=t&&(this.height=t,r=!0),r&&this.emit("update",this);}},{key:"setCustomSize",value:function value(e,t){this.customSize=!0,this.setSize(e,t);}},{key:"isCustomSize",value:function value(){return this.customSize;}},{key:"isLandscape",value:function value(){return this.getAspect()>1;}},{key:"getAspect",value:function value(){return this.width/this.height;}}]);}();var sharpnessShader="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nuniform vec2 uStep;\nuniform float uSharpnessPower;\n\nconst float FSR_RCAS_LIMIT = 0.25 - 1.0 / 16.0;\n\nfloat calcLuma(vec3 texel) {\n  float luma = texel.b * 0.5 + (texel.r * 0.5 + texel.g);\n  return luma;\n}\n\nvec3 min4_vec3(vec3 a, vec3 b, vec3 c, vec3 d) {\n  vec3 min_ab = min(a, b);\n  vec3 min_cd = min(c, d);\n\n  return min(min_ab, min_cd);\n}\n\nvec3 max4_vec3(vec3 a, vec3 b, vec3 c, vec3 d) {\n  vec3 max_ab = max(a, b);\n  vec3 max_cd = max(c, d);\n\n  return max(max_ab, max_cd);\n}\n\nfloat max3_float(float a, float b, float c) {\n  float max_ab = max(a, b);\n\n  return max(max_ab, c);\n}\n\nfloat max5_float(float a, float b, float c, float d, float e) {\n  float max_ab = max(a, b);\n  float max_cd = max(c, d);\n  float max_ab_cd = max(max_ab, max_cd);\n\n  return max(max_ab_cd, e);\n}\n\nfloat min5_float(float a, float b, float c, float d, float e) {\n  float min_ab = min(a, b);\n  float min_cd = min(c, d);\n  float min_ab_cd = min(min_ab, min_cd);\n\n  return min(min_ab_cd, e);\n}\n\nfloat saturate(float val) {\n  return min(1.0, max(0.0, val));\n}\n\nfloat rcp(float val) {\n  return 1.0 / val;\n}\n\nvoid main() {\n  vec4 color = texture2D(uSampler, vTextureCoord);\n  // Algorithm uses minimal 3x3 pixel neighborhood.\n  //    b\n  //  d e f\n  //    h\n\n  vec3 e_texel = color.rgb;\n  vec3 b_texel = texture2D(uSampler, vTextureCoord + vec2(0, -uStep.y)).rgb;\n  vec3 h_texel = texture2D(uSampler, vTextureCoord + vec2(0, +uStep.y)).rgb;\n  vec3 d_texel = texture2D(uSampler, vTextureCoord + vec2(-uStep.x, 0)).rgb;\n  vec3 f_texel = texture2D(uSampler, vTextureCoord + vec2(+uStep.x, 0)).rgb;\n\n  float e_luma = calcLuma(e_texel);\n  float b_luma = calcLuma(b_texel);\n  float h_luma = calcLuma(h_texel);\n  float d_luma = calcLuma(d_texel);\n  float f_luma = calcLuma(f_texel);\n\n  // Min and max of ring.\n  vec3 min_ring = min4_vec3(b_texel, h_texel, d_texel, f_texel);\n  vec3 max_ring = max4_vec3(b_texel, h_texel, d_texel, f_texel);\n  // Immediate constants for peak range.\n  vec2 peakC = vec2(1.0, 1.0 * 4.0);\n  // Limiters, these need to be high precision RCPs.\n  vec3 hit_min = min_ring / (4.0 * max_ring);\n  vec3 hit_max = (1.0 - max_ring) / (4.0 * min_ring - peakC.y);\n  vec3 lobeC = max(-hit_min, hit_max);\n\n  float max_lobeC = max3_float(lobeC.r, lobeC.g, lobeC.b);\n  float lobe = max(-FSR_RCAS_LIMIT, min(max_lobeC, 0.0)) * uSharpnessPower;\n\n  // Noise detection.\n  float noise = 0.25 * b_luma + 0.25 * d_luma + 0.25 * f_luma + 0.25 * h_luma - e_luma;\n  float max_luma = max5_float(e_luma, b_luma, h_luma, d_luma, f_luma);\n  float min_luma = min5_float(e_luma, b_luma, h_luma, d_luma, f_luma);\n  noise = saturate(abs(noise) * rcp(max_luma - min_luma));\n  noise = -0.5 * noise + 1.0;\n  lobe = lobe * noise;\n\n  vec3 result = (lobe * (b_texel + d_texel + h_texel + f_texel) + e_texel) / (4.0 * lobe + 1.0);\n\n  gl_FragColor = vec4(result, color.a);\n}\n";function filterSharpness_typeof(e){return filterSharpness_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},filterSharpness_typeof(e);}function filterSharpness_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function filterSharpness_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,filterSharpness_toPropertyKey(n.key),n);}}function filterSharpness_createClass(e,t,r){return t&&filterSharpness_defineProperties(e.prototype,t),r&&filterSharpness_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function filterSharpness_toPropertyKey(e){var t=filterSharpness_toPrimitive(e,"string");return"symbol"==filterSharpness_typeof(t)?t:t+"";}function filterSharpness_toPrimitive(e,t){if("object"!=filterSharpness_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=filterSharpness_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function filterSharpness_callSuper(e,t,r){return t=filterSharpness_getPrototypeOf(t),filterSharpness_possibleConstructorReturn(e,filterSharpness_isNativeReflectConstruct()?Reflect.construct(t,r||[],filterSharpness_getPrototypeOf(e).constructor):t.apply(e,r));}function filterSharpness_possibleConstructorReturn(e,t){if(t&&("object"==filterSharpness_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return filterSharpness_assertThisInitialized(e);}function filterSharpness_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function filterSharpness_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(filterSharpness_isNativeReflectConstruct=function filterSharpness_isNativeReflectConstruct(){return!!e;})();}function filterSharpness_getPrototypeOf(e){return filterSharpness_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},filterSharpness_getPrototypeOf(e);}function filterSharpness_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&filterSharpness_setPrototypeOf(e,t);}function filterSharpness_setPrototypeOf(e,t){return filterSharpness_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},filterSharpness_setPrototypeOf(e,t);}var FilterSharpness=function(e){function t(e){var r,n;return filterSharpness_classCallCheck(this,t),r=filterSharpness_callSuper(this,t,[void 0,sharpnessShader]),e.outputResolution&&r.setOutputResolution(e.outputResolution),r.setPower(null!==(n=e.power)&&void 0!==n?n:0),r;}return filterSharpness_inherits(t,_Filter2),filterSharpness_createClass(t,[{key:"setOutputResolution",value:function value(e){var t=1/(e.width-1),r=1/(e.height-1);this.uniforms.uStep=[t,r];}},{key:"setPower",value:function value(e){e=Math.max(0,e),e=Math.min(1,e),this.uniforms.uSharpnessPower=.3*e+1;}}]);}(),config_defaultConfig=function config_defaultConfig(){return{power:0};};function sharpnessEffect_typeof(e){return sharpnessEffect_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},sharpnessEffect_typeof(e);}function sharpnessEffect_regeneratorRuntime(){sharpnessEffect_regeneratorRuntime=function sharpnessEffect_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==sharpnessEffect_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(sharpnessEffect_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function sharpnessEffect_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function sharpnessEffect_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){sharpnessEffect_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){sharpnessEffect_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function sharpnessEffect_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function sharpnessEffect_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sharpnessEffect_toPropertyKey(n.key),n);}}function sharpnessEffect_createClass(e,t,r){return t&&sharpnessEffect_defineProperties(e.prototype,t),r&&sharpnessEffect_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function sharpnessEffect_toPropertyKey(e){var t=sharpnessEffect_toPrimitive(e,"string");return"symbol"==sharpnessEffect_typeof(t)?t:t+"";}function sharpnessEffect_toPrimitive(e,t){if("object"!=sharpnessEffect_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=sharpnessEffect_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function sharpnessEffect_callSuper(e,t,r){return t=sharpnessEffect_getPrototypeOf(t),sharpnessEffect_possibleConstructorReturn(e,sharpnessEffect_isNativeReflectConstruct()?Reflect.construct(t,r||[],sharpnessEffect_getPrototypeOf(e).constructor):t.apply(e,r));}function sharpnessEffect_possibleConstructorReturn(e,t){if(t&&("object"==sharpnessEffect_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return sharpnessEffect_assertThisInitialized(e);}function sharpnessEffect_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function sharpnessEffect_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(sharpnessEffect_isNativeReflectConstruct=function sharpnessEffect_isNativeReflectConstruct(){return!!e;})();}function sharpnessEffect_superPropGet(e,t,r,n){var i=sharpnessEffect_get(sharpnessEffect_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e);}:i;}function sharpnessEffect_get(){return sharpnessEffect_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=sharpnessEffect_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value;}},sharpnessEffect_get.apply(null,arguments);}function sharpnessEffect_superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=sharpnessEffect_getPrototypeOf(e)););return e;}function sharpnessEffect_getPrototypeOf(e){return sharpnessEffect_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},sharpnessEffect_getPrototypeOf(e);}function sharpnessEffect_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sharpnessEffect_setPrototypeOf(e,t);}function sharpnessEffect_setPrototypeOf(e,t){return sharpnessEffect_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},sharpnessEffect_setPrototypeOf(e,t);}var SharpnessEffect=function(e){function t(e){var r;return sharpnessEffect_classCallCheck(this,t),(r=sharpnessEffect_callSuper(this,t,[e])).config=config_defaultConfig(),r.filterName="sharpness",r;}return sharpnessEffect_inherits(t,AbstractEffect),sharpnessEffect_createClass(t,[{key:"prepare",value:function value(){this.resources.texture;var e=this.sdkOptions,t=e.width,r=e.height;this.filterSharpness=new FilterSharpness({outputResolution:{height:r,width:t}}),this.sdkOptions.on("update",this.onOptionsUpdate,this);}},{key:"onOptionsUpdate",value:function value(){var e=this.sdkOptions,t=e.width,r=e.height;this.filterSharpness.setOutputResolution({height:r,width:t});}},{key:"process",value:(r=sharpnessEffect_asyncToGenerator(sharpnessEffect_regeneratorRuntime().mark(function e(){return sharpnessEffect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break;}return e.abrupt("return");case 2:this.resources.filters.set(this.filterName,this.filterSharpness);case 3:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"disable",value:function value(){sharpnessEffect_superPropGet(t,"disable",this,3)([]),this.resources.filters["delete"](this.filterName);}},{key:"setConfig",value:function value(e){this.setPower(e.power);}},{key:"setPower",value:function value(e){void 0!==e&&(this.config.power=e,this.filterSharpness.setPower(e));}},{key:"destroy",value:function value(){this.sdkOptions.off("update",this.onOptionsUpdate,this);}}]);var r;}();function FilterDrawEffects_typeof(e){return FilterDrawEffects_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},FilterDrawEffects_typeof(e);}function FilterDrawEffects_regeneratorRuntime(){FilterDrawEffects_regeneratorRuntime=function FilterDrawEffects_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==FilterDrawEffects_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(FilterDrawEffects_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function FilterDrawEffects_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function FilterDrawEffects_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){FilterDrawEffects_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){FilterDrawEffects_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function FilterDrawEffects_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function FilterDrawEffects_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FilterDrawEffects_toPropertyKey(n.key),n);}}function FilterDrawEffects_createClass(e,t,r){return t&&FilterDrawEffects_defineProperties(e.prototype,t),r&&FilterDrawEffects_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function FilterDrawEffects_toPropertyKey(e){var t=FilterDrawEffects_toPrimitive(e,"string");return"symbol"==FilterDrawEffects_typeof(t)?t:t+"";}function FilterDrawEffects_toPrimitive(e,t){if("object"!=FilterDrawEffects_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=FilterDrawEffects_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function FilterDrawEffects_callSuper(e,t,r){return t=FilterDrawEffects_getPrototypeOf(t),FilterDrawEffects_possibleConstructorReturn(e,FilterDrawEffects_isNativeReflectConstruct()?Reflect.construct(t,r||[],FilterDrawEffects_getPrototypeOf(e).constructor):t.apply(e,r));}function FilterDrawEffects_possibleConstructorReturn(e,t){if(t&&("object"==FilterDrawEffects_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return FilterDrawEffects_assertThisInitialized(e);}function FilterDrawEffects_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function FilterDrawEffects_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(FilterDrawEffects_isNativeReflectConstruct=function FilterDrawEffects_isNativeReflectConstruct(){return!!e;})();}function FilterDrawEffects_getPrototypeOf(e){return FilterDrawEffects_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},FilterDrawEffects_getPrototypeOf(e);}function FilterDrawEffects_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FilterDrawEffects_setPrototypeOf(e,t);}function FilterDrawEffects_setPrototypeOf(e,t){return FilterDrawEffects_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},FilterDrawEffects_setPrototypeOf(e,t);}var FilterDrawEffect=function(e){function t(e){return FilterDrawEffects_classCallCheck(this,t),FilterDrawEffects_callSuper(this,t,[e]);}return FilterDrawEffects_inherits(t,AbstractEffect),FilterDrawEffects_createClass(t,[{key:"prepare",value:function value(){var e=this.resources.texture;this.original=new Frame(e,{width:this.sdkOptions.width,height:this.sdkOptions.height}),this.original.addBuffer("result"),this.sdkOptions.on("update",this.onOptionsUpdate,this);}},{key:"onOptionsUpdate",value:function value(){this.original.resize(this.sdkOptions.width,this.sdkOptions.height);}},{key:"process",value:(r=FilterDrawEffects_asyncToGenerator(FilterDrawEffects_regeneratorRuntime().mark(function e(){var t=this;return FilterDrawEffects_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.resources.filters.size){e.next=2;break;}return e.abrupt("return");case 2:this.resources.filters.forEach(function(e){var r;null===(r=t.original.frame.filters)||void 0===r||r.push(e);}),this.resources.renderer.renderTo(this.original.frame,this.original.getBuffer("result")),this.resources.texture.update(this.original.getBuffer("result"),!1),this.original.frame.filters=[];case 6:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"destroy",value:function value(){this.sdkOptions.off("update",this.onOptionsUpdate,this);}}]);var r;}();function MirroringEffect_typeof(e){return MirroringEffect_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},MirroringEffect_typeof(e);}function MirroringEffect_regeneratorRuntime(){MirroringEffect_regeneratorRuntime=function MirroringEffect_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==MirroringEffect_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(MirroringEffect_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function MirroringEffect_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function MirroringEffect_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){MirroringEffect_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){MirroringEffect_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function MirroringEffect_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function MirroringEffect_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MirroringEffect_toPropertyKey(n.key),n);}}function MirroringEffect_createClass(e,t,r){return t&&MirroringEffect_defineProperties(e.prototype,t),r&&MirroringEffect_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function MirroringEffect_toPropertyKey(e){var t=MirroringEffect_toPrimitive(e,"string");return"symbol"==MirroringEffect_typeof(t)?t:t+"";}function MirroringEffect_toPrimitive(e,t){if("object"!=MirroringEffect_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=MirroringEffect_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function MirroringEffect_callSuper(e,t,r){return t=MirroringEffect_getPrototypeOf(t),MirroringEffect_possibleConstructorReturn(e,MirroringEffect_isNativeReflectConstruct()?Reflect.construct(t,r||[],MirroringEffect_getPrototypeOf(e).constructor):t.apply(e,r));}function MirroringEffect_possibleConstructorReturn(e,t){if(t&&("object"==MirroringEffect_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return MirroringEffect_assertThisInitialized(e);}function MirroringEffect_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function MirroringEffect_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(MirroringEffect_isNativeReflectConstruct=function MirroringEffect_isNativeReflectConstruct(){return!!e;})();}function MirroringEffect_superPropGet(e,t,r,n){var i=MirroringEffect_get(MirroringEffect_getPrototypeOf(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e);}:i;}function MirroringEffect_get(){return MirroringEffect_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=MirroringEffect_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value;}},MirroringEffect_get.apply(null,arguments);}function MirroringEffect_superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=MirroringEffect_getPrototypeOf(e)););return e;}function MirroringEffect_getPrototypeOf(e){return MirroringEffect_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},MirroringEffect_getPrototypeOf(e);}function MirroringEffect_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MirroringEffect_setPrototypeOf(e,t);}function MirroringEffect_setPrototypeOf(e,t){return MirroringEffect_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},MirroringEffect_setPrototypeOf(e,t);}var MirroringEffect=function(e){function t(e){var r;return MirroringEffect_classCallCheck(this,t),(r=MirroringEffect_callSuper(this,t,[e])).filterName="mirroring",r.filterMirror=new FilterMirror(),r;}return MirroringEffect_inherits(t,AbstractEffect),MirroringEffect_createClass(t,[{key:"prepare",value:function value(){}},{key:"process",value:(r=MirroringEffect_asyncToGenerator(MirroringEffect_regeneratorRuntime().mark(function e(){return MirroringEffect_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break;}return e.abrupt("return");case 2:this.resources.filters.set(this.filterName,this.filterMirror);case 3:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"enable",value:function value(){MirroringEffect_superPropGet(t,"enable",this,3)([]),this.resources.mirror=!0;}},{key:"disable",value:function value(){MirroringEffect_superPropGet(t,"disable",this,3)([]),this.resources.mirror=!1,this.resources.filters["delete"](this.filterName);}},{key:"destroy",value:function value(){}}]);var r;}();function FinalDrawEffects_typeof(e){return FinalDrawEffects_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},FinalDrawEffects_typeof(e);}function FinalDrawEffects_regeneratorRuntime(){FinalDrawEffects_regeneratorRuntime=function FinalDrawEffects_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==FinalDrawEffects_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(FinalDrawEffects_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function FinalDrawEffects_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function FinalDrawEffects_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){FinalDrawEffects_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){FinalDrawEffects_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function FinalDrawEffects_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function FinalDrawEffects_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FinalDrawEffects_toPropertyKey(n.key),n);}}function FinalDrawEffects_createClass(e,t,r){return t&&FinalDrawEffects_defineProperties(e.prototype,t),r&&FinalDrawEffects_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function FinalDrawEffects_toPropertyKey(e){var t=FinalDrawEffects_toPrimitive(e,"string");return"symbol"==FinalDrawEffects_typeof(t)?t:t+"";}function FinalDrawEffects_toPrimitive(e,t){if("object"!=FinalDrawEffects_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=FinalDrawEffects_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function FinalDrawEffects_callSuper(e,t,r){return t=FinalDrawEffects_getPrototypeOf(t),FinalDrawEffects_possibleConstructorReturn(e,FinalDrawEffects_isNativeReflectConstruct()?Reflect.construct(t,r||[],FinalDrawEffects_getPrototypeOf(e).constructor):t.apply(e,r));}function FinalDrawEffects_possibleConstructorReturn(e,t){if(t&&("object"==FinalDrawEffects_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return FinalDrawEffects_assertThisInitialized(e);}function FinalDrawEffects_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function FinalDrawEffects_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return(FinalDrawEffects_isNativeReflectConstruct=function FinalDrawEffects_isNativeReflectConstruct(){return!!e;})();}function FinalDrawEffects_getPrototypeOf(e){return FinalDrawEffects_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e);},FinalDrawEffects_getPrototypeOf(e);}function FinalDrawEffects_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FinalDrawEffects_setPrototypeOf(e,t);}function FinalDrawEffects_setPrototypeOf(e,t){return FinalDrawEffects_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e;},FinalDrawEffects_setPrototypeOf(e,t);}var FinalDrawEffects_classPrivateFieldSet=function FinalDrawEffects_classPrivateFieldSet(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r;},FinalDrawEffects_classPrivateFieldGet=function FinalDrawEffects_classPrivateFieldGet(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e);},_FinalDrawEffect_original,FinalDrawEffect=function(e){function t(e){var r;return FinalDrawEffects_classCallCheck(this,t),r=FinalDrawEffects_callSuper(this,t,[e]),_FinalDrawEffect_original.set(r,void 0),r;}return FinalDrawEffects_inherits(t,AbstractEffect),FinalDrawEffects_createClass(t,[{key:"prepare",value:function value(){var e=this.resources.texture,t=this.sdkOptions,r=t.width,n=t.height;FinalDrawEffects_classPrivateFieldSet(this,_FinalDrawEffect_original,new Frame(e,{width:r,height:n}),"f"),FinalDrawEffects_classPrivateFieldGet(this,_FinalDrawEffect_original,"f").addBuffer("result"),this.sdkOptions.on("update",this.onOptionsUpdate,this);}},{key:"onOptionsUpdate",value:function value(){var e=this.sdkOptions,t=e.width,r=e.height;FinalDrawEffects_classPrivateFieldGet(this,_FinalDrawEffect_original,"f").resize(t,r);}},{key:"process",value:(r=FinalDrawEffects_asyncToGenerator(FinalDrawEffects_regeneratorRuntime().mark(function e(){return FinalDrawEffects_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.resources.renderer.addToEffects(FinalDrawEffects_classPrivateFieldGet(this,_FinalDrawEffect_original,"f").frame),this.resources.renderer.addStatistics(),this.resources.renderer.render(),this.resources.renderer.removeStatistics(),this.resources.renderer.removeFromEffects(FinalDrawEffects_classPrivateFieldGet(this,_FinalDrawEffect_original,"f").frame);case 5:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"destroy",value:function value(){this.sdkOptions.off("update",this.onOptionsUpdate,this);}}]);var r;}();function tsvb_toConsumableArray(e){return tsvb_arrayWithoutHoles(e)||tsvb_iterableToArray(e)||tsvb_unsupportedIterableToArray(e)||tsvb_nonIterableSpread();}function tsvb_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function tsvb_unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return tsvb_arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tsvb_arrayLikeToArray(e,t):void 0;}}function tsvb_iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e);}function tsvb_arrayWithoutHoles(e){if(Array.isArray(e))return tsvb_arrayLikeToArray(e);}function tsvb_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n;}function tsvb_regeneratorRuntime(){tsvb_regeneratorRuntime=function tsvb_regeneratorRuntime(){return t;};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value;},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t];}try{l({},"");}catch(e){l=function l(e,t,r){return e[t]=r;};}function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:E(e,r,s)}),a;}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)};}catch(e){return{type:"throw",arg:e};}}t.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function b(){}var v={};l(v,a,function(){return this;});var x=Object.getPrototypeOf,_=x&&x(x(k([])));_&&_!==r&&n.call(_,a)&&(v=_);var S=b.prototype=g.prototype=Object.create(v);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e);});});}function I(e,t){function r(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==tsvb_typeof(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,a,s);},function(e){r("throw",e,a,s);}):t.resolve(c).then(function(e){l.value=e,a(l);},function(e){return r("throw",e,a,s);});}s(u.arg);}var o;i(this,"_invoke",{value:function value(e,n){function i(){return new t(function(t,i){r(e,n,t,i);});}return o=o?o.then(i,i):i();}});}function E(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0};}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done};}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg);}};}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator["return"]&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m);}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t);}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t;}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0);}function k(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r;};return o.next=o;}}throw new TypeError(tsvb_typeof(t)+" is not iterable");}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name));},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e;},t.awrap=function(e){return{__await:e};},T(I.prototype),l(I.prototype,s,function(){return this;}),t.AsyncIterator=I,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new I(c(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next();});},T(S),l(S,u,"Generator"),l(S,a,function(){return this;}),l(S,"toString",function(){return"[object Generator]";}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e;}return e.done=!0,e;};},t.values=k,P.prototype={constructor:P,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e);},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval;},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i;}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc);}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc);}}}},abrupt:function abrupt(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break;}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a);},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m;},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),m;}},"catch":function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r);}return i;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(t,r,n){return this.delegate={iterator:k(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m;}},t;}function tsvb_asyncGeneratorStep(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value;}catch(e){return void r(e);}s.done?t(u):Promise.resolve(u).then(n,i);}function tsvb_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){tsvb_asyncGeneratorStep(o,n,i,a,s,"next",e);}function s(e){tsvb_asyncGeneratorStep(o,n,i,a,s,"throw",e);}a(void 0);});};}function tsvb_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function tsvb_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tsvb_toPropertyKey(n.key),n);}}function tsvb_createClass(e,t,r){return t&&tsvb_defineProperties(e.prototype,t),r&&tsvb_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;}function tsvb_toPropertyKey(e){var t=tsvb_toPrimitive(e,"string");return"symbol"==tsvb_typeof(t)?t:t+"";}function tsvb_toPrimitive(e,t){if("object"!=tsvb_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=tsvb_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}function tsvb_typeof(e){return tsvb_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return _typeof2(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e);},tsvb_typeof(e);}_FinalDrawEffect_original=new WeakMap();var tsvb_decorate=function tsvb_decorate(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":tsvb_typeof(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a;},tsvb_metadata=function tsvb_metadata(e,t){if("object"===("undefined"==typeof Reflect?"undefined":tsvb_typeof(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t);},tsvb_classPrivateFieldGet=function tsvb_classPrivateFieldGet(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e);},tsvb_classPrivateFieldSet=function tsvb_classPrivateFieldSet(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r;},_tsvb_abortController,tsvb=function(){return tsvb_createClass(function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;tsvb_classCallCheck(this,e),this.outputFrameFormat="RGBX",this.components=new Proxy({},componentsProxyHandler),_tsvb_abortController.set(this,void 0),this.customer_id=t,src_settings.yy.CUSTOMER_ID=t,src_settings.yy.setVersion(),user_uid.W.getInstance().getUID(this.customer_id),stats.Uz.Instance.setCustomerID(this.customer_id),r&&(this.custom_inference=MLInferenceFactory.getInference("custom"),this.custom_inference.setBackend(r)),this.onnx_inference=MLInferenceFactory.getInference("onnx"),this.sdkOptions=new Options(),this.recorder=new Recorder(),this.callbackStore=new CallbackStore(),this.colorFilterEffect=new ColorFilterEffect(this.sdkOptions),this.customResolutionEffect=new CustomResolution(this.sdkOptions),this.sharpnessEffect=new SharpnessEffect(this.sdkOptions),this.mirroringEffect=new MirroringEffect(this.sdkOptions),this.filterDrawEffect=new FilterDrawEffect(this.sdkOptions),this.finalDrawEffect=new FinalDrawEffect(this.sdkOptions),this.sdkOptions.on("update",this.onOptionsUpdate,this);},[{key:"onOptionsUpdate",value:function value(e){Object.values(this.components).forEach(function(e){return e.render();}),this.virtualBackgroundEffect&&this.setSegmentationPreset(this.virtualBackgroundEffect.settings.preset);}},{key:"cache",value:(n=tsvb_asyncToGenerator(tsvb_regeneratorRuntime().mark(function e(){var t,r,n=arguments;return tsvb_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]&&n[0],r=!1,this.custom_inference&&(r=!0),e.abrupt("return",this.onnx_inference.cache(t,r));case 4:case"end":return e.stop();}},e,this);})),function(){return n.apply(this,arguments);})},{key:"preload",value:(r=tsvb_asyncToGenerator(tsvb_regeneratorRuntime().mark(function e(){var t;return tsvb_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,this.custom_inference&&(t=!0),e.abrupt("return",this.onnx_inference.preload(t));case 3:case"end":return e.stop();}},e,this);})),function(){return r.apply(this,arguments);})},{key:"config",value:function value(e){e.hasOwnProperty("app_env")&&(src_settings.yy.APP_ENV=e.app_env),e.hasOwnProperty("api_url")&&(src_settings.yy.API_URL=e.api_url),e.hasOwnProperty("model_url")&&(src_settings.yy.MODEL_URL=e.model_url),e.hasOwnProperty("sdk_url")&&(src_settings.yy.SDK_URL=e.sdk_url),e.hasOwnProperty("provider")&&(src_settings.yy.PROVIDER=e.provider),e.hasOwnProperty("preset")&&(src_settings.yy.PRESET=e.preset),e.hasOwnProperty("proxy")&&(src_settings.yy.PROXY=e.proxy),e.hasOwnProperty("stats")&&(src_settings.yy.STATS=e.stats),e.hasOwnProperty("wasmPaths")&&Object.keys(e.wasmPaths).length&&(src_settings.yy.WASM_PATHS=Object.assign(src_settings.yy.WASM_PATHS,e.wasmPaths)),e.hasOwnProperty("presets")&&Object.keys(e.presets).length&&(src_settings.yy.PRESETS=Object.assign(src_settings.yy.PRESETS,e.presets)),e.hasOwnProperty("models")&&Object.keys(e.models).length&&(src_settings.yy.MODELS=Object.assign(src_settings.yy.MODELS,e.models)),e.hasOwnProperty("effects")&&Object.keys(e.effects).length&&(src_settings.yy.EFFECTS=tsvb_toConsumableArray(e.effects));}},{key:"init",value:(t=tsvb_asyncToGenerator(tsvb_regeneratorRuntime().mark(function e(t){var r,n,i,o=this;return tsvb_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.aborted){e.next=2;break;}return e.abrupt("return");case 2:if(this.streamProcessor&&(this.streamProcessor.destroy(),this.effectProcessor.destroy(),delete this.streamProcessor,delete this.effectProcessor),n="requestAnimationFrameCallback","MediaStreamTrackProcessor"in window&&"MediaStreamTrackGenerator"in window?(this.streamProcessor=StreamProcessorFactory.getStreamProcessor("transform",this.sdkOptions),n="MediaStreamTrackProcessor"):"requestVideoFrameCallback"in HTMLVideoElement.prototype?(this.streamProcessor=StreamProcessorFactory.getStreamProcessor("videocallback",this.sdkOptions),n="requestVideoFrameCallback"):this.streamProcessor=StreamProcessorFactory.getStreamProcessor("animationcallback",this.sdkOptions),errorBus.bv.notify({message:"".concat(n," supported"),type:errorBus.By.INFO,emitter:errorBus.JK.TSVB}),this.streamProcessor.onFrameDraw(this.callbackStore.getCallback("onFrameDraw")),this.streamProcessor.onChangeInputResolution(this.callbackStore.getCallback("onChangeInputResolution")),i=new renderer_Renderer(this.sdkOptions,this.outputFrameFormat),this.streamProcessor.setRenderer(i),this.effectProcessor=new EffectProcessor(i,this.components),!t.aborted&&src_settings.yy.isEffectExist(src_settings.y$.CUSTOM_RESOLUTION)&&this.effectProcessor.addEffect(this.customResolutionEffect),!t.aborted&&src_settings.yy.isEffectExist(src_settings.y$.MIRRORING)&&this.effectProcessor.addEffect(this.mirroringEffect),!src_settings.yy.isEffectExist(src_settings.y$.LOW_LIGHT)){e.next=17;break;}return this.lowLightEffect=new LowLightEffect(this.sdkOptions,this.customer_id),e.next=17,this.lowLightEffect.init(this.onnx_inference).then(function(){if(!t.aborted){o.effectProcessor.addEffect(o.lowLightEffect);var e=o.callbackStore.getCallback("onLowLightSuccess");o.lowLightEffect.onSuccess(e);}})["catch"](function(){});case 17:if(!t.aborted&&src_settings.yy.isEffectExist(src_settings.y$.COLOR_FILTER)&&this.effectProcessor.addEffect(this.colorFilterEffect),!t.aborted&&src_settings.yy.isEffectExist(src_settings.y$.SHARPNESS)&&this.effectProcessor.addEffect(this.sharpnessEffect),!src_settings.yy.isEffectExist(src_settings.y$.COLOR_CORRECTION)){e.next=23;break;}return this.colorCorrectorEffect=new ColorCorrectorEffect(this.sdkOptions,this.customer_id),e.next=23,this.colorCorrectorEffect.init(this.onnx_inference).then(function(){t.aborted||o.effectProcessor.addEffect(o.colorCorrectorEffect);})["catch"](function(){});case 23:if(t.aborted||this.effectProcessor.addEffect(this.filterDrawEffect),!src_settings.yy.isEffectExist(src_settings.y$.SMART_ZOOM)){e.next=28;break;}return this.smartZoomEffect=new SmartZoomEffect(this.sdkOptions,this.customer_id),e.next=28,this.smartZoomEffect.init(this.onnx_inference).then(function(){t.aborted||o.effectProcessor.addEffect(o.smartZoomEffect);})["catch"](function(){});case 28:if(!src_settings.yy.isEffectExist(src_settings.y$.VIRTUAL_BACKGROUND)){e.next=32;break;}return this.virtualBackgroundEffect=new VirtualBackgroundEffect(this.sdkOptions,this.customer_id),e.next=32,this.virtualBackgroundEffect.init(null!==(r=this.custom_inference)&&void 0!==r?r:this.onnx_inference).then(function(){t.aborted||o.effectProcessor.addEffect(o.virtualBackgroundEffect);})["catch"](function(){});case 32:this.streamProcessor.useEffectProcessor(this.effectProcessor),this.callbackStore.call("onReady");case 34:case"end":return e.stop();}},e,this);})),function(e){return t.apply(this,arguments);})},{key:"getCustomerId",value:function value(){return this.customer_id;}},{key:"useStream",value:function value(e,t){var r;if(e.getVideoTracks().length){var n=e.getVideoTracks()[0].getSettings();if(t?this.sdkOptions.setCustomSize(t.width,t.height):this.sdkOptions.setSize(n.width,n.height),Object.values(this.components).forEach(function(e){return e.render();}),tsvb_classPrivateFieldGet(this,_tsvb_abortController,"f")&&tsvb_classPrivateFieldGet(this,_tsvb_abortController,"f").abort(),tsvb_classPrivateFieldSet(this,_tsvb_abortController,new AbortController(),"f"),this.init(tsvb_classPrivateFieldGet(this,_tsvb_abortController,"f").signal),this.streamProcessor.useStream(e),this.streamProcessor.getInputVideoTrack()){this.streamProcessor.process();var i=null===(r=this.streamProcessor.getStream())||void 0===r?void 0:r.getVideoTracks()[0];i&&this.recorder.setSDKVideoTrack(i);}else errorBus.bv.notify({message:"There is no input videoTrack to process",emitter:errorBus.JK.TSVB});}else errorBus.bv.notify({message:"There is no input videoTrack in the Media Stream",emitter:errorBus.JK.TSVB});}},{key:"setSegmentationPreset",value:(e=tsvb_asyncToGenerator(tsvb_regeneratorRuntime().mark(function e(t){var r;return tsvb_regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.virtualBackgroundEffect){e.next=2;break;}return e.abrupt("return",!1);case 2:if(!this.onnx_inference.isGPU||["quality","balanced"].includes(t)){e.next=5;break;}return errorBus.bv.notify({message:"WebGPU backend support only quality and balanced presets",emitter:errorBus.JK.TSVB}),e.abrupt("return",!1);case 5:return this.effectProcessor.hasFrames?this.effectProcessor.pause():this.streamProcessor.pause(),this.streamProcessor.clearBuffers(),this.streamProcessor.clearBuffers(),e.next=10,this.virtualBackgroundEffect.setPreset(t);case 10:return e.next=12,this.virtualBackgroundEffect.init(null!==(r=this.custom_inference)&&void 0!==r?r:this.onnx_inference);case 12:return this.effectProcessor.hasFrames?this.effectProcessor.unpause():this.streamProcessor.unpause(),e.abrupt("return",!0);case 14:case"end":return e.stop();}},e,this);})),function(t){return e.apply(this,arguments);})},{key:"getSegmentationPreset",value:function value(){return this.virtualBackgroundEffect.getPreset();}},{key:"setBackgroundColor",value:function value(e){this.virtualBackgroundEffect.setBackgroundColor(e);}},{key:"getStream",value:function value(){return this.streamProcessor.getStream();}},{key:"toCanvas",value:function value(e){this.streamProcessor.renderToCanvas(e);}},{key:"setFpsLimit",value:function value(e){return!!this.streamProcessor&&(this.streamProcessor.setFpsLimit(e),!0);}},{key:"showFps",value:function value(){return!!this.streamProcessor&&(this.streamProcessor.showFps(),!0);}},{key:"hideFps",value:function value(){return!!this.streamProcessor&&(this.streamProcessor.hideFps(),!0);}},{key:"freeze",value:function value(){return!!this.effectProcessor&&(this.effectProcessor.pause(),!0);}},{key:"unfreeze",value:function value(){return!!this.effectProcessor&&(this.effectProcessor.unpause(),!0);}},{key:"enableBeautification",value:function value(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.enableBeautification(),!0);}},{key:"disableBeautification",value:function value(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.disableBeautification(),!0);}},{key:"setBoundaryMode",value:function value(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setBoundaryMode(e),!0);}},{key:"setBackgroundFitMode",value:function value(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setBackgroundFitMode(e),!0);}},{key:"setBoundaryLevel",value:function value(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setBoundaryLevel(e),!0);}},{key:"setBeautificationLevel",value:function value(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setBeautificationLevel(e),!0);}},{key:"setBlur",value:function value(e){if(!this.virtualBackgroundEffect)return!1;var t=15*Math.cbrt(this.sdkOptions.height*this.sdkOptions.width)/67;return this.virtualBackgroundEffect.setBlur(Math.round(e*t)),!0;}},{key:"clearBlur",value:function value(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.clearBlur(),!0);}},{key:"setBackground",value:function value(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setBackground(e),!0);}},{key:"clearBackground",value:function value(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.clearBackground(),!0);}},{key:"enableFrameSkipping",value:function value(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.enableFrameSkipping(),!0);}},{key:"disableFrameSkipping",value:function value(){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.disableFrameSkipping(),!0);}},{key:"setLayout",value:function value(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setLayout(e),!0);}},{key:"setLayoutMode",value:function value(e){return!!this.virtualBackgroundEffect&&(this.virtualBackgroundEffect.setLayoutMode(e),!0);}},{key:"setCustomLayout",value:function value(e){if(!this.virtualBackgroundEffect)return!1;var t={};return void 0!==e.xOffset&&(t.xOffset=e.xOffset*this.sdkOptions.width),void 0!==e.yOffset&&(t.yOffset=e.yOffset*this.sdkOptions.height),void 0!==e.size&&(t.width=e.size*this.sdkOptions.width,t.height=e.size*this.sdkOptions.height),this.virtualBackgroundEffect.setCustomLayout(t),!0;}},{key:"setFaceArea",value:function value(e){return!!this.smartZoomEffect&&(e=Math.max(e,.01),e=Math.min(e,1),this.smartZoomEffect.setConfig("faceAreaProportion",e),!0);}},{key:"setFaceDetectorAccuracy",value:function value(e){return!!this.smartZoomEffect&&(e=Math.max(e,.2),e=Math.min(e,1),this.smartZoomEffect.setConfig("faceDetectorAccuracy",e),!0);}},{key:"getDetectedFaces",value:function value(){return this.smartZoomEffect?this.smartZoomEffect.getFaces():[];}},{key:"setSmartZoomSmoothing",value:function value(e){return!!this.smartZoomEffect&&(e=Math.max(e,.01),e=Math.min(e,1),this.smartZoomEffect.setConfig("smoothPower",100*e),!0);}},{key:"setSmartZoomSensitivity",value:function value(e){return!!this.smartZoomEffect&&(e=Math.max(e,0),e=Math.min(e,1),this.smartZoomEffect.setConfig("sensitivityValue",e),!0);}},{key:"setSmartZoomPerod",value:function value(e){return!!this.smartZoomEffect&&(e=Math.max(e,0),e=Math.min(e,1e3),this.smartZoomEffect.setConfig("faceDetectorPediod_ms",e),!0);}},{key:"switchDrawFaceSquare",value:function value(e){return!!this.smartZoomEffect&&(this.smartZoomEffect.setConfig("isFaceSquareDrawingEnabled",e),!0);}},{key:"switchDrawPreFaceSquare",value:function value(e){return!!this.smartZoomEffect&&(this.smartZoomEffect.setConfig("isPreFaceSquareDrawingEnabled",e),!0);}},{key:"enableSmartZoom",value:function value(){return!!this.smartZoomEffect&&(this.smartZoomEffect.enable(),!0);}},{key:"disableSmartZoom",value:function value(){return!!this.smartZoomEffect&&(this.smartZoomEffect.disable(),!0);}},{key:"enableColorCorrector",value:function value(){return!!this.colorCorrectorEffect&&(this.colorCorrectorEffect.enable(),!0);}},{key:"disableColorCorrector",value:function value(){return!!this.colorCorrectorEffect&&(this.colorCorrectorEffect.disable(),!0);}},{key:"enableMirroring",value:function value(){return!!this.mirroringEffect&&(this.mirroringEffect.enable(),!0);}},{key:"disableMirroring",value:function value(){return!!this.mirroringEffect&&(this.mirroringEffect.disable(),!0);}},{key:"enableColorFilter",value:function value(){return!!this.colorFilterEffect&&(this.colorFilterEffect.enable(),!0);}},{key:"disableColorFilter",value:function value(){return!!this.colorFilterEffect&&(this.colorFilterEffect.disable(),!0);}},{key:"setColorFilterConfig",value:function value(e){return!!this.colorFilterEffect&&(this.colorFilterEffect.setConfig(e),!0);}},{key:"setFilterPart",value:function value(e){return!!this.colorCorrectorEffect&&(this.colorCorrectorEffect.setConfig("filterPart",e),!0);}},{key:"setColorCorrectorPeriod",value:function value(e){return!!this.colorCorrectorEffect&&(e=Math.max(e,0),e=Math.min(e,5e3),this.colorCorrectorEffect.setConfig("modelPediod_ms",e),!0);}},{key:"setColorCorrectorPower",value:function value(e){return!!this.colorCorrectorEffect&&(e=Math.max(e,0),e=Math.min(e,1),this.colorCorrectorEffect.setConfig("cc_power",e),!0);}},{key:"enableLowLightEffect",value:function value(){return!!this.lowLightEffect&&(this.lowLightEffect.enable(),!0);}},{key:"disableLowLightEffect",value:function value(){return!!this.lowLightEffect&&(this.lowLightEffect.disable(),!0);}},{key:"setLowLightEffectConfig",value:function value(e){return!!this.lowLightEffect&&(this.lowLightEffect.setConfig(e),!0);}},{key:"setLowLightEffectPower",value:function value(e){return this.setLowLightEffectConfig({power:e}),!0;}},{key:"enableSharpnessEffect",value:function value(){return!!this.sharpnessEffect&&(this.sharpnessEffect.enable(),!0);}},{key:"disableSharpnessEffect",value:function value(){return!!this.sharpnessEffect&&(this.sharpnessEffect.disable(),!0);}},{key:"setSharpnessEffectConfig",value:function value(e){return!!this.sharpnessEffect&&(this.sharpnessEffect.setConfig(e),!0);}},{key:"clear",value:function value(){return!!this.streamProcessor&&(this.streamProcessor.destroy(),!0);}},{key:"run",value:function value(){return this.streamProcessor&&(this.streamProcessor.isRunning=!0),!0;}},{key:"stop",value:function value(){return this.streamProcessor&&(this.streamProcessor.isRunning=!1),!0;}},{key:"enablePipelineSkipping",value:function value(){var e;null===(e=this.effectProcessor)||void 0===e||e.enablePipelineSkipping();}},{key:"disablePipelineSkipping",value:function value(){var e;null===(e=this.effectProcessor)||void 0===e||e.disablePipelineSkipping();}},{key:"getEffectProcessor",value:function value(){return this.effectProcessor;}},{key:"createComponent",value:function value(e){return new componentsMap[e.component](this.sdkOptions,e.options);}},{key:"addComponent",value:function value(e,t){this.components[t]=e;}},{key:"getComponentConstructor",value:function value(e){return componentsMap[e];}},{key:"setOutputResolution",value:function value(e){this.streamProcessor&&this.streamProcessor.setOutputResolution(e.width,e.height);}},{key:"clearOutputResolution",value:function value(){this.streamProcessor&&this.streamProcessor.clearOutputResolution();}},{key:"setOutputFrameFormat",value:function value(e){this.outputFrameFormat=e;}},{key:"onReady",set:function set(e){this.callbackStore.setCallback("onReady",e);}},{key:"onError",value:function value(e){errorBus.bv.subscribe(e);}},{key:"onFrame",set:function set(e){var t;this.callbackStore.setCallback("onFrameDraw",e),null===(t=this.streamProcessor)||void 0===t||t.onFrameDraw(e);}},{key:"onChangeInputResolution",value:function value(e){var t;this.callbackStore.setCallback("onChangeInputResolution",e),null===(t=this.streamProcessor)||void 0===t||t.onChangeInputResolution(e);}},{key:"onAuthRequest",value:function value(e){this.onnx_inference&&this.onnx_inference.onAuth(e);}},{key:"onColorFilterSuccess",value:function value(e){this.callbackStore.setCallback("onColorFilterSuccess",e),this.colorFilterEffect.onSuccess(e);}},{key:"onLowLightSuccess",value:function value(e){var t;this.callbackStore.setCallback("onLowLightSuccess",e),null===(t=this.lowLightEffect)||void 0===t||t.onSuccess(e);}}]);var e,t,r,n;}();_tsvb_abortController=new WeakMap(),tsvb=tsvb_decorate([(0,stats.Y)("tsvb"),tsvb_metadata("design:paramtypes",[String,Object])],tsvb);var componentsMap={overlay_screen:OverlayScreen,watermark:Watermark,lowerthird_1:LtLeftTextbox,lowerthird_2:LtHorizontalMirror,lowerthird_3:LtSlideBold,lowerthird_4:LtDoubleSlideRect,lowerthird_5:LtTwoSlideRects,stickers:Stickers},__webpack_exports__tsvb=exports.tsvb=__webpack_exports__.o;
